/*!
Parts of this script are from the PenguinMod Packager <https://studio.penguinmod.com/PenguinMod-Packager/>, licensed as follows:
Copyright (C) 2021-2022 Thomas Weber

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

Parts of this script are from Scratch <https://scratch.mit.edu/>, licensed as follows:
Copyright (c) 2016, Massachusetts Institute of Technology
All rights reserved.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.

2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/

!function(A){function e(e){for(var t,i,r=e[0],o=e[1],s=0,B=[];s<r.length;s++)i=r[s],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&B.push(n[i][0]),n[i]=0;for(t in o)Object.prototype.hasOwnProperty.call(o,t)&&(A[t]=o[t]);for(a&&a(e);B.length;)B.shift()()}var t={},n={0:0};function i(e){if(t[e])return t[e].exports;var n=t[e]={i:e,l:!1,exports:{}};return A[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.e=function(A){var e=[],t=n[A];if(0!==t)if(t)e.push(t[2]);else{var r=new Promise((function(e,i){t=n[A]=[e,i]}));e.push(t[2]=r);var o,s=document.createElement("script");s.charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.src=function(A){return i.p+"scaffolding/"+({1:"vendors~iframe-extension-worker"}[A]||A)+".js"}(A);var a=new Error;o=function(e){s.onerror=s.onload=null,clearTimeout(B);var t=n[A];if(0!==t){if(t){var i=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;a.message="Loading chunk "+A+" failed.\n("+i+": "+r+")",a.name="ChunkLoadError",a.type=i,a.request=r,t[1](a)}n[A]=void 0}};var B=setTimeout((function(){o({type:"timeout",target:s})}),12e4);s.onerror=s.onload=o,document.head.appendChild(s)}return Promise.all(e)},i.m=A,i.c=t,i.d=function(A,e,t){i.o(A,e)||Object.defineProperty(A,e,{enumerable:!0,get:t})},i.r=function(A){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(A,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(A,"__esModule",{value:!0})},i.t=function(A,e){if(1&e&&(A=i(A)),8&e)return A;if(4&e&&"object"==typeof A&&A&&A.__esModule)return A;var t=Object.create(null);if(i.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:A}),2&e&&"string"!=typeof A)for(var n in A)i.d(t,n,function(e){return A[e]}.bind(null,n));return t},i.n=function(A){var e=A&&A.__esModule?function(){return A.default}:function(){return A};return i.d(e,"a",e),e},i.o=function(A,e){return Object.prototype.hasOwnProperty.call(A,e)},i.p="",i.oe=function(A){throw console.error(A),A};var r=window.webpackJsonp=window.webpackJsonp||[],o=r.push.bind(r);r.push=e,r=r.slice();for(var s=0;s<r.length;s++)e(r[s]);var a=o;i(i.s=499)}([,function(A,e){A.exports={BOOLEAN:"Boolean",BUTTON:"button",LABEL:"label",COMMAND:"command",CONDITIONAL:"conditional",EVENT:"event",HAT:"hat",LOOP:"loop",REPORTER:"reporter",XML:"xml"}},function(A,e,t){const n=t(8),i=A=>{if("string"!=typeof A)return!1;for(let e=0;e<A.length;e++){const t=A.charCodeAt(e);if(48===t||9===t)return!1}return!0};class r{static toNumber(A){if("number"==typeof A)return Number.isNaN(A)?0:A;const e=Number(A);return Number.isNaN(e)?0:e}static toBoolean(A){return"boolean"==typeof A?A:"string"==typeof A?""!==A&&"0"!==A&&"false"!==A.toLowerCase():Boolean(A)}static toString(A){return String(A)}static toRgbColorList(A){const e=r.toRgbColorObject(A);return[e.r,e.g,e.b]}static toRgbColorObject(A){let e;return"string"==typeof A&&"#"===A.substring(0,1)?(e=n.hexToRgb(A),e||(e={r:0,g:0,b:0,a:255})):e=n.decimalToRgb(r.toNumber(A)),e}static isWhiteSpace(A){return null===A||"string"==typeof A&&0===A.trim().length}static compare(A,e){let t=Number(A),n=Number(e);if(0===t&&i(A)?t=NaN:0===n&&i(e)&&(n=NaN),isNaN(t)||isNaN(n)){const t=String(A).toLowerCase(),n=String(e).toLowerCase();return t<n?-1:t>n?1:0}return t===1/0&&n===1/0||t===-1/0&&n===-1/0?0:t-n}static isInt(A){return"number"==typeof A?!!isNaN(A)||A===Math.floor(A):"boolean"==typeof A||"string"==typeof A&&A.indexOf(".")<0}static get LIST_INVALID(){return"INVALID"}static get LIST_ALL(){return"ALL"}static toListIndex(A,e,t){if("number"!=typeof A){if("all"===A)return t?r.LIST_ALL:r.LIST_INVALID;if("last"===A)return e>0?e:r.LIST_INVALID;if("random"===A||"any"===A)return e>0?1+Math.floor(Math.random()*e):r.LIST_INVALID}return(A=Math.floor(r.toNumber(A)))<1||A>e?r.LIST_INVALID:A}}A.exports=r},function(A,e){A.exports={ANGLE:"angle",BOOLEAN:"Boolean",COLOR:"color",NUMBER:"number",STRING:"string",MATRIX:"matrix",NOTE:"note",IMAGE:"image",POLYGON:"polygon",CUSTOM:"custom",COSTUME:"costume",SOUND:"sound",VARIABLE:"variable",LIST:"list",BROADCAST:"broadcast",SEPERATOR:"seperator"}},function(A,e,t){"use strict";var n=t(143),i=t(144),r=t(87),o=t(86),s=t(85);function a(A,e){return Object.keys(e).forEach((function(t){A[t]=e[t]})),A}A.exports=function A(){var e=a({},s),t="en",B={},c=function(A){return A},g=null,E="warning",Q={};function u(A,e,r){var o="string"==typeof A?A:A.default,s=h(o,"object"==typeof A&&A.id||c(o),r||t);return(s.format||(s.format=i(n(s.message),r||t,Q)))(e)}u.rich=function(A,e,r){var o="string"==typeof A?A:A.default,s=h(o,"object"==typeof A&&A.id||c(o),r||t);return(s.toParts||(s.toParts=i.toParts(n(s.message,{tagsType:l}),r||t,Q)))(e)};var l="<>";function w(A,e){var t=A[2];return function(A,e){var n="object"==typeof t?function(A,e){return Object.keys(A).reduce((function(t,n){return t[n]=A[n](e),t}),{})}(t,e):t;return"function"==typeof A?A(n):A}}function h(A,e,t){var n=o(t,B)||"en",i=B[n]||(B[n]={}),r=i[e];if("string"==typeof r&&(r=i[e]={message:r}),!r){var s='Translation for "'+e+'" in "'+n+'" is missing';if("warning"===E)"undefined"!=typeof console&&console.warn(s);else if("ignore"!==E)throw new Error(s);var a="function"==typeof g?g(A,e,n)||A:g||A;r=i[e]={message:a}}return r}function C(A,e,n,i,s){"object"==typeof n&&"object"!=typeof i&&(s=i,i=n,n=0);var a=o(s||t,r),B=a&&r[a][A]||I;return i["="+ +e]||i[B(e-n)]||i.other}function I(){return"other"}return Q[l]=w,u.setup=function(A){return(A=A||{}).locale&&(t=A.locale),"translations"in A&&(B=A.translations||{}),A.generateId&&(c=A.generateId),"missingReplacement"in A&&(g=A.missingReplacement),A.missingTranslation&&(E=A.missingTranslation),A.formats&&(A.formats.number&&a(e.number,A.formats.number),A.formats.date&&a(e.date,A.formats.date),A.formats.time&&a(e.time,A.formats.time)),A.types&&((Q=A.types)[l]=w),{locale:t,translations:B,generateId:c,missingReplacement:g,missingTranslation:E,formats:e,types:Q}},u.number=function(A,n,i){var r=n&&e.number[n]||e.parseNumberPattern(n)||e.number.default;return new Intl.NumberFormat(i||t,r).format(A)},u.date=function(A,n,i){var r=n&&e.date[n]||e.parseDatePattern(n)||e.date.default;return new Intl.DateTimeFormat(i||t,r).format(A)},u.time=function(A,n,i){var r=n&&e.time[n]||e.parseDatePattern(n)||e.time.default;return new Intl.DateTimeFormat(i||t,r).format(A)},u.select=function(A,e){return e[A]||e.other},u.custom=function(A,e,t,n){return A[1]in Q?Q[A[1]](A,e)(t,n):t},u.plural=C.bind(null,"cardinal"),u.selectordinal=C.bind(null,"ordinal"),u.namespace=A,u}()},function(A,e,t){const n=t(53);n.enable(),A.exports=n("vm")},function(A,e){A.exports=class{static degToRad(A){return A*Math.PI/180}static radToDeg(A){return 180*A/Math.PI}static clamp(A,e,t){return Math.min(Math.max(A,e),t)}static wrapClamp(A,e,t){const n=t-e+1;return A-Math.floor((A-e)/n)*n}static tan(A){switch(A%=360){case-270:case 90:return 1/0;case-90:case 270:return-1/0;default:return Math.round(1e10*Math.tan(Math.PI*A/180))/1e10}}static reducedSortOrdering(A){const e=A.slice(0).sort((A,e)=>A-e);return A.map(A=>e.indexOf(A))}static inclusiveRandIntWithout(A,e,t){const n=e-A,i=A+Math.floor(Math.random()*n);return i>=t?i+1:i}static scale(A,e,t,n,i){return(A-e)/(t-e)*(i-n)+n}}},function(A,e){A.exports=class{static simple(A){return JSON.parse(JSON.stringify(A))}}},function(A,e){class t{static get RGB_BLACK(){return{r:0,g:0,b:0}}static get RGB_WHITE(){return{r:255,g:255,b:255}}static decimalToHex(A){A<0&&(A+=16777216);let e=Math.round(Number(A)).toString(16);return e="#".concat("000000".substr(0,6-e.length)).concat(e),e}static decimalToRgb(A){const e=A>>24&255;return{r:A>>16&255,g:A>>8&255,b:255&A,a:e>0?e:255}}static hexToRgb(A){A.startsWith("#")&&(A=A.substring(1)),8===A.length&&(A=A.slice(0,6));const e=parseInt(A,16);if(isNaN(e))return null;if(6===A.length)return{r:e>>16&255,g:e>>8&255,b:255&e};if(3===A.length){const A=e>>8&15,t=e>>4&15,n=15&e;return{r:A<<4|A,g:t<<4|t,b:n<<4|n}}return null}static rgbToHex(A){return t.decimalToHex(t.rgbToDecimal(A))}static rgbToDecimal(A){return(A.r<<16)+(A.g<<8)+A.b}static hexToDecimal(A){return t.rgbToDecimal(t.hexToRgb(A))}static hsvToRgb(A){let e=A.h%360;e<0&&(e+=360);const t=Math.max(0,Math.min(A.s,1)),n=Math.max(0,Math.min(A.v,1)),i=Math.floor(e/60),r=e/60-i,o=n*(1-t),s=n*(1-t*r),a=n*(1-t*(1-r));let B,c,g;switch(i){default:case 0:B=n,c=a,g=o;break;case 1:B=s,c=n,g=o;break;case 2:B=o,c=n,g=a;break;case 3:B=o,c=s,g=n;break;case 4:B=a,c=o,g=n;break;case 5:B=n,c=o,g=s}return{r:Math.floor(255*B),g:Math.floor(255*c),b:Math.floor(255*g)}}static rgbToHsv(A){const e=A.r/255,t=A.g/255,n=A.b/255,i=Math.min(Math.min(e,t),n),r=Math.max(Math.max(e,t),n);let o=0,s=0;if(i!==r){o=60*((e===i?3:t===i?5:1)-(e===i?t-n:t===i?n-e:e-t)/(r-i))%360,s=(r-i)/r}return{h:o,s:s,v:r}}static mixRgb(A,e,t){if(t<=0)return A;if(t>=1)return e;const n=1-t;return{r:n*A.r+t*e.r,g:n*A.g+t*e.g,b:n*A.b+t*e.b}}}A.exports=t},function(A,e){const t="!#%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";A.exports=function(){const A=t.length,e=[];for(let n=0;n<20;n++)e[n]=t.charAt(Math.random()*A);return e.join("")}},function(A,e,t){const n=t(5);class i{static withoutTrailingDigits(A){let e=A.length-1;for(;e>=0&&"0123456789".indexOf(A.charAt(e))>-1;)e--;return A.slice(0,e+1)}static unusedName(A,e){if(e.indexOf(A)<0)return A;A=i.withoutTrailingDigits(A);let t=2;for(;e.indexOf(A+t)>=0;)t++;return A+t}static splitFirst(A,e){const t=A.indexOf(e);return t>=0?[A.substring(0,t),A.substring(t+1)]:[A,null]}static stringify(A){return JSON.stringify(A,(A,e)=>"number"!=typeof e||e!==1/0&&e!==-1/0&&!isNaN(e)?e:0)}static replaceUnsafeChars(A){if("string"!=typeof A){if(!Array.isArray(A))return n.error("Unexpected input recieved in replaceUnsafeChars"),A;A=String(A)}return A.replace(/[<>&'"]/g,A=>{switch(A){case"<":return"lt";case">":return"gt";case"&":return"amp";case"'":return"apos";case'"':return"quot"}})}}A.exports=i},function(A,e){A.exports={HEXAGONAL:1,ROUND:2,SQUARE:3,LEAF:4,PLUS:5,OCTAGONAL:6,BUMPED:7,INDENTED:8,SCRAPPED:9,ARROW:10,TICKET:11}},function(A,e){A.exports={Always:1,Never:2,IfAtMostOneObstacle:3,OnlyWhenNoObstacles:4}},function(A,e){A.exports={validateJSON:A=>{let e=!1,t={};try{if(!A.startsWith("{"))throw new Error("error lol");t=JSON.parse(A),e=!0}catch(A){}return{object:t,json:A,isValid:e}},validateArray:A=>{let e=!1,t=[];try{if(!A.startsWith("["))throw new Error("error lol");t=JSON.parse(A),e=!0}catch(A){}return{array:t,json:A,isValid:e}},stringToEqivalint:A=>{try{if(!A.startsWith("{")&&!A.startsWith("["))throw new Error("not actualy a json!!!!!!!!!!");A=JSON.parse(A)}catch(e){String(Number(A))===A?A=Number(A):"true"===A.toLowerCase()?A=!0:"false"===A.toLowerCase()?A=!1:"undefined"===A?A=void 0:"null"===A&&(A=null)}return A},valueToString:A=>A="object"==typeof A?JSON.stringify(A):String(A),validateRegex:(A,e)=>{let t=!1;try{new RegExp(A,e),t=!0}catch(A){}return t}}},function(A,e){var t;t=function(){return this}();try{t=t||new Function("return this")()}catch(A){"object"==typeof window&&(t=window)}A.exports=t},function(A,e){A.exports={SPRITE:"sprite",STAGE:"stage"}},function(A,e){class t{static get BACKGROUND_LAYER(){return"background"}static get VIDEO_LAYER(){return"video"}static get PEN_LAYER(){return"pen"}static get SPRITE_LAYER(){return"sprite"}static get LAYER_GROUPS(){return[t.BACKGROUND_LAYER,t.VIDEO_LAYER,t.PEN_LAYER,t.SPRITE_LAYER]}static get LAYER_GROUPS_PEN(){return[t.BACKGROUND_LAYER,t.VIDEO_LAYER,t.SPRITE_LAYER,t.PEN_LAYER]}}A.exports=t},function(A,e,t){
/*!
 * @license twgl.js 4.4.0 Copyright (c) 2015, Gregg Tavares All Rights Reserved.
 * Available via the MIT license.
 * see: http://github.com/greggman/twgl.js for details
 */
var n;"undefined"!=typeof self&&self,n=function(){return function(A){var e={};function t(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return A[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}return t.m=A,t.c=e,t.d=function(A,e,n){t.o(A,e)||Object.defineProperty(A,e,{configurable:!1,enumerable:!0,get:n})},t.n=function(A){var e=A&&A.__esModule?function(){return A.default}:function(){return A};return t.d(e,"a",e),e},t.o=function(A,e){return Object.prototype.hasOwnProperty.call(A,e)},t.p="",t(t.s=9)}([function(A,e,t){"use strict";e.__esModule=!0,e.copyExistingProperties=function(A,e){Object.keys(e).forEach((function(t){e.hasOwnProperty(t)&&A.hasOwnProperty(t)&&(e[t]=A[t])}))},e.copyNamedProperties=function(A,e,t){A.forEach((function(A){var n=e[A];void 0!==n&&(t[A]=n)}))},e.isBuffer=function(A,e){return o||(o=A.createBuffer()),e instanceof o.constructor},e.isRenderbuffer=function(A,e){return s||(s=A.createRenderbuffer()),e instanceof s.constructor},e.isShader=function(A,e){return a||(a=A.createShader(A.VERTEX_SHADER)),e instanceof a.constructor},e.isTexture=function(A,e){return B||(B=A.createTexture()),e instanceof B.constructor},e.isSampler=function(A,e){if(!c){if(!A.createSampler)return!1;c=A.createSampler()}return e instanceof c.constructor},e.warn=e.error=void 0;var n,i=(n=t(2))&&n.__esModule?n:{default:n},r=i.default.console&&i.default.console.error&&"function"==typeof i.default.console.error?i.default.console.error.bind(i.default.console):function(){};e.error=r;var o,s,a,B,c,g=i.default.console&&i.default.console.warn&&"function"==typeof i.default.console.warn?i.default.console.warn.bind(i.default.console):function(){};e.warn=g},function(A,e,t){"use strict";e.__esModule=!0,e.getGLTypeForTypedArray=function(A){if(A instanceof Int8Array)return 5120;if(A instanceof Uint8Array)return 5121;if(A instanceof Uint8ClampedArray)return 5121;if(A instanceof Int16Array)return 5122;if(A instanceof Uint16Array)return 5123;if(A instanceof Int32Array)return 5124;if(A instanceof Uint32Array)return 5125;if(A instanceof Float32Array)return 5126;throw"unsupported typed array type"},e.getGLTypeForTypedArrayType=function(A){if(A===Int8Array)return 5120;if(A===Uint8Array)return 5121;if(A===Uint8ClampedArray)return 5121;if(A===Int16Array)return 5122;if(A===Uint16Array)return 5123;if(A===Int32Array)return 5124;if(A===Uint32Array)return 5125;if(A===Float32Array)return 5126;throw"unsupported typed array type"},e.getTypedArrayTypeForGLType=function(A){var e=r[A];if(!e)throw"unknown gl type";return e},e.isArrayBuffer=void 0;var n,i=(n=t(2))&&n.__esModule?n:{default:n},r={},o=r;o[5120]=Int8Array,o[5121]=Uint8Array,o[5122]=Int16Array,o[5123]=Uint16Array,o[5124]=Int32Array,o[5125]=Uint32Array,o[5126]=Float32Array,o[32819]=Uint16Array,o[32820]=Uint16Array,o[33635]=Uint16Array,o[5131]=Uint16Array,o[33640]=Uint32Array,o[35899]=Uint32Array,o[35902]=Uint32Array,o[36269]=Uint32Array,o[34042]=Uint32Array;var s=i.default.SharedArrayBuffer?function(A){return A&&A.buffer&&(A.buffer instanceof ArrayBuffer||A.buffer instanceof i.default.SharedArrayBuffer)}:function(A){return A&&A.buffer&&A.buffer instanceof ArrayBuffer};e.isArrayBuffer=s},function(A,e,t){"use strict";e.__esModule=!0,e.default=void 0;var n=void 0!==n?n:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};e.default=n},function(A,e,t){"use strict";e.__esModule=!0,e.add=function(A,e,t){return(t=t||new n(3))[0]=A[0]+e[0],t[1]=A[1]+e[1],t[2]=A[2]+e[2],t},e.copy=function(A,e){return(e=e||new n(3))[0]=A[0],e[1]=A[1],e[2]=A[2],e},e.create=function(A,e,t){var i=new n(3);return A&&(i[0]=A),e&&(i[1]=e),t&&(i[2]=t),i},e.cross=function(A,e,t){t=t||new n(3);var i=A[2]*e[0]-A[0]*e[2],r=A[0]*e[1]-A[1]*e[0];return t[0]=A[1]*e[2]-A[2]*e[1],t[1]=i,t[2]=r,t},e.distance=function(A,e){var t=A[0]-e[0],n=A[1]-e[1],i=A[2]-e[2];return Math.sqrt(t*t+n*n+i*i)},e.distanceSq=function(A,e){var t=A[0]-e[0],n=A[1]-e[1],i=A[2]-e[2];return t*t+n*n+i*i},e.divide=function(A,e,t){return(t=t||new n(3))[0]=A[0]/e[0],t[1]=A[1]/e[1],t[2]=A[2]/e[2],t},e.divScalar=function(A,e,t){return(t=t||new n(3))[0]=A[0]/e,t[1]=A[1]/e,t[2]=A[2]/e,t},e.dot=function(A,e){return A[0]*e[0]+A[1]*e[1]+A[2]*e[2]},e.lerp=function(A,e,t,i){return(i=i||new n(3))[0]=(1-t)*A[0]+t*e[0],i[1]=(1-t)*A[1]+t*e[1],i[2]=(1-t)*A[2]+t*e[2],i},e.length=function(A){return Math.sqrt(A[0]*A[0]+A[1]*A[1]+A[2]*A[2])},e.lengthSq=function(A){return A[0]*A[0]+A[1]*A[1]+A[2]*A[2]},e.mulScalar=function(A,e,t){return(t=t||new n(3))[0]=A[0]*e,t[1]=A[1]*e,t[2]=A[2]*e,t},e.multiply=function(A,e,t){return(t=t||new n(3))[0]=A[0]*e[0],t[1]=A[1]*e[1],t[2]=A[2]*e[2],t},e.negate=function(A,e){return(e=e||new n(3))[0]=-A[0],e[1]=-A[1],e[2]=-A[2],e},e.normalize=function(A,e){e=e||new n(3);var t=A[0]*A[0]+A[1]*A[1]+A[2]*A[2],i=Math.sqrt(t);return i>1e-5?(e[0]=A[0]/i,e[1]=A[1]/i,e[2]=A[2]/i):(e[0]=0,e[1]=0,e[2]=0),e},e.setDefaultType=function(A){var e=n;return n=A,e},e.subtract=function(A,e,t){return(t=t||new n(3))[0]=A[0]-e[0],t[1]=A[1]-e[1],t[2]=A[2]-e[2],t};var n=Float32Array},function(A,e,t){"use strict";e.__esModule=!0,e.isWebGL1=function(A){return!A.texStorage2D},e.isWebGL2=function(A){return!!A.texStorage2D},e.glEnumToString=void 0;var n,i,r=(n={},i={},function(A,e){return function(A){var e=A.constructor.name;if(!n[e]){for(var t in A)if("number"==typeof A[t]){var r=i[A[t]];i[A[t]]=r?"".concat(r," | ").concat(t):t}n[e]=!0}}(A),i[e]||"0x"+e.toString(16)});e.glEnumToString=r},function(A,e,t){"use strict";e.__esModule=!0,e.createAttributeSetters=J,e.createProgram=y,e.createProgramFromScripts=function(A,e,t,n,i){for(var r=Y(t,n,i),o=[],s=0;s<e.length;++s){var a=T(A,e[s],A[f[s]],r.errorCallback);if(!a)return null;o.push(a)}return y(A,o,r)},e.createProgramFromSources=x,e.createProgramInfo=function(A,e,t,n,i){var r=Y(t,n,i),o=!0;if(e=e.map((function(A){if(A.indexOf("\n")<0){var e=c(A);e?A=e.text:(r.errorCallback("no element with id: "+A),o=!1)}return A})),!o)return null;var s=x(A,e,r);return s?L(A,s):null},e.createProgramInfoFromProgram=L,e.createUniformSetters=G,e.createUniformBlockSpecFromProgram=b,e.createUniformBlockInfoFromProgram=k,e.createUniformBlockInfo=function(A,e,t){return k(A,e.program,e.uniformBlockSpec,t)},e.createTransformFeedback=function(A,e,t){var n=A.createTransformFeedback();return A.bindTransformFeedback(A.TRANSFORM_FEEDBACK,n),A.useProgram(e.program),H(A,e,t),A.bindTransformFeedback(A.TRANSFORM_FEEDBACK,null),function(A,e,t){for(var n in e.transformFeedbackInfo&&(e=e.transformFeedbackInfo),t.attribs&&(t=t.attribs),t){var i=e[n];i&&A.bindBufferBase(A.TRANSFORM_FEEDBACK_BUFFER,i.index,null)}}(A,e,t),n},e.createTransformFeedbackInfo=S,e.bindTransformFeedbackInfo=H,e.setAttributes=z,e.setBuffersAndAttributes=function(A,e,t){t.vertexArrayObject?A.bindVertexArray(t.vertexArrayObject):(z(e.attribSetters||e,t.attribs),t.indices&&A.bindBuffer(A.ELEMENT_ARRAY_BUFFER,t.indices))},e.setUniforms=function A(e,t){for(var n=e.uniformSetters||e,i=arguments.length,r=1;r<i;++r){var o=arguments[r];if(Array.isArray(o))for(var s=o.length,a=0;a<s;++a)A(n,o[a]);else for(var B in o){var c=n[B];c&&c(o[B])}}},e.setUniformBlock=function(A,e,t){j(A,e,t)&&A.bufferData(A.UNIFORM_BUFFER,t.array,A.DYNAMIC_DRAW)},e.setBlockUniforms=function(A,e){var t=A.uniforms;for(var n in e){var i=t[n];if(i){var r=e[n];r.length?i.set(r):i[0]=r}}},e.bindUniformBlock=j;var n,i=s(t(4)),r=s(t(0)),o=(n=t(2))&&n.__esModule?n:{default:n};function s(A){if(A&&A.__esModule)return A;var e={};if(null!=A)for(var t in A)if(Object.prototype.hasOwnProperty.call(A,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(A,t):{};n.get||n.set?Object.defineProperty(e,t,n):e[t]=A[t]}return e.default=A,e}var a=r.error,B=r.warn,c=o.default&&o.default.document&&o.default.document.getElementById?o.default.document.getElementById.bind(o.default.document):function(){return null},g={};function E(A,e){return g[e].bindPoint}function Q(A,e){return function(t){A.uniform1i(e,t)}}function u(A,e){return function(t){A.uniform1iv(e,t)}}function l(A,e){return function(t){A.uniform2iv(e,t)}}function w(A,e){return function(t){A.uniform3iv(e,t)}}function h(A,e){return function(t){A.uniform4iv(e,t)}}function C(A,e,t,n){var o=E(0,e);return i.isWebGL2(A)?function(e){var i,s;r.isTexture(A,e)?(i=e,s=null):(i=e.texture,s=e.sampler),A.uniform1i(n,t),A.activeTexture(A.TEXTURE0+t),A.bindTexture(o,i),A.bindSampler(t,s)}:function(e){A.uniform1i(n,t),A.activeTexture(A.TEXTURE0+t),A.bindTexture(o,e)}}function I(A,e,t,n,o){for(var s=E(0,e),a=new Int32Array(o),B=0;B<o;++B)a[B]=t+B;return i.isWebGL2(A)?function(e){A.uniform1iv(n,a),e.forEach((function(e,n){var i,o;A.activeTexture(A.TEXTURE0+a[n]),r.isTexture(A,e)?(i=e,o=null):(i=e.texture,o=e.sampler),A.bindSampler(t,o),A.bindTexture(s,i)}))}:function(e){A.uniform1iv(n,a),e.forEach((function(e,t){A.activeTexture(A.TEXTURE0+a[t]),A.bindTexture(s,e)}))}}function M(A,e){return function(t){A.bindBuffer(A.ARRAY_BUFFER,t.buffer),A.enableVertexAttribArray(e),A.vertexAttribPointer(e,t.numComponents||t.size,t.type||A.FLOAT,t.normalize||!1,t.stride||0,t.offset||0),void 0!==t.divisor&&A.vertexAttribDivisor(e,t.divisor)}}function d(A,e){return function(t){A.bindBuffer(A.ARRAY_BUFFER,t.buffer),A.enableVertexAttribArray(e),A.vertexAttribIPointer(e,t.numComponents||t.size,t.type||A.INT,t.stride||0,t.offset||0),void 0!==t.divisor&&A.vertexAttribDivisor(e,t.divisor)}}function m(A,e,t){var n=t.size,i=t.count;return function(t){A.bindBuffer(A.ARRAY_BUFFER,t.buffer);for(var r=t.size||t.numComponents||n,o=r/i,s=t.type||A.FLOAT,a=g[s].size*r,B=t.normalize||!1,c=t.offset||0,E=a/i,Q=0;Q<i;++Q)A.enableVertexAttribArray(e+Q),A.vertexAttribPointer(e+Q,o,s,B,a,c+E*Q),void 0!==t.divisor&&A.vertexAttribDivisor(e+Q,t.divisor)}}g[5126]={Type:Float32Array,size:4,setter:function(A,e){return function(t){A.uniform1f(e,t)}},arraySetter:function(A,e){return function(t){A.uniform1fv(e,t)}}},g[35664]={Type:Float32Array,size:8,setter:function(A,e){return function(t){A.uniform2fv(e,t)}}},g[35665]={Type:Float32Array,size:12,setter:function(A,e){return function(t){A.uniform3fv(e,t)}}},g[35666]={Type:Float32Array,size:16,setter:function(A,e){return function(t){A.uniform4fv(e,t)}}},g[5124]={Type:Int32Array,size:4,setter:Q,arraySetter:u},g[35667]={Type:Int32Array,size:8,setter:l},g[35668]={Type:Int32Array,size:12,setter:w},g[35669]={Type:Int32Array,size:16,setter:h},g[5125]={Type:Uint32Array,size:4,setter:function(A,e){return function(t){A.uniform1ui(e,t)}},arraySetter:function(A,e){return function(t){A.uniform1uiv(e,t)}}},g[36294]={Type:Uint32Array,size:8,setter:function(A,e){return function(t){A.uniform2uiv(e,t)}}},g[36295]={Type:Uint32Array,size:12,setter:function(A,e){return function(t){A.uniform3uiv(e,t)}}},g[36296]={Type:Uint32Array,size:16,setter:function(A,e){return function(t){A.uniform4uiv(e,t)}}},g[35670]={Type:Uint32Array,size:4,setter:Q,arraySetter:u},g[35671]={Type:Uint32Array,size:8,setter:l},g[35672]={Type:Uint32Array,size:12,setter:w},g[35673]={Type:Uint32Array,size:16,setter:h},g[35674]={Type:Float32Array,size:16,setter:function(A,e){return function(t){A.uniformMatrix2fv(e,!1,t)}}},g[35675]={Type:Float32Array,size:36,setter:function(A,e){return function(t){A.uniformMatrix3fv(e,!1,t)}}},g[35676]={Type:Float32Array,size:64,setter:function(A,e){return function(t){A.uniformMatrix4fv(e,!1,t)}}},g[35685]={Type:Float32Array,size:24,setter:function(A,e){return function(t){A.uniformMatrix2x3fv(e,!1,t)}}},g[35686]={Type:Float32Array,size:32,setter:function(A,e){return function(t){A.uniformMatrix2x4fv(e,!1,t)}}},g[35687]={Type:Float32Array,size:24,setter:function(A,e){return function(t){A.uniformMatrix3x2fv(e,!1,t)}}},g[35688]={Type:Float32Array,size:48,setter:function(A,e){return function(t){A.uniformMatrix3x4fv(e,!1,t)}}},g[35689]={Type:Float32Array,size:32,setter:function(A,e){return function(t){A.uniformMatrix4x2fv(e,!1,t)}}},g[35690]={Type:Float32Array,size:48,setter:function(A,e){return function(t){A.uniformMatrix4x3fv(e,!1,t)}}},g[35678]={Type:null,size:0,setter:C,arraySetter:I,bindPoint:3553},g[35680]={Type:null,size:0,setter:C,arraySetter:I,bindPoint:34067},g[35679]={Type:null,size:0,setter:C,arraySetter:I,bindPoint:32879},g[35682]={Type:null,size:0,setter:C,arraySetter:I,bindPoint:3553},g[36289]={Type:null,size:0,setter:C,arraySetter:I,bindPoint:35866},g[36292]={Type:null,size:0,setter:C,arraySetter:I,bindPoint:35866},g[36293]={Type:null,size:0,setter:C,arraySetter:I,bindPoint:34067},g[36298]={Type:null,size:0,setter:C,arraySetter:I,bindPoint:3553},g[36299]={Type:null,size:0,setter:C,arraySetter:I,bindPoint:32879},g[36300]={Type:null,size:0,setter:C,arraySetter:I,bindPoint:34067},g[36303]={Type:null,size:0,setter:C,arraySetter:I,bindPoint:35866},g[36306]={Type:null,size:0,setter:C,arraySetter:I,bindPoint:3553},g[36307]={Type:null,size:0,setter:C,arraySetter:I,bindPoint:32879},g[36308]={Type:null,size:0,setter:C,arraySetter:I,bindPoint:34067},g[36311]={Type:null,size:0,setter:C,arraySetter:I,bindPoint:35866};var p={};p[5126]={size:4,setter:M},p[35664]={size:8,setter:M},p[35665]={size:12,setter:M},p[35666]={size:16,setter:M},p[5124]={size:4,setter:d},p[35667]={size:8,setter:d},p[35668]={size:12,setter:d},p[35669]={size:16,setter:d},p[5125]={size:4,setter:d},p[36294]={size:8,setter:d},p[36295]={size:12,setter:d},p[36296]={size:16,setter:d},p[35670]={size:4,setter:d},p[35671]={size:8,setter:d},p[35672]={size:12,setter:d},p[35673]={size:16,setter:d},p[35674]={size:4,setter:m,count:2},p[35675]={size:9,setter:m,count:3},p[35676]={size:16,setter:m,count:4};var F=/^[ \t]*\n/;function D(A,e,t,n){var i=n||a,r=A.createShader(t),o=0;if(F.test(e)&&(o=1,e=e.replace(F,"")),A.shaderSource(r,e),A.compileShader(r),!A.getShaderParameter(r,A.COMPILE_STATUS)){var s=A.getShaderInfoLog(r);return i(function(A,e){return e=e||0,++e,A.split("\n").map((function(A,t){return t+e+": "+A})).join("\n")}(e,o)+"\n*** Error compiling shader: "+s),A.deleteShader(r),null}return r}function Y(A,e,t){var n;if("function"==typeof e&&(t=e,e=void 0),"function"==typeof A)t=A,A=void 0;else if(A&&!Array.isArray(A)){if(A.errorCallback)return A;var i=A;t=i.errorCallback,A=i.attribLocations,n=i.transformFeedbackVaryings}var r={errorCallback:t||a,transformFeedbackVaryings:n};if(A){var o={};Array.isArray(A)?A.forEach((function(A,t){o[A]=e?e[t]:t})):o=A,r.attribLocations=o}return r}var f=["VERTEX_SHADER","FRAGMENT_SHADER"];function N(A){return A.indexOf("frag")>=0?(void 0).FRAGMENT_SHADER:A.indexOf("vert")>=0?(void 0).VERTEX_SHADER:void 0}function U(A,e){e.forEach((function(e){A.deleteShader(e)}))}function y(A,e,t,n,i){for(var o=Y(t,n,i),s=[],a=[],B=0;B<e.length;++B){var g=e[B];if("string"==typeof g){var E=c(g),Q=E?E.text:g,u=A[f[B]];E&&E.type&&(u=N(E.type)||u),g=D(A,Q,u,o.errorCallback),a.push(g)}r.isShader(A,g)&&s.push(g)}if(s.length!==e.length)return o.errorCallback("not enough shaders for program"),U(A,a),null;var l=A.createProgram();s.forEach((function(e){A.attachShader(l,e)})),o.attribLocations&&Object.keys(o.attribLocations).forEach((function(e){A.bindAttribLocation(l,o.attribLocations[e],e)}));var w=o.transformFeedbackVaryings;if(w&&(w.attribs&&(w=w.attribs),Array.isArray(w)||(w=Object.keys(w)),A.transformFeedbackVaryings(l,w,o.transformFeedbackMode||A.SEPARATE_ATTRIBS)),A.linkProgram(l),!A.getProgramParameter(l,A.LINK_STATUS)){var h=A.getProgramInfoLog(l);return o.errorCallback("Error in program linking:"+h),A.deleteProgram(l),U(A,a),null}return l}function T(A,e,t,n){var i,r=c(e);if(!r)throw"*** Error: unknown script element"+e;i=r.text;var o=t||N(r.type);if(!o)throw"*** Error: unknown shader type";return D(A,i,o,n)}function x(A,e,t,n,i){for(var r=Y(t,n,i),o=[],s=0;s<e.length;++s){var a=D(A,e[s],A[f[s]],r.errorCallback);if(!a)return null;o.push(a)}return y(A,o,r)}function R(A){var e=A.name;return e.startsWith("gl_")||e.startsWith("webgl_")}function G(A,e){var t=0;function n(e,n){var i,r=A.getUniformLocation(e,n.name),o=n.size>1&&"[0]"===n.name.substr(-3),s=n.type,a=g[s];if(!a)throw"unknown type: 0x"+s.toString(16);if(a.bindPoint){var B=t;t+=n.size,i=o?a.arraySetter(A,s,B,r,n.size):a.setter(A,s,B,r,n.size)}else i=a.arraySetter&&o?a.arraySetter(A,r):a.setter(A,r);return i.location=r,i}for(var i={},r=A.getProgramParameter(e,A.ACTIVE_UNIFORMS),o=0;o<r;++o){var s=A.getActiveUniform(e,o);if(!R(s)){var a=s.name;"[0]"===a.substr(-3)&&(a=a.substr(0,a.length-3));var B=n(e,s);i[a]=B}}return i}function S(A,e){for(var t={},n=A.getProgramParameter(e,A.TRANSFORM_FEEDBACK_VARYINGS),i=0;i<n;++i){var r=A.getTransformFeedbackVarying(e,i);t[r.name]={index:i,type:r.type,size:r.size}}return t}function H(A,e,t){for(var n in e.transformFeedbackInfo&&(e=e.transformFeedbackInfo),t.attribs&&(t=t.attribs),t){var i=e[n];if(i){var r=t[n];r.offset?A.bindBufferRange(A.TRANSFORM_FEEDBACK_BUFFER,i.index,r.buffer,r.offset,r.size):A.bindBufferBase(A.TRANSFORM_FEEDBACK_BUFFER,i.index,r.buffer)}}}function b(A,e){for(var t=A.getProgramParameter(e,A.ACTIVE_UNIFORMS),n=[],i=[],r=0;r<t;++r){i.push(r),n.push({});var o=A.getActiveUniform(e,r);if(R(o))break;n[r].name=o.name}[["UNIFORM_TYPE","type"],["UNIFORM_SIZE","size"],["UNIFORM_BLOCK_INDEX","blockNdx"],["UNIFORM_OFFSET","offset"]].forEach((function(t){var r=t[0],o=t[1];A.getActiveUniforms(e,i,A[r]).forEach((function(A,e){n[e][o]=A}))}));for(var s={},a=A.getProgramParameter(e,A.ACTIVE_UNIFORM_BLOCKS),B=0;B<a;++B){var c=A.getActiveUniformBlockName(e,B),g={index:B,usedByVertexShader:A.getActiveUniformBlockParameter(e,B,A.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER),usedByFragmentShader:A.getActiveUniformBlockParameter(e,B,A.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER),size:A.getActiveUniformBlockParameter(e,B,A.UNIFORM_BLOCK_DATA_SIZE),uniformIndices:A.getActiveUniformBlockParameter(e,B,A.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES)};g.used=g.usedByVertexSahder||g.usedByFragmentShader,s[c]=g}return{blockSpecs:s,uniformData:n}}var v=/\[\d+\]\.$/;function k(A,e,t,n){var i=t.blockSpecs,r=t.uniformData,o=i[n];if(!o)return B("no uniform block object named:",n),{name:n,uniforms:{}};var s=new ArrayBuffer(o.size),a=A.createBuffer(),c=o.index;A.bindBuffer(A.UNIFORM_BUFFER,a),A.uniformBlockBinding(e,o.index,c);var E=n+".";v.test(E)&&(E=E.replace(v,"."));var Q={};return o.uniformIndices.forEach((function(A){var e=r[A],t=g[e.type],n=t.Type,i=e.size*t.size,o=e.name;o.substr(0,E.length)===E&&(o=o.substr(E.length)),Q[o]=new n(s,e.offset,i/n.BYTES_PER_ELEMENT)})),{name:n,array:s,asFloat:new Float32Array(s),buffer:a,uniforms:Q}}function j(A,e,t){var n=(e.uniformBlockSpec||e).blockSpecs[t.name];if(n){var i=n.index;return A.bindBufferRange(A.UNIFORM_BUFFER,i,t.buffer,t.offset||0,t.array.byteLength),!0}return!1}function J(A,e){for(var t={},n=A.getProgramParameter(e,A.ACTIVE_ATTRIBUTES),i=0;i<n;++i){var r=A.getActiveAttrib(e,i);if(!R(r)){var o=A.getAttribLocation(e,r.name),s=p[r.type],a=s.setter(A,o,s);a.location=o,t[r.name]=a}}return t}function z(A,e){for(var t in e){var n=A[t];n&&n(e[t])}}function L(A,e){var t={program:e,uniformSetters:G(A,e),attribSetters:J(A,e)};return i.isWebGL2(A)&&(t.uniformBlockSpec=b(A,e),t.transformFeedbackInfo=S(A,e)),t}},function(A,e,t){"use strict";e.__esModule=!0,e.axisRotate=function(A,e,t,n){n=n||new i(16);var r=e[0],o=e[1],s=e[2],a=Math.sqrt(r*r+o*o+s*s),B=(r/=a)*r,c=(o/=a)*o,g=(s/=a)*s,E=Math.cos(t),Q=Math.sin(t),u=1-E,l=B+(1-B)*E,w=r*o*u+s*Q,h=r*s*u-o*Q,C=r*o*u-s*Q,I=c+(1-c)*E,M=o*s*u+r*Q,d=r*s*u+o*Q,m=o*s*u-r*Q,p=g+(1-g)*E,F=A[0],D=A[1],Y=A[2],f=A[3],N=A[4],U=A[5],y=A[6],T=A[7],x=A[8],R=A[9],G=A[10],S=A[11];return n[0]=l*F+w*N+h*x,n[1]=l*D+w*U+h*R,n[2]=l*Y+w*y+h*G,n[3]=l*f+w*T+h*S,n[4]=C*F+I*N+M*x,n[5]=C*D+I*U+M*R,n[6]=C*Y+I*y+M*G,n[7]=C*f+I*T+M*S,n[8]=d*F+m*N+p*x,n[9]=d*D+m*U+p*R,n[10]=d*Y+m*y+p*G,n[11]=d*f+m*T+p*S,A!==n&&(n[12]=A[12],n[13]=A[13],n[14]=A[14],n[15]=A[15]),n},e.axisRotation=function(A,e,t){t=t||new i(16);var n=A[0],r=A[1],o=A[2],s=Math.sqrt(n*n+r*r+o*o),a=(n/=s)*n,B=(r/=s)*r,c=(o/=s)*o,g=Math.cos(e),E=Math.sin(e),Q=1-g;return t[0]=a+(1-a)*g,t[1]=n*r*Q+o*E,t[2]=n*o*Q-r*E,t[3]=0,t[4]=n*r*Q-o*E,t[5]=B+(1-B)*g,t[6]=r*o*Q+n*E,t[7]=0,t[8]=n*o*Q+r*E,t[9]=r*o*Q-n*E,t[10]=c+(1-c)*g,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.copy=a,e.frustum=function(A,e,t,n,r,o,s){s=s||new i(16);var a=e-A,B=n-t,c=r-o;return s[0]=2*r/a,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=2*r/B,s[6]=0,s[7]=0,s[8]=(A+e)/a,s[9]=(n+t)/B,s[10]=o/c,s[11]=-1,s[12]=0,s[13]=0,s[14]=r*o/c,s[15]=0,s},e.getAxis=function(A,e,t){t=t||n.create();var i=4*e;return t[0]=A[i+0],t[1]=A[i+1],t[2]=A[i+2],t},e.getTranslation=function(A,e){return(e=e||n.create())[0]=A[12],e[1]=A[13],e[2]=A[14],e},e.identity=B,e.inverse=c,e.lookAt=function(A,e,t,a){a=a||new i(16);var B=r,c=o,g=s;return n.normalize(n.subtract(A,e,g),g),n.normalize(n.cross(t,g,B),B),n.normalize(n.cross(g,B,c),c),a[0]=B[0],a[1]=B[1],a[2]=B[2],a[3]=0,a[4]=c[0],a[5]=c[1],a[6]=c[2],a[7]=0,a[8]=g[0],a[9]=g[1],a[10]=g[2],a[11]=0,a[12]=A[0],a[13]=A[1],a[14]=A[2],a[15]=1,a},e.multiply=function(A,e,t){t=t||new i(16);var n=A[0],r=A[1],o=A[2],s=A[3],a=A[4],B=A[5],c=A[6],g=A[7],E=A[8],Q=A[9],u=A[10],l=A[11],w=A[12],h=A[13],C=A[14],I=A[15],M=e[0],d=e[1],m=e[2],p=e[3],F=e[4],D=e[5],Y=e[6],f=e[7],N=e[8],U=e[9],y=e[10],T=e[11],x=e[12],R=e[13],G=e[14],S=e[15];return t[0]=n*M+a*d+E*m+w*p,t[1]=r*M+B*d+Q*m+h*p,t[2]=o*M+c*d+u*m+C*p,t[3]=s*M+g*d+l*m+I*p,t[4]=n*F+a*D+E*Y+w*f,t[5]=r*F+B*D+Q*Y+h*f,t[6]=o*F+c*D+u*Y+C*f,t[7]=s*F+g*D+l*Y+I*f,t[8]=n*N+a*U+E*y+w*T,t[9]=r*N+B*U+Q*y+h*T,t[10]=o*N+c*U+u*y+C*T,t[11]=s*N+g*U+l*y+I*T,t[12]=n*x+a*R+E*G+w*S,t[13]=r*x+B*R+Q*G+h*S,t[14]=o*x+c*R+u*G+C*S,t[15]=s*x+g*R+l*G+I*S,t},e.negate=function(A,e){return(e=e||new i(16))[0]=-A[0],e[1]=-A[1],e[2]=-A[2],e[3]=-A[3],e[4]=-A[4],e[5]=-A[5],e[6]=-A[6],e[7]=-A[7],e[8]=-A[8],e[9]=-A[9],e[10]=-A[10],e[11]=-A[11],e[12]=-A[12],e[13]=-A[13],e[14]=-A[14],e[15]=-A[15],e},e.ortho=function(A,e,t,n,r,o,s){return(s=s||new i(16))[0]=2/(e-A),s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=2/(n-t),s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2/(r-o),s[11]=0,s[12]=(e+A)/(A-e),s[13]=(n+t)/(t-n),s[14]=(o+r)/(r-o),s[15]=1,s},e.perspective=function(A,e,t,n,r){r=r||new i(16);var o=Math.tan(.5*Math.PI-.5*A),s=1/(t-n);return r[0]=o/e,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=o,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=(t+n)*s,r[11]=-1,r[12]=0,r[13]=0,r[14]=t*n*s*2,r[15]=0,r},e.rotateX=function(A,e,t){t=t||new i(16);var n=A[4],r=A[5],o=A[6],s=A[7],a=A[8],B=A[9],c=A[10],g=A[11],E=Math.cos(e),Q=Math.sin(e);return t[4]=E*n+Q*a,t[5]=E*r+Q*B,t[6]=E*o+Q*c,t[7]=E*s+Q*g,t[8]=E*a-Q*n,t[9]=E*B-Q*r,t[10]=E*c-Q*o,t[11]=E*g-Q*s,A!==t&&(t[0]=A[0],t[1]=A[1],t[2]=A[2],t[3]=A[3],t[12]=A[12],t[13]=A[13],t[14]=A[14],t[15]=A[15]),t},e.rotateY=function(A,e,t){t=t||new i(16);var n=A[0],r=A[1],o=A[2],s=A[3],a=A[8],B=A[9],c=A[10],g=A[11],E=Math.cos(e),Q=Math.sin(e);return t[0]=E*n-Q*a,t[1]=E*r-Q*B,t[2]=E*o-Q*c,t[3]=E*s-Q*g,t[8]=E*a+Q*n,t[9]=E*B+Q*r,t[10]=E*c+Q*o,t[11]=E*g+Q*s,A!==t&&(t[4]=A[4],t[5]=A[5],t[6]=A[6],t[7]=A[7],t[12]=A[12],t[13]=A[13],t[14]=A[14],t[15]=A[15]),t},e.rotateZ=function(A,e,t){t=t||new i(16);var n=A[0],r=A[1],o=A[2],s=A[3],a=A[4],B=A[5],c=A[6],g=A[7],E=Math.cos(e),Q=Math.sin(e);return t[0]=E*n+Q*a,t[1]=E*r+Q*B,t[2]=E*o+Q*c,t[3]=E*s+Q*g,t[4]=E*a-Q*n,t[5]=E*B-Q*r,t[6]=E*c-Q*o,t[7]=E*g-Q*s,A!==t&&(t[8]=A[8],t[9]=A[9],t[10]=A[10],t[11]=A[11],t[12]=A[12],t[13]=A[13],t[14]=A[14],t[15]=A[15]),t},e.rotationX=function(A,e){e=e||new i(16);var t=Math.cos(A),n=Math.sin(A);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=t,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.rotationY=function(A,e){e=e||new i(16);var t=Math.cos(A),n=Math.sin(A);return e[0]=t,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=t,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.rotationZ=function(A,e){e=e||new i(16);var t=Math.cos(A),n=Math.sin(A);return e[0]=t,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=t,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.scale=function(A,e,t){t=t||new i(16);var n=e[0],r=e[1],o=e[2];return t[0]=n*A[0],t[1]=n*A[1],t[2]=n*A[2],t[3]=n*A[3],t[4]=r*A[4],t[5]=r*A[5],t[6]=r*A[6],t[7]=r*A[7],t[8]=o*A[8],t[9]=o*A[9],t[10]=o*A[10],t[11]=o*A[11],A!==t&&(t[12]=A[12],t[13]=A[13],t[14]=A[14],t[15]=A[15]),t},e.scaling=function(A,e){return(e=e||new i(16))[0]=A[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=A[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=A[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.setAxis=function(A,e,t,n){n!==A&&(n=a(A,n));var i=4*t;return n[i+0]=e[0],n[i+1]=e[1],n[i+2]=e[2],n},e.setDefaultType=function(A){var e=i;return i=A,e},e.setTranslation=function(A,e,t){return t=t||B(),A!==t&&(t[0]=A[0],t[1]=A[1],t[2]=A[2],t[3]=A[3],t[4]=A[4],t[5]=A[5],t[6]=A[6],t[7]=A[7],t[8]=A[8],t[9]=A[9],t[10]=A[10],t[11]=A[11]),t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},e.transformDirection=function(A,e,t){t=t||n.create();var i=e[0],r=e[1],o=e[2];return t[0]=i*A[0]+r*A[4]+o*A[8],t[1]=i*A[1]+r*A[5]+o*A[9],t[2]=i*A[2]+r*A[6]+o*A[10],t},e.transformNormal=function(A,e,t){t=t||n.create();var i=c(A),r=e[0],o=e[1],s=e[2];return t[0]=r*i[0]+o*i[1]+s*i[2],t[1]=r*i[4]+o*i[5]+s*i[6],t[2]=r*i[8]+o*i[9]+s*i[10],t},e.transformPoint=function(A,e,t){t=t||n.create();var i=e[0],r=e[1],o=e[2],s=i*A[3]+r*A[7]+o*A[11]+A[15];return t[0]=(i*A[0]+r*A[4]+o*A[8]+A[12])/s,t[1]=(i*A[1]+r*A[5]+o*A[9]+A[13])/s,t[2]=(i*A[2]+r*A[6]+o*A[10]+A[14])/s,t},e.translate=function(A,e,t){t=t||new i(16);var n=e[0],r=e[1],o=e[2],s=A[0],a=A[1],B=A[2],c=A[3],g=A[4],E=A[5],Q=A[6],u=A[7],l=A[8],w=A[9],h=A[10],C=A[11],I=A[12],M=A[13],d=A[14],m=A[15];return A!==t&&(t[0]=s,t[1]=a,t[2]=B,t[3]=c,t[4]=g,t[5]=E,t[6]=Q,t[7]=u,t[8]=l,t[9]=w,t[10]=h,t[11]=C),t[12]=s*n+g*r+l*o+I,t[13]=a*n+E*r+w*o+M,t[14]=B*n+Q*r+h*o+d,t[15]=c*n+u*r+C*o+m,t},e.translation=function(A,e){return(e=e||new i(16))[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=A[0],e[13]=A[1],e[14]=A[2],e[15]=1,e},e.transpose=function(A,e){var t;if((e=e||new i(16))===A)return t=A[1],A[1]=A[4],A[4]=t,t=A[2],A[2]=A[8],A[8]=t,t=A[3],A[3]=A[12],A[12]=t,t=A[6],A[6]=A[9],A[9]=t,t=A[7],A[7]=A[13],A[13]=t,t=A[11],A[11]=A[14],A[14]=t,e;var n=A[0],r=A[1],o=A[2],s=A[3],a=A[4],B=A[5],c=A[6],g=A[7],E=A[8],Q=A[9],u=A[10],l=A[11],w=A[12],h=A[13],C=A[14],I=A[15];return e[0]=n,e[1]=a,e[2]=E,e[3]=w,e[4]=r,e[5]=B,e[6]=Q,e[7]=h,e[8]=o,e[9]=c,e[10]=u,e[11]=C,e[12]=s,e[13]=g,e[14]=l,e[15]=I,e};var n=function(A){if(A&&A.__esModule)return A;var e={};if(null!=A)for(var t in A)if(Object.prototype.hasOwnProperty.call(A,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(A,t):{};n.get||n.set?Object.defineProperty(e,t,n):e[t]=A[t]}return e.default=A,e}(t(3)),i=Float32Array,r=n.create(),o=n.create(),s=n.create();function a(A,e){return(e=e||new i(16))[0]=A[0],e[1]=A[1],e[2]=A[2],e[3]=A[3],e[4]=A[4],e[5]=A[5],e[6]=A[6],e[7]=A[7],e[8]=A[8],e[9]=A[9],e[10]=A[10],e[11]=A[11],e[12]=A[12],e[13]=A[13],e[14]=A[14],e[15]=A[15],e}function B(A){return(A=A||new i(16))[0]=1,A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=1,A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[10]=1,A[11]=0,A[12]=0,A[13]=0,A[14]=0,A[15]=1,A}function c(A,e){e=e||new i(16);var t=A[0],n=A[1],r=A[2],o=A[3],s=A[4],a=A[5],B=A[6],c=A[7],g=A[8],E=A[9],Q=A[10],u=A[11],l=A[12],w=A[13],h=A[14],C=A[15],I=Q*C,M=h*u,d=B*C,m=h*c,p=B*u,F=Q*c,D=r*C,Y=h*o,f=r*u,N=Q*o,U=r*c,y=B*o,T=g*w,x=l*E,R=s*w,G=l*a,S=s*E,H=g*a,b=t*w,v=l*n,k=t*E,j=g*n,J=t*a,z=s*n,L=I*a+m*E+p*w-(M*a+d*E+F*w),P=M*n+D*E+N*w-(I*n+Y*E+f*w),O=d*n+Y*a+U*w-(m*n+D*a+y*w),V=F*n+f*a+y*E-(p*n+N*a+U*E),W=1/(t*L+s*P+g*O+l*V);return e[0]=W*L,e[1]=W*P,e[2]=W*O,e[3]=W*V,e[4]=W*(M*s+d*g+F*l-(I*s+m*g+p*l)),e[5]=W*(I*t+Y*g+f*l-(M*t+D*g+N*l)),e[6]=W*(m*t+D*s+y*l-(d*t+Y*s+U*l)),e[7]=W*(p*t+N*s+U*g-(F*t+f*s+y*g)),e[8]=W*(T*c+G*u+S*C-(x*c+R*u+H*C)),e[9]=W*(x*o+b*u+j*C-(T*o+v*u+k*C)),e[10]=W*(R*o+v*c+J*C-(G*o+b*c+z*C)),e[11]=W*(H*o+k*c+z*u-(S*o+j*c+J*u)),e[12]=W*(R*Q+H*h+x*B-(S*h+T*B+G*Q)),e[13]=W*(k*h+T*r+v*Q-(b*Q+j*h+x*r)),e[14]=W*(b*B+z*h+G*r-(J*h+R*r+v*B)),e[15]=W*(J*Q+S*r+j*B-(k*B+z*Q+H*r)),e}},function(A,e,t){"use strict";e.__esModule=!0,e.createAttribsFromArrays=w,e.createBuffersFromArrays=function(A,e){var t={};return Object.keys(e).forEach((function(n){t[n]=C(A,e[n],n)})),e.indices?(t.numElements=e.indices.length,t.elementType=n.getGLTypeForTypedArray(l(e.indices),"indices")):t.numElements=function(A){for(var e,t=0;t<h.length&&!((e=h[t])in A);++t);ii===h.length&&(e=Object.keys(A)[0]);var n=A[e],i=c(n).length,r=u(n,e),o=i/r;if(i%r>0)throw"numComponents "+r+" not correct for length "+i;return o}(e),t},e.createBufferFromArray=C,e.createBufferFromTypedArray=a,e.createBufferInfoFromArrays=function(A,e){var t={attribs:w(A,e)},i=e.indices;if(i){var r=l(i,"indices");t.indices=a(A,r,A.ELEMENT_ARRAY_BUFFER),t.numElements=r.length,t.elementType=n.getGLTypeForTypedArray(r)}else t.numElements=function(A,e){var t,n;for(n=0;n<h.length&&!((t=h[n])in e)&&!((t=o.attribPrefix+t)in e);++n);n===h.length&&(t=Object.keys(e)[0]);var i=e[t];A.bindBuffer(A.ARRAY_BUFFER,i.buffer);var r=A.getBufferParameter(A.ARRAY_BUFFER,A.BUFFER_SIZE);A.bindBuffer(A.ARRAY_BUFFER,null);var s=function(A,e){return e===A.BYTE||e===A.UNSIGNED_BYTE?1:e===A.SHORT||e===A.UNSIGNED_SHORT?2:e===A.INT||e===A.UNSIGNED_INT||e===A.FLOAT?4:0}(A,i.type),a=r/s,B=i.numComponents||i.size,c=a/B;if(c%1!=0)throw"numComponents "+B+" not correct for length "+length;return c}(A,t.attribs);return t},e.setAttribInfoBufferFromArray=function(A,e,t,n){t=l(t),void 0!==n?(A.bindBuffer(A.ARRAY_BUFFER,e.buffer),A.bufferSubData(A.ARRAY_BUFFER,n,t)):s(A,A.ARRAY_BUFFER,e.buffer,t,e.drawType)},e.setAttributePrefix=function(A){o.attribPrefix=A},e.setAttributeDefaults_=function(A){i.copyExistingProperties(A,o)},e.getNumComponents_=u,e.getArray_=c;var n=r(t(1)),i=r(t(0));function r(A){if(A&&A.__esModule)return A;var e={};if(null!=A)for(var t in A)if(Object.prototype.hasOwnProperty.call(A,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(A,t):{};n.get||n.set?Object.defineProperty(e,t,n):e[t]=A[t]}return e.default=A,e}var o={attribPrefix:""};function s(A,e,t,n,i){A.bindBuffer(e,t),A.bufferData(e,n,i||A.STATIC_DRAW)}function a(A,e,t,n){if(i.isBuffer(A,e))return e;t=t||A.ARRAY_BUFFER;var r=A.createBuffer();return s(A,t,r,e,n),r}function B(A){return"indices"===A}function c(A){return A.length?A:A.data}var g=/coord|texture/i,E=/color|colour/i;function Q(A,e){var t;if(e%(t=g.test(A)?2:E.test(A)?4:3)>0)throw"Can not guess numComponents for attribute '"+A+"'. Tried "+t+" but "+e+" values is not evenly divisible by "+t+". You should specify it.";return t}function u(A,e){return A.numComponents||A.size||Q(e,c(A).length)}function l(A,e){if(n.isArrayBuffer(A))return A;if(n.isArrayBuffer(A.data))return A.data;Array.isArray(A)&&(A={data:A});var t=A.type;return t||(t=B(e)?Uint16Array:Float32Array),new t(A.data)}function w(A,e){var t={};return Object.keys(e).forEach((function(i){if(!B(i)){var r,s,c,g,E,w=e[i],h=w.attrib||w.name||w.attribName||o.attribPrefix+i;if("number"==typeof w||"number"==typeof w.data){E=w.data||w;var C=w.type||Float32Array,I=E*C.BYTES_PER_ELEMENT;s=n.getGLTypeForTypedArrayType(C),c=void 0!==w.normalize?w.normalize:(d=C)===Int8Array||d===Uint8Array,g=w.numComponents||w.size||Q(i,E),r=A.createBuffer(),A.bindBuffer(A.ARRAY_BUFFER,r),A.bufferData(A.ARRAY_BUFFER,I,w.drawType||A.STATIC_DRAW)}else{var M=l(w,i);r=a(A,M,void 0,w.drawType),s=n.getGLTypeForTypedArray(M),c=void 0!==w.normalize?w.normalize:function(A){return A instanceof Int8Array||A instanceof Uint8Array}(M),g=u(w,i),E=M.length}t[h]={buffer:r,numComponents:g,type:s,normalize:c,stride:w.stride||0,offset:w.offset||0,divisor:void 0===w.divisor?void 0:w.divisor,drawType:w.drawType}}var d})),A.bindBuffer(A.ARRAY_BUFFER,null),t}var h=["position","positions","a_position"];function C(A,e,t){var n="indices"===t?A.ELEMENT_ARRAY_BUFFER:A.ARRAY_BUFFER;return a(A,l(e,t),n)}},function(A,e,t){"use strict";e.__esModule=!0,e.setTextureDefaults_=function(A){o.copyExistingProperties(A,B),A.textureColor&&p(A.textureColor)},e.createSampler=x,e.createSamplers=function(A,e){var t={};return Object.keys(e).forEach((function(n){t[n]=x(A,e[n])})),t},e.setSamplerParameters=T,e.createTexture=W,e.setEmptyTexture=V,e.setTextureFromArray=O,e.loadTextureFromUrl=z,e.setTextureFromElement=b,e.setTextureFilteringForSize=R,e.setTextureParameters=y,e.setDefaultTextureColor=p,e.createTextures=function(A,e,t){t=t||v;var n=0,i=[],r={},o={};function s(){0===n&&setTimeout((function(){t(i.length?i:void 0,r,o)}),0)}return Object.keys(e).forEach((function(t){var a,B,c=e[t];("string"==typeof(B=c.src)||Array.isArray(B)&&"string"==typeof B[0])&&(a=function(A,e,r){o[t]=r,--n,A&&i.push(A),s()},++n),r[t]=W(A,c,a)})),s(),r},e.resizeTexture=function(A,e,t,n,i){n=n||t.width,i=i||t.height;var r=t.target||A.TEXTURE_2D;A.bindTexture(r,e);var o,s=t.level||0,a=t.internalFormat||t.format||A.RGBA,B=I(a),g=t.format||B.format,E=t.src;if(o=E&&(c(E)||Array.isArray(E)&&"number"==typeof E[0])?t.type||d(A,E,B.type):t.type||B.type,r===A.TEXTURE_CUBE_MAP)for(var Q=0;Q<6;++Q)A.texImage2D(A.TEXTURE_CUBE_MAP_POSITIVE_X+Q,s,a,n,i,0,g,o,null);else A.texImage2D(r,s,a,n,i,0,g,o,null)},e.getNumComponentsForFormat=function(A){var e=u[A];if(!e)throw"unknown format: "+A;return e.numColorComponents},e.getBytesPerElementForInternalFormat=C;var n,i=a(t(4)),r=a(t(1)),o=a(t(0)),s=(n=t(2))&&n.__esModule?n:{default:n};function a(A){if(A&&A.__esModule)return A;var e={};if(null!=A)for(var t in A)if(Object.prototype.hasOwnProperty.call(A,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(A,t):{};n.get||n.set?Object.defineProperty(e,t,n):e[t]=A[t]}return e.default=A,e}var B={textureColor:new Uint8Array([128,192,255,255]),textureOptions:{},crossOrigin:void 0},c=r.isArrayBuffer,g=s.default.document&&s.default.document.createElement?s.default.document.createElement("canvas").getContext("2d"):null,E=6407,Q=33319,u={},l=u;l[6406]={numColorComponents:1},l[6409]={numColorComponents:1},l[6410]={numColorComponents:2},l[E]={numColorComponents:3},l[6408]={numColorComponents:4},l[6403]={numColorComponents:1},l[36244]={numColorComponents:1},l[Q]={numColorComponents:2},l[33320]={numColorComponents:2},l[E]={numColorComponents:3},l[36248]={numColorComponents:3},l[6408]={numColorComponents:4},l[36249]={numColorComponents:4},l[6402]={numColorComponents:1},l[34041]={numColorComponents:2};var w={},h=w;function C(A,e){var t=w[A];if(!t)throw"unknown internal format";var n=t.bytesPerElementMap[e];if(void 0===n)throw"unknown internal format";return n}function I(A){var e=w[A];if(!e)throw"unknown internal format";return{format:e.textureFormat,type:Array.isArray(e.type)?e.type[0]:e.type}}function M(A){return 0==(A&A-1)}function d(A,e,t){return c(e)?r.getGLTypeForTypedArray(e):t||A.UNSIGNED_BYTE}function m(A,e,t,n,i){if(i%1!=0)throw"can't guess dimensions";if(t||n){if(n){if(!t&&(t=i/n)%1)throw"can't guess dimensions"}else if((n=i/t)%1)throw"can't guess dimensions"}else{var r=Math.sqrt(i/(e===A.TEXTURE_CUBE_MAP?6:1));r%1==0?(t=r,n=r):(t=i,n=1)}return{width:t,height:n}}function p(A){B.textureColor=new Uint8Array([255*A[0],255*A[1],255*A[2],255*A[3]])}h[6406]={textureFormat:6406,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[5121,5131,36193,5126]},h[6409]={textureFormat:6409,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[5121,5131,36193,5126]},h[6410]={textureFormat:6410,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2,4,4,8],type:[5121,5131,36193,5126]},h[E]={textureFormat:E,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,6,6,12,2],type:[5121,5131,36193,5126,33635]},h[6408]={textureFormat:6408,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,8,8,16,2,2],type:[5121,5131,36193,5126,32819,32820]},h[33321]={textureFormat:6403,colorRenderable:!0,textureFilterable:!0,bytesPerElement:1,type:5121},h[36756]={textureFormat:6403,colorRenderable:!1,textureFilterable:!0,bytesPerElement:1,type:5120},h[33325]={textureFormat:6403,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4,2],type:[5126,5131]},h[33326]={textureFormat:6403,colorRenderable:!1,textureFilterable:!1,bytesPerElement:4,type:5126},h[33330]={textureFormat:36244,colorRenderable:!0,textureFilterable:!1,bytesPerElement:1,type:5121},h[33329]={textureFormat:36244,colorRenderable:!0,textureFilterable:!1,bytesPerElement:1,type:5120},h[33332]={textureFormat:36244,colorRenderable:!0,textureFilterable:!1,bytesPerElement:2,type:5123},h[33331]={textureFormat:36244,colorRenderable:!0,textureFilterable:!1,bytesPerElement:2,type:5122},h[33334]={textureFormat:36244,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:5125},h[33333]={textureFormat:36244,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:5124},h[33323]={textureFormat:Q,colorRenderable:!0,textureFilterable:!0,bytesPerElement:2,type:5121},h[36757]={textureFormat:Q,colorRenderable:!1,textureFilterable:!0,bytesPerElement:2,type:5120},h[33327]={textureFormat:Q,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[8,4],type:[5126,5131]},h[33328]={textureFormat:Q,colorRenderable:!1,textureFilterable:!1,bytesPerElement:8,type:5126},h[33336]={textureFormat:33320,colorRenderable:!0,textureFilterable:!1,bytesPerElement:2,type:5121},h[33335]={textureFormat:33320,colorRenderable:!0,textureFilterable:!1,bytesPerElement:2,type:5120},h[33338]={textureFormat:33320,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:5123},h[33337]={textureFormat:33320,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:5122},h[33340]={textureFormat:33320,colorRenderable:!0,textureFilterable:!1,bytesPerElement:8,type:5125},h[33339]={textureFormat:33320,colorRenderable:!0,textureFilterable:!1,bytesPerElement:8,type:5124},h[32849]={textureFormat:E,colorRenderable:!0,textureFilterable:!0,bytesPerElement:3,type:5121},h[35905]={textureFormat:E,colorRenderable:!1,textureFilterable:!0,bytesPerElement:3,type:5121},h[36194]={textureFormat:E,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,2],type:[5121,33635]},h[36758]={textureFormat:E,colorRenderable:!1,textureFilterable:!0,bytesPerElement:3,type:5120},h[35898]={textureFormat:E,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[5126,5131,35899]},h[35901]={textureFormat:E,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[5126,5131,35902]},h[34843]={textureFormat:E,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6],type:[5126,5131]},h[34837]={textureFormat:E,colorRenderable:!1,textureFilterable:!1,bytesPerElement:12,type:5126},h[36221]={textureFormat:36248,colorRenderable:!1,textureFilterable:!1,bytesPerElement:3,type:5121},h[36239]={textureFormat:36248,colorRenderable:!1,textureFilterable:!1,bytesPerElement:3,type:5120},h[36215]={textureFormat:36248,colorRenderable:!1,textureFilterable:!1,bytesPerElement:6,type:5123},h[36233]={textureFormat:36248,colorRenderable:!1,textureFilterable:!1,bytesPerElement:6,type:5122},h[36209]={textureFormat:36248,colorRenderable:!1,textureFilterable:!1,bytesPerElement:12,type:5125},h[36227]={textureFormat:36248,colorRenderable:!1,textureFilterable:!1,bytesPerElement:12,type:5124},h[32856]={textureFormat:6408,colorRenderable:!0,textureFilterable:!0,bytesPerElement:4,type:5121},h[35907]={textureFormat:6408,colorRenderable:!0,textureFilterable:!0,bytesPerElement:4,type:5121},h[36759]={textureFormat:6408,colorRenderable:!1,textureFilterable:!0,bytesPerElement:4,type:5120},h[32855]={textureFormat:6408,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2,4],type:[5121,32820,33640]},h[32854]={textureFormat:6408,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2],type:[5121,32819]},h[32857]={textureFormat:6408,colorRenderable:!0,textureFilterable:!0,bytesPerElement:4,type:33640},h[34842]={textureFormat:6408,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[16,8],type:[5126,5131]},h[34836]={textureFormat:6408,colorRenderable:!1,textureFilterable:!1,bytesPerElement:16,type:5126},h[36220]={textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:5121},h[36238]={textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:5120},h[36975]={textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:33640},h[36214]={textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:8,type:5123},h[36232]={textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:8,type:5122},h[36226]={textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:16,type:5124},h[36208]={textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:16,type:5125},h[33189]={textureFormat:6402,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[5123,5125]},h[33190]={textureFormat:6402,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:5125},h[36012]={textureFormat:6402,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:5126},h[35056]={textureFormat:34041,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:34042},h[36013]={textureFormat:34041,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:36269},Object.keys(h).forEach((function(A){var e=h[A];if(e.bytesPerElementMap={},Array.isArray(e.bytesPerElement))e.bytesPerElement.forEach((function(A,t){var n=e.type[t];e.bytesPerElementMap[n]=A}));else{var t=e.type;e.bytesPerElementMap[t]=e.bytesPerElement}}));var F={};function D(A,e){void 0!==e.colorspaceConversion&&(F.colorspaceConversion=A.getParameter(A.UNPACK_COLORSPACE_CONVERSION_WEBGL),A.pixelStorei(A.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.colorspaceConversion)),void 0!==e.premultiplyAlpha&&(F.premultiplyAlpha=A.getParameter(A.UNPACK_PREMULTIPLY_ALPHA_WEBGL),A.pixelStorei(A.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha)),void 0!==e.flipY&&(F.flipY=A.getParameter(A.UNPACK_FLIP_Y_WEBGL),A.pixelStorei(A.UNPACK_FLIP_Y_WEBGL,e.flipY))}function Y(A,e){void 0!==e.colorspaceConversion&&A.pixelStorei(A.UNPACK_COLORSPACE_CONVERSION_WEBGL,F.colorspaceConversion),void 0!==e.premultiplyAlpha&&A.pixelStorei(A.UNPACK_PREMULTIPLY_ALPHA_WEBGL,F.premultiplyAlpha),void 0!==e.flipY&&A.pixelStorei(A.UNPACK_FLIP_Y_WEBGL,F.flipY)}function f(A){F.unpackAlignment=A.getParameter(A.UNPACK_ALIGNMENT),i.isWebGL2(A)&&(F.unpackRowLength=A.getParameter(A.UNPACK_ROW_LENGTH),F.unpackImageHeight=A.getParameter(A.UNPACK_IMAGE_HEIGHT),F.unpackSkipPixels=A.getParameter(A.UNPACK_SKIP_PIXELS),F.unpackSkipRows=A.getParameter(A.UNPACK_SKIP_ROWS),F.unpackSkipImages=A.getParameter(A.UNPACK_SKIP_IMAGES))}function N(A){A.pixelStorei(A.UNPACK_ALIGNMENT,F.unpackAlignment),i.isWebGL2(A)&&(A.pixelStorei(A.UNPACK_ROW_LENGTH,F.unpackRowLength),A.pixelStorei(A.UNPACK_IMAGE_HEIGHT,F.unpackImageHeight),A.pixelStorei(A.UNPACK_SKIP_PIXELS,F.unpackSkipPixels),A.pixelStorei(A.UNPACK_SKIP_ROWS,F.unpackSkipRows),A.pixelStorei(A.UNPACK_SKIP_IMAGES,F.unpackSkipImages))}function U(A,e,t,n){n.minMag&&(t.call(A,e,A.TEXTURE_MIN_FILTER,n.minMag),t.call(A,e,A.TEXTURE_MAG_FILTER,n.minMag)),n.min&&t.call(A,e,A.TEXTURE_MIN_FILTER,n.min),n.mag&&t.call(A,e,A.TEXTURE_MAG_FILTER,n.mag),n.wrap&&(t.call(A,e,A.TEXTURE_WRAP_S,n.wrap),t.call(A,e,A.TEXTURE_WRAP_T,n.wrap),(e===A.TEXTURE_3D||o.isSampler(A,e))&&t.call(A,e,A.TEXTURE_WRAP_R,n.wrap)),n.wrapR&&t.call(A,e,A.TEXTURE_WRAP_R,n.wrapR),n.wrapS&&t.call(A,e,A.TEXTURE_WRAP_S,n.wrapS),n.wrapT&&t.call(A,e,A.TEXTURE_WRAP_T,n.wrapT),n.minLod&&t.call(A,e,A.TEXTURE_MIN_LOD,n.minLod),n.maxLod&&t.call(A,e,A.TEXTURE_MAX_LOD,n.maxLod),n.baseLevel&&t.call(A,e,A.TEXTURE_BASE_LEVEL,n.baseLevel),n.maxLevel&&t.call(A,e,A.TEXTURE_MAX_LEVEL,n.maxLevel)}function y(A,e,t){var n=t.target||A.TEXTURE_2D;A.bindTexture(n,e),U(A,n,A.texParameteri,t)}function T(A,e,t){U(A,e,A.samplerParameteri,t)}function x(A,e){var t=A.createSampler();return T(A,t,e),t}function R(A,e,t,n,r,o,s){t=t||B.textureOptions,o=o||A.RGBA,s=s||A.UNSIGNED_BYTE;var a=t.target||A.TEXTURE_2D;if(n=n||t.width,r=r||t.height,A.bindTexture(a,e),function(A,e,t,n){if(!i.isWebGL2(A))return M(e)&&M(t);var r=w[n];if(!r)throw"unknown internal format";return r.colorRenderable&&r.textureFilterable}(A,n,r,o))A.generateMipmap(a);else{var c=function(A){var e=w[A];if(!e)throw"unknown internal format";return e.textureFilterable}(o)?A.LINEAR:A.NEAREST;A.texParameteri(a,A.TEXTURE_MIN_FILTER,c),A.texParameteri(a,A.TEXTURE_MAG_FILTER,c),A.texParameteri(a,A.TEXTURE_WRAP_S,A.CLAMP_TO_EDGE),A.texParameteri(a,A.TEXTURE_WRAP_T,A.CLAMP_TO_EDGE)}}function G(A){return!0===A.auto||void 0===A.auto&&void 0===A.level}function S(A,e){return(e=e||{}).cubeFaceOrder||[A.TEXTURE_CUBE_MAP_POSITIVE_X,A.TEXTURE_CUBE_MAP_NEGATIVE_X,A.TEXTURE_CUBE_MAP_POSITIVE_Y,A.TEXTURE_CUBE_MAP_NEGATIVE_Y,A.TEXTURE_CUBE_MAP_POSITIVE_Z,A.TEXTURE_CUBE_MAP_NEGATIVE_Z]}function H(A,e){var t=S(A,e).map((function(A,e){return{face:A,ndx:e}}));return t.sort((function(A,e){return A.face-e.face})),t}function b(A,e,t,n){var i=(n=n||B.textureOptions).target||A.TEXTURE_2D,r=n.level||0,o=t.width,a=t.height,c=n.internalFormat||n.format||A.RGBA,E=I(c),Q=n.format||E.format,u=n.type||E.type;if(D(A,n),A.bindTexture(i,e),i===A.TEXTURE_CUBE_MAP){var l,w,h=t.width,C=t.height;if(h/6===C)l=C,w=[0,0,1,0,2,0,3,0,4,0,5,0];else if(C/6===h)l=h,w=[0,0,0,1,0,2,0,3,0,4,0,5];else if(h/3==C/2)l=h/3,w=[0,0,1,0,2,0,0,1,1,1,2,1];else{if(h/2!=C/3)throw"can't figure out cube map from element: "+(t.src?t.src:t.nodeName);l=h/2,w=[0,0,1,0,0,1,1,1,0,2,1,2]}g?(g.canvas.width=l,g.canvas.height=l,o=l,a=l,H(A,n).forEach((function(e){var n=w[2*e.ndx+0]*l,i=w[2*e.ndx+1]*l;g.drawImage(t,n,i,l,l,0,0,l,l),A.texImage2D(e.face,r,c,Q,u,g.canvas)})),g.canvas.width=1,g.canvas.height=1):s.default.createImageBitmap&&(o=l,a=l,H(A,n).forEach((function(B){var g=w[2*B.ndx+0]*l,E=w[2*B.ndx+1]*l;A.texImage2D(B.face,r,c,l,l,0,Q,u,null),s.default.createImageBitmap(t,g,E,l,l,{premultiplyAlpha:"none",colorSpaceConversion:"none"}).then((function(t){D(A,n),A.bindTexture(i,e),A.texImage2D(B.face,r,c,Q,u,t),Y(A,n),G(n)&&R(A,e,n,o,a,c,u)}))})))}else if(i===A.TEXTURE_3D||i===A.TEXTURE_2D_ARRAY){var M=Math.min(t.width,t.height),d=Math.max(t.width,t.height),m=d/M;if(m%1!=0)throw"can not compute 3D dimensions of element";var p=t.width===d?1:0,F=t.height===d?1:0;f(A),A.pixelStorei(A.UNPACK_ALIGNMENT,1),A.pixelStorei(A.UNPACK_ROW_LENGTH,t.width),A.pixelStorei(A.UNPACK_IMAGE_HEIGHT,0),A.pixelStorei(A.UNPACK_SKIP_IMAGES,0),A.texImage3D(i,r,c,M,M,M,0,Q,u,null);for(var U=0;U<m;++U){var T=U*M*p,x=U*M*F;A.pixelStorei(A.UNPACK_SKIP_PIXELS,T),A.pixelStorei(A.UNPACK_SKIP_ROWS,x),A.texSubImage3D(i,r,0,0,U,M,M,1,Q,u,t)}N(A)}else A.texImage2D(i,r,c,Q,u,t);Y(A,n),G(n)&&R(A,e,n,o,a,c,u),y(A,e,n)}function v(){}function k(A){return s.default.ImageBitmap&&A instanceof s.default.ImageBitmap||s.default.ImageData&&A instanceof s.default.ImageData||s.default.HTMLElement&&A instanceof s.default.HTMLElement}function j(A,e,t){return k(A)?(setTimeout((function(){t(null,A)})),A):function(A,e,t){var n;if(t=t||v,s.default.Image){n=new s.default.Image,void 0!==(e=void 0!==e?e:B.crossOrigin)&&(n.crossOrigin=e);var i=function(){n.removeEventListener("error",r),n.removeEventListener("load",a),n=null},r=function(){var e="couldn't load image: "+A;o.error(e),t(e,n),i()},a=function(){t(null,n),i()};return n.addEventListener("error",r),n.addEventListener("load",a),n.src=A,n}if(s.default.ImageBitmap){var c,g,E=function(){t(c,g)},Q={};e&&(Q.mode="cors"),fetch(A,Q).then((function(A){if(!A.ok)throw A;return A.blob()})).then((function(A){return s.default.createImageBitmap(A,{premultiplyAlpha:"none",colorSpaceConversion:"none"})})).then((function(A){g=A,setTimeout(E)})).catch((function(A){c=A,setTimeout(E)})),n=null}return n}(A,e,t)}function J(A,e,t){var n=(t=t||B.textureOptions).target||A.TEXTURE_2D;if(A.bindTexture(n,e),!1!==t.color){var i=function(A){return A=A||B.textureColor,c(A)?A:new Uint8Array([255*A[0],255*A[1],255*A[2],255*A[3]])}(t.color);if(n===A.TEXTURE_CUBE_MAP)for(var r=0;r<6;++r)A.texImage2D(A.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,A.RGBA,1,1,0,A.RGBA,A.UNSIGNED_BYTE,i);else n===A.TEXTURE_3D||n===A.TEXTURE_2D_ARRAY?A.texImage3D(n,0,A.RGBA,1,1,1,0,A.RGBA,A.UNSIGNED_BYTE,i):A.texImage2D(n,0,A.RGBA,1,1,0,A.RGBA,A.UNSIGNED_BYTE,i)}}function z(A,e,t,n){return n=n||v,t=t||B.textureOptions,J(A,e,t),j((t=Object.assign({},t)).src,t.crossOrigin,(function(i,r){i?n(i,e,r):(b(A,e,r,t),n(null,e,r))}))}function L(A,e,t,n){n=n||v;var i=t.src;if(6!==i.length)throw"there must be 6 urls for a cubemap";var r=t.level||0,o=t.internalFormat||t.format||A.RGBA,s=I(o),a=t.format||s.format,B=t.type||A.UNSIGNED_BYTE,c=t.target||A.TEXTURE_2D;if(c!==A.TEXTURE_CUBE_MAP)throw"target must be TEXTURE_CUBE_MAP";J(A,e,t),t=Object.assign({},t);var g,E=6,Q=[],u=S(A,t);g=i.map((function(i,s){return j(i,t.crossOrigin,(l=u[s],function(i,s){--E,i?Q.push(i):s.width!==s.height?Q.push("cubemap face img is not a square: "+s.src):(D(A,t),A.bindTexture(c,e),5===E?S(A).forEach((function(e){A.texImage2D(e,r,o,a,B,s)})):A.texImage2D(l,r,o,a,B,s),Y(A,t),G(t)&&A.generateMipmap(c)),0===E&&n(Q.length?Q:void 0,e,g)}));var l}))}function P(A,e,t,n){n=n||v;var i=t.src,r=t.internalFormat||t.format||A.RGBA,o=I(r),s=t.format||o.format,a=t.type||A.UNSIGNED_BYTE,B=t.target||A.TEXTURE_2D_ARRAY;if(B!==A.TEXTURE_3D&&B!==A.TEXTURE_2D_ARRAY)throw"target must be TEXTURE_3D or TEXTURE_2D_ARRAY";J(A,e,t),t=Object.assign({},t);var c,E=i.length,Q=[],u=t.level||0,l=t.width,w=t.height,h=i.length,C=!0;c=i.map((function(i,o){return j(i,t.crossOrigin,(I=o,function(i,o){if(--E,i)Q.push(i);else{if(D(A,t),A.bindTexture(B,e),C){C=!1,l=t.width||o.width,w=t.height||o.height,A.texImage3D(B,u,r,l,w,h,0,s,a,null);for(var M=0;M<h;++M)A.texSubImage3D(B,u,0,0,M,l,w,1,s,a,o)}else{var d=o;o.width===l&&o.height===w||(d=g.canvas,g.canvas.width=l,g.canvas.height=w,g.drawImage(o,0,0,l,w)),A.texSubImage3D(B,u,0,0,I,l,w,1,s,a,d),d===g.canvas&&(g.canvas.width=0,g.canvas.height=0)}Y(A,t),G(t)&&A.generateMipmap(B)}0===E&&n(Q.length?Q:void 0,e,c)}));var I}))}function O(A,e,t,n){var o=(n=n||B.textureOptions).target||A.TEXTURE_2D;A.bindTexture(o,e);var s=n.width,a=n.height,g=n.depth,E=n.level||0,Q=n.internalFormat||n.format||A.RGBA,u=I(Q),l=n.format||u.format,w=n.type||d(A,t,u.type);if(c(t))t instanceof Uint8ClampedArray&&(t=new Uint8Array(t.buffer));else{var h=r.getTypedArrayTypeForGLType(w);t=new h(t)}var M,p=C(Q,w),F=t.byteLength/p;if(F%1)throw"length wrong size for format: "+i.glEnumToString(A,l);if(o===A.TEXTURE_3D)if(s||a||g)!s||a&&g?!a||s&&g?(M=m(A,o,s,a,F/g),s=M.width,a=M.height):(M=m(A,o,s,g,F/a),s=M.width,g=M.height):(M=m(A,o,a,g,F/s),a=M.width,g=M.height);else{var U=Math.cbrt(F);if(U%1!=0)throw"can't guess cube size of array of numElements: "+F;s=U,a=U,g=U}else M=m(A,o,s,a,F),s=M.width,a=M.height;if(f(A),A.pixelStorei(A.UNPACK_ALIGNMENT,n.unpackAlignment||1),D(A,n),o===A.TEXTURE_CUBE_MAP){var y=F/6*(p/t.BYTES_PER_ELEMENT);H(A,n).forEach((function(e){var n=y*e.ndx,i=t.subarray(n,n+y);A.texImage2D(e.face,E,Q,s,a,0,l,w,i)}))}else o===A.TEXTURE_3D?A.texImage3D(o,E,Q,s,a,g,0,l,w,t):A.texImage2D(o,E,Q,s,a,0,l,w,t);return Y(A,n),N(A),{width:s,height:a,depth:g,type:w}}function V(A,e,t){var n=t.target||A.TEXTURE_2D;A.bindTexture(n,e);var i=t.level||0,r=t.internalFormat||t.format||A.RGBA,o=I(r),s=t.format||o.format,a=t.type||o.type;if(D(A,t),n===A.TEXTURE_CUBE_MAP)for(var B=0;B<6;++B)A.texImage2D(A.TEXTURE_CUBE_MAP_POSITIVE_X+B,i,r,t.width,t.height,0,s,a,null);else n===A.TEXTURE_3D?A.texImage3D(n,i,r,t.width,t.height,t.depth,0,s,a,null):A.texImage2D(n,i,r,t.width,t.height,0,s,a,null);Y(A,t)}function W(A,e,t){t=t||v,e=e||B.textureOptions;var n=A.createTexture(),i=e.target||A.TEXTURE_2D,r=e.width||1,o=e.height||1,s=e.internalFormat||A.RGBA,a=I(s),g=e.type||a.type;A.bindTexture(i,n),i===A.TEXTURE_CUBE_MAP&&(A.texParameteri(i,A.TEXTURE_WRAP_S,A.CLAMP_TO_EDGE),A.texParameteri(i,A.TEXTURE_WRAP_T,A.CLAMP_TO_EDGE));var E=e.src;if(E)if("function"==typeof E&&(E=E(A,e)),"string"==typeof E)z(A,n,e,t);else if(c(E)||Array.isArray(E)&&("number"==typeof E[0]||Array.isArray(E[0])||c(E[0]))){var Q=O(A,n,E,e);r=Q.width,o=Q.height,g=Q.type}else if(Array.isArray(E)&&("string"==typeof E[0]||k(E[0])))i===A.TEXTURE_CUBE_MAP?L(A,n,e,t):P(A,n,e,t);else{if(!k(E))throw"unsupported src type";b(A,n,E,e),r=E.width,o=E.height}else V(A,n,e);return G(e)&&R(A,n,e,r,o,s,g),y(A,n,e),n}},function(A,e,t){"use strict";e.__esModule=!0;var n={m4:!0,v3:!0,primitives:!0};e.primitives=e.v3=e.m4=void 0;var i=a(t(6));e.m4=i;var r=a(t(3));e.v3=r;var o=a(t(10));e.primitives=o;var s=t(11);function a(A){if(A&&A.__esModule)return A;var e={};if(null!=A)for(var t in A)if(Object.prototype.hasOwnProperty.call(A,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(A,t):{};n.get||n.set?Object.defineProperty(e,t,n):e[t]=A[t]}return e.default=A,e}Object.keys(s).forEach((function(A){"default"!==A&&"__esModule"!==A&&(Object.prototype.hasOwnProperty.call(n,A)||(e[A]=s[A]))}))},function(A,e,t){"use strict";e.__esModule=!0,e.create3DFVertices=f,e.createAugmentedTypedArray=E,e.createCubeVertices=F,e.createPlaneVertices=d,e.createSphereVertices=m,e.createTruncatedConeVertices=D,e.createXYQuadVertices=M,e.createCresentVertices=N,e.createCylinderVertices=U,e.createTorusVertices=y,e.createDiscVertices=T,e.deindexVertices=function(A){var e=A.indices,t={},n=e.length;return Object.keys(A).filter(Q).forEach((function(i){for(var r=A[i],o=r.numComponents,s=E(o,n,r.constructor),a=0;a<n;++a)for(var B=e[a]*o,c=0;c<o;++c)s.push(r[B+c]);t[i]=s})),t},e.flattenNormals=function(A){if(A.indices)throw"can't flatten normals of indexed vertices. deindex them first";for(var e=A.normal,t=e.length,n=0;n<t;n+=9){var i=e[n+0],r=e[n+1],o=e[n+2],s=e[n+3],a=e[n+4],B=e[n+5],c=e[n+6],g=e[n+7],E=e[n+8],Q=i+s+c,u=r+a+g,l=o+B+E,w=Math.sqrt(Q*Q+u*u+l*l);Q/=w,u/=w,l/=w,e[n+0]=Q,e[n+1]=u,e[n+2]=l,e[n+3]=Q,e[n+4]=u,e[n+5]=l,e[n+6]=Q,e[n+7]=u,e[n+8]=l}return A},e.makeRandomVertexColors=function(A,e){e=e||{};var t=A.position.numElements,n=E(4,t,Uint8Array),i=e.rand||function(A,e){return e<3?(t=256,Math.random()*t|0):255;var t};if(A.color=n,A.indices)for(var r=0;r<t;++r)n.push(i(r,0),i(r,1),i(r,2),i(r,3));else for(var o=e.vertsPerColor||3,s=t/o,a=0;a<s;++a)for(var B=[i(a,0),i(a,1),i(a,2),i(a,3)],c=0;c<o;++c)n.push(B);return A},e.reorientDirections=w,e.reorientNormals=h,e.reorientPositions=C,e.reorientVertices=I,e.concatVertices=function(A){for(var e,t={},n=function(n){var i=A[n];Object.keys(i).forEach((function(A){t[A]||(t[A]=[]),e||"indices"===A||(e=A);var n=i[A],r=c(n,A),o=B(n).length/r;t[A].push(o)}))},i=0;i<A.length;++i)n(i);var r=t[e],o={};return Object.keys(t).forEach((function(e){var t=function(e){for(var t,n=0,i=0;i<A.length;++i){var r=A[i][e],o=B(r);n+=o.length,t&&!r.data||(t=r)}return{length:n,spec:t}}(e),n=H(t.spec,t.length);!function(e,t,n){for(var i=0,r=0,o=0;o<A.length;++o){var s=A[o][e],a=B(s);"indices"===e?(S(a,n,r,i),i+=t[o]):S(a,n,r),r+=a.length}}(e,r,B(n)),o[e]=n})),o},e.duplicateVertices=function(A){var e={};return Object.keys(A).forEach((function(t){var n=A[t],i=B(n),r=H(n,i.length);S(i,B(r),0),e[t]=r})),e},e.createDiscBuffers=e.createDiscBufferInfo=e.createTorusBuffers=e.createTorusBufferInfo=e.createCylinderBuffers=e.createCylinderBufferInfo=e.createCresentBuffers=e.createCresentBufferInfo=e.createXYQuadBuffers=e.createXYQuadBufferInfo=e.createTruncatedConeBuffers=e.createTruncatedConeBufferInfo=e.createSphereBuffers=e.createSphereBufferInfo=e.createPlaneBuffers=e.createPlaneBufferInfo=e.createCubeBuffers=e.createCubeBufferInfo=e.create3DFBuffers=e.create3DFBufferInfo=void 0;var n=a(t(7)),i=a(t(0)),r=a(t(1)),o=a(t(6)),s=a(t(3));function a(A){if(A&&A.__esModule)return A;var e={};if(null!=A)for(var t in A)if(Object.prototype.hasOwnProperty.call(A,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(A,t):{};n.get||n.set?Object.defineProperty(e,t,n):e[t]=A[t]}return e.default=A,e}var B=n.getArray_,c=n.getNumComponents_;function g(A,e){var t=0;return A.push=function(){for(var e=0;e<arguments.length;++e){var n=arguments[e];if(n instanceof Array||r.isArrayBuffer(n))for(var i=0;i<n.length;++i)A[t++]=n[i];else A[t++]=n}},A.reset=function(A){t=A||0},A.numComponents=e,Object.defineProperty(A,"numElements",{get:function(){return this.length/this.numComponents|0}}),A}function E(A,e,t){return g(new(t||Float32Array)(A*e),A)}function Q(A){return"indices"!==A}function u(A,e,t){for(var n=A.length,i=new Float32Array(3),r=0;r<n;r+=3)t(e,[A[r],A[r+1],A[r+2]],i),A[r]=i[0],A[r+1]=i[1],A[r+2]=i[2]}function l(A,e,t){t=t||s.create();var n=e[0],i=e[1],r=e[2];return t[0]=n*A[0]+i*A[1]+r*A[2],t[1]=n*A[4]+i*A[5]+r*A[6],t[2]=n*A[8]+i*A[9]+r*A[10],t}function w(A,e){return u(A,e,o.transformDirection),A}function h(A,e){return u(A,o.inverse(e),l),A}function C(A,e){return u(A,e,o.transformPoint),A}function I(A,e){return Object.keys(A).forEach((function(t){var n=A[t];t.indexOf("pos")>=0?C(n,e):t.indexOf("tan")>=0||t.indexOf("binorm")>=0?w(n,e):t.indexOf("norm")>=0&&h(n,e)})),A}function M(A,e,t){return A=A||2,{position:{numComponents:2,data:[(e=e||0)+-1*(A*=.5),(t=t||0)+-1*A,e+1*A,t+-1*A,e+-1*A,t+1*A,e+1*A,t+1*A]},normal:[0,0,1,0,0,1,0,0,1,0,0,1],texcoord:[0,0,1,0,0,1,1,1],indices:[0,1,2,2,1,3]}}function d(A,e,t,n,i){A=A||1,e=e||1,t=t||1,n=n||1,i=i||o.identity();for(var r=(t+1)*(n+1),s=E(3,r),a=E(3,r),B=E(2,r),c=0;c<=n;c++)for(var g=0;g<=t;g++){var Q=g/t,u=c/n;s.push(A*Q-.5*A,0,e*u-.5*e),a.push(0,1,0),B.push(Q,u)}for(var l=t+1,w=E(3,t*n*2,Uint16Array),h=0;h<n;h++)for(var C=0;C<t;C++)w.push((h+0)*l+C,(h+1)*l+C,(h+0)*l+C+1),w.push((h+1)*l+C,(h+1)*l+C+1,(h+0)*l+C+1);return I({position:s,normal:a,texcoord:B,indices:w},i)}function m(A,e,t,n,i,r,o){if(e<=0||t<=0)throw Error("subdivisionAxis and subdivisionHeight must be > 0");n=n||0,r=r||0;for(var s=(i=i||Math.PI)-n,a=(o=o||2*Math.PI)-r,B=(e+1)*(t+1),c=E(3,B),g=E(3,B),Q=E(2,B),u=0;u<=t;u++)for(var l=0;l<=e;l++){var w=l/e,h=u/t,C=a*w,I=s*h,M=Math.sin(C),d=Math.cos(C),m=Math.sin(I),p=d*m,F=Math.cos(I),D=M*m;c.push(A*p,A*F,A*D),g.push(p,F,D),Q.push(1-w,h)}for(var Y=e+1,f=E(3,e*t*2,Uint16Array),N=0;N<e;N++)for(var U=0;U<t;U++)f.push((U+0)*Y+N,(U+0)*Y+N+1,(U+1)*Y+N),f.push((U+1)*Y+N,(U+0)*Y+N+1,(U+1)*Y+N+1);return{position:c,normal:g,texcoord:Q,indices:f}}var p=[[3,7,5,1],[6,2,0,4],[6,7,3,2],[0,1,5,4],[7,6,4,5],[2,3,1,0]];function F(A){for(var e=(A=A||1)/2,t=[[-e,-e,-e],[+e,-e,-e],[-e,+e,-e],[+e,+e,-e],[-e,-e,+e],[+e,-e,+e],[-e,+e,+e],[+e,+e,+e]],n=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],i=[[1,0],[0,0],[0,1],[1,1]],r=E(3,24),o=E(3,24),s=E(2,24),a=E(3,12,Uint16Array),B=0;B<6;++B){for(var c=p[B],g=0;g<4;++g){var Q=t[c[g]],u=n[B],l=i[g];r.push(Q),o.push(u),s.push(l)}var w=4*B;a.push(w+0,w+1,w+2),a.push(w+0,w+2,w+3)}return{position:r,normal:o,texcoord:s,indices:a}}function D(A,e,t,n,i,r,o){if(n<3)throw Error("radialSubdivisions must be 3 or greater");if(i<1)throw Error("verticalSubdivisions must be 1 or greater");for(var s=void 0===r||r,a=void 0===o||o,B=(s?2:0)+(a?2:0),c=(n+1)*(i+1+B),g=E(3,c),Q=E(3,c),u=E(2,c),l=E(3,n*(i+B)*2,Uint16Array),w=n+1,h=Math.atan2(A-e,t),C=Math.cos(h),I=Math.sin(h),M=i+(a?2:0),d=s?-2:0;d<=M;++d){var m=d/i,p=t*m,F=void 0;d<0?(p=0,m=1,F=A):d>i?(p=t,m=1,F=e):F=A+d/i*(e-A),-2!==d&&d!==i+2||(F=0,m=0),p-=t/2;for(var D=0;D<w;++D){var Y=Math.sin(D*Math.PI*2/n),f=Math.cos(D*Math.PI*2/n);g.push(Y*F,p,f*F),Q.push(d<0||d>i?0:Y*C,d<0?-1:d>i?1:I,d<0||d>i?0:f*C),u.push(D/n,1-m)}}for(var N=0;N<i+B;++N)for(var U=0;U<n;++U)l.push(w*(N+0)+0+U,w*(N+0)+1+U,w*(N+1)+1+U),l.push(w*(N+0)+0+U,w*(N+1)+1+U,w*(N+1)+0+U);return{position:g,normal:Q,texcoord:u,indices:l}}function Y(A,e){e=e||[];for(var t=[],n=0;n<A.length;n+=4){var i=A[n],r=A.slice(n+1,n+4);r.push.apply(r,e);for(var o=0;o<i;++o)t.push.apply(t,r)}return t}function f(){var A=[0,0,0,0,150,0,30,0,0,0,150,0,30,150,0,30,0,0,30,0,0,30,30,0,100,0,0,30,30,0,100,30,0,100,0,0,30,60,0,30,90,0,67,60,0,30,90,0,67,90,0,67,60,0,0,0,30,30,0,30,0,150,30,0,150,30,30,0,30,30,150,30,30,0,30,100,0,30,30,30,30,30,30,30,100,0,30,100,30,30,30,60,30,67,60,30,30,90,30,30,90,30,67,60,30,67,90,30,0,0,0,100,0,0,100,0,30,0,0,0,100,0,30,0,0,30,100,0,0,100,30,0,100,30,30,100,0,0,100,30,30,100,0,30,30,30,0,30,30,30,100,30,30,30,30,0,100,30,30,100,30,0,30,30,0,30,60,30,30,30,30,30,30,0,30,60,0,30,60,30,30,60,0,67,60,30,30,60,30,30,60,0,67,60,0,67,60,30,67,60,0,67,90,30,67,60,30,67,60,0,67,90,0,67,90,30,30,90,0,30,90,30,67,90,30,30,90,0,67,90,30,67,90,0,30,90,0,30,150,30,30,90,30,30,90,0,30,150,0,30,150,30,0,150,0,0,150,30,30,150,30,0,150,0,30,150,30,30,150,0,0,0,0,0,0,30,0,150,30,0,0,0,0,150,30,0,150,0],e=Y([18,0,0,1,18,0,0,-1,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,-1,0,6,-1,0,0]),t=Y([18,200,70,120,18,80,70,200,6,70,200,210,6,200,200,70,6,210,100,70,6,210,160,70,6,70,180,210,6,100,70,210,6,76,210,100,6,140,210,80,6,90,130,110,6,160,160,220],[255]),n=A.length/3,i={position:E(3,n),texcoord:E(2,n),normal:E(3,n),color:E(4,n,Uint8Array),indices:E(3,n/3,Uint16Array)};i.position.push(A),i.texcoord.push([.22,.19,.22,.79,.34,.19,.22,.79,.34,.79,.34,.19,.34,.19,.34,.31,.62,.19,.34,.31,.62,.31,.62,.19,.34,.43,.34,.55,.49,.43,.34,.55,.49,.55,.49,.43,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,0,1,1,1,0,0,1,1,1,0]),i.normal.push(e),i.color.push(t);for(var r=0;r<n;++r)i.indices.push(r);return i}function N(A,e,t,n,i,r,o){if(i<=0)throw Error("subdivisionDown must be > 0");var a=(o=o||1)-(r=r||0),B=2*(i+1)*4,c=E(3,B),g=E(3,B),Q=E(2,B);function u(A,e,t){return A+(e-A)*t}function l(e,t,o,B,E,l){for(var w=0;w<=i;w++){var h=t/1,C=w/i,I=2*(h-.5),M=(r+C*a)*Math.PI,d=Math.sin(M),m=Math.cos(M),p=u(A,e,d),F=I*n,D=m*A,Y=d*p;c.push(F,D,Y);var f=s.add(s.multiply([0,d,m],o),B);g.push(f),Q.push(h*E+l,C)}}for(var w=0;w<2;w++){var h=2*(w/1-.5);l(e,w,[1,1,1],[0,0,0],1,0),l(e,w,[0,0,0],[h,0,0],0,0),l(t,w,[1,1,1],[0,0,0],1,0),l(t,w,[0,0,0],[h,0,0],0,1)}var C=E(3,2*i*4,Uint16Array);function I(A,e){for(var t=0;t<i;++t)C.push(A+t+0,A+t+1,e+t+0),C.push(A+t+1,e+t+1,e+t+0)}var M=i+1;return I(0*M,4*M),I(5*M,7*M),I(6*M,2*M),I(3*M,1*M),{position:c,normal:g,texcoord:Q,indices:C}}function U(A,e,t,n,i,r){return D(A,A,e,t,n,i,r)}function y(A,e,t,n,i,r){if(t<3)throw Error("radialSubdivisions must be 3 or greater");if(n<3)throw Error("verticalSubdivisions must be 3 or greater");i=i||0;for(var o=(r=r||2*Math.PI)-i,s=t+1,a=n+1,B=s*a,c=E(3,B),g=E(3,B),Q=E(2,B),u=E(3,t*n*2,Uint16Array),l=0;l<a;++l)for(var w=l/n,h=w*Math.PI*2,C=Math.sin(h),I=A+C*e,M=Math.cos(h),d=M*e,m=0;m<s;++m){var p=m/t,F=i+p*o,D=Math.sin(F),Y=Math.cos(F),f=D*I,N=Y*I,U=D*C,y=Y*C;c.push(f,d,N),g.push(U,M,y),Q.push(p,1-w)}for(var T=0;T<n;++T)for(var x=0;x<t;++x){var R=1+x,G=1+T;u.push(s*T+x,s*G+x,s*T+R),u.push(s*G+x,s*G+R,s*T+R)}return{position:c,normal:g,texcoord:Q,indices:u}}function T(A,e,t,n,i){if(e<3)throw Error("divisions must be at least 3");i=i||1,n=n||0;for(var r=(e+1)*((t=t||1)+1),o=E(3,r),s=E(3,r),a=E(2,r),B=E(3,t*e*2,Uint16Array),c=0,g=A-n,Q=e+1,u=0;u<=t;++u){for(var l=n+g*Math.pow(u/t,i),w=0;w<=e;++w){var h=2*Math.PI*w/e,C=l*Math.cos(h),I=l*Math.sin(h);if(o.push(C,0,I),s.push(0,1,0),a.push(1-w/e,u/t),u>0&&w!==e){var M=c+(w+1),d=c+w,m=c+w-Q,p=c+(w+1)-Q;B.push(M,d,m),B.push(M,m,p)}}c+=e+1}return{position:o,normal:s,texcoord:a,indices:B}}function x(A){return function(e){var t=A.apply(this,Array.prototype.slice.call(arguments,1));return n.createBuffersFromArrays(e,t)}}function R(A){return function(e){var t=A.apply(null,Array.prototype.slice.call(arguments,1));return n.createBufferInfoFromArrays(e,t)}}var G=["numComponents","size","type","normalize","stride","offset","attrib","name","attribName"];function S(A,e,t,n){n=n||0;for(var i=A.length,r=0;r<i;++r)e[t+r]=A[r]+n}function H(A,e){var t=B(A),n=new t.constructor(e),r=n;return t.numComponents&&t.numElements&&g(n,t.numComponents),A.data&&(r={data:n},i.copyNamedProperties(G,A,r)),r}var b=R(f);e.create3DFBufferInfo=b;var v=x(f);e.create3DFBuffers=v;var k=R(F);e.createCubeBufferInfo=k;var j=x(F);e.createCubeBuffers=j;var J=R(d);e.createPlaneBufferInfo=J;var z=x(d);e.createPlaneBuffers=z;var L=R(m);e.createSphereBufferInfo=L;var P=x(m);e.createSphereBuffers=P;var O=R(D);e.createTruncatedConeBufferInfo=O;var V=x(D);e.createTruncatedConeBuffers=V;var W=R(M);e.createXYQuadBufferInfo=W;var K=x(M);e.createXYQuadBuffers=K;var X=R(N);e.createCresentBufferInfo=X;var Z=x(N);e.createCresentBuffers=Z;var _=R(U);e.createCylinderBufferInfo=_;var q=x(U);e.createCylinderBuffers=q;var $=R(y);e.createTorusBufferInfo=$;var AA=x(y);e.createTorusBuffers=AA;var eA=R(T);e.createDiscBufferInfo=eA;var tA=x(T);e.createDiscBuffers=tA},function(A,e,t){"use strict";e.__esModule=!0;var n={addExtensionsToContext:!0,getContext:!0,getWebGLContext:!0,resizeCanvasToDisplaySize:!0,setDefaults:!0};e.addExtensionsToContext=C,e.getContext=function(A,e){return function(A,e){for(var t=["webgl2","webgl","experimental-webgl"],n=null,i=0;i<t.length;++i)if(n=A.getContext(t[i],e)){u.addExtensionsToContext&&C(n);break}return n}(A,e)},e.getWebGLContext=function(A,e){return function(A,e){for(var t=["webgl","experimental-webgl"],n=null,i=0;i<t.length;++i)if(n=A.getContext(t[i],e)){u.addExtensionsToContext&&C(n);break}return n}(A,e)},e.resizeCanvasToDisplaySize=function(A,e){e=e||1,e=Math.max(0,e);var t=A.clientWidth*e|0,n=A.clientHeight*e|0;return(A.width!==t||A.height!==n)&&(A.width=t,A.height=n,!0)},e.setDefaults=function(A){o.copyExistingProperties(A,u),i.setAttributeDefaults_(A),r.setTextureDefaults_(A)};var i=Q(t(7));Object.keys(i).forEach((function(A){"default"!==A&&"__esModule"!==A&&(Object.prototype.hasOwnProperty.call(n,A)||(e[A]=i[A]))}));var r=Q(t(8));Object.keys(r).forEach((function(A){"default"!==A&&"__esModule"!==A&&(Object.prototype.hasOwnProperty.call(n,A)||(e[A]=r[A]))}));var o=Q(t(0)),s=Q(t(4));Object.keys(s).forEach((function(A){"default"!==A&&"__esModule"!==A&&(Object.prototype.hasOwnProperty.call(n,A)||(e[A]=s[A]))}));var a=t(12);Object.keys(a).forEach((function(A){"default"!==A&&"__esModule"!==A&&(Object.prototype.hasOwnProperty.call(n,A)||(e[A]=a[A]))}));var B=t(13);Object.keys(B).forEach((function(A){"default"!==A&&"__esModule"!==A&&(Object.prototype.hasOwnProperty.call(n,A)||(e[A]=B[A]))}));var c=t(5);Object.keys(c).forEach((function(A){"default"!==A&&"__esModule"!==A&&(Object.prototype.hasOwnProperty.call(n,A)||(e[A]=c[A]))}));var g=t(1);Object.keys(g).forEach((function(A){"default"!==A&&"__esModule"!==A&&(Object.prototype.hasOwnProperty.call(n,A)||(e[A]=g[A]))}));var E=t(14);function Q(A){if(A&&A.__esModule)return A;var e={};if(null!=A)for(var t in A)if(Object.prototype.hasOwnProperty.call(A,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(A,t):{};n.get||n.set?Object.defineProperty(e,t,n):e[t]=A[t]}return e.default=A,e}Object.keys(E).forEach((function(A){"default"!==A&&"__esModule"!==A&&(Object.prototype.hasOwnProperty.call(n,A)||(e[A]=E[A]))}));var u={addExtensionsToContext:!0},l=/^(.*?)_/;function w(A,e){s.glEnumToString(A,0);var t=A.getExtension(e);if(t){var n={},i=l.exec(e)[1],r="_"+i;for(var a in t){var B=t[a],c="function"==typeof B,g=c?i:r,E=a;a.endsWith(g)&&(E=a.substring(0,a.length-g.length)),void 0!==A[E]?c||A[E]===B||o.warn(E,A[E],B,a):c?A[E]=function(A){return function(){return A.apply(t,arguments)}}(B):(A[E]=B,n[E]=B)}n.constructor={name:t.constructor.name},s.glEnumToString(n,0)}return t}var h=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_float","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2","EXT_frag_depth","EXT_sRGB","EXT_shader_texture_lod","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_depth_texture","WEBGL_draw_buffers"];function C(A){for(var e=0;e<h.length;++e)w(A,h[e])}},function(A,e,t){"use strict";e.__esModule=!0,e.drawBufferInfo=i,e.drawObjectList=function(A,e){var t=null,r=null;e.forEach((function(e){if(!1!==e.active){var o=e.programInfo,s=e.vertexArrayInfo||e.bufferInfo,a=!1,B=void 0===e.type?A.TRIANGLES:e.type;o!==t&&(t=o,A.useProgram(o.program),a=!0),(a||s!==r)&&(r&&r.vertexArrayObject&&!s.vertexArrayObject&&A.bindVertexArray(null),r=s,n.setBuffersAndAttributes(A,o,s)),n.setUniforms(o,e.uniforms),i(A,s,B,e.count,e.offset,e.instanceCount)}})),r.vertexArrayObject&&A.bindVertexArray(null)};var n=function(A){if(A&&A.__esModule)return A;var e={};if(null!=A)for(var t in A)if(Object.prototype.hasOwnProperty.call(A,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(A,t):{};n.get||n.set?Object.defineProperty(e,t,n):e[t]=A[t]}return e.default=A,e}(t(5));function i(A,e,t,n,i,r){t=void 0===t?A.TRIANGLES:t;var o=e.indices,s=e.elementType,a=void 0===n?e.numElements:n;i=void 0===i?0:i,s||o?void 0!==r?A.drawElementsInstanced(t,a,void 0===s?A.UNSIGNED_SHORT:e.elementType,i,r):A.drawElements(t,a,void 0===s?A.UNSIGNED_SHORT:e.elementType,i):void 0!==r?A.drawArraysInstanced(t,i,a,r):A.drawArrays(t,i,a)}},function(A,e,t){"use strict";e.__esModule=!0,e.bindFramebufferInfo=function(A,e,t){t=t||A.FRAMEBUFFER,e?(A.bindFramebuffer(t,e.framebuffer),A.viewport(0,0,e.width,e.height)):(A.bindFramebuffer(t,null),A.viewport(0,0,A.drawingBufferWidth,A.drawingBufferHeight))},e.createFramebufferInfo=function(A,e,t,r){var B=A.FRAMEBUFFER,c=A.createFramebuffer();A.bindFramebuffer(B,c),t=t||A.drawingBufferWidth,r=r||A.drawingBufferHeight;var g=0,E={framebuffer:c,attachments:[],width:t,height:r};return(e=e||o).forEach((function(e){var o=e.attachment,c=e.format,Q=function(A){return s[A]}(c);if(Q||(Q=36064+g++),!o)if(function(A){return a[A]}(c))o=A.createRenderbuffer(),A.bindRenderbuffer(A.RENDERBUFFER,o),A.renderbufferStorage(A.RENDERBUFFER,c,t,r);else{var u=Object.assign({},e);u.width=t,u.height=r,void 0===u.auto&&(u.auto=!1,u.min=u.min||u.minMag||A.LINEAR,u.mag=u.mag||u.minMag||A.LINEAR,u.wrapS=u.wrapS||u.wrap||A.CLAMP_TO_EDGE,u.wrapT=u.wrapT||u.wrap||A.CLAMP_TO_EDGE),o=n.createTexture(A,u)}if(i.isRenderbuffer(A,o))A.framebufferRenderbuffer(B,Q,A.RENDERBUFFER,o);else{if(!i.isTexture(A,o))throw"unknown attachment type";A.framebufferTexture2D(B,Q,e.texTarget||A.TEXTURE_2D,o,e.level||0)}E.attachments.push(o)})),E},e.resizeFramebufferInfo=function(A,e,t,r,s){r=r||A.drawingBufferWidth,s=s||A.drawingBufferHeight,e.width=r,e.height=s,(t=t||o).forEach((function(t,o){var a=e.attachments[o],B=t.format;if(i.isRenderbuffer(A,a))A.bindRenderbuffer(A.RENDERBUFFER,a),A.renderbufferStorage(A.RENDERBUFFER,B,r,s);else{if(!i.isTexture(A,a))throw"unknown attachment type";n.resizeTexture(A,a,t,r,s)}}))};var n=r(t(8)),i=r(t(0));function r(A){if(A&&A.__esModule)return A;var e={};if(null!=A)for(var t in A)if(Object.prototype.hasOwnProperty.call(A,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(A,t):{};n.get||n.set?Object.defineProperty(e,t,n):e[t]=A[t]}return e.default=A,e}var o=[{format:6408,type:5121,min:9729,wrap:33071},{format:34041}],s={34041:33306,6401:36128,36168:36128,6402:36096,33189:36096},a={32854:!0,32855:!0,36194:!0,34041:!0,33189:!0,6401:!0,36168:!0}},function(A,e,t){"use strict";e.__esModule=!0,e.createVertexArrayInfo=function(A,e,t){var i=A.createVertexArray();return A.bindVertexArray(i),e.length||(e=[e]),e.forEach((function(e){n.setBuffersAndAttributes(A,e,t)})),A.bindVertexArray(null),{numElements:t.numElements,elementType:t.elementType,vertexArrayObject:i}},e.createVAOAndSetAttributes=i,e.createVAOFromBufferInfo=function(A,e,t){return i(A,e.attribSetters||e,t.attribs,t.indices)};var n=function(A){if(A&&A.__esModule)return A;var e={};if(null!=A)for(var t in A)if(Object.prototype.hasOwnProperty.call(A,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(A,t):{};n.get||n.set?Object.defineProperty(e,t,n):e[t]=A[t]}return e.default=A,e}(t(5));function i(A,e,t,i){var r=A.createVertexArray();return A.bindVertexArray(r),n.setAttributes(e,t),i&&A.bindBuffer(A.ELEMENT_ARRAY_BUFFER,i),A.bindVertexArray(null),r}}])},A.exports=n()},function(A,e,t){(function(e){class t{constructor(){let A=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.nowObj;this.startTime=0,this.nowObj=A,this._pausedTime=null}static get USE_PERFORMANCE(){return!1}static get legacyDateCode(){return{now:function(){return(new Date).getTime()}}}static get nowObj(){return t.USE_PERFORMANCE&&"undefined"!=typeof self&&self.performance&&"now"in self.performance?self.performance:Date.now?Date:t.legacyDateCode}time(){return this.nowObj.now()}relativeTime(){return this.nowObj.now()}start(){this.startTime=this.nowObj.now()}pause(){this._pausedTime||(this._pausedTime=this.timeElapsed())}play(){this._pausedTime&&(this.startTime=this.nowObj.now()-this._pausedTime,this._pausedTime=null)}timeElapsed(){if(this._pausedTime)return this._pausedTime;return this.nowObj.now()-this.startTime}setTimeout(A,t){return e.setTimeout(A,t)}clearTimeout(A){e.clearTimeout(A)}}A.exports=t}).call(this,t(14))},function(A,e,t){const n=t(9),i=t(24);class r{constructor(A,e,t,i){switch(this.id=A||n(),this.name=e,this.type=t,this.isCloud=i,this.type){case r.SCALAR_TYPE:this.value=0;break;case r.LIST_TYPE:this.value=[];break;case r.BROADCAST_MESSAGE_TYPE:this.value=this.name;break;default:console.warn("Invalid variable type: ".concat(this.type))}}toXML(A){return A=!0===A,'<variable type="'.concat(this.type,'" id="').concat(this.id,'" islocal="').concat(A,'" iscloud="').concat(this.isCloud,'">').concat(i(this.name),"</variable>")}static get SCALAR_TYPE(){return""}static get LIST_TYPE(){return"list"}static get BROADCAST_MESSAGE_TYPE(){return"broadcast_msg"}}A.exports=r},function(A,e,t){"use strict";(function(A){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var n=t(127),i=t(128),r=t(129);function o(){return a.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(A,e){if(o()<e)throw new RangeError("Invalid typed array length");return a.TYPED_ARRAY_SUPPORT?(A=new Uint8Array(e)).__proto__=a.prototype:(null===A&&(A=new a(e)),A.length=e),A}function a(A,e,t){if(!(a.TYPED_ARRAY_SUPPORT||this instanceof a))return new a(A,e,t);if("number"==typeof A){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return g(this,A)}return B(this,A,e,t)}function B(A,e,t,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(A,e,t,n){if(e.byteLength,t<0||e.byteLength<t)throw new RangeError("'offset' is out of bounds");if(e.byteLength<t+(n||0))throw new RangeError("'length' is out of bounds");e=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n);a.TYPED_ARRAY_SUPPORT?(A=e).__proto__=a.prototype:A=E(A,e);return A}(A,e,t,n):"string"==typeof e?function(A,e,t){"string"==typeof t&&""!==t||(t="utf8");if(!a.isEncoding(t))throw new TypeError('"encoding" must be a valid string encoding');var n=0|u(e,t),i=(A=s(A,n)).write(e,t);i!==n&&(A=A.slice(0,i));return A}(A,e,t):function(A,e){if(a.isBuffer(e)){var t=0|Q(e.length);return 0===(A=s(A,t)).length||e.copy(A,0,0,t),A}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(n=e.length)!=n?s(A,0):E(A,e);if("Buffer"===e.type&&r(e.data))return E(A,e.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(A,e)}function c(A){if("number"!=typeof A)throw new TypeError('"size" argument must be a number');if(A<0)throw new RangeError('"size" argument must not be negative')}function g(A,e){if(c(e),A=s(A,e<0?0:0|Q(e)),!a.TYPED_ARRAY_SUPPORT)for(var t=0;t<e;++t)A[t]=0;return A}function E(A,e){var t=e.length<0?0:0|Q(e.length);A=s(A,t);for(var n=0;n<t;n+=1)A[n]=255&e[n];return A}function Q(A){if(A>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|A}function u(A,e){if(a.isBuffer(A))return A.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(A)||A instanceof ArrayBuffer))return A.byteLength;"string"!=typeof A&&(A=""+A);var t=A.length;if(0===t)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":case void 0:return j(A).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*t;case"hex":return t>>>1;case"base64":return J(A).length;default:if(n)return j(A).length;e=(""+e).toLowerCase(),n=!0}}function l(A,e,t){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===t||t>this.length)&&(t=this.length),t<=0)return"";if((t>>>=0)<=(e>>>=0))return"";for(A||(A="utf8");;)switch(A){case"hex":return U(this,e,t);case"utf8":case"utf-8":return Y(this,e,t);case"ascii":return f(this,e,t);case"latin1":case"binary":return N(this,e,t);case"base64":return D(this,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return y(this,e,t);default:if(n)throw new TypeError("Unknown encoding: "+A);A=(A+"").toLowerCase(),n=!0}}function w(A,e,t){var n=A[e];A[e]=A[t],A[t]=n}function h(A,e,t,n,i){if(0===A.length)return-1;if("string"==typeof t?(n=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,isNaN(t)&&(t=i?0:A.length-1),t<0&&(t=A.length+t),t>=A.length){if(i)return-1;t=A.length-1}else if(t<0){if(!i)return-1;t=0}if("string"==typeof e&&(e=a.from(e,n)),a.isBuffer(e))return 0===e.length?-1:C(A,e,t,n,i);if("number"==typeof e)return e&=255,a.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(A,e,t):Uint8Array.prototype.lastIndexOf.call(A,e,t):C(A,[e],t,n,i);throw new TypeError("val must be string, number or Buffer")}function C(A,e,t,n,i){var r,o=1,s=A.length,a=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(A.length<2||e.length<2)return-1;o=2,s/=2,a/=2,t/=2}function B(A,e){return 1===o?A[e]:A.readUInt16BE(e*o)}if(i){var c=-1;for(r=t;r<s;r++)if(B(A,r)===B(e,-1===c?0:r-c)){if(-1===c&&(c=r),r-c+1===a)return c*o}else-1!==c&&(r-=r-c),c=-1}else for(t+a>s&&(t=s-a),r=t;r>=0;r--){for(var g=!0,E=0;E<a;E++)if(B(A,r+E)!==B(e,E)){g=!1;break}if(g)return r}return-1}function I(A,e,t,n){t=Number(t)||0;var i=A.length-t;n?(n=Number(n))>i&&(n=i):n=i;var r=e.length;if(r%2!=0)throw new TypeError("Invalid hex string");n>r/2&&(n=r/2);for(var o=0;o<n;++o){var s=parseInt(e.substr(2*o,2),16);if(isNaN(s))return o;A[t+o]=s}return o}function M(A,e,t,n){return z(j(e,A.length-t),A,t,n)}function d(A,e,t,n){return z(function(A){for(var e=[],t=0;t<A.length;++t)e.push(255&A.charCodeAt(t));return e}(e),A,t,n)}function m(A,e,t,n){return d(A,e,t,n)}function p(A,e,t,n){return z(J(e),A,t,n)}function F(A,e,t,n){return z(function(A,e){for(var t,n,i,r=[],o=0;o<A.length&&!((e-=2)<0);++o)t=A.charCodeAt(o),n=t>>8,i=t%256,r.push(i),r.push(n);return r}(e,A.length-t),A,t,n)}function D(A,e,t){return 0===e&&t===A.length?n.fromByteArray(A):n.fromByteArray(A.slice(e,t))}function Y(A,e,t){t=Math.min(A.length,t);for(var n=[],i=e;i<t;){var r,o,s,a,B=A[i],c=null,g=B>239?4:B>223?3:B>191?2:1;if(i+g<=t)switch(g){case 1:B<128&&(c=B);break;case 2:128==(192&(r=A[i+1]))&&(a=(31&B)<<6|63&r)>127&&(c=a);break;case 3:r=A[i+1],o=A[i+2],128==(192&r)&&128==(192&o)&&(a=(15&B)<<12|(63&r)<<6|63&o)>2047&&(a<55296||a>57343)&&(c=a);break;case 4:r=A[i+1],o=A[i+2],s=A[i+3],128==(192&r)&&128==(192&o)&&128==(192&s)&&(a=(15&B)<<18|(63&r)<<12|(63&o)<<6|63&s)>65535&&a<1114112&&(c=a)}null===c?(c=65533,g=1):c>65535&&(c-=65536,n.push(c>>>10&1023|55296),c=56320|1023&c),n.push(c),i+=g}return function(A){var e=A.length;if(e<=4096)return String.fromCharCode.apply(String,A);var t="",n=0;for(;n<e;)t+=String.fromCharCode.apply(String,A.slice(n,n+=4096));return t}(n)}e.Buffer=a,e.SlowBuffer=function(A){+A!=A&&(A=0);return a.alloc(+A)},e.INSPECT_MAX_BYTES=50,a.TYPED_ARRAY_SUPPORT=void 0!==A.TYPED_ARRAY_SUPPORT?A.TYPED_ARRAY_SUPPORT:function(){try{var A=new Uint8Array(1);return A.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===A.foo()&&"function"==typeof A.subarray&&0===A.subarray(1,1).byteLength}catch(A){return!1}}(),e.kMaxLength=o(),a.poolSize=8192,a._augment=function(A){return A.__proto__=a.prototype,A},a.from=function(A,e,t){return B(null,A,e,t)},a.TYPED_ARRAY_SUPPORT&&(a.prototype.__proto__=Uint8Array.prototype,a.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&a[Symbol.species]===a&&Object.defineProperty(a,Symbol.species,{value:null,configurable:!0})),a.alloc=function(A,e,t){return function(A,e,t,n){return c(e),e<=0?s(A,e):void 0!==t?"string"==typeof n?s(A,e).fill(t,n):s(A,e).fill(t):s(A,e)}(null,A,e,t)},a.allocUnsafe=function(A){return g(null,A)},a.allocUnsafeSlow=function(A){return g(null,A)},a.isBuffer=function(A){return!(null==A||!A._isBuffer)},a.compare=function(A,e){if(!a.isBuffer(A)||!a.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(A===e)return 0;for(var t=A.length,n=e.length,i=0,r=Math.min(t,n);i<r;++i)if(A[i]!==e[i]){t=A[i],n=e[i];break}return t<n?-1:n<t?1:0},a.isEncoding=function(A){switch(String(A).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(A,e){if(!r(A))throw new TypeError('"list" argument must be an Array of Buffers');if(0===A.length)return a.alloc(0);var t;if(void 0===e)for(e=0,t=0;t<A.length;++t)e+=A[t].length;var n=a.allocUnsafe(e),i=0;for(t=0;t<A.length;++t){var o=A[t];if(!a.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,i),i+=o.length}return n},a.byteLength=u,a.prototype._isBuffer=!0,a.prototype.swap16=function(){var A=this.length;if(A%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<A;e+=2)w(this,e,e+1);return this},a.prototype.swap32=function(){var A=this.length;if(A%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<A;e+=4)w(this,e,e+3),w(this,e+1,e+2);return this},a.prototype.swap64=function(){var A=this.length;if(A%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<A;e+=8)w(this,e,e+7),w(this,e+1,e+6),w(this,e+2,e+5),w(this,e+3,e+4);return this},a.prototype.toString=function(){var A=0|this.length;return 0===A?"":0===arguments.length?Y(this,0,A):l.apply(this,arguments)},a.prototype.equals=function(A){if(!a.isBuffer(A))throw new TypeError("Argument must be a Buffer");return this===A||0===a.compare(this,A)},a.prototype.inspect=function(){var A="",t=e.INSPECT_MAX_BYTES;return this.length>0&&(A=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(A+=" ... ")),"<Buffer "+A+">"},a.prototype.compare=function(A,e,t,n,i){if(!a.isBuffer(A))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===t&&(t=A?A.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),e<0||t>A.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&e>=t)return 0;if(n>=i)return-1;if(e>=t)return 1;if(this===A)return 0;for(var r=(i>>>=0)-(n>>>=0),o=(t>>>=0)-(e>>>=0),s=Math.min(r,o),B=this.slice(n,i),c=A.slice(e,t),g=0;g<s;++g)if(B[g]!==c[g]){r=B[g],o=c[g];break}return r<o?-1:o<r?1:0},a.prototype.includes=function(A,e,t){return-1!==this.indexOf(A,e,t)},a.prototype.indexOf=function(A,e,t){return h(this,A,e,t,!0)},a.prototype.lastIndexOf=function(A,e,t){return h(this,A,e,t,!1)},a.prototype.write=function(A,e,t,n){if(void 0===e)n="utf8",t=this.length,e=0;else if(void 0===t&&"string"==typeof e)n=e,t=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(t)?(t|=0,void 0===n&&(n="utf8")):(n=t,t=void 0)}var i=this.length-e;if((void 0===t||t>i)&&(t=i),A.length>0&&(t<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var r=!1;;)switch(n){case"hex":return I(this,A,e,t);case"utf8":case"utf-8":return M(this,A,e,t);case"ascii":return d(this,A,e,t);case"latin1":case"binary":return m(this,A,e,t);case"base64":return p(this,A,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return F(this,A,e,t);default:if(r)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),r=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function f(A,e,t){var n="";t=Math.min(A.length,t);for(var i=e;i<t;++i)n+=String.fromCharCode(127&A[i]);return n}function N(A,e,t){var n="";t=Math.min(A.length,t);for(var i=e;i<t;++i)n+=String.fromCharCode(A[i]);return n}function U(A,e,t){var n=A.length;(!e||e<0)&&(e=0),(!t||t<0||t>n)&&(t=n);for(var i="",r=e;r<t;++r)i+=k(A[r]);return i}function y(A,e,t){for(var n=A.slice(e,t),i="",r=0;r<n.length;r+=2)i+=String.fromCharCode(n[r]+256*n[r+1]);return i}function T(A,e,t){if(A%1!=0||A<0)throw new RangeError("offset is not uint");if(A+e>t)throw new RangeError("Trying to access beyond buffer length")}function x(A,e,t,n,i,r){if(!a.isBuffer(A))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<r)throw new RangeError('"value" argument is out of bounds');if(t+n>A.length)throw new RangeError("Index out of range")}function R(A,e,t,n){e<0&&(e=65535+e+1);for(var i=0,r=Math.min(A.length-t,2);i<r;++i)A[t+i]=(e&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function G(A,e,t,n){e<0&&(e=4294967295+e+1);for(var i=0,r=Math.min(A.length-t,4);i<r;++i)A[t+i]=e>>>8*(n?i:3-i)&255}function S(A,e,t,n,i,r){if(t+n>A.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function H(A,e,t,n,r){return r||S(A,0,t,4),i.write(A,e,t,n,23,4),t+4}function b(A,e,t,n,r){return r||S(A,0,t,8),i.write(A,e,t,n,52,8),t+8}a.prototype.slice=function(A,e){var t,n=this.length;if((A=~~A)<0?(A+=n)<0&&(A=0):A>n&&(A=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<A&&(e=A),a.TYPED_ARRAY_SUPPORT)(t=this.subarray(A,e)).__proto__=a.prototype;else{var i=e-A;t=new a(i,void 0);for(var r=0;r<i;++r)t[r]=this[r+A]}return t},a.prototype.readUIntLE=function(A,e,t){A|=0,e|=0,t||T(A,e,this.length);for(var n=this[A],i=1,r=0;++r<e&&(i*=256);)n+=this[A+r]*i;return n},a.prototype.readUIntBE=function(A,e,t){A|=0,e|=0,t||T(A,e,this.length);for(var n=this[A+--e],i=1;e>0&&(i*=256);)n+=this[A+--e]*i;return n},a.prototype.readUInt8=function(A,e){return e||T(A,1,this.length),this[A]},a.prototype.readUInt16LE=function(A,e){return e||T(A,2,this.length),this[A]|this[A+1]<<8},a.prototype.readUInt16BE=function(A,e){return e||T(A,2,this.length),this[A]<<8|this[A+1]},a.prototype.readUInt32LE=function(A,e){return e||T(A,4,this.length),(this[A]|this[A+1]<<8|this[A+2]<<16)+16777216*this[A+3]},a.prototype.readUInt32BE=function(A,e){return e||T(A,4,this.length),16777216*this[A]+(this[A+1]<<16|this[A+2]<<8|this[A+3])},a.prototype.readIntLE=function(A,e,t){A|=0,e|=0,t||T(A,e,this.length);for(var n=this[A],i=1,r=0;++r<e&&(i*=256);)n+=this[A+r]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*e)),n},a.prototype.readIntBE=function(A,e,t){A|=0,e|=0,t||T(A,e,this.length);for(var n=e,i=1,r=this[A+--n];n>0&&(i*=256);)r+=this[A+--n]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},a.prototype.readInt8=function(A,e){return e||T(A,1,this.length),128&this[A]?-1*(255-this[A]+1):this[A]},a.prototype.readInt16LE=function(A,e){e||T(A,2,this.length);var t=this[A]|this[A+1]<<8;return 32768&t?4294901760|t:t},a.prototype.readInt16BE=function(A,e){e||T(A,2,this.length);var t=this[A+1]|this[A]<<8;return 32768&t?4294901760|t:t},a.prototype.readInt32LE=function(A,e){return e||T(A,4,this.length),this[A]|this[A+1]<<8|this[A+2]<<16|this[A+3]<<24},a.prototype.readInt32BE=function(A,e){return e||T(A,4,this.length),this[A]<<24|this[A+1]<<16|this[A+2]<<8|this[A+3]},a.prototype.readFloatLE=function(A,e){return e||T(A,4,this.length),i.read(this,A,!0,23,4)},a.prototype.readFloatBE=function(A,e){return e||T(A,4,this.length),i.read(this,A,!1,23,4)},a.prototype.readDoubleLE=function(A,e){return e||T(A,8,this.length),i.read(this,A,!0,52,8)},a.prototype.readDoubleBE=function(A,e){return e||T(A,8,this.length),i.read(this,A,!1,52,8)},a.prototype.writeUIntLE=function(A,e,t,n){(A=+A,e|=0,t|=0,n)||x(this,A,e,t,Math.pow(2,8*t)-1,0);var i=1,r=0;for(this[e]=255&A;++r<t&&(i*=256);)this[e+r]=A/i&255;return e+t},a.prototype.writeUIntBE=function(A,e,t,n){(A=+A,e|=0,t|=0,n)||x(this,A,e,t,Math.pow(2,8*t)-1,0);var i=t-1,r=1;for(this[e+i]=255&A;--i>=0&&(r*=256);)this[e+i]=A/r&255;return e+t},a.prototype.writeUInt8=function(A,e,t){return A=+A,e|=0,t||x(this,A,e,1,255,0),a.TYPED_ARRAY_SUPPORT||(A=Math.floor(A)),this[e]=255&A,e+1},a.prototype.writeUInt16LE=function(A,e,t){return A=+A,e|=0,t||x(this,A,e,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[e]=255&A,this[e+1]=A>>>8):R(this,A,e,!0),e+2},a.prototype.writeUInt16BE=function(A,e,t){return A=+A,e|=0,t||x(this,A,e,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[e]=A>>>8,this[e+1]=255&A):R(this,A,e,!1),e+2},a.prototype.writeUInt32LE=function(A,e,t){return A=+A,e|=0,t||x(this,A,e,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[e+3]=A>>>24,this[e+2]=A>>>16,this[e+1]=A>>>8,this[e]=255&A):G(this,A,e,!0),e+4},a.prototype.writeUInt32BE=function(A,e,t){return A=+A,e|=0,t||x(this,A,e,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[e]=A>>>24,this[e+1]=A>>>16,this[e+2]=A>>>8,this[e+3]=255&A):G(this,A,e,!1),e+4},a.prototype.writeIntLE=function(A,e,t,n){if(A=+A,e|=0,!n){var i=Math.pow(2,8*t-1);x(this,A,e,t,i-1,-i)}var r=0,o=1,s=0;for(this[e]=255&A;++r<t&&(o*=256);)A<0&&0===s&&0!==this[e+r-1]&&(s=1),this[e+r]=(A/o>>0)-s&255;return e+t},a.prototype.writeIntBE=function(A,e,t,n){if(A=+A,e|=0,!n){var i=Math.pow(2,8*t-1);x(this,A,e,t,i-1,-i)}var r=t-1,o=1,s=0;for(this[e+r]=255&A;--r>=0&&(o*=256);)A<0&&0===s&&0!==this[e+r+1]&&(s=1),this[e+r]=(A/o>>0)-s&255;return e+t},a.prototype.writeInt8=function(A,e,t){return A=+A,e|=0,t||x(this,A,e,1,127,-128),a.TYPED_ARRAY_SUPPORT||(A=Math.floor(A)),A<0&&(A=255+A+1),this[e]=255&A,e+1},a.prototype.writeInt16LE=function(A,e,t){return A=+A,e|=0,t||x(this,A,e,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[e]=255&A,this[e+1]=A>>>8):R(this,A,e,!0),e+2},a.prototype.writeInt16BE=function(A,e,t){return A=+A,e|=0,t||x(this,A,e,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[e]=A>>>8,this[e+1]=255&A):R(this,A,e,!1),e+2},a.prototype.writeInt32LE=function(A,e,t){return A=+A,e|=0,t||x(this,A,e,4,2147483647,-2147483648),a.TYPED_ARRAY_SUPPORT?(this[e]=255&A,this[e+1]=A>>>8,this[e+2]=A>>>16,this[e+3]=A>>>24):G(this,A,e,!0),e+4},a.prototype.writeInt32BE=function(A,e,t){return A=+A,e|=0,t||x(this,A,e,4,2147483647,-2147483648),A<0&&(A=4294967295+A+1),a.TYPED_ARRAY_SUPPORT?(this[e]=A>>>24,this[e+1]=A>>>16,this[e+2]=A>>>8,this[e+3]=255&A):G(this,A,e,!1),e+4},a.prototype.writeFloatLE=function(A,e,t){return H(this,A,e,!0,t)},a.prototype.writeFloatBE=function(A,e,t){return H(this,A,e,!1,t)},a.prototype.writeDoubleLE=function(A,e,t){return b(this,A,e,!0,t)},a.prototype.writeDoubleBE=function(A,e,t){return b(this,A,e,!1,t)},a.prototype.copy=function(A,e,t,n){if(t||(t=0),n||0===n||(n=this.length),e>=A.length&&(e=A.length),e||(e=0),n>0&&n<t&&(n=t),n===t)return 0;if(0===A.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(t<0||t>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),A.length-e<n-t&&(n=A.length-e+t);var i,r=n-t;if(this===A&&t<e&&e<n)for(i=r-1;i>=0;--i)A[i+e]=this[i+t];else if(r<1e3||!a.TYPED_ARRAY_SUPPORT)for(i=0;i<r;++i)A[i+e]=this[i+t];else Uint8Array.prototype.set.call(A,this.subarray(t,t+r),e);return r},a.prototype.fill=function(A,e,t,n){if("string"==typeof A){if("string"==typeof e?(n=e,e=0,t=this.length):"string"==typeof t&&(n=t,t=this.length),1===A.length){var i=A.charCodeAt(0);i<256&&(A=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!a.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof A&&(A&=255);if(e<0||this.length<e||this.length<t)throw new RangeError("Out of range index");if(t<=e)return this;var r;if(e>>>=0,t=void 0===t?this.length:t>>>0,A||(A=0),"number"==typeof A)for(r=e;r<t;++r)this[r]=A;else{var o=a.isBuffer(A)?A:j(new a(A,n).toString()),s=o.length;for(r=0;r<t-e;++r)this[r+e]=o[r%s]}return this};var v=/[^+\/0-9A-Za-z-_]/g;function k(A){return A<16?"0"+A.toString(16):A.toString(16)}function j(A,e){var t;e=e||1/0;for(var n=A.length,i=null,r=[],o=0;o<n;++o){if((t=A.charCodeAt(o))>55295&&t<57344){if(!i){if(t>56319){(e-=3)>-1&&r.push(239,191,189);continue}if(o+1===n){(e-=3)>-1&&r.push(239,191,189);continue}i=t;continue}if(t<56320){(e-=3)>-1&&r.push(239,191,189),i=t;continue}t=65536+(i-55296<<10|t-56320)}else i&&(e-=3)>-1&&r.push(239,191,189);if(i=null,t<128){if((e-=1)<0)break;r.push(t)}else if(t<2048){if((e-=2)<0)break;r.push(t>>6|192,63&t|128)}else if(t<65536){if((e-=3)<0)break;r.push(t>>12|224,t>>6&63|128,63&t|128)}else{if(!(t<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;r.push(t>>18|240,t>>12&63|128,t>>6&63|128,63&t|128)}}return r}function J(A){return n.toByteArray(function(A){if((A=function(A){return A.trim?A.trim():A.replace(/^\s+|\s+$/g,"")}(A).replace(v,"")).length<2)return"";for(;A.length%4!=0;)A+="=";return A}(A))}function z(A,e,t,n){for(var i=0;i<n&&!(i+t>=e.length||i>=A.length);++i)e[i+t]=A[i];return i}}).call(this,t(14))},function(A,e,t){function n(){}t(134).mixin(n),n.prototype.write=function(A,e,t){this.emit("item",A,e,t)},n.prototype.end=function(){this.emit("end"),this.removeAllListeners()},n.prototype.pipe=function(A){var e=this;function t(){A.write.apply(A,Array.prototype.slice.call(arguments))}function n(){!A._isStdio&&A.end()}return e.emit("unpipe",A),A.emit("pipe",e),e.on("item",t),e.on("end",n),e.when("unpipe",(function(i){var r=i===A||void 0===i;return r&&(e.removeListener("item",t),e.removeListener("end",n),A.emit("unpipe")),r})),A},n.prototype.unpipe=function(A){return this.emit("unpipe",A),this},n.prototype.format=function(A){throw new Error(["Warning: .format() is deprecated in Minilog v2! Use .pipe() instead. For example:","var Minilog = require('minilog');","Minilog","  .pipe(Minilog.backends.console.formatClean)","  .pipe(Minilog.backends.console);"].join("\n"))},n.mixin=function(A){var e,t=n.prototype;for(e in t)t.hasOwnProperty(e)&&(A.prototype[e]=t[e])},A.exports=n},function(A,e,t){function n(A,e,t){return(e=function(A){var e=function(A,e){if("object"!=typeof A||!A)return A;var t=A[Symbol.toPrimitive];if(void 0!==t){var n=t.call(A,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(A)}(A,"string");return"symbol"==typeof e?e:e+""}(e))in A?Object.defineProperty(A,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):A[e]=t,A}const i=t(218),r=t(93),o=t(24),s=t(57),a=t(7),{Map:B}=t(34),c=t(94),g=t(95),E=t(5),Q=t(19),u=t(35),l=t(10);class w{constructor(A,e){n(this,"XMLToBlock",i),n(this,"XMLToMutation",r),this.runtime=A,this._blocks={},this._scripts=[],Object.defineProperty(this,"_cache",{writable:!0,enumerable:!1}),this._cache={inputs:{},procedureParamNames:{},procedureDefinitions:{},_executeCached:{},_monitored:null,scripts:{},compiledScripts:{},compiledProcedures:{},proceduresPopulated:!1},this.forceNoGlow=e||!1}getCachedCompileResult(A){return this._cache.compiledScripts.hasOwnProperty(A)?this._cache.compiledScripts[A]:null}cacheCompileResult(A,e){this._cache.compiledScripts[A]={success:!0,value:e}}cacheCompileError(A,e){this._cache.compiledScripts[A]={success:!1,value:e}}static get BRANCH_INPUT_PREFIX(){return"SUBSTACK"}getBlock(A){return this._blocks[A]}getScripts(){return this._scripts}getNextBlock(A){const e=this._blocks[A];return void 0===e?null:e.next}getBranch(A,e){const t=this._blocks[A];if(void 0===t)return null;e||(e=1);let n=w.BRANCH_INPUT_PREFIX;e>1&&(n+=e);const i=t.inputs[n];return void 0===i?null:i.block}getOpcode(A){return void 0===A?null:A.opcode}getFields(A){return void 0===A?null:A.fields}getInputs(A){if(void 0===A)return null;let e=this._cache.inputs[A.id];if(void 0!==e)return e;e={};for(const t in A.inputs)t.substring(0,w.BRANCH_INPUT_PREFIX.length)!==w.BRANCH_INPUT_PREFIX&&(e[t]=A.inputs[t]);return this._cache.inputs[A.id]=e,e}getMutation(A){return void 0===A?null:A.mutation}getTopLevelScript(A){let e=this._blocks[A];if(void 0===e)return null;for(;null!==e.parent;)e=this._blocks[e.parent];return e.id}getProcedureDefinition(A){const e=this._cache.procedureDefinitions[A];if(void 0!==e)return e;for(const e in this._blocks){if(!this._blocks.hasOwnProperty(e))continue;const t=this._blocks[e];if("procedures_definition"===t.opcode||"procedures_definition_return"===t.opcode){const n=this._getCustomBlockInternal(t);if(n&&n.mutation.proccode===A)return this._cache.procedureDefinitions[A]=e,e}}return this._cache.procedureDefinitions[A]=null,null}getProcedureParamNamesAndIds(A){return this.getProcedureParamNamesIdsAndDefaults(A).slice(0,2)}getProcedureParamNamesIdsAndDefaults(A){const e=this._cache.procedureParamNames[A];if(void 0!==e)return e;for(const e in this._blocks){if(!this._blocks.hasOwnProperty(e))continue;const t=this._blocks[e];if("procedures_prototype"===t.opcode&&t.mutation.proccode===A){const e=JSON.parse(t.mutation.argumentnames),n=JSON.parse(t.mutation.argumentids),i=JSON.parse(t.mutation.argumentdefaults);return this._cache.procedureParamNames[A]=[e,n,i],this._cache.procedureParamNames[A]}}const t=this.runtime.getAddonBlock(A);return t?(this._cache.procedureParamNames[A]=t.namesIdsDefaults,t.namesIdsDefaults):(this._cache.procedureParamNames[A]=null,null)}populateProcedureCache(){if(!this._cache.proceduresPopulated){for(const A in this._blocks){if(!this._blocks.hasOwnProperty(A))continue;const e=this._blocks[A];if("procedures_prototype"!==e.opcode){if("procedures_definition"===e.opcode||"procedures_definition_return"===e.opcode){const t=this._getCustomBlockInternal(e);if(t){const e=t.mutation.proccode;this._cache.procedureDefinitions[e]||(this._cache.procedureDefinitions[e]=A);continue}}}else{const A=e.mutation.proccode;if(!this._cache.procedureParamNames[A]){const t=JSON.parse(e.mutation.argumentnames),n=JSON.parse(e.mutation.argumentids),i=JSON.parse(e.mutation.argumentdefaults);this._cache.procedureParamNames[A]=[t,n,i]}}}this._cache.proceduresPopulated=!0}}duplicate(){const A=new w(this.runtime,this.forceNoGlow);return A._blocks=a.simple(this._blocks),A._scripts=a.simple(this._scripts),A}blocklyListen(A){if("object"!=typeof A)return;if("string"!=typeof A.blockId&&"string"!=typeof A.varId&&"string"!=typeof A.commentId)return;const e=this.runtime.getTargetForStage(),t=this.runtime.getEditingTarget();if("stackclick"!==A.element)switch(A.type){case"create":{const e=i(A);for(let A=0;A<e.length;A++)this.createBlock(e[A]);break}case"change":this.changeBlock({id:A.blockId,element:A.element,name:A.name,value:A.newValue});break;case"move":this.moveBlock({id:A.blockId,oldParent:A.oldParentId,oldInput:A.oldInputName,newParent:A.newParentId,newInput:A.newInputName,newCoordinate:A.newCoordinate});break;case"dragOutside":this.runtime.emitBlockDragUpdate(A.isOutside);break;case"endDrag":if(this.runtime.emitBlockDragUpdate(!1),A.isOutside){const e=i(A);this.runtime.emitBlockEndDrag(e,A.blockId)}break;case"delete":if(!this._blocks.hasOwnProperty(A.blockId)||this._blocks[A.blockId].shadow)return;this._blocks[A.blockId].topLevel&&(this.runtime.quietGlow(A.blockId),this.runtime.compilerOptions.enabled&&setTimeout(()=>{if(!this._blocks[A.blockId]){const e=this.runtime.threads.find(e=>e.getId()==="".concat(t.id,"&").concat(A.blockId));e&&this.runtime._stopThread(e)}},100)),this.deleteBlock(A.blockId);break;case"var_create":if(this.resetCache(),A.isLocal&&t&&!t.isStage&&!A.isCloud)t.lookupVariableById(A.varId)||(t.createVariable(A.varId,A.varName,A.varType),this.runtime.emit("variableCreate",A.varType,A.varId,A.varName,A.isCloud),this.emitProjectChanged());else{if(e.lookupVariableById(A.varId))return;const t=this.runtime.targets.filter(A=>A.isOriginal);for(const e of t)if(e.lookupVariableByNameAndType(A.varName,A.varType,!0))return;e.createVariable(A.varId,A.varName,A.varType,A.isCloud),this.runtime.emit("variableCreate",A.varType,A.varId,A.varName,A.isCloud),this.emitProjectChanged()}break;case"var_rename":if(t&&t.variables.hasOwnProperty(A.varId))t.renameVariable(A.varId,A.newName),t.blocks.updateBlocksAfterVarRename(A.varId,A.newName);else{e.renameVariable(A.varId,A.newName);const t=this.runtime.targets;for(let e=0;e<t.length;e++){t[e].blocks.updateBlocksAfterVarRename(A.varId,A.newName)}}this.runtime.emit("variableChange",A.varType,A.varId,A.newName,A.oldName),this.emitProjectChanged();break;case"var_delete":{this.resetCache();const n=t&&t.variables.hasOwnProperty(A.varId)?t:e;this.runtime.emit("variableDelete",A.varType,A.varId),n.deleteVariable(A.varId),this.emitProjectChanged();break}case"comment_create":if(this.resetCache(),this.runtime.getEditingTarget()){const e=this.runtime.getEditingTarget();e.createComment(A.commentId,A.blockId,A.text,A.xy.x,A.xy.y,A.width,A.height,A.minimized),null===e.comments[A.commentId].x&&null===e.comments[A.commentId].y&&(e.comments[A.commentId].x=A.xy.x,e.comments[A.commentId].y=A.xy.y)}this.emitProjectChanged();break;case"comment_change":if(this.resetCache(),this.runtime.getEditingTarget()){const e=this.runtime.getEditingTarget();if(!e.comments.hasOwnProperty(A.commentId))return void E.warn("Cannot change comment with id ".concat(A.commentId," because it does not exist."));const t=e.comments[A.commentId],n=A.newContents_;n.hasOwnProperty("minimized")&&(t.minimized=n.minimized),n.hasOwnProperty("width")&&n.hasOwnProperty("height")&&(t.width=n.width,t.height=n.height),n.hasOwnProperty("text")&&(t.text=n.text),this.emitProjectChanged()}break;case"comment_move":if(this.runtime.getEditingTarget()){const e=this.runtime.getEditingTarget();if(e&&!e.comments.hasOwnProperty(A.commentId))return void E.warn("Cannot change comment with id ".concat(A.commentId," because it does not exist."));const t=e.comments[A.commentId],n=A.newCoordinate_;t.x=n.x,t.y=n.y,this.emitProjectChanged()}break;case"comment_delete":if(this.resetCache(),this.runtime.getEditingTarget()){const e=this.runtime.getEditingTarget();if(!e.comments.hasOwnProperty(A.commentId))return;if(delete e.comments[A.commentId],A.blockId){const t=e.blocks.getBlock(A.blockId);if(!t)return void E.warn("Could not find block referenced by comment with id: ".concat(A.commentId));delete t.comment}this.emitProjectChanged()}}else this.runtime.toggleScript(A.blockId,{stackClick:!0})}resetCache(){this._cache.inputs={},this._cache.procedureParamNames={},this._cache.procedureDefinitions={},this._cache._executeCached={},this._cache._monitored=null,this._cache.scripts={},this._cache.compiledScripts={},this._cache.compiledProcedures={},this._cache.proceduresPopulated=!1}emitProjectChanged(){this.forceNoGlow||this.runtime.emitProjectChanged()}createBlock(A){this._blocks.hasOwnProperty(A.id)||(this._blocks[A.id]=A,A.topLevel&&this._addScript(A.id),this.resetCache(),this.emitProjectChanged())}changeBlock(A){if(-1===["field","mutation","checkbox"].indexOf(A.element))return;let e=this._blocks[A.id];if(void 0!==e){switch(A.element){case"field":if(!e.fields[A.name])return;if("string"==typeof e.fields[A.name].variableType){const t=this.runtime.getEditingTarget().lookupVariableById(A.value);t&&(e.fields[A.name].value=t.name,e.fields[A.name].id=A.value)}else{e.fields[A.name].value=A.value,"sensing_of_object_menu"===e.opcode&&("_stage_"===e.fields.OBJECT.value?this._blocks[e.parent].fields.PROPERTY.value="backdrop #":this._blocks[e.parent].fields.PROPERTY.value="x position",this.runtime.requestBlocksUpdate());const t=e.shadow&&e.parent?this._blocks[e.parent]:e;t.isMonitored&&this.runtime.requestUpdateMonitor(B({id:t.id,params:this._getBlockParams(t)}))}if("object"==typeof ScratchBlocks){const e=this.runtime.getMonitorState(),t=void 0!==e.get("".concat(A.id,"_").concat(A.value))||void 0!==e.get("".concat(A.id,"_").concat(A.value.toLowerCase())),n=ScratchBlocks.mainWorkspace,i=(n.isFlyout?n:n.getFlyout()).checkboxes_[A.id];i&&(i.clicked=t,t?ScratchBlocks.utils.addClass(i.svgRoot,"checked"):ScratchBlocks.utils.removeClass(i.svgRoot,"checked"))}break;case"mutation":e.mutation=r(A.value);break;case"checkbox":{var t;if(e.fields&&Object.keys(e.fields).length>0&&"data_variable"!==e.opcode&&"data_listcontents"!==e.opcode){const A=u(e.id,e.fields);let t=this.runtime.monitorBlocks.getBlock(A);t||(t=JSON.parse(JSON.stringify(e)),t.id=A,this.runtime.monitorBlocks.createBlock(t)),e=t}const r=e.isMonitored;e.isMonitored=A.value;let a=!1;a="data_variable"===e.opcode?!this.runtime.getTargetForStage().variables[e.fields.VARIABLE.id]:"data_listcontents"===e.opcode?!this.runtime.getTargetForStage().variables[e.fields.LIST.id]:Object.values(e.fields).some(A=>void 0!==A.variableType&&("id"in A&&!this.runtime.getTargetForStage().variables[A.id]));var n=((A,t,n)=>{if(null==A)return!1;const i=A.blocks.find(A=>A.info.opcode===l.splitFirst(e.opcode,"_")[1]);return null!==(t=null==i||null===(n=i.info)||void 0===n?void 0:n.isSpriteSpecific)&&void 0!==t&&t})(vm.runtime._blockInfo.find(A=>A.id===l.splitFirst(e.opcode,"_")[0]));const B=a||this.runtime.monitorBlockInfo.hasOwnProperty(e.opcode)&&(null===(t=this.runtime.monitorBlockInfo[e.opcode])||void 0===t?void 0:t.isSpriteSpecific)||n;if(e.targetId=B?e.targetId||this.runtime.getEditingTarget().id:null,r&&!e.isMonitored)this.runtime.requestHideMonitor(e.id);else if(!r&&e.isMonitored){var i,o;if(!this.runtime.requestShowMonitor(e.id))this.runtime.requestAddMonitor(s({id:e.id,targetId:e.targetId,spriteName:e.targetId?this.runtime.getTargetById(e.targetId).getName():null,opcode:e.opcode,params:this._getBlockParams(e),value:"",mode:"data_listcontents"===e.opcode?"list":"default",variableType:null===(i=Object.values(e.fields)[0])||void 0===i?void 0:i.variableType,variableId:null===(o=Object.values(e.fields)[0])||void 0===o?void 0:o.id}))}break}}this.emitProjectChanged(),this.resetCache()}}moveBlock(A){if(!this._blocks.hasOwnProperty(A.id))return;const e=this._blocks[A.id];let t=!1;if(A.newCoordinate&&(t=e.x!==A.newCoordinate.x||e.y!==A.newCoordinate.y,e.x=A.newCoordinate.x,e.y=A.newCoordinate.y),void 0!==A.oldParent){const e=this._blocks[A.oldParent];void 0!==A.oldInput&&e.inputs[A.oldInput].block===A.id?e.inputs[A.oldInput].block=null:e.next===A.id&&(e.next=null),this._blocks[A.id].parent=null,t=!0}if(void 0===A.newParent)this._addScript(A.id);else{if(this._deleteScript(A.id),void 0===A.newInput)this._blocks[A.newParent].next=A.id;else{let e=null;this._blocks[A.newParent].inputs.hasOwnProperty(A.newInput)&&(e=this._blocks[A.newParent].inputs[A.newInput].shadow),this._blocks[A.id].shadow&&(e=A.id),this._blocks[A.newParent].inputs[A.newInput]={name:A.newInput,block:A.id,shadow:e}}this._blocks[A.id].parent=A.newParent,t=!0}this.resetCache(),t&&this.emitProjectChanged()}runAllMonitored(A){null===this._cache._monitored&&(this._cache._monitored=Object.keys(this._blocks).filter(A=>this.getBlock(A).isMonitored).map(e=>{const t=this.getBlock(e).targetId;return{blockId:e,target:t?A.getTargetById(t):null}}));const e=this._cache._monitored;for(let t=0;t<e.length;t++){const{blockId:n,target:i}=e[t];A.addMonitorScript(n,i)}}deleteBlock(A,e){const t=this._blocks[A];if(!t)return;if(null===t.next||e||this.deleteBlock(t.next),e){var n;const e=this._blocks[t.parent],i=this._blocks[t.next],r=null!=e&&e.inputs?null===(n=[...Object.entries(e.inputs)].find(e=>e[1].block===A))||void 0===n?void 0:n[1]:null;e&&!r&&(e.next=t.next),i&&(i.parent=t.parent),i&&r&&(r.block=t.next)}for(const A in t.inputs)null!==t.inputs[A].block&&this.deleteBlock(t.inputs[A].block),null!==t.inputs[A].shadow&&t.inputs[A].shadow!==t.inputs[A].block&&this.deleteBlock(t.inputs[A].shadow);e||this._deleteScript(A);const i=this._scripts.indexOf(A);if(e&&i>-1){const A=this._blocks[t.next];A&&(this._scripts.push(A.id),A.topLevel=!0,A.x=t.x,A.y=t.y),this._scripts.splice(i,1)}delete this._blocks[A],this.resetCache(),this.emitProjectChanged()}getAllVariableAndListReferences(A,e){const t=A||this._blocks,n=Object.create(null);for(const A in t){let i=null,r=null;if(t[A].fields.VARIABLE?(i=t[A].fields.VARIABLE,r=Q.SCALAR_TYPE):t[A].fields.LIST?(i=t[A].fields.LIST,r=Q.LIST_TYPE):e&&t[A].fields.BROADCAST_OPTION&&(i=t[A].fields.BROADCAST_OPTION,r=Q.BROADCAST_MESSAGE_TYPE),i){const A=i.id;n[A]?n[A].push({referencingField:i,type:r}):n[A]=[{referencingField:i,type:r}]}}return n}updateBlocksAfterVarRename(A,e){const t=this._blocks;for(const n in t){let i=null;if(t[n].fields.VARIABLE?i=t[n].fields.VARIABLE:t[n].fields.LIST&&(i=t[n].fields.LIST),i){A===i.id&&(i.value=e)}}}updateTargetSpecificBlocks(A){const e=this._blocks;for(const t in e)A&&"event_whenthisspriteclicked"===e[t].opcode?e[t].opcode="event_whenstageclicked":A||"event_whenstageclicked"!==e[t].opcode||(e[t].opcode="event_whenthisspriteclicked")}updateAssetName(A,e,t){let n,i,r=this.runtime.getEditingTarget();switch(t){case"costume":i="COSTUME_RENAMED",n=this._getCostumeField.bind(this);break;case"backdrop":r=this.runtime.getTargetForStage(),i="COSTUME_RENAMED",n=this._getBackdropField.bind(this);break;case"sound":i="SOUND_RENAMED",n=this._getSoundField.bind(this);break;case"sprite":i="SPRITE_RENAMED",n=this._getSpriteField.bind(this);break;default:return}const o=this._blocks;for(const t in o){const i=n(t);i&&i.value===A&&(i.value=e)}this.resetCache(),this.runtime.emit(i,{old:A,new:e},r)}updateSensingOfReference(A,e,t){const n=this._blocks;let i=!1;for(const r in n){const o=n[r];if("sensing_of"===o.opcode&&o.fields.PROPERTY.value===A&&o.inputs.OBJECT.block===o.inputs.OBJECT.shadow){this.getBlock(o.inputs.OBJECT.block).fields.OBJECT.value===t&&(o.fields.PROPERTY.value=e,i=!0)}}return i&&this.resetCache(),i}_getCostumeField(A){const e=this.getBlock(A);return e&&e.fields.hasOwnProperty("COSTUME")?e.fields.COSTUME:null}_getSoundField(A){const e=this.getBlock(A);return e&&e.fields.hasOwnProperty("SOUND_MENU")?e.fields.SOUND_MENU:null}_getBackdropField(A){const e=this.getBlock(A);return e&&e.fields.hasOwnProperty("BACKDROP")?e.fields.BACKDROP:null}_getSpriteField(A){const e=this.getBlock(A);if(!e)return null;const t=["TOWARDS","TO","OBJECT","VIDEOONMENU2","DISTANCETOMENU","TOUCHINGOBJECTMENU","CLONE_OPTION"];for(let A=0;A<t.length;A++){const n=t[A];if(e.fields.hasOwnProperty(n))return e.fields[n]}return null}toXML(A){return this._scripts.map(e=>this.blockToXML(e,A)).join()}blockToXML(A,e){const t=this._blocks[A];if(!t)return;const n=t.shadow?"shadow":"block";let i="<".concat(n,'\n                id="').concat(o(t.id),'"\n                type="').concat(o(t.opcode),'"\n                ').concat(t.topLevel?'x="'.concat(t.x,'" y="').concat(t.y,'"'):"","\n            >");const r=t.comment;r&&(e?e.hasOwnProperty(r)?i+=e[r].toXML():E.warn("Could not find comment with id: ".concat(r," in provided comment descriptions.")):E.warn("Cannot serialize comment with id: ".concat(r,"; no comment descriptions provided."))),t.mutation&&(i+=this.mutationToXML(t.mutation));for(const A in t.inputs){if(!t.inputs.hasOwnProperty(A))continue;const n=t.inputs[A];(n.block||n.shadow)&&(i+='<value name="'.concat(o(n.name),'">'),n.block&&(i+=this.blockToXML(n.block,e)),n.shadow&&n.shadow!==n.block&&(i+=this.blockToXML(n.shadow,e)),i+="</value>")}for(const A in t.fields){if(!t.fields.hasOwnProperty(A))continue;const e=t.fields[A];i+='<field name="'.concat(o(e.name),'"');const n=e.id;n&&(i+=' id="'.concat(o(n),'"'));const r=e.variableType;"string"==typeof r&&(i+=' variabletype="'.concat(o(r),'"'));let s=e.value;"string"==typeof s&&(s=o(e.value)),i+=">".concat(s,"</field>")}return t.next&&(i+="<next>".concat(this.blockToXML(t.next,e),"</next>")),i+="</".concat(n,">"),i}mutationToXML(A){if("string"==typeof A)return o(A);let e="<".concat(A.tagName);for(const t in A){if("children"===t||"tagName"===t)continue;let n="string"==typeof A[t]?o(A[t]):A[t];"blockInfo"===t&&(n=o(JSON.stringify(A[t]))),e+=" ".concat(t,'="').concat(n,'"')}e+=">";for(let t=0;t<A.children.length;t++)e+=this.mutationToXML(A.children[t]);return e+="</".concat(A.tagName,">"),e}_getBlockParams(A){const e={};for(const t in A.fields)e[t]=A.fields[t].value;for(const t in A.inputs){const n=this._blocks[A.inputs[t].block];for(const A in n.fields)e[A]=n.fields[A].value}return e}_getCustomBlockInternal(A){if(A.inputs&&A.inputs.custom_block)return this._blocks[A.inputs.custom_block.block]}_addScript(A){this._scripts.indexOf(A)>-1||(this._scripts.push(A),this._blocks[A].topLevel=!0)}_deleteScript(A){const e=this._scripts.indexOf(A);e>-1&&this._scripts.splice(e,1),this._blocks[A]&&(this._blocks[A].topLevel=!1)}}c.getCached=function(A,e,t){let n=A._cache._executeCached[e];if(void 0!==n)return n;const i=A.getBlock(e);return void 0===i?null:(n=void 0===t?{id:e,opcode:A.getOpcode(i),fields:A.getFields(i),inputs:A.getInputs(i),mutation:A.getMutation(i)}:new t(A,{id:e,opcode:A.getOpcode(i),fields:A.getFields(i),inputs:A.getInputs(i),mutation:A.getMutation(i)}),A._cache._executeCached[e]=n,n)};const h=g._RuntimeScriptCache;g.getScripts=function(A,e){let t=A._cache.scripts[e];if(!t){t=A._cache.scripts[e]=[];const n=A._scripts;for(let i=0;i<n.length;i++){const r=n[i];A.getBlock(r).opcode===e&&t.push(new h(A,r))}}return t},A.exports=w},function(A,e,t){const n=t(149),i=t(150);class r{static base64ToUint8Array(A){const e=n(A),t=e.length,i=new Uint8Array(t);for(let A=0;A<t;A++)i[A]=e.charCodeAt(A);return i}static uint8ArrayToBase64(A){let e="";const t=A.byteLength;for(let n=0;n<t;n++)e+=String.fromCharCode(A[n]);return i(e)}static arrayBufferToBase64(A){return r.uint8ArrayToBase64(new Uint8Array(A))}}A.exports=r},function(A,e,t){const n=t(5),i=function(A){if("string"!=typeof A){if(!Array.isArray(A))return n.warn("Unexptected type ".concat(typeof A," in xmlEscape at: ").concat((new Error).stack)),A;A=String(A)}return A.replace(/[<>&'"]/g,A=>{switch(A){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case"'":return"&apos;";case'"':return"&quot;"}})};A.exports=i,A.exports.escapeAttribute=A=>{const e=i(A);return JSON.stringify(e).slice(1,-1)}},function(A,e,t){(function(e){A.exports=class{bufferToArray(A,e){A=new DataView(A);const t=[],n="function"==typeof e?e:A=>A;for(let e=0;e<A.byteLength;e++){const i=A.getUint8(e);t.push(n(i))}return t}arrayToBuffer(A,t){t="function"==typeof e?t:A=>A;const n=new ArrayBuffer(A.length),i=new DataView(n);return A.forEach((A,e)=>{A=t(A),i.setUint8(e,A)}),i.buffer}uint8ArrayToBuffer(A){return A.buffer.slice(A.byteOffset,A.byteLength+A.byteOffset)}bufferToUint8Array(A){return new Uint8Array(A)}bufferToString(A,e,t){e||(e=" ");return this.bufferToArray(A).map("function"==typeof t?t:A=>A.toString(16)).map(A=>A.length<2?"0".concat(A):A).join(e)}}}).call(this,t(40))},function(A,e){function t(A){for(var e=[[A.x,A.y]];A.parent;)A=A.parent,e.push([A.x,A.y]);return e.reverse()}function n(A,e,t,n){var i,r,o,s,a,B,c=Math.abs,g=[];for(i=A<t?1:-1,r=e<n?1:-1,a=(o=c(t-A))-(s=c(n-e));g.push([A,e]),A!==t||e!==n;)(B=2*a)>-s&&(a-=s,A+=i),B<o&&(a+=o,e+=r);return g}e.backtrace=t,e.biBacktrace=function(A,e){var n=t(A),i=t(e);return n.concat(i.reverse())},e.pathLength=function(A){var e,t,n,i,r,o=0;for(e=1;e<A.length;++e)t=A[e-1],n=A[e],i=t[0]-n[0],r=t[1]-n[1],o+=Math.sqrt(i*i+r*r);return o},e.interpolate=n,e.expandPath=function(A){var e,t,i,r,o,s,a=[],B=A.length;if(B<2)return a;for(o=0;o<B-1;++o)for(e=A[o],t=A[o+1],r=(i=n(e[0],e[1],t[0],t[1])).length,s=0;s<r-1;++s)a.push(i[s]);return a.push(A[B-1]),a},e.smoothenPath=function(A,e){var t,i,r,o,s,a,B,c,g,E=e.length,Q=e[0][0],u=e[0][1],l=e[E-1][0],w=e[E-1][1];for(r=[[t=Q,i=u]],o=2;o<E;++o){for(B=n(t,i,(a=e[o])[0],a[1]),g=!1,s=1;s<B.length;++s)if(c=B[s],!A.isWalkableAt(c[0],c[1])){g=!0;break}g&&(lastValidCoord=e[o-1],r.push(lastValidCoord),t=lastValidCoord[0],i=lastValidCoord[1])}return r.push([l,w]),r},e.compressPath=function(A){if(A.length<3)return A;var e,t,n,i,r,o,s=[],a=A[0][0],B=A[0][1],c=A[1][0],g=A[1][1],E=c-a,Q=g-B;for(E/=r=Math.sqrt(E*E+Q*Q),Q/=r,s.push([a,B]),o=2;o<A.length;o++)e=c,t=g,n=E,i=Q,E=(c=A[o][0])-e,Q=(g=A[o][1])-t,Q/=r=Math.sqrt(E*E+Q*Q),(E/=r)===n&&Q===i||s.push([e,t]);return s.push([c,g]),s}},function(A,e,t){"use strict";var n,i="object"==typeof Reflect?Reflect:null,r=i&&"function"==typeof i.apply?i.apply:function(A,e,t){return Function.prototype.apply.call(A,e,t)};n=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(A){return Object.getOwnPropertyNames(A).concat(Object.getOwnPropertySymbols(A))}:function(A){return Object.getOwnPropertyNames(A)};var o=Number.isNaN||function(A){return A!=A};function s(){s.init.call(this)}A.exports=s,A.exports.once=function(A,e){return new Promise((function(t,n){function i(t){A.removeListener(e,r),n(t)}function r(){"function"==typeof A.removeListener&&A.removeListener("error",i),t([].slice.call(arguments))}h(A,e,r,{once:!0}),"error"!==e&&function(A,e,t){"function"==typeof A.on&&h(A,"error",e,t)}(A,i,{once:!0})}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var a=10;function B(A){if("function"!=typeof A)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof A)}function c(A){return void 0===A._maxListeners?s.defaultMaxListeners:A._maxListeners}function g(A,e,t,n){var i,r,o,s;if(B(t),void 0===(r=A._events)?(r=A._events=Object.create(null),A._eventsCount=0):(void 0!==r.newListener&&(A.emit("newListener",e,t.listener?t.listener:t),r=A._events),o=r[e]),void 0===o)o=r[e]=t,++A._eventsCount;else if("function"==typeof o?o=r[e]=n?[t,o]:[o,t]:n?o.unshift(t):o.push(t),(i=c(A))>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=A,a.type=e,a.count=o.length,s=a,console&&console.warn&&console.warn(s)}return A}function E(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Q(A,e,t){var n={fired:!1,wrapFn:void 0,target:A,type:e,listener:t},i=E.bind(n);return i.listener=t,n.wrapFn=i,i}function u(A,e,t){var n=A._events;if(void 0===n)return[];var i=n[e];return void 0===i?[]:"function"==typeof i?t?[i.listener||i]:[i]:t?function(A){for(var e=new Array(A.length),t=0;t<e.length;++t)e[t]=A[t].listener||A[t];return e}(i):w(i,i.length)}function l(A){var e=this._events;if(void 0!==e){var t=e[A];if("function"==typeof t)return 1;if(void 0!==t)return t.length}return 0}function w(A,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=A[n];return t}function h(A,e,t,n){if("function"==typeof A.on)n.once?A.once(e,t):A.on(e,t);else{if("function"!=typeof A.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof A);A.addEventListener(e,(function i(r){n.once&&A.removeEventListener(e,i),t(r)}))}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(A){if("number"!=typeof A||A<0||o(A))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+A+".");a=A}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(A){if("number"!=typeof A||A<0||o(A))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+A+".");return this._maxListeners=A,this},s.prototype.getMaxListeners=function(){return c(this)},s.prototype.emit=function(A){for(var e=[],t=1;t<arguments.length;t++)e.push(arguments[t]);var n="error"===A,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var o;if(e.length>0&&(o=e[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var a=i[A];if(void 0===a)return!1;if("function"==typeof a)r(a,this,e);else{var B=a.length,c=w(a,B);for(t=0;t<B;++t)r(c[t],this,e)}return!0},s.prototype.addListener=function(A,e){return g(this,A,e,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(A,e){return g(this,A,e,!0)},s.prototype.once=function(A,e){return B(e),this.on(A,Q(this,A,e)),this},s.prototype.prependOnceListener=function(A,e){return B(e),this.prependListener(A,Q(this,A,e)),this},s.prototype.removeListener=function(A,e){var t,n,i,r,o;if(B(e),void 0===(n=this._events))return this;if(void 0===(t=n[A]))return this;if(t===e||t.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete n[A],n.removeListener&&this.emit("removeListener",A,t.listener||e));else if("function"!=typeof t){for(i=-1,r=t.length-1;r>=0;r--)if(t[r]===e||t[r].listener===e){o=t[r].listener,i=r;break}if(i<0)return this;0===i?t.shift():function(A,e){for(;e+1<A.length;e++)A[e]=A[e+1];A.pop()}(t,i),1===t.length&&(n[A]=t[0]),void 0!==n.removeListener&&this.emit("removeListener",A,o||e)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(A){var e,t,n;if(void 0===(t=this._events))return this;if(void 0===t.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==t[A]&&(0==--this._eventsCount?this._events=Object.create(null):delete t[A]),this;if(0===arguments.length){var i,r=Object.keys(t);for(n=0;n<r.length;++n)"removeListener"!==(i=r[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=t[A]))this.removeListener(A,e);else if(void 0!==e)for(n=e.length-1;n>=0;n--)this.removeListener(A,e[n]);return this},s.prototype.listeners=function(A){return u(this,A,!0)},s.prototype.rawListeners=function(A){return u(this,A,!1)},s.listenerCount=function(A,e){return"function"==typeof A.listenerCount?A.listenerCount(e):l.call(A,e)},s.prototype.listenerCount=l,s.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]}},function(A,e,t){const n=t(9),i="'none'",r={accelerometer:i,"ambient-light-sensor":i,battery:i,camera:i,"display-capture":i,"document-domain":i,"encrypted-media":i,fullscreen:i,geolocation:i,gyroscope:i,magnetometer:i,microphone:i,midi:i,payment:i,"picture-in-picture":i,"publickey-credentials-get":i,"speaker-selection":i,usb:i,vibrate:i,vr:i,"screen-wake-lock":i,"web-share":i,"interest-cohort":i},o=()=>{const A=document.createElement("iframe"),e=n()+n()+n()+n();return A.dataset.id=e,A.style.display="none",A.setAttribute("aria-hidden","true"),A.sandbox="allow-scripts allow-modals",A.allow=Object.entries(r).map(A=>{let[e,t]=A;return"".concat(e," ").concat(t)}).join("; "),document.body.append(A),A},s=(window.origin,(A,e)=>{const t=["<!DOCTYPE html>",'<html lang="en-US">',"<head>","<title>the an one of an iframe</title>","</head>","<body>","<h1><p>epic computing in progress...</p></h1>","<script>","(async () => {\n    let result = null;\n    let success = true;\n    try {\n        // techincally eval can also postMessage\n        // and also modify success & result probably\n        // but theres no real reason to prevent it\n        // nor does the user have any reason to do it\n        result = await eval(".concat((A=>JSON.stringify(A).replaceAll("<\/script>","<\\/script>"))(A),");\n    } catch (err) {\n        success = false;\n        result = err;\n    }\n\n    const parent = window.parent;\n    const origin = '*';\n    // console.log(result,success);\n    console.log(origin);\n\n    try {\n        parent.postMessage({\n            payload: {\n                success: success,\n                value: result,\n                id: ").concat(JSON.stringify(e.dataset.id),"\n            },\n        }, origin);\n    } catch (topLevelError) {\n        // couldnt clone likely\n        try {\n            parent.postMessage({\n                payload: {\n                    success: success,\n                    value: JSON.stringify(result),\n                    id: ").concat(JSON.stringify(e.dataset.id),'\n                },\n            }, origin);\n        } catch (err) {\n            // ok we cant stringify it just error\n            parent.postMessage({\n                payload: {\n                    success: false,\n                    value: [String(topLevelError), String(err)].join("; "),\n                    id: ').concat(JSON.stringify(e.dataset.id),"\n                },\n            }, origin);\n        }\n    }\n})();"),"<\/script>","</body>","</html>"].join("\n"),n=new Blob([t],{type:"text/html;charset=UTF-8"});return URL.createObjectURL(n)});A.exports=class{static execute(A){return new Promise(e=>{const t=o(),n=A=>{var i,r,o;(i=A,r=t,o=n,new Promise(A=>{if(!i.data.payload)return;if(i.data.payload.id!==r.dataset.id)return;const e=i.data.payload;window.removeEventListener("message",o);try{const A=r.src;URL.revokeObjectURL(A)}catch(A){console.warn("failed to revoke url of iframe sandboxed eval")}r.remove(),A(e)})).then(A=>{e({success:A.success,value:A.value})})};window.addEventListener("message",n),t.src=s(A,t)})}}},function(A,e,t){const n=t(17),i=t(50),r=t(456);A.exports=class{constructor(A,e){this._renderer=e,this._id=A,this._rotationCenter=n.v3.create(0,0),this._texture=null,this._uniforms={u_skinSize:[0,0],u_skin:null},this._silhouette=new r,this.private=!1}dispose(){this._id=i.ID_NONE}get id(){return this._id}get rotationCenter(){return this._rotationCenter}get size(){return[0,0]}useNearest(A,e){return!0}calculateRotationCenter(){return[this.size[0]/2,this.size[1]/2]}getTexture(A,e){return this._emptyImageTexture}getFenceBounds(A,e){return A.getAABB(e)}getUniforms(A){return this._uniforms.u_skin=this.getTexture(A),this._uniforms.u_skinSize=this.size,this._uniforms}emitWasAltered(){this._renderer.skinWasAltered(this)}updateSilhouette(){this._silhouette.unlazy()}_setTexture(A){const e=this._renderer.gl;e.bindTexture(e.TEXTURE_2D,this._texture),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,A),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),this._silhouette.update(A)}setEmptyImageData(){if(this._texture=null,!this._emptyImageData){this._emptyImageData=new ImageData(1,1);const A=this._renderer.gl,e={auto:!0,wrap:A.CLAMP_TO_EDGE,src:this._emptyImageData};this._emptyImageTexture=n.createTexture(A,e)}this._rotationCenter[0]=0,this._rotationCenter[1]=0,this._silhouette.update(this._emptyImageData),this.emitWasAltered()}isTouchingNearest(A){return this._silhouette.isTouchingNearest(A)}isTouchingLinear(A){return this._silhouette.isTouchingLinear(A)}}},function(A,e,t){t(81),A.exports={TextEncoder:TextEncoder,TextDecoder:TextDecoder}},function(A,e,t){const n=t(412),i=t(433),r=t(107),o=t(103),s=t(435),a=t(106),B=t(70),c=t(104),g=t(436),E=t(69);A.exports={BitmapAdapter:i,convertFonts:c,inlineSvgFonts:r,loadSvgString:o,sanitizeSvg:s,serializeSvgToString:a,SvgElement:B,SVGRenderer:n,fixForVanilla:g,DOMPurify:E}},function(module,exports,__webpack_require__){(function(process,global){var __WEBPACK_AMD_DEFINE_RESULT__;
/**
 * [js-md5]{@link https://github.com/emn178/js-md5}
 *
 * @namespace md5
 * @version 0.7.3
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2017
 * @license MIT
 */!function(){"use strict";var ERROR="input is invalid type",WINDOW="object"==typeof window,root=WINDOW?window:{};root.JS_MD5_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&"object"==typeof self,NODE_JS=!root.JS_MD5_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;NODE_JS?root=global:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_MD5_NO_COMMON_JS&&"object"==typeof module&&module.exports,AMD=__webpack_require__(440),ARRAY_BUFFER=!root.JS_MD5_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,HEX_CHARS="0123456789abcdef".split(""),EXTRA=[128,32768,8388608,-2147483648],SHIFT=[0,8,16,24],OUTPUT_TYPES=["hex","array","digest","buffer","arrayBuffer","base64"],BASE64_ENCODE_CHAR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),blocks=[],buffer8;if(ARRAY_BUFFER){var buffer=new ArrayBuffer(68);buffer8=new Uint8Array(buffer),blocks=new Uint32Array(buffer)}!root.JS_MD5_NO_NODE_JS&&Array.isArray||(Array.isArray=function(A){return"[object Array]"===Object.prototype.toString.call(A)}),!ARRAY_BUFFER||!root.JS_MD5_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(A){return"object"==typeof A&&A.buffer&&A.buffer.constructor===ArrayBuffer});var createOutputMethod=function(A){return function(e){return new Md5(!0).update(e)[A]()}},createMethod=function(){var A=createOutputMethod("hex");NODE_JS&&(A=nodeWrap(A)),A.create=function(){return new Md5},A.update=function(e){return A.create().update(e)};for(var e=0;e<OUTPUT_TYPES.length;++e){var t=OUTPUT_TYPES[e];A[t]=createOutputMethod(t)}return A},nodeWrap=function nodeWrap(method){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),nodeMethod=function(A){if("string"==typeof A)return crypto.createHash("md5").update(A,"utf8").digest("hex");if(null==A)throw ERROR;return A.constructor===ArrayBuffer&&(A=new Uint8Array(A)),Array.isArray(A)||ArrayBuffer.isView(A)||A.constructor===Buffer?crypto.createHash("md5").update(new Buffer(A)).digest("hex"):method(A)};return nodeMethod};function Md5(A){if(A)blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks,this.buffer8=buffer8;else if(ARRAY_BUFFER){var e=new ArrayBuffer(68);this.buffer8=new Uint8Array(e),this.blocks=new Uint32Array(e)}else this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.h0=this.h1=this.h2=this.h3=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}Md5.prototype.update=function(A){if(!this.finalized){var e,t=typeof A;if("string"!==t){if("object"!==t)throw ERROR;if(null===A)throw ERROR;if(ARRAY_BUFFER&&A.constructor===ArrayBuffer)A=new Uint8Array(A);else if(!(Array.isArray(A)||ARRAY_BUFFER&&ArrayBuffer.isView(A)))throw ERROR;e=!0}for(var n,i,r=0,o=A.length,s=this.blocks,a=this.buffer8;r<o;){if(this.hashed&&(this.hashed=!1,s[0]=s[16],s[16]=s[1]=s[2]=s[3]=s[4]=s[5]=s[6]=s[7]=s[8]=s[9]=s[10]=s[11]=s[12]=s[13]=s[14]=s[15]=0),e)if(ARRAY_BUFFER)for(i=this.start;r<o&&i<64;++r)a[i++]=A[r];else for(i=this.start;r<o&&i<64;++r)s[i>>2]|=A[r]<<SHIFT[3&i++];else if(ARRAY_BUFFER)for(i=this.start;r<o&&i<64;++r)(n=A.charCodeAt(r))<128?a[i++]=n:n<2048?(a[i++]=192|n>>6,a[i++]=128|63&n):n<55296||n>=57344?(a[i++]=224|n>>12,a[i++]=128|n>>6&63,a[i++]=128|63&n):(n=65536+((1023&n)<<10|1023&A.charCodeAt(++r)),a[i++]=240|n>>18,a[i++]=128|n>>12&63,a[i++]=128|n>>6&63,a[i++]=128|63&n);else for(i=this.start;r<o&&i<64;++r)(n=A.charCodeAt(r))<128?s[i>>2]|=n<<SHIFT[3&i++]:n<2048?(s[i>>2]|=(192|n>>6)<<SHIFT[3&i++],s[i>>2]|=(128|63&n)<<SHIFT[3&i++]):n<55296||n>=57344?(s[i>>2]|=(224|n>>12)<<SHIFT[3&i++],s[i>>2]|=(128|n>>6&63)<<SHIFT[3&i++],s[i>>2]|=(128|63&n)<<SHIFT[3&i++]):(n=65536+((1023&n)<<10|1023&A.charCodeAt(++r)),s[i>>2]|=(240|n>>18)<<SHIFT[3&i++],s[i>>2]|=(128|n>>12&63)<<SHIFT[3&i++],s[i>>2]|=(128|n>>6&63)<<SHIFT[3&i++],s[i>>2]|=(128|63&n)<<SHIFT[3&i++]);this.lastByteIndex=i,this.bytes+=i-this.start,i>=64?(this.start=i-64,this.hash(),this.hashed=!0):this.start=i}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Md5.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var A=this.blocks,e=this.lastByteIndex;A[e>>2]|=EXTRA[3&e],e>=56&&(this.hashed||this.hash(),A[0]=A[16],A[16]=A[1]=A[2]=A[3]=A[4]=A[5]=A[6]=A[7]=A[8]=A[9]=A[10]=A[11]=A[12]=A[13]=A[14]=A[15]=0),A[14]=this.bytes<<3,A[15]=this.hBytes<<3|this.bytes>>>29,this.hash()}},Md5.prototype.hash=function(){var A,e,t,n,i,r,o=this.blocks;this.first?e=((e=((A=((A=o[0]-680876937)<<7|A>>>25)-271733879<<0)^(t=((t=(-271733879^(n=((n=(-1732584194^2004318071&A)+o[1]-117830708)<<12|n>>>20)+A<<0)&(-271733879^A))+o[2]-1126478375)<<17|t>>>15)+n<<0)&(n^A))+o[3]-1316259209)<<22|e>>>10)+t<<0:(A=this.h0,e=this.h1,t=this.h2,e=((e+=((A=((A+=((n=this.h3)^e&(t^n))+o[0]-680876936)<<7|A>>>25)+e<<0)^(t=((t+=(e^(n=((n+=(t^A&(e^t))+o[1]-389564586)<<12|n>>>20)+A<<0)&(A^e))+o[2]+606105819)<<17|t>>>15)+n<<0)&(n^A))+o[3]-1044525330)<<22|e>>>10)+t<<0),e=((e+=((A=((A+=(n^e&(t^n))+o[4]-176418897)<<7|A>>>25)+e<<0)^(t=((t+=(e^(n=((n+=(t^A&(e^t))+o[5]+1200080426)<<12|n>>>20)+A<<0)&(A^e))+o[6]-1473231341)<<17|t>>>15)+n<<0)&(n^A))+o[7]-45705983)<<22|e>>>10)+t<<0,e=((e+=((A=((A+=(n^e&(t^n))+o[8]+1770035416)<<7|A>>>25)+e<<0)^(t=((t+=(e^(n=((n+=(t^A&(e^t))+o[9]-1958414417)<<12|n>>>20)+A<<0)&(A^e))+o[10]-42063)<<17|t>>>15)+n<<0)&(n^A))+o[11]-1990404162)<<22|e>>>10)+t<<0,e=((e+=((A=((A+=(n^e&(t^n))+o[12]+1804603682)<<7|A>>>25)+e<<0)^(t=((t+=(e^(n=((n+=(t^A&(e^t))+o[13]-40341101)<<12|n>>>20)+A<<0)&(A^e))+o[14]-1502002290)<<17|t>>>15)+n<<0)&(n^A))+o[15]+1236535329)<<22|e>>>10)+t<<0,e=((e+=((n=((n+=(e^t&((A=((A+=(t^n&(e^t))+o[1]-165796510)<<5|A>>>27)+e<<0)^e))+o[6]-1069501632)<<9|n>>>23)+A<<0)^A&((t=((t+=(A^e&(n^A))+o[11]+643717713)<<14|t>>>18)+n<<0)^n))+o[0]-373897302)<<20|e>>>12)+t<<0,e=((e+=((n=((n+=(e^t&((A=((A+=(t^n&(e^t))+o[5]-701558691)<<5|A>>>27)+e<<0)^e))+o[10]+38016083)<<9|n>>>23)+A<<0)^A&((t=((t+=(A^e&(n^A))+o[15]-660478335)<<14|t>>>18)+n<<0)^n))+o[4]-405537848)<<20|e>>>12)+t<<0,e=((e+=((n=((n+=(e^t&((A=((A+=(t^n&(e^t))+o[9]+568446438)<<5|A>>>27)+e<<0)^e))+o[14]-1019803690)<<9|n>>>23)+A<<0)^A&((t=((t+=(A^e&(n^A))+o[3]-187363961)<<14|t>>>18)+n<<0)^n))+o[8]+1163531501)<<20|e>>>12)+t<<0,e=((e+=((n=((n+=(e^t&((A=((A+=(t^n&(e^t))+o[13]-1444681467)<<5|A>>>27)+e<<0)^e))+o[2]-51403784)<<9|n>>>23)+A<<0)^A&((t=((t+=(A^e&(n^A))+o[7]+1735328473)<<14|t>>>18)+n<<0)^n))+o[12]-1926607734)<<20|e>>>12)+t<<0,e=((e+=((r=(n=((n+=((i=e^t)^(A=((A+=(i^n)+o[5]-378558)<<4|A>>>28)+e<<0))+o[8]-2022574463)<<11|n>>>21)+A<<0)^A)^(t=((t+=(r^e)+o[11]+1839030562)<<16|t>>>16)+n<<0))+o[14]-35309556)<<23|e>>>9)+t<<0,e=((e+=((r=(n=((n+=((i=e^t)^(A=((A+=(i^n)+o[1]-1530992060)<<4|A>>>28)+e<<0))+o[4]+1272893353)<<11|n>>>21)+A<<0)^A)^(t=((t+=(r^e)+o[7]-155497632)<<16|t>>>16)+n<<0))+o[10]-1094730640)<<23|e>>>9)+t<<0,e=((e+=((r=(n=((n+=((i=e^t)^(A=((A+=(i^n)+o[13]+681279174)<<4|A>>>28)+e<<0))+o[0]-358537222)<<11|n>>>21)+A<<0)^A)^(t=((t+=(r^e)+o[3]-722521979)<<16|t>>>16)+n<<0))+o[6]+76029189)<<23|e>>>9)+t<<0,e=((e+=((r=(n=((n+=((i=e^t)^(A=((A+=(i^n)+o[9]-640364487)<<4|A>>>28)+e<<0))+o[12]-421815835)<<11|n>>>21)+A<<0)^A)^(t=((t+=(r^e)+o[15]+530742520)<<16|t>>>16)+n<<0))+o[2]-995338651)<<23|e>>>9)+t<<0,e=((e+=((n=((n+=(e^((A=((A+=(t^(e|~n))+o[0]-198630844)<<6|A>>>26)+e<<0)|~t))+o[7]+1126891415)<<10|n>>>22)+A<<0)^((t=((t+=(A^(n|~e))+o[14]-1416354905)<<15|t>>>17)+n<<0)|~A))+o[5]-57434055)<<21|e>>>11)+t<<0,e=((e+=((n=((n+=(e^((A=((A+=(t^(e|~n))+o[12]+1700485571)<<6|A>>>26)+e<<0)|~t))+o[3]-1894986606)<<10|n>>>22)+A<<0)^((t=((t+=(A^(n|~e))+o[10]-1051523)<<15|t>>>17)+n<<0)|~A))+o[1]-2054922799)<<21|e>>>11)+t<<0,e=((e+=((n=((n+=(e^((A=((A+=(t^(e|~n))+o[8]+1873313359)<<6|A>>>26)+e<<0)|~t))+o[15]-30611744)<<10|n>>>22)+A<<0)^((t=((t+=(A^(n|~e))+o[6]-1560198380)<<15|t>>>17)+n<<0)|~A))+o[13]+1309151649)<<21|e>>>11)+t<<0,e=((e+=((n=((n+=(e^((A=((A+=(t^(e|~n))+o[4]-145523070)<<6|A>>>26)+e<<0)|~t))+o[11]-1120210379)<<10|n>>>22)+A<<0)^((t=((t+=(A^(n|~e))+o[2]+718787259)<<15|t>>>17)+n<<0)|~A))+o[9]-343485551)<<21|e>>>11)+t<<0,this.first?(this.h0=A+1732584193<<0,this.h1=e-271733879<<0,this.h2=t-1732584194<<0,this.h3=n+271733878<<0,this.first=!1):(this.h0=this.h0+A<<0,this.h1=this.h1+e<<0,this.h2=this.h2+t<<0,this.h3=this.h3+n<<0)},Md5.prototype.hex=function(){this.finalize();var A=this.h0,e=this.h1,t=this.h2,n=this.h3;return HEX_CHARS[A>>4&15]+HEX_CHARS[15&A]+HEX_CHARS[A>>12&15]+HEX_CHARS[A>>8&15]+HEX_CHARS[A>>20&15]+HEX_CHARS[A>>16&15]+HEX_CHARS[A>>28&15]+HEX_CHARS[A>>24&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[15&e]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[t>>4&15]+HEX_CHARS[15&t]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[n>>4&15]+HEX_CHARS[15&n]+HEX_CHARS[n>>12&15]+HEX_CHARS[n>>8&15]+HEX_CHARS[n>>20&15]+HEX_CHARS[n>>16&15]+HEX_CHARS[n>>28&15]+HEX_CHARS[n>>24&15]},Md5.prototype.toString=Md5.prototype.hex,Md5.prototype.digest=function(){this.finalize();var A=this.h0,e=this.h1,t=this.h2,n=this.h3;return[255&A,A>>8&255,A>>16&255,A>>24&255,255&e,e>>8&255,e>>16&255,e>>24&255,255&t,t>>8&255,t>>16&255,t>>24&255,255&n,n>>8&255,n>>16&255,n>>24&255]},Md5.prototype.array=Md5.prototype.digest,Md5.prototype.arrayBuffer=function(){this.finalize();var A=new ArrayBuffer(16),e=new Uint32Array(A);return e[0]=this.h0,e[1]=this.h1,e[2]=this.h2,e[3]=this.h3,A},Md5.prototype.buffer=Md5.prototype.arrayBuffer,Md5.prototype.base64=function(){for(var A,e,t,n="",i=this.array(),r=0;r<15;)A=i[r++],e=i[r++],t=i[r++],n+=BASE64_ENCODE_CHAR[A>>>2]+BASE64_ENCODE_CHAR[63&(A<<4|e>>>4)]+BASE64_ENCODE_CHAR[63&(e<<2|t>>>6)]+BASE64_ENCODE_CHAR[63&t];return A=i[r],n+=BASE64_ENCODE_CHAR[A>>>2]+BASE64_ENCODE_CHAR[A<<4&63]+"=="};var exports=createMethod();COMMON_JS?module.exports=exports:(root.md5=exports,AMD&&(__WEBPACK_AMD_DEFINE_RESULT__=function(){return exports}.call(exports,__webpack_require__,exports,module),void 0===__WEBPACK_AMD_DEFINE_RESULT__||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)))}()}).call(this,__webpack_require__(40),__webpack_require__(14))},function(A,e,t){(function(e,t,n,i){A.exports=function A(e,t,n){function i(o,s){if(!t[o]){if(!e[o]){if(r)return r(o,!0);var a=new Error("Cannot find module '"+o+"'");throw a.code="MODULE_NOT_FOUND",a}var B=t[o]={exports:{}};e[o][0].call(B.exports,(function(A){return i(e[o][1][A]||A)}),B,B.exports,A,e,t,n)}return t[o].exports}for(var r=!1,o=0;o<n.length;o++)i(n[o]);return i}({1:[function(A,e,t){"use strict";var n=A("./utils"),i=A("./support"),r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.encode=function(A){for(var e,t,i,o,s,a,B,c=[],g=0,E=A.length,Q=E,u="string"!==n.getTypeOf(A);g<A.length;)Q=E-g,i=u?(e=A[g++],t=g<E?A[g++]:0,g<E?A[g++]:0):(e=A.charCodeAt(g++),t=g<E?A.charCodeAt(g++):0,g<E?A.charCodeAt(g++):0),o=e>>2,s=(3&e)<<4|t>>4,a=1<Q?(15&t)<<2|i>>6:64,B=2<Q?63&i:64,c.push(r.charAt(o)+r.charAt(s)+r.charAt(a)+r.charAt(B));return c.join("")},t.decode=function(A){var e,t,n,o,s,a,B=0,c=0,g="data:";if(A.substr(0,g.length)===g)throw new Error("Invalid base64 input, it looks like a data url.");var E,Q=3*(A=A.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(A.charAt(A.length-1)===r.charAt(64)&&Q--,A.charAt(A.length-2)===r.charAt(64)&&Q--,Q%1!=0)throw new Error("Invalid base64 input, bad content length.");for(E=i.uint8array?new Uint8Array(0|Q):new Array(0|Q);B<A.length;)e=r.indexOf(A.charAt(B++))<<2|(o=r.indexOf(A.charAt(B++)))>>4,t=(15&o)<<4|(s=r.indexOf(A.charAt(B++)))>>2,n=(3&s)<<6|(a=r.indexOf(A.charAt(B++))),E[c++]=e,64!==s&&(E[c++]=t),64!==a&&(E[c++]=n);return E}},{"./support":30,"./utils":32}],2:[function(A,e,t){"use strict";var n=A("./external"),i=A("./stream/DataWorker"),r=A("./stream/Crc32Probe"),o=A("./stream/DataLengthProbe");function s(A,e,t,n,i){this.compressedSize=A,this.uncompressedSize=e,this.crc32=t,this.compression=n,this.compressedContent=i}s.prototype={getContentWorker:function(){var A=new i(n.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new o("data_length")),e=this;return A.on("end",(function(){if(this.streamInfo.data_length!==e.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),A},getCompressedWorker:function(){return new i(n.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},s.createWorkerFrom=function(A,e,t){return A.pipe(new r).pipe(new o("uncompressedSize")).pipe(e.compressWorker(t)).pipe(new o("compressedSize")).withStreamInfo("compression",e)},e.exports=s},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(A,e,t){"use strict";var n=A("./stream/GenericWorker");t.STORE={magic:"\0\0",compressWorker:function(){return new n("STORE compression")},uncompressWorker:function(){return new n("STORE decompression")}},t.DEFLATE=A("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(A,e,t){"use strict";var n=A("./utils"),i=function(){for(var A,e=[],t=0;t<256;t++){A=t;for(var n=0;n<8;n++)A=1&A?3988292384^A>>>1:A>>>1;e[t]=A}return e}();e.exports=function(A,e){return void 0!==A&&A.length?"string"!==n.getTypeOf(A)?function(A,e,t,n){var r=i,o=0+t;A^=-1;for(var s=0;s<o;s++)A=A>>>8^r[255&(A^e[s])];return-1^A}(0|e,A,A.length):function(A,e,t,n){var r=i,o=0+t;A^=-1;for(var s=0;s<o;s++)A=A>>>8^r[255&(A^e.charCodeAt(s))];return-1^A}(0|e,A,A.length):0}},{"./utils":32}],5:[function(A,e,t){"use strict";t.base64=!1,t.binary=!1,t.dir=!1,t.createFolders=!0,t.date=null,t.compression=null,t.compressionOptions=null,t.comment=null,t.unixPermissions=null,t.dosPermissions=null},{}],6:[function(A,e,t){"use strict";var n;n="undefined"!=typeof Promise?Promise:A("lie"),e.exports={Promise:n}},{lie:37}],7:[function(A,e,t){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,i=A("pako"),r=A("./utils"),o=A("./stream/GenericWorker"),s=n?"uint8array":"array";function a(A,e){o.call(this,"FlateWorker/"+A),this._pako=null,this._pakoAction=A,this._pakoOptions=e,this.meta={}}t.magic="\b\0",r.inherits(a,o),a.prototype.processChunk=function(A){this.meta=A.meta,null===this._pako&&this._createPako(),this._pako.push(r.transformTo(s,A.data),!1)},a.prototype.flush=function(){o.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},a.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this._pako=null},a.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var A=this;this._pako.onData=function(e){A.push({data:e,meta:A.meta})}},t.compressWorker=function(A){return new a("Deflate",A)},t.uncompressWorker=function(){return new a("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(A,e,t){"use strict";function n(A,e){var t,n="";for(t=0;t<e;t++)n+=String.fromCharCode(255&A),A>>>=8;return n}function i(A,e,t,i,o,c){var g,E,Q=A.file,u=A.compression,l=c!==s.utf8encode,w=r.transformTo("string",c(Q.name)),h=r.transformTo("string",s.utf8encode(Q.name)),C=Q.comment,I=r.transformTo("string",c(C)),M=r.transformTo("string",s.utf8encode(C)),d=h.length!==Q.name.length,m=M.length!==C.length,p="",F="",D="",Y=Q.dir,f=Q.date,N={crc32:0,compressedSize:0,uncompressedSize:0};e&&!t||(N.crc32=A.crc32,N.compressedSize=A.compressedSize,N.uncompressedSize=A.uncompressedSize);var U=0;e&&(U|=8),l||!d&&!m||(U|=2048);var y=0,T=0;Y&&(y|=16),"UNIX"===o?(T=798,y|=function(A,e){var t=A;return A||(t=e?16893:33204),(65535&t)<<16}(Q.unixPermissions,Y)):(T=20,y|=function(A){return 63&(A||0)}(Q.dosPermissions)),g=f.getUTCHours(),g<<=6,g|=f.getUTCMinutes(),g<<=5,g|=f.getUTCSeconds()/2,E=f.getUTCFullYear()-1980,E<<=4,E|=f.getUTCMonth()+1,E<<=5,E|=f.getUTCDate(),d&&(F=n(1,1)+n(a(w),4)+h,p+="up"+n(F.length,2)+F),m&&(D=n(1,1)+n(a(I),4)+M,p+="uc"+n(D.length,2)+D);var x="";return x+="\n\0",x+=n(U,2),x+=u.magic,x+=n(g,2),x+=n(E,2),x+=n(N.crc32,4),x+=n(N.compressedSize,4),x+=n(N.uncompressedSize,4),x+=n(w.length,2),x+=n(p.length,2),{fileRecord:B.LOCAL_FILE_HEADER+x+w+p,dirRecord:B.CENTRAL_FILE_HEADER+n(T,2)+x+n(I.length,2)+"\0\0\0\0"+n(y,4)+n(i,4)+w+p+I}}var r=A("../utils"),o=A("../stream/GenericWorker"),s=A("../utf8"),a=A("../crc32"),B=A("../signature");function c(A,e,t,n){o.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=e,this.zipPlatform=t,this.encodeFileName=n,this.streamFiles=A,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}r.inherits(c,o),c.prototype.push=function(A){var e=A.meta.percent||0,t=this.entriesCount,n=this._sources.length;this.accumulate?this.contentBuffer.push(A):(this.bytesWritten+=A.data.length,o.prototype.push.call(this,{data:A.data,meta:{currentFile:this.currentFile,percent:t?(e+100*(t-n-1))/t:100}}))},c.prototype.openedSource=function(A){this.currentSourceOffset=this.bytesWritten,this.currentFile=A.file.name;var e=this.streamFiles&&!A.file.dir;if(e){var t=i(A,e,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:t.fileRecord,meta:{percent:0}})}else this.accumulate=!0},c.prototype.closedSource=function(A){this.accumulate=!1;var e=this.streamFiles&&!A.file.dir,t=i(A,e,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(t.dirRecord),e)this.push({data:function(A){return B.DATA_DESCRIPTOR+n(A.crc32,4)+n(A.compressedSize,4)+n(A.uncompressedSize,4)}(A),meta:{percent:100}});else for(this.push({data:t.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},c.prototype.flush=function(){for(var A=this.bytesWritten,e=0;e<this.dirRecords.length;e++)this.push({data:this.dirRecords[e],meta:{percent:100}});var t=this.bytesWritten-A,i=function(A,e,t,i,o){var s=r.transformTo("string",o(i));return B.CENTRAL_DIRECTORY_END+"\0\0\0\0"+n(A,2)+n(A,2)+n(e,4)+n(t,4)+n(s.length,2)+s}(this.dirRecords.length,t,A,this.zipComment,this.encodeFileName);this.push({data:i,meta:{percent:100}})},c.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},c.prototype.registerPrevious=function(A){this._sources.push(A);var e=this;return A.on("data",(function(A){e.processChunk(A)})),A.on("end",(function(){e.closedSource(e.previous.streamInfo),e._sources.length?e.prepareNextSource():e.end()})),A.on("error",(function(A){e.error(A)})),this},c.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},c.prototype.error=function(A){var e=this._sources;if(!o.prototype.error.call(this,A))return!1;for(var t=0;t<e.length;t++)try{e[t].error(A)}catch(A){}return!0},c.prototype.lock=function(){o.prototype.lock.call(this);for(var A=this._sources,e=0;e<A.length;e++)A[e].lock()},e.exports=c},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(A,e,t){"use strict";var n=A("../compressions"),i=A("./ZipFileWorker");t.generateWorker=function(A,e,t){var r=new i(e.streamFiles,t,e.platform,e.encodeFileName),o=0;try{A.forEach((function(A,t){o++;var i=function(A,e){var t=A||e,i=n[t];if(!i)throw new Error(t+" is not a valid compression method !");return i}(t.options.compression,e.compression),s=t.options.compressionOptions||e.compressionOptions||{},a=t.dir,B=t.date;t._compressWorker(i,s).withStreamInfo("file",{name:A,dir:a,date:B,comment:t.comment||"",unixPermissions:t.unixPermissions,dosPermissions:t.dosPermissions}).pipe(r)})),r.entriesCount=o}catch(A){r.error(A)}return r}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(A,e,t){"use strict";function n(){if(!(this instanceof n))return new n;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var A=new n;for(var e in this)"function"!=typeof this[e]&&(A[e]=this[e]);return A}}(n.prototype=A("./object")).loadAsync=A("./load"),n.support=A("./support"),n.defaults=A("./defaults"),n.version="3.10.1",n.loadAsync=function(A,e){return(new n).loadAsync(A,e)},n.external=A("./external"),e.exports=n},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(A,e,t){"use strict";var n=A("./utils"),i=A("./external"),r=A("./utf8"),o=A("./zipEntries"),s=A("./stream/Crc32Probe"),a=A("./nodejsUtils");function B(A){return new i.Promise((function(e,t){var n=A.decompressed.getContentWorker().pipe(new s);n.on("error",(function(A){t(A)})).on("end",(function(){n.streamInfo.crc32!==A.decompressed.crc32?t(new Error("Corrupted zip : CRC32 mismatch")):e()})).resume()}))}e.exports=function(A,e){var t=this;return e=n.extend(e||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:r.utf8decode}),a.isNode&&a.isStream(A)?i.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):n.prepareContent("the loaded zip file",A,!0,e.optimizedBinaryString,e.base64).then((function(A){var t=new o(e);return t.load(A),t})).then((function(A){var t=[i.Promise.resolve(A)],n=A.files;if(e.checkCRC32)for(var r=0;r<n.length;r++)t.push(B(n[r]));return i.Promise.all(t)})).then((function(A){for(var i=A.shift(),r=i.files,o=0;o<r.length;o++){var s=r[o],a=s.fileNameStr,B=n.resolve(s.fileNameStr);t.file(B,s.decompressed,{binary:!0,optimizedBinaryString:!0,date:s.date,dir:s.dir,comment:s.fileCommentStr.length?s.fileCommentStr:null,unixPermissions:s.unixPermissions,dosPermissions:s.dosPermissions,createFolders:e.createFolders}),s.dir||(t.file(B).unsafeOriginalName=a)}return i.zipComment.length&&(t.comment=i.zipComment),t}))}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(A,e,t){"use strict";var n=A("../utils"),i=A("../stream/GenericWorker");function r(A,e){i.call(this,"Nodejs stream input adapter for "+A),this._upstreamEnded=!1,this._bindStream(e)}n.inherits(r,i),r.prototype._bindStream=function(A){var e=this;(this._stream=A).pause(),A.on("data",(function(A){e.push({data:A,meta:{percent:0}})})).on("error",(function(A){e.isPaused?this.generatedError=A:e.error(A)})).on("end",(function(){e.isPaused?e._upstreamEnded=!0:e.end()}))},r.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},r.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},e.exports=r},{"../stream/GenericWorker":28,"../utils":32}],13:[function(A,e,t){"use strict";var n=A("readable-stream").Readable;function i(A,e,t){n.call(this,e),this._helper=A;var i=this;A.on("data",(function(A,e){i.push(A)||i._helper.pause(),t&&t(e)})).on("error",(function(A){i.emit("error",A)})).on("end",(function(){i.push(null)}))}A("../utils").inherits(i,n),i.prototype._read=function(){this._helper.resume()},e.exports=i},{"../utils":32,"readable-stream":16}],14:[function(A,t,n){"use strict";t.exports={isNode:void 0!==e,newBufferFrom:function(A,t){if(e.from&&e.from!==Uint8Array.from)return e.from(A,t);if("number"==typeof A)throw new Error('The "data" argument must not be a number');return new e(A,t)},allocBuffer:function(A){if(e.alloc)return e.alloc(A);var t=new e(A);return t.fill(0),t},isBuffer:function(A){return e.isBuffer(A)},isStream:function(A){return A&&"function"==typeof A.on&&"function"==typeof A.pause&&"function"==typeof A.resume}}},{}],15:[function(A,e,t){"use strict";function n(A,e,t){var n,i=r.getTypeOf(e),s=r.extend(t||{},a);s.date=s.date||new Date,null!==s.compression&&(s.compression=s.compression.toUpperCase()),"string"==typeof s.unixPermissions&&(s.unixPermissions=parseInt(s.unixPermissions,8)),s.unixPermissions&&16384&s.unixPermissions&&(s.dir=!0),s.dosPermissions&&16&s.dosPermissions&&(s.dir=!0),s.dir&&(A=l(A)),s.createFolders&&(n=u(A))&&w.call(this,n,!0);var g,h="string"===i&&!1===s.binary&&!1===s.base64;t&&void 0!==t.binary||(s.binary=!h),(e instanceof B&&0===e.uncompressedSize||s.dir||!e||0===e.length)&&(s.base64=!1,s.binary=!0,e="",s.compression="STORE",i="string"),g=e instanceof B||e instanceof o?e:E.isNode&&E.isStream(e)?new Q(A,e):r.prepareContent(A,e,s.binary,s.optimizedBinaryString,s.base64);var C=new c(A,g,s);this.files[A]=C}var i=A("./utf8"),r=A("./utils"),o=A("./stream/GenericWorker"),s=A("./stream/StreamHelper"),a=A("./defaults"),B=A("./compressedObject"),c=A("./zipObject"),g=A("./generate"),E=A("./nodejsUtils"),Q=A("./nodejs/NodejsStreamInputAdapter"),u=function(A){"/"===A.slice(-1)&&(A=A.substring(0,A.length-1));var e=A.lastIndexOf("/");return 0<e?A.substring(0,e):""},l=function(A){return"/"!==A.slice(-1)&&(A+="/"),A},w=function(A,e){return e=void 0!==e?e:a.createFolders,A=l(A),this.files[A]||n.call(this,A,null,{dir:!0,createFolders:e}),this.files[A]};function h(A){return"[object RegExp]"===Object.prototype.toString.call(A)}var C={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(A){var e,t,n;for(e in this.files)n=this.files[e],(t=e.slice(this.root.length,e.length))&&e.slice(0,this.root.length)===this.root&&A(t,n)},filter:function(A){var e=[];return this.forEach((function(t,n){A(t,n)&&e.push(n)})),e},file:function(A,e,t){if(1!==arguments.length)return A=this.root+A,n.call(this,A,e,t),this;if(h(A)){var i=A;return this.filter((function(A,e){return!e.dir&&i.test(A)}))}var r=this.files[this.root+A];return r&&!r.dir?r:null},folder:function(A){if(!A)return this;if(h(A))return this.filter((function(e,t){return t.dir&&A.test(e)}));var e=this.root+A,t=w.call(this,e),n=this.clone();return n.root=t.name,n},remove:function(A){A=this.root+A;var e=this.files[A];if(e||("/"!==A.slice(-1)&&(A+="/"),e=this.files[A]),e&&!e.dir)delete this.files[A];else for(var t=this.filter((function(e,t){return t.name.slice(0,A.length)===A})),n=0;n<t.length;n++)delete this.files[t[n].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(A){var e,t={};try{if((t=r.extend(A||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode})).type=t.type.toLowerCase(),t.compression=t.compression.toUpperCase(),"binarystring"===t.type&&(t.type="string"),!t.type)throw new Error("No output type specified.");r.checkSupport(t.type),"darwin"!==t.platform&&"freebsd"!==t.platform&&"linux"!==t.platform&&"sunos"!==t.platform||(t.platform="UNIX"),"win32"===t.platform&&(t.platform="DOS");var n=t.comment||this.comment||"";e=g.generateWorker(this,t,n)}catch(A){(e=new o("error")).error(A)}return new s(e,t.type||"string",t.mimeType)},generateAsync:function(A,e){return this.generateInternalStream(A).accumulate(e)},generateNodeStream:function(A,e){return(A=A||{}).type||(A.type="nodebuffer"),this.generateInternalStream(A).toNodejsStream(e)}};e.exports=C},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(A,e,t){"use strict";e.exports=A("stream")},{stream:void 0}],17:[function(A,e,t){"use strict";var n=A("./DataReader");function i(A){n.call(this,A);for(var e=0;e<this.data.length;e++)A[e]=255&A[e]}A("../utils").inherits(i,n),i.prototype.byteAt=function(A){return this.data[this.zero+A]},i.prototype.lastIndexOfSignature=function(A){for(var e=A.charCodeAt(0),t=A.charCodeAt(1),n=A.charCodeAt(2),i=A.charCodeAt(3),r=this.length-4;0<=r;--r)if(this.data[r]===e&&this.data[r+1]===t&&this.data[r+2]===n&&this.data[r+3]===i)return r-this.zero;return-1},i.prototype.readAndCheckSignature=function(A){var e=A.charCodeAt(0),t=A.charCodeAt(1),n=A.charCodeAt(2),i=A.charCodeAt(3),r=this.readData(4);return e===r[0]&&t===r[1]&&n===r[2]&&i===r[3]},i.prototype.readData=function(A){if(this.checkOffset(A),0===A)return[];var e=this.data.slice(this.zero+this.index,this.zero+this.index+A);return this.index+=A,e},e.exports=i},{"../utils":32,"./DataReader":18}],18:[function(A,e,t){"use strict";var n=A("../utils");function i(A){this.data=A,this.length=A.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(A){this.checkIndex(this.index+A)},checkIndex:function(A){if(this.length<this.zero+A||A<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+A+"). Corrupted zip ?")},setIndex:function(A){this.checkIndex(A),this.index=A},skip:function(A){this.setIndex(this.index+A)},byteAt:function(){},readInt:function(A){var e,t=0;for(this.checkOffset(A),e=this.index+A-1;e>=this.index;e--)t=(t<<8)+this.byteAt(e);return this.index+=A,t},readString:function(A){return n.transformTo("string",this.readData(A))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var A=this.readInt(4);return new Date(Date.UTC(1980+(A>>25&127),(A>>21&15)-1,A>>16&31,A>>11&31,A>>5&63,(31&A)<<1))}},e.exports=i},{"../utils":32}],19:[function(A,e,t){"use strict";var n=A("./Uint8ArrayReader");function i(A){n.call(this,A)}A("../utils").inherits(i,n),i.prototype.readData=function(A){this.checkOffset(A);var e=this.data.slice(this.zero+this.index,this.zero+this.index+A);return this.index+=A,e},e.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(A,e,t){"use strict";var n=A("./DataReader");function i(A){n.call(this,A)}A("../utils").inherits(i,n),i.prototype.byteAt=function(A){return this.data.charCodeAt(this.zero+A)},i.prototype.lastIndexOfSignature=function(A){return this.data.lastIndexOf(A)-this.zero},i.prototype.readAndCheckSignature=function(A){return A===this.readData(4)},i.prototype.readData=function(A){this.checkOffset(A);var e=this.data.slice(this.zero+this.index,this.zero+this.index+A);return this.index+=A,e},e.exports=i},{"../utils":32,"./DataReader":18}],21:[function(A,e,t){"use strict";var n=A("./ArrayReader");function i(A){n.call(this,A)}A("../utils").inherits(i,n),i.prototype.readData=function(A){if(this.checkOffset(A),0===A)return new Uint8Array(0);var e=this.data.subarray(this.zero+this.index,this.zero+this.index+A);return this.index+=A,e},e.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(A,e,t){"use strict";var n=A("../utils"),i=A("../support"),r=A("./ArrayReader"),o=A("./StringReader"),s=A("./NodeBufferReader"),a=A("./Uint8ArrayReader");e.exports=function(A){var e=n.getTypeOf(A);return n.checkSupport(e),"string"!==e||i.uint8array?"nodebuffer"===e?new s(A):i.uint8array?new a(n.transformTo("uint8array",A)):new r(n.transformTo("array",A)):new o(A)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(A,e,t){"use strict";t.LOCAL_FILE_HEADER="PK",t.CENTRAL_FILE_HEADER="PK",t.CENTRAL_DIRECTORY_END="PK",t.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",t.ZIP64_CENTRAL_DIRECTORY_END="PK",t.DATA_DESCRIPTOR="PK\b"},{}],24:[function(A,e,t){"use strict";var n=A("./GenericWorker"),i=A("../utils");function r(A){n.call(this,"ConvertWorker to "+A),this.destType=A}i.inherits(r,n),r.prototype.processChunk=function(A){this.push({data:i.transformTo(this.destType,A.data),meta:A.meta})},e.exports=r},{"../utils":32,"./GenericWorker":28}],25:[function(A,e,t){"use strict";var n=A("./GenericWorker"),i=A("../crc32");function r(){n.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}A("../utils").inherits(r,n),r.prototype.processChunk=function(A){this.streamInfo.crc32=i(A.data,this.streamInfo.crc32||0),this.push(A)},e.exports=r},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(A,e,t){"use strict";var n=A("../utils"),i=A("./GenericWorker");function r(A){i.call(this,"DataLengthProbe for "+A),this.propName=A,this.withStreamInfo(A,0)}n.inherits(r,i),r.prototype.processChunk=function(A){if(A){var e=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=e+A.data.length}i.prototype.processChunk.call(this,A)},e.exports=r},{"../utils":32,"./GenericWorker":28}],27:[function(A,e,t){"use strict";var n=A("../utils"),i=A("./GenericWorker");function r(A){i.call(this,"DataWorker");var e=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,A.then((function(A){e.dataIsReady=!0,e.data=A,e.max=A&&A.length||0,e.type=n.getTypeOf(A),e.isPaused||e._tickAndRepeat()}),(function(A){e.error(A)}))}n.inherits(r,i),r.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},r.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,n.delay(this._tickAndRepeat,[],this)),!0)},r.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},r.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var A=null,e=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":A=this.data.substring(this.index,e);break;case"uint8array":A=this.data.subarray(this.index,e);break;case"array":case"nodebuffer":A=this.data.slice(this.index,e)}return this.index=e,this.push({data:A,meta:{percent:this.max?this.index/this.max*100:0}})},e.exports=r},{"../utils":32,"./GenericWorker":28}],28:[function(A,e,t){"use strict";function n(A){this.name=A||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}n.prototype={push:function(A){this.emit("data",A)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(A){this.emit("error",A)}return!0},error:function(A){return!this.isFinished&&(this.isPaused?this.generatedError=A:(this.isFinished=!0,this.emit("error",A),this.previous&&this.previous.error(A),this.cleanUp()),!0)},on:function(A,e){return this._listeners[A].push(e),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(A,e){if(this._listeners[A])for(var t=0;t<this._listeners[A].length;t++)this._listeners[A][t].call(this,e)},pipe:function(A){return A.registerPrevious(this)},registerPrevious:function(A){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=A.streamInfo,this.mergeStreamInfo(),this.previous=A;var e=this;return A.on("data",(function(A){e.processChunk(A)})),A.on("end",(function(){e.end()})),A.on("error",(function(A){e.error(A)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var A=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),A=!0),this.previous&&this.previous.resume(),!A},flush:function(){},processChunk:function(A){this.push(A)},withStreamInfo:function(A,e){return this.extraStreamInfo[A]=e,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var A in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,A)&&(this.streamInfo[A]=this.extraStreamInfo[A])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var A="Worker "+this.name;return this.previous?this.previous+" -> "+A:A}},e.exports=n},{}],29:[function(A,t,n){"use strict";var i=A("../utils"),r=A("./ConvertWorker"),o=A("./GenericWorker"),s=A("../base64"),a=A("../support"),B=A("../external"),c=null;if(a.nodestream)try{c=A("../nodejs/NodejsStreamOutputAdapter")}catch(A){}function g(A,e,t){var n=e;switch(e){case"blob":case"arraybuffer":n="uint8array";break;case"base64":n="string"}try{this._internalType=n,this._outputType=e,this._mimeType=t,i.checkSupport(n),this._worker=A.pipe(new r(n)),A.lock()}catch(A){this._worker=new o("error"),this._worker.error(A)}}g.prototype={accumulate:function(A){return function(A,t){return new B.Promise((function(n,r){var o=[],a=A._internalType,B=A._outputType,c=A._mimeType;A.on("data",(function(A,e){o.push(A),t&&t(e)})).on("error",(function(A){o=[],r(A)})).on("end",(function(){try{var A=function(A,e,t){switch(A){case"blob":return i.newBlob(i.transformTo("arraybuffer",e),t);case"base64":return s.encode(e);default:return i.transformTo(A,e)}}(B,function(A,t){var n,i=0,r=null,o=0;for(n=0;n<t.length;n++)o+=t[n].length;switch(A){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(r=new Uint8Array(o),n=0;n<t.length;n++)r.set(t[n],i),i+=t[n].length;return r;case"nodebuffer":return e.concat(t);default:throw new Error("concat : unsupported type '"+A+"'")}}(a,o),c);n(A)}catch(A){r(A)}o=[]})).resume()}))}(this,A)},on:function(A,e){var t=this;return"data"===A?this._worker.on(A,(function(A){e.call(t,A.data,A.meta)})):this._worker.on(A,(function(){i.delay(e,arguments,t)})),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(A){if(i.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new c(this,{objectMode:"nodebuffer"!==this._outputType},A)}},t.exports=g},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(A,t,n){"use strict";if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,n.nodebuffer=void 0!==e,n.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)n.blob=!1;else{var i=new ArrayBuffer(0);try{n.blob=0===new Blob([i],{type:"application/zip"}).size}catch(A){try{var r=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);r.append(i),n.blob=0===r.getBlob("application/zip").size}catch(A){n.blob=!1}}}try{n.nodestream=!!A("readable-stream").Readable}catch(A){n.nodestream=!1}},{"readable-stream":16}],31:[function(A,e,t){"use strict";for(var n=A("./utils"),i=A("./support"),r=A("./nodejsUtils"),o=A("./stream/GenericWorker"),s=new Array(256),a=0;a<256;a++)s[a]=252<=a?6:248<=a?5:240<=a?4:224<=a?3:192<=a?2:1;function B(){o.call(this,"utf-8 decode"),this.leftOver=null}function c(){o.call(this,"utf-8 encode")}s[254]=s[254]=1,t.utf8encode=function(A){return i.nodebuffer?r.newBufferFrom(A,"utf-8"):function(A){var e,t,n,r,o,s=A.length,a=0;for(r=0;r<s;r++)55296==(64512&(t=A.charCodeAt(r)))&&r+1<s&&56320==(64512&(n=A.charCodeAt(r+1)))&&(t=65536+(t-55296<<10)+(n-56320),r++),a+=t<128?1:t<2048?2:t<65536?3:4;for(e=i.uint8array?new Uint8Array(a):new Array(a),r=o=0;o<a;r++)55296==(64512&(t=A.charCodeAt(r)))&&r+1<s&&56320==(64512&(n=A.charCodeAt(r+1)))&&(t=65536+(t-55296<<10)+(n-56320),r++),t<128?e[o++]=t:(t<2048?e[o++]=192|t>>>6:(t<65536?e[o++]=224|t>>>12:(e[o++]=240|t>>>18,e[o++]=128|t>>>12&63),e[o++]=128|t>>>6&63),e[o++]=128|63&t);return e}(A)},t.utf8decode=function(A){return i.nodebuffer?n.transformTo("nodebuffer",A).toString("utf-8"):function(A){var e,t,i,r,o=A.length,a=new Array(2*o);for(e=t=0;e<o;)if((i=A[e++])<128)a[t++]=i;else if(4<(r=s[i]))a[t++]=65533,e+=r-1;else{for(i&=2===r?31:3===r?15:7;1<r&&e<o;)i=i<<6|63&A[e++],r--;1<r?a[t++]=65533:i<65536?a[t++]=i:(i-=65536,a[t++]=55296|i>>10&1023,a[t++]=56320|1023&i)}return a.length!==t&&(a.subarray?a=a.subarray(0,t):a.length=t),n.applyFromCharCode(a)}(A=n.transformTo(i.uint8array?"uint8array":"array",A))},n.inherits(B,o),B.prototype.processChunk=function(A){var e=n.transformTo(i.uint8array?"uint8array":"array",A.data);if(this.leftOver&&this.leftOver.length){if(i.uint8array){var r=e;(e=new Uint8Array(r.length+this.leftOver.length)).set(this.leftOver,0),e.set(r,this.leftOver.length)}else e=this.leftOver.concat(e);this.leftOver=null}var o=function(A,e){var t;for((e=e||A.length)>A.length&&(e=A.length),t=e-1;0<=t&&128==(192&A[t]);)t--;return t<0||0===t?e:t+s[A[t]]>e?t:e}(e),a=e;o!==e.length&&(i.uint8array?(a=e.subarray(0,o),this.leftOver=e.subarray(o,e.length)):(a=e.slice(0,o),this.leftOver=e.slice(o,e.length))),this.push({data:t.utf8decode(a),meta:A.meta})},B.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:t.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},t.Utf8DecodeWorker=B,n.inherits(c,o),c.prototype.processChunk=function(A){this.push({data:t.utf8encode(A.data),meta:A.meta})},t.Utf8EncodeWorker=c},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(A,e,n){"use strict";var i=A("./support"),r=A("./base64"),o=A("./nodejsUtils"),s=A("./external");function a(A){return A}function B(A,e){for(var t=0;t<A.length;++t)e[t]=255&A.charCodeAt(t);return e}A("setimmediate"),n.newBlob=function(A,e){n.checkSupport("blob");try{return new Blob([A],{type:e})}catch(n){try{var t=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return t.append(A),t.getBlob(e)}catch(A){throw new Error("Bug : can't construct the Blob.")}}};var c={stringifyByChunk:function(A,e,t){var n=[],i=0,r=A.length;if(r<=t)return String.fromCharCode.apply(null,A);for(;i<r;)"array"===e||"nodebuffer"===e?n.push(String.fromCharCode.apply(null,A.slice(i,Math.min(i+t,r)))):n.push(String.fromCharCode.apply(null,A.subarray(i,Math.min(i+t,r)))),i+=t;return n.join("")},stringifyByChar:function(A){for(var e="",t=0;t<A.length;t++)e+=String.fromCharCode(A[t]);return e},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(A){return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&1===String.fromCharCode.apply(null,o.allocBuffer(1)).length}catch(A){return!1}}()}};function g(A){var e=65536,t=n.getTypeOf(A),i=!0;if("uint8array"===t?i=c.applyCanBeUsed.uint8array:"nodebuffer"===t&&(i=c.applyCanBeUsed.nodebuffer),i)for(;1<e;)try{return c.stringifyByChunk(A,t,e)}catch(A){e=Math.floor(e/2)}return c.stringifyByChar(A)}function E(A,e){for(var t=0;t<A.length;t++)e[t]=A[t];return e}n.applyFromCharCode=g;var Q={};Q.string={string:a,array:function(A){return B(A,new Array(A.length))},arraybuffer:function(A){return Q.string.uint8array(A).buffer},uint8array:function(A){return B(A,new Uint8Array(A.length))},nodebuffer:function(A){return B(A,o.allocBuffer(A.length))}},Q.array={string:g,array:a,arraybuffer:function(A){return new Uint8Array(A).buffer},uint8array:function(A){return new Uint8Array(A)},nodebuffer:function(A){return o.newBufferFrom(A)}},Q.arraybuffer={string:function(A){return g(new Uint8Array(A))},array:function(A){return E(new Uint8Array(A),new Array(A.byteLength))},arraybuffer:a,uint8array:function(A){return new Uint8Array(A)},nodebuffer:function(A){return o.newBufferFrom(new Uint8Array(A))}},Q.uint8array={string:g,array:function(A){return E(A,new Array(A.length))},arraybuffer:function(A){return A.buffer},uint8array:a,nodebuffer:function(A){return o.newBufferFrom(A)}},Q.nodebuffer={string:g,array:function(A){return E(A,new Array(A.length))},arraybuffer:function(A){return Q.nodebuffer.uint8array(A).buffer},uint8array:function(A){return E(A,new Uint8Array(A.length))},nodebuffer:a},n.transformTo=function(A,e){if(e=e||"",!A)return e;n.checkSupport(A);var t=n.getTypeOf(e);return Q[t][A](e)},n.resolve=function(A){for(var e=A.split("/"),t=[],n=0;n<e.length;n++){var i=e[n];"."===i||""===i&&0!==n&&n!==e.length-1||(".."===i?t.pop():t.push(i))}return t.join("/")},n.getTypeOf=function(A){return"string"==typeof A?"string":"[object Array]"===Object.prototype.toString.call(A)?"array":i.nodebuffer&&o.isBuffer(A)?"nodebuffer":i.uint8array&&A instanceof Uint8Array?"uint8array":i.arraybuffer&&A instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(A){if(!i[A.toLowerCase()])throw new Error(A+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(A){var e,t,n="";for(t=0;t<(A||"").length;t++)n+="\\x"+((e=A.charCodeAt(t))<16?"0":"")+e.toString(16).toUpperCase();return n},n.delay=function(A,e,n){t((function(){A.apply(n||null,e||[])}))},n.inherits=function(A,e){function t(){}t.prototype=e.prototype,A.prototype=new t},n.extend=function(){var A,e,t={};for(A=0;A<arguments.length;A++)for(e in arguments[A])Object.prototype.hasOwnProperty.call(arguments[A],e)&&void 0===t[e]&&(t[e]=arguments[A][e]);return t},n.prepareContent=function(A,e,t,o,a){return s.Promise.resolve(e).then((function(A){return i.blob&&(A instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(A)))&&"undefined"!=typeof FileReader?new s.Promise((function(e,t){var n=new FileReader;n.onload=function(A){e(A.target.result)},n.onerror=function(A){t(A.target.error)},n.readAsArrayBuffer(A)})):A})).then((function(e){var c=n.getTypeOf(e);return c?("arraybuffer"===c?e=n.transformTo("uint8array",e):"string"===c&&(a?e=r.decode(e):t&&!0!==o&&(e=function(A){return B(A,i.uint8array?new Uint8Array(A.length):new Array(A.length))}(e))),e):s.Promise.reject(new Error("Can't read the data of '"+A+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(A,e,t){"use strict";var n=A("./reader/readerFor"),i=A("./utils"),r=A("./signature"),o=A("./zipEntry"),s=A("./support");function a(A){this.files=[],this.loadOptions=A}a.prototype={checkSignature:function(A){if(!this.reader.readAndCheckSignature(A)){this.reader.index-=4;var e=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+i.pretty(e)+", expected "+i.pretty(A)+")")}},isSignature:function(A,e){var t=this.reader.index;this.reader.setIndex(A);var n=this.reader.readString(4)===e;return this.reader.setIndex(t),n},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var A=this.reader.readData(this.zipCommentLength),e=s.uint8array?"uint8array":"array",t=i.transformTo(e,A);this.zipComment=this.loadOptions.decodeFileName(t)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var A,e,t,n=this.zip64EndOfCentralSize-44;0<n;)A=this.reader.readInt(2),e=this.reader.readInt(4),t=this.reader.readData(e),this.zip64ExtensibleData[A]={id:A,length:e,value:t}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var A,e;for(A=0;A<this.files.length;A++)e=this.files[A],this.reader.setIndex(e.localHeaderOffset),this.checkSignature(r.LOCAL_FILE_HEADER),e.readLocalPart(this.reader),e.handleUTF8(),e.processAttributes()},readCentralDir:function(){var A;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(r.CENTRAL_FILE_HEADER);)(A=new o({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(A);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var A=this.reader.lastIndexOfSignature(r.CENTRAL_DIRECTORY_END);if(A<0)throw this.isSignature(0,r.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(A);var e=A;if(this.checkSignature(r.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(A=this.reader.lastIndexOfSignature(r.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(A),this.checkSignature(r.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,r.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(r.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(r.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var t=this.centralDirOffset+this.centralDirSize;this.zip64&&(t+=20,t+=12+this.zip64EndOfCentralSize);var n=e-t;if(0<n)this.isSignature(e,r.CENTRAL_FILE_HEADER)||(this.reader.zero=n);else if(n<0)throw new Error("Corrupted zip: missing "+Math.abs(n)+" bytes.")},prepareReader:function(A){this.reader=n(A)},load:function(A){this.prepareReader(A),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},e.exports=a},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(A,e,t){"use strict";var n=A("./reader/readerFor"),i=A("./utils"),r=A("./compressedObject"),o=A("./crc32"),s=A("./utf8"),a=A("./compressions"),B=A("./support");function c(A,e){this.options=A,this.loadOptions=e}c.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(A){var e,t;if(A.skip(22),this.fileNameLength=A.readInt(2),t=A.readInt(2),this.fileName=A.readData(this.fileNameLength),A.skip(t),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(e=function(A){for(var e in a)if(Object.prototype.hasOwnProperty.call(a,e)&&a[e].magic===A)return a[e];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")");this.decompressed=new r(this.compressedSize,this.uncompressedSize,this.crc32,e,A.readData(this.compressedSize))},readCentralPart:function(A){this.versionMadeBy=A.readInt(2),A.skip(2),this.bitFlag=A.readInt(2),this.compressionMethod=A.readString(2),this.date=A.readDate(),this.crc32=A.readInt(4),this.compressedSize=A.readInt(4),this.uncompressedSize=A.readInt(4);var e=A.readInt(2);if(this.extraFieldsLength=A.readInt(2),this.fileCommentLength=A.readInt(2),this.diskNumberStart=A.readInt(2),this.internalFileAttributes=A.readInt(2),this.externalFileAttributes=A.readInt(4),this.localHeaderOffset=A.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");A.skip(e),this.readExtraFields(A),this.parseZIP64ExtraField(A),this.fileComment=A.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var A=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==A&&(this.dosPermissions=63&this.externalFileAttributes),3==A&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var A=n(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=A.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=A.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=A.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=A.readInt(4))}},readExtraFields:function(A){var e,t,n,i=A.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});A.index+4<i;)e=A.readInt(2),t=A.readInt(2),n=A.readData(t),this.extraFields[e]={id:e,length:t,value:n};A.setIndex(i)},handleUTF8:function(){var A=B.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=s.utf8decode(this.fileName),this.fileCommentStr=s.utf8decode(this.fileComment);else{var e=this.findExtraFieldUnicodePath();if(null!==e)this.fileNameStr=e;else{var t=i.transformTo(A,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(t)}var n=this.findExtraFieldUnicodeComment();if(null!==n)this.fileCommentStr=n;else{var r=i.transformTo(A,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(r)}}},findExtraFieldUnicodePath:function(){var A=this.extraFields[28789];if(A){var e=n(A.value);return 1!==e.readInt(1)||o(this.fileName)!==e.readInt(4)?null:s.utf8decode(e.readData(A.length-5))}return null},findExtraFieldUnicodeComment:function(){var A=this.extraFields[25461];if(A){var e=n(A.value);return 1!==e.readInt(1)||o(this.fileComment)!==e.readInt(4)?null:s.utf8decode(e.readData(A.length-5))}return null}},e.exports=c},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(A,e,t){"use strict";function n(A,e,t){this.name=A,this.dir=t.dir,this.date=t.date,this.comment=t.comment,this.unixPermissions=t.unixPermissions,this.dosPermissions=t.dosPermissions,this._data=e,this._dataBinary=t.binary,this.options={compression:t.compression,compressionOptions:t.compressionOptions}}var i=A("./stream/StreamHelper"),r=A("./stream/DataWorker"),o=A("./utf8"),s=A("./compressedObject"),a=A("./stream/GenericWorker");n.prototype={internalStream:function(A){var e=null,t="string";try{if(!A)throw new Error("No output type specified.");var n="string"===(t=A.toLowerCase())||"text"===t;"binarystring"!==t&&"text"!==t||(t="string"),e=this._decompressWorker();var r=!this._dataBinary;r&&!n&&(e=e.pipe(new o.Utf8EncodeWorker)),!r&&n&&(e=e.pipe(new o.Utf8DecodeWorker))}catch(A){(e=new a("error")).error(A)}return new i(e,t,"")},async:function(A,e){return this.internalStream(A).accumulate(e)},nodeStream:function(A,e){return this.internalStream(A||"nodebuffer").toNodejsStream(e)},_compressWorker:function(A,e){if(this._data instanceof s&&this._data.compression.magic===A.magic)return this._data.getCompressedWorker();var t=this._decompressWorker();return this._dataBinary||(t=t.pipe(new o.Utf8EncodeWorker)),s.createWorkerFrom(t,A,e)},_decompressWorker:function(){return this._data instanceof s?this._data.getContentWorker():this._data instanceof a?this._data:new r(this._data)}};for(var B=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],c=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},g=0;g<B.length;g++)n.prototype[B[g]]=c;e.exports=n},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(A,e,t){(function(A){"use strict";var t,n,i=A.MutationObserver||A.WebKitMutationObserver;if(i){var r=0,o=new i(c),s=A.document.createTextNode("");o.observe(s,{characterData:!0}),t=function(){s.data=r=++r%2}}else if(A.setImmediate||void 0===A.MessageChannel)t="document"in A&&"onreadystatechange"in A.document.createElement("script")?function(){var e=A.document.createElement("script");e.onreadystatechange=function(){c(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},A.document.documentElement.appendChild(e)}:function(){setTimeout(c,0)};else{var a=new A.MessageChannel;a.port1.onmessage=c,t=function(){a.port2.postMessage(0)}}var B=[];function c(){var A,e;n=!0;for(var t=B.length;t;){for(e=B,B=[],A=-1;++A<t;)e[A]();t=B.length}n=!1}e.exports=function(A){1!==B.push(A)||n||t()}}).call(this,void 0!==n?n:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(A,e,t){"use strict";var n=A("immediate");function i(){}var r={},o=["REJECTED"],s=["FULFILLED"],a=["PENDING"];function B(A){if("function"!=typeof A)throw new TypeError("resolver must be a function");this.state=a,this.queue=[],this.outcome=void 0,A!==i&&Q(this,A)}function c(A,e,t){this.promise=A,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof t&&(this.onRejected=t,this.callRejected=this.otherCallRejected)}function g(A,e,t){n((function(){var n;try{n=e(t)}catch(n){return r.reject(A,n)}n===A?r.reject(A,new TypeError("Cannot resolve promise with itself")):r.resolve(A,n)}))}function E(A){var e=A&&A.then;if(A&&("object"==typeof A||"function"==typeof A)&&"function"==typeof e)return function(){e.apply(A,arguments)}}function Q(A,e){var t=!1;function n(e){t||(t=!0,r.reject(A,e))}function i(e){t||(t=!0,r.resolve(A,e))}var o=u((function(){e(i,n)}));"error"===o.status&&n(o.value)}function u(A,e){var t={};try{t.value=A(e),t.status="success"}catch(A){t.status="error",t.value=A}return t}(e.exports=B).prototype.finally=function(A){if("function"!=typeof A)return this;var e=this.constructor;return this.then((function(t){return e.resolve(A()).then((function(){return t}))}),(function(t){return e.resolve(A()).then((function(){throw t}))}))},B.prototype.catch=function(A){return this.then(null,A)},B.prototype.then=function(A,e){if("function"!=typeof A&&this.state===s||"function"!=typeof e&&this.state===o)return this;var t=new this.constructor(i);return this.state!==a?g(t,this.state===s?A:e,this.outcome):this.queue.push(new c(t,A,e)),t},c.prototype.callFulfilled=function(A){r.resolve(this.promise,A)},c.prototype.otherCallFulfilled=function(A){g(this.promise,this.onFulfilled,A)},c.prototype.callRejected=function(A){r.reject(this.promise,A)},c.prototype.otherCallRejected=function(A){g(this.promise,this.onRejected,A)},r.resolve=function(A,e){var t=u(E,e);if("error"===t.status)return r.reject(A,t.value);var n=t.value;if(n)Q(A,n);else{A.state=s,A.outcome=e;for(var i=-1,o=A.queue.length;++i<o;)A.queue[i].callFulfilled(e)}return A},r.reject=function(A,e){A.state=o,A.outcome=e;for(var t=-1,n=A.queue.length;++t<n;)A.queue[t].callRejected(e);return A},B.resolve=function(A){return A instanceof this?A:r.resolve(new this(i),A)},B.reject=function(A){var e=new this(i);return r.reject(e,A)},B.all=function(A){var e=this;if("[object Array]"!==Object.prototype.toString.call(A))return this.reject(new TypeError("must be an array"));var t=A.length,n=!1;if(!t)return this.resolve([]);for(var o=new Array(t),s=0,a=-1,B=new this(i);++a<t;)c(A[a],a);return B;function c(A,i){e.resolve(A).then((function(A){o[i]=A,++s!==t||n||(n=!0,r.resolve(B,o))}),(function(A){n||(n=!0,r.reject(B,A))}))}},B.race=function(A){if("[object Array]"!==Object.prototype.toString.call(A))return this.reject(new TypeError("must be an array"));var e=A.length,t=!1;if(!e)return this.resolve([]);for(var n,o=-1,s=new this(i);++o<e;)n=A[o],this.resolve(n).then((function(A){t||(t=!0,r.resolve(s,A))}),(function(A){t||(t=!0,r.reject(s,A))}));return s}},{immediate:36}],38:[function(A,e,t){"use strict";var n={};(0,A("./lib/utils/common").assign)(n,A("./lib/deflate"),A("./lib/inflate"),A("./lib/zlib/constants")),e.exports=n},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(A,e,t){"use strict";var n=A("./zlib/deflate"),i=A("./utils/common"),r=A("./utils/strings"),o=A("./zlib/messages"),s=A("./zlib/zstream"),a=Object.prototype.toString;function B(A){if(!(this instanceof B))return new B(A);this.options=i.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},A||{});var e=this.options;e.raw&&0<e.windowBits?e.windowBits=-e.windowBits:e.gzip&&0<e.windowBits&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var t=n.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(0!==t)throw new Error(o[t]);if(e.header&&n.deflateSetHeader(this.strm,e.header),e.dictionary){var c;if(c="string"==typeof e.dictionary?r.string2buf(e.dictionary):"[object ArrayBuffer]"===a.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,0!==(t=n.deflateSetDictionary(this.strm,c)))throw new Error(o[t]);this._dict_set=!0}}function c(A,e){var t=new B(e);if(t.push(A,!0),t.err)throw t.msg||o[t.err];return t.result}B.prototype.push=function(A,e){var t,o,s=this.strm,B=this.options.chunkSize;if(this.ended)return!1;o=e===~~e?e:!0===e?4:0,"string"==typeof A?s.input=r.string2buf(A):"[object ArrayBuffer]"===a.call(A)?s.input=new Uint8Array(A):s.input=A,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new i.Buf8(B),s.next_out=0,s.avail_out=B),1!==(t=n.deflate(s,o))&&0!==t)return this.onEnd(t),!(this.ended=!0);0!==s.avail_out&&(0!==s.avail_in||4!==o&&2!==o)||("string"===this.options.to?this.onData(r.buf2binstring(i.shrinkBuf(s.output,s.next_out))):this.onData(i.shrinkBuf(s.output,s.next_out)))}while((0<s.avail_in||0===s.avail_out)&&1!==t);return 4===o?(t=n.deflateEnd(this.strm),this.onEnd(t),this.ended=!0,0===t):2!==o||(this.onEnd(0),!(s.avail_out=0))},B.prototype.onData=function(A){this.chunks.push(A)},B.prototype.onEnd=function(A){0===A&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=A,this.msg=this.strm.msg},t.Deflate=B,t.deflate=c,t.deflateRaw=function(A,e){return(e=e||{}).raw=!0,c(A,e)},t.gzip=function(A,e){return(e=e||{}).gzip=!0,c(A,e)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(A,e,t){"use strict";var n=A("./zlib/inflate"),i=A("./utils/common"),r=A("./utils/strings"),o=A("./zlib/constants"),s=A("./zlib/messages"),a=A("./zlib/zstream"),B=A("./zlib/gzheader"),c=Object.prototype.toString;function g(A){if(!(this instanceof g))return new g(A);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},A||{});var e=this.options;e.raw&&0<=e.windowBits&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(0<=e.windowBits&&e.windowBits<16)||A&&A.windowBits||(e.windowBits+=32),15<e.windowBits&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;var t=n.inflateInit2(this.strm,e.windowBits);if(t!==o.Z_OK)throw new Error(s[t]);this.header=new B,n.inflateGetHeader(this.strm,this.header)}function E(A,e){var t=new g(e);if(t.push(A,!0),t.err)throw t.msg||s[t.err];return t.result}g.prototype.push=function(A,e){var t,s,a,B,g,E,Q=this.strm,u=this.options.chunkSize,l=this.options.dictionary,w=!1;if(this.ended)return!1;s=e===~~e?e:!0===e?o.Z_FINISH:o.Z_NO_FLUSH,"string"==typeof A?Q.input=r.binstring2buf(A):"[object ArrayBuffer]"===c.call(A)?Q.input=new Uint8Array(A):Q.input=A,Q.next_in=0,Q.avail_in=Q.input.length;do{if(0===Q.avail_out&&(Q.output=new i.Buf8(u),Q.next_out=0,Q.avail_out=u),(t=n.inflate(Q,o.Z_NO_FLUSH))===o.Z_NEED_DICT&&l&&(E="string"==typeof l?r.string2buf(l):"[object ArrayBuffer]"===c.call(l)?new Uint8Array(l):l,t=n.inflateSetDictionary(this.strm,E)),t===o.Z_BUF_ERROR&&!0===w&&(t=o.Z_OK,w=!1),t!==o.Z_STREAM_END&&t!==o.Z_OK)return this.onEnd(t),!(this.ended=!0);Q.next_out&&(0!==Q.avail_out&&t!==o.Z_STREAM_END&&(0!==Q.avail_in||s!==o.Z_FINISH&&s!==o.Z_SYNC_FLUSH)||("string"===this.options.to?(a=r.utf8border(Q.output,Q.next_out),B=Q.next_out-a,g=r.buf2string(Q.output,a),Q.next_out=B,Q.avail_out=u-B,B&&i.arraySet(Q.output,Q.output,a,B,0),this.onData(g)):this.onData(i.shrinkBuf(Q.output,Q.next_out)))),0===Q.avail_in&&0===Q.avail_out&&(w=!0)}while((0<Q.avail_in||0===Q.avail_out)&&t!==o.Z_STREAM_END);return t===o.Z_STREAM_END&&(s=o.Z_FINISH),s===o.Z_FINISH?(t=n.inflateEnd(this.strm),this.onEnd(t),this.ended=!0,t===o.Z_OK):s!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),!(Q.avail_out=0))},g.prototype.onData=function(A){this.chunks.push(A)},g.prototype.onEnd=function(A){A===o.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=A,this.msg=this.strm.msg},t.Inflate=g,t.inflate=E,t.inflateRaw=function(A,e){return(e=e||{}).raw=!0,E(A,e)},t.ungzip=E},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(A,e,t){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;t.assign=function(A){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var t=e.shift();if(t){if("object"!=typeof t)throw new TypeError(t+"must be non-object");for(var n in t)t.hasOwnProperty(n)&&(A[n]=t[n])}}return A},t.shrinkBuf=function(A,e){return A.length===e?A:A.subarray?A.subarray(0,e):(A.length=e,A)};var i={arraySet:function(A,e,t,n,i){if(e.subarray&&A.subarray)A.set(e.subarray(t,t+n),i);else for(var r=0;r<n;r++)A[i+r]=e[t+r]},flattenChunks:function(A){var e,t,n,i,r,o;for(e=n=0,t=A.length;e<t;e++)n+=A[e].length;for(o=new Uint8Array(n),e=i=0,t=A.length;e<t;e++)r=A[e],o.set(r,i),i+=r.length;return o}},r={arraySet:function(A,e,t,n,i){for(var r=0;r<n;r++)A[i+r]=e[t+r]},flattenChunks:function(A){return[].concat.apply([],A)}};t.setTyped=function(A){A?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,i)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,r))},t.setTyped(n)},{}],42:[function(A,e,t){"use strict";var n=A("./common"),i=!0,r=!0;try{String.fromCharCode.apply(null,[0])}catch(A){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(A){r=!1}for(var o=new n.Buf8(256),s=0;s<256;s++)o[s]=252<=s?6:248<=s?5:240<=s?4:224<=s?3:192<=s?2:1;function a(A,e){if(e<65537&&(A.subarray&&r||!A.subarray&&i))return String.fromCharCode.apply(null,n.shrinkBuf(A,e));for(var t="",o=0;o<e;o++)t+=String.fromCharCode(A[o]);return t}o[254]=o[254]=1,t.string2buf=function(A){var e,t,i,r,o,s=A.length,a=0;for(r=0;r<s;r++)55296==(64512&(t=A.charCodeAt(r)))&&r+1<s&&56320==(64512&(i=A.charCodeAt(r+1)))&&(t=65536+(t-55296<<10)+(i-56320),r++),a+=t<128?1:t<2048?2:t<65536?3:4;for(e=new n.Buf8(a),r=o=0;o<a;r++)55296==(64512&(t=A.charCodeAt(r)))&&r+1<s&&56320==(64512&(i=A.charCodeAt(r+1)))&&(t=65536+(t-55296<<10)+(i-56320),r++),t<128?e[o++]=t:(t<2048?e[o++]=192|t>>>6:(t<65536?e[o++]=224|t>>>12:(e[o++]=240|t>>>18,e[o++]=128|t>>>12&63),e[o++]=128|t>>>6&63),e[o++]=128|63&t);return e},t.buf2binstring=function(A){return a(A,A.length)},t.binstring2buf=function(A){for(var e=new n.Buf8(A.length),t=0,i=e.length;t<i;t++)e[t]=A.charCodeAt(t);return e},t.buf2string=function(A,e){var t,n,i,r,s=e||A.length,B=new Array(2*s);for(t=n=0;t<s;)if((i=A[t++])<128)B[n++]=i;else if(4<(r=o[i]))B[n++]=65533,t+=r-1;else{for(i&=2===r?31:3===r?15:7;1<r&&t<s;)i=i<<6|63&A[t++],r--;1<r?B[n++]=65533:i<65536?B[n++]=i:(i-=65536,B[n++]=55296|i>>10&1023,B[n++]=56320|1023&i)}return a(B,n)},t.utf8border=function(A,e){var t;for((e=e||A.length)>A.length&&(e=A.length),t=e-1;0<=t&&128==(192&A[t]);)t--;return t<0||0===t?e:t+o[A[t]]>e?t:e}},{"./common":41}],43:[function(A,e,t){"use strict";e.exports=function(A,e,t,n){for(var i=65535&A|0,r=A>>>16&65535|0,o=0;0!==t;){for(t-=o=2e3<t?2e3:t;r=r+(i=i+e[n++]|0)|0,--o;);i%=65521,r%=65521}return i|r<<16|0}},{}],44:[function(A,e,t){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(A,e,t){"use strict";var n=function(){for(var A,e=[],t=0;t<256;t++){A=t;for(var n=0;n<8;n++)A=1&A?3988292384^A>>>1:A>>>1;e[t]=A}return e}();e.exports=function(A,e,t,i){var r=n,o=i+t;A^=-1;for(var s=i;s<o;s++)A=A>>>8^r[255&(A^e[s])];return-1^A}},{}],46:[function(A,e,t){"use strict";var n,i=A("../utils/common"),r=A("./trees"),o=A("./adler32"),s=A("./crc32"),a=A("./messages"),B=-2,c=258,g=262,E=113;function Q(A,e){return A.msg=a[e],e}function u(A){return(A<<1)-(4<A?9:0)}function l(A){for(var e=A.length;0<=--e;)A[e]=0}function w(A){var e=A.state,t=e.pending;t>A.avail_out&&(t=A.avail_out),0!==t&&(i.arraySet(A.output,e.pending_buf,e.pending_out,t,A.next_out),A.next_out+=t,e.pending_out+=t,A.total_out+=t,A.avail_out-=t,e.pending-=t,0===e.pending&&(e.pending_out=0))}function h(A,e){r._tr_flush_block(A,0<=A.block_start?A.block_start:-1,A.strstart-A.block_start,e),A.block_start=A.strstart,w(A.strm)}function C(A,e){A.pending_buf[A.pending++]=e}function I(A,e){A.pending_buf[A.pending++]=e>>>8&255,A.pending_buf[A.pending++]=255&e}function M(A,e){var t,n,i=A.max_chain_length,r=A.strstart,o=A.prev_length,s=A.nice_match,a=A.strstart>A.w_size-g?A.strstart-(A.w_size-g):0,B=A.window,E=A.w_mask,Q=A.prev,u=A.strstart+c,l=B[r+o-1],w=B[r+o];A.prev_length>=A.good_match&&(i>>=2),s>A.lookahead&&(s=A.lookahead);do{if(B[(t=e)+o]===w&&B[t+o-1]===l&&B[t]===B[r]&&B[++t]===B[r+1]){r+=2,t++;do{}while(B[++r]===B[++t]&&B[++r]===B[++t]&&B[++r]===B[++t]&&B[++r]===B[++t]&&B[++r]===B[++t]&&B[++r]===B[++t]&&B[++r]===B[++t]&&B[++r]===B[++t]&&r<u);if(n=c-(u-r),r=u-c,o<n){if(A.match_start=e,s<=(o=n))break;l=B[r+o-1],w=B[r+o]}}}while((e=Q[e&E])>a&&0!=--i);return o<=A.lookahead?o:A.lookahead}function d(A){var e,t,n,r,a,B,c,E,Q,u,l=A.w_size;do{if(r=A.window_size-A.lookahead-A.strstart,A.strstart>=l+(l-g)){for(i.arraySet(A.window,A.window,l,l,0),A.match_start-=l,A.strstart-=l,A.block_start-=l,e=t=A.hash_size;n=A.head[--e],A.head[e]=l<=n?n-l:0,--t;);for(e=t=l;n=A.prev[--e],A.prev[e]=l<=n?n-l:0,--t;);r+=l}if(0===A.strm.avail_in)break;if(B=A.strm,c=A.window,E=A.strstart+A.lookahead,u=void 0,(Q=r)<(u=B.avail_in)&&(u=Q),t=0===u?0:(B.avail_in-=u,i.arraySet(c,B.input,B.next_in,u,E),1===B.state.wrap?B.adler=o(B.adler,c,u,E):2===B.state.wrap&&(B.adler=s(B.adler,c,u,E)),B.next_in+=u,B.total_in+=u,u),A.lookahead+=t,A.lookahead+A.insert>=3)for(a=A.strstart-A.insert,A.ins_h=A.window[a],A.ins_h=(A.ins_h<<A.hash_shift^A.window[a+1])&A.hash_mask;A.insert&&(A.ins_h=(A.ins_h<<A.hash_shift^A.window[a+3-1])&A.hash_mask,A.prev[a&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=a,a++,A.insert--,!(A.lookahead+A.insert<3)););}while(A.lookahead<g&&0!==A.strm.avail_in)}function m(A,e){for(var t,n;;){if(A.lookahead<g){if(d(A),A.lookahead<g&&0===e)return 1;if(0===A.lookahead)break}if(t=0,A.lookahead>=3&&(A.ins_h=(A.ins_h<<A.hash_shift^A.window[A.strstart+3-1])&A.hash_mask,t=A.prev[A.strstart&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=A.strstart),0!==t&&A.strstart-t<=A.w_size-g&&(A.match_length=M(A,t)),A.match_length>=3)if(n=r._tr_tally(A,A.strstart-A.match_start,A.match_length-3),A.lookahead-=A.match_length,A.match_length<=A.max_lazy_match&&A.lookahead>=3){for(A.match_length--;A.strstart++,A.ins_h=(A.ins_h<<A.hash_shift^A.window[A.strstart+3-1])&A.hash_mask,t=A.prev[A.strstart&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=A.strstart,0!=--A.match_length;);A.strstart++}else A.strstart+=A.match_length,A.match_length=0,A.ins_h=A.window[A.strstart],A.ins_h=(A.ins_h<<A.hash_shift^A.window[A.strstart+1])&A.hash_mask;else n=r._tr_tally(A,0,A.window[A.strstart]),A.lookahead--,A.strstart++;if(n&&(h(A,!1),0===A.strm.avail_out))return 1}return A.insert=A.strstart<2?A.strstart:2,4===e?(h(A,!0),0===A.strm.avail_out?3:4):A.last_lit&&(h(A,!1),0===A.strm.avail_out)?1:2}function p(A,e){for(var t,n,i;;){if(A.lookahead<g){if(d(A),A.lookahead<g&&0===e)return 1;if(0===A.lookahead)break}if(t=0,A.lookahead>=3&&(A.ins_h=(A.ins_h<<A.hash_shift^A.window[A.strstart+3-1])&A.hash_mask,t=A.prev[A.strstart&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=A.strstart),A.prev_length=A.match_length,A.prev_match=A.match_start,A.match_length=2,0!==t&&A.prev_length<A.max_lazy_match&&A.strstart-t<=A.w_size-g&&(A.match_length=M(A,t),A.match_length<=5&&(1===A.strategy||3===A.match_length&&4096<A.strstart-A.match_start)&&(A.match_length=2)),A.prev_length>=3&&A.match_length<=A.prev_length){for(i=A.strstart+A.lookahead-3,n=r._tr_tally(A,A.strstart-1-A.prev_match,A.prev_length-3),A.lookahead-=A.prev_length-1,A.prev_length-=2;++A.strstart<=i&&(A.ins_h=(A.ins_h<<A.hash_shift^A.window[A.strstart+3-1])&A.hash_mask,t=A.prev[A.strstart&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=A.strstart),0!=--A.prev_length;);if(A.match_available=0,A.match_length=2,A.strstart++,n&&(h(A,!1),0===A.strm.avail_out))return 1}else if(A.match_available){if((n=r._tr_tally(A,0,A.window[A.strstart-1]))&&h(A,!1),A.strstart++,A.lookahead--,0===A.strm.avail_out)return 1}else A.match_available=1,A.strstart++,A.lookahead--}return A.match_available&&(n=r._tr_tally(A,0,A.window[A.strstart-1]),A.match_available=0),A.insert=A.strstart<2?A.strstart:2,4===e?(h(A,!0),0===A.strm.avail_out?3:4):A.last_lit&&(h(A,!1),0===A.strm.avail_out)?1:2}function F(A,e,t,n,i){this.good_length=A,this.max_lazy=e,this.nice_length=t,this.max_chain=n,this.func=i}function D(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(1146),this.dyn_dtree=new i.Buf16(122),this.bl_tree=new i.Buf16(78),l(this.dyn_ltree),l(this.dyn_dtree),l(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(16),this.heap=new i.Buf16(573),l(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(573),l(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Y(A){var e;return A&&A.state?(A.total_in=A.total_out=0,A.data_type=2,(e=A.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?42:E,A.adler=2===e.wrap?0:1,e.last_flush=0,r._tr_init(e),0):Q(A,B)}function f(A){var e=Y(A);return 0===e&&function(A){A.window_size=2*A.w_size,l(A.head),A.max_lazy_match=n[A.level].max_lazy,A.good_match=n[A.level].good_length,A.nice_match=n[A.level].nice_length,A.max_chain_length=n[A.level].max_chain,A.strstart=0,A.block_start=0,A.lookahead=0,A.insert=0,A.match_length=A.prev_length=2,A.match_available=0,A.ins_h=0}(A.state),e}function N(A,e,t,n,r,o){if(!A)return B;var s=1;if(-1===e&&(e=6),n<0?(s=0,n=-n):15<n&&(s=2,n-=16),r<1||9<r||8!==t||n<8||15<n||e<0||9<e||o<0||4<o)return Q(A,B);8===n&&(n=9);var a=new D;return(A.state=a).strm=A,a.wrap=s,a.gzhead=null,a.w_bits=n,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=r+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new i.Buf8(2*a.w_size),a.head=new i.Buf16(a.hash_size),a.prev=new i.Buf16(a.w_size),a.lit_bufsize=1<<r+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new i.Buf8(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=3*a.lit_bufsize,a.level=e,a.strategy=o,a.method=t,f(A)}n=[new F(0,0,0,0,(function(A,e){var t=65535;for(t>A.pending_buf_size-5&&(t=A.pending_buf_size-5);;){if(A.lookahead<=1){if(d(A),0===A.lookahead&&0===e)return 1;if(0===A.lookahead)break}A.strstart+=A.lookahead,A.lookahead=0;var n=A.block_start+t;if((0===A.strstart||A.strstart>=n)&&(A.lookahead=A.strstart-n,A.strstart=n,h(A,!1),0===A.strm.avail_out))return 1;if(A.strstart-A.block_start>=A.w_size-g&&(h(A,!1),0===A.strm.avail_out))return 1}return A.insert=0,4===e?(h(A,!0),0===A.strm.avail_out?3:4):(A.strstart>A.block_start&&(h(A,!1),A.strm.avail_out),1)})),new F(4,4,8,4,m),new F(4,5,16,8,m),new F(4,6,32,32,m),new F(4,4,16,16,p),new F(8,16,32,32,p),new F(8,16,128,128,p),new F(8,32,128,256,p),new F(32,128,258,1024,p),new F(32,258,258,4096,p)],t.deflateInit=function(A,e){return N(A,e,8,15,8,0)},t.deflateInit2=N,t.deflateReset=f,t.deflateResetKeep=Y,t.deflateSetHeader=function(A,e){return A&&A.state?2!==A.state.wrap?B:(A.state.gzhead=e,0):B},t.deflate=function(A,e){var t,i,o,a;if(!A||!A.state||5<e||e<0)return A?Q(A,B):B;if(i=A.state,!A.output||!A.input&&0!==A.avail_in||666===i.status&&4!==e)return Q(A,0===A.avail_out?-5:B);if(i.strm=A,t=i.last_flush,i.last_flush=e,42===i.status)if(2===i.wrap)A.adler=0,C(i,31),C(i,139),C(i,8),i.gzhead?(C(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),C(i,255&i.gzhead.time),C(i,i.gzhead.time>>8&255),C(i,i.gzhead.time>>16&255),C(i,i.gzhead.time>>24&255),C(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),C(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(C(i,255&i.gzhead.extra.length),C(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(A.adler=s(A.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(C(i,0),C(i,0),C(i,0),C(i,0),C(i,0),C(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),C(i,3),i.status=E);else{var g=8+(i.w_bits-8<<4)<<8;g|=(2<=i.strategy||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(g|=32),g+=31-g%31,i.status=E,I(i,g),0!==i.strstart&&(I(i,A.adler>>>16),I(i,65535&A.adler)),A.adler=1}if(69===i.status)if(i.gzhead.extra){for(o=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>o&&(A.adler=s(A.adler,i.pending_buf,i.pending-o,o)),w(A),o=i.pending,i.pending!==i.pending_buf_size));)C(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>o&&(A.adler=s(A.adler,i.pending_buf,i.pending-o,o)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){o=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>o&&(A.adler=s(A.adler,i.pending_buf,i.pending-o,o)),w(A),o=i.pending,i.pending===i.pending_buf_size)){a=1;break}a=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,C(i,a)}while(0!==a);i.gzhead.hcrc&&i.pending>o&&(A.adler=s(A.adler,i.pending_buf,i.pending-o,o)),0===a&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){o=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>o&&(A.adler=s(A.adler,i.pending_buf,i.pending-o,o)),w(A),o=i.pending,i.pending===i.pending_buf_size)){a=1;break}a=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,C(i,a)}while(0!==a);i.gzhead.hcrc&&i.pending>o&&(A.adler=s(A.adler,i.pending_buf,i.pending-o,o)),0===a&&(i.status=103)}else i.status=103;if(103===i.status&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&w(A),i.pending+2<=i.pending_buf_size&&(C(i,255&A.adler),C(i,A.adler>>8&255),A.adler=0,i.status=E)):i.status=E),0!==i.pending){if(w(A),0===A.avail_out)return i.last_flush=-1,0}else if(0===A.avail_in&&u(e)<=u(t)&&4!==e)return Q(A,-5);if(666===i.status&&0!==A.avail_in)return Q(A,-5);if(0!==A.avail_in||0!==i.lookahead||0!==e&&666!==i.status){var M=2===i.strategy?function(A,e){for(var t;;){if(0===A.lookahead&&(d(A),0===A.lookahead)){if(0===e)return 1;break}if(A.match_length=0,t=r._tr_tally(A,0,A.window[A.strstart]),A.lookahead--,A.strstart++,t&&(h(A,!1),0===A.strm.avail_out))return 1}return A.insert=0,4===e?(h(A,!0),0===A.strm.avail_out?3:4):A.last_lit&&(h(A,!1),0===A.strm.avail_out)?1:2}(i,e):3===i.strategy?function(A,e){for(var t,n,i,o,s=A.window;;){if(A.lookahead<=c){if(d(A),A.lookahead<=c&&0===e)return 1;if(0===A.lookahead)break}if(A.match_length=0,A.lookahead>=3&&0<A.strstart&&(n=s[i=A.strstart-1])===s[++i]&&n===s[++i]&&n===s[++i]){o=A.strstart+c;do{}while(n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&i<o);A.match_length=c-(o-i),A.match_length>A.lookahead&&(A.match_length=A.lookahead)}if(A.match_length>=3?(t=r._tr_tally(A,1,A.match_length-3),A.lookahead-=A.match_length,A.strstart+=A.match_length,A.match_length=0):(t=r._tr_tally(A,0,A.window[A.strstart]),A.lookahead--,A.strstart++),t&&(h(A,!1),0===A.strm.avail_out))return 1}return A.insert=0,4===e?(h(A,!0),0===A.strm.avail_out?3:4):A.last_lit&&(h(A,!1),0===A.strm.avail_out)?1:2}(i,e):n[i.level].func(i,e);if(3!==M&&4!==M||(i.status=666),1===M||3===M)return 0===A.avail_out&&(i.last_flush=-1),0;if(2===M&&(1===e?r._tr_align(i):5!==e&&(r._tr_stored_block(i,0,0,!1),3===e&&(l(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),w(A),0===A.avail_out))return i.last_flush=-1,0}return 4!==e?0:i.wrap<=0?1:(2===i.wrap?(C(i,255&A.adler),C(i,A.adler>>8&255),C(i,A.adler>>16&255),C(i,A.adler>>24&255),C(i,255&A.total_in),C(i,A.total_in>>8&255),C(i,A.total_in>>16&255),C(i,A.total_in>>24&255)):(I(i,A.adler>>>16),I(i,65535&A.adler)),w(A),0<i.wrap&&(i.wrap=-i.wrap),0!==i.pending?0:1)},t.deflateEnd=function(A){var e;return A&&A.state?42!==(e=A.state.status)&&69!==e&&73!==e&&91!==e&&103!==e&&e!==E&&666!==e?Q(A,B):(A.state=null,e===E?Q(A,-3):0):B},t.deflateSetDictionary=function(A,e){var t,n,r,s,a,c,g,E,Q=e.length;if(!A||!A.state)return B;if(2===(s=(t=A.state).wrap)||1===s&&42!==t.status||t.lookahead)return B;for(1===s&&(A.adler=o(A.adler,e,Q,0)),t.wrap=0,Q>=t.w_size&&(0===s&&(l(t.head),t.strstart=0,t.block_start=0,t.insert=0),E=new i.Buf8(t.w_size),i.arraySet(E,e,Q-t.w_size,t.w_size,0),e=E,Q=t.w_size),a=A.avail_in,c=A.next_in,g=A.input,A.avail_in=Q,A.next_in=0,A.input=e,d(t);t.lookahead>=3;){for(n=t.strstart,r=t.lookahead-2;t.ins_h=(t.ins_h<<t.hash_shift^t.window[n+3-1])&t.hash_mask,t.prev[n&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=n,n++,--r;);t.strstart=n,t.lookahead=2,d(t)}return t.strstart+=t.lookahead,t.block_start=t.strstart,t.insert=t.lookahead,t.lookahead=0,t.match_length=t.prev_length=2,t.match_available=0,A.next_in=c,A.input=g,A.avail_in=a,t.wrap=s,0},t.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(A,e,t){"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(A,e,t){"use strict";e.exports=function(A,e){var t,n,i,r,o,s,a,B,c,g,E,Q,u,l,w,h,C,I,M,d,m,p,F,D,Y;t=A.state,n=A.next_in,D=A.input,i=n+(A.avail_in-5),r=A.next_out,Y=A.output,o=r-(e-A.avail_out),s=r+(A.avail_out-257),a=t.dmax,B=t.wsize,c=t.whave,g=t.wnext,E=t.window,Q=t.hold,u=t.bits,l=t.lencode,w=t.distcode,h=(1<<t.lenbits)-1,C=(1<<t.distbits)-1;A:do{u<15&&(Q+=D[n++]<<u,u+=8,Q+=D[n++]<<u,u+=8),I=l[Q&h];e:for(;;){if(Q>>>=M=I>>>24,u-=M,0==(M=I>>>16&255))Y[r++]=65535&I;else{if(!(16&M)){if(0==(64&M)){I=l[(65535&I)+(Q&(1<<M)-1)];continue e}if(32&M){t.mode=12;break A}A.msg="invalid literal/length code",t.mode=30;break A}d=65535&I,(M&=15)&&(u<M&&(Q+=D[n++]<<u,u+=8),d+=Q&(1<<M)-1,Q>>>=M,u-=M),u<15&&(Q+=D[n++]<<u,u+=8,Q+=D[n++]<<u,u+=8),I=w[Q&C];t:for(;;){if(Q>>>=M=I>>>24,u-=M,!(16&(M=I>>>16&255))){if(0==(64&M)){I=w[(65535&I)+(Q&(1<<M)-1)];continue t}A.msg="invalid distance code",t.mode=30;break A}if(m=65535&I,u<(M&=15)&&(Q+=D[n++]<<u,(u+=8)<M&&(Q+=D[n++]<<u,u+=8)),a<(m+=Q&(1<<M)-1)){A.msg="invalid distance too far back",t.mode=30;break A}if(Q>>>=M,u-=M,(M=r-o)<m){if(c<(M=m-M)&&t.sane){A.msg="invalid distance too far back",t.mode=30;break A}if(F=E,(p=0)===g){if(p+=B-M,M<d){for(d-=M;Y[r++]=E[p++],--M;);p=r-m,F=Y}}else if(g<M){if(p+=B+g-M,(M-=g)<d){for(d-=M;Y[r++]=E[p++],--M;);if(p=0,g<d){for(d-=M=g;Y[r++]=E[p++],--M;);p=r-m,F=Y}}}else if(p+=g-M,M<d){for(d-=M;Y[r++]=E[p++],--M;);p=r-m,F=Y}for(;2<d;)Y[r++]=F[p++],Y[r++]=F[p++],Y[r++]=F[p++],d-=3;d&&(Y[r++]=F[p++],1<d&&(Y[r++]=F[p++]))}else{for(p=r-m;Y[r++]=Y[p++],Y[r++]=Y[p++],Y[r++]=Y[p++],2<(d-=3););d&&(Y[r++]=Y[p++],1<d&&(Y[r++]=Y[p++]))}break}}break}}while(n<i&&r<s);n-=d=u>>3,Q&=(1<<(u-=d<<3))-1,A.next_in=n,A.next_out=r,A.avail_in=n<i?i-n+5:5-(n-i),A.avail_out=r<s?s-r+257:257-(r-s),t.hold=Q,t.bits=u}},{}],49:[function(A,e,t){"use strict";var n=A("../utils/common"),i=A("./adler32"),r=A("./crc32"),o=A("./inffast"),s=A("./inftrees"),a=-2;function B(A){return(A>>>24&255)+(A>>>8&65280)+((65280&A)<<8)+((255&A)<<24)}function c(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function g(A){var e;return A&&A.state?(e=A.state,A.total_in=A.total_out=e.total=0,A.msg="",e.wrap&&(A.adler=1&e.wrap),e.mode=1,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new n.Buf32(852),e.distcode=e.distdyn=new n.Buf32(592),e.sane=1,e.back=-1,0):a}function E(A){var e;return A&&A.state?((e=A.state).wsize=0,e.whave=0,e.wnext=0,g(A)):a}function Q(A,e){var t,n;return A&&A.state?(n=A.state,e<0?(t=0,e=-e):(t=1+(e>>4),e<48&&(e&=15)),e&&(e<8||15<e)?a:(null!==n.window&&n.wbits!==e&&(n.window=null),n.wrap=t,n.wbits=e,E(A))):a}function u(A,e){var t,n;return A?(n=new c,(A.state=n).window=null,0!==(t=Q(A,e))&&(A.state=null),t):a}var l,w,h=!0;function C(A){if(h){var e;for(l=new n.Buf32(512),w=new n.Buf32(32),e=0;e<144;)A.lens[e++]=8;for(;e<256;)A.lens[e++]=9;for(;e<280;)A.lens[e++]=7;for(;e<288;)A.lens[e++]=8;for(s(1,A.lens,0,288,l,0,A.work,{bits:9}),e=0;e<32;)A.lens[e++]=5;s(2,A.lens,0,32,w,0,A.work,{bits:5}),h=!1}A.lencode=l,A.lenbits=9,A.distcode=w,A.distbits=5}function I(A,e,t,i){var r,o=A.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new n.Buf8(o.wsize)),i>=o.wsize?(n.arraySet(o.window,e,t-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(i<(r=o.wsize-o.wnext)&&(r=i),n.arraySet(o.window,e,t-i,r,o.wnext),(i-=r)?(n.arraySet(o.window,e,t-i,i,0),o.wnext=i,o.whave=o.wsize):(o.wnext+=r,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=r))),0}t.inflateReset=E,t.inflateReset2=Q,t.inflateResetKeep=g,t.inflateInit=function(A){return u(A,15)},t.inflateInit2=u,t.inflate=function(A,e){var t,c,g,E,Q,u,l,w,h,M,d,m,p,F,D,Y,f,N,U,y,T,x,R,G,S=0,H=new n.Buf8(4),b=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!A||!A.state||!A.output||!A.input&&0!==A.avail_in)return a;12===(t=A.state).mode&&(t.mode=13),Q=A.next_out,g=A.output,l=A.avail_out,E=A.next_in,c=A.input,u=A.avail_in,w=t.hold,h=t.bits,M=u,d=l,x=0;A:for(;;)switch(t.mode){case 1:if(0===t.wrap){t.mode=13;break}for(;h<16;){if(0===u)break A;u--,w+=c[E++]<<h,h+=8}if(2&t.wrap&&35615===w){H[t.check=0]=255&w,H[1]=w>>>8&255,t.check=r(t.check,H,2,0),h=w=0,t.mode=2;break}if(t.flags=0,t.head&&(t.head.done=!1),!(1&t.wrap)||(((255&w)<<8)+(w>>8))%31){A.msg="incorrect header check",t.mode=30;break}if(8!=(15&w)){A.msg="unknown compression method",t.mode=30;break}if(h-=4,T=8+(15&(w>>>=4)),0===t.wbits)t.wbits=T;else if(T>t.wbits){A.msg="invalid window size",t.mode=30;break}t.dmax=1<<T,A.adler=t.check=1,t.mode=512&w?10:12,h=w=0;break;case 2:for(;h<16;){if(0===u)break A;u--,w+=c[E++]<<h,h+=8}if(t.flags=w,8!=(255&t.flags)){A.msg="unknown compression method",t.mode=30;break}if(57344&t.flags){A.msg="unknown header flags set",t.mode=30;break}t.head&&(t.head.text=w>>8&1),512&t.flags&&(H[0]=255&w,H[1]=w>>>8&255,t.check=r(t.check,H,2,0)),h=w=0,t.mode=3;case 3:for(;h<32;){if(0===u)break A;u--,w+=c[E++]<<h,h+=8}t.head&&(t.head.time=w),512&t.flags&&(H[0]=255&w,H[1]=w>>>8&255,H[2]=w>>>16&255,H[3]=w>>>24&255,t.check=r(t.check,H,4,0)),h=w=0,t.mode=4;case 4:for(;h<16;){if(0===u)break A;u--,w+=c[E++]<<h,h+=8}t.head&&(t.head.xflags=255&w,t.head.os=w>>8),512&t.flags&&(H[0]=255&w,H[1]=w>>>8&255,t.check=r(t.check,H,2,0)),h=w=0,t.mode=5;case 5:if(1024&t.flags){for(;h<16;){if(0===u)break A;u--,w+=c[E++]<<h,h+=8}t.length=w,t.head&&(t.head.extra_len=w),512&t.flags&&(H[0]=255&w,H[1]=w>>>8&255,t.check=r(t.check,H,2,0)),h=w=0}else t.head&&(t.head.extra=null);t.mode=6;case 6:if(1024&t.flags&&(u<(m=t.length)&&(m=u),m&&(t.head&&(T=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Array(t.head.extra_len)),n.arraySet(t.head.extra,c,E,m,T)),512&t.flags&&(t.check=r(t.check,c,m,E)),u-=m,E+=m,t.length-=m),t.length))break A;t.length=0,t.mode=7;case 7:if(2048&t.flags){if(0===u)break A;for(m=0;T=c[E+m++],t.head&&T&&t.length<65536&&(t.head.name+=String.fromCharCode(T)),T&&m<u;);if(512&t.flags&&(t.check=r(t.check,c,m,E)),u-=m,E+=m,T)break A}else t.head&&(t.head.name=null);t.length=0,t.mode=8;case 8:if(4096&t.flags){if(0===u)break A;for(m=0;T=c[E+m++],t.head&&T&&t.length<65536&&(t.head.comment+=String.fromCharCode(T)),T&&m<u;);if(512&t.flags&&(t.check=r(t.check,c,m,E)),u-=m,E+=m,T)break A}else t.head&&(t.head.comment=null);t.mode=9;case 9:if(512&t.flags){for(;h<16;){if(0===u)break A;u--,w+=c[E++]<<h,h+=8}if(w!==(65535&t.check)){A.msg="header crc mismatch",t.mode=30;break}h=w=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),A.adler=t.check=0,t.mode=12;break;case 10:for(;h<32;){if(0===u)break A;u--,w+=c[E++]<<h,h+=8}A.adler=t.check=B(w),h=w=0,t.mode=11;case 11:if(0===t.havedict)return A.next_out=Q,A.avail_out=l,A.next_in=E,A.avail_in=u,t.hold=w,t.bits=h,2;A.adler=t.check=1,t.mode=12;case 12:if(5===e||6===e)break A;case 13:if(t.last){w>>>=7&h,h-=7&h,t.mode=27;break}for(;h<3;){if(0===u)break A;u--,w+=c[E++]<<h,h+=8}switch(t.last=1&w,h-=1,3&(w>>>=1)){case 0:t.mode=14;break;case 1:if(C(t),t.mode=20,6!==e)break;w>>>=2,h-=2;break A;case 2:t.mode=17;break;case 3:A.msg="invalid block type",t.mode=30}w>>>=2,h-=2;break;case 14:for(w>>>=7&h,h-=7&h;h<32;){if(0===u)break A;u--,w+=c[E++]<<h,h+=8}if((65535&w)!=(w>>>16^65535)){A.msg="invalid stored block lengths",t.mode=30;break}if(t.length=65535&w,h=w=0,t.mode=15,6===e)break A;case 15:t.mode=16;case 16:if(m=t.length){if(u<m&&(m=u),l<m&&(m=l),0===m)break A;n.arraySet(g,c,E,m,Q),u-=m,E+=m,l-=m,Q+=m,t.length-=m;break}t.mode=12;break;case 17:for(;h<14;){if(0===u)break A;u--,w+=c[E++]<<h,h+=8}if(t.nlen=257+(31&w),w>>>=5,h-=5,t.ndist=1+(31&w),w>>>=5,h-=5,t.ncode=4+(15&w),w>>>=4,h-=4,286<t.nlen||30<t.ndist){A.msg="too many length or distance symbols",t.mode=30;break}t.have=0,t.mode=18;case 18:for(;t.have<t.ncode;){for(;h<3;){if(0===u)break A;u--,w+=c[E++]<<h,h+=8}t.lens[b[t.have++]]=7&w,w>>>=3,h-=3}for(;t.have<19;)t.lens[b[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,R={bits:t.lenbits},x=s(0,t.lens,0,19,t.lencode,0,t.work,R),t.lenbits=R.bits,x){A.msg="invalid code lengths set",t.mode=30;break}t.have=0,t.mode=19;case 19:for(;t.have<t.nlen+t.ndist;){for(;Y=(S=t.lencode[w&(1<<t.lenbits)-1])>>>16&255,f=65535&S,!((D=S>>>24)<=h);){if(0===u)break A;u--,w+=c[E++]<<h,h+=8}if(f<16)w>>>=D,h-=D,t.lens[t.have++]=f;else{if(16===f){for(G=D+2;h<G;){if(0===u)break A;u--,w+=c[E++]<<h,h+=8}if(w>>>=D,h-=D,0===t.have){A.msg="invalid bit length repeat",t.mode=30;break}T=t.lens[t.have-1],m=3+(3&w),w>>>=2,h-=2}else if(17===f){for(G=D+3;h<G;){if(0===u)break A;u--,w+=c[E++]<<h,h+=8}h-=D,T=0,m=3+(7&(w>>>=D)),w>>>=3,h-=3}else{for(G=D+7;h<G;){if(0===u)break A;u--,w+=c[E++]<<h,h+=8}h-=D,T=0,m=11+(127&(w>>>=D)),w>>>=7,h-=7}if(t.have+m>t.nlen+t.ndist){A.msg="invalid bit length repeat",t.mode=30;break}for(;m--;)t.lens[t.have++]=T}}if(30===t.mode)break;if(0===t.lens[256]){A.msg="invalid code -- missing end-of-block",t.mode=30;break}if(t.lenbits=9,R={bits:t.lenbits},x=s(1,t.lens,0,t.nlen,t.lencode,0,t.work,R),t.lenbits=R.bits,x){A.msg="invalid literal/lengths set",t.mode=30;break}if(t.distbits=6,t.distcode=t.distdyn,R={bits:t.distbits},x=s(2,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,R),t.distbits=R.bits,x){A.msg="invalid distances set",t.mode=30;break}if(t.mode=20,6===e)break A;case 20:t.mode=21;case 21:if(6<=u&&258<=l){A.next_out=Q,A.avail_out=l,A.next_in=E,A.avail_in=u,t.hold=w,t.bits=h,o(A,d),Q=A.next_out,g=A.output,l=A.avail_out,E=A.next_in,c=A.input,u=A.avail_in,w=t.hold,h=t.bits,12===t.mode&&(t.back=-1);break}for(t.back=0;Y=(S=t.lencode[w&(1<<t.lenbits)-1])>>>16&255,f=65535&S,!((D=S>>>24)<=h);){if(0===u)break A;u--,w+=c[E++]<<h,h+=8}if(Y&&0==(240&Y)){for(N=D,U=Y,y=f;Y=(S=t.lencode[y+((w&(1<<N+U)-1)>>N)])>>>16&255,f=65535&S,!(N+(D=S>>>24)<=h);){if(0===u)break A;u--,w+=c[E++]<<h,h+=8}w>>>=N,h-=N,t.back+=N}if(w>>>=D,h-=D,t.back+=D,t.length=f,0===Y){t.mode=26;break}if(32&Y){t.back=-1,t.mode=12;break}if(64&Y){A.msg="invalid literal/length code",t.mode=30;break}t.extra=15&Y,t.mode=22;case 22:if(t.extra){for(G=t.extra;h<G;){if(0===u)break A;u--,w+=c[E++]<<h,h+=8}t.length+=w&(1<<t.extra)-1,w>>>=t.extra,h-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=23;case 23:for(;Y=(S=t.distcode[w&(1<<t.distbits)-1])>>>16&255,f=65535&S,!((D=S>>>24)<=h);){if(0===u)break A;u--,w+=c[E++]<<h,h+=8}if(0==(240&Y)){for(N=D,U=Y,y=f;Y=(S=t.distcode[y+((w&(1<<N+U)-1)>>N)])>>>16&255,f=65535&S,!(N+(D=S>>>24)<=h);){if(0===u)break A;u--,w+=c[E++]<<h,h+=8}w>>>=N,h-=N,t.back+=N}if(w>>>=D,h-=D,t.back+=D,64&Y){A.msg="invalid distance code",t.mode=30;break}t.offset=f,t.extra=15&Y,t.mode=24;case 24:if(t.extra){for(G=t.extra;h<G;){if(0===u)break A;u--,w+=c[E++]<<h,h+=8}t.offset+=w&(1<<t.extra)-1,w>>>=t.extra,h-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){A.msg="invalid distance too far back",t.mode=30;break}t.mode=25;case 25:if(0===l)break A;if(m=d-l,t.offset>m){if((m=t.offset-m)>t.whave&&t.sane){A.msg="invalid distance too far back",t.mode=30;break}p=m>t.wnext?(m-=t.wnext,t.wsize-m):t.wnext-m,m>t.length&&(m=t.length),F=t.window}else F=g,p=Q-t.offset,m=t.length;for(l<m&&(m=l),l-=m,t.length-=m;g[Q++]=F[p++],--m;);0===t.length&&(t.mode=21);break;case 26:if(0===l)break A;g[Q++]=t.length,l--,t.mode=21;break;case 27:if(t.wrap){for(;h<32;){if(0===u)break A;u--,w|=c[E++]<<h,h+=8}if(d-=l,A.total_out+=d,t.total+=d,d&&(A.adler=t.check=t.flags?r(t.check,g,d,Q-d):i(t.check,g,d,Q-d)),d=l,(t.flags?w:B(w))!==t.check){A.msg="incorrect data check",t.mode=30;break}h=w=0}t.mode=28;case 28:if(t.wrap&&t.flags){for(;h<32;){if(0===u)break A;u--,w+=c[E++]<<h,h+=8}if(w!==(4294967295&t.total)){A.msg="incorrect length check",t.mode=30;break}h=w=0}t.mode=29;case 29:x=1;break A;case 30:x=-3;break A;case 31:return-4;case 32:default:return a}return A.next_out=Q,A.avail_out=l,A.next_in=E,A.avail_in=u,t.hold=w,t.bits=h,(t.wsize||d!==A.avail_out&&t.mode<30&&(t.mode<27||4!==e))&&I(A,A.output,A.next_out,d-A.avail_out)?(t.mode=31,-4):(M-=A.avail_in,d-=A.avail_out,A.total_in+=M,A.total_out+=d,t.total+=d,t.wrap&&d&&(A.adler=t.check=t.flags?r(t.check,g,d,A.next_out-d):i(t.check,g,d,A.next_out-d)),A.data_type=t.bits+(t.last?64:0)+(12===t.mode?128:0)+(20===t.mode||15===t.mode?256:0),(0==M&&0===d||4===e)&&0===x&&(x=-5),x)},t.inflateEnd=function(A){if(!A||!A.state)return a;var e=A.state;return e.window&&(e.window=null),A.state=null,0},t.inflateGetHeader=function(A,e){var t;return A&&A.state?0==(2&(t=A.state).wrap)?a:((t.head=e).done=!1,0):a},t.inflateSetDictionary=function(A,e){var t,n=e.length;return A&&A.state?0!==(t=A.state).wrap&&11!==t.mode?a:11===t.mode&&i(1,e,n,0)!==t.check?-3:I(A,e,n,n)?(t.mode=31,-4):(t.havedict=1,0):a},t.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(A,e,t){"use strict";var n=A("../utils/common"),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],r=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(A,e,t,a,B,c,g,E){var Q,u,l,w,h,C,I,M,d,m=E.bits,p=0,F=0,D=0,Y=0,f=0,N=0,U=0,y=0,T=0,x=0,R=null,G=0,S=new n.Buf16(16),H=new n.Buf16(16),b=null,v=0;for(p=0;p<=15;p++)S[p]=0;for(F=0;F<a;F++)S[e[t+F]]++;for(f=m,Y=15;1<=Y&&0===S[Y];Y--);if(Y<f&&(f=Y),0===Y)return B[c++]=20971520,B[c++]=20971520,E.bits=1,0;for(D=1;D<Y&&0===S[D];D++);for(f<D&&(f=D),p=y=1;p<=15;p++)if(y<<=1,(y-=S[p])<0)return-1;if(0<y&&(0===A||1!==Y))return-1;for(H[1]=0,p=1;p<15;p++)H[p+1]=H[p]+S[p];for(F=0;F<a;F++)0!==e[t+F]&&(g[H[e[t+F]]++]=F);if(C=0===A?(R=b=g,19):1===A?(R=i,G-=257,b=r,v-=257,256):(R=o,b=s,-1),p=D,h=c,U=F=x=0,l=-1,w=(T=1<<(N=f))-1,1===A&&852<T||2===A&&592<T)return 1;for(;;){for(I=p-U,d=g[F]<C?(M=0,g[F]):g[F]>C?(M=b[v+g[F]],R[G+g[F]]):(M=96,0),Q=1<<p-U,D=u=1<<N;B[h+(x>>U)+(u-=Q)]=I<<24|M<<16|d|0,0!==u;);for(Q=1<<p-1;x&Q;)Q>>=1;if(0!==Q?(x&=Q-1,x+=Q):x=0,F++,0==--S[p]){if(p===Y)break;p=e[t+g[F]]}if(f<p&&(x&w)!==l){for(0===U&&(U=f),h+=D,y=1<<(N=p-U);N+U<Y&&!((y-=S[N+U])<=0);)N++,y<<=1;if(T+=1<<N,1===A&&852<T||2===A&&592<T)return 1;B[l=x&w]=f<<24|N<<16|h-c|0}}return 0!==x&&(B[h+x]=p-U<<24|64<<16|0),E.bits=f,0}},{"../utils/common":41}],51:[function(A,e,t){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(A,e,t){"use strict";var n=A("../utils/common");function i(A){for(var e=A.length;0<=--e;)A[e]=0}var r=256,o=286,s=30,a=15,B=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],c=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],E=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Q=new Array(576);i(Q);var u=new Array(60);i(u);var l=new Array(512);i(l);var w=new Array(256);i(w);var h=new Array(29);i(h);var C,I,M,d=new Array(s);function m(A,e,t,n,i){this.static_tree=A,this.extra_bits=e,this.extra_base=t,this.elems=n,this.max_length=i,this.has_stree=A&&A.length}function p(A,e){this.dyn_tree=A,this.max_code=0,this.stat_desc=e}function F(A){return A<256?l[A]:l[256+(A>>>7)]}function D(A,e){A.pending_buf[A.pending++]=255&e,A.pending_buf[A.pending++]=e>>>8&255}function Y(A,e,t){A.bi_valid>16-t?(A.bi_buf|=e<<A.bi_valid&65535,D(A,A.bi_buf),A.bi_buf=e>>16-A.bi_valid,A.bi_valid+=t-16):(A.bi_buf|=e<<A.bi_valid&65535,A.bi_valid+=t)}function f(A,e,t){Y(A,t[2*e],t[2*e+1])}function N(A,e){for(var t=0;t|=1&A,A>>>=1,t<<=1,0<--e;);return t>>>1}function U(A,e,t){var n,i,r=new Array(16),o=0;for(n=1;n<=a;n++)r[n]=o=o+t[n-1]<<1;for(i=0;i<=e;i++){var s=A[2*i+1];0!==s&&(A[2*i]=N(r[s]++,s))}}function y(A){var e;for(e=0;e<o;e++)A.dyn_ltree[2*e]=0;for(e=0;e<s;e++)A.dyn_dtree[2*e]=0;for(e=0;e<19;e++)A.bl_tree[2*e]=0;A.dyn_ltree[512]=1,A.opt_len=A.static_len=0,A.last_lit=A.matches=0}function T(A){8<A.bi_valid?D(A,A.bi_buf):0<A.bi_valid&&(A.pending_buf[A.pending++]=A.bi_buf),A.bi_buf=0,A.bi_valid=0}function x(A,e,t,n){var i=2*e,r=2*t;return A[i]<A[r]||A[i]===A[r]&&n[e]<=n[t]}function R(A,e,t){for(var n=A.heap[t],i=t<<1;i<=A.heap_len&&(i<A.heap_len&&x(e,A.heap[i+1],A.heap[i],A.depth)&&i++,!x(e,n,A.heap[i],A.depth));)A.heap[t]=A.heap[i],t=i,i<<=1;A.heap[t]=n}function G(A,e,t){var n,i,o,s,a=0;if(0!==A.last_lit)for(;n=A.pending_buf[A.d_buf+2*a]<<8|A.pending_buf[A.d_buf+2*a+1],i=A.pending_buf[A.l_buf+a],a++,0===n?f(A,i,e):(f(A,(o=w[i])+r+1,e),0!==(s=B[o])&&Y(A,i-=h[o],s),f(A,o=F(--n),t),0!==(s=c[o])&&Y(A,n-=d[o],s)),a<A.last_lit;);f(A,256,e)}function S(A,e){var t,n,i,r=e.dyn_tree,o=e.stat_desc.static_tree,s=e.stat_desc.has_stree,B=e.stat_desc.elems,c=-1;for(A.heap_len=0,A.heap_max=573,t=0;t<B;t++)0!==r[2*t]?(A.heap[++A.heap_len]=c=t,A.depth[t]=0):r[2*t+1]=0;for(;A.heap_len<2;)r[2*(i=A.heap[++A.heap_len]=c<2?++c:0)]=1,A.depth[i]=0,A.opt_len--,s&&(A.static_len-=o[2*i+1]);for(e.max_code=c,t=A.heap_len>>1;1<=t;t--)R(A,r,t);for(i=B;t=A.heap[1],A.heap[1]=A.heap[A.heap_len--],R(A,r,1),n=A.heap[1],A.heap[--A.heap_max]=t,A.heap[--A.heap_max]=n,r[2*i]=r[2*t]+r[2*n],A.depth[i]=(A.depth[t]>=A.depth[n]?A.depth[t]:A.depth[n])+1,r[2*t+1]=r[2*n+1]=i,A.heap[1]=i++,R(A,r,1),2<=A.heap_len;);A.heap[--A.heap_max]=A.heap[1],function(A,e){var t,n,i,r,o,s,B=e.dyn_tree,c=e.max_code,g=e.stat_desc.static_tree,E=e.stat_desc.has_stree,Q=e.stat_desc.extra_bits,u=e.stat_desc.extra_base,l=e.stat_desc.max_length,w=0;for(r=0;r<=a;r++)A.bl_count[r]=0;for(B[2*A.heap[A.heap_max]+1]=0,t=A.heap_max+1;t<573;t++)l<(r=B[2*B[2*(n=A.heap[t])+1]+1]+1)&&(r=l,w++),B[2*n+1]=r,c<n||(A.bl_count[r]++,o=0,u<=n&&(o=Q[n-u]),s=B[2*n],A.opt_len+=s*(r+o),E&&(A.static_len+=s*(g[2*n+1]+o)));if(0!==w){do{for(r=l-1;0===A.bl_count[r];)r--;A.bl_count[r]--,A.bl_count[r+1]+=2,A.bl_count[l]--,w-=2}while(0<w);for(r=l;0!==r;r--)for(n=A.bl_count[r];0!==n;)c<(i=A.heap[--t])||(B[2*i+1]!==r&&(A.opt_len+=(r-B[2*i+1])*B[2*i],B[2*i+1]=r),n--)}}(A,e),U(r,c,A.bl_count)}function H(A,e,t){var n,i,r=-1,o=e[1],s=0,a=7,B=4;for(0===o&&(a=138,B=3),e[2*(t+1)+1]=65535,n=0;n<=t;n++)i=o,o=e[2*(n+1)+1],++s<a&&i===o||(s<B?A.bl_tree[2*i]+=s:0!==i?(i!==r&&A.bl_tree[2*i]++,A.bl_tree[32]++):s<=10?A.bl_tree[34]++:A.bl_tree[36]++,r=i,B=(s=0)===o?(a=138,3):i===o?(a=6,3):(a=7,4))}function b(A,e,t){var n,i,r=-1,o=e[1],s=0,a=7,B=4;for(0===o&&(a=138,B=3),n=0;n<=t;n++)if(i=o,o=e[2*(n+1)+1],!(++s<a&&i===o)){if(s<B)for(;f(A,i,A.bl_tree),0!=--s;);else 0!==i?(i!==r&&(f(A,i,A.bl_tree),s--),f(A,16,A.bl_tree),Y(A,s-3,2)):s<=10?(f(A,17,A.bl_tree),Y(A,s-3,3)):(f(A,18,A.bl_tree),Y(A,s-11,7));r=i,B=(s=0)===o?(a=138,3):i===o?(a=6,3):(a=7,4)}}i(d);var v=!1;function k(A,e,t,i){Y(A,0+(i?1:0),3),function(A,e,t,i){T(A),D(A,t),D(A,~t),n.arraySet(A.pending_buf,A.window,e,t,A.pending),A.pending+=t}(A,e,t)}t._tr_init=function(A){v||(function(){var A,e,t,n,i,r=new Array(16);for(n=t=0;n<28;n++)for(h[n]=t,A=0;A<1<<B[n];A++)w[t++]=n;for(w[t-1]=n,n=i=0;n<16;n++)for(d[n]=i,A=0;A<1<<c[n];A++)l[i++]=n;for(i>>=7;n<s;n++)for(d[n]=i<<7,A=0;A<1<<c[n]-7;A++)l[256+i++]=n;for(e=0;e<=a;e++)r[e]=0;for(A=0;A<=143;)Q[2*A+1]=8,A++,r[8]++;for(;A<=255;)Q[2*A+1]=9,A++,r[9]++;for(;A<=279;)Q[2*A+1]=7,A++,r[7]++;for(;A<=287;)Q[2*A+1]=8,A++,r[8]++;for(U(Q,287,r),A=0;A<s;A++)u[2*A+1]=5,u[2*A]=N(A,5);C=new m(Q,B,257,o,a),I=new m(u,c,0,s,a),M=new m(new Array(0),g,0,19,7)}(),v=!0),A.l_desc=new p(A.dyn_ltree,C),A.d_desc=new p(A.dyn_dtree,I),A.bl_desc=new p(A.bl_tree,M),A.bi_buf=0,A.bi_valid=0,y(A)},t._tr_stored_block=k,t._tr_flush_block=function(A,e,t,n){var i,o,s=0;0<A.level?(2===A.strm.data_type&&(A.strm.data_type=function(A){var e,t=4093624447;for(e=0;e<=31;e++,t>>>=1)if(1&t&&0!==A.dyn_ltree[2*e])return 0;if(0!==A.dyn_ltree[18]||0!==A.dyn_ltree[20]||0!==A.dyn_ltree[26])return 1;for(e=32;e<r;e++)if(0!==A.dyn_ltree[2*e])return 1;return 0}(A)),S(A,A.l_desc),S(A,A.d_desc),s=function(A){var e;for(H(A,A.dyn_ltree,A.l_desc.max_code),H(A,A.dyn_dtree,A.d_desc.max_code),S(A,A.bl_desc),e=18;3<=e&&0===A.bl_tree[2*E[e]+1];e--);return A.opt_len+=3*(e+1)+5+5+4,e}(A),i=A.opt_len+3+7>>>3,(o=A.static_len+3+7>>>3)<=i&&(i=o)):i=o=t+5,t+4<=i&&-1!==e?k(A,e,t,n):4===A.strategy||o===i?(Y(A,2+(n?1:0),3),G(A,Q,u)):(Y(A,4+(n?1:0),3),function(A,e,t,n){var i;for(Y(A,e-257,5),Y(A,t-1,5),Y(A,n-4,4),i=0;i<n;i++)Y(A,A.bl_tree[2*E[i]+1],3);b(A,A.dyn_ltree,e-1),b(A,A.dyn_dtree,t-1)}(A,A.l_desc.max_code+1,A.d_desc.max_code+1,s+1),G(A,A.dyn_ltree,A.dyn_dtree)),y(A),n&&T(A)},t._tr_tally=function(A,e,t){return A.pending_buf[A.d_buf+2*A.last_lit]=e>>>8&255,A.pending_buf[A.d_buf+2*A.last_lit+1]=255&e,A.pending_buf[A.l_buf+A.last_lit]=255&t,A.last_lit++,0===e?A.dyn_ltree[2*t]++:(A.matches++,e--,A.dyn_ltree[2*(w[t]+r+1)]++,A.dyn_dtree[2*F(e)]++),A.last_lit===A.lit_bufsize-1},t._tr_align=function(A){Y(A,2,3),f(A,256,Q),function(A){16===A.bi_valid?(D(A,A.bi_buf),A.bi_buf=0,A.bi_valid=0):8<=A.bi_valid&&(A.pending_buf[A.pending++]=255&A.bi_buf,A.bi_buf>>=8,A.bi_valid-=8)}(A)}},{"../utils/common":41}],53:[function(A,e,t){"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(A,e,t){(function(A){!function(A,e){"use strict";if(!A.setImmediate){var t,n,r,o,s=1,a={},B=!1,c=A.document,g=Object.getPrototypeOf&&Object.getPrototypeOf(A);g=g&&g.setTimeout?g:A,t="[object process]"==={}.toString.call(A.process)?function(A){i.nextTick((function(){Q(A)}))}:function(){if(A.postMessage&&!A.importScripts){var e=!0,t=A.onmessage;return A.onmessage=function(){e=!1},A.postMessage("","*"),A.onmessage=t,e}}()?(o="setImmediate$"+Math.random()+"$",A.addEventListener?A.addEventListener("message",u,!1):A.attachEvent("onmessage",u),function(e){A.postMessage(o+e,"*")}):A.MessageChannel?((r=new MessageChannel).port1.onmessage=function(A){Q(A.data)},function(A){r.port2.postMessage(A)}):c&&"onreadystatechange"in c.createElement("script")?(n=c.documentElement,function(A){var e=c.createElement("script");e.onreadystatechange=function(){Q(A),e.onreadystatechange=null,n.removeChild(e),e=null},n.appendChild(e)}):function(A){setTimeout(Q,0,A)},g.setImmediate=function(A){"function"!=typeof A&&(A=new Function(""+A));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var i={callback:A,args:e};return a[s]=i,t(s),s++},g.clearImmediate=E}function E(A){delete a[A]}function Q(A){if(B)setTimeout(Q,0,A);else{var e=a[A];if(e){B=!0;try{!function(A){var e=A.callback,t=A.args;switch(t.length){case 0:e();break;case 1:e(t[0]);break;case 2:e(t[0],t[1]);break;case 3:e(t[0],t[1],t[2]);break;default:e.apply(void 0,t)}}(e)}finally{E(A),B=!1}}}}function u(e){e.source===A&&"string"==typeof e.data&&0===e.data.indexOf(o)&&Q(+e.data.slice(o.length))}}("undefined"==typeof self?void 0===A?this:A:self)}).call(this,void 0!==n?n:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])(10)}).call(this,t(20).Buffer,t(130).setImmediate,t(14),t(40))},function(A,e,t){A.exports=function(){"use strict";var A=Array.prototype.slice;function e(A,e){e&&(A.prototype=Object.create(e.prototype)),A.prototype.constructor=A}function t(A){return o(A)?A:z(A)}function n(A){return s(A)?A:L(A)}function i(A){return a(A)?A:P(A)}function r(A){return o(A)&&!B(A)?A:O(A)}function o(A){return!(!A||!A[g])}function s(A){return!(!A||!A[E])}function a(A){return!(!A||!A[Q])}function B(A){return s(A)||a(A)}function c(A){return!(!A||!A[u])}e(n,t),e(i,t),e(r,t),t.isIterable=o,t.isKeyed=s,t.isIndexed=a,t.isAssociative=B,t.isOrdered=c,t.Keyed=n,t.Indexed=i,t.Set=r;var g="@@__IMMUTABLE_ITERABLE__@@",E="@@__IMMUTABLE_KEYED__@@",Q="@@__IMMUTABLE_INDEXED__@@",u="@@__IMMUTABLE_ORDERED__@@",l={},w={value:!1},h={value:!1};function C(A){return A.value=!1,A}function I(A){A&&(A.value=!0)}function M(){}function d(A,e){e=e||0;for(var t=Math.max(0,A.length-e),n=new Array(t),i=0;i<t;i++)n[i]=A[i+e];return n}function m(A){return void 0===A.size&&(A.size=A.__iterate(F)),A.size}function p(A,e){if("number"!=typeof e){var t=e>>>0;if(""+t!==e||4294967295===t)return NaN;e=t}return e<0?m(A)+e:e}function F(){return!0}function D(A,e,t){return(0===A||void 0!==t&&A<=-t)&&(void 0===e||void 0!==t&&e>=t)}function Y(A,e){return N(A,e,0)}function f(A,e){return N(A,e,e)}function N(A,e,t){return void 0===A?t:A<0?Math.max(0,e+A):void 0===e?A:Math.min(e,A)}var U,y,T,x="function"==typeof Symbol&&Symbol.iterator,R=x||"@@iterator";function G(A){this.next=A}function S(A,e,t,n){var i=0===A?e:1===A?t:[e,t];return n?n.value=i:n={value:i,done:!1},n}function H(){return{value:void 0,done:!0}}function b(A){return!!j(A)}function v(A){return A&&"function"==typeof A.next}function k(A){var e=j(A);return e&&e.call(A)}function j(A){var e=A&&(x&&A[x]||A["@@iterator"]);if("function"==typeof e)return e}function J(A){return A&&"number"==typeof A.length}function z(A){return null==A?_():o(A)?A.toSeq():function(A){var e=AA(A)||"object"==typeof A&&new W(A);if(!e)throw new TypeError("Expected Array or iterable object of values, or keyed object: "+A);return e}(A)}function L(A){return null==A?_().toKeyedSeq():o(A)?s(A)?A.toSeq():A.fromEntrySeq():q(A)}function P(A){return null==A?_():o(A)?s(A)?A.entrySeq():A.toIndexedSeq():$(A)}function O(A){return(null==A?_():o(A)?s(A)?A.entrySeq():A:$(A)).toSetSeq()}function V(A){this._array=A,this.size=A.length}function W(A){var e=Object.keys(A);this._object=A,this._keys=e,this.size=e.length}function K(A){this._iterable=A,this.size=A.length||A.size}function X(A){this._iterator=A,this._iteratorCache=[]}function Z(A){return!(!A||!A["@@__IMMUTABLE_SEQ__@@"])}function _(){return U||(U=new V([]))}function q(A){var e=Array.isArray(A)?new V(A).fromEntrySeq():v(A)?new X(A).fromEntrySeq():b(A)?new K(A).fromEntrySeq():"object"==typeof A?new W(A):void 0;if(!e)throw new TypeError("Expected Array or iterable object of [k, v] entries, or keyed object: "+A);return e}function $(A){var e=AA(A);if(!e)throw new TypeError("Expected Array or iterable object of values: "+A);return e}function AA(A){return J(A)?new V(A):v(A)?new X(A):b(A)?new K(A):void 0}function eA(A,e,t,n){var i=A._cache;if(i){for(var r=i.length-1,o=0;o<=r;o++){var s=i[t?r-o:o];if(!1===e(s[1],n?s[0]:o,A))return o+1}return o}return A.__iterateUncached(e,t)}function tA(A,e,t,n){var i=A._cache;if(i){var r=i.length-1,o=0;return new G((function(){var A=i[t?r-o:o];return o++>r?{value:void 0,done:!0}:S(e,n?A[0]:o-1,A[1])}))}return A.__iteratorUncached(e,t)}function nA(A,e){return e?function A(e,t,n,i){return Array.isArray(t)?e.call(i,n,P(t).map((function(n,i){return A(e,n,i,t)}))):rA(t)?e.call(i,n,L(t).map((function(n,i){return A(e,n,i,t)}))):t}(e,A,"",{"":A}):iA(A)}function iA(A){return Array.isArray(A)?P(A).map(iA).toList():rA(A)?L(A).map(iA).toMap():A}function rA(A){return A&&(A.constructor===Object||void 0===A.constructor)}function oA(A,e){if(A===e||A!=A&&e!=e)return!0;if(!A||!e)return!1;if("function"==typeof A.valueOf&&"function"==typeof e.valueOf){if((A=A.valueOf())===(e=e.valueOf())||A!=A&&e!=e)return!0;if(!A||!e)return!1}return!("function"!=typeof A.equals||"function"!=typeof e.equals||!A.equals(e))}function sA(A,e){if(A===e)return!0;if(!o(e)||void 0!==A.size&&void 0!==e.size&&A.size!==e.size||void 0!==A.__hash&&void 0!==e.__hash&&A.__hash!==e.__hash||s(A)!==s(e)||a(A)!==a(e)||c(A)!==c(e))return!1;if(0===A.size&&0===e.size)return!0;var t=!B(A);if(c(A)){var n=A.entries();return e.every((function(A,e){var i=n.next().value;return i&&oA(i[1],A)&&(t||oA(i[0],e))}))&&n.next().done}var i=!1;if(void 0===A.size)if(void 0===e.size)"function"==typeof A.cacheResult&&A.cacheResult();else{i=!0;var r=A;A=e,e=r}var g=!0,E=e.__iterate((function(e,n){if(t?!A.has(e):i?!oA(e,A.get(n,l)):!oA(A.get(n,l),e))return g=!1,!1}));return g&&A.size===E}function aA(A,e){if(!(this instanceof aA))return new aA(A,e);if(this._value=A,this.size=void 0===e?1/0:Math.max(0,e),0===this.size){if(y)return y;y=this}}function BA(A,e){if(!A)throw new Error(e)}function cA(A,e,t){if(!(this instanceof cA))return new cA(A,e,t);if(BA(0!==t,"Cannot step a Range by 0"),A=A||0,void 0===e&&(e=1/0),t=void 0===t?1:Math.abs(t),e<A&&(t=-t),this._start=A,this._end=e,this._step=t,this.size=Math.max(0,Math.ceil((e-A)/t-1)+1),0===this.size){if(T)return T;T=this}}function gA(){throw TypeError("Abstract")}function EA(){}function QA(){}function uA(){}G.prototype.toString=function(){return"[Iterator]"},G.KEYS=0,G.VALUES=1,G.ENTRIES=2,G.prototype.inspect=G.prototype.toSource=function(){return this.toString()},G.prototype[R]=function(){return this},e(z,t),z.of=function(){return z(arguments)},z.prototype.toSeq=function(){return this},z.prototype.toString=function(){return this.__toString("Seq {","}")},z.prototype.cacheResult=function(){return!this._cache&&this.__iterateUncached&&(this._cache=this.entrySeq().toArray(),this.size=this._cache.length),this},z.prototype.__iterate=function(A,e){return eA(this,A,e,!0)},z.prototype.__iterator=function(A,e){return tA(this,A,e,!0)},e(L,z),L.prototype.toKeyedSeq=function(){return this},e(P,z),P.of=function(){return P(arguments)},P.prototype.toIndexedSeq=function(){return this},P.prototype.toString=function(){return this.__toString("Seq [","]")},P.prototype.__iterate=function(A,e){return eA(this,A,e,!1)},P.prototype.__iterator=function(A,e){return tA(this,A,e,!1)},e(O,z),O.of=function(){return O(arguments)},O.prototype.toSetSeq=function(){return this},z.isSeq=Z,z.Keyed=L,z.Set=O,z.Indexed=P,z.prototype["@@__IMMUTABLE_SEQ__@@"]=!0,e(V,P),V.prototype.get=function(A,e){return this.has(A)?this._array[p(this,A)]:e},V.prototype.__iterate=function(A,e){for(var t=this._array,n=t.length-1,i=0;i<=n;i++)if(!1===A(t[e?n-i:i],i,this))return i+1;return i},V.prototype.__iterator=function(A,e){var t=this._array,n=t.length-1,i=0;return new G((function(){return i>n?{value:void 0,done:!0}:S(A,i,t[e?n-i++:i++])}))},e(W,L),W.prototype.get=function(A,e){return void 0===e||this.has(A)?this._object[A]:e},W.prototype.has=function(A){return this._object.hasOwnProperty(A)},W.prototype.__iterate=function(A,e){for(var t=this._object,n=this._keys,i=n.length-1,r=0;r<=i;r++){var o=n[e?i-r:r];if(!1===A(t[o],o,this))return r+1}return r},W.prototype.__iterator=function(A,e){var t=this._object,n=this._keys,i=n.length-1,r=0;return new G((function(){var o=n[e?i-r:r];return r++>i?{value:void 0,done:!0}:S(A,o,t[o])}))},W.prototype[u]=!0,e(K,P),K.prototype.__iterateUncached=function(A,e){if(e)return this.cacheResult().__iterate(A,e);var t=k(this._iterable),n=0;if(v(t))for(var i;!(i=t.next()).done&&!1!==A(i.value,n++,this););return n},K.prototype.__iteratorUncached=function(A,e){if(e)return this.cacheResult().__iterator(A,e);var t=k(this._iterable);if(!v(t))return new G(H);var n=0;return new G((function(){var e=t.next();return e.done?e:S(A,n++,e.value)}))},e(X,P),X.prototype.__iterateUncached=function(A,e){if(e)return this.cacheResult().__iterate(A,e);for(var t,n=this._iterator,i=this._iteratorCache,r=0;r<i.length;)if(!1===A(i[r],r++,this))return r;for(;!(t=n.next()).done;){var o=t.value;if(i[r]=o,!1===A(o,r++,this))break}return r},X.prototype.__iteratorUncached=function(A,e){if(e)return this.cacheResult().__iterator(A,e);var t=this._iterator,n=this._iteratorCache,i=0;return new G((function(){if(i>=n.length){var e=t.next();if(e.done)return e;n[i]=e.value}return S(A,i,n[i++])}))},e(aA,P),aA.prototype.toString=function(){return 0===this.size?"Repeat []":"Repeat [ "+this._value+" "+this.size+" times ]"},aA.prototype.get=function(A,e){return this.has(A)?this._value:e},aA.prototype.includes=function(A){return oA(this._value,A)},aA.prototype.slice=function(A,e){var t=this.size;return D(A,e,t)?this:new aA(this._value,f(e,t)-Y(A,t))},aA.prototype.reverse=function(){return this},aA.prototype.indexOf=function(A){return oA(this._value,A)?0:-1},aA.prototype.lastIndexOf=function(A){return oA(this._value,A)?this.size:-1},aA.prototype.__iterate=function(A,e){for(var t=0;t<this.size;t++)if(!1===A(this._value,t,this))return t+1;return t},aA.prototype.__iterator=function(A,e){var t=this,n=0;return new G((function(){return n<t.size?S(A,n++,t._value):{value:void 0,done:!0}}))},aA.prototype.equals=function(A){return A instanceof aA?oA(this._value,A._value):sA(A)},e(cA,P),cA.prototype.toString=function(){return 0===this.size?"Range []":"Range [ "+this._start+"..."+this._end+(1!==this._step?" by "+this._step:"")+" ]"},cA.prototype.get=function(A,e){return this.has(A)?this._start+p(this,A)*this._step:e},cA.prototype.includes=function(A){var e=(A-this._start)/this._step;return e>=0&&e<this.size&&e===Math.floor(e)},cA.prototype.slice=function(A,e){return D(A,e,this.size)?this:(A=Y(A,this.size),(e=f(e,this.size))<=A?new cA(0,0):new cA(this.get(A,this._end),this.get(e,this._end),this._step))},cA.prototype.indexOf=function(A){var e=A-this._start;if(e%this._step==0){var t=e/this._step;if(t>=0&&t<this.size)return t}return-1},cA.prototype.lastIndexOf=function(A){return this.indexOf(A)},cA.prototype.__iterate=function(A,e){for(var t=this.size-1,n=this._step,i=e?this._start+t*n:this._start,r=0;r<=t;r++){if(!1===A(i,r,this))return r+1;i+=e?-n:n}return r},cA.prototype.__iterator=function(A,e){var t=this.size-1,n=this._step,i=e?this._start+t*n:this._start,r=0;return new G((function(){var o=i;return i+=e?-n:n,r>t?{value:void 0,done:!0}:S(A,r++,o)}))},cA.prototype.equals=function(A){return A instanceof cA?this._start===A._start&&this._end===A._end&&this._step===A._step:sA(this,A)},e(gA,t),e(EA,gA),e(QA,gA),e(uA,gA),gA.Keyed=EA,gA.Indexed=QA,gA.Set=uA;var lA="function"==typeof Math.imul&&-2===Math.imul(4294967295,2)?Math.imul:function(A,e){var t=65535&(A|=0),n=65535&(e|=0);return t*n+((A>>>16)*n+t*(e>>>16)<<16>>>0)|0};function wA(A){return A>>>1&1073741824|3221225471&A}function hA(A){if(!1===A||null==A)return 0;if("function"==typeof A.valueOf&&(!1===(A=A.valueOf())||null==A))return 0;if(!0===A)return 1;var e=typeof A;if("number"===e){if(A!=A||A===1/0)return 0;var t=0|A;for(t!==A&&(t^=4294967295*A);A>4294967295;)t^=A/=4294967295;return wA(t)}if("string"===e)return A.length>DA?function(A){var e=NA[A];return void 0===e&&(e=CA(A),fA===YA&&(fA=0,NA={}),fA++,NA[A]=e),e}(A):CA(A);if("function"==typeof A.hashCode)return A.hashCode();if("object"===e)return function(A){var e;if(mA&&void 0!==(e=IA.get(A)))return e;if(void 0!==(e=A[FA]))return e;if(!dA){if(void 0!==(e=A.propertyIsEnumerable&&A.propertyIsEnumerable[FA]))return e;if(void 0!==(e=function(A){if(A&&A.nodeType>0)switch(A.nodeType){case 1:return A.uniqueID;case 9:return A.documentElement&&A.documentElement.uniqueID}}(A)))return e}if(e=++pA,1073741824&pA&&(pA=0),mA)IA.set(A,e);else{if(void 0!==MA&&!1===MA(A))throw new Error("Non-extensible objects are not allowed as keys.");if(dA)Object.defineProperty(A,FA,{enumerable:!1,configurable:!1,writable:!1,value:e});else if(void 0!==A.propertyIsEnumerable&&A.propertyIsEnumerable===A.constructor.prototype.propertyIsEnumerable)A.propertyIsEnumerable=function(){return this.constructor.prototype.propertyIsEnumerable.apply(this,arguments)},A.propertyIsEnumerable[FA]=e;else{if(void 0===A.nodeType)throw new Error("Unable to set a non-enumerable property on object.");A[FA]=e}}return e}(A);if("function"==typeof A.toString)return CA(A.toString());throw new Error("Value type "+e+" cannot be hashed.")}function CA(A){for(var e=0,t=0;t<A.length;t++)e=31*e+A.charCodeAt(t)|0;return wA(e)}var IA,MA=Object.isExtensible,dA=function(){try{return Object.defineProperty({},"@",{}),!0}catch(A){return!1}}(),mA="function"==typeof WeakMap;mA&&(IA=new WeakMap);var pA=0,FA="__immutablehash__";"function"==typeof Symbol&&(FA=Symbol(FA));var DA=16,YA=255,fA=0,NA={};function UA(A){BA(A!==1/0,"Cannot perform this action with an infinite size.")}function yA(A){return null==A?PA():TA(A)&&!c(A)?A:PA().withMutations((function(e){var t=n(A);UA(t.size),t.forEach((function(A,t){return e.set(t,A)}))}))}function TA(A){return!(!A||!A[RA])}e(yA,EA),yA.of=function(){var e=A.call(arguments,0);return PA().withMutations((function(A){for(var t=0;t<e.length;t+=2){if(t+1>=e.length)throw new Error("Missing value for key: "+e[t]);A.set(e[t],e[t+1])}}))},yA.prototype.toString=function(){return this.__toString("Map {","}")},yA.prototype.get=function(A,e){return this._root?this._root.get(0,void 0,A,e):e},yA.prototype.set=function(A,e){return OA(this,A,e)},yA.prototype.setIn=function(A,e){return this.updateIn(A,l,(function(){return e}))},yA.prototype.remove=function(A){return OA(this,A,l)},yA.prototype.deleteIn=function(A){return this.updateIn(A,(function(){return l}))},yA.prototype.update=function(A,e,t){return 1===arguments.length?A(this):this.updateIn([A],e,t)},yA.prototype.updateIn=function(A,e,t){t||(t=e,e=void 0);var n=function A(e,t,n,i){var r=e===l,o=t.next();if(o.done){var s=r?n:e,a=i(s);return a===s?e:a}BA(r||e&&e.set,"invalid keyPath");var B=o.value,c=r?l:e.get(B,l),g=A(c,t,n,i);return g===c?e:g===l?e.remove(B):(r?PA():e).set(B,g)}(this,Xe(A),e,t);return n===l?void 0:n},yA.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._root=null,this.__hash=void 0,this.__altered=!0,this):PA()},yA.prototype.merge=function(){return XA(this,void 0,arguments)},yA.prototype.mergeWith=function(e){var t=A.call(arguments,1);return XA(this,e,t)},yA.prototype.mergeIn=function(e){var t=A.call(arguments,1);return this.updateIn(e,PA(),(function(A){return"function"==typeof A.merge?A.merge.apply(A,t):t[t.length-1]}))},yA.prototype.mergeDeep=function(){return XA(this,ZA,arguments)},yA.prototype.mergeDeepWith=function(e){var t=A.call(arguments,1);return XA(this,_A(e),t)},yA.prototype.mergeDeepIn=function(e){var t=A.call(arguments,1);return this.updateIn(e,PA(),(function(A){return"function"==typeof A.mergeDeep?A.mergeDeep.apply(A,t):t[t.length-1]}))},yA.prototype.sort=function(A){return de(ve(this,A))},yA.prototype.sortBy=function(A,e){return de(ve(this,e,A))},yA.prototype.withMutations=function(A){var e=this.asMutable();return A(e),e.wasAltered()?e.__ensureOwner(this.__ownerID):this},yA.prototype.asMutable=function(){return this.__ownerID?this:this.__ensureOwner(new M)},yA.prototype.asImmutable=function(){return this.__ensureOwner()},yA.prototype.wasAltered=function(){return this.__altered},yA.prototype.__iterator=function(A,e){return new jA(this,A,e)},yA.prototype.__iterate=function(A,e){var t=this,n=0;return this._root&&this._root.iterate((function(e){return n++,A(e[1],e[0],t)}),e),n},yA.prototype.__ensureOwner=function(A){return A===this.__ownerID?this:A?LA(this.size,this._root,A,this.__hash):(this.__ownerID=A,this.__altered=!1,this)},yA.isMap=TA;var xA,RA="@@__IMMUTABLE_MAP__@@",GA=yA.prototype;function SA(A,e){this.ownerID=A,this.entries=e}function HA(A,e,t){this.ownerID=A,this.bitmap=e,this.nodes=t}function bA(A,e,t){this.ownerID=A,this.count=e,this.nodes=t}function vA(A,e,t){this.ownerID=A,this.keyHash=e,this.entries=t}function kA(A,e,t){this.ownerID=A,this.keyHash=e,this.entry=t}function jA(A,e,t){this._type=e,this._reverse=t,this._stack=A._root&&zA(A._root)}function JA(A,e){return S(A,e[0],e[1])}function zA(A,e){return{node:A,index:0,__prev:e}}function LA(A,e,t,n){var i=Object.create(GA);return i.size=A,i._root=e,i.__ownerID=t,i.__hash=n,i.__altered=!1,i}function PA(){return xA||(xA=LA(0))}function OA(A,e,t){var n,i;if(A._root){var r=C(w),o=C(h);if(n=VA(A._root,A.__ownerID,0,void 0,e,t,r,o),!o.value)return A;i=A.size+(r.value?t===l?-1:1:0)}else{if(t===l)return A;i=1,n=new SA(A.__ownerID,[[e,t]])}return A.__ownerID?(A.size=i,A._root=n,A.__hash=void 0,A.__altered=!0,A):n?LA(i,n):PA()}function VA(A,e,t,n,i,r,o,s){return A?A.update(e,t,n,i,r,o,s):r===l?A:(I(s),I(o),new kA(e,n,[i,r]))}function WA(A){return A.constructor===kA||A.constructor===vA}function KA(A,e,t,n,i){if(A.keyHash===n)return new vA(e,n,[A.entry,i]);var r,o=31&(0===t?A.keyHash:A.keyHash>>>t),s=31&(0===t?n:n>>>t);return new HA(e,1<<o|1<<s,o===s?[KA(A,e,t+5,n,i)]:(r=new kA(e,n,i),o<s?[A,r]:[r,A]))}function XA(A,e,t){for(var i=[],r=0;r<t.length;r++){var s=t[r],a=n(s);o(s)||(a=a.map((function(A){return nA(A)}))),i.push(a)}return qA(A,e,i)}function ZA(A,e,t){return A&&A.mergeDeep&&o(e)?A.mergeDeep(e):oA(A,e)?A:e}function _A(A){return function(e,t,n){if(e&&e.mergeDeepWith&&o(t))return e.mergeDeepWith(A,t);var i=A(e,t,n);return oA(e,i)?e:i}}function qA(A,e,t){return 0===(t=t.filter((function(A){return 0!==A.size}))).length?A:0!==A.size||A.__ownerID||1!==t.length?A.withMutations((function(A){for(var n=e?function(t,n){A.update(n,l,(function(A){return A===l?t:e(A,t,n)}))}:function(e,t){A.set(t,e)},i=0;i<t.length;i++)t[i].forEach(n)})):A.constructor(t[0])}function $A(A){return A=(A=(858993459&(A-=A>>1&1431655765))+(A>>2&858993459))+(A>>4)&252645135,A+=A>>8,127&(A+=A>>16)}function Ae(A,e,t,n){var i=n?A:d(A);return i[e]=t,i}GA[RA]=!0,GA.delete=GA.remove,GA.removeIn=GA.deleteIn,SA.prototype.get=function(A,e,t,n){for(var i=this.entries,r=0,o=i.length;r<o;r++)if(oA(t,i[r][0]))return i[r][1];return n},SA.prototype.update=function(A,e,t,n,i,r,o){for(var s=i===l,a=this.entries,B=0,c=a.length;B<c&&!oA(n,a[B][0]);B++);var g=B<c;if(g?a[B][1]===i:s)return this;if(I(o),(s||!g)&&I(r),!s||1!==a.length){if(!g&&!s&&a.length>=ee)return function(A,e,t,n){A||(A=new M);for(var i=new kA(A,hA(t),[t,n]),r=0;r<e.length;r++){var o=e[r];i=i.update(A,0,void 0,o[0],o[1])}return i}(A,a,n,i);var E=A&&A===this.ownerID,Q=E?a:d(a);return g?s?B===c-1?Q.pop():Q[B]=Q.pop():Q[B]=[n,i]:Q.push([n,i]),E?(this.entries=Q,this):new SA(A,Q)}},HA.prototype.get=function(A,e,t,n){void 0===e&&(e=hA(t));var i=1<<(31&(0===A?e:e>>>A)),r=this.bitmap;return 0==(r&i)?n:this.nodes[$A(r&i-1)].get(A+5,e,t,n)},HA.prototype.update=function(A,e,t,n,i,r,o){void 0===t&&(t=hA(n));var s=31&(0===e?t:t>>>e),a=1<<s,B=this.bitmap,c=0!=(B&a);if(!c&&i===l)return this;var g=$A(B&a-1),E=this.nodes,Q=c?E[g]:void 0,u=VA(Q,A,e+5,t,n,i,r,o);if(u===Q)return this;if(!c&&u&&E.length>=te)return function(A,e,t,n,i){for(var r=0,o=new Array(32),s=0;0!==t;s++,t>>>=1)o[s]=1&t?e[r++]:void 0;return o[n]=i,new bA(A,r+1,o)}(A,E,B,s,u);if(c&&!u&&2===E.length&&WA(E[1^g]))return E[1^g];if(c&&u&&1===E.length&&WA(u))return u;var w=A&&A===this.ownerID,h=c?u?B:B^a:B|a,C=c?u?Ae(E,g,u,w):function(A,e,t){var n=A.length-1;if(t&&e===n)return A.pop(),A;for(var i=new Array(n),r=0,o=0;o<n;o++)o===e&&(r=1),i[o]=A[o+r];return i}(E,g,w):function(A,e,t,n){var i=A.length+1;if(n&&e+1===i)return A[e]=t,A;for(var r=new Array(i),o=0,s=0;s<i;s++)s===e?(r[s]=t,o=-1):r[s]=A[s+o];return r}(E,g,u,w);return w?(this.bitmap=h,this.nodes=C,this):new HA(A,h,C)},bA.prototype.get=function(A,e,t,n){void 0===e&&(e=hA(t));var i=31&(0===A?e:e>>>A),r=this.nodes[i];return r?r.get(A+5,e,t,n):n},bA.prototype.update=function(A,e,t,n,i,r,o){void 0===t&&(t=hA(n));var s=31&(0===e?t:t>>>e),a=i===l,B=this.nodes,c=B[s];if(a&&!c)return this;var g=VA(c,A,e+5,t,n,i,r,o);if(g===c)return this;var E=this.count;if(c){if(!g&&--E<ne)return function(A,e,t,n){for(var i=0,r=0,o=new Array(t),s=0,a=1,B=e.length;s<B;s++,a<<=1){var c=e[s];void 0!==c&&s!==n&&(i|=a,o[r++]=c)}return new HA(A,i,o)}(A,B,E,s)}else E++;var Q=A&&A===this.ownerID,u=Ae(B,s,g,Q);return Q?(this.count=E,this.nodes=u,this):new bA(A,E,u)},vA.prototype.get=function(A,e,t,n){for(var i=this.entries,r=0,o=i.length;r<o;r++)if(oA(t,i[r][0]))return i[r][1];return n},vA.prototype.update=function(A,e,t,n,i,r,o){void 0===t&&(t=hA(n));var s=i===l;if(t!==this.keyHash)return s?this:(I(o),I(r),KA(this,A,e,t,[n,i]));for(var a=this.entries,B=0,c=a.length;B<c&&!oA(n,a[B][0]);B++);var g=B<c;if(g?a[B][1]===i:s)return this;if(I(o),(s||!g)&&I(r),s&&2===c)return new kA(A,this.keyHash,a[1^B]);var E=A&&A===this.ownerID,Q=E?a:d(a);return g?s?B===c-1?Q.pop():Q[B]=Q.pop():Q[B]=[n,i]:Q.push([n,i]),E?(this.entries=Q,this):new vA(A,this.keyHash,Q)},kA.prototype.get=function(A,e,t,n){return oA(t,this.entry[0])?this.entry[1]:n},kA.prototype.update=function(A,e,t,n,i,r,o){var s=i===l,a=oA(n,this.entry[0]);return(a?i===this.entry[1]:s)?this:(I(o),s?void I(r):a?A&&A===this.ownerID?(this.entry[1]=i,this):new kA(A,this.keyHash,[n,i]):(I(r),KA(this,A,e,hA(n),[n,i])))},SA.prototype.iterate=vA.prototype.iterate=function(A,e){for(var t=this.entries,n=0,i=t.length-1;n<=i;n++)if(!1===A(t[e?i-n:n]))return!1},HA.prototype.iterate=bA.prototype.iterate=function(A,e){for(var t=this.nodes,n=0,i=t.length-1;n<=i;n++){var r=t[e?i-n:n];if(r&&!1===r.iterate(A,e))return!1}},kA.prototype.iterate=function(A,e){return A(this.entry)},e(jA,G),jA.prototype.next=function(){for(var A=this._type,e=this._stack;e;){var t,n=e.node,i=e.index++;if(n.entry){if(0===i)return JA(A,n.entry)}else if(n.entries){if(i<=(t=n.entries.length-1))return JA(A,n.entries[this._reverse?t-i:i])}else if(i<=(t=n.nodes.length-1)){var r=n.nodes[this._reverse?t-i:i];if(r){if(r.entry)return JA(A,r.entry);e=this._stack=zA(r,e)}continue}e=this._stack=this._stack.__prev}return{value:void 0,done:!0}};var ee=8,te=16,ne=8;function ie(A){var e=ue();if(null==A)return e;if(re(A))return A;var t=i(A),n=t.size;return 0===n?e:(UA(n),n>0&&n<32?Qe(0,n,5,null,new ae(t.toArray())):e.withMutations((function(A){A.setSize(n),t.forEach((function(e,t){return A.set(t,e)}))})))}function re(A){return!(!A||!A[oe])}e(ie,QA),ie.of=function(){return this(arguments)},ie.prototype.toString=function(){return this.__toString("List [","]")},ie.prototype.get=function(A,e){if((A=p(this,A))>=0&&A<this.size){var t=he(this,A+=this._origin);return t&&t.array[31&A]}return e},ie.prototype.set=function(A,e){return function(A,e,t){if((e=p(A,e))!=e)return A;if(e>=A.size||e<0)return A.withMutations((function(A){e<0?Ce(A,e).set(0,t):Ce(A,0,e+1).set(e,t)}));e+=A._origin;var n=A._tail,i=A._root,r=C(h);return e>=Me(A._capacity)?n=le(n,A.__ownerID,0,e,t,r):i=le(i,A.__ownerID,A._level,e,t,r),r.value?A.__ownerID?(A._root=i,A._tail=n,A.__hash=void 0,A.__altered=!0,A):Qe(A._origin,A._capacity,A._level,i,n):A}(this,A,e)},ie.prototype.remove=function(A){return this.has(A)?0===A?this.shift():A===this.size-1?this.pop():this.splice(A,1):this},ie.prototype.insert=function(A,e){return this.splice(A,0,e)},ie.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=this._origin=this._capacity=0,this._level=5,this._root=this._tail=null,this.__hash=void 0,this.__altered=!0,this):ue()},ie.prototype.push=function(){var A=arguments,e=this.size;return this.withMutations((function(t){Ce(t,0,e+A.length);for(var n=0;n<A.length;n++)t.set(e+n,A[n])}))},ie.prototype.pop=function(){return Ce(this,0,-1)},ie.prototype.unshift=function(){var A=arguments;return this.withMutations((function(e){Ce(e,-A.length);for(var t=0;t<A.length;t++)e.set(t,A[t])}))},ie.prototype.shift=function(){return Ce(this,1)},ie.prototype.merge=function(){return Ie(this,void 0,arguments)},ie.prototype.mergeWith=function(e){var t=A.call(arguments,1);return Ie(this,e,t)},ie.prototype.mergeDeep=function(){return Ie(this,ZA,arguments)},ie.prototype.mergeDeepWith=function(e){var t=A.call(arguments,1);return Ie(this,_A(e),t)},ie.prototype.setSize=function(A){return Ce(this,0,A)},ie.prototype.slice=function(A,e){var t=this.size;return D(A,e,t)?this:Ce(this,Y(A,t),f(e,t))},ie.prototype.__iterator=function(A,e){var t=0,n=Ee(this,e);return new G((function(){var e=n();return e===ge?{value:void 0,done:!0}:S(A,t++,e)}))},ie.prototype.__iterate=function(A,e){for(var t,n=0,i=Ee(this,e);(t=i())!==ge&&!1!==A(t,n++,this););return n},ie.prototype.__ensureOwner=function(A){return A===this.__ownerID?this:A?Qe(this._origin,this._capacity,this._level,this._root,this._tail,A,this.__hash):(this.__ownerID=A,this)},ie.isList=re;var oe="@@__IMMUTABLE_LIST__@@",se=ie.prototype;function ae(A,e){this.array=A,this.ownerID=e}se[oe]=!0,se.delete=se.remove,se.setIn=GA.setIn,se.deleteIn=se.removeIn=GA.removeIn,se.update=GA.update,se.updateIn=GA.updateIn,se.mergeIn=GA.mergeIn,se.mergeDeepIn=GA.mergeDeepIn,se.withMutations=GA.withMutations,se.asMutable=GA.asMutable,se.asImmutable=GA.asImmutable,se.wasAltered=GA.wasAltered,ae.prototype.removeBefore=function(A,e,t){if(t===e?1<<e:0===this.array.length)return this;var n=t>>>e&31;if(n>=this.array.length)return new ae([],A);var i,r=0===n;if(e>0){var o=this.array[n];if((i=o&&o.removeBefore(A,e-5,t))===o&&r)return this}if(r&&!i)return this;var s=we(this,A);if(!r)for(var a=0;a<n;a++)s.array[a]=void 0;return i&&(s.array[n]=i),s},ae.prototype.removeAfter=function(A,e,t){if(t===(e?1<<e:0)||0===this.array.length)return this;var n,i=t-1>>>e&31;if(i>=this.array.length)return this;if(e>0){var r=this.array[i];if((n=r&&r.removeAfter(A,e-5,t))===r&&i===this.array.length-1)return this}var o=we(this,A);return o.array.splice(i+1),n&&(o.array[i]=n),o};var Be,ce,ge={};function Ee(A,e){var t=A._origin,n=A._capacity,i=Me(n),r=A._tail;return o(A._root,A._level,0);function o(A,s,a){return 0===s?function(A,o){var s=o===i?r&&r.array:A&&A.array,a=o>t?0:t-o,B=n-o;return B>32&&(B=32),function(){if(a===B)return ge;var A=e?--B:a++;return s&&s[A]}}(A,a):function(A,i,r){var s,a=A&&A.array,B=r>t?0:t-r>>i,c=1+(n-r>>i);return c>32&&(c=32),function(){for(;;){if(s){var A=s();if(A!==ge)return A;s=null}if(B===c)return ge;var t=e?--c:B++;s=o(a&&a[t],i-5,r+(t<<i))}}}(A,s,a)}}function Qe(A,e,t,n,i,r,o){var s=Object.create(se);return s.size=e-A,s._origin=A,s._capacity=e,s._level=t,s._root=n,s._tail=i,s.__ownerID=r,s.__hash=o,s.__altered=!1,s}function ue(){return Be||(Be=Qe(0,0,5))}function le(A,e,t,n,i,r){var o,s=n>>>t&31,a=A&&s<A.array.length;if(!a&&void 0===i)return A;if(t>0){var B=A&&A.array[s],c=le(B,e,t-5,n,i,r);return c===B?A:((o=we(A,e)).array[s]=c,o)}return a&&A.array[s]===i?A:(I(r),o=we(A,e),void 0===i&&s===o.array.length-1?o.array.pop():o.array[s]=i,o)}function we(A,e){return e&&A&&e===A.ownerID?A:new ae(A?A.array.slice():[],e)}function he(A,e){if(e>=Me(A._capacity))return A._tail;if(e<1<<A._level+5){for(var t=A._root,n=A._level;t&&n>0;)t=t.array[e>>>n&31],n-=5;return t}}function Ce(A,e,t){void 0!==e&&(e|=0),void 0!==t&&(t|=0);var n=A.__ownerID||new M,i=A._origin,r=A._capacity,o=i+e,s=void 0===t?r:t<0?r+t:i+t;if(o===i&&s===r)return A;if(o>=s)return A.clear();for(var a=A._level,B=A._root,c=0;o+c<0;)B=new ae(B&&B.array.length?[void 0,B]:[],n),c+=1<<(a+=5);c&&(o+=c,i+=c,s+=c,r+=c);for(var g=Me(r),E=Me(s);E>=1<<a+5;)B=new ae(B&&B.array.length?[B]:[],n),a+=5;var Q=A._tail,u=E<g?he(A,s-1):E>g?new ae([],n):Q;if(Q&&E>g&&o<r&&Q.array.length){for(var l=B=we(B,n),w=a;w>5;w-=5){var h=g>>>w&31;l=l.array[h]=we(l.array[h],n)}l.array[g>>>5&31]=Q}if(s<r&&(u=u&&u.removeAfter(n,0,s)),o>=E)o-=E,s-=E,a=5,B=null,u=u&&u.removeBefore(n,0,o);else if(o>i||E<g){for(c=0;B;){var C=o>>>a&31;if(C!==E>>>a&31)break;C&&(c+=(1<<a)*C),a-=5,B=B.array[C]}B&&o>i&&(B=B.removeBefore(n,a,o-c)),B&&E<g&&(B=B.removeAfter(n,a,E-c)),c&&(o-=c,s-=c)}return A.__ownerID?(A.size=s-o,A._origin=o,A._capacity=s,A._level=a,A._root=B,A._tail=u,A.__hash=void 0,A.__altered=!0,A):Qe(o,s,a,B,u)}function Ie(A,e,t){for(var n=[],r=0,s=0;s<t.length;s++){var a=t[s],B=i(a);B.size>r&&(r=B.size),o(a)||(B=B.map((function(A){return nA(A)}))),n.push(B)}return r>A.size&&(A=A.setSize(r)),qA(A,e,n)}function Me(A){return A<32?0:A-1>>>5<<5}function de(A){return null==A?Fe():me(A)?A:Fe().withMutations((function(e){var t=n(A);UA(t.size),t.forEach((function(A,t){return e.set(t,A)}))}))}function me(A){return TA(A)&&c(A)}function pe(A,e,t,n){var i=Object.create(de.prototype);return i.size=A?A.size:0,i._map=A,i._list=e,i.__ownerID=t,i.__hash=n,i}function Fe(){return ce||(ce=pe(PA(),ue()))}function De(A,e,t){var n,i,r=A._map,o=A._list,s=r.get(e),a=void 0!==s;if(t===l){if(!a)return A;o.size>=32&&o.size>=2*r.size?(n=(i=o.filter((function(A,e){return void 0!==A&&s!==e}))).toKeyedSeq().map((function(A){return A[0]})).flip().toMap(),A.__ownerID&&(n.__ownerID=i.__ownerID=A.__ownerID)):(n=r.remove(e),i=s===o.size-1?o.pop():o.set(s,void 0))}else if(a){if(t===o.get(s)[1])return A;n=r,i=o.set(s,[e,t])}else n=r.set(e,o.size),i=o.set(o.size,[e,t]);return A.__ownerID?(A.size=n.size,A._map=n,A._list=i,A.__hash=void 0,A):pe(n,i)}function Ye(A,e){this._iter=A,this._useKeys=e,this.size=A.size}function fe(A){this._iter=A,this.size=A.size}function Ne(A){this._iter=A,this.size=A.size}function Ue(A){this._iter=A,this.size=A.size}function ye(A){var e=Ve(A);return e._iter=A,e.size=A.size,e.flip=function(){return A},e.reverse=function(){var e=A.reverse.apply(this);return e.flip=function(){return A.reverse()},e},e.has=function(e){return A.includes(e)},e.includes=function(e){return A.has(e)},e.cacheResult=We,e.__iterateUncached=function(e,t){var n=this;return A.__iterate((function(A,t){return!1!==e(t,A,n)}),t)},e.__iteratorUncached=function(e,t){if(2===e){var n=A.__iterator(e,t);return new G((function(){var A=n.next();if(!A.done){var e=A.value[0];A.value[0]=A.value[1],A.value[1]=e}return A}))}return A.__iterator(1===e?0:1,t)},e}function Te(A,e,t){var n=Ve(A);return n.size=A.size,n.has=function(e){return A.has(e)},n.get=function(n,i){var r=A.get(n,l);return r===l?i:e.call(t,r,n,A)},n.__iterateUncached=function(n,i){var r=this;return A.__iterate((function(A,i,o){return!1!==n(e.call(t,A,i,o),i,r)}),i)},n.__iteratorUncached=function(n,i){var r=A.__iterator(2,i);return new G((function(){var i=r.next();if(i.done)return i;var o=i.value,s=o[0];return S(n,s,e.call(t,o[1],s,A),i)}))},n}function xe(A,e){var t=Ve(A);return t._iter=A,t.size=A.size,t.reverse=function(){return A},A.flip&&(t.flip=function(){var e=ye(A);return e.reverse=function(){return A.flip()},e}),t.get=function(t,n){return A.get(e?t:-1-t,n)},t.has=function(t){return A.has(e?t:-1-t)},t.includes=function(e){return A.includes(e)},t.cacheResult=We,t.__iterate=function(e,t){var n=this;return A.__iterate((function(A,t){return e(A,t,n)}),!t)},t.__iterator=function(e,t){return A.__iterator(e,!t)},t}function Re(A,e,t,n){var i=Ve(A);return n&&(i.has=function(n){var i=A.get(n,l);return i!==l&&!!e.call(t,i,n,A)},i.get=function(n,i){var r=A.get(n,l);return r!==l&&e.call(t,r,n,A)?r:i}),i.__iterateUncached=function(i,r){var o=this,s=0;return A.__iterate((function(A,r,a){if(e.call(t,A,r,a))return s++,i(A,n?r:s-1,o)}),r),s},i.__iteratorUncached=function(i,r){var o=A.__iterator(2,r),s=0;return new G((function(){for(;;){var r=o.next();if(r.done)return r;var a=r.value,B=a[0],c=a[1];if(e.call(t,c,B,A))return S(i,n?B:s++,c,r)}}))},i}function Ge(A,e,t,n){var i=A.size;if(void 0!==e&&(e|=0),void 0!==t&&(t===1/0?t=i:t|=0),D(e,t,i))return A;var r=Y(e,i),o=f(t,i);if(r!=r||o!=o)return Ge(A.toSeq().cacheResult(),e,t,n);var s,a=o-r;a==a&&(s=a<0?0:a);var B=Ve(A);return B.size=0===s?s:A.size&&s||void 0,!n&&Z(A)&&s>=0&&(B.get=function(e,t){return(e=p(this,e))>=0&&e<s?A.get(e+r,t):t}),B.__iterateUncached=function(e,t){var i=this;if(0===s)return 0;if(t)return this.cacheResult().__iterate(e,t);var o=0,a=!0,B=0;return A.__iterate((function(A,t){if(!a||!(a=o++<r))return B++,!1!==e(A,n?t:B-1,i)&&B!==s})),B},B.__iteratorUncached=function(e,t){if(0!==s&&t)return this.cacheResult().__iterator(e,t);var i=0!==s&&A.__iterator(e,t),o=0,a=0;return new G((function(){for(;o++<r;)i.next();if(++a>s)return{value:void 0,done:!0};var A=i.next();return n||1===e?A:S(e,a-1,0===e?void 0:A.value[1],A)}))},B}function Se(A,e,t,n){var i=Ve(A);return i.__iterateUncached=function(i,r){var o=this;if(r)return this.cacheResult().__iterate(i,r);var s=!0,a=0;return A.__iterate((function(A,r,B){if(!s||!(s=e.call(t,A,r,B)))return a++,i(A,n?r:a-1,o)})),a},i.__iteratorUncached=function(i,r){var o=this;if(r)return this.cacheResult().__iterator(i,r);var s=A.__iterator(2,r),a=!0,B=0;return new G((function(){var A,r,c;do{if((A=s.next()).done)return n||1===i?A:S(i,B++,0===i?void 0:A.value[1],A);var g=A.value;r=g[0],c=g[1],a&&(a=e.call(t,c,r,o))}while(a);return 2===i?A:S(i,r,c,A)}))},i}function He(A,e){var t=s(A),i=[A].concat(e).map((function(A){return o(A)?t&&(A=n(A)):A=t?q(A):$(Array.isArray(A)?A:[A]),A})).filter((function(A){return 0!==A.size}));if(0===i.length)return A;if(1===i.length){var r=i[0];if(r===A||t&&s(r)||a(A)&&a(r))return r}var B=new V(i);return t?B=B.toKeyedSeq():a(A)||(B=B.toSetSeq()),(B=B.flatten(!0)).size=i.reduce((function(A,e){if(void 0!==A){var t=e.size;if(void 0!==t)return A+t}}),0),B}function be(A,e,t){var n=Ve(A);return n.__iterateUncached=function(n,i){var r=0,s=!1;return function A(a,B){var c=this;a.__iterate((function(i,a){return(!e||B<e)&&o(i)?A(i,B+1):!1===n(i,t?a:r++,c)&&(s=!0),!s}),i)}(A,0),r},n.__iteratorUncached=function(n,i){var r=A.__iterator(n,i),s=[],a=0;return new G((function(){for(;r;){var A=r.next();if(!1===A.done){var B=A.value;if(2===n&&(B=B[1]),e&&!(s.length<e)||!o(B))return t?A:S(n,a++,B,A);s.push(r),r=B.__iterator(n,i)}else r=s.pop()}return{value:void 0,done:!0}}))},n}function ve(A,e,t){e||(e=Ke);var n=s(A),i=0,r=A.toSeq().map((function(e,n){return[n,e,i++,t?t(e,n,A):e]})).toArray();return r.sort((function(A,t){return e(A[3],t[3])||A[2]-t[2]})).forEach(n?function(A,e){r[e].length=2}:function(A,e){r[e]=A[1]}),n?L(r):a(A)?P(r):O(r)}function ke(A,e,t){if(e||(e=Ke),t){var n=A.toSeq().map((function(e,n){return[e,t(e,n,A)]})).reduce((function(A,t){return je(e,A[1],t[1])?t:A}));return n&&n[0]}return A.reduce((function(A,t){return je(e,A,t)?t:A}))}function je(A,e,t){var n=A(t,e);return 0===n&&t!==e&&(null==t||t!=t)||n>0}function Je(A,e,n){var i=Ve(A);return i.size=new V(n).map((function(A){return A.size})).min(),i.__iterate=function(A,e){for(var t,n=this.__iterator(1,e),i=0;!(t=n.next()).done&&!1!==A(t.value,i++,this););return i},i.__iteratorUncached=function(A,i){var r=n.map((function(A){return A=t(A),k(i?A.reverse():A)})),o=0,s=!1;return new G((function(){var t;return s||(t=r.map((function(A){return A.next()})),s=t.some((function(A){return A.done}))),s?{value:void 0,done:!0}:S(A,o++,e.apply(null,t.map((function(A){return A.value}))))}))},i}function ze(A,e){return Z(A)?e:A.constructor(e)}function Le(A){if(A!==Object(A))throw new TypeError("Expected [K, V] tuple: "+A)}function Pe(A){return UA(A.size),m(A)}function Oe(A){return s(A)?n:a(A)?i:r}function Ve(A){return Object.create((s(A)?L:a(A)?P:O).prototype)}function We(){return this._iter.cacheResult?(this._iter.cacheResult(),this.size=this._iter.size,this):z.prototype.cacheResult.call(this)}function Ke(A,e){return A>e?1:A<e?-1:0}function Xe(A){var e=k(A);if(!e){if(!J(A))throw new TypeError("Expected iterable or array-like: "+A);e=k(t(A))}return e}function Ze(A,e){var t,n=function(r){if(r instanceof n)return r;if(!(this instanceof n))return new n(r);if(!t){t=!0;var o=Object.keys(A);!function(A,e){try{e.forEach(At.bind(void 0,A))}catch(A){}}(i,o),i.size=o.length,i._name=e,i._keys=o,i._defaultValues=A}this._map=yA(r)},i=n.prototype=Object.create(_e);return i.constructor=n,n}e(de,yA),de.of=function(){return this(arguments)},de.prototype.toString=function(){return this.__toString("OrderedMap {","}")},de.prototype.get=function(A,e){var t=this._map.get(A);return void 0!==t?this._list.get(t)[1]:e},de.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._map.clear(),this._list.clear(),this):Fe()},de.prototype.set=function(A,e){return De(this,A,e)},de.prototype.remove=function(A){return De(this,A,l)},de.prototype.wasAltered=function(){return this._map.wasAltered()||this._list.wasAltered()},de.prototype.__iterate=function(A,e){var t=this;return this._list.__iterate((function(e){return e&&A(e[1],e[0],t)}),e)},de.prototype.__iterator=function(A,e){return this._list.fromEntrySeq().__iterator(A,e)},de.prototype.__ensureOwner=function(A){if(A===this.__ownerID)return this;var e=this._map.__ensureOwner(A),t=this._list.__ensureOwner(A);return A?pe(e,t,A,this.__hash):(this.__ownerID=A,this._map=e,this._list=t,this)},de.isOrderedMap=me,de.prototype[u]=!0,de.prototype.delete=de.prototype.remove,e(Ye,L),Ye.prototype.get=function(A,e){return this._iter.get(A,e)},Ye.prototype.has=function(A){return this._iter.has(A)},Ye.prototype.valueSeq=function(){return this._iter.valueSeq()},Ye.prototype.reverse=function(){var A=this,e=xe(this,!0);return this._useKeys||(e.valueSeq=function(){return A._iter.toSeq().reverse()}),e},Ye.prototype.map=function(A,e){var t=this,n=Te(this,A,e);return this._useKeys||(n.valueSeq=function(){return t._iter.toSeq().map(A,e)}),n},Ye.prototype.__iterate=function(A,e){var t,n=this;return this._iter.__iterate(this._useKeys?function(e,t){return A(e,t,n)}:(t=e?Pe(this):0,function(i){return A(i,e?--t:t++,n)}),e)},Ye.prototype.__iterator=function(A,e){if(this._useKeys)return this._iter.__iterator(A,e);var t=this._iter.__iterator(1,e),n=e?Pe(this):0;return new G((function(){var i=t.next();return i.done?i:S(A,e?--n:n++,i.value,i)}))},Ye.prototype[u]=!0,e(fe,P),fe.prototype.includes=function(A){return this._iter.includes(A)},fe.prototype.__iterate=function(A,e){var t=this,n=0;return this._iter.__iterate((function(e){return A(e,n++,t)}),e)},fe.prototype.__iterator=function(A,e){var t=this._iter.__iterator(1,e),n=0;return new G((function(){var e=t.next();return e.done?e:S(A,n++,e.value,e)}))},e(Ne,O),Ne.prototype.has=function(A){return this._iter.includes(A)},Ne.prototype.__iterate=function(A,e){var t=this;return this._iter.__iterate((function(e){return A(e,e,t)}),e)},Ne.prototype.__iterator=function(A,e){var t=this._iter.__iterator(1,e);return new G((function(){var e=t.next();return e.done?e:S(A,e.value,e.value,e)}))},e(Ue,L),Ue.prototype.entrySeq=function(){return this._iter.toSeq()},Ue.prototype.__iterate=function(A,e){var t=this;return this._iter.__iterate((function(e){if(e){Le(e);var n=o(e);return A(n?e.get(1):e[1],n?e.get(0):e[0],t)}}),e)},Ue.prototype.__iterator=function(A,e){var t=this._iter.__iterator(1,e);return new G((function(){for(;;){var e=t.next();if(e.done)return e;var n=e.value;if(n){Le(n);var i=o(n);return S(A,i?n.get(0):n[0],i?n.get(1):n[1],e)}}}))},fe.prototype.cacheResult=Ye.prototype.cacheResult=Ne.prototype.cacheResult=Ue.prototype.cacheResult=We,e(Ze,EA),Ze.prototype.toString=function(){return this.__toString($e(this)+" {","}")},Ze.prototype.has=function(A){return this._defaultValues.hasOwnProperty(A)},Ze.prototype.get=function(A,e){if(!this.has(A))return e;var t=this._defaultValues[A];return this._map?this._map.get(A,t):t},Ze.prototype.clear=function(){if(this.__ownerID)return this._map&&this._map.clear(),this;var A=this.constructor;return A._empty||(A._empty=qe(this,PA()))},Ze.prototype.set=function(A,e){if(!this.has(A))throw new Error('Cannot set unknown key "'+A+'" on '+$e(this));if(this._map&&!this._map.has(A)&&e===this._defaultValues[A])return this;var t=this._map&&this._map.set(A,e);return this.__ownerID||t===this._map?this:qe(this,t)},Ze.prototype.remove=function(A){if(!this.has(A))return this;var e=this._map&&this._map.remove(A);return this.__ownerID||e===this._map?this:qe(this,e)},Ze.prototype.wasAltered=function(){return this._map.wasAltered()},Ze.prototype.__iterator=function(A,e){var t=this;return n(this._defaultValues).map((function(A,e){return t.get(e)})).__iterator(A,e)},Ze.prototype.__iterate=function(A,e){var t=this;return n(this._defaultValues).map((function(A,e){return t.get(e)})).__iterate(A,e)},Ze.prototype.__ensureOwner=function(A){if(A===this.__ownerID)return this;var e=this._map&&this._map.__ensureOwner(A);return A?qe(this,e,A):(this.__ownerID=A,this._map=e,this)};var _e=Ze.prototype;function qe(A,e,t){var n=Object.create(Object.getPrototypeOf(A));return n._map=e,n.__ownerID=t,n}function $e(A){return A._name||A.constructor.name||"Record"}function At(A,e){Object.defineProperty(A,e,{get:function(){return this.get(e)},set:function(A){BA(this.__ownerID,"Cannot set on an immutable record."),this.set(e,A)}})}function et(A){return null==A?at():tt(A)&&!c(A)?A:at().withMutations((function(e){var t=r(A);UA(t.size),t.forEach((function(A){return e.add(A)}))}))}function tt(A){return!(!A||!A[it])}_e.delete=_e.remove,_e.deleteIn=_e.removeIn=GA.removeIn,_e.merge=GA.merge,_e.mergeWith=GA.mergeWith,_e.mergeIn=GA.mergeIn,_e.mergeDeep=GA.mergeDeep,_e.mergeDeepWith=GA.mergeDeepWith,_e.mergeDeepIn=GA.mergeDeepIn,_e.setIn=GA.setIn,_e.update=GA.update,_e.updateIn=GA.updateIn,_e.withMutations=GA.withMutations,_e.asMutable=GA.asMutable,_e.asImmutable=GA.asImmutable,e(et,uA),et.of=function(){return this(arguments)},et.fromKeys=function(A){return this(n(A).keySeq())},et.prototype.toString=function(){return this.__toString("Set {","}")},et.prototype.has=function(A){return this._map.has(A)},et.prototype.add=function(A){return ot(this,this._map.set(A,!0))},et.prototype.remove=function(A){return ot(this,this._map.remove(A))},et.prototype.clear=function(){return ot(this,this._map.clear())},et.prototype.union=function(){var e=A.call(arguments,0);return 0===(e=e.filter((function(A){return 0!==A.size}))).length?this:0!==this.size||this.__ownerID||1!==e.length?this.withMutations((function(A){for(var t=0;t<e.length;t++)r(e[t]).forEach((function(e){return A.add(e)}))})):this.constructor(e[0])},et.prototype.intersect=function(){var e=A.call(arguments,0);if(0===e.length)return this;e=e.map((function(A){return r(A)}));var t=this;return this.withMutations((function(A){t.forEach((function(t){e.every((function(A){return A.includes(t)}))||A.remove(t)}))}))},et.prototype.subtract=function(){var e=A.call(arguments,0);if(0===e.length)return this;e=e.map((function(A){return r(A)}));var t=this;return this.withMutations((function(A){t.forEach((function(t){e.some((function(A){return A.includes(t)}))&&A.remove(t)}))}))},et.prototype.merge=function(){return this.union.apply(this,arguments)},et.prototype.mergeWith=function(e){var t=A.call(arguments,1);return this.union.apply(this,t)},et.prototype.sort=function(A){return Bt(ve(this,A))},et.prototype.sortBy=function(A,e){return Bt(ve(this,e,A))},et.prototype.wasAltered=function(){return this._map.wasAltered()},et.prototype.__iterate=function(A,e){var t=this;return this._map.__iterate((function(e,n){return A(n,n,t)}),e)},et.prototype.__iterator=function(A,e){return this._map.map((function(A,e){return e})).__iterator(A,e)},et.prototype.__ensureOwner=function(A){if(A===this.__ownerID)return this;var e=this._map.__ensureOwner(A);return A?this.__make(e,A):(this.__ownerID=A,this._map=e,this)},et.isSet=tt;var nt,it="@@__IMMUTABLE_SET__@@",rt=et.prototype;function ot(A,e){return A.__ownerID?(A.size=e.size,A._map=e,A):e===A._map?A:0===e.size?A.__empty():A.__make(e)}function st(A,e){var t=Object.create(rt);return t.size=A?A.size:0,t._map=A,t.__ownerID=e,t}function at(){return nt||(nt=st(PA()))}function Bt(A){return null==A?ut():ct(A)?A:ut().withMutations((function(e){var t=r(A);UA(t.size),t.forEach((function(A){return e.add(A)}))}))}function ct(A){return tt(A)&&c(A)}rt[it]=!0,rt.delete=rt.remove,rt.mergeDeep=rt.merge,rt.mergeDeepWith=rt.mergeWith,rt.withMutations=GA.withMutations,rt.asMutable=GA.asMutable,rt.asImmutable=GA.asImmutable,rt.__empty=at,rt.__make=st,e(Bt,et),Bt.of=function(){return this(arguments)},Bt.fromKeys=function(A){return this(n(A).keySeq())},Bt.prototype.toString=function(){return this.__toString("OrderedSet {","}")},Bt.isOrderedSet=ct;var gt,Et=Bt.prototype;function Qt(A,e){var t=Object.create(Et);return t.size=A?A.size:0,t._map=A,t.__ownerID=e,t}function ut(){return gt||(gt=Qt(Fe()))}function lt(A){return null==A?dt():wt(A)?A:dt().unshiftAll(A)}function wt(A){return!(!A||!A[Ct])}Et[u]=!0,Et.__empty=ut,Et.__make=Qt,e(lt,QA),lt.of=function(){return this(arguments)},lt.prototype.toString=function(){return this.__toString("Stack [","]")},lt.prototype.get=function(A,e){var t=this._head;for(A=p(this,A);t&&A--;)t=t.next;return t?t.value:e},lt.prototype.peek=function(){return this._head&&this._head.value},lt.prototype.push=function(){if(0===arguments.length)return this;for(var A=this.size+arguments.length,e=this._head,t=arguments.length-1;t>=0;t--)e={value:arguments[t],next:e};return this.__ownerID?(this.size=A,this._head=e,this.__hash=void 0,this.__altered=!0,this):Mt(A,e)},lt.prototype.pushAll=function(A){if(0===(A=i(A)).size)return this;UA(A.size);var e=this.size,t=this._head;return A.reverse().forEach((function(A){e++,t={value:A,next:t}})),this.__ownerID?(this.size=e,this._head=t,this.__hash=void 0,this.__altered=!0,this):Mt(e,t)},lt.prototype.pop=function(){return this.slice(1)},lt.prototype.unshift=function(){return this.push.apply(this,arguments)},lt.prototype.unshiftAll=function(A){return this.pushAll(A)},lt.prototype.shift=function(){return this.pop.apply(this,arguments)},lt.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._head=void 0,this.__hash=void 0,this.__altered=!0,this):dt()},lt.prototype.slice=function(A,e){if(D(A,e,this.size))return this;var t=Y(A,this.size);if(f(e,this.size)!==this.size)return QA.prototype.slice.call(this,A,e);for(var n=this.size-t,i=this._head;t--;)i=i.next;return this.__ownerID?(this.size=n,this._head=i,this.__hash=void 0,this.__altered=!0,this):Mt(n,i)},lt.prototype.__ensureOwner=function(A){return A===this.__ownerID?this:A?Mt(this.size,this._head,A,this.__hash):(this.__ownerID=A,this.__altered=!1,this)},lt.prototype.__iterate=function(A,e){if(e)return this.reverse().__iterate(A);for(var t=0,n=this._head;n&&!1!==A(n.value,t++,this);)n=n.next;return t},lt.prototype.__iterator=function(A,e){if(e)return this.reverse().__iterator(A);var t=0,n=this._head;return new G((function(){if(n){var e=n.value;return n=n.next,S(A,t++,e)}return{value:void 0,done:!0}}))},lt.isStack=wt;var ht,Ct="@@__IMMUTABLE_STACK__@@",It=lt.prototype;function Mt(A,e,t,n){var i=Object.create(It);return i.size=A,i._head=e,i.__ownerID=t,i.__hash=n,i.__altered=!1,i}function dt(){return ht||(ht=Mt(0))}function mt(A,e){var t=function(t){A.prototype[t]=e[t]};return Object.keys(e).forEach(t),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(e).forEach(t),A}It[Ct]=!0,It.withMutations=GA.withMutations,It.asMutable=GA.asMutable,It.asImmutable=GA.asImmutable,It.wasAltered=GA.wasAltered,t.Iterator=G,mt(t,{toArray:function(){UA(this.size);var A=new Array(this.size||0);return this.valueSeq().__iterate((function(e,t){A[t]=e})),A},toIndexedSeq:function(){return new fe(this)},toJS:function(){return this.toSeq().map((function(A){return A&&"function"==typeof A.toJS?A.toJS():A})).__toJS()},toJSON:function(){return this.toSeq().map((function(A){return A&&"function"==typeof A.toJSON?A.toJSON():A})).__toJS()},toKeyedSeq:function(){return new Ye(this,!0)},toMap:function(){return yA(this.toKeyedSeq())},toObject:function(){UA(this.size);var A={};return this.__iterate((function(e,t){A[t]=e})),A},toOrderedMap:function(){return de(this.toKeyedSeq())},toOrderedSet:function(){return Bt(s(this)?this.valueSeq():this)},toSet:function(){return et(s(this)?this.valueSeq():this)},toSetSeq:function(){return new Ne(this)},toSeq:function(){return a(this)?this.toIndexedSeq():s(this)?this.toKeyedSeq():this.toSetSeq()},toStack:function(){return lt(s(this)?this.valueSeq():this)},toList:function(){return ie(s(this)?this.valueSeq():this)},toString:function(){return"[Iterable]"},__toString:function(A,e){return 0===this.size?A+e:A+" "+this.toSeq().map(this.__toStringMapper).join(", ")+" "+e},concat:function(){var e=A.call(arguments,0);return ze(this,He(this,e))},includes:function(A){return this.some((function(e){return oA(e,A)}))},entries:function(){return this.__iterator(2)},every:function(A,e){UA(this.size);var t=!0;return this.__iterate((function(n,i,r){if(!A.call(e,n,i,r))return t=!1,!1})),t},filter:function(A,e){return ze(this,Re(this,A,e,!0))},find:function(A,e,t){var n=this.findEntry(A,e);return n?n[1]:t},forEach:function(A,e){return UA(this.size),this.__iterate(e?A.bind(e):A)},join:function(A){UA(this.size),A=void 0!==A?""+A:",";var e="",t=!0;return this.__iterate((function(n){t?t=!1:e+=A,e+=null!=n?n.toString():""})),e},keys:function(){return this.__iterator(0)},map:function(A,e){return ze(this,Te(this,A,e))},reduce:function(A,e,t){var n,i;return UA(this.size),arguments.length<2?i=!0:n=e,this.__iterate((function(e,r,o){i?(i=!1,n=e):n=A.call(t,n,e,r,o)})),n},reduceRight:function(A,e,t){var n=this.toKeyedSeq().reverse();return n.reduce.apply(n,arguments)},reverse:function(){return ze(this,xe(this,!0))},slice:function(A,e){return ze(this,Ge(this,A,e,!0))},some:function(A,e){return!this.every(ft(A),e)},sort:function(A){return ze(this,ve(this,A))},values:function(){return this.__iterator(1)},butLast:function(){return this.slice(0,-1)},isEmpty:function(){return void 0!==this.size?0===this.size:!this.some((function(){return!0}))},count:function(A,e){return m(A?this.toSeq().filter(A,e):this)},countBy:function(A,e){return function(A,e,t){var n=yA().asMutable();return A.__iterate((function(i,r){n.update(e.call(t,i,r,A),0,(function(A){return A+1}))})),n.asImmutable()}(this,A,e)},equals:function(A){return sA(this,A)},entrySeq:function(){var A=this;if(A._cache)return new V(A._cache);var e=A.toSeq().map(Yt).toIndexedSeq();return e.fromEntrySeq=function(){return A.toSeq()},e},filterNot:function(A,e){return this.filter(ft(A),e)},findEntry:function(A,e,t){var n=t;return this.__iterate((function(t,i,r){if(A.call(e,t,i,r))return n=[i,t],!1})),n},findKey:function(A,e){var t=this.findEntry(A,e);return t&&t[0]},findLast:function(A,e,t){return this.toKeyedSeq().reverse().find(A,e,t)},findLastEntry:function(A,e,t){return this.toKeyedSeq().reverse().findEntry(A,e,t)},findLastKey:function(A,e){return this.toKeyedSeq().reverse().findKey(A,e)},first:function(){return this.find(F)},flatMap:function(A,e){return ze(this,function(A,e,t){var n=Oe(A);return A.toSeq().map((function(i,r){return n(e.call(t,i,r,A))})).flatten(!0)}(this,A,e))},flatten:function(A){return ze(this,be(this,A,!0))},fromEntrySeq:function(){return new Ue(this)},get:function(A,e){return this.find((function(e,t){return oA(t,A)}),void 0,e)},getIn:function(A,e){for(var t,n=this,i=Xe(A);!(t=i.next()).done;){var r=t.value;if((n=n&&n.get?n.get(r,l):l)===l)return e}return n},groupBy:function(A,e){return function(A,e,t){var n=s(A),i=(c(A)?de():yA()).asMutable();A.__iterate((function(r,o){i.update(e.call(t,r,o,A),(function(A){return(A=A||[]).push(n?[o,r]:r),A}))}));var r=Oe(A);return i.map((function(e){return ze(A,r(e))}))}(this,A,e)},has:function(A){return this.get(A,l)!==l},hasIn:function(A){return this.getIn(A,l)!==l},isSubset:function(A){return A="function"==typeof A.includes?A:t(A),this.every((function(e){return A.includes(e)}))},isSuperset:function(A){return(A="function"==typeof A.isSubset?A:t(A)).isSubset(this)},keyOf:function(A){return this.findKey((function(e){return oA(e,A)}))},keySeq:function(){return this.toSeq().map(Dt).toIndexedSeq()},last:function(){return this.toSeq().reverse().first()},lastKeyOf:function(A){return this.toKeyedSeq().reverse().keyOf(A)},max:function(A){return ke(this,A)},maxBy:function(A,e){return ke(this,e,A)},min:function(A){return ke(this,A?Nt(A):Tt)},minBy:function(A,e){return ke(this,e?Nt(e):Tt,A)},rest:function(){return this.slice(1)},skip:function(A){return this.slice(Math.max(0,A))},skipLast:function(A){return ze(this,this.toSeq().reverse().skip(A).reverse())},skipWhile:function(A,e){return ze(this,Se(this,A,e,!0))},skipUntil:function(A,e){return this.skipWhile(ft(A),e)},sortBy:function(A,e){return ze(this,ve(this,e,A))},take:function(A){return this.slice(0,Math.max(0,A))},takeLast:function(A){return ze(this,this.toSeq().reverse().take(A).reverse())},takeWhile:function(A,e){return ze(this,function(A,e,t){var n=Ve(A);return n.__iterateUncached=function(n,i){var r=this;if(i)return this.cacheResult().__iterate(n,i);var o=0;return A.__iterate((function(A,i,s){return e.call(t,A,i,s)&&++o&&n(A,i,r)})),o},n.__iteratorUncached=function(n,i){var r=this;if(i)return this.cacheResult().__iterator(n,i);var o=A.__iterator(2,i),s=!0;return new G((function(){if(!s)return{value:void 0,done:!0};var A=o.next();if(A.done)return A;var i=A.value,a=i[0],B=i[1];return e.call(t,B,a,r)?2===n?A:S(n,a,B,A):(s=!1,{value:void 0,done:!0})}))},n}(this,A,e))},takeUntil:function(A,e){return this.takeWhile(ft(A),e)},valueSeq:function(){return this.toIndexedSeq()},hashCode:function(){return this.__hash||(this.__hash=function(A){if(A.size===1/0)return 0;var e=c(A),t=s(A),n=e?1:0;return function(A,e){return e=lA(e,3432918353),e=lA(e<<15|e>>>-15,461845907),e=lA(e<<13|e>>>-13,5),e=lA((e=(e+3864292196|0)^A)^e>>>16,2246822507),e=wA((e=lA(e^e>>>13,3266489909))^e>>>16)}(A.__iterate(t?e?function(A,e){n=31*n+xt(hA(A),hA(e))|0}:function(A,e){n=n+xt(hA(A),hA(e))|0}:e?function(A){n=31*n+hA(A)|0}:function(A){n=n+hA(A)|0}),n)}(this))}});var pt=t.prototype;pt[g]=!0,pt[R]=pt.values,pt.__toJS=pt.toArray,pt.__toStringMapper=Ut,pt.inspect=pt.toSource=function(){return this.toString()},pt.chain=pt.flatMap,pt.contains=pt.includes,mt(n,{flip:function(){return ze(this,ye(this))},mapEntries:function(A,e){var t=this,n=0;return ze(this,this.toSeq().map((function(i,r){return A.call(e,[r,i],n++,t)})).fromEntrySeq())},mapKeys:function(A,e){var t=this;return ze(this,this.toSeq().flip().map((function(n,i){return A.call(e,n,i,t)})).flip())}});var Ft=n.prototype;function Dt(A,e){return e}function Yt(A,e){return[e,A]}function ft(A){return function(){return!A.apply(this,arguments)}}function Nt(A){return function(){return-A.apply(this,arguments)}}function Ut(A){return"string"==typeof A?JSON.stringify(A):String(A)}function yt(){return d(arguments)}function Tt(A,e){return A<e?1:A>e?-1:0}function xt(A,e){return A^e+2654435769+(A<<6)+(A>>2)|0}return Ft[E]=!0,Ft[R]=pt.entries,Ft.__toJS=pt.toObject,Ft.__toStringMapper=function(A,e){return JSON.stringify(e)+": "+Ut(A)},mt(i,{toKeyedSeq:function(){return new Ye(this,!1)},filter:function(A,e){return ze(this,Re(this,A,e,!1))},findIndex:function(A,e){var t=this.findEntry(A,e);return t?t[0]:-1},indexOf:function(A){var e=this.keyOf(A);return void 0===e?-1:e},lastIndexOf:function(A){var e=this.lastKeyOf(A);return void 0===e?-1:e},reverse:function(){return ze(this,xe(this,!1))},slice:function(A,e){return ze(this,Ge(this,A,e,!1))},splice:function(A,e){var t=arguments.length;if(e=Math.max(0|e,0),0===t||2===t&&!e)return this;A=Y(A,A<0?this.count():this.size);var n=this.slice(0,A);return ze(this,1===t?n:n.concat(d(arguments,2),this.slice(A+e)))},findLastIndex:function(A,e){var t=this.findLastEntry(A,e);return t?t[0]:-1},first:function(){return this.get(0)},flatten:function(A){return ze(this,be(this,A,!1))},get:function(A,e){return(A=p(this,A))<0||this.size===1/0||void 0!==this.size&&A>this.size?e:this.find((function(e,t){return t===A}),void 0,e)},has:function(A){return(A=p(this,A))>=0&&(void 0!==this.size?this.size===1/0||A<this.size:-1!==this.indexOf(A))},interpose:function(A){return ze(this,function(A,e){var t=Ve(A);return t.size=A.size&&2*A.size-1,t.__iterateUncached=function(t,n){var i=this,r=0;return A.__iterate((function(A,n){return(!r||!1!==t(e,r++,i))&&!1!==t(A,r++,i)}),n),r},t.__iteratorUncached=function(t,n){var i,r=A.__iterator(1,n),o=0;return new G((function(){return(!i||o%2)&&(i=r.next()).done?i:o%2?S(t,o++,e):S(t,o++,i.value,i)}))},t}(this,A))},interleave:function(){var A=[this].concat(d(arguments)),e=Je(this.toSeq(),P.of,A),t=e.flatten(!0);return e.size&&(t.size=e.size*A.length),ze(this,t)},keySeq:function(){return cA(0,this.size)},last:function(){return this.get(-1)},skipWhile:function(A,e){return ze(this,Se(this,A,e,!1))},zip:function(){var A=[this].concat(d(arguments));return ze(this,Je(this,yt,A))},zipWith:function(A){var e=d(arguments);return e[0]=this,ze(this,Je(this,A,e))}}),i.prototype[Q]=!0,i.prototype[u]=!0,mt(r,{get:function(A,e){return this.has(A)?A:e},includes:function(A){return this.has(A)},keySeq:function(){return this.valueSeq()}}),r.prototype.has=pt.includes,r.prototype.contains=r.prototype.includes,mt(L,n.prototype),mt(P,i.prototype),mt(O,r.prototype),mt(EA,n.prototype),mt(QA,i.prototype),mt(uA,r.prototype),{Iterable:t,Seq:z,Collection:gA,Map:yA,OrderedMap:de,List:ie,Stack:lt,Set:et,OrderedSet:Bt,Record:Ze,Range:cA,Repeat:aA,is:oA,fromJS:nA}}()},function(A,e){A.exports=function(A,e){let t="";for(const A in e){let n=e[A].value;"CURRENTMENU"===A&&(n=n.toLowerCase()),t+="_".concat(n)}return"".concat(A).concat(t)}},function(A,e,t){const n=t(5),i=[];class r{constructor(A){this.isLoop=!1,this.warpMode=A,this.justReported=null,this.reporting="",this.reported=null,this.waitingReporter=null,this.params=null,this.executionContext=null,this.op=null}reset(){return this.isLoop=!1,this.warpMode=!1,this.justReported=null,this.reported=null,this.waitingReporter=null,this.params=null,this.executionContext=null,this.op=null,this}reuse(){let A=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.warpMode;return this.reset(),this.warpMode=Boolean(A),this}static create(A){const e=i.pop();return void 0!==e?(e.warpMode=Boolean(A),e):new r(A)}static release(A){void 0!==A&&i.push(A.reset())}}class o{constructor(A){this.topBlock=A,this.stack=[],this.stackFrames=[],this.status=0,this.isKilled=!1,this.target=null,this.blockContainer=null,this.requestScriptGlowInFrame=!1,this.blockGlowInFrame=null,this.warpTimer=null,this.justReported=null,this.triedToCompile=!1,this.isCompiled=!1,this.timer=null,this.generator=null,this.procedures=null,this.executableHat=!1,this.compatibilityStackFrame=null,this.variables=Object.create(null)}static get STATUS_RUNNING(){return 0}static get STATUS_PROMISE_WAIT(){return 1}static get STATUS_YIELD(){return 2}static get STATUS_YIELD_TICK(){return 3}static get STATUS_PAUSED(){return 5}static get STATUS_DONE(){return 4}static getIdFromTargetAndBlock(A,e){return"".concat(A.id,"&").concat(e)}getId(){return o.getIdFromTargetAndBlock(this.target,this.topBlock)}pushStack(A){if(this.stack.push(A),this.stack.length>this.stackFrames.length){const A=this.stackFrames[this.stackFrames.length-1];this.stackFrames.push(r.create(void 0!==A&&A.warpMode))}}reuseStackForNextBlock(A){this.stack[this.stack.length-1]=A,this.stackFrames[this.stackFrames.length-1].reuse()}popStack(){return r.release(this.stackFrames.pop()),this.stack.pop()}stopThisScript(){let A=this.peekStack();for(;null!==A;){const e=this.target.blocks.getBlock(A);if(this.peekStackFrame().waitingReporter)break;if(void 0!==e&&"procedures_call"===e.opcode){this.goToNextBlock();break}this.popStack(),A=this.peekStack()}0===this.stack.length&&(this.requestScriptGlowInFrame=!1,this.status=o.STATUS_DONE,this.target.runtime.emit("THREAD_FINISHED",this))}peekStack(){return this.stack.length>0?this.stack[this.stack.length-1]:null}peekStackFrame(){return this.stackFrames.length>0?this.stackFrames[this.stackFrames.length-1]:null}peekParentStackFrame(){return this.stackFrames.length>1?this.stackFrames[this.stackFrames.length-2]:null}pushReportedValue(A){this.justReported=void 0===A?null:A}initParams(){const A=this.peekStackFrame();null===A.params&&(A.params={})}pause(){this.originalStatus=this.status,this.status=o.STATUS_PAUSED,this.timer&&this.timer.pause()}play(){this.status=this.originalStatus,this.timer&&this.timer.play()}pushParam(A,e){this.peekStackFrame().params[A]=e}getParam(A){for(let e=this.stackFrames.length-1;e>=0;e--){const t=this.stackFrames[e];if(null!==t.params)return Object.prototype.hasOwnProperty.call(t.params,A)?t.params[A]:null}return null}getAllparams(){return this.peekStackFrame().params}atStackTop(){return this.peekStack()===this.topBlock}goToNextBlock(){const A=this.target.blocks.getNextBlock(this.peekStack());this.reuseStackForNextBlock(A)}isRecursiveCall(A){let e=5;for(let t=this.stackFrames.length-1-1;t>=0;t--){const n=this.target.blocks.getBlock(this.stackFrames[t].op.id)||this.target.runtime.flyoutBlocks.getBlock(this.stackFrames[t].op.id);if("procedures_call"===n.opcode&&n.mutation.proccode===A)return!0;if(--e<0)return!1}return!1}tryCompile(){if(!this.blockContainer)return;const A=t(220);this.triedToCompile=!0;const e=!this.stackClick,i=this.topBlock,r=this.blockContainer.getBlock(i)?this.blockContainer:this.target.runtime.flyoutBlocks,o=e&&r.getCachedCompileResult(i);if(o&&!o.success)return;let s;if(o)s=o.value;else try{s=A(this),e&&r.cacheCompileResult(i,s)}catch(A){return n.error("cannot compile script",this.target.getName(),A),e&&r.cacheCompileError(i,A),void this.target.runtime.emitCompileError(this.target,A)}this.procedures={};for(const A of Object.keys(s.procedures))this.procedures[A]=s.procedures[A](this);this.generator=s.startingFunction(this)(),this.executableHat=s.executableHat,this.blockContainer.forceNoGlow||(this.blockGlowInFrame=this.topBlock,this.requestScriptGlowInFrame=!0),this.isCompiled=!0}}o._StackFrame=r,A.exports=o},function(A,e){A.exports={manhattan:function(A,e){return A+e},euclidean:function(A,e){return Math.sqrt(A*A+e*e)},octile:function(A,e){var t=Math.SQRT2-1;return A<e?t*A+e:t*e+A},chebyshev:function(A,e){return Math.max(A,e)}}},function(A,e,t){const n=t(22),i=t(71),r=t(19),o=t(47),s=t(57),a=t(16),B=t(5),c=t(9),g=t(6),E=t(10),Q=t(102),u=t(7),l=t(441),w=t(442),{loadCostume:h}=t(49),{loadSound:C}=t(48),{deserializeCostume:I,deserializeSound:M}=t(110),d=t(443),m=Object.prototype.hasOwnProperty,p=["argument","colour","control","data","event","looks","math","motion","operator","procedures","sensing","sound"],F=12,D=13,Y={math_number:[4,"NUM"],math_positive_number:[5,"NUM"],math_whole_number:[6,"NUM"],math_integer:[7,"NUM"],math_angle:[8,"NUM"],colour_picker:[9,"COLOUR"],text:[10,"TEXT"],event_broadcast_menu:[11,"BROADCAST_OPTION"],data_variable:[F,"VARIABLE"],data_listcontents:[D,"LIST"]},f={jwUnite_always:"event_always",jwUnite_whenanything:"event_whenanything",jwUnite_getspritewithattrib:"sensing_getspritewithattrib",jwUnite_backToGreenFlag:"control_backToGreenFlag",jwUnite_trueBoolean:"operator_trueBoolean",jwUnite_falseBoolean:"operator_falseBoolean",jwUnite_randomBoolean:"operator_randomBoolean",jwUnite_mobile:"sensing_mobile",jwUnite_thing_is_text:"sensing_thing_is_text",jwUnite_thing_is_number:"sensing_thing_is_number",jwUnite_if_return_else_return:"control_if_return_else_return",jwUnite_indexOfTextInText:"operator_indexOfTextInText",jwUnite_regextest:"sensing_regextest",jwUnite_regexmatch:"operator_regexmatch",jwUnite_replaceAll:"operator_replaceAll",jwUnite_getLettersFromIndexToIndexInText:"operator_getLettersFromIndexToIndexInText",jwUnite_readLineInMultilineText:"operator_readLineInMultilineText",jwUnite_newLine:"operator_newLine",jwUnite_stringify:"operator_stringify",jwUnite_lerpFunc:"operator_lerpFunc",jwUnite_advMath:"operator_advMath",jwUnite_constrainnumber:"operator_constrainnumber"},N={griffpatch:{id:"griffpatch",url:"https://extensions.turbowarp.org/box2d.js"},jwUnite:(A,e,t)=>{A.extensionIDs.delete("jwUnite");let n=e.blocks;const i=Object.keys(n),r=A.patcher;for(let A,o=0;o<i.length;o++)if(A=n[i[o]],"object"==typeof A&&!Array.isArray(A)){if(f[A.opcode]&&(A.opcode=f[A.opcode],"sensing_regextest"!==A.opcode&&"operator_regexmatch"!==A.opcode||(A.inputs.regrule=[1,[10,"g"]])),"jwUnite_setReplacer"===A.opcode||"jwUnite_replaceWithReplacers"===A.opcode){r.loaded.includes("jgJSON")||(t.extensionManager.loadExtensionURL("jgJSON"),r.loaded.push("jgJSON")),n=Object.assign(n,u.simple(d.blocks)),e.variables=Object.assign(e.variables,u.simple(d.variables));const i="jwUnite_setReplacer"===A.opcode?"setReplacerToDisplay":"replaceWithReplacersDisplay",o=u.simple(d.blocks[i]);A.opcode="procedures_call",A.mutation=o.mutation}n[i[o]]=A}e.blocks=n}},U=function(A){const e=function(A){if(m.call(Y,A.opcode)){const e=Y[A.opcode],t=e[0],n=e[1],i=A.fields[n],r=[t,i.value];return"event_broadcast_menu"===A.opcode?r.push(i.id):"data_variable"!==A.opcode&&"data_listcontents"!==A.opcode||(r.push(i.id),A.topLevel&&(r.push(A.x?Math.round(A.x):0),r.push(A.y?Math.round(A.y):0))),r}return null}(A);if(e)return e;const t=Object.create(null);return t.opcode=A.opcode,t.next=A.next,t.parent=A.parent,t.inputs=function(A){const e=Object.create(null);for(const t in A)m.call(A,t)&&(A[t].block===A[t].shadow?e[t]=[1,A[t].block]:null===A[t].shadow?e[t]=[2,A[t].block]:e[t]=[3,A[t].block,A[t].shadow]);return e}(A.inputs),t.fields=function(A){const e=Object.create(null);for(const t in A)m.call(A,t)&&(e[t]=[A[t].value],A[t].hasOwnProperty("id")&&e[t].push(A[t].id),A[t].hasOwnProperty("variableType")&&e[t].push(A[t].variableType));return e}(A.fields),t.shadow=A.shadow,A.topLevel?(t.topLevel=!0,t.x=A.x?Math.round(A.x):0,t.y=A.y?Math.round(A.y):0):t.topLevel=!1,A.mutation&&(t.mutation=A.mutation),A.comment&&(t.comment=A.comment),t},y=function(A,e){const t=A.inputs;for(const A in t){const n=t[A];for(let A=1;A<n.length;A++){if(!n[A])continue;const t=n[A],i=e[t];Array.isArray(i)&&(n[A]=i,delete e[t])}}return A},T=function(A){if("string"!=typeof A)return console.error("invalid opcode "+A),"";const e=A.indexOf("_"),t=A.substring(0,e).replace(/[^\w-]/g,"-");return-1===p.indexOf(t)&&""!==t?t:void 0},x=A=>A._blockInfo.map(A=>A.id).filter(e=>A.extensionManager.isExtensionLoaded(e)),R=(A,e)=>{if(!e.extensionManager)return null;const t=e.extensionManager.getExtensionURLs(),n={};for(const e of A){const A=t[e];"string"==typeof A&&(n[e]=A)}return 0===Object.keys(n).length?null:n},G=function(A){const e=Object.create(null);for(const t in A)A.hasOwnProperty(t)&&(e[t]=U(A[t]));for(const A in e){const t=e[A];e[A]=y(t,e)}for(const A in e){const t=e[A];Array.isArray(t)&&[F,D].indexOf(t[0])<0&&(B.warn("Found an unexpected top level primitive with block ID: ".concat(A,"; deleting it from serialized blocks.")),delete e[A])}return e},S=function(A){const e=Object.create(null);e.name=A.name;const t=A.broken||A;return e.bitmapResolution=t.bitmapResolution,e.dataFormat=t.dataFormat.toLowerCase(),e.assetId=t.assetId,e.md5ext=t.md5,e.rotationCenterX=t.rotationCenterX,e.rotationCenterY=t.rotationCenterY,e},H=function(A){const e=Object.create(null);e.name=A.name;const t=A.broken||A;return e.assetId=t.assetId,e.dataFormat=t.dataFormat.toLowerCase(),e.format=t.format,e.rate=t.rate,e.sampleCount=t.sampleCount,e.md5ext=t.md5,e},b=A=>"number"==typeof A||"string"==typeof A||"boolean"==typeof A,v=(A,e)=>{if(Array.isArray(e)){let t=null;for(let n=0;n<e.length;n++){if(e[n].customId){const{serialize:t}=A.serializers[e[n].customId];e[n]=t(e[n])}b(e[n])||(t||(t=e.slice()),t[n]="".concat(t[n]))}return t||e}if(e.customId){const{serialize:t}=A.serializers[e.customId];return{customType:!0,typeId:e.customId,serialized:t(e)}}return b(e)?e:"".concat(e)},k=function(A,e){const t=Object.create(null);t.isStage=e.isStage,t.name=t.isStage?"Stage":e.name,function(A,e,t){A.variables=Object.create(null),A.lists=Object.create(null),A.broadcasts=Object.create(null),A.customVars=[];for(const n in t){const i=t[n];switch(i.type){case r.BROADCAST_MESSAGE_TYPE:A.broadcasts[n]=i.value;break;case r.LIST_TYPE:A.lists[n]=[i.name,v(e,i.value)];break;case r.SCALAR_TYPE:A.variables[n]=[i.name,v(e,i.value)],i.isCloud&&A.variables[n].push(!0);break;default:const t=i.serialize(),o={type:i.type,id:n,info:t};A.customVars.push(o)}}}(t,A,e.variables),t.blocks=G(e.blocks),t.comments=function(A){const e=Object.create(null);for(const t in A){if(!A.hasOwnProperty(t))continue;const n=A[t],i=Object.create(null);i.blockId=n.blockId,i.x=n.x,i.y=n.y,i.width=n.width,i.height=n.height,i.minimized=n.minimized,i.text=n.text,e[t]=i}return e}(e.comments),(e.currentCostume<0||e.currentCostume>=e.costumes.length)&&(B.warn("currentCostume property for target ".concat(e.name," is out of range")),e.currentCostume=g.clamp(e.currentCostume,0,e.costumes.length-1)),t.currentCostume=e.currentCostume,t.costumes=e.costumes.map(S),t.sounds=e.sounds.map(H),t.id=e.id,e.hasOwnProperty("volume")&&(t.volume=e.volume),e.hasOwnProperty("layerOrder")&&(t.layerOrder=e.layerOrder),t.isStage?(e.hasOwnProperty("tempo")&&(t.tempo=e.tempo),e.hasOwnProperty("videoTransparency")&&(t.videoTransparency=e.videoTransparency),e.hasOwnProperty("videoState")&&(t.videoState=e.videoState),e.hasOwnProperty("textToSpeechLanguage")&&(t.textToSpeechLanguage=e.textToSpeechLanguage)):(t.visible=e.visible,t.x=e.x,t.y=e.y,t.size=e.size,t.direction=e.direction,t.draggable=e.draggable,t.rotationStyle=e.rotationStyle);const n=x(A),i={};for(let t of n){var o;"ext_".concat(t)in A&&"function"==typeof A["ext_".concat(t)].serializeForTarget?i[t]=A["ext_".concat(t)].serializeForTarget(e):t in(null!==(o=e.extensionStorage)&&void 0!==o?o:{})&&(i[t]=e.extensionStorage[t])}return i&&(t.extensionData=i),t},j=function(A){const e=A.map(A=>A.getLayerOrder());return g.reducedSortOrdering(e)},J=function(A,e){const t=(e.stageWidth-480)/2,n=(e.stageHeight-360)/2;return A.valueSeq().filter(A=>!T(A.opcode)||A.visible).map(A=>{const e={id:A.id,mode:A.mode,opcode:A.opcode,params:A.params,spriteName:A.spriteName,value:Array.isArray(A.value)?[]:0,width:A.width,height:A.height,x:A.x-t,y:A.y-n,visible:A.visible,variableType:A.variableType,variableId:A.variableId};return"list"!==A.mode&&(e.sliderMin=A.sliderMin,e.sliderMax=A.sliderMax,e.isDiscrete=A.isDiscrete),e})},z=function(A,e,t,n){if(!Array.isArray(A))return A;const i=Object.create(null),o=c();switch(i.id=o,i.next=null,i.parent=e,i.shadow=t,i.inputs=Object.create(null),A[0]){case 4:i.opcode="math_number",i.fields={NUM:{name:"NUM",value:A[1]}},i.topLevel=!1;break;case 5:i.opcode="math_positive_number",i.fields={NUM:{name:"NUM",value:A[1]}},i.topLevel=!1;break;case 6:i.opcode="math_whole_number",i.fields={NUM:{name:"NUM",value:A[1]}},i.topLevel=!1;break;case 7:i.opcode="math_integer",i.fields={NUM:{name:"NUM",value:A[1]}},i.topLevel=!1;break;case 8:i.opcode="math_angle",i.fields={NUM:{name:"NUM",value:A[1]}},i.topLevel=!1;break;case 9:i.opcode="colour_picker",i.fields={COLOUR:{name:"COLOUR",value:A[1]}},i.topLevel=!1;break;case 10:i.opcode="text",i.fields={TEXT:{name:"TEXT",value:A[1]}},i.topLevel=!1;break;case 11:i.opcode="event_broadcast_menu",i.fields={BROADCAST_OPTION:{name:"BROADCAST_OPTION",value:A[1],id:A[2],variableType:r.BROADCAST_MESSAGE_TYPE}},i.topLevel=!1;break;case F:i.opcode="data_variable",i.fields={VARIABLE:{name:"VARIABLE",value:A[1],id:A[2],variableType:r.SCALAR_TYPE}},A.length>3&&(i.topLevel=!0,i.x=A[3],i.y=A[4]);break;case D:i.opcode="data_listcontents",i.fields={LIST:{name:"LIST",value:A[1],id:A[2],variableType:r.LIST_TYPE}},A.length>3&&(i.topLevel=!0,i.x=A[3],i.y=A[4]);break;case 14:i.opcode=A[1],i.fields={[A[2]]:A[3]},A.length>4&&(i.topLevel=!0,i.x=A[4],i.y=A[5]);break;default:return B.error("Found unknown primitive type during deserialization: ".concat(JSON.stringify(A))),null}return n[o]=i,o},L=function(A,e,t){const n={};for(const i in A){if(!m.call(A,i))continue;const r=A[i];if(!Array.isArray(r))continue;let o=null,s=null;const a=r[0];1===a?o=s=z(r[1],e,!0,t):2===a?o=z(r[1],e,!1,t):(o=z(r[1],e,!1,t),s=z(r[2],e,!0,t)),n[i]={name:i,block:o,shadow:s}}return n},P=function(A){const e={};for(const t in A){if(!m.call(A,t))continue;const n=A[t];Array.isArray(n)&&(e[t]={name:t,value:n[0]},n.length>1&&(e[t].id=n[1]),n.length>2&&(e[t].variableType=n[2]),"BROADCAST_OPTION"===t?e[t].variableType=r.BROADCAST_MESSAGE_TYPE:"VARIABLE"===t?e[t].variableType=r.SCALAR_TYPE:"LIST"===t&&(e[t].variableType=r.LIST_TYPE))}return e},O=function(A){for(const e in A){if(!Object.prototype.hasOwnProperty.call(A,e))continue;const t=A[e];Array.isArray(t)?(delete A[e],z(t,null,!1,A)):(t.id=e,t.inputs=L(t.inputs,e,A),t.fields=P(t.fields))}return A},V=function(A,e){if("procedures_return"===A.opcode){A.inputs.return=A.inputs.VALUE,A.inputs.return.name="return",delete A.inputs.VALUE;let i=A,r=i.parent;for(;null!==r;){var t,n;if(r)i=e._blocks[r],r=null!==(t=null===(n=i)||void 0===n?void 0:n.parent)&&void 0!==t?t:null}if(i&&"procedures_definition"===i.opcode){i.opcode="procedures_definition_return";e._blocks[i.inputs.custom_block.block].mutation.returns="true"}}else if("procedures_call"===A.opcode){const t=e.getProcedureDefinition(A.mutation.proccode);if(t){const n=e._blocks[t].inputs.custom_block.block;"true"===e._blocks[n].mutation.returns&&(A.mutation.returns="true")}const n=e._blocks[A.parent];if(n)if(n.next===A.id)A.mutation.returns="false";else for(const e of Object.values(n.inputs))if(e.block===A.id&&e.name.startsWith("SUBSTACK")){A.mutation.returns="false";break}}};A.exports={serialize:function(A,e){let{allowOptimization:t=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=Object.create(null),i=x(A),r=e?[A.getTargetById(e)]:A.targets.filter(A=>A.isOriginal),o=j(r),s=r.map(A=>A.toJSON());A.renderer&&!e&&s.forEach((A,e)=>{A.layerOrder=o[e]});const a=s.map(e=>k(A,e)),B=A.fontManager.serializeJSON();if(e){const e=a[0],t=R(i,A);e.extensions=i,t&&(e.extensionURLs=t),e.extensionData={};for(const t of i)"ext_".concat(t)in A&&"function"==typeof A["ext_".concat(t)].serialize?e.extensionData[t]=A["ext_".concat(t)].serialize():t in A.extensionStorage&&(e.extensionData[t]=A.extensionStorage[t]);return B&&(e.customFonts=B),e}n.targets=a,n.monitors=J(A.getMonitorState(),A),n.extensionData={};for(const e of i)"ext_".concat(e)in A&&"function"==typeof A["ext_".concat(e)].serialize?n.extensionData[e]=A["ext_".concat(e)].serialize():e in A.extensionStorage&&(n.extensionData[e]=A.extensionStorage[e]);n.extensions=i;const c=R(i,A);c&&(n.extensionURLs=c),B&&(n.customFonts=B);const g=Object.create(null);g.semver="3.0.0",g.vm="0.2.0",A.origin&&(g.origin=A.origin),g.agent="";const E=Object.create(null);return E.name="PenguinMod",E.url="https://penguinmod.com/",E.version="stable",g.platform=E,n.meta=g,t&&l(n),n},deserialize:function(A,e,t,c){const u=new w(e);u.registerExtensions(N);const l={extensionIDs:new Set(A.extensions),extensionURLs:new Map,extensionData:{},patcher:u};var d;(A.meta?A.meta.origin?e.origin=A.meta.origin:A.meta.platform?e.origin=A.meta.platform.name:e.origin=null:e.origin=null,A.extensionURLs&&(l.extensionURLs=new Map(Object.entries(A.extensionURLs))),A.extensionData||A.extensionStorage)&&(l.extensionData=Object.assign(null!==(d=A.extensionStorage)&&void 0!==d?d:{},A.extensionData));let m;m=A.customFonts?e.fontManager.deserialize(A.customFonts,t,c):Promise.resolve();const p=((c?[A]:A.targets)||[]).map((A,e)=>Object.assign(A,{targetPaneOrder:e})).sort((A,e)=>A.layerOrder-e.layerOrder),F=A.monitors||[];return m.then(()=>p.map(A=>function(A,e,t){if(!A.hasOwnProperty("name"))return Promise.resolve(null);const n={costumePromises:null,soundPromises:null,soundBank:e.audioEngine&&e.audioEngine.createBank()};return n.costumePromises=(A.costumes||[]).map(A=>{const n={asset:A.asset,assetId:A.assetId,skinId:null,name:A.name,bitmapResolution:A.bitmapResolution,rotationCenterX:A.rotationCenterX,rotationCenterY:A.rotationCenterY},i=A.dataFormat||A.assetType&&A.assetType.runtimeFormat||"png",r=A.hasOwnProperty("md5ext")?A.md5ext:"".concat(A.assetId,".").concat(i);return n.md5=r,n.dataFormat=i,I(n,e,t).then(()=>h(r,n,e))}),n.soundPromises=(A.sounds||[]).map(A=>{const i={assetId:A.assetId,format:A.format,rate:A.rate,sampleCount:A.sampleCount,name:A.name,md5:A.md5ext,dataFormat:A.dataFormat,data:null};return M(i,e,t).then(()=>C(i,e,n.soundBank))}),n}(A,e,t))).then(A=>Promise.resolve(A)).then(A=>Promise.all(p.map((t,s)=>function(A,e,t,s,B){if(!A.hasOwnProperty("name"))return Promise.resolve(null);const c=new n(e),E=new i(c,e);if(A.hasOwnProperty("name")&&(E.name=A.name),A.hasOwnProperty("blocks")){for(const e in A.blocks){if(!A.blocks.hasOwnProperty(e))continue;const n=A.blocks[e];if("object"!=typeof n||Array.isArray(n))continue;const i=T(n.opcode);t.patcher.patchExists(i)&&t.patcher.runExtensionPatch(i,t,A)}O(A.blocks);const n=[];for(const t in A.blocks){if(!A.blocks.hasOwnProperty(t))continue;const i=A.blocks[t];"TurboWarp"===e.origin&&("procedures_call"!==i.opcode&&"procedures_return"!==i.opcode||n.push(i)),c.createBlock(i)}if("TurboWarp"===e.origin)for(const A of n)V(A,c)}const{costumePromises:Q}=B,{soundBank:u,soundPromises:l}=B,w=E.createClone(A.isStage?a.BACKGROUND_LAYER:a.SPRITE_LAYER);if(A.hasOwnProperty("tempo")&&(w.tempo=A.tempo),A.hasOwnProperty("volume")&&(w.volume=A.volume),A.hasOwnProperty("videoTransparency")&&(w.videoTransparency=A.videoTransparency),A.hasOwnProperty("videoState")&&(w.videoState=A.videoState),A.hasOwnProperty("textToSpeechLanguage")&&(w.textToSpeechLanguage=A.textToSpeechLanguage),A.hasOwnProperty("variables"))for(const t in A.variables){const n=A.variables[t],i=3===n.length&&n[2]&&A.isStage&&e.canAddCloudVariable(),o=new r(t,n[0],r.SCALAR_TYPE,i);i&&e.addCloudVariable(),o.value=n[1],w.variables[o.id]=o}if(A.hasOwnProperty("lists"))for(const e in A.lists){const t=A.lists[e],n=new r(e,t[0],r.LIST_TYPE,!1);n.value=t[1],w.variables[n.id]=n}if(A.hasOwnProperty("broadcasts"))for(const e in A.broadcasts){const t=A.broadcasts[e],n=new r(e,t,r.BROADCAST_MESSAGE_TYPE,!1);w.variables[n.id]=n}if(A.hasOwnProperty("customVars"))for(const t of A.customVars){if(Array.isArray(t)){const A=e.newVariableInstance(...t);w.variables[t[1]]=A;continue}const A=e.newVariableInstance(t.type,...t.info);w.variables[t.id]=A}if(A.hasOwnProperty("comments"))for(const e in A.comments){const t=A.comments[e],n=new o(e,t.text,t.x,t.y,t.width,t.height,t.minimized);t.blockId&&(n.blockId=t.blockId),w.comments[n.id]=n}A.hasOwnProperty("x")&&(w.x=A.x),A.hasOwnProperty("y")&&(w.y=A.y),A.hasOwnProperty("direction")&&(w.direction=A.direction),A.hasOwnProperty("size")&&(w.size=A.size),A.hasOwnProperty("visible")&&(w.visible=A.visible),A.hasOwnProperty("currentCostume")&&(w.currentCostume=g.clamp(A.currentCostume,0,A.costumes.length-1)),A.hasOwnProperty("rotationStyle")&&(w.rotationStyle=A.rotationStyle),A.hasOwnProperty("isStage")&&(w.isStage=A.isStage),A.hasOwnProperty("targetPaneOrder")&&(w.targetPaneOrder=A.targetPaneOrder),A.hasOwnProperty("draggable")&&(w.draggable=A.draggable);const h=e.targets.map(A=>A.id);var C;(A.hasOwnProperty("id")&&!h.includes(A.id)&&(w.id=A.id),A.hasOwnProperty("extensionData")||A.hasOwnProperty("extensionStorage"))&&(w.extensionData=Object.assign(null!==(C=A.extensionStorage)&&void 0!==C?C:{},A.extensionData));return Promise.all(Q).then(A=>{E.costumes=A}),Promise.all(l).then(A=>{E.sounds=A,E.soundBank=u||null}),Promise.all(Q.concat(l)).then(()=>w)}(t,e,l,0,A[s])))).then(A=>A.map((A,e)=>(A.layerOrder=e,A)).sort((A,e)=>A.targetPaneOrder-e.targetPaneOrder).map(A=>(delete A.targetPaneOrder,A))).then(A=>function(A){const e=Q.getAllVarRefsForTargets(A,!0);A.forEach(A=>{Object.keys(A.variables).forEach(e=>{const t=E.replaceUnsafeChars(e);t!==e&&(A.variables[e].id=t,A.variables[t]=A.variables[e],delete A.variables[e])})});for(const A in e){const t=E.replaceUnsafeChars(A);A!==t&&Q.updateVariableIdentifiers(e[A],t)}return A}(A)).then(A=>{"TurboWarp"===e.origin&&(e.origin=null);const t=A.find(A=>A.isStage);if(t){let A;for(const e of Object.values(null==t?void 0:t.comments))if(e.text.includes(" // _twconfig_")){A=e;break}A&&e.parseProjectOptions(A)}return F.map(t=>function(A,e,t,n){const i=(e.stageWidth-480)/2,o=(e.stageHeight-360)/2;if(A.x+=i,A.y+=o,A.x=g.clamp(A.x,0,e.stageWidth),A.y=g.clamp(A.y,0,e.stageHeight),A.spriteName){const e=t.filter(e=>e.sprite.name===A.spriteName);e&&e.length>0?A.targetId=e[0].id:B.warn("Tried to deserialize sprite specific monitor ".concat(A.opcode," but could not find sprite ").concat(A.spriteName,"."))}const a=e.monitorBlockInfo[A.opcode];if("data_listcontents"===A.opcode){const e=A.targetId?t.find(e=>e.id===A.targetId):t.find(A=>A.isStage);e&&Object.prototype.hasOwnProperty.call(e.variables,A.id)&&(A.params.LIST=e.variables[A.id].name)}const c={};for(const e in A.params){const t={name:e,value:A.params[e]};"object"==typeof A.params[e]&&(t.id=A.params[e].id,t.value=A.params[e].name),c[e]=t}"data_variable"!==A.opcode&&"data_listcontents"!==A.opcode&&a&&a.isSpriteSpecific?A.id=a.getId(A.targetId,c):A.id=E.replaceUnsafeChars(A.id);const Q=e.monitorBlocks._blocks[A.id];if(Q)Q.isMonitored=A.visible,Q.targetId=A.targetId;else{const t={id:A.id,opcode:A.opcode,inputs:{},fields:c,topLevel:!0,next:null,parent:null,shadow:!1,x:0,y:0,isMonitored:A.visible,targetId:A.targetId};if("data_variable"===A.opcode){const e=t.fields.VARIABLE;e.id=A.id,e.variableType=r.SCALAR_TYPE}else if("data_listcontents"===A.opcode){const e=t.fields.LIST;e.id=A.id,e.variableType=r.LIST_TYPE}else if(A.variableId){const e=Object.values(t.fields)[0];e.id=A.variableId,e.variableType=A.variableType}e.monitorBlocks.createBlock(t)}e.requestAddMonitor(s(A))}(t,e,A)),A}).then(A=>({targets:A,extensions:l}))},deserializeBlocks:O,serializeBlocks:G,deserializeStandaloneBlocks:A=>{if((A=JSON.parse(JSON.stringify(A))).extensionURLs){const e=new Map;for(const[t,n]of Object.entries(A.extensionURLs))e.set(t,n);return{blocks:A.blocks,extensionURLs:e}}return{blocks:A,extensionURLs:new Map}},serializeStandaloneBlocks:(A,e)=>{const t=new Set(x(e)),n=R(t,e);return n?{blocks:A,extensionURLs:n}:A},getExtensionIdForOpcode:T}},function(A,e,t){const n=t(17),i=(A,e,t)=>Math.max(Math.min(A,t),e);class r{constructor(A){this._gl=A,this._shaderCache={};for(const A in r.DRAW_MODE)Object.prototype.hasOwnProperty.call(r.DRAW_MODE,A)&&(this._shaderCache[A]=[])}getShader(A,e){const t=this._shaderCache[A];A===r.DRAW_MODE.silhouette&&(e&=~(r.EFFECT_INFO.color.mask|r.EFFECT_INFO.brightness.mask));let n=t[e];return n||(n=t[e]=this._buildShader(A,e)),n}_buildShader(A,e){const i=r.EFFECTS.length,o=["#define DRAW_MODE_".concat(A)];for(let A=0;A<i;++A)0!=(e&1<<A)&&o.push("#define ENABLE_".concat(r.EFFECTS[A]));const s="".concat(o.join("\n"),"\n"),a=s+t(459),B=s+t(460);return n.createProgramInfo(this._gl,[a,B])}}r.EFFECT_INFO={color:{uniformName:"u_color",mask:1,converter:A=>A/200%1,shapeChanges:!1},fisheye:{uniformName:"u_fisheye",mask:2,converter:A=>Math.max(0,(A+100)/100),shapeChanges:!0},whirl:{uniformName:"u_whirl",mask:4,converter:A=>-A*Math.PI/180,shapeChanges:!0},pixelate:{uniformName:"u_pixelate",mask:8,converter:A=>Math.abs(A)/10,shapeChanges:!0},mosaic:{uniformName:"u_mosaic",mask:16,converter:A=>(A=Math.round((Math.abs(A)+10)/10),Math.max(1,Math.min(A,512))),shapeChanges:!0},brightness:{uniformName:"u_brightness",mask:32,converter:A=>Math.max(-100,Math.min(A,100))/100,shapeChanges:!1},ghost:{uniformName:"u_ghost",mask:64,converter:A=>1-Math.max(0,Math.min(A,100))/100,shapeChanges:!1},red:{uniformName:"u_red",mask:128,converter:A=>i(A,-100,100)/100*4+1,shapeChanges:!1},green:{uniformName:"u_green",mask:256,converter:A=>i(A,-100,100)/100*4+1,shapeChanges:!1},blue:{uniformName:"u_blue",mask:512,converter:A=>i(A,-100,100)/100*4+1,shapeChanges:!1},opaque:{uniformName:"u_opaque",mask:1024,converter:A=>i(Math.ceil(A),1,100),shapeChanges:!1},saturation:{uniformName:"u_saturation",mask:2048,converter:A=>A/100+1,shapeChanges:!1},tintColor:{uniformName:"u_tintColor",mask:4096,converter:A=>A-1,shapeChanges:!1}},r.EFFECTS=Object.keys(r.EFFECT_INFO),r.DRAW_MODE={default:"default",straightAlpha:"straightAlpha",silhouette:"silhouette",colorMask:"colorMask",line:"line",background:"background"},A.exports=r},function(A,e){var t,n,i=A.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(A){if(t===setTimeout)return setTimeout(A,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(A,0);try{return t(A,0)}catch(e){try{return t.call(null,A,0)}catch(e){return t.call(this,A,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(A){t=r}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(A){n=o}}();var a,B=[],c=!1,g=-1;function E(){c&&a&&(c=!1,a.length?B=a.concat(B):g=-1,B.length&&Q())}function Q(){if(!c){var A=s(E);c=!0;for(var e=B.length;e;){for(a=B,B=[];++g<e;)a&&a[g].run();g=-1,e=B.length}a=null,c=!1,function(A){if(n===clearTimeout)return clearTimeout(A);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(A);try{n(A)}catch(e){try{return n.call(null,A)}catch(e){return n.call(this,A)}}}(A)}}function u(A,e){this.fun=A,this.array=e}function l(){}i.nextTick=function(A){var e=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];B.push(new u(A,e)),1!==B.length||c||s(Q)},u.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=l,i.addListener=l,i.once=l,i.off=l,i.removeListener=l,i.removeAllListeners=l,i.emit=l,i.prependListener=l,i.prependOnceListener=l,i.listeners=function(A){return[]},i.binding=function(A){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(A){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(A,e){A.exports={translateForCamera:(A,e,t,n)=>{const{pos:i,scale:r,dir:o}=A.getCamera(e),s=o/180*Math.PI,a=Math.sin(s),B=Math.cos(s),c=t-i[0],g=n-i[1];return[r*(c*B-g*a),r*(c*a+g*B)]},translateScreenPos:(A,e,t,n)=>{const{pos:i,scale:r,dir:o}=A.getCamera(e),s=1/r,a=-o/180*Math.PI,B=Math.sin(a),c=Math.cos(a);return[i[0]+s*(t*c-n*B),i[1]+s*(t*B+n*c)]}}},function(A,e,t){const n=t(54);A.exports=class extends n{constructor(A,e,t,n){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;super(),this._socket=A.getScratchLinkSocket("BLE"),this._socket.setOnOpen(this.requestPeripheral.bind(this)),this._socket.setOnClose(this.handleDisconnectError.bind(this)),this._socket.setOnError(this._handleRequestError.bind(this)),this._socket.setHandleMessage(this._handleMessage.bind(this)),this._sendMessage=this._socket.sendMessage.bind(this._socket),this._availablePeripherals={},this._connectCallback=n,this._connected=!1,this._characteristicDidChangeCallback=null,this._resetCallback=i,this._discoverTimeoutID=null,this._extensionId=e,this._peripheralOptions=t,this._runtime=A,this._socket.open()}requestPeripheral(){this._availablePeripherals={},this._discoverTimeoutID&&window.clearTimeout(this._discoverTimeoutID),this._discoverTimeoutID=window.setTimeout(this._handleDiscoverTimeout.bind(this),15e3),this.sendRemoteRequest("discover",this._peripheralOptions).catch(A=>{this._handleRequestError(A)})}connectPeripheral(A){this.sendRemoteRequest("connect",{peripheralId:A}).then(()=>{this._connected=!0,this._runtime.emit(this._runtime.constructor.PERIPHERAL_CONNECTED),this._connectCallback()}).catch(A=>{this._handleRequestError(A)})}disconnect(){this._connected&&(this._connected=!1),this._socket.isOpen()&&this._socket.close(),this._discoverTimeoutID&&window.clearTimeout(this._discoverTimeoutID),this._runtime.emit(this._runtime.constructor.PERIPHERAL_DISCONNECTED)}isConnected(){return this._connected}startNotifications(A,e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const n={serviceId:A,characteristicId:e};return this._characteristicDidChangeCallback=t,this.sendRemoteRequest("startNotifications",n).catch(A=>{this.handleDisconnectError(A)})}read(A,e){let t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const n={serviceId:A,characteristicId:e};return arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&(n.startNotifications=!0),t&&(this._characteristicDidChangeCallback=t),this.sendRemoteRequest("read",n).catch(A=>{this.handleDisconnectError(A)})}write(A,e,t){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const r={serviceId:A,characteristicId:e,message:t};return n&&(r.encoding=n),null!==i&&(r.withResponse=i),this.sendRemoteRequest("write",r).catch(A=>{this.handleDisconnectError(A)})}didReceiveCall(A,e){switch(A){case"didDiscoverPeripheral":this._availablePeripherals[e.peripheralId]=e,this._runtime.emit(this._runtime.constructor.PERIPHERAL_LIST_UPDATE,this._availablePeripherals),this._discoverTimeoutID&&window.clearTimeout(this._discoverTimeoutID);break;case"userDidPickPeripheral":this._availablePeripherals[e.peripheralId]=e,this._runtime.emit(this._runtime.constructor.USER_PICKED_PERIPHERAL,this._availablePeripherals),this._discoverTimeoutID&&window.clearTimeout(this._discoverTimeoutID);break;case"userDidNotPickPeripheral":this._runtime.emit(this._runtime.constructor.PERIPHERAL_SCAN_TIMEOUT),this._discoverTimeoutID&&window.clearTimeout(this._discoverTimeoutID);break;case"characteristicDidChange":this._characteristicDidChangeCallback&&this._characteristicDidChangeCallback(e.message);break;case"ping":return 42}}handleDisconnectError(){this._connected&&(this.disconnect(),this._resetCallback&&this._resetCallback(),this._runtime.emit(this._runtime.constructor.PERIPHERAL_CONNECTION_LOST_ERROR,{message:"Scratch lost connection to",extensionId:this._extensionId}))}_handleRequestError(){this._runtime.emit(this._runtime.constructor.PERIPHERAL_REQUEST_ERROR,{message:"Scratch lost connection to",extensionId:this._extensionId})}_handleDiscoverTimeout(){this._discoverTimeoutID&&window.clearTimeout(this._discoverTimeoutID),this._runtime.emit(this._runtime.constructor.PERIPHERAL_SCAN_TIMEOUT)}}},function(A,e,t){const n={Timer:t(18),Cast:t(2),log:t(5),blockUtility:t(223),thread:null};let i="";const r={};i+="let stuckCounter = 0;\nconst isStuck = () => {\n // The real time is not checked on every call for performance.\n stuckCounter++;\n if (stuckCounter === 100) {\n stuckCounter = 0;\n return globalState.thread.target.runtime.sequencer.timer.timeElapsed() > 500;\n }\n return false;\n};",r.nullish="const nullish = (check, alt) => {\n if (!check) {\n if (val === undefined) return alt\n if (val === null) return alt\n return check\n } else {\n return check\n }\n}",r.startHats="const startHats = (requestedHat, optMatchFields) => {\n const thread = globalState.thread;\n const threads = thread.target.runtime.startHats(requestedHat, optMatchFields);\n return threads;\n}",r.waitThreads="const waitThreads = function*(threads) {\n const thread = globalState.thread;\n const runtime = thread.target.runtime;\n\n while (true) {\n // determine whether any threads are running\n let anyRunning = false;\n for (let i = 0; i < threads.length; i++) {\n if (runtime.threads.indexOf(threads[i]) !== -1) {\n anyRunning = true;\n break;\n }\n }\n if (!anyRunning) {\n // all threads are finished, can resume\n return;\n }\n\n let allWaiting = true;\n for (let i = 0; i < threads.length; i++) {\n if (!runtime.isWaitingThread(threads[i])) {\n allWaiting = false;\n break;\n }\n }\n if (allWaiting) {\n thread.status = 3; // STATUS_YIELD_TICK\n }\n\n yield;\n }\n}",r.waitPromise="\nconst waitPromise = function*(promise) {\n const thread = globalState.thread;\n let returnValue;\n let errorReturn;\n\n promise\n .then(value => {\n returnValue = value;\n thread.status = 0; // STATUS_RUNNING\n })\n .catch(error => {\n errorReturn = error;\n // i realized, i dont actually know what would happen if we never do this but throw and exit anyways\n thread.status = 0; // STATUS_RUNNING\n });\n\n // enter STATUS_PROMISE_WAIT and yield\n // this will stop script execution until the promise handlers reset the thread status\n thread.status = 1; // STATUS_PROMISE_WAIT\n yield;\n\n // throw the promise error if ee got one\n if (errorReturn) throw errorReturn\n return returnValue;\n}",r.executeInCompatibilityLayer="let hasResumedFromPromise = false;\n\nconst isPromise = value => (\n // see engine/execute.js\n value !== null &&\n typeof value === 'object' &&\n typeof value.then === 'function'\n);\nconst executeInCompatibilityLayer = function*(inputs, blockFunction, isWarp, useFlags, blockId, branchInfo, visualReport) {\n const thread = globalState.thread;\n const blockUtility = globalState.blockUtility;\n const stackFrame = branchInfo ? branchInfo.stackFrame : {};\n const finish = (returnValue) => {\n if (branchInfo) {\n if (typeof returnValue === 'undefined' && blockUtility._startedBranch) {\n branchInfo.isLoop = blockUtility._startedBranch[1];\n return blockUtility._startedBranch[0];\n }\n branchInfo.isLoop = branchInfo.defaultIsLoop;\n return returnValue;\n }\n return returnValue;\n };\n\n // reset the stackframe\n // we only ever use one stackframe at a time, so this shouldn't cause issues\n thread.stackFrames[thread.stackFrames.length - 1].reuse(isWarp);\n\n const executeBlock = () => {\n blockUtility.init(thread, blockId, stackFrame, branchInfo);\n return blockFunction(inputs, blockUtility, visualReport);\n };\n\n let returnValue = executeBlock();\n if (isPromise(returnValue)) {\n returnValue = finish(yield* waitPromise(returnValue));\n if (useFlags) hasResumedFromPromise = true;\n return returnValue;\n }\n\n if (thread.status === 1 || thread.status === 4 ) {\n // Something external is forcing us to stop\n yield;\n // Make up a return value because whatever is forcing us to stop can't specify one\n return '';\n }\n\n while (thread.status === 2 || thread.status === 3 ) {\n // Yielded threads will run next iteration.\n if (thread.status === 2 ) {\n thread.status = 0; // STATUS_RUNNING\n // Yield back to the event loop when stuck or not in warp mode.\n if (!isWarp || isStuck()) {\n yield;\n }\n } else {\n // status is STATUS_YIELD_TICK, always yield to the event loop\n yield;\n }\n\n returnValue = executeBlock();\n if (isPromise(returnValue)) {\n returnValue = finish(yield* waitPromise(returnValue));\n if (useFlags) hasResumedFromPromise = true;\n return returnValue;\n }\n\n if (thread.status === 1 || thread.status === 4 ) {\n yield;\n return finish('');\n }\n }\n return finish(returnValue);\n}",r.createBranchInfo="const createBranchInfo = (isLoop) => ({\n defaultIsLoop: isLoop,\n isLoop: false,\n branch: 0,\n stackFrame: {},\n onEnd: [],\n});",r.retire="const retire = () => {\n const thread = globalState.thread;\n thread.target.runtime.sequencer.retireThread(thread);\n}",r.toBoolean="const toBoolean = value => {\n if (typeof value === 'boolean') {\n return value;\n }\n if (typeof value === 'string') {\n if (value === '' || value === '0' || value.toLowerCase() === 'false') {\n return false;\n }\n return true;\n }\n return !!value;\n}",r.limitPrecision="const limitPrecision = value => {\n const rounded = Math.round(value);\n const delta = value - rounded;\n return (Math.abs(delta) < 1e-9) ? rounded : value;\n}",i+="const isNotActuallyZero = val => {\n if (typeof val !== 'string') return false;\n for (let i = 0; i < val.length; i++) {\n const code = val.charCodeAt(i);\n if (code === 48 || code === 9) {\n return false;\n }\n }\n return true;\n};",i+="const compareEqualSlow = (v1, v2) => {\n const n1 = +v1;\n if (isNaN(n1) || (n1 === 0 && isNotActuallyZero(v1))) return ('' + v1).toLowerCase() === ('' + v2).toLowerCase();\n const n2 = +v2;\n if (isNaN(n2) || (n2 === 0 && isNotActuallyZero(v2))) return ('' + v1).toLowerCase() === ('' + v2).toLowerCase();\n return n1 === n2;\n};\nconst compareEqual = (v1, v2) => (typeof v1 === 'number' && typeof v2 === 'number' && !isNaN(v1) && !isNaN(v2) || v1 === v2) ? v1 === v2 : compareEqualSlow(v1, v2);",r.compareGreaterThan="const compareGreaterThanSlow = (v1, v2) => {\n let n1 = +v1;\n let n2 = +v2;\n if (n1 === 0 && isNotActuallyZero(v1)) {\n n1 = NaN;\n } else if (n2 === 0 && isNotActuallyZero(v2)) {\n n2 = NaN;\n }\n if (isNaN(n1) || isNaN(n2)) {\n const s1 = ('' + v1).toLowerCase();\n const s2 = ('' + v2).toLowerCase();\n return s1 > s2;\n }\n return n1 > n2;\n};\nconst compareGreaterThan = (v1, v2) => typeof v1 === 'number' && typeof v2 === 'number' && !isNaN(v1) ? v1 > v2 : compareGreaterThanSlow(v1, v2)",r.compareLessThan="const compareLessThanSlow = (v1, v2) => {\n let n1 = +v1;\n let n2 = +v2;\n if (n1 === 0 && isNotActuallyZero(v1)) {\n n1 = NaN;\n } else if (n2 === 0 && isNotActuallyZero(v2)) {\n n2 = NaN;\n }\n if (isNaN(n1) || isNaN(n2)) {\n const s1 = ('' + v1).toLowerCase();\n const s2 = ('' + v2).toLowerCase();\n return s1 < s2;\n }\n return n1 < n2;\n};\nconst compareLessThan = (v1, v2) => typeof v1 === 'number' && typeof v2 === 'number' && !isNaN(v2) ? v1 < v2 : compareLessThanSlow(v1, v2)",r.randomInt="const randomInt = (low, high) => low + Math.floor(Math.random() * ((high + 1) - low))",r.randomFloat="const randomFloat = (low, high) => (Math.random() * (high - low)) + low",r.timer="const timer = () => {\n const t = new globalState.Timer({\n now: () => globalState.thread.target.runtime.currentMSecs\n });\n t.start();\n return t;\n}",r.daysSince2000="const daysSince2000 = () => (Date.now() - 946684800000) / (24 * 60 * 60 * 1000)",r.distance="const distance = menu => {\n const thread = globalState.thread;\n if (thread.target.isStage) return 10000;\n\n let targetX = 0;\n let targetY = 0;\n if (menu === '_mouse_') {\n targetX = thread.target.runtime.ioDevices.mouse.getScratchX();\n targetY = thread.target.runtime.ioDevices.mouse.getScratchY();\n } else {\n const distTarget = thread.target.runtime.getSpriteTargetByName(menu);\n if (!distTarget) return 10000;\n targetX = distTarget.x;\n targetY = distTarget.y;\n }\n\n const dx = thread.target.x - targetX;\n const dy = thread.target.y - targetY;\n return Math.sqrt((dx * dx) + (dy * dy));\n}",i+="const listIndexSlow = (index, length) => {\n if (index === 'last') {\n return length - 1;\n } else if (index === 'random' || index === 'any') {\n if (length > 0) {\n return (Math.random() * length) | 0;\n }\n return -1;\n }\n index = (+index || 0) | 0;\n if (index < 1 || index > length) {\n return -1;\n }\n return index - 1;\n};\nconst listIndex = (index, length) => {\n if (typeof index !== 'number') {\n return listIndexSlow(index, length);\n }\n index = index | 0;\n return index < 1 || index > length ? -1 : index - 1;\n};",r.listGet="const listGet = (list, idx) => {\n const index = listIndex(idx, list.length);\n if (index === -1) {\n return '';\n }\n return list[index];\n}",r.listReplace="const listReplace = (list, idx, value) => {\n const index = listIndex(idx, list.value.length);\n if (index === -1) {\n return;\n }\n list.value[index] = value;\n list._monitorUpToDate = false;\n}",r.listInsert="const listInsert = (list, idx, value) => {\n const index = listIndex(idx, list.value.length + 1);\n if (index === -1) {\n return;\n }\n list.value.splice(index, 0, value);\n list._monitorUpToDate = false;\n}",r.listDelete="const listDelete = (list, idx) => {\n if (idx === 'all') {\n list.value = [];\n return;\n }\n const index = listIndex(idx, list.value.length);\n if (index === -1) {\n return;\n }\n list.value.splice(index, 1);\n list._monitorUpToDate = false;\n}",r.listContains="const listContains = (list, item) => {\n // TODO: evaluate whether indexOf is worthwhile here\n if (list.value.indexOf(item) !== -1) {\n return true;\n }\n for (let i = 0; i < list.value.length; i++) {\n if (compareEqual(list.value[i], item)) {\n return true;\n }\n }\n return false;\n}",r.listContainsFastest="const listContainsFastest = (list, item) => {\n return list.value.some(litem => compareEqual(litem, item));\n}",r.listIndexOf="const listIndexOf = (list, item) => {\n for (let i = 0; i < list.value.length; i++) {\n if (compareEqual(list.value[i], item)) {\n return i + 1;\n }\n }\n return 0;\n}",r.listContents="const listContents = list => {\n for (let i = 0; i < list.value.length; i++) {\n const listItem = list.value[i];\n // this is an intentional break from what scratch 3 does to address our automatic string -> number conversions\n // it fixes more than it breaks\n if ((listItem + '').length !== 1) {\n return list.value.join(' ');\n }\n }\n return list.value.join('');\n}",r.colorToList="const colorToList = color => globalState.Cast.toRgbColorList(color)",r.mod="const mod = (n, modulus) => {\n let result = n % modulus;\n if (result / modulus < 0) result += modulus;\n return result;\n}",r.tan="const tan = (angle) => {\n switch (angle % 360) {\n case -270: case 90: return Infinity;\n case -90: case 270: return -Infinity;\n }\n return Math.round(Math.tan((Math.PI * angle) / 180) * 1e10) / 1e10;\n}",r.resolveImageURL="const resolveImageURL = imgURL => \n typeof imgURL === 'object' && imgURL.type === 'canvas'\n ? Promise.resolve(imgURL.canvas)\n : new Promise(resolve => {\n const image = new Image();\n image.crossOrigin = \"anonymous\";\n image.onload = resolve(image);\n image.onerror = resolve; // ignore loading errors lol!\n image.src = ''+imgURL;\n })",r.parseJSONSafe="const parseJSONSafe = json => {\n try return JSON.parse(json)\n catch return {}\n}",r._resolveKeyPath="const _resolveKeyPath = (obj, keyPath) => {\n const path = keyPath.matchAll(/(\\.|^)(?<key>[^.[]+)|\\[(?<litkey>(\\\\\\]|\\\\|[^]])+)\\]/g);\n let top = obj;\n let pre;\n let tok;\n let key;\n while (!(tok = path.next()).done) {\n key = tok.value.groups.key ?? tok.value.groups.litKey.replaceAll('\\\\\\\\', '\\\\').replaceAll('\\\\]', ']');\n pre = top;\n top = top?.get?.(key) ?? top?.[key];\n if (top === undefined) return [obj, keyPath];\n }\n return [pre, key];\n}",r.get="const get = (obj, keyPath) => {\n const [root, key] = _resolveKeyPath(obj, keyPath);\n return typeof root === 'undefined' \n ? '' \n : root.get?.(key) ?? root[key];\n}",r.set="const set = (obj, keyPath, val) => {\n const [root, key] = _resolveKeyPath(obj, keyPath);\n return typeof root === 'undefined' \n ? '' \n : root.set?.(key) ?? (root[key] = val);\n}",r.remove="const remove = (obj, keyPath) => {\n const [root, key] = _resolveKeyPath(obj, keyPath);\n return typeof root === 'undefined' \n ? '' \n : root.delete?.(key) ?? root.remove?.(key) ?? (delete root[key]);\n}",r.includes="const includes = (obj, keyPath) => {\n const [root, key] = _resolveKeyPath(obj, keyPath);\n return typeof root === 'undefined' \n ? '' \n : root.has?.(key) ?? (key in root);\n}";const o=A=>{n.thread=A,A.generator.next()},s=[];o.scopedEval=A=>{const e=(A=>{let e="let stuckCounter = 0;\nconst isStuck = () => {\n // The real time is not checked on every call for performance.\n stuckCounter++;\n if (stuckCounter === 100) {\n stuckCounter = 0;\n return globalState.thread.target.runtime.sequencer.timer.timeElapsed() > 500;\n }\n return false;\n};const isNotActuallyZero = val => {\n if (typeof val !== 'string') return false;\n for (let i = 0; i < val.length; i++) {\n const code = val.charCodeAt(i);\n if (code === 48 || code === 9) {\n return false;\n }\n }\n return true;\n};const compareEqualSlow = (v1, v2) => {\n const n1 = +v1;\n if (isNaN(n1) || (n1 === 0 && isNotActuallyZero(v1))) return ('' + v1).toLowerCase() === ('' + v2).toLowerCase();\n const n2 = +v2;\n if (isNaN(n2) || (n2 === 0 && isNotActuallyZero(v2))) return ('' + v1).toLowerCase() === ('' + v2).toLowerCase();\n return n1 === n2;\n};\nconst compareEqual = (v1, v2) => (typeof v1 === 'number' && typeof v2 === 'number' && !isNaN(v1) && !isNaN(v2) || v1 === v2) ? v1 === v2 : compareEqualSlow(v1, v2);const listIndexSlow = (index, length) => {\n if (index === 'last') {\n return length - 1;\n } else if (index === 'random' || index === 'any') {\n if (length > 0) {\n return (Math.random() * length) | 0;\n }\n return -1;\n }\n index = (+index || 0) | 0;\n if (index < 1 || index > length) {\n return -1;\n }\n return index - 1;\n};\nconst listIndex = (index, length) => {\n if (typeof index !== 'number') {\n return listIndexSlow(index, length);\n }\n index = index | 0;\n return index < 1 || index > length ? -1 : index - 1;\n};";for(const t of Object.keys(r))A.includes(t)&&(e+="".concat(r[t],";"));return e.includes("executeInCompatibilityLayer")&&!e.includes("const waitPromise")&&(e=e.replace("let hasResumedFromPromise = false;","let hasResumedFromPromise = false;\n".concat(r.waitPromise))),e.includes("_resolveKeyPath")&&!e.includes("const _resolveKeyPath")&&(e=r._resolveKeyPath+";"+e),e+="return ".concat(A),e})(A);try{return new Function("globalState",e)(n)}catch(A){throw n.log.error("was unable to compile script",e),console.log(A),A}},o.runtimeFunctions=r,o.saveGlobalState=()=>{s.push(n.thread)},o.restoreGlobalState=()=>{n.thread=s.pop()},o.globalState=n,A.exports=o},function(A,e,t){A.exports=t(327)},function(A,e,t){var n=t(44),i=t(26),r=t(37);t(12);function o(A){A=A||{},this.heuristic=A.heuristic||r.manhattan,this.trackJumpRecursion=A.trackJumpRecursion||!1}o.prototype.findPath=function(A,e,t,r,o){var s,a=this.openList=new n((function(A,e){return A.f-e.f})),B=this.startNode=o.getNodeAt(A,e),c=this.endNode=o.getNodeAt(t,r);for(this.grid=o,B.g=0,B.f=0,a.push(B),B.opened=!0;!a.empty();){if((s=a.pop()).closed=!0,s===c)return i.expandPath(i.backtrace(c));this._identifySuccessors(s)}return[]},o.prototype._identifySuccessors=function(A){var e,t,n,i,o,s,a,B,c,g,E=this.grid,Q=this.heuristic,u=this.openList,l=this.endNode.x,w=this.endNode.y,h=A.x,C=A.y,I=Math.abs;Math.max;for(i=0,o=(e=this._findNeighbors(A)).length;i<o;++i)if(t=e[i],n=this._jump(t[0],t[1],h,C)){if(s=n[0],a=n[1],(g=E.getNodeAt(s,a)).closed)continue;B=r.octile(I(s-h),I(a-C)),c=A.g+B,(!g.opened||c<g.g)&&(g.g=c,g.h=g.h||Q(I(s-l),I(a-w)),g.f=g.g+g.h,g.parent=A,g.opened?u.updateItem(g):(u.push(g),g.opened=!0))}},A.exports=o},function(A,e,t){(function(e){function n(A,e){var t=Object.keys(A);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(A);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(A,e).enumerable}))),t.push.apply(t,n)}return t}function i(A){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?n(Object(t),!0).forEach((function(e){r(A,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(t)):n(Object(t)).forEach((function(e){Object.defineProperty(A,e,Object.getOwnPropertyDescriptor(t,e))}))}return A}function r(A,e,t){return(e=function(A){var e=function(A,e){if("object"!=typeof A||!A)return A;var t=A[Symbol.toPrimitive];if(void 0!==t){var n=t.call(A,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(A)}(A,"string");return"symbol"==typeof e?e:e+""}(e))in A?Object.defineProperty(A,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):A[e]=t,A}const o=t(3),s=t(1),a=t(15),B=t(2),c=t(7),g=t(8),E=A=>{try{return new URL(A,location.href)}catch(A){return null}};class Q{constructor(A){this.limited=!0===A}get ArgumentType(){return o}get BlockType(){return s}get TargetType(){return a}get Cast(){return B}get Clone(){return c}get Color(){return g}get vm(){return vm}get renderer(){return Q.vm.runtime.renderer}async canFetch(A){if(this.limited){const e=E(A);return!!e&&("blob:"===e.protocol||e.protocol,!0)}return!0}async canOpenWindow(A){if(this.limited){const e=E(A);return!!e&&"javascript:"!==e.protocol}return!0}async canRedirect(A){if(this.limited){const e=E(A);return!!e&&"javascript:"!==e.protocol}return!0}async fetch(A,t){if(this.limited){const n=A instanceof Request?A.url:A;if(!await e.Scratch.canFetch(n))throw new Error("Permission to fetch ".concat(n," rejected."));return fetch(A,i(i({},t),{},{redirect:"error"}))}return fetch(A,i(i({},t),{},{redirect:"error"}))}async openWindow(A,t){if(this.limited){if(!await e.Scratch.canOpenWindow(A))throw new Error("Permission to open tab ".concat(A," rejected."));return window.open(A,"_blank",t)}return window.open(A,"_blank",t)}async redirect(A){if(this.limited){if(!await e.Scratch.canRedirect(A))throw new Error("Permission to redirect to ".concat(A," rejected."));location.href=A}else location.href=A}get extensions(){return{unsandboxed:!0,register:()=>{throw new Error("Register cannot be replicated in custom-ext-api-to-core")}}}}A.exports=Q}).call(this,t(14))},function(A,e,t){const n=t(9),i=t(24);class r{constructor(A,e,t,i,o,s,a){this.id=A||n(),this.text=e,this.x=t,this.y=i,this.width=Math.max(Number(o),r.MIN_WIDTH),this.height=Math.max(Number(s),r.MIN_HEIGHT),this.minimized=a||!1,this.blockId=null}toXML(){return'<comment id="'.concat(this.id,'" x="').concat(this.x,'" y="').concat(this.y,'" w="').concat(this.width,'" h="').concat(this.height,'" pinned="').concat(null!==this.blockId,'" minimized="').concat(this.minimized,'">').concat(i(this.text),"</comment>")}static get MIN_WIDTH(){return 20}static get MIN_HEIGHT(){return 20}static get DEFAULT_WIDTH(){return 100}static get DEFAULT_HEIGHT(){return 100}}A.exports=r},function(A,e,t){const n=t(10),i=t(5),r=function(A,e,t,n){return A.assetId=e.assetId,t.audioEngine?t.audioEngine.decodeSoundPlayer(Object.assign({},A,{data:e.data})).then(e=>{A.soundId=e.id;const i=e.buffer;return A.rate=i.sampleRate,A.sampleCount=i.length,null!==n&&n.addSoundPlayer(e),t.isPackaged&&(A.asset=null),A}):(i.warn("No audio engine present; cannot load sound asset: ",A.md5),Promise.resolve(A))},o=function(A,e,t){const n=A.asset,i=A.assetId,o=A.sampleCount,s=A.rate,a=A.format,B=A.dataFormat;return A.assetId=e.storage.defaultAssetId.Sound,A.asset=e.storage.get(A.assetId),A.md5="".concat(A.assetId,".").concat(A.asset.dataFormat),r(A,A.asset,e,t).then(A=>(A.broken={},A.broken.assetId=i,A.broken.md5="".concat(i,".").concat(B),A.broken.asset=n,A.broken.sampleCount=o,A.broken.rate=s,A.broken.format=a,A.broken.dataFormat=B,A))};A.exports={loadSound:function(A,e,t){if(!e.storage)return i.warn("No storage module present; cannot load sound asset: ",A.md5),Promise.resolve(A);const s=n.splitFirst(A.md5,"."),a=s[0],B=s[1].toLowerCase();return A.dataFormat=B,(A.asset&&Promise.resolve(A.asset)||e.storage.load(e.storage.AssetType.Sound,a,B)).then(n=>(A.asset=n,n?r(A,n,e,t):(i.warn("Failed to find sound data: ",A.md5),o(A,e,t)))).catch(n=>(i.warn("Failed to load sound: ".concat(A.md5," with error: ").concat(n)),o(A,e,t)))},loadSoundFromAsset:r}},function(A,e,t){const n=t(10),i=t(5),r=t(67),{loadSvgString:o,serializeSvgToString:s}=t(31),{parseVectorMetadata:a}=t(108),B=function(A,e,t,n){return new Promise(i=>{let r=A.asset.decodeText();if(void 0===t){const e=a(r);e&&(t=e,A.rotationCenterX=t[0],A.rotationCenterY=t[1])}if(n&&2===n){const t=s(o(r,!0));if(r!==t){r=t;const n=e.storage;A.asset.encodeTextData(t,n.DataFormat.SVG,!0),A.assetId=A.asset.assetId,A.md5="".concat(A.assetId,".").concat(A.dataFormat)}}A.skinId=e.renderer.createSVGSkin(r,t),A.size=e.renderer.getSkinSize(A.skinId),t||(t=e.renderer.getSkinRotationCenter(A.skinId),A.rotationCenterX=t[0],A.rotationCenterY=t[1],A.bitmapResolution=1),e.isPackaged&&(A.asset=null),i(A)})},c=new class{constructor(){this.pool=[],this.clearSoon=null}clear(){this.clearSoon||(this.clearSoon=new Promise(A=>setTimeout(A,1e3)).then(()=>{this.pool.length=0,this.clearSoon=null}))}create(){return this.pool.pop()||document.createElement("canvas")}release(A){this.clear(),this.pool.push(A)}},g=A=>new Promise((e,t)=>{const n=new Image;n.onload=function(){e(n),n.onload=null,n.onerror=null},n.onerror=function(){t(new Error("Costume load failed. Asset could not be read.")),n.onload=null,n.onerror=null},n.src=A}),E=new r(async A=>{let e;for(let t=0;t<3;t++)try{if("function"==typeof createImageBitmap){const e=await createImageBitmap(new Blob([A.data.buffer],{type:A.assetType.contentType}));if(!e)throw new Error("createImageBitmap resolved with ".concat(e));return e}return await g(A.encodeDataURI())}catch(A){e||(e=A),i.warn(A),await new Promise(A=>setTimeout(A,2e3*Math.random()))}throw e},25),Q=function(A,e,t){return function(A,e,t){return A&&A.asset?e.v2BitmapAdapter?Promise.all([A.asset,A.textLayerAsset].map(A=>A?E.do(A):null)).then(n=>{let[i,r]=n;if(!i)throw new Error("Loading bitmap costume base failed.");const o=1===A.bitmapResolution?2:1;let s,a;if(r){a=c.create(),a.width=i.width,a.height=i.height;const A=a.getContext("2d");A.drawImage(i,0,0),A.drawImage(r,0,0),s=a}else s=i;return 1!==o&&(s=e.v2BitmapAdapter.resize(s,s.width*o,s.height*o),a&&c.release(a)),s.reusable=!1,t&&(t[0]=t[0]*o,t[1]=t[1]*o,A.rotationCenterX=t[0],A.rotationCenterY=t[1]),A.bitmapResolution=2,delete A.textLayerMD5,delete A.textLayerAsset,{image:s,rotationCenter:t,assetMatchesBase:1===o&&!r}}).finally(()=>{delete A.textLayerMD5,delete A.textLayerAsset}):Promise.reject("No V2 Bitmap adapter present."):Promise.reject("Costume load failed. Assets were missing.")}(A,e,t).then(t=>(t.assetMatchesBase||function(t){if(!e.v2BitmapAdapter)return Promise.reject("No V2 Bitmap adapter present.");const n=e.storage;A.asset=n.createAsset(n.AssetType.ImageBitmap,n.DataFormat.PNG,e.v2BitmapAdapter.convertDataURIToBinary(t),null,!0),A.dataFormat=n.DataFormat.PNG,A.assetId=A.asset.assetId,A.md5="".concat(A.assetId,".").concat(A.dataFormat)}((A=>{if(A instanceof HTMLCanvasElement)return A.toDataURL();const e=c.create();e.width=A.width,e.height=A.height;e.getContext("2d").drawImage(A,0,0);const t=e.toDataURL();return c.release(e),t})(t.image)),t)).then(t=>{let n,{image:i,rotationCenter:r}=t;r&&(n=[r[0]/2,r[1]/2]),A.skinId=e.renderer.createBitmapSkin(i,A.bitmapResolution,n);const o=e.renderer.getSkinSize(A.skinId);return A.size=[2*o[0],2*o[1]],r||(r=e.renderer.getSkinRotationCenter(A.skinId),A.rotationCenterX=2*r[0],A.rotationCenterY=2*r[1],A.bitmapResolution=2),e.isPackaged&&(A.asset=null),A})},u=function(A,e){const t=A.asset,n=A.assetId,i=A.rotationCenterX,r=A.rotationCenterY,o=A.bitmapResolution,s=A.dataFormat,a=e.storage.AssetType,c=A.dataFormat===a.ImageVector.runtimeFormat;A.assetId=c?e.storage.defaultAssetId.ImageVector:e.storage.defaultAssetId.ImageBitmap,A.asset=e.storage.get(A.assetId),A.md5="".concat(A.assetId,".").concat(A.asset.dataFormat);return(c?B(A,e):Q(A,e)).then(A=>(A.broken={},A.broken.assetId=n,A.broken.md5="".concat(n,".").concat(s),A.broken.asset=t,A.broken.dataFormat=s,A.broken.rotationCenterX=i,A.broken.rotationCenterY=r,A.broken.bitmapResolution=o,A))},l=function(A,e,t){A.assetId=A.asset.assetId;if(!e.renderer)return i.warn("No rendering module present; cannot load costume: ",A.name),Promise.resolve(A);const n=e.storage.AssetType;let r;return"number"!=typeof A.rotationCenterX||isNaN(A.rotationCenterX)||"number"!=typeof A.rotationCenterY||isNaN(A.rotationCenterY)||(r=[A.rotationCenterX,A.rotationCenterY]),A.asset.assetType.runtimeFormat===n.ImageVector.runtimeFormat?B(A,e,r,t).catch(t=>(i.warn("Error loading vector image: ".concat(t)),u(A,e))):Q(A,e,r).catch(t=>(i.warn("Error loading bitmap image: ".concat(t)),u(A,e)))};A.exports={loadCostume:function(A,e,t,r){const o=n.splitFirst(A,"."),s=o[0],a=o[1].toLowerCase();if(e.dataFormat=a,e.asset)return l(e,t,r);if(!t.storage)return i.warn("No storage module present; cannot load costume asset: ",A),Promise.resolve(e);if(!t.storage.defaultAssetId)return i.warn("No default assets found"),Promise.resolve(e);const B=t.storage.AssetType,c="svg"===a?B.ImageVector:B.ImageBitmap,g=t.storage.load(c,s,a);let E;return E=e.textLayerMD5?t.storage.load(B.ImageBitmap,e.textLayerMD5,"png"):Promise.resolve(null),Promise.all([g,E]).then(A=>A[0]?(e.asset=A[0],A[1]&&(e.textLayerAsset=A[1]),l(e,t,r)):u(e,t)).catch(A=>(i.warn("Error loading costume: ",A),u(e,t)))},loadCostumeFromAsset:l}},function(A,e){A.exports={ID_NONE:-1,Events:{UseHighQualityRenderChanged:"UseHighQualityRenderChanged",AllowPrivateSkinAccessChanged:"AllowPrivateSkinAccessChanged",NativeSizeChanged:"NativeSizeChanged"}}},function(A,e,t){const n=t(53);n.enable(),A.exports=n("scratch-audioengine")},,function(A,e,t){var n=t(133),i=n.enable,r=n.disable,o="undefined"!=typeof navigator&&/chrome/i.test(navigator.userAgent),s=t(136);if(n.defaultBackend=o?s.minilog:s,"undefined"!=typeof window){try{n.enable(JSON.parse(window.localStorage.minilogSettings))}catch(A){}if(window.location&&window.location.search){var a=RegExp("[?&]minilog=([^&]*)").exec(window.location.search);a&&n.enable(decodeURIComponent(a[1]))}}n.enable=function(){i.call(n,!0);try{window.localStorage.minilogSettings=JSON.stringify(!0)}catch(A){}return this},n.disable=function(){r.call(n);try{delete window.localStorage.minilogSettings}catch(A){}return this},(A.exports=n).backends={array:t(139),browser:n.defaultBackend,localStorage:t(140),jQuery:t(141)}},function(A,e){A.exports=class{constructor(){this._requestID=0,this._openRequests={}}sendRemoteRequest(A,e){const t=this._requestID++,n=new Promise((A,e)=>{this._openRequests[t]={resolve:A,reject:e}});return this._sendRequest(A,e,t),n}sendRemoteNotification(A,e){this._sendRequest(A,e)}didReceiveCall(){throw new Error("Must override didReceiveCall")}_sendMessage(){throw new Error("Must override _sendMessage")}_sendRequest(A,e,t){const n={jsonrpc:"2.0",method:A,params:e};null!==t&&(n.id=t),this._sendMessage(n)}_handleMessage(A){if("2.0"!==A.jsonrpc)throw new Error("Bad or missing JSON-RPC version in message: ".concat(A));A.hasOwnProperty("method")?this._handleRequest(A):this._handleResponse(A)}_sendResponse(A,e,t){const n={jsonrpc:"2.0",id:A};t?n.error=t:n.result=e||null,this._sendMessage(n)}_handleResponse(A){const{result:e,error:t,id:n}=A,i=this._openRequests[n];delete this._openRequests[n],i&&(t?i.reject(t):i.resolve(e))}_handleRequest(A){const{method:e,params:t,id:n}=A,i=this.didReceiveCall(e,t);n&&Promise.resolve(i).then(A=>{this._sendResponse(n,A)},A=>{this._sendResponse(n,null,A)})}}},function(A,e,t){const n=t(18);A.exports=class{constructor(A){this._maxTokens=A,this._refillInterval=1e3/A,this._count=this._maxTokens,this._timer=new n,this._timer.start(),this._lastUpdateTime=this._timer.timeElapsed()}okayToSend(){const A=this._timer.timeElapsed(),e=A-this._lastUpdateTime,t=Math.floor(e/this._refillInterval);return t>0&&(this._lastUpdateTime=A),this._count=Math.min(this._maxTokens,this._count+t),this._count>0&&(this._count--,!0)}}},function(A,e){A.exports=(A,e,t)=>{let n=null;const i=window.AbortController?new window.AbortController:null,r=i?i.signal:null;return Promise.race([fetch(A,Object.assign({signal:r},e)).then(A=>(clearTimeout(n),A)),new Promise((A,e)=>{n=setTimeout(()=>{i&&i.abort(),e(new Error("Fetch timed out after ".concat(t," ms")))},t)})])}},function(A,e,t){const{Record:n}=t(34),i=n({id:null,spriteName:null,targetId:null,opcode:null,value:null,params:null,mode:"default",sliderMin:0,sliderMax:100,isDiscrete:!0,x:null,y:null,width:0,height:0,visible:!0,variableId:null,variableType:null});A.exports=i},function(A,e,t){function n(A,e,t){return(e=function(A){var e=function(A,e){if("object"!=typeof A||!A)return A;var t=A[Symbol.toPrimitive];if(void 0!==t){var n=t.call(A,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(A)}(A,"string");return"symbol"==typeof e?e:e+""}(e))in A?Object.defineProperty(A,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):A[e]=t,A}const i=t(2),r=t(10),o=t(1),s=(t(96),t(59)),a=(t(19),t(8),t(5)),B=t(7),{IntermediateScript:c,IntermediateRepresentation:g}=t(97),E=t(221),Q=(A,e)=>({scope:A,id:e.id,name:e.name,isCloud:e.isCloud}),u=(A,e)=>e?"W".concat(A):"Z".concat(A),l=A=>A.substring(1);class w{constructor(A){this.thread=A,this.target=A.target,this.blocks=A.blockContainer,this.runtime=this.target.runtime,this.stage=this.runtime.getTargetForStage(),this.util=new s(this.runtime.sequencer,this.thread),this.script=new c,this.script.warpTimer=this.target.runtime.compilerOptions.warpTimer,this.script.isOptimized=this.target.runtime.runtimeOptions.dangerousOptimizations,this.script.optimizationUtil=this.target.runtime.optimizationUtil,this.variableCache={},this.usesTimer=!1}setProcedureVariant(A){const e=l(A);this.script.procedureCode=e,this.script.isProcedure=!0,this.script.yields=!1;const t=this.blocks.getProcedureParamNamesIdsAndDefaults(e);if(null===t)throw new Error("IR: cannot find procedure: ".concat(A));const[n,i,r]=t;this.script.arguments=n}enableWarp(){this.script.isWarp=!0}getBlockById(A){return this.blocks.getBlock(A)||this.blocks.runtime.flyoutBlocks.getBlock(A)}getBlockInfo(A){const[e,t]=r.splitFirst(A,"_");if(!e||!t)return null;const n=this.runtime._blockInfo.find(A=>A.id===e);if(!n)return null;const i=n.blocks.find(A=>A.info.opcode===t);return i||null}descendInputOfBlock(A,e){const t=A.inputs[e];if(!t)return a.warn("IR: ".concat(A.opcode,": missing input ").concat(e),A),{kind:"constant",value:0};const n=t.block,i=this.getBlockById(n);return i?this.descendInput(i):(a.warn("IR: ".concat(A.opcode,": could not find input ").concat(e," with ID ").concat(n)),{kind:"constant",value:0})}descendInput(A){const e=String(A.opcode).split("_")[0],t=String(A.opcode).replace(e+"_","");if(h.hasExtensionIr(e)&&h.getExtensionIr(e)[t]){const n=h.getExtensionIr(e)[t];let i=null;try{i=n(this,A)}catch(A){a.warn(e+"_"+t,"failed to create IR data;",A)}if(i&&"input"===i.kind)return i.kind=e+"."+t,i}switch(A.opcode){case"colour_picker":return{kind:"constant",value:A.fields.COLOUR.value};case"math_angle":case"math_integer":case"math_number":case"math_positive_number":case"math_whole_number":return{kind:"constant",value:A.fields.NUM.value};case"text":return{kind:"constant",value:A.fields.TEXT.value};case"checkbox":return{kind:"constant",value:"TRUE"==A.fields.CHECKBOX.value};case"polygon":const e=[];for(let t=1;t<=A.mutation.points;t++){const n="x".concat(t),i="y".concat(t);e.push({x:this.descendInputOfBlock(A,n),y:this.descendInputOfBlock(A,i)})}return{kind:"math.polygon",points:e};case"argument_reporter_string_number":{const e=A.fields.VALUE.value,t=this.script.arguments.lastIndexOf(e);return-1===t&&"last key pressed"===e.toLowerCase()?{kind:"tw.lastKeyPressed"}:-1===t?{kind:"constant",value:0}:{kind:"args.stringNumber",index:t}}case"argument_reporter_boolean":{const e=A.fields.VALUE.value,t=this.script.arguments.lastIndexOf(e);if(-1===t){const A=e.toLowerCase();return{kind:"constant",value:"is compiled?"===A||"is penguinmod?"===A||"is penguinmod or turbowarp?"===A}}return{kind:"args.boolean",index:t}}case"control_get_counter":return{kind:"counter.get"};case"control_error":return{kind:"control.error"};case"control_is_clone":return{kind:"control.isclone"};case"data_variable":return{kind:"var.get",variable:this.descendVariable(A,"VARIABLE","")};case"data_itemoflist":return{kind:"list.get",list:this.descendVariable(A,"LIST","list"),index:this.descendInputOfBlock(A,"INDEX")};case"data_lengthoflist":return{kind:"list.length",list:this.descendVariable(A,"LIST","list")};case"data_listcontainsitem":return{kind:"list.contains",list:this.descendVariable(A,"LIST","list"),item:this.descendInputOfBlock(A,"ITEM")};case"data_itemnumoflist":return{kind:"list.indexOf",list:this.descendVariable(A,"LIST","list"),item:this.descendInputOfBlock(A,"ITEM")};case"data_amountinlist":return{kind:"list.amountOf",list:this.descendVariable(A,"LIST","list"),value:this.descendInputOfBlock(A,"VALUE")};case"data_listcontents":return{kind:"list.contents",list:this.descendVariable(A,"LIST","list")};case"data_filterlistitem":return{kind:"list.filteritem"};case"data_filterlistindex":return{kind:"list.filterindex"};case"event_broadcast_menu":{const e=A.fields.BROADCAST_OPTION,t=this.target.lookupBroadcastMsg(e.id,e.value);return{kind:"constant",value:t?t.name:""}}case"pmEventsExpansion_broadcastFunction":return this.script.yields=!0,{kind:"pmEventsExpansion.broadcastFunction",broadcast:this.descendInputOfBlock(A,"BROADCAST")};case"pmEventsExpansion_broadcastFunctionArgs":return this.script.yields=!0,{kind:"pmEventsExpansion.broadcastFunctionArgs",broadcast:this.descendInputOfBlock(A,"BROADCAST"),args:this.descendInputOfBlock(A,"ARGS")};case"control_inline_stack_output":return{kind:"control.inlineStackOutput",code:this.descendSubstack(A,"SUBSTACK")};case"looks_backdropnumbername":return"number"===A.fields.NUMBER_NAME.value?{kind:"looks.backdropNumber"}:{kind:"looks.backdropName"};case"looks_costumenumbername":return"number"===A.fields.NUMBER_NAME.value?{kind:"looks.costumeNumber"}:{kind:"looks.costumeName"};case"looks_size":return{kind:"looks.size"};case"looks_tintColor":return{kind:"looks.tintColor"};case"motion_direction":return{kind:"motion.direction"};case"motion_xposition":return{kind:"motion.x"};case"motion_yposition":return{kind:"motion.y"};case"operator_add":return{kind:"op.add",left:this.descendInputOfBlock(A,"NUM1"),right:this.descendInputOfBlock(A,"NUM2")};case"operator_and":return{kind:"op.and",left:this.descendInputOfBlock(A,"OPERAND1"),right:this.descendInputOfBlock(A,"OPERAND2")};case"operator_contains":return{kind:"op.contains",string:this.descendInputOfBlock(A,"STRING1"),contains:this.descendInputOfBlock(A,"STRING2")};case"operator_divide":return{kind:"op.divide",left:this.descendInputOfBlock(A,"NUM1"),right:this.descendInputOfBlock(A,"NUM2")};case"operator_power":return{kind:"op.power",left:this.descendInputOfBlock(A,"NUM1"),right:this.descendInputOfBlock(A,"NUM2")};case"operator_expandableMath":{const e=A.mutation.menuvalues,t=Object.values(A.inputs),i=[];for(var n=0;n<t.length;n++){const r=t[n];null==r.block?delete A.inputs[r.name]:i.push([this.descendInputOfBlock(A,r.name),e[n]])}return{kind:"op.expandmath",operations:i}}case"operator_equals":return{kind:"op.equals",left:this.descendInputOfBlock(A,"OPERAND1"),right:this.descendInputOfBlock(A,"OPERAND2")};case"operator_gt":return{kind:"op.greater",left:this.descendInputOfBlock(A,"OPERAND1"),right:this.descendInputOfBlock(A,"OPERAND2")};case"operator_join":return{kind:"op.join",left:this.descendInputOfBlock(A,"STRING1"),right:this.descendInputOfBlock(A,"STRING2")};case"operators_expandablejoininputs":{const e=[];for(const t of Object.values(A.inputs))null==t.block?delete A.inputs[t.name]:e.push(this.descendInputOfBlock(A,t.name));return{kind:"op.expandjoin",strings:e}}case"operator_length":return{kind:"op.length",string:this.descendInputOfBlock(A,"STRING")};case"operator_letter_of":return{kind:"op.letterOf",letter:this.descendInputOfBlock(A,"LETTER"),string:this.descendInputOfBlock(A,"STRING")};case"operator_lt":return{kind:"op.less",left:this.descendInputOfBlock(A,"OPERAND1"),right:this.descendInputOfBlock(A,"OPERAND2")};case"operator_mathop":{const e=this.descendInputOfBlock(A,"NUM");switch(A.fields.OPERATOR.value.toLowerCase()){case"abs":return{kind:"op.abs",value:e};case"floor":return{kind:"op.floor",value:e};case"ceiling":return{kind:"op.ceiling",value:e};case"sign":return{kind:"op.sign",value:e};case"sqrt":return{kind:"op.sqrt",value:e};case"sin":return{kind:"op.sin",value:e};case"cos":return{kind:"op.cos",value:e};case"tan":return{kind:"op.tan",value:e};case"asin":return{kind:"op.asin",value:e};case"acos":return{kind:"op.acos",value:e};case"atan":return{kind:"op.atan",value:e};case"ln":return{kind:"op.ln",value:e};case"log":return{kind:"op.log",value:e};case"log2":return{kind:"op.log2",value:e};case"e ^":return{kind:"op.e^",value:e};case"10 ^":return{kind:"op.10^",value:e};default:return{kind:"constant",value:0}}}case"operator_advlog":return{kind:"op.advlog",left:this.descendInputOfBlock(A,"NUM1"),right:this.descendInputOfBlock(A,"NUM2")};case"operator_mod":return{kind:"op.mod",left:this.descendInputOfBlock(A,"NUM1"),right:this.descendInputOfBlock(A,"NUM2")};case"operator_multiply":return{kind:"op.multiply",left:this.descendInputOfBlock(A,"NUM1"),right:this.descendInputOfBlock(A,"NUM2")};case"operator_not":return{kind:"op.not",operand:this.descendInputOfBlock(A,"OPERAND")};case"operator_or":return{kind:"op.or",left:this.descendInputOfBlock(A,"OPERAND1"),right:this.descendInputOfBlock(A,"OPERAND2")};case"operator_random":{const e=this.descendInputOfBlock(A,"FROM"),t=this.descendInputOfBlock(A,"TO");if("constant"===e.kind&&"constant"===t.kind){const A=e.value,n=t.value,r=i.toNumber(A),o=i.toNumber(n);return r===o?{kind:"constant",value:r}:i.isInt(A)&&i.isInt(n)?{kind:"op.random",low:r<=o?e:t,high:r<=o?t:e,useInts:!0,useFloats:!1}:{kind:"op.random",low:r<=o?e:t,high:r<=o?t:e,useInts:!1,useFloats:!0}}if("constant"===e.kind){if(!i.isInt(i.toNumber(e.value)))return{kind:"op.random",low:e,high:t,useInts:!1,useFloats:!0}}else if("constant"===t.kind&&!i.isInt(i.toNumber(t.value)))return{kind:"op.random",low:e,high:t,useInts:!1,useFloats:!0};return{kind:"op.random",low:e,high:t,useInts:!1,useFloats:!1}}case"operator_round":return{kind:"op.round",value:this.descendInputOfBlock(A,"NUM")};case"operator_subtract":return{kind:"op.subtract",left:this.descendInputOfBlock(A,"NUM1"),right:this.descendInputOfBlock(A,"NUM2")};case"sensing_answer":return{kind:"sensing.answer"};case"sensing_coloristouchingcolor":return{kind:"sensing.colorTouchingColor",target:this.descendInputOfBlock(A,"COLOR2"),mask:this.descendInputOfBlock(A,"COLOR")};case"sensing_current":switch(A.fields.CURRENTMENU.value.toLowerCase()){case"year":return{kind:"sensing.year"};case"month":return{kind:"sensing.month"};case"date":return{kind:"sensing.date"};case"dayofweek":return{kind:"sensing.dayofweek"};case"hour":return{kind:"sensing.hour"};case"minute":return{kind:"sensing.minute"};case"second":return{kind:"sensing.second"};case"timestamp":return{kind:"sensing.timestamp"}}return{kind:"constant",value:0};case"sensing_dayssince2000":return{kind:"sensing.daysSince2000"};case"sensing_distanceto":return{kind:"sensing.distance",target:this.descendInputOfBlock(A,"DISTANCETOMENU")};case"sensing_keypressed":return{kind:"keyboard.pressed",key:this.descendInputOfBlock(A,"KEY_OPTION")};case"sensing_mousedown":return{kind:"mouse.down"};case"sensing_mousex":return{kind:"mouse.x"};case"sensing_mousey":return{kind:"mouse.y"};case"sensing_of":return{kind:"sensing.of",property:A.fields.PROPERTY.value,object:this.descendInputOfBlock(A,"OBJECT")};case"sensing_timer":return this.usesTimer=!0,{kind:"timer.get"};case"sensing_touchingcolor":return{kind:"sensing.touchingColor",color:this.descendInputOfBlock(A,"COLOR")};case"sensing_touchingobject":return{kind:"sensing.touching",object:this.descendInputOfBlock(A,"TOUCHINGOBJECTMENU")};case"sensing_username":return{kind:"sensing.username"};case"sensing_loggedin":return{kind:"sensing.loggedin"};case"operator_trueBoolean":return{kind:"op.true"};case"operator_falseBoolean":return{kind:"op.false"};case"operator_randomBoolean":return{kind:"op.randbool"};case"sound_sounds_menu":return{kind:"constant",value:A.fields.SOUND_MENU.value};case"lmsTempVars2_getRuntimeVariable":return{kind:"tempVars.get",var:this.descendInputOfBlock(A,"VAR"),runtime:!0};case"lmsTempVars2_getThreadVariable":return{kind:"tempVars.get",var:this.descendInputOfBlock(A,"VAR"),thread:!0};case"tempVars_getVariable":return{kind:"tempVars.get",var:this.descendInputOfBlock(A,"name")};case"lmsTempVars2_runtimeVariableExists":return{kind:"tempVars.exists",var:this.descendInputOfBlock(A,"VAR"),runtime:!0};case"lmsTempVars2_threadVariableExists":return{kind:"tempVars.exists",var:this.descendInputOfBlock(A,"VAR"),thread:!0};case"tempVars_variableExists":return{kind:"tempVars.exists",var:this.descendInputOfBlock(A,"name")};case"lmsTempVars2_listRuntimeVariables":return{kind:"tempVars.all",runtime:!0};case"lmsTempVars2_listThreadVariables":return{kind:"tempVars.all",thread:!0};case"tempVars_allVariables":return{kind:"tempVars.all"};case"procedures_call_return":case"procedures_call":{const e=A.mutation.proccode;if("tw:debugger;"===e)return{kind:"tw.debugger"};const t=this.blocks.getProcedureParamNamesIdsAndDefaults(e);if(null===t)return{kind:"noop"};const[n,i,r]=t;if(this.runtime.getAddonBlock(e)){this.script.yields=!0;const t={};for(let e=0;e<i.length;e++){let o;o=A.inputs[i[e]]&&A.inputs[i[e]].block?this.descendInputOfBlock(A,i[e]):{kind:"constant",value:r[e]},t[n[e]]=o}return{kind:"addons.call",code:e,arguments:t,blockId:A.id}}const o=this.blocks.getProcedureDefinition(e),s=this.blocks.getBlock(o);if(!s)return{kind:"noop"};const a=this.blocks.getBlock(s.inputs.custom_block.block);let B=this.script.isWarp;if(!B&&a&&a.mutation){const A=a.mutation.warp;"boolean"==typeof A?B=A:"string"==typeof A&&(B=JSON.parse(A))}const c=u(e,B);this.script.dependedProcedures.includes(c)||this.script.dependedProcedures.push(c),this.script.isWarp||e===this.script.procedureCode&&(this.script.yields=!0);const g=[];for(let e=0;e<i.length;e++){let t;t=A.inputs[i[e]]&&A.inputs[i[e]].block?i[e].startsWith("SUBSTACK")?this.descendSubstack(A,i[e]):this.descendInputOfBlock(A,i[e]):{kind:"constant",value:r[e]},g.push(t)}return{kind:"procedures.call",code:e,variant:c,returns:!0,arguments:g,type:JSON.parse(A.mutation.opType||'"string"')}}case"tw_getLastKeyPressed":return{kind:"tw.lastKeyPressed"};case"control_dualblock":return{kind:"control.dualBlock"};default:{if(this.runtime.getOpcodeFunction(A.opcode)){if(E.outputBlocks.includes(A.opcode))return this.descendCompatLayer(A);const e=this.getBlockInfo(A.opcode);if(e){const t=e.info.blockType,n=this.descendCompatLayer(A);if(n.block=A,A.mutation&&(n.mutation=A.mutation),t===o.REPORTER||t===o.BOOLEAN)return n}}const e=Object.keys(A.inputs),t=Object.keys(A.fields);if(0===e.length&&1===t.length)return{kind:"constant",value:A.fields[t[0]].value};throw a.warn("IR: Unknown input: ".concat(A.opcode),A),new Error("IR: Unknown input: ".concat(A.opcode))}}}descendStackedBlock(A){const e=String(A.opcode).split("_")[0],t=String(A.opcode).replace(e+"_","");if(h.hasExtensionIr(e)&&h.getExtensionIr(e)[t]){const n=h.getExtensionIr(e)[t];let i=null;try{i=n(this,A)}catch(A){a.warn(e+"_"+t,"failed to create IR data;",A)}if(i&&"stack"===i.kind)return i.kind=e+"."+t,i}switch(A.opcode){case"your_mom":return{kind:"your mom"};case"control_switch":return{kind:"control.switch",test:this.descendInputOfBlock(A,"CONDITION"),conditions:this.descendSubstack(A,"SUBSTACK"),default:[]};case"control_switch_default":return{kind:"control.switch",test:this.descendInputOfBlock(A,"CONDITION"),conditions:this.descendSubstack(A,"SUBSTACK1"),default:this.descendSubstack(A,"SUBSTACK2")};case"control_case_next":return{kind:"control.case",condition:this.descendInputOfBlock(A,"CONDITION"),code:this.descendSubstack(A,"SUBSTACK"),runsNext:!0};case"control_case":return{kind:"control.case",condition:this.descendInputOfBlock(A,"CONDITION"),code:this.descendSubstack(A,"SUBSTACK"),runsNext:!1};case"control_exitCase":return{kind:"control.exitCase"};case"control_exitLoop":return{kind:"control.exitLoop"};case"control_continueLoop":return{kind:"control.continueLoop"};case"control_all_at_once":return{kind:"control.allAtOnce",condition:{kind:"constant",value:!0},code:this.descendSubstack(A,"SUBSTACK")};case"control_clear_counter":return{kind:"counter.clear"};case"control_create_clone_of":return{kind:"control.createClone",target:this.descendInputOfBlock(A,"CLONE_OPTION")};case"control_delete_this_clone":return this.script.yields=!0,{kind:"control.deleteClone"};case"control_forever":return this.analyzeLoop(),{kind:"control.while",condition:{kind:"constant",value:!0},do:this.descendSubstack(A,"SUBSTACK")};case"control_for_each":return this.analyzeLoop(),{kind:"control.for",variable:this.descendVariable(A,"VARIABLE",""),count:this.descendInputOfBlock(A,"VALUE"),do:this.descendSubstack(A,"SUBSTACK")};case"control_if":return{kind:"control.if",condition:this.descendInputOfBlock(A,"CONDITION"),whenTrue:this.descendSubstack(A,"SUBSTACK"),whenFalse:[]};case"control_if_else":return{kind:"control.if",condition:this.descendInputOfBlock(A,"CONDITION"),whenTrue:this.descendSubstack(A,"SUBSTACK"),whenFalse:this.descendSubstack(A,"SUBSTACK2")};case"control_try_catch":return{kind:"control.trycatch",try:this.descendSubstack(A,"SUBSTACK"),catch:this.descendSubstack(A,"SUBSTACK2")};case"control_throw_error":return{kind:"control.throwError",error:this.descendInputOfBlock(A,"ERROR")};case"control_incr_counter":return{kind:"counter.increment"};case"control_decr_counter":return{kind:"counter.decrement"};case"control_set_counter":return{kind:"counter.set",value:this.descendInputOfBlock(A,"VALUE")};case"control_repeat":return this.analyzeLoop(),{kind:"control.repeat",times:this.descendInputOfBlock(A,"TIMES"),do:this.descendSubstack(A,"SUBSTACK")};case"control_repeatForSeconds":return this.analyzeLoop(),{kind:"control.repeatForSeconds",times:this.descendInputOfBlock(A,"TIMES"),do:this.descendSubstack(A,"SUBSTACK")};case"control_repeat_until":{this.analyzeLoop(),this.usesTimer=!1;const e=this.descendInputOfBlock(A,"CONDITION"),t=this.usesTimer;return t&&(this.script.yields=!0),{kind:"control.while",condition:{kind:"op.not",operand:e},do:this.descendSubstack(A,"SUBSTACK"),warpTimer:t}}case"control_stop":{const e=A.fields.STOP_OPTION.value;return"all"===e?(this.script.yields=!0,{kind:"control.stopAll"}):"other scripts in sprite"===e||"other scripts in stage"===e?{kind:"control.stopOthers"}:"this script"===e?{kind:"control.stopScript"}:{kind:"noop"}}case"control_wait":return this.script.yields=!0,{kind:"control.wait",seconds:this.descendInputOfBlock(A,"DURATION")};case"control_waittick":return this.script.yields=!0,{kind:"control.waitTick"};case"control_wait_until":return this.script.yields=!0,{kind:"control.waitUntil",condition:this.descendInputOfBlock(A,"CONDITION")};case"control_waitsecondsoruntil":return this.script.yields=!0,{kind:"control.waitOrUntil",seconds:this.descendInputOfBlock(A,"DURATION"),condition:this.descendInputOfBlock(A,"CONDITION")};case"control_while":return this.analyzeLoop(),{kind:"control.while",condition:this.descendInputOfBlock(A,"CONDITION"),do:this.descendSubstack(A,"SUBSTACK"),warpTimer:!1};case"control_run_as_sprite":return{kind:"control.runAsSprite",sprite:this.descendInputOfBlock(A,"RUN_AS_OPTION"),substack:this.descendSubstack(A,"SUBSTACK")};case"control_new_script":return{kind:"control.newScript",substack:this.descendSubstack(A,"SUBSTACK")};case"data_addtolist":return{kind:"list.add",list:this.descendVariable(A,"LIST","list"),item:this.descendInputOfBlock(A,"ITEM")};case"data_changevariableby":{const e=this.descendVariable(A,"VARIABLE","");return{kind:"var.set",variable:e,value:{kind:"op.add",left:{kind:"var.get",variable:e},right:this.descendInputOfBlock(A,"VALUE")}}}case"data_deletealloflist":return{kind:"list.deleteAll",list:this.descendVariable(A,"LIST","list")};case"data_listforeachnum":return this.analyzeLoop(),{kind:"list.forEach",num:!0,list:this.descendVariable(A,"LIST","list"),variable:this.descendVariable(A,"VARIABLE",""),do:this.descendSubstack(A,"SUBSTACK")};case"data_listforeachitem":return this.analyzeLoop(),{kind:"list.forEach",num:!1,list:this.descendVariable(A,"LIST","list"),variable:this.descendVariable(A,"VARIABLE",""),do:this.descendSubstack(A,"SUBSTACK")};case"data_deleteoflist":{const e=this.descendInputOfBlock(A,"INDEX");return"constant"===e.kind&&"all"===e.value?{kind:"list.deleteAll",list:this.descendVariable(A,"LIST","list")}:{kind:"list.delete",list:this.descendVariable(A,"LIST","list"),index:e}}case"data_shiftlist":return{kind:"list.shift",list:this.descendVariable(A,"LIST","list"),index:this.descendInputOfBlock(A,"INDEX")};case"data_hidelist":return{kind:"list.hide",list:this.descendVariable(A,"LIST","list")};case"data_hidevariable":return{kind:"var.hide",variable:this.descendVariable(A,"VARIABLE","")};case"data_insertatlist":return{kind:"list.insert",list:this.descendVariable(A,"LIST","list"),index:this.descendInputOfBlock(A,"INDEX"),item:this.descendInputOfBlock(A,"ITEM")};case"data_replaceitemoflist":return{kind:"list.replace",list:this.descendVariable(A,"LIST","list"),index:this.descendInputOfBlock(A,"INDEX"),item:this.descendInputOfBlock(A,"ITEM")};case"data_setvariableto":return{kind:"var.set",variable:this.descendVariable(A,"VARIABLE",""),value:this.descendInputOfBlock(A,"VALUE")};case"data_showlist":return{kind:"list.show",list:this.descendVariable(A,"LIST","list")};case"data_showvariable":return{kind:"var.show",variable:this.descendVariable(A,"VARIABLE","")};case"data_filterlist":return{kind:"list.filter",list:this.descendVariable(A,"LIST","list"),bool:this.descendInputOfBlock(A,"BOOL")};case"event_broadcast":return{kind:"event.broadcast",broadcast:this.descendInputOfBlock(A,"BROADCAST_INPUT")};case"event_broadcastandwait":return this.script.yields=!0,{kind:"event.broadcastAndWait",broadcast:this.descendInputOfBlock(A,"BROADCAST_INPUT")};case"looks_changeeffectby":return{kind:"looks.changeEffect",effect:A.fields.EFFECT.value.toLowerCase(),value:this.descendInputOfBlock(A,"CHANGE")};case"looks_changesizeby":return{kind:"looks.changeSize",size:this.descendInputOfBlock(A,"CHANGE")};case"looks_cleargraphiceffects":return{kind:"looks.clearEffects"};case"looks_goforwardbackwardlayers":return"forward"===A.fields.FORWARD_BACKWARD.value?{kind:"looks.forwardLayers",layers:this.descendInputOfBlock(A,"NUM")}:{kind:"looks.backwardLayers",layers:this.descendInputOfBlock(A,"NUM")};case"looks_goTargetLayer":return"infront"===A.fields.FORWARD_BACKWARD.value?{kind:"looks.targetFront",layers:this.descendInputOfBlock(A,"VISIBLE_OPTION")}:{kind:"looks.targetBack",layers:this.descendInputOfBlock(A,"VISIBLE_OPTION")};case"looks_gotofrontback":return"front"===A.fields.FRONT_BACK.value?{kind:"looks.goToFront"}:{kind:"looks.goToBack"};case"looks_hide":return{kind:"looks.hide"};case"looks_nextbackdrop":return{kind:"looks.nextBackdrop"};case"looks_nextcostume":return{kind:"looks.nextCostume"};case"looks_seteffectto":return{kind:"looks.setEffect",effect:A.fields.EFFECT.value.toLowerCase(),value:this.descendInputOfBlock(A,"VALUE")};case"looks_setsizeto":return{kind:"looks.setSize",size:this.descendInputOfBlock(A,"SIZE")};case"looks_setFont":return{kind:"looks.setFont",font:this.descendInputOfBlock(A,"font"),size:this.descendInputOfBlock(A,"size")};case"looks_setColor":return{kind:"looks.setColor",prop:A.fields.prop.value,color:this.descendInputOfBlock(A,"color")};case"looks_setTintColor":return{kind:"looks.setTintColor",color:this.descendInputOfBlock(A,"color")};case"looks_setShape":return{kind:"looks.setShape",prop:A.fields.prop.value,value:this.descendInputOfBlock(A,"color")};case"looks_show":return{kind:"looks.show"};case"looks_switchbackdropto":return{kind:"looks.switchBackdrop",backdrop:this.descendInputOfBlock(A,"BACKDROP")};case"looks_switchcostumeto":return{kind:"looks.switchCostume",costume:this.descendInputOfBlock(A,"COSTUME")};case"motion_changexby":return{kind:"motion.changeX",dx:this.descendInputOfBlock(A,"DX")};case"motion_changeyby":return{kind:"motion.changeY",dy:this.descendInputOfBlock(A,"DY")};case"motion_gotoxy":return{kind:"motion.setXY",x:this.descendInputOfBlock(A,"X"),y:this.descendInputOfBlock(A,"Y")};case"motion_ifonedgebounce":return{kind:"motion.ifOnEdgeBounce"};case"motion_movesteps":return{kind:"motion.step",steps:this.descendInputOfBlock(A,"STEPS")};case"motion_pointindirection":return{kind:"motion.setDirection",direction:this.descendInputOfBlock(A,"DIRECTION")};case"motion_setrotationstyle":return{kind:"motion.setRotationStyle",style:A.fields.STYLE.value};case"motion_setx":return{kind:"motion.setX",x:this.descendInputOfBlock(A,"X")};case"motion_sety":return{kind:"motion.setY",y:this.descendInputOfBlock(A,"Y")};case"motion_turnleft":return{kind:"motion.setDirection",direction:{kind:"op.subtract",left:{kind:"motion.direction"},right:this.descendInputOfBlock(A,"DEGREES")}};case"motion_turnright":return{kind:"motion.setDirection",direction:{kind:"op.add",left:{kind:"motion.direction"},right:this.descendInputOfBlock(A,"DEGREES")}};case"pen_clear":return{kind:"pen.clear"};case"pen_changePenColorParamBy":return{kind:"pen.changeParam",param:this.descendInputOfBlock(A,"COLOR_PARAM"),value:this.descendInputOfBlock(A,"VALUE")};case"pen_changePenHueBy":return{kind:"pen.legacyChangeHue",hue:this.descendInputOfBlock(A,"HUE")};case"pen_changePenShadeBy":return{kind:"pen.legacyChangeShade",shade:this.descendInputOfBlock(A,"SHADE")};case"pen_penDown":return{kind:"pen.down"};case"pen_penUp":return{kind:"pen.up"};case"pen_setPenColorParamTo":return{kind:"pen.setParam",param:this.descendInputOfBlock(A,"COLOR_PARAM"),value:this.descendInputOfBlock(A,"VALUE")};case"pen_setPenColorToColor":return{kind:"pen.setColor",color:this.descendInputOfBlock(A,"COLOR")};case"pen_setPenHueToNumber":return{kind:"pen.legacySetHue",hue:this.descendInputOfBlock(A,"HUE")};case"pen_setPenShadeToNumber":return{kind:"pen.legacySetShade",shade:this.descendInputOfBlock(A,"SHADE")};case"pen_setPenSizeTo":return{kind:"pen.setSize",size:this.descendInputOfBlock(A,"SIZE")};case"pen_changePenSizeBy":return{kind:"pen.changeSize",size:this.descendInputOfBlock(A,"SIZE")};case"pen_stamp":return{kind:"pen.stamp"};case"procedures_return":{const e=this.getBlockById(this.thread.topBlock);return{kind:"procedures.return",return:this.descendInputOfBlock(A,"return"),isDefineClicked:!!e&&("procedures_return"===e.opcode||e.opcode.startsWith("procedures_definition"))}}case"procedures_set":return{kind:"procedures.set",param:this.descendInputOfBlock(A,"PARAM"),val:this.descendInputOfBlock(A,"VALUE")};case"procedures_call":{if("true"===A.mutation.returns){const e=B.simple(A);return e.opcode="procedures_call_return",this.descendStackedBlock(e)}const e=A.mutation.proccode;if("tw:debugger;"===e)return{kind:"tw.debugger"};const t=this.blocks.getProcedureParamNamesIdsAndDefaults(e);if(null===t)return{kind:"noop"};const[n,i,r]=t;if(this.runtime.getAddonBlock(e)){this.script.yields=!0;const t={};for(let e=0;e<i.length;e++){let o;o=A.inputs[i[e]]&&A.inputs[i[e]].block?this.descendInputOfBlock(A,i[e]):{kind:"constant",value:r[e]},t[n[e]]=o}return{kind:"addons.call",code:e,arguments:t,blockId:A.id}}const o=this.blocks.getProcedureDefinition(e),s=this.blocks.getBlock(o);if(!s)return{kind:"noop"};const a=this.blocks.getBlock(s.inputs.custom_block.block);let c=this.script.isWarp;if(!c&&a&&a.mutation){const A=a.mutation.warp;"boolean"==typeof A?c=A:"string"==typeof A&&(c=JSON.parse(A))}const g=u(e,c);this.script.dependedProcedures.includes(g)||this.script.dependedProcedures.push(g),this.script.isWarp||e===this.script.procedureCode&&(this.script.yields=!0);const E=[];for(let e=0;e<i.length;e++){let t;t=A.inputs[i[e]]&&A.inputs[i[e]].block?i[e].startsWith("SUBSTACK")?this.descendSubstack(A,i[e]):this.descendInputOfBlock(A,i[e]):{kind:"constant",value:r[e]},E.push(t)}return{kind:"procedures.call",code:e,variant:g,returns:!1,arguments:E,type:JSON.parse(A.mutation.optype||'"statement"')}}case"sensing_set_of":return{kind:"sensing.set.of",property:A.fields.PROPERTY.value,object:this.descendInputOfBlock(A,"OBJECT"),value:this.descendInputOfBlock(A,"VALUE")};case"sensing_resettimer":return{kind:"timer.reset"};case"lmsTempVars2_setRuntimeVariable":return{kind:"tempVars.set",var:this.descendInputOfBlock(A,"VAR"),val:this.descendInputOfBlock(A,"STRING"),runtime:!0};case"lmsTempVars2_setThreadVariable":return{kind:"tempVars.set",var:this.descendInputOfBlock(A,"VAR"),val:this.descendInputOfBlock(A,"STRING"),thread:!0};case"tempVars_setVariable":return{kind:"tempVars.set",var:this.descendInputOfBlock(A,"name"),val:this.descendInputOfBlock(A,"value")};case"lmsTempVars2_changeRuntimeVariable":const e=this.descendInputOfBlock(A,"VAR");return{kind:"tempVars.set",var:e,val:{kind:"op.add",left:{kind:"tempVars.get",var:e,runtime:!0},right:this.descendInputOfBlock(A,"NUM")},runtime:!0};case"lmsTempVars2_changeThreadVariable":{const e=this.descendInputOfBlock(A,"VAR");return{kind:"tempVars.set",var:e,val:{kind:"op.add",left:{kind:"tempVars.get",var:e,thread:!0},right:this.descendInputOfBlock(A,"NUM")},thread:!0}}case"tempVars_changeVariable":{const e=this.descendInputOfBlock(A,"name");return{kind:"tempVars.set",var:e,val:{kind:"op.add",left:{kind:"tempVars.get",var:e},right:this.descendInputOfBlock(A,"value")}}}case"lmsTempVars2_deleteRuntimeVariable":return{kind:"tempVars.delete",var:this.descendInputOfBlock(A,"VAR"),runtime:!0};case"tempVars_deleteVariable":return{kind:"tempVars.delete",var:this.descendInputOfBlock(A,"name")};case"lmsTempVars2_deleteAllRuntimeVariables":return{kind:"tempVars.deleteAll",runtime:!0};case"tempVars_deleteAllVariables":return{kind:"tempVars.deleteAll"};case"lmsTempVars2_forEachThreadVariable":return{kind:"tempVars.forEach",var:this.descendInputOfBlock(A,"VAR"),loops:this.descendInputOfBlock(A,"NUM"),do:this.descendSubstack(A,"SUBSTACK"),thread:!0};case"tempVars_forEachTempVar":return this.analyzeLoop(),{kind:"tempVars.forEach",var:this.descendInputOfBlock(A,"NAME"),loops:this.descendInputOfBlock(A,"REPEAT"),do:this.descendSubstack(A,"SUBSTACK")};case"control_dualblock":return{kind:"control.dualBlock"};default:if(this.runtime.getOpcodeFunction(A.opcode)){if(E.statementBlocks.includes(A.opcode))return this.descendCompatLayer(A);const e=this.getBlockInfo(A.opcode);if(e){const t=e.info.blockType,n=this.descendCompatLayer(A,e.info);if(n.block=A,A.mutation&&(n.mutation=A.mutation),t===o.COMMAND||t===o.CONDITIONAL||t===o.LOOP)return n}}if(this.thread.stackClick)try{return{kind:"visualReport",input:this.descendInput(A)}}catch(A){}throw a.warn("IR: Unknown stacked block: ".concat(A.opcode),A),new Error("IR: Unknown stacked block: ".concat(A.opcode))}}descendSubstack(A,e){const t=A.inputs[e];if(!t)return[];const n=t.block;return this.walkStack(n)}walkStack(A){const e=[];let t=A;for(;null!==t;){const A=this.getBlockById(t);if(!A)break;const n=this.descendStackedBlock(A);e.push(n),t=A.next}return e}descendVariable(A,e,t){const n=A.fields[e],i=n.id;if(this.variableCache.hasOwnProperty(i))return this.variableCache[i];const r=this._descendVariable(i,n.value,t);return this.variableCache[i]=r,r}_descendVariable(A,e,t){const n=this.target,i=this.stage;if(n.variables.hasOwnProperty(A))return Q("target",n.variables[A]);if(!n.isStage&&i&&i.variables.hasOwnProperty(A))return Q("stage",i.variables[A]);for(const A in n.variables)if(n.variables.hasOwnProperty(A)){const i=n.variables[A];if(i.name===e&&i.type===t)return Q("target",i)}if(!n.isStage&&i)for(const A in i.variables)if(i.variables.hasOwnProperty(A)){const n=i.variables[A];if(n.name===e&&n.type===t)return Q("stage",n)}const r=this.runtime.newVariableInstance(t,A,e,!1);if(n.variables[A]=r,n.sprite)for(const i of n.sprite.clones)i.variables.hasOwnProperty(A)||(i.variables[A]=this.runtime.newVariableInstance(t,A,e,!1));return Q("target",r)}descendCompatLayer(A,e){this.script.yields=!0,e||(e=(e=this.getBlockInfo(A.opcode))?e.info:null);const t={};for(const e of Object.keys(A.inputs))e.startsWith("SUBSTACK")||(t[e]=this.descendInputOfBlock(A,e));const n={},i=[],r=e&&e.blockType||o.COMMAND;if(r===o.CONDITIONAL||r===o.LOOP)for(let t in e.branches||[]){const e="0"===t?"SUBSTACK":"SUBSTACK".concat(Number(t)+1);i.push(this.descendSubstack(A,e))}for(const e of Object.keys(A.fields)){const t=A.fields[e].variableType;if(void 0===t)n[e]=A.fields[e].value;else{const i=this.descendVariable(A,e,t);n[e]=i}}return{kind:"compat",id:A.id,opcode:A.opcode,blockType:r,inputs:t,fields:n,substacks:i}}analyzeLoop(){this.script.isWarp&&!this.script.warpTimer||(this.script.yields=!0)}readTopBlockComment(A){const e=this.target.comments[A];if(!e)return;const t=e.text;for(const A of t.split("\n")){if(!/^tw\b/.test(A))continue;const e=A.split(" ");for(const A of e)switch(A){case"nocompile":throw new Error("Script explicitly disables compilation");case"stuck":this.script.warpTimer=!0}break}}walkHat(A){const e=A.next,t=A.opcode,n=this.runtime._hats[t];if(this.thread.stackClick){return this.runtime.getOpcodeFunction(t)?[this.descendCompatLayer(A),...this.walkStack(e)]:this.walkStack(e)}if(n.edgeActivated)return this.script.yields=!0,this.script.executableHat=!0,[{kind:"hat.edge",id:A.id,condition:this.descendCompatLayer(A)},...this.walkStack(e)];return this.runtime.getOpcodeFunction(t)?(this.script.yields=!0,this.script.executableHat=!0,[{kind:"hat.predicate",condition:this.descendCompatLayer(A)},...this.walkStack(e)]):this.walkStack(e)}generate(A){this.blocks.populateProcedureCache(),this.script.topBlockId=A;const e=this.getBlockById(A);if(!e){if(this.script.isProcedure)return this.script;throw new Error("Cannot find top block")}e.comment&&this.readTopBlockComment(e.comment);if(!!this.runtime._hats[e.opcode])this.script.stack=this.walkHat(e);else{let t;t="procedures_definition"===e.opcode||"procedures_definition_return"===e.opcode?e.next:A,t&&(this.script.stack=this.walkStack(t))}return this.script}}class h{constructor(A){this.thread=A,this.blocks=A.blockContainer,this.proceduresToCompile=new Map,this.compilingProcedures=new Map,this.procedures={},this.analyzedProcedures=[]}static setExtensionIr(A,e){h._extensionIRInfo[A]=e}static hasExtensionIr(A){return Boolean(h._extensionIRInfo[A])}static getExtensionIr(A){return h._extensionIRInfo[A]}addProcedureDependencies(A){for(const e of A){if(this.procedures.hasOwnProperty(e))continue;if(this.compilingProcedures.has(e))continue;if(this.proceduresToCompile.has(e))continue;const A=l(e),t=this.blocks.getProcedureDefinition(A);this.proceduresToCompile.set(e,t)}}generateScriptTree(A,e){const t=A.generate(e);return this.addProcedureDependencies(t.dependedProcedures),t}analyzeScript(A){let e=!1;for(const t of A.dependedProcedures){const n=this.procedures[t];this.analyzedProcedures.includes(t)||(this.analyzedProcedures.push(t),this.analyzeScript(n)&&(e=!0),this.analyzedProcedures.pop()),n.yields&&!A.yields&&(A.yields=!0,e=!0)}return e}generate(){const A=this.generateScriptTree(new w(this.thread),this.thread.topBlock),e=this.blocks._cache.compiledProcedures;for(;this.proceduresToCompile.size>0;){this.compilingProcedures=this.proceduresToCompile,this.proceduresToCompile=new Map;for(const[A,t]of this.compilingProcedures.entries())if(e[A]){const t=e[A];this.procedures[A]=t,this.addProcedureDependencies(t.dependedProcedures)}else{const n="W"===A.charAt(0),i=new w(this.thread);i.setProcedureVariant(A),n&&i.enableWarp();const r=this.generateScriptTree(i,t);this.procedures[A]=r,e[A]=r}}for(;this.analyzeScript(A););const t=new g;return t.entry=A,t.procedures=this.procedures,t}}n(h,"_extensionIRInfo",{}),n(h,"exports",{ScriptTreeGenerator:w}),A.exports=h},function(A,e,t){const n=t(36),i=t(18);A.exports=class{constructor(){let A=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.sequencer=A,this.thread=e,this._nowObj={now:()=>this.sequencer.runtime.currentMSecs}}get target(){return this.thread.target}get runtime(){return this.sequencer.runtime}get nowObj(){return this.runtime?this._nowObj:null}get stackFrame(){const A=this.thread.peekStackFrame();return null===A.executionContext&&(A.executionContext={}),A.executionContext}stackTimerFinished(){return!(this.stackFrame.timer.timeElapsed()<this.stackFrame.duration)}stackTimerNeedsInit(){return!this.stackFrame.timer}startStackTimer(A){this.nowObj?this.stackFrame.timer=new i(this.nowObj):this.stackFrame.timer=new i,this.stackFrame.timer.start(),this.stackFrame.duration=A}yield(){this.thread.status=n.STATUS_YIELD}defaultStatus(){this.thread.status=n.STATUS_RUNNING}yieldTick(){this.thread.status=n.STATUS_YIELD_TICK}startBranch(A,e){this.sequencer.stepToBranch(this.thread,A,e)}getBranchAndTarget(A,e){const t=this.thread.blockContainer.getBranch(A,e);return t?[t,this.thread.target]:this.sequencer.runtime.getBranchAndTarget(A,e)}stopAll(){this.sequencer.runtime.stopAll()}stopOtherTargetThreads(){this.sequencer.runtime.stopForTarget(this.thread.target,this.thread)}stopThisScript(){this.thread.stopThisScript()}startProcedure(A){this.sequencer.stepToProcedure(this.thread,A)}getProcedureParamNamesAndIds(A){return this.thread.target.blocks.getProcedureParamNamesAndIds(A)}getProcedureParamNamesIdsAndDefaults(A){return this.thread.target.blocks.getProcedureParamNamesIdsAndDefaults(A)}initParams(){this.thread.initParams()}pushParam(A,e){this.thread.pushParam(A,e)}getParam(A){return this.thread.getParam(A)}startHats(A,e,t){const n=this.thread,i=this.sequencer,r=this.sequencer.runtime.startHats(A,e,t);return this.thread=n,this.sequencer=i,r}ioQuery(A,e,t){if(this.sequencer.runtime.ioDevices[A]&&this.sequencer.runtime.ioDevices[A][e]){const n=this.sequencer.runtime.ioDevices[A];return n[e].apply(n,t)}}}},function(A,e,t){var n;function i(A,e,t){return(e=function(A){var e=function(A,e){if("object"!=typeof A||!A)return A;var t=A[Symbol.toPrimitive];if(void 0!==t){var n=t.call(A,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(A)}(A,"string");return"symbol"==typeof e?e:e+""}(e))in A?Object.defineProperty(A,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):A[e]=t,A}const r=t(5),o=t(2),s=t(1),a=t(222),B=t(43),c=t(224),{IntermediateScript:g,IntermediateRepresentation:E}=t(97),Q=A=>("string"!=typeof A&&(r.warn("sanitize got unexpected type: ".concat(typeof A)),A=""+A),JSON.stringify(A).slice(1,-1)),u="runtime.ext_pen",l="".concat(u,"._getPenState(target)"),w=Math.PI/180,h=180/Math.PI,C=new a("factory"),I=new a("fun"),M=new a("gen");class d{constructor(A,e){this.source=A,this.type=e}asNumber(){return 1===this.type?this.source:5===this.type?"(".concat(this.source," || 0)"):"(+".concat(this.source," || 0)")}asNumberOrNaN(){return 1===this.type||5===this.type?this.source:"(+".concat(this.source,")")}asString(){return 2===this.type?this.source:'("" + '.concat(this.source,")")}asBoolean(){return 4===this.type?"toBoolean(".concat(this.source,")"):2===this.type?"".concat(this.source," === 'false' || ").concat(this.source," === '0' ? false : true"):1===this.type?"".concat(this.source," !== 0"):5===this.type?"(".concat(this.source," || 0) !== 0"):this.source}asColor(){return this.asUnknown()}asUnknown(){return this.source}asSafe(){return this.asUnknown()}isAlwaysNumber(){return 1===this.type}isAlwaysNumberOrNaN(){return 1===this.type||5===this.type}isNeverNumber(){return!1}}class m{constructor(A,e){this.constantValue=A,this.safe=e}asNumber(){const A=+this.constantValue;return A?A.toString():Object.is(A,-0)?"-0":"0"}asNumberOrNaN(){return this.asNumber()}asString(){return'"'.concat(Q(""+this.constantValue),'"')}asBoolean(){return o.toBoolean(this.constantValue).toString()}asColor(){if(/^#[0-9a-f]{6,8}$/i.test(this.constantValue)){const A=this.constantValue.slice(1);return Number.parseInt(A,16).toString()}return this.asUnknown()}asUnknown(){if("number"==typeof this.constantValue)return this.constantValue;return(+this.constantValue).toString()===this.constantValue?this.constantValue:this.asString()}asSafe(){return this.safe?this.asUnknown():this.asString()}isAlwaysNumber(){const A=+this.constantValue;return!Number.isNaN(A)&&(0!==A||""!==this.constantValue.toString().trim())}isAlwaysNumberOrNaN(){return this.isAlwaysNumber()}isNeverNumber(){return Number.isNaN(+this.constantValue)}}class p{constructor(A){this.source=A,this.type=4,this._value=null}setInput(A){if(A instanceof p){if(!A._value)return this.type=4,void(this._value=null);A=A._value}this._value=A,this.type=A instanceof d?A.type:4}asNumber(){return 1===this.type?this.source:5===this.type?"(".concat(this.source," || 0)"):"(+".concat(this.source," || 0)")}asNumberOrNaN(){return 1===this.type||5===this.type?this.source:"(+".concat(this.source,")")}asString(){return 2===this.type?this.source:'("" + '.concat(this.source,")")}asBoolean(){return 3===this.type?this.source:"toBoolean(".concat(this.source,")")}asColor(){return this.asUnknown()}asUnknown(){return this.source}asSafe(){return this.asUnknown()}isAlwaysNumber(){return!!this._value&&this._value.isAlwaysNumber()}isAlwaysNumberOrNaN(){return!!this._value&&this._value.isAlwaysNumberOrNaN()}isNeverNumber(){return!!this._value&&this._value.isNeverNumber()}}const F=A=>{const e=+A.constantValue;return!!e&&e.toString()===A.constantValue.toString()};class D{constructor(A,e){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.isLoop=A,this.isLastBlock=!1,this.overrideLoop=t,this.importantData={parents:[e]},A&&(this.importantData.containedByLoop=A),this.parent=e}assignData(A){A instanceof D&&((A=A.importantData).parents=A.parents.concat(this.importantData.parents)),Object.assign(this.importantData,A)}}class Y{constructor(A,e,t){this.script=A,this.ir=e,this.target=t,this.source="",this.variableInputs={},this.isWarp=A.isWarp,this.isOptimized=A.isOptimized,this.optimizationUtil=A.optimizationUtil,this.isProcedure=A.isProcedure,this.warpTimer=A.warpTimer,this.frames=[],this.currentFrame=null,this.namesOfCostumesAndSounds=(A=>{const e=new Set;for(const t of A.targets)if(t.isOriginal){const A=t.sprite;for(const t of A.costumes)e.add(t.name);for(const t of A.sounds)e.add(t.name)}return e})(t.runtime),this.localVariables=new a("a"),this._setupVariablesPool=new a("b"),this._setupVariables={},this.descendedIntoModulo=!1,this.isInHat=!1,this.debug=this.target.runtime.debug}static setExtensionJs(A,e){Y._extensionJSInfo[A]=e}static hasExtensionJs(A){return Boolean(Y._extensionJSInfo[A])}static getExtensionJs(A){return Y._extensionJSInfo[A]}static getExtensionImports(){return{Frame:D,TypedInput:d,VariableInput:p,ConstantInput:m,VariablePool:a,TYPE_NUMBER:1,TYPE_STRING:2,TYPE_BOOLEAN:3,TYPE_UNKNOWN:4,TYPE_NUMBER_NAN:5}}pushFrame(A){this.frames.push(A),this.currentFrame=A}popFrame(){this.frames.pop(),this.currentFrame=this.frames[this.frames.length-1]}isLastBlockInLoop(){for(let A=this.frames.length-1;A>=0;A--){const e=this.frames[A];if(e.overrideLoop)return e.isLoop;if(!e.isLastBlock)return!1;if(e.isLoop)return!0}return!1}descendInput(A){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const t=String(A.kind).split(".")[0],n=String(A.kind).replace(t+".","");if(Y.hasExtensionJs(t)&&Y.getExtensionJs(t)[n]){const e=Y.getExtensionImports(),i=Y.getExtensionJs(t)[n];let o=null;try{o=i(A,this,e)}catch(A){r.warn(t+"_"+n,"failed to compile JavaScript;",A)}return o}switch(A.kind){case"args.boolean":return new d("toBoolean(p".concat(A.index,")"),3);case"args.stringNumber":return new d("p".concat(A.index),4);case"compat":return new d("(".concat(this.generateCompatibilityLayerCall(A,!1,null,e),")"),4);case"constant":return this.safeConstantInput(A.value);case"counter.get":return new d("runtime.ext_scratch3_control._counter",1);case"control.error":return new d("runtime.ext_scratch3_control._error",2);case"control.isclone":return new d("(!target.isOriginal)",3);case"math.polygon":let t=JSON.stringify(A.points.map((A,e)=>({x:"x".concat(e),y:"y".concat(e)})));for(let e=0;e<A.points.length;e++){const n=A.points[e],i='"x'.concat(e,'"'),r='"y'.concat(e,'"');t=t.replace(i,this.descendInput(n.x).asNumber()).replace(r,this.descendInput(n.y).asNumber())}return new d(t,4);case"control.inlineStackOutput":{const e=this.source;this.source="(yield* (function*() {",this.descendStack(A.code,new D(!1,"control.inlineStackOutput",!0)),this.source+="})())";const t=this.source;return this.source=e,new d(t,4)}case"keyboard.pressed":return new d("runtime.ioDevices.keyboard.getKeyIsDown(".concat(this.descendInput(A.key).asSafe(),")"),3);case"list.contains":return this.isOptimized?new d("listContainsFastest(".concat(this.referenceVariable(A.list),", ").concat(this.descendInput(A.item).asUnknown(),")"),3):new d("listContains(".concat(this.referenceVariable(A.list),", ").concat(this.descendInput(A.item).asUnknown(),")"),3);case"list.contents":return this.isOptimized?new d("(".concat(this.referenceVariable(A.list),".value.join(' '))"),2):new d("listContents(".concat(this.referenceVariable(A.list),")"),2);case"list.get":{const e=this.descendInput(A.index);if(c.supportsNullishCoalescing){if(e.isAlwaysNumberOrNaN())return new d("(".concat(this.referenceVariable(A.list),".value[(").concat(e.asNumber(),' | 0) - 1] ?? "")'),4);if(e instanceof m&&"last"===e.constantValue)return new d("(".concat(this.referenceVariable(A.list),".value[").concat(this.referenceVariable(A.list),'.value.length - 1] ?? "")'),4)}return this.isOptimized?new d("(".concat(this.referenceVariable(A.list),".value[").concat(e.asUnknown(),' - 1] ?? "")'),4):new d("listGet(".concat(this.referenceVariable(A.list),".value, ").concat(e.asUnknown(),")"),4)}case"list.indexOf":return new d("listIndexOf(".concat(this.referenceVariable(A.list),", ").concat(this.descendInput(A.item).asUnknown(),")"),1);case"list.amountOf":return new d("".concat(this.referenceVariable(A.list),".value.filter((x) => x == ").concat(this.descendInput(A.value).asUnknown(),").length"),1);case"list.length":return new d("".concat(this.referenceVariable(A.list),".value.length"),1);case"list.filteritem":return new d('(thread._listFilterItem ?? [""])[(thread._listFilterItem ?? [""]).length - 1]',4);case"list.filterindex":return new d("(thread._listFilterIndex ?? [0])[(thread._listFilterIndex ?? [0]).length - 1]",1);case"looks.size":return new d("target.size",1);case"looks.tintColor":return new d("runtime.ext_scratch3_looks.getTintColor(null, { target: target })",1);case"looks.backdropName":return new d("stage.getCostumes()[stage.currentCostume].name",2);case"looks.backdropNumber":return new d("(stage.currentCostume + 1)",1);case"looks.costumeName":return new d("target.getCostumes()[target.currentCostume].name",2);case"looks.costumeNumber":return new d("(target.currentCostume + 1)",1);case"motion.direction":return new d("target.direction",1);case"motion.x":return this.isOptimized?new d("(target.x)",1):new d("limitPrecision(target.x)",1);case"motion.y":return this.isOptimized?new d("(target.y)",1):new d("limitPrecision(target.y)",1);case"mouse.down":return new d("runtime.ioDevices.mouse.getIsDown()",3);case"mouse.x":return new d("runtime.ioDevices.mouse.getScratchX()",1);case"mouse.y":return new d("runtime.ioDevices.mouse.getScratchY()",1);case"op.true":return new d("(true)",3);case"op.false":return new d("(false)",3);case"op.randbool":return new d("(Boolean(Math.round(Math.random())))",3);case"pmEventsExpansion.broadcastFunction":let n="(yield* (function*() {";n+='var broadcastVar = runtime.getTargetForStage().lookupBroadcastMsg("", '.concat(this.descendInput(A.broadcast).asString()," );\n"),n+="if (broadcastVar) broadcastVar.isSent = true;\n";const o=this.localVariables.next();n+="var ".concat(o,' = startHats("event_whenbroadcastreceived", { BROADCAST_OPTION: ').concat(this.descendInput(A.broadcast).asString()," });\n");const s=this.localVariables.next();n+="for (const ".concat(s," of ").concat(o,") { ").concat(s,".__evex_recievedDataa = '' };\n"),n+="yield* waitThreads(".concat(o,");\n"),this.isWarp?n+="if (isStuck()) yield;\n":n+="yield;\n",this.resetVariableInputs();const a=this.localVariables.next(),B=this.localVariables.next();return n+="var ".concat(a," = undefined;\n"),n+="for (var ".concat(B," of ").concat(o,") {"),n+="if (typeof ".concat(B,".__evex_returnDataa !== 'undefined') {"),n+="return ".concat(B,".__evex_returnDataa;\n"),n+="}",n+="}",n+="return '';\n",n+="})())",new d(n,2);case"pmEventsExpansion.broadcastFunctionArgs":{let e="(yield* (function*() {";const t=this.localVariables.next();e+='var broadcastVar = runtime.getTargetForStage().lookupBroadcastMsg("", '.concat(this.descendInput(A.broadcast).asString()," );\n"),e+="if (broadcastVar) broadcastVar.isSent = true;\n",e+="var ".concat(t,' = startHats("event_whenbroadcastreceived", { BROADCAST_OPTION: ').concat(this.descendInput(A.broadcast).asString()," });\n");const n=this.localVariables.next();e+="for (const ".concat(n," of ").concat(t,") { ").concat(n,".__evex_recievedDataa = ").concat(this.descendInput(A.args).asString()," };\n"),e+="yield* waitThreads(".concat(t,");\n"),this.isWarp?e+="if (isStuck()) yield;\n":e+="yield;\n",this.resetVariableInputs();const i=this.localVariables.next(),r=this.localVariables.next();return e+="var ".concat(i," = undefined;\n"),e+="for (var ".concat(r," of ").concat(t,") {"),e+="if (typeof ".concat(r,".__evex_returnDataa !== 'undefined') {"),e+="return ".concat(r,".__evex_returnDataa;\n"),e+="}",e+="}",e+="return '';\n",e+="})())",new d(e,2)}case"op.abs":return new d("Math.abs(".concat(this.descendInput(A.value).asNumber(),")"),1);case"op.acos":return new d("(Math.acos(".concat(this.descendInput(A.value).asNumber(),") * ").concat(h,")"),5);case"op.add":return new d("(".concat(this.descendInput(A.left).asNumber()," + ").concat(this.descendInput(A.right).asNumber(),")"),5);case"op.and":return new d("(".concat(this.descendInput(A.left).asBoolean()," && ").concat(this.descendInput(A.right).asBoolean(),")"),3);case"op.asin":return new d("(Math.asin(".concat(this.descendInput(A.value).asNumber(),") * ").concat(h,")"),5);case"op.atan":return new d("(Math.atan(".concat(this.descendInput(A.value).asNumber(),") * ").concat(h,")"),1);case"op.ceiling":return new d("Math.ceil(".concat(this.descendInput(A.value).asNumber(),")"),1);case"op.contains":return new d("(".concat(this.descendInput(A.string).asString(),".toLowerCase().indexOf(").concat(this.descendInput(A.contains).asString(),".toLowerCase()) !== -1)"),3);case"op.cos":if(this.isOptimized){const e="".concat(this.descendInput(A.value).asNumber());return new d("(Number.isInteger(".concat(e,") ? runtime.optimizationUtil.cos[((").concat(e," % 360) + 360) % 360] : (Math.round(Math.cos(").concat(e," * ").concat(w,") * 1e10) / 1e10))"),5)}return new d("(Math.round(Math.cos(".concat(this.descendInput(A.value).asNumber()," * ").concat(w,") * 1e10) / 1e10)"),5);case"op.divide":return new d("(".concat(this.descendInput(A.left).asNumber()," / ").concat(this.descendInput(A.right).asNumber(),")"),5);case"op.power":return new d("(Math.pow(".concat(this.descendInput(A.left).asNumber(),", ").concat(this.descendInput(A.right).asNumber(),"))"),5);case"op.equals":{const e=this.descendInput(A.left),t=this.descendInput(A.right);if(e.isNeverNumber()||t.isNeverNumber())return new d("(".concat(e.asString(),".toLowerCase() === ").concat(t.asString(),".toLowerCase())"),3);const n=e.isAlwaysNumber(),i=t.isAlwaysNumber();return n&&i||(n&&e instanceof m&&F(e)||i&&t instanceof m&&F(t))?new d("(".concat(e.asNumber()," === ").concat(t.asNumber(),")"),3):new d("compareEqual(".concat(e.asUnknown(),", ").concat(t.asUnknown(),")"),3)}case"op.e^":return new d("Math.exp(".concat(this.descendInput(A.value).asNumber(),")"),1);case"op.floor":return new d("Math.floor(".concat(this.descendInput(A.value).asNumber(),")"),1);case"op.greater":{const e=this.descendInput(A.left),t=this.descendInput(A.right);return e.isAlwaysNumber()&&t.isAlwaysNumberOrNaN()?new d("(".concat(e.asNumber()," > ").concat(t.asNumberOrNaN(),")"),3):e.isAlwaysNumberOrNaN()&&t.isAlwaysNumber()?new d("!(".concat(e.asNumberOrNaN()," <= ").concat(t.asNumber(),")"),3):e.isNeverNumber()||t.isNeverNumber()?new d("(".concat(e.asString(),".toLowerCase() > ").concat(t.asString(),".toLowerCase())"),3):new d("compareGreaterThan(".concat(e.asUnknown(),", ").concat(t.asUnknown(),")"),3)}case"op.join":return new d("(".concat(this.descendInput(A.left).asString()," + ").concat(this.descendInput(A.right).asString(),")"),2);case"op.expandjoin":for(var i=0;i<A.strings.length;i++)A.strings[i]=this.descendInput(A.strings[i]).asString();return new d("("+A.strings.join("+")+")",2);case"op.length":return new d("".concat(this.descendInput(A.string).asString(),".length"),1);case"op.less":{const e=this.descendInput(A.left),t=this.descendInput(A.right);return e.isAlwaysNumberOrNaN()&&t.isAlwaysNumber()?new d("(".concat(e.asNumberOrNaN()," < ").concat(t.asNumber(),")"),3):e.isAlwaysNumber()&&t.isAlwaysNumberOrNaN()?new d("!(".concat(e.asNumber()," >= ").concat(t.asNumberOrNaN(),")"),3):e.isNeverNumber()||t.isNeverNumber()?new d("(".concat(e.asString(),".toLowerCase() < ").concat(t.asString(),".toLowerCase())"),3):new d("compareLessThan(".concat(e.asUnknown(),", ").concat(t.asUnknown(),")"),3)}case"op.letterOf":return new d("((".concat(this.descendInput(A.string).asString(),")[(").concat(this.descendInput(A.letter).asNumber(),' | 0) - 1] || "")'),2);case"op.ln":return new d("Math.log(".concat(this.descendInput(A.value).asNumber(),")"),5);case"op.log":return new d("(Math.log(".concat(this.descendInput(A.value).asNumber(),") / Math.LN10)"),5);case"op.log2":return new d("Math.log2(".concat(this.descendInput(A.value).asNumber(),")"),5);case"op.advlog":return new d("(Math.log(".concat(this.descendInput(A.right).asNumber(),") / (Math.log(").concat(this.descendInput(A.left).asNumber(),"))"),5);case"op.mod":return this.descendedIntoModulo=!0,new d("mod(".concat(this.descendInput(A.left).asNumber(),", ").concat(this.descendInput(A.right).asNumber(),")"),5);case"op.multiply":return new d("(".concat(this.descendInput(A.left).asNumber()," * ").concat(this.descendInput(A.right).asNumber(),")"),5);case"op.not":return new d("!".concat(this.descendInput(A.operand).asBoolean()),3);case"op.or":return new d("(".concat(this.descendInput(A.left).asBoolean()," || ").concat(this.descendInput(A.right).asBoolean(),")"),3);case"op.random":return A.useInts?new d("randomInt(".concat(this.descendInput(A.low).asNumber(),", ").concat(this.descendInput(A.high).asNumber(),")"),1):A.useFloats?new d("randomFloat(".concat(this.descendInput(A.low).asNumber(),", ").concat(this.descendInput(A.high).asNumber(),")"),5):new d("runtime.ext_scratch3_operators._random(".concat(this.descendInput(A.low).asUnknown(),", ").concat(this.descendInput(A.high).asUnknown(),")"),5);case"op.round":return new d("Math.round(".concat(this.descendInput(A.value).asNumber(),")"),1);case"op.sign":return new d("Math.sign(".concat(this.descendInput(A.value).asNumber(),")"),1);case"op.sin":if(this.isOptimized){const e="".concat(this.descendInput(A.value).asNumber());return new d("(Number.isInteger(".concat(e,") ? runtime.optimizationUtil.sin[((").concat(e," % 360) + 360) % 360] : (Math.round(Math.sin(").concat(e," * ").concat(w,") * 1e10) / 1e10))"),5)}return new d("(Math.round(Math.sin(".concat(this.descendInput(A.value).asNumber()," * ").concat(w,") * 1e10) / 1e10)"),5);case"op.sqrt":return new d("Math.sqrt(".concat(this.descendInput(A.value).asNumber(),")"),5);case"op.subtract":return new d("(".concat(this.descendInput(A.left).asNumber()," - ").concat(this.descendInput(A.right).asNumber(),")"),5);case"op.tan":return new d("tan(".concat(this.descendInput(A.value).asNumber(),")"),5);case"op.10^":return new d("(10 ** ".concat(this.descendInput(A.value).asNumber(),")"),1);case"op.expandmath":{const e=A.operations;let t="",n=0;for(i=0;i<e.length;i++){const A=e[i],r=(e[i-1],A[1]);if("^"===r)t+="Math.pow(",t+=this.descendInput(A[0]).asNumber(),t+=",",n++;else{for(t+=this.descendInput(A[0]).asNumber();n>0;)t+=")",n--;r&&(t+=r)}}return new d("("+t+")",5)}case"sensing.answer":return new d("runtime.ext_scratch3_sensing._answer",2);case"sensing.colorTouchingColor":return new d("target.colorIsTouchingColor(colorToList(".concat(this.descendInput(A.target).asColor(),"), colorToList(").concat(this.descendInput(A.mask).asColor(),"))"),3);case"sensing.date":return new d("(new Date().getDate())",1);case"sensing.dayofweek":return new d("(new Date().getDay() + 1)",1);case"sensing.daysSince2000":return new d("daysSince2000()",1);case"sensing.distance":return new d("distance(".concat(this.descendInput(A.target).asString(),")"),1);case"sensing.hour":return new d("(new Date().getHours())",1);case"sensing.minute":return new d("(new Date().getMinutes())",1);case"sensing.month":return new d("(new Date().getMonth() + 1)",1);case"sensing.of":{const e=this.descendInput(A.object).asString(),t=A.property;if("constant"===A.object.kind){const n="_stage_"===A.object.value,i=n?"stage":this.evaluateOnce("runtime.getSpriteTargetByName(".concat(e,")"));if("volume"===t)return new d("(".concat(i," ? ").concat(i,".volume : 0)"),1);if(n)switch(t){case"background #":case"backdrop #":return new d("(".concat(i,".currentCostume + 1)"),1);case"backdrop name":return new d("".concat(i,".getCostumes()[").concat(i,".currentCostume].name"),2)}else switch(t){case"x position":return new d("(".concat(i," ? ").concat(i,".x : 0)"),1);case"y position":return new d("(".concat(i," ? ").concat(i,".y : 0)"),1);case"direction":return new d("(".concat(i," ? ").concat(i,".direction : 0)"),1);case"costume #":return new d("(".concat(i," ? ").concat(i,".currentCostume + 1 : 0)"),1);case"costume name":return new d("(".concat(i," ? ").concat(i,".getCostumes()[").concat(i,".currentCostume].name : 0)"),4);case"layer":return new d("(".concat(i," ? ").concat(i,".getLayerOrder() : 0)"),1);case"size":return new d("(".concat(i," ? ").concat(i,".size : 0)"),1)}const r=this.evaluateOnce("".concat(i," && ").concat(i,'.lookupVariableByNameAndType("').concat(Q(t),'", "", true)'));return new d("(".concat(r," ? ").concat(r,".value : 0)"),4)}return new d("runtime.ext_scratch3_sensing.getAttributeOf({OBJECT: ".concat(e,', PROPERTY: "').concat(Q(t),'" })'),4)}case"sensing.second":return new d("(new Date().getSeconds())",1);case"sensing.timestamp":return new d("(Date.now())",1);case"sensing.touching":return new d("target.isTouchingObject(".concat(this.descendInput(A.object).asUnknown(),")"),3);case"sensing.touchingColor":return new d("target.isTouchingColor(colorToList(".concat(this.descendInput(A.color).asColor(),"))"),3);case"sensing.username":return new d("runtime.ioDevices.userData.getUsername()",2);case"sensing.loggedin":return new d("runtime.ioDevices.userData.getLoggedIn()",3);case"sensing.year":return new d("(new Date().getFullYear())",1);case"timer.get":return new d("runtime.ioDevices.clock.projectTimer()",1);case"tw.lastKeyPressed":return new d("runtime.ioDevices.keyboard.getLastKeyPressed()",2);case"var.get":return this.descendVariable(A.variable);case"procedures.call":{const e=A.code,t=A.variant;let n="(";const i=this.ir.procedures[t];if(null===i.stack)return new d('""',2);const r=!this.isWarp&&e===this.script.procedureCode,o=this.isInHat;if((r||o)&&this.yieldNotWarp(),i.yields&&(n+="yield* ",!this.script.yields))throw new Error("Script uses yielding procedure but is not marked as yielding.");if(n+='thread.procedures["'.concat(Q(t),'"]('),i.arguments.length){const e=[];for(const t of A.arguments)e.push(this.descendInput(t).asSafe());n+=e.join(",")}return n+="))",this.resetVariableInputs(),new d(n,4)}case"noop":return console.warn("unexpected noop"),new d('""',4);case"tempVars.get":{const e=this.descendInput(A.var),t=A.runtime?"runtime.variables":A.thread?"thread.variables":"tempVars",n=this.isOptimized?"".concat(t,"[").concat(e.asString(),"]"):"get(".concat(t,", ").concat(e.asString(),")");return c.supportsNullishCoalescing?new d("(".concat(n,' ?? "")'),4):new d("nullish(".concat(n,', "")'),4)}case"tempVars.exists":{const e=this.descendInput(A.var),t=A.runtime?"runtime.variables":A.thread?"thread.variables":"tempVars",n=this.isOptimized?"".concat(e.asString()," in ").concat(t):"includes(".concat(t,", ").concat(e.asString(),")");return new d(n,3)}case"tempVars.all":const g=A.runtime?"runtime.variables":A.thread?"thread.variables":"tempVars";return A.runtime||A.thread?new d("Object.keys(".concat(g,").join(',')"),2):new d("JSON.stringify(Object.keys(tempVars))",2);case"control.dualBlock":return new d('"dual block works!"',2);default:throw r.warn("JS: Unknown input: ".concat(A.kind),A),new Error("JS: Unknown input: ".concat(A.kind))}}descendStackedBlock(A){const e=String(A.kind).split(".")[0],t=String(A.kind).replace(e+".","");if(Y.hasExtensionJs(e)&&Y.getExtensionJs(e)[t]){const n=Y.getExtensionImports(),i=Y.getExtensionJs(e)[t];try{i(A,this,n)}catch(A){r.warn(e+"_"+t,"failed to compile JavaScript;",A)}}else switch(A.kind){case"your mom":const e="https://penguinmod.com/dump/urmom-your-mom.mp4",t="https://penguinmod.com/dump/chips.mp4",n="https://penguinmod.com/dump/MISTER_BEAST.webm",i=A=>'`<video src="'.concat(A,'" height="${height}" autoplay loop style="alignment:center;"></video>`');this.source+="\n            const stage = document.getElementsByClassName('stage_stage_1fD7k box_box_2jjDp')[0].children[0]\n            const height = stage.children[0].style.height\n            stage.innerHTML = ".concat(i(e),"\n            runtime.on('PROJECT_STOP_ALL', () => document.body.innerHTML = ").concat(i(t),")\n            stage.children[0].addEventListener('mousedown', () => stage.innerHTML = ").concat(i(n),");\n            ");break;case"addons.call":{const e=this.descendInputRecord(A.arguments),t='runtime.getAddonBlock("'.concat(Q(A.code),'").callback'),n='"'.concat(Q(A.blockId),'"');this.source+="yield* executeInCompatibilityLayer(".concat(e,", ").concat(t,", ").concat(this.isWarp,", false, ").concat(n,");\n");break}case"compat":{const e=this.isLastBlockInLoop(),t=A.blockType;if(t===s.COMMAND||t===s.HAT)this.source+="".concat(this.generateCompatibilityLayerCall(A,e),";\n");else{if(t!==s.CONDITIONAL&&t!==s.LOOP)throw new Error("Unknown block type: ".concat(t));{const e=this.localVariables.next();this.source+="const ".concat(e," = createBranchInfo(").concat(t===s.LOOP,");\n"),this.source+="while (".concat(e,".branch = +(").concat(this.generateCompatibilityLayerCall(A,!1,e),")) {\n"),this.source+="switch (".concat(e,".branch) {\n");for(let e=0;e<A.substacks.length;e++)this.source+="case ".concat(e+1,": {\n"),this.descendStack(A.substacks[e],new D(!1)),this.source+="break;\n",this.source+="}\n";this.source+="}\n",this.source+="if (".concat(e,".onEnd[0]) yield ").concat(e,".onEnd.shift()(").concat(e,");\n"),this.source+="if (!".concat(e,".isLoop) break;\n"),this.yieldLoop(),this.source+="}\n"}}e&&(this.source+="if (hasResumedFromPromise) {hasResumedFromPromise = false;continue;}\n");break}case"procedures.set":const o=this.descendInput(A.val),a=A.param.index;void 0!==a&&(this.source+="p".concat(a," = ").concat(o.asSafe(),";\n"));break;case"control.createClone":this.source+="runtime.ext_scratch3_control._createClone(".concat(this.descendInput(A.target).asString(),", target);\n");break;case"control.deleteClone":this.source+="if (!target.isOriginal) {\n",this.source+="  runtime.disposeTarget(target);\n",this.source+="  runtime.stopForTarget(target);\n",this.retire(),this.source+="}\n";break;case"control.for":{this.resetVariableInputs();const e=this.localVariables.next();this.source+="var ".concat(e," = 0; "),this.source+="while (".concat(e," < ").concat(this.descendInput(A.count).asNumber(),") { "),this.source+="".concat(e,"++; "),this.source+="".concat(this.referenceVariable(A.variable),".value = ").concat(e,";\n"),this.descendStack(A.do,new D(!0,"control.for")),this.yieldLoop(),this.source+="}\n";break}case"control.switch":this.source+="switch (".concat(this.descendInput(A.test).asString(),") {\n"),this.descendStack(A.conditions,new D(!1,"control.switch")),A.default.length&&(this.source+="default:\n",this.descendStack(A.default,new D(!1,"control.switch"))),this.source+="}\n";break;case"control.case":if("control.switch"!==this.currentFrame.parent){this.source+='throw \'All "case" blocks must be inside of a "switch" block.\';\n';break}if(this.source+="case ".concat(this.descendInput(A.condition).asString(),":\n"),!A.runsNext){const e=new D(!1,"control.case");e.assignData({containedByCase:!0}),this.descendStack(A.code,e),this.source+="break;\n"}break;case"control.allAtOnce":{const e=this.isWarp;this.isWarp=!0,this.descendStack(A.code,new D(!1,"control.allAtOnce")),this.isWarp=e;break}case"control.newScript":{const A=this.localVariables.next(),e=this.localVariables.next();this.source+="var ".concat(A," = thread.peekStack();\n"),this.source+="var ".concat(e," = thread.target.blocks.getBranch(").concat(A,", 0);\n"),this.source+="if (".concat(e,") {"),this.source+="runtime._pushThread(".concat(e,", target, {});\n"),this.source+="}";break}case"control.exitCase":if(!this.currentFrame.importantData.containedByCase){this.source+='throw \'All "exit case" blocks must be inside of a "case" block.\';\n';break}this.source+="break;\n";break;case"control.exitLoop":if(!this.currentFrame.importantData.containedByLoop){this.source+="throw 'All \"escape loop\" blocks must be inside of a looping block.';\n";break}this.source+="break;\n";break;case"control.continueLoop":if(!this.currentFrame.importantData.containedByLoop){this.source+="throw 'All \"continue loop\" blocks must be inside of a looping block.';\n";break}this.source+="continue;\n";break;case"control.if":this.source+="if (".concat(this.descendInput(A.condition).asBoolean(),") {\n"),this.descendStack(A.whenTrue,new D(!1,"control.if")),A.whenFalse.length&&(this.source+="} else {\n",this.descendStack(A.whenFalse,new D(!1,"control.if"))),this.source+="}\n";break;case"control.trycatch":this.source+="try {\n",this.descendStack(A.try,new D(!1,"control.trycatch"));const B=this.localVariables.next();this.source+="} catch (".concat(B,") {\n"),this.source+="runtime.ext_scratch3_control._error = String(".concat(B,");\n"),this.descendStack(A.catch,new D(!1,"control.trycatch")),this.source+="}\n";break;case"control.throwError":{const e=this.descendInput(A.error).asString();this.source+="throw ".concat(e,";\n");break}case"control.repeat":{const e=this.localVariables.next();this.source+="for (var ".concat(e," = ").concat(this.descendInput(A.times).asNumber(),"; ").concat(e," >= 0.5; ").concat(e,"--) {\n"),this.descendStack(A.do,new D(!0,"control.repeat")),this.yieldLoop(),this.source+="}\n";break}case"control.repeatForSeconds":{const e=this.localVariables.next();this.source+="thread.timer2 = timer();\n",this.source+="var ".concat(e," = Math.max(0, 1000 * ").concat(this.descendInput(A.times).asNumber(),");\n"),this.requestRedraw(),this.source+="while (thread.timer2.timeElapsed() < ".concat(e,") {\n"),this.descendStack(A.do,new D(!0,"control.repeatForSeconds")),this.yieldLoop(),this.source+="}\n",this.source+="thread.timer2 = null;\n";break}case"control.stopAll":this.source+="runtime.stopAll();\n",this.retire();break;case"control.stopOthers":this.source+="runtime.stopForTarget(target, thread);\n";break;case"control.stopScript":this.isProcedure?this.source+="return;\n":this.retire();break;case"control.wait":{const e=this.localVariables.next();this.source+="thread.timer = timer();\n",this.source+="var ".concat(e," = Math.max(0, 1000 * ").concat(this.descendInput(A.seconds).asNumber(),");\n"),this.requestRedraw(),this.yieldNotWarp(),this.source+="while (thread.timer.timeElapsed() < ".concat(e,") {\n"),this.yieldStuckOrNotWarp(),this.source+="}\n",this.source+="thread.timer = null;\n";break}case"control.waitTick":this.yieldNotWarp();break;case"control.waitUntil":this.resetVariableInputs(),this.source+="while (!".concat(this.descendInput(A.condition).asBoolean(),") {\n"),this.yieldStuckOrNotWarp(),this.source+="}\n";break;case"control.waitOrUntil":{const e=this.localVariables.next(),t=this.descendInput(A.condition).asBoolean();this.source+="thread.timer = timer();\n",this.source+="var ".concat(e," = Math.max(0, 1000 * ").concat(this.descendInput(A.seconds).asNumber(),");\n"),this.requestRedraw(),this.yieldNotWarp(),this.source+="while ((thread.timer.timeElapsed() < ".concat(e,") && (!(").concat(t,"))) {\n"),this.yieldStuckOrNotWarp(),this.source+="}\n",this.source+="thread.timer = null;\n";break}case"control.while":this.resetVariableInputs(),this.source+="while (".concat(this.descendInput(A.condition).asBoolean(),") {\n"),this.descendStack(A.do,new D(!0,"control.while")),A.warpTimer?this.yieldStuckOrNotWarp():this.yieldLoop(),this.source+="}\n";break;case"control.runAsSprite":const c="runtime.getTargetForStage()",g=this.descendInput(A.sprite).asString(),E='"_stage_"'===g,w=this.localVariables.next();this.source+="const ".concat(w," = target;\n"),this.source+="try {\n";const h=this.localVariables.next();this.source+="var ".concat(h," = ").concat(g,";\n");const C=E?c:"runtime.getSpriteTargetByName(".concat(h,") || runtime.getTargetById(").concat(h,")");this.source+="const target = (".concat(C,");\n"),this.source+="if (target) {\n",this.source+="thread.target = target;\n";const I=this.localVariables.next(),M=this.localVariables.next();this.source+="var ".concat(I," = thread.spoofing;\n"),this.source+="var ".concat(M," = thread.spoofTarget;\n"),this.source+="thread.spoofing = true;\n",this.source+="thread.spoofTarget = target;\n",this.descendStack(A.substack,new D(!1,"control.runAsSprite")),this.source+="thread.target = ".concat(w,";\n"),this.source+="thread.spoofing = ".concat(I,";\n"),this.source+="thread.spoofTarget = ".concat(M,";\n"),this.source+="}\n",this.source+="} catch (e) {\nconsole.log('as sprite function failed;', e);\n",this.source+="thread.target = ".concat(w,";\n"),this.source+="thread.spoofing = ".concat(I,";\n"),this.source+="thread.spoofTarget = ".concat(M,";\n"),this.source+="}\n";break;case"counter.clear":this.source+="runtime.ext_scratch3_control._counter = 0;\n";break;case"counter.increment":this.source+="runtime.ext_scratch3_control._counter++;\n";break;case"counter.decrement":this.source+="runtime.ext_scratch3_control._counter--;\n";break;case"counter.set":this.source+="runtime.ext_scratch3_control._counter = ".concat(this.descendInput(A.value).asNumber(),";\n");break;case"hat.edge":this.isInHat=!0,this.source+="{\n",this.source+="const resolvedValue = ".concat(this.descendInput(A.condition).asBoolean(),";\n"),this.source+='const id = "'.concat(Q(A.id),'";\n'),this.source+="const hasOldEdgeValue = target.hasEdgeActivatedValue(id);\n",this.source+="const oldEdgeValue = target.updateEdgeActivatedValue(id, resolvedValue);\n",this.source+="const edgeWasActivated = hasOldEdgeValue ? (!oldEdgeValue && resolvedValue) : resolvedValue;\n",this.source+="if (!edgeWasActivated) {\n",this.retire(),this.source+="}\n",this.source+="yield;\n",this.source+="}\n",this.isInHat=!1;break;case"hat.predicate":this.isInHat=!0,this.source+="if (!".concat(this.descendInput(A.condition).asBoolean(),") {\n"),this.retire(),this.source+="}\n",this.source+="yield;\n",this.isInHat=!1;break;case"event.broadcast":this.source+='var broadcastVar = runtime.getTargetForStage().lookupBroadcastMsg("", '.concat(this.descendInput(A.broadcast).asString()," );\n"),this.source+="if (broadcastVar) broadcastVar.isSent = true;\n",this.source+='startHats("event_whenbroadcastreceived", { BROADCAST_OPTION: '.concat(this.descendInput(A.broadcast).asString()," });\n"),this.resetVariableInputs();break;case"event.broadcastAndWait":this.source+='var broadcastVar = runtime.getTargetForStage().lookupBroadcastMsg("", '.concat(this.descendInput(A.broadcast).asString()," );\n"),this.source+="if (broadcastVar) broadcastVar.isSent = true;\n",this.source+='yield* waitThreads(startHats("event_whenbroadcastreceived", { BROADCAST_OPTION: '.concat(this.descendInput(A.broadcast).asString()," }));\n"),this.yielded();break;case"list.forEach":{const e=this.referenceVariable(A.list),t=this.descendVariable(A.variable),n=A.num?"index + 1":"value";this.source+="for (let index = 0; index < ".concat(e,".value.length; index++) {")+"const value = ".concat(e,".value[index];\n")+"".concat(t.source," = ").concat(n,";\n"),this.descendStack(A.do,new D(!0,"list.forEach")),this.source+="};\n";break}case"list.add":{const e=this.referenceVariable(A.list);this.source+="".concat(e,".value.push(").concat(this.descendInput(A.item).asSafe(),");\n"),this.source+="".concat(e,"._monitorUpToDate = false;\n");break}case"list.delete":{const e=this.referenceVariable(A.list),t=this.descendInput(A.index);if(t instanceof m){if("last"===t.constantValue){this.source+="".concat(e,".value.pop();\n"),this.source+="".concat(e,"._monitorUpToDate = false;\n");break}if(1==+t.constantValue){this.source+="".concat(e,".value.shift();\n"),this.source+="".concat(e,"._monitorUpToDate = false;\n");break}}this.source+="listDelete(".concat(e,", ").concat(t.asUnknown(),");\n");break}case"list.deleteAll":this.source+="".concat(this.referenceVariable(A.list),".value = [];\n");break;case"list.shift":const d=this.referenceVariable(A.list),p=this.descendInput(A.index).asNumber();if(p<=0)break;this.source+="".concat(d,".value = ").concat(d,".value.slice(").concat(p,");\n"),this.source+="".concat(d,"._monitorUpToDate = false;\n");break;case"list.hide":this.source+='runtime.monitorBlocks.changeBlock({ id: "'.concat(Q(A.list.id),'", element: "checkbox", value: false }, runtime);\n');break;case"list.insert":{const e=this.referenceVariable(A.list),t=this.descendInput(A.index),n=this.descendInput(A.item);if(t instanceof m&&1==+t.constantValue){this.source+="".concat(e,".value.unshift(").concat(n.asSafe(),");\n"),this.source+="".concat(e,"._monitorUpToDate = false;\n");break}this.source+="listInsert(".concat(e,", ").concat(t.asUnknown(),", ").concat(n.asSafe(),");\n");break}case"list.replace":this.source+="listReplace(".concat(this.referenceVariable(A.list),", ").concat(this.descendInput(A.index).asUnknown(),", ").concat(this.descendInput(A.item).asSafe(),");\n");break;case"list.show":this.source+='runtime.monitorBlocks.changeBlock({ id: "'.concat(Q(A.list.id),'", element: "checkbox", value: true }, runtime);\n');break;case"list.filter":const F=this.localVariables.next();this.source+="var ".concat(F," = [];\n");const Y=this.localVariables.next();this.source+="var ".concat(Y," = [...").concat(this.referenceVariable(A.list),".value];\n"),this.source+="thread._listFilterItem ??= [];\n",this.source+="thread._listFilterIndex ??= [];\n",this.source+='thread._listFilterItem.push("");\n',this.source+="thread._listFilterIndex.push(0);\n";let f="thread._listFilterIndex[thread._listFilterIndex.length-1]",N="thread._listFilterItem[thread._listFilterItem.length-1]";this.source+="for (".concat(f," = 1; ").concat(f," <= ").concat(Y,".length; ").concat(f,"++) {\n"),this.source+="    ".concat(N," = ").concat(Y,"[").concat(f," - 1];\n"),this.source+="    if (".concat(this.descendInput(A.bool).asBoolean(),") ").concat(F,".push(").concat(N,");\n"),this.source+="};\n",this.source+="".concat(this.referenceVariable(A.list),".value = ").concat(F,";\n"),this.source+="thread._listFilterItem.pop();\n",this.source+="thread._listFilterIndex.pop();\n";break;case"looks.backwardLayers":this.target.isStage||(this.source+="target.goBackwardLayers(".concat(this.descendInput(A.layers).asNumber(),");\n"));break;case"looks.clearEffects":this.source+="target.clearEffects();\nruntime.ext_scratch3_looks._resetBubbles(target)\n";break;case"looks.changeEffect":this.target.effects.hasOwnProperty(A.effect)&&(this.source+='target.setEffect("'.concat(Q(A.effect),'", runtime.ext_scratch3_looks.clampEffect("').concat(Q(A.effect),'", ').concat(this.descendInput(A.value).asNumber(),' + target.effects["').concat(Q(A.effect),'"]));\n'));break;case"looks.changeSize":this.source+="target.setSize(target.size + ".concat(this.descendInput(A.size).asNumber(),");\n");break;case"looks.forwardLayers":this.target.isStage||(this.source+="target.goForwardLayers(".concat(this.descendInput(A.layers).asNumber(),");\n"));break;case"looks.goToBack":this.target.isStage||(this.source+="target.goToBack();\n");break;case"looks.goToFront":this.target.isStage||(this.source+="target.goToFront();\n");break;case"looks.targetFront":if(!this.target.isStage){const e=this.descendInput(A.layers).asString(),t=this.localVariables.next(),n=this.localVariables.next(),i=this.localVariables.next();this.source+="const ".concat(t," = runtime.getSpriteTargetByName(").concat(e,");\n"),this.source+="if (".concat(t,") {\n"),this.source+="const ".concat(i," = target.getLayerOrder();\n"),this.source+="const ".concat(n," = ").concat(t,".getLayerOrder();\n"),this.source+="if (".concat(n," > ").concat(i,") target.goForwardLayers(").concat(n," - ").concat(i,");\n"),this.source+="else target.goForwardLayers(".concat(n," - ").concat(i," + 1);\n"),this.source+="}\n"}break;case"looks.targetBack":if(!this.target.isStage){const e=this.descendInput(A.layers).asString(),t=this.localVariables.next(),n=this.localVariables.next(),i=this.localVariables.next();this.source+="const ".concat(t," = runtime.getSpriteTargetByName(").concat(e,");\n"),this.source+="if (".concat(t,") {\n"),this.source+="const ".concat(i," = target.getLayerOrder();\n"),this.source+="const ".concat(n," = ").concat(t,".getLayerOrder();\n"),this.source+="if (".concat(n," > ").concat(i,") target.goForwardLayers(").concat(n," - ").concat(i," - 1);\n"),this.source+="else target.goForwardLayers(".concat(n," - ").concat(i,");\n"),this.source+="}\n"}break;case"looks.hide":this.source+="target.setVisible(false);\n",this.source+="runtime.ext_scratch3_looks._renderBubble(target);\n";break;case"looks.nextBackdrop":this.source+="runtime.ext_scratch3_looks._setBackdrop(stage, stage.currentCostume + 1, true);\n";break;case"looks.nextCostume":this.source+="target.setCostume(target.currentCostume + 1);\n";break;case"looks.setEffect":this.target.effects.hasOwnProperty(A.effect)&&(this.source+='target.setEffect("'.concat(Q(A.effect),'", runtime.ext_scratch3_looks.clampEffect("').concat(Q(A.effect),'", ').concat(this.descendInput(A.value).asNumber(),"));\n"));break;case"looks.setSize":this.source+="target.setSize(".concat(this.descendInput(A.size).asNumber(),");\n");break;case"looks.setFont":this.source+="runtime.ext_scratch3_looks.setFont({ font: ".concat(this.descendInput(A.font).asString(),", size: ").concat(this.descendInput(A.size).asNumber()," }, { target: target });\n");break;case"looks.setColor":this.source+='runtime.ext_scratch3_looks.setColor({ prop: "'.concat(Q(A.prop),'", color: ').concat(this.descendInput(A.color).asColor()," }, { target: target });\n");break;case"looks.setTintColor":this.source+="runtime.ext_scratch3_looks.setTintColor({ color: ".concat(this.descendInput(A.color).asColor()," }, { target: target });\n");break;case"looks.setShape":this.source+='runtime.ext_scratch3_looks.setShape({ prop: "'.concat(Q(A.prop),'", color: ').concat(this.descendInput(A.value).asColor()," }, { target: target });\n");break;case"looks.show":this.source+="target.setVisible(true);\n",this.source+="runtime.ext_scratch3_looks._renderBubble(target);\n";break;case"looks.switchBackdrop":this.source+="runtime.ext_scratch3_looks._setBackdrop(stage, ".concat(this.descendInput(A.backdrop).asSafe(),");\n");break;case"looks.switchCostume":this.source+="runtime.ext_scratch3_looks._setCostume(target, ".concat(this.descendInput(A.costume).asSafe(),");\n");break;case"motion.changeX":this.source+="target.setXY(target.x + ".concat(this.descendInput(A.dx).asNumber(),", target.y);\n");break;case"motion.changeY":this.source+="target.setXY(target.x, target.y + ".concat(this.descendInput(A.dy).asNumber(),");\n");break;case"motion.ifOnEdgeBounce":this.source+="runtime.ext_scratch3_motion._ifOnEdgeBounce(target);\n";break;case"motion.setDirection":this.source+="target.setDirection(".concat(this.descendInput(A.direction).asNumber(),");\n");break;case"motion.setRotationStyle":this.source+='target.setRotationStyle("'.concat(Q(A.style),'");\n');break;case"motion.setX":case"motion.setY":case"motion.setXY":{this.descendedIntoModulo=!1;const e="x"in A?this.descendInput(A.x).asNumber():"target.x",t="y"in A?this.descendInput(A.y).asNumber():"target.y";this.source+="target.setXY(".concat(e,", ").concat(t,");\n"),this.descendedIntoModulo&&(this.source+="if (target.interpolationData) target.interpolationData = null;\n");break}case"motion.step":this.source+="runtime.ext_scratch3_motion._moveSteps(".concat(this.descendInput(A.steps).asNumber(),", target);\n");break;case"noop":console.warn("unexpected noop");break;case"pen.clear":this.source+="".concat(u,".clear();\n");break;case"pen.down":this.source+="".concat(u,"._penDown(target);\n");break;case"pen.changeParam":this.source+="".concat(u,"._setOrChangeColorParam(").concat(this.descendInput(A.param).asString(),", ").concat(this.descendInput(A.value).asNumber(),", ").concat(l,", true);\n");break;case"pen.changeSize":this.source+="".concat(u,"._changePenSizeBy(").concat(this.descendInput(A.size).asNumber(),", target);\n");break;case"pen.legacyChangeHue":this.source+="".concat(u,"._changePenHueBy(").concat(this.descendInput(A.hue).asNumber(),", target);\n");break;case"pen.legacyChangeShade":this.source+="".concat(u,"._changePenShadeBy(").concat(this.descendInput(A.shade).asNumber(),", target);\n");break;case"pen.legacySetHue":this.source+="".concat(u,"._setPenHueToNumber(").concat(this.descendInput(A.hue).asNumber(),", target);\n");break;case"pen.legacySetShade":this.source+="".concat(u,"._setPenShadeToNumber(").concat(this.descendInput(A.shade).asNumber(),", target);\n");break;case"pen.setColor":this.source+="".concat(u,"._setPenColorToColor(").concat(this.descendInput(A.color).asColor(),", target);\n");break;case"pen.setParam":this.source+="".concat(u,"._setOrChangeColorParam(").concat(this.descendInput(A.param).asString(),", ").concat(this.descendInput(A.value).asNumber(),", ").concat(l,", false);\n");break;case"pen.setSize":this.source+="".concat(u,"._setPenSizeTo(").concat(this.descendInput(A.size).asNumber(),", target);\n");break;case"pen.stamp":this.source+="".concat(u,"._stamp(target);\n");break;case"pen.up":this.source+="".concat(u,"._penUp(target);\n");break;case"procedures.return":A.isDefineClicked?this.retire():this.source+="return ".concat(this.descendInput(A.return).asUnknown(),";\n");break;case"procedures.call":{const e=A.code,t=A.variant,n=this.ir.procedures[t];if(null===n.stack)break;if(this.isWarp||e!==this.script.procedureCode||this.yieldNotWarp(),n.yields&&(this.source+="yield* ",!this.script.yields))throw new Error("Script uses yielding procedure but is not marked as yielding.");if(this.source+='thread.procedures["'.concat(Q(t),'"]('),n.arguments.length){const e=[];for(const t of A.arguments)e.push(this.descendInput(t).asSafe());this.source+=e.join(",")}if(this.source+=");\n","hat"===A.type)throw new Error("Custom hat blocks are not supported");this.resetVariableInputs();break}case"timer.reset":this.source+="runtime.ioDevices.clock.resetProjectTimer();\n";break;case"tw.debugger":this.source+="debugger;\n";break;case"var.hide":this.source+='runtime.monitorBlocks.changeBlock({ id: "'.concat(Q(A.variable.id),'", element: "checkbox", value: false }, runtime);\n');break;case"var.set":{const e=this.descendVariable(A.variable),t=this.descendInput(A.value);e.setInput(t),this.source+="".concat(e.source," = ").concat(t.asSafe(),";\n"),A.variable.isCloud&&(this.source+='runtime.ioDevices.cloud.requestUpdateVariable("'.concat(Q(A.variable.name),'", ').concat(e.source,");\n"));break}case"var.show":this.source+='runtime.monitorBlocks.changeBlock({ id: "'.concat(Q(A.variable.id),'", element: "checkbox", value: true }, runtime);\n');break;case"visualReport":{const e=this.localVariables.next();this.source+="const ".concat(e," = ").concat(this.descendInput(A.input,!0).asUnknown(),";\n"),this.source+="if (".concat(e,' !== undefined) runtime.visualReport("').concat(Q(this.script.topBlockId),'", ').concat(e,");\n");break}case"sensing.set.of":{const e=this.descendInput(A.object),t=this.descendInput(A.value),n=A.property,i="_stage_"===A.object.value,r=this.localVariables.next();switch(this.source+="var ".concat(r," = ").concat(i?"stage":"runtime.getSpriteTargetByName(".concat(e.asString(),")"),";\n"),this.source+="if (".concat(r,")"),n){case"volume":this.source+="runtime.ext_scratch3_sound._updateVolume(".concat(t.asNumber(),", ").concat(r,");\n");break;case"x position":this.source+="".concat(r,".setXY(").concat(t.asNumber(),", ").concat(r,".y);\n");break;case"y position":this.source+="".concat(r,".setXY(").concat(r,".x, ").concat(t.asNumber(),");\n");break;case"direction":this.source+="".concat(r,".setDirection(").concat(t.asNumber(),");\n");break;case"costume":const A=1===t.type?t.asNumber():t.asString();this.source+="runtime.ext_scratch3_looks._setCostume(".concat(r,", ").concat(A,");\n");break;case"backdrop":const e=1===t.type?t.asNumber():t.asString();this.source+="runtime.ext_scratch3_looks._setBackdrop(".concat(r,", ").concat(e,");\n");break;case"size":this.source+="".concat(r,".setSize(").concat(t.asNumber(),");\n");break;default:const i=this.localVariables.next();this.source+="{\nconst ".concat(i," = ").concat(r," ? ").concat(r,'.lookupVariableByNameAndType("').concat(Q(n),'", "", true) : "";\n'),this.source+="if (".concat(i,") "),this.source+="".concat(i,".value = ").concat(t.asString(),";\n}\n")}break}case"tempVars.set":{const e=this.descendInput(A.var),t=this.descendInput(A.val),n=A.runtime?"runtime.variables":A.thread?"thread.variables":"tempVars";this.source+=this.isOptimized?"".concat(n,"[").concat(e.asString(),"] = ").concat(t.asUnknown(),";\n"):"set(".concat(n,", ").concat(e.asString(),", ").concat(t.asUnknown(),");\n");break}case"tempVars.delete":{const e=this.descendInput(A.var),t=A.runtime?"runtime.variables":A.thread?"thread.variables":"tempVars";this.source+=this.isOptimized?"delete ".concat(t,"[").concat(e.asString(),"];\n"):"remove(".concat(t,", ").concat(e.asString(),");\n");break}case"tempVars.deleteAll":{const e=A.runtime?"runtime.variables":A.thread?"thread.variables":"tempVars";this.source+="".concat(e," = Object.create(null);\n");break}case"tempVars.forEach":{const e=this.descendInput(A.var),t=this.descendInput(A.loops),n=A.runtime?"runtime.variables":A.thread?"thread.variables":"tempVars",i=this.localVariables.next(),r=this.localVariables.next(),o=this.isOptimized?"".concat(n,"[").concat(e.asString(),"]"):"".concat(i,"[").concat(r,"]");this.isOptimized||(this.source+="const [".concat(i,",").concat(r,"] = _resolveKeyPath(").concat(n,", ").concat(e.asString(),"); ")),this.source+="".concat(o," = 0; "),this.source+="while (".concat(o," < ").concat(t.asNumber(),") { "),this.source+="".concat(o,"++;\n"),this.descendStack(A.do,new D(!0,"tempVars.forEach")),this.yieldLoop(),this.source+="}\n";break}case"control.dualBlock":this.source+='console.log("dual block works");\n';break;default:throw r.warn("JS: Unknown stacked block: ".concat(A.kind),A),new Error("JS: Unknown stacked block: ".concat(A.kind))}}descendInputRecord(A){let e="{";for(const t of Object.keys(A)){const n=A[t];e+='"'.concat(Q(t),'":').concat(this.descendInput(n).asSafe(),",")}return e+="}",e}resetVariableInputs(){this.variableInputs={}}descendStack(A,e){this.resetVariableInputs(),e.assignData(this.currentFrame),this.pushFrame(e);for(let t=0;t<A.length;t++)e.isLastBlock=t===A.length-1,this.descendStackedBlock(A[t]);this.resetVariableInputs(),this.popFrame()}descendVariable(A){if(this.variableInputs.hasOwnProperty(A.id))return this.variableInputs[A.id];const e=new p("".concat(this.referenceVariable(A),".value"));return this.variableInputs[A.id]=e,e}referenceVariable(A){return"target"===A.scope?this.evaluateOnce('target.variables["'.concat(Q(A.id),'"]')):this.evaluateOnce('stage.variables["'.concat(Q(A.id),'"]'))}evaluateOnce(A){if(this._setupVariables.hasOwnProperty(A))return this._setupVariables[A];const e=this._setupVariablesPool.next();return this._setupVariables[A]=e,e}retire(){this.isProcedure?this.source+="retire(); yield;\n":this.source+="retire(); return;\n"}yieldLoop(){this.warpTimer?this.yieldStuckOrNotWarp():this.yieldNotWarp()}yieldNotWarp(){this.isWarp||(this.source+="yield;\n",this.yielded())}yieldStuckOrNotWarp(){this.isWarp?this.source+="if (isStuck()) yield;\n":this.source+="yield;\n",this.yielded()}yielded(){if(!this.script.yields)throw new Error("Script yielded but is not marked as yielding.");this.resetVariableInputs()}requestRedraw(){this.source+="runtime.requestRedraw();\n"}safeConstantInput(A){const e="string"==typeof A&&this.namesOfCostumesAndSounds.has(A);return new m(A,!e)}generateCompatibilityLayerCall(A,e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3?arguments[3]:void 0;const i=A.opcode;let r="yield* executeInCompatibilityLayer({";for(const e of Object.keys(A.inputs)){const t=A.inputs[e];if(e.startsWith("substack")){r+='"'.concat(Q(e.toLowerCase()),'":(function* () {\n'),this.descendStack(t,new D(!0,i)),r+="}),";continue}const n=this.descendInput(t).asSafe();r+='"'.concat(Q(e),'":').concat(n,",")}for(const e of Object.keys(A.fields)){const t=A.fields[e];"string"==typeof t?r+='"'.concat(Q(e),'":"').concat(Q(t),'",'):r+='"'.concat(Q(e),'":').concat(JSON.stringify(t),",")}r+='"mutation":'.concat(JSON.stringify(A.mutation),",");const o=this.evaluateOnce('runtime.getOpcodeFunction("'.concat(Q(i),'")'));return r+="}, ".concat(o,", ").concat(this.isWarp,", ").concat(e,', "').concat(Q(A.id),'", ').concat(t,", ").concat(n,")"),r}getScriptFactoryName(){return C.next()}getScriptName(A){let e=A?M.next():I.next();if(this.isProcedure){const A=this.script.procedureCode.replace(/%[\w]/g,"").replace(/[^a-zA-Z0-9]/g,"_").substring(0,20);e+="_".concat(A)}return e}createScriptFactory(){let A="";A+="(function ".concat(this.getScriptFactoryName(),"(thread) { "),A+="let __target = thread.target; ",A+="let target = __target; ",A+="const runtime = __target.runtime; ",A+="const stage = runtime.getTargetForStage();\n";for(const e of Object.keys(this._setupVariables)){const t=this._setupVariables[e];A+="const ".concat(t," = ").concat(e,";\n")}if(A+="return ",this.script.yields?A+="function* ":A+="function ",A+=this.getScriptName(this.script.yields),A+=" (",this.script.arguments.length){const e=[];for(let A=0;A<this.script.arguments.length;A++)e.push("p".concat(A));A+=e.join(",")}return A+=") {\n",A+="let tempVars = Object.create(null);",A+="let target = __target;\n",A+="if (thread.spoofing) {\n",A+="target = thread.spoofTarget;\n",A+="};\n",A+="try {\n",A+=this.source,A+="} catch (err) {",A+='console.log("'.concat(Q(A),'");\n'),A+="console.error(err);",A+='runtime.emit("BLOCK_STACK_ERROR", {',A+='id:"'.concat(Q(this.script.topBlockId),'",'),A+="value:String(err)",A+="});\n",A+="}\n",this.isProcedure||(A+="retire();\n"),A+="}; })",A}compile(){this.script.stack&&this.descendStack(this.script.stack,new D(!1));const A=this.createScriptFactory(),e=B.scopedEval(A);return this.debug&&r.info("JS: ".concat(this.target.getName(),": compiled ").concat(this.script.procedureCode||"script"),A),Y.testingApparatus&&Y.testingApparatus.report(this,A),e}}n=Y,i(Y,"exports",{TypedInput:d,ConstantInput:m,VariableInput:p,Frame:D,VariablePool:a,TYPE_NUMBER:1,TYPE_STRING:2,TYPE_BOOLEAN:3,TYPE_UNKNOWN:4,TYPE_NUMBER_NAN:5,PEN_EXT:u,PEN_STATE:l,factoryNameVariablePool:C,functionNameVariablePool:I,generatorNameVariablePool:M,sanitize:Q}),i(Y,"unstable_exports",n.exports),i(Y,"_extensionJSInfo",{}),Y.testingApparatus=null,A.exports=Y},function(A,e,t){const n=t(59),i=t(94),r=t(5),o=t(36),{Map:s}=t(34),a=t(2),B=new n;let c=-1;const g=function(A,e,t,n,i){const r=n.id,a=n.opcode,B=n._isHat;if(t.pushReportedValue(A),B)if(t.stackClick)t.status=o.STATUS_RUNNING;else if(e.runtime.getIsEdgeActivatedHat(a)){const n=t.target.hasEdgeActivatedValue(r),i=t.target.updateEdgeActivatedValue(r,A);(n?!i&&A:A)?t.status=o.STATUS_RUNNING:e.retireThread(t)}else A?t.status=o.STATUS_RUNNING:e.retireThread(t);else{if(i&&void 0!==A&&t.atStackTop()&&(t.stackClick&&e.runtime.visualReport(r,A),t.updateMonitor)){const t=e.runtime.monitorBlocks.getBlock(r).targetId;if(t&&!e.runtime.getTargetById(t))return;e.runtime.requestUpdateMonitor(s({id:r,spriteName:t?e.runtime.getTargetById(t).getName():null,value:A}))}t.status=o.STATUS_RUNNING}},E=(A,e,t,n,i)=>{t.status===o.STATUS_RUNNING&&(t.status=o.STATUS_PROMISE_WAIT),A.then(A=>{if(g(A,e,t,n,i),i&&(!n._isHat||t.stackClick)){let A,e;do{const n=t.popStack();if(null===n)return;if(e=t.target.blocks.getNextBlock(n),null!==e)break;A=t.peekStackFrame()}while(null!==A&&!A.isLoop);t.pushStack(e)}},A=>{r.warn("Primitive rejected promise: ",A),t.status=o.STATUS_RUNNING,t.popStack()})};class Q{constructor(A,e){this.id=e.id,this.opcode=e.opcode,this.fields=e.fields,this.inputs=e.inputs,this.mutation=e.mutation,this._profiler=null,this._profilerFrame=null,this._isHat=!1,this._blockFunction=null,this._definedBlockFunction=!1,this._isShadowBlock=!1,this._shadowValue=null,this._fields=Object.assign({},this.fields),this._inputs=Object.assign({},this.inputs),this._argValues={mutation:this.mutation},this._parentKey=null,this._parentValues=null,this._ops=[];const{runtime:t}=B.sequencer,{opcode:n,fields:r,inputs:o}=this;this._isHat=t.getIsHat(n),this._blockFunction=t.getOpcodeFunction(n),this._definedBlockFunction=void 0!==this._blockFunction;const s=Object.keys(r);this._isShadowBlock=!this._definedBlockFunction&&1===s.length&&0===Object.keys(o).length,this._shadowValue=this._isShadowBlock&&r[s[0]].value;for(const A in r){const e=r[A];"string"==typeof e.variableType?this._argValues[A]={id:e.id,name:e.value}:this._argValues[A]=e.value}if(delete this._inputs.custom_block,"BROADCAST_INPUT"in this._inputs){this._argValues.BROADCAST_OPTION={id:null,name:null};const e=this._inputs.BROADCAST_INPUT;if(e.block===e.shadow){const t=A.getBlock(e.shadow).fields.BROADCAST_OPTION;this._argValues.BROADCAST_OPTION.id=t.id,this._argValues.BROADCAST_OPTION.name=t.value,delete this._inputs.BROADCAST_INPUT}}for(const e in this._inputs){const t=this._inputs[e];if(t.block){const n=i.getCached(A,t.block,Q);if(n._isHat)continue;this._ops.push(...n._ops),n._parentKey=e,n._parentValues=this._argValues,n._isShadowBlock&&(this._argValues[e]=n._shadowValue)}}this._definedBlockFunction&&this._ops.push(this)}}A.exports=function(A,e){const t=A.runtime;B.sequencer=A,B.thread=e;const n=e.peekStack(),r=e.peekStackFrame();let s=e.blockContainer,u=i.getCached(s,n,Q);if(null===u&&(s=t.flyoutBlocks,u=i.getCached(s,n,Q),null===u))return void A.retireThread(e);const l=u._ops,w=l.length;let h=0;if(null!==r.reported){const A=r.reported;for(;h<A.length;h++){const{opCached:e,inputValue:t}=A[h],n=l.find(A=>A.id===e);if(n){const A=n._parentKey,e=n._parentValues;"BROADCAST_INPUT"===A?(e.BROADCAST_OPTION.id=null,e.BROADCAST_OPTION.name=a.toString(t)):e[A]=t}}if(A.length>0){const e=A.reverse().find(A=>l.find(e=>e.id===A.opCached));h=e?l.findIndex(A=>A.id===e.opCached)+1:0}if(null!==e.justReported&&l[h]&&l[h].id===r.reporting){const A=l[h],t=e.justReported;e.justReported=null;const n=A._parentKey,i=A._parentValues;"BROADCAST_INPUT"===n?(i.BROADCAST_OPTION.id=null,i.BROADCAST_OPTION.name=a.toString(t)):i[n]=t,h+=1}r.reporting=null,r.reported=null}const C=h;for(;h<w;h++){const t=h===w-1,n=l[h],i=n._blockFunction,c=n._argValues;s.forceNoGlow||(e.requestScriptGlowInFrame=!0);const Q=i(c,B);if(null!==(I=Q)&&"object"==typeof I&&"function"==typeof I.then){E(Q,A,e,n,t),e.justReported=null,r.reporting=l[h].id,r.reported=l.slice(0,h).map(A=>{const e=A._parentKey,t=A._parentValues;return"BROADCAST_INPUT"===e?{opCached:A.id,inputValue:t[e].BROADCAST_OPTION.name}:{opCached:A.id,inputValue:t[e]}});break}if(e.status===o.STATUS_RUNNING)if(t)g(Q,A,e,n,t);else{const A=n._parentKey,e=n._parentValues;"BROADCAST_INPUT"===A?(e.BROADCAST_OPTION.id=null,e.BROADCAST_OPTION.name=a.toString(Q)):e[A]=Q}else if(e.status===o.STATUS_DONE)break}var I;if(null!==t.profiler){u._profiler!==t.profiler&&function(A,e){e._profiler=A,-1===c&&(c=A.idByName("blockFunction"));const t=e._ops;for(let e=0;e<t.length;e++)t[e]._profilerFrame=A.frame(c,t[e].opcode)}(t.profiler,u);const A=Math.min(h+1,w);for(let e=C;e<A;e++)l[e]._profilerFrame.count+=1}}},function(A,e){const t=new Set;A.exports=function(){let A=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Proxy(A,{set:function(A,e,n){return t.has(e)||(console.warn("extensionStorage APIs are deprecated. Please avoid using them in your extensions."),t.add(e)),A[e]=n}})}},function(A,e){A.exports={DEFAULT:null,LEFT:"LEFT",CENTER:"CENTRE",RIGHT:"RIGHT"}},function(A,e){A.exports=function(A,e,t){this.x=A,this.y=e,this.walkable=void 0===t||t}},function(A,e,t){var n=t(44),i=t(26),r=t(37),o=t(12);function s(A){A=A||{},this.allowDiagonal=A.allowDiagonal,this.dontCrossCorners=A.dontCrossCorners,this.heuristic=A.heuristic||r.manhattan,this.weight=A.weight||1,this.diagonalMovement=A.diagonalMovement,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=o.OnlyWhenNoObstacles:this.diagonalMovement=o.IfAtMostOneObstacle:this.diagonalMovement=o.Never),this.diagonalMovement===o.Never?this.heuristic=A.heuristic||r.manhattan:this.heuristic=A.heuristic||r.octile}s.prototype.findPath=function(A,e,t,r,o){var s,a,B,c,g,E,Q,u,l=new n((function(A,e){return A.f-e.f})),w=o.getNodeAt(A,e),h=o.getNodeAt(t,r),C=this.heuristic,I=this.diagonalMovement,M=this.weight,d=Math.abs,m=Math.SQRT2;for(w.g=0,w.f=0,l.push(w),w.opened=!0;!l.empty();){if((s=l.pop()).closed=!0,s===h)return i.backtrace(h);for(c=0,g=(a=o.getNeighbors(s,I)).length;c<g;++c)(B=a[c]).closed||(E=B.x,Q=B.y,u=s.g+(E-s.x==0||Q-s.y==0?1:m),(!B.opened||u<B.g)&&(B.g=u,B.h=B.h||M*C(d(E-t),d(Q-r)),B.f=B.g+B.h,B.parent=s,B.opened?l.updateItem(B):(l.push(B),B.opened=!0)))}return[]},A.exports=s},function(A,e,t){var n=t(44),i=t(26),r=t(37),o=t(12);function s(A){A=A||{},this.allowDiagonal=A.allowDiagonal,this.dontCrossCorners=A.dontCrossCorners,this.diagonalMovement=A.diagonalMovement,this.heuristic=A.heuristic||r.manhattan,this.weight=A.weight||1,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=o.OnlyWhenNoObstacles:this.diagonalMovement=o.IfAtMostOneObstacle:this.diagonalMovement=o.Never),this.diagonalMovement===o.Never?this.heuristic=A.heuristic||r.manhattan:this.heuristic=A.heuristic||r.octile}s.prototype.findPath=function(A,e,t,r,o){var s,a,B,c,g,E,Q,u,l=function(A,e){return A.f-e.f},w=new n(l),h=new n(l),C=o.getNodeAt(A,e),I=o.getNodeAt(t,r),M=this.heuristic,d=this.diagonalMovement,m=this.weight,p=Math.abs,F=Math.SQRT2;for(C.g=0,C.f=0,w.push(C),C.opened=1,I.g=0,I.f=0,h.push(I),I.opened=2;!w.empty()&&!h.empty();){for((s=w.pop()).closed=!0,c=0,g=(a=o.getNeighbors(s,d)).length;c<g;++c)if(!(B=a[c]).closed){if(2===B.opened)return i.biBacktrace(s,B);E=B.x,Q=B.y,u=s.g+(E-s.x==0||Q-s.y==0?1:F),(!B.opened||u<B.g)&&(B.g=u,B.h=B.h||m*M(p(E-t),p(Q-r)),B.f=B.g+B.h,B.parent=s,B.opened?w.updateItem(B):(w.push(B),B.opened=1))}for((s=h.pop()).closed=!0,c=0,g=(a=o.getNeighbors(s,d)).length;c<g;++c)if(!(B=a[c]).closed){if(1===B.opened)return i.biBacktrace(B,s);E=B.x,Q=B.y,u=s.g+(E-s.x==0||Q-s.y==0?1:F),(!B.opened||u<B.g)&&(B.g=u,B.h=B.h||m*M(p(E-A),p(Q-e)),B.f=B.g+B.h,B.parent=s,B.opened?h.updateItem(B):(h.push(B),B.opened=2))}}return[]},A.exports=s},function(A,e){A.exports=class{constructor(A,e){this.callback=A,this.maxConcurrent=e,this._current=0,this._queue=[]}do(){for(var A=arguments.length,e=new Array(A),t=0;t<A;t++)e[t]=arguments[t];return new Promise((A,t)=>{this._queue.push([A,t,e]),this._startNext()})}_startNext(){if(this._current>=this.maxConcurrent||0===this._queue.length)return;this._current++;const[A,e,t]=this._queue.shift();this.callback.apply(null,t).then(e=>{A(e),this._current--,this._startNext()}).catch(A=>{e(A),this._current--,this._startNext()})}}},function(A,e,t){const n=t(6),i=t(10),r=t(2),o=t(7),{translateForCamera:s}=t(41),a=t(410),B=t(16),c=t(411),g=t(24);class E extends a{constructor(A,e){super(e,A.blocks),this.customId="pm-rendered-target",this.sprite=A,this.renderer=null,this.runtime&&(this.renderer=this.runtime.renderer),this.drawableID=null,this.dragging=!1,this.effects={color:0,fisheye:0,whirl:0,pixelate:0,mosaic:0,brightness:0,ghost:0,red:0,green:0,blue:0,opaque:0,saturation:0,tintColor:16777216},this.isOriginal=!0,this.isStage=!1,this.isDisposed=!1,this.x=0,this.y=0,this.transform=[0,0],this.direction=90,this.draggable=!1,this.visible=!0,this.size=100,this.stretch=[100,100],this.currentCostume=0,this.rotationStyle=E.ROTATION_STYLE_ALL_AROUND,this.volume=100,this.tempo=60,this.videoTransparency=50,this.videoState=E.VIDEO_STATE.ON,this.textToSpeechLanguage=null,this.onTargetMoved=null,this.onTargetVisualChange=null,this.interpolationData=null,this.cameraBound="default"}cameraUpdateEvent(){const{direction:A,scale:e}=this._getRenderedDirectionAndScale(),t=this._translatePossitionToCamera();this.renderer.updateDrawablePosition(this.drawableID,t),this.renderer.updateDrawableDirectionScale(this.drawableID,A,e,this.transform),this.renderer.updateDrawableVisible(this.drawableID,this.visible)}initDrawable(A){this.renderer&&(this.drawableID=this.renderer.createDrawable(A)),this.isOriginal||this.runtime.startHats("control_start_as_clone",null,this)}get audioPlayer(){console.warn("get audioPlayer deprecated, please update to use .sprite.soundBank methods"),console.warn(new Error("stack for debug").stack);const A=this.sprite.soundBank,e={playSound:e=>A.play(this,e)};return Object.defineProperty(this,"audioPlayer",{configurable:!1,enumerable:!0,writable:!1,value:e}),e}initAudio(){}static get ROTATION_STYLE_ALL_AROUND(){return"all around"}static get ROTATION_STYLE_LOOK_AT(){return"look at"}static get ROTATION_STYLE_LEFT_RIGHT(){return"left-right"}static get ROTATION_STYLE_UP_DOWN(){return"up-down"}static get ROTATION_STYLE_NONE(){return"don't rotate"}static get VIDEO_STATE(){return{OFF:"off",ON:"on",ON_FLIPPED:"on-flipped"}}emitVisualChange(){this.onTargetVisualChange&&this.onTargetVisualChange(this)}bindToCamera(A){this.cameraBound=A,this.updateAllDrawableProperties()}removeCameraBinding(){this.cameraBound=null,this.updateAllDrawableProperties()}_translatePossitionToCamera(){return this.cameraBound?s(this.runtime,this.cameraBound,this.x,this.y):[this.x,this.y]}setXY(A,e,t,n){if(this.isStage)return;if(this.dragging&&!t)return;const i=this.x,r=this.y;if(this.renderer){const t=this.runtime.runtimeOptions.fencing&&!n?this.renderer.getFencedPositionOfDrawable(this.drawableID,[A,e]):[A,e];this.x=t[0],this.y=t[1],this.renderer.updateDrawablePosition(this.drawableID,this._translatePossitionToCamera()),this.visible&&(this.emitVisualChange(),this.runtime.requestRedraw())}else this.x=A,this.y=e;this.onTargetMoved&&this.onTargetMoved(this,i,r,t),this.runtime.requestTargetsUpdate(this)}setTransform(A){if(!Array.isArray(A)||2!==A.length)throw new TypeError("Expected an Array of length 2 for the transform input");if(!this.isStage){if(this.transform=[A[0],A[1]],this.renderer){const{direction:A,scale:e}=this._getRenderedDirectionAndScale();this.renderer.updateDrawableDirectionScale(this.drawableID,A,e,this.transform),this.visible&&(this.emitVisualChange(),this.runtime.requestRedraw())}this.runtime.requestTargetsUpdate(this)}}_getRenderedDirectionAndScale(){const A=this.runtime.getCamera(this.cameraBound);let e=this.direction,t=[this.size,this.size];if(this.rotationStyle===E.ROTATION_STYLE_NONE)e=90;else if(this.rotationStyle===E.ROTATION_STYLE_LEFT_RIGHT){e=90;t=[(this.direction<0?-1:1)*this.size,this.size]}else if(this.rotationStyle===E.ROTATION_STYLE_UP_DOWN){e=90;const A=this.direction>90||this.direction<-90?-1:1;t=[this.size,A*this.size]}else if(this.rotationStyle===E.ROTATION_STYLE_LOOK_AT){const A=this.direction<0?-1:1;t=[this.size,A*this.size]}return t[0]*=this.stretch[0]/100,t[1]*=this.stretch[1]/100,this.cameraBound&&(t[0]*=A.scale,t[1]*=A.scale,e-=A.dir),{direction:e,scale:t,stretch:this.stretch}}setStretch(A,e){if(!this.isStage){if(this.stretch=[A,e],this.renderer){const{direction:A,scale:e}=this._getRenderedDirectionAndScale();this.renderer.updateDrawableDirectionScale(this.drawableID,A,e,this.transform),this.visible&&(this.emitVisualChange(),this.runtime.requestRedraw())}this.runtime.requestTargetsUpdate(this)}}setDirection(A){if(!this.isStage&&isFinite(A)){if(this.direction=this.runtime.runtimeOptions.disableDirectionClamping?A:n.wrapClamp(A,-179,180),this.renderer){const{direction:A,scale:e}=this._getRenderedDirectionAndScale();this.renderer.updateDrawableDirectionScale(this.drawableID,A,e,this.transform),this.visible&&(this.emitVisualChange(),this.runtime.requestRedraw())}this.runtime.requestTargetsUpdate(this)}}setDraggable(A){this.isStage||(this.draggable=!!A,this.runtime.requestTargetsUpdate(this))}setVisible(A){this.isStage||(this.visible=!!A,this.renderer&&(this.renderer.updateDrawableVisible(this.drawableID,this.visible),this.visible&&(this.emitVisualChange(),this.runtime.requestRedraw())),this.runtime.requestTargetsUpdate(this))}setSize(A){if(!this.isStage){if(this.renderer){this.size=Math.max(0,A);const{direction:e,scale:t}=this._getRenderedDirectionAndScale();this.renderer.updateDrawableDirectionScale(this.drawableID,e,t,this.transform),this.visible&&(this.emitVisualChange(),this.runtime.requestRedraw())}else this.size=A;this.runtime.requestTargetsUpdate(this)}}setEffect(A,e){this.effects.hasOwnProperty(A)&&(this.effects[A]=e,this.renderer&&(this.renderer.updateDrawableEffect(this.drawableID,A,e),this.visible&&(this.emitVisualChange(),this.runtime.requestRedraw())))}clearEffects(){for(const A in this.effects)this.effects.hasOwnProperty(A)&&(this.effects[A]=0);if(this.renderer){for(const A in this.effects)this.effects.hasOwnProperty(A)&&this.renderer.updateDrawableEffect(this.drawableID,A,0);this.visible&&(this.emitVisualChange(),this.runtime.requestRedraw())}}setCostume(A){if((A=Math.round(A))!==1/0&&A!==-1/0&&A||(A=0),this.currentCostume=n.wrapClamp(A,0,this.sprite.costumes.length-1),this.renderer){const A=this.sprite.costumes[this.currentCostume];this.renderer.updateDrawableSkinId(this.drawableID,A.skinId),this.visible&&(this.emitVisualChange(),this.runtime.requestRedraw())}this.runtime.requestTargetsUpdate(this)}addCostume(A,e){"number"!=typeof e||isNaN(e)?this.sprite.addCostumeAt(A,this.sprite.costumes.length):this.sprite.addCostumeAt(A,e)}renameCostume(A,e){const t=this.sprite.costumes.filter((e,t)=>A!==t).map(A=>A.name),n=this.getCostumes()[A].name,r=i.unusedName(e,t);if(this.getCostumes()[A].name=r,this.isStage){const A=this.runtime.targets;for(let e=0;e<A.length;e++){A[e].blocks.updateAssetName(n,r,"backdrop")}}else this.blocks.updateAssetName(n,r,"costume")}deleteCostume(A){const e=this.sprite.costumes.length;if(1===e)return null;if(A<0||A>=e)return null;const t=this.sprite.deleteCostumeAt(A);return A===this.currentCostume&&A===e-1?this.setCostume(A-1):A<this.currentCostume?this.setCostume(this.currentCostume-1):this.setCostume(this.currentCostume),this.runtime.requestTargetsUpdate(this),t}addSound(A,e){const t=this.sprite.sounds.map(A=>A.name);A.name=i.unusedName(A.name,t),"number"!=typeof e||isNaN(e)?this.sprite.sounds.push(A):this.sprite.sounds.splice(e,0,A)}renameSound(A,e){const t=this.sprite.sounds.filter((e,t)=>A!==t).map(A=>A.name),n=this.sprite.sounds[A].name,r=i.unusedName(e,t);this.sprite.sounds[A].name=r,this.blocks.updateAssetName(n,r,"sound")}deleteSound(A){if(A<0||A>=this.sprite.sounds.length)return null;const e=this.sprite.sounds.splice(A,1)[0];return this.runtime.requestTargetsUpdate(this),e}setRotationStyle(A){if(A===E.ROTATION_STYLE_NONE?this.rotationStyle=E.ROTATION_STYLE_NONE:A===E.ROTATION_STYLE_ALL_AROUND?this.rotationStyle=E.ROTATION_STYLE_ALL_AROUND:A===E.ROTATION_STYLE_LEFT_RIGHT?this.rotationStyle=E.ROTATION_STYLE_LEFT_RIGHT:A===E.ROTATION_STYLE_UP_DOWN?this.rotationStyle=E.ROTATION_STYLE_UP_DOWN:A===E.ROTATION_STYLE_LOOK_AT&&(this.rotationStyle=E.ROTATION_STYLE_LOOK_AT),this.renderer){const{direction:A,scale:e}=this._getRenderedDirectionAndScale();this.renderer.updateDrawableDirectionScale(this.drawableID,A,e,this.transform),this.visible&&(this.emitVisualChange(),this.runtime.requestRedraw())}this.runtime.requestTargetsUpdate(this)}getCostumeIndexByName(A){const e=this.getCostumes();for(let t=0;t<e.length;t++)if(e[t].name===A)return t;return-1}getCurrentCostume(){return this.getCostumes()[this.currentCostume]}getCostumes(){return this.sprite.costumes}reorderCostume(A,e){if((e=n.clamp(e,0,this.sprite.costumes.length-1))===(A=n.clamp(A,0,this.sprite.costumes.length-1)))return!1;const t=this.getCurrentCostume(),i=this.sprite.costumes[A];return this.sprite.deleteCostumeAt(A),this.addCostume(i,e),this.currentCostume=this.getCostumeIndexByName(t.name),!0}reorderSound(A,e){if((e=n.clamp(e,0,this.sprite.sounds.length-1))===(A=n.clamp(A,0,this.sprite.sounds.length-1)))return!1;const t=this.sprite.sounds[A];return this.deleteSound(A),this.addSound(t,e),!0}getSounds(){return this.sprite.sounds}getSoundIndexByName(A){const e=this.getSounds();for(let t=0;t<e.length;t++)if(e[t].name===A)return t;return-1}updateAllDrawableProperties(){if(this.renderer){const{direction:A,scale:e}=this._getRenderedDirectionAndScale(),t=this._translatePossitionToCamera();this.renderer.updateDrawablePosition(this.drawableID,t),this.renderer.updateDrawableDirectionScale(this.drawableID,A,e,this.transform),this.renderer.updateDrawableVisible(this.drawableID,this.visible);const n=this.getCostumes()[this.currentCostume];this.renderer.updateDrawableSkinId(this.drawableID,n.skinId);for(const A in this.effects)this.effects.hasOwnProperty(A)&&this.renderer.updateDrawableEffect(this.drawableID,A,this.effects[A]);this.visible&&(this.emitVisualChange(),this.runtime.requestRedraw())}this.runtime.requestTargetsUpdate(this)}getName(){return this.sprite.name}isSprite(){return!this.isStage&&this.isOriginal}getBounds(){return this.renderer?this.runtime.renderer.getBounds(this.drawableID):null}getBoundsForBubble(){return this.renderer?this.runtime.renderer.getBoundsForBubble(this.drawableID):null}isTouchingObject(A,e){if("_mouse_"===A){if(!this.runtime.ioDevices.mouse)return!1;const A=this.runtime.ioDevices.mouse.getClientX(),e=this.runtime.ioDevices.mouse.getClientY();return this.isTouchingPoint(A,e)}return"_edge_"===A?this.isTouchingEdge():e?this.isTouchingSpriteUnoriginals(A):this.isTouchingSprite(A)}isTouchingPoint(A,e){return!!this.renderer&&this.renderer.drawableTouching(this.drawableID,A,e)}isTouchingEdge(){if(this.renderer){const A=this.runtime.stageWidth,e=this.runtime.stageHeight,t=this.getBounds();if(t.left<-A/2||t.right>A/2||t.top>e/2||t.bottom<-e/2)return!0}return!1}isTouchingSprite(A){A=r.toString(A);const e=this.runtime.getSpriteTargetByName(A);if(!e||!this.renderer)return!1;const t=e.sprite.clones.filter(A=>!A.dragging).map(A=>A.drawableID);return this.renderer.isTouchingDrawables(this.drawableID,t)}isTouchingTarget(A){A=r.toString(A);const e=this.runtime.getTargetById(A);return!(!e||!this.renderer||e.dragging)&&this.renderer.isTouchingDrawables(this.drawableID,[e.drawableID])}isTouchingSpriteUnoriginals(A){A=r.toString(A);const e=this.runtime.getSpriteTargetByName(A);if(!e||!this.renderer)return!1;const t=e.sprite.clones.filter(A=>!A.dragging&&!A.isOriginal).map(A=>A.drawableID);return this.renderer.isTouchingDrawables(this.drawableID,t)}spriteTouchingPoint(A){A=r.toString(A);const e=this.runtime.getSpriteTargetByName(A);if(!e||!this.renderer)return null;const t=e.sprite.clones.filter(A=>!A.dragging).map(A=>A.drawableID);return this.renderer.getTouchingDrawablesPoint(this.drawableID,t)}isTouchingColor(A){return!!this.renderer&&this.renderer.isTouchingColor(this.drawableID,A)}colorIsTouchingColor(A,e){return!!this.renderer&&this.renderer.isTouchingColor(this.drawableID,A,e)}getLayerOrder(){return this.renderer?this.renderer.getDrawableOrder(this.drawableID):null}goToFront(){this.renderer&&this.renderer.setDrawableOrder(this.drawableID,1/0,B.SPRITE_LAYER),this.runtime.setExecutablePosition(this,1/0)}goToBack(){this.renderer&&this.renderer.setDrawableOrder(this.drawableID,-1/0,B.SPRITE_LAYER,!1),this.runtime.setExecutablePosition(this,-1/0)}goForwardLayers(A){this.renderer&&this.renderer.setDrawableOrder(this.drawableID,A,B.SPRITE_LAYER,!0),this.runtime.moveExecutable(this,A)}goBackwardLayers(A){this.renderer&&this.renderer.setDrawableOrder(this.drawableID,-A,B.SPRITE_LAYER,!0),this.runtime.moveExecutable(this,-A)}goBehindOther(A){if(this.renderer){const e=this.renderer.setDrawableOrder(A.drawableID,0,B.SPRITE_LAYER,!0);this.renderer.setDrawableOrder(this.drawableID,e,B.SPRITE_LAYER)}const e=this.runtime.executableTargets.indexOf(A);this.runtime.setExecutablePosition(this,e)}keepInFence(A,e,t){let n=t;n||(n={left:-this.runtime.stageWidth/2,right:this.runtime.stageWidth/2,top:this.runtime.stageHeight/2,bottom:-this.runtime.stageHeight/2});const i=this.getBounds();if(!i)return;i.left+=A-this.x,i.right+=A-this.x,i.top+=e-this.y,i.bottom+=e-this.y;let r=0,o=0;return i.left<n.left&&(r+=n.left-i.left),i.right>n.right&&(r+=n.right-i.right),i.top>n.top&&(o+=n.top-i.top),i.bottom<n.bottom&&(o+=n.bottom-i.bottom),[A+r,e+o]}makeClone(){if(!this.runtime.clonesAvailable()||this.isStage)return null;this.runtime.changeCloneCounter(1);const A=this.sprite.createClone();return A.x=this.x,A.y=this.y,A.direction=this.direction,A.draggable=this.draggable,A.visible=this.visible,A.size=this.size,A.stretch=this.stretch,A.currentCostume=this.currentCostume,A.rotationStyle=this.rotationStyle,A.effects=o.simple(this.effects),A.variables=this.duplicateVariables(),A.cameraBound=this.cameraBound,A._edgeActivatedHatValues=o.simple(this._edgeActivatedHatValues),A.initDrawable(B.SPRITE_LAYER),A.updateAllDrawableProperties(),A}duplicate(){return this.sprite.duplicate().then(A=>{const e=A.createClone();return e.x=400*(Math.random()-.5)/2,e.y=300*(Math.random()-.5)/2,e.direction=this.direction,e.draggable=this.draggable,e.visible=this.visible,e.size=this.size,e.stretch=this.stretch,e.currentCostume=this.currentCostume,e.rotationStyle=this.rotationStyle,e.effects=JSON.parse(JSON.stringify(this.effects)),e.variables=this.duplicateVariables(e.blocks),e.cameraBound=this.cameraBound,e.updateAllDrawableProperties(),e})}onGreenFlag(){this.clearEffects()}onStopAll(){this.clearEffects()}postSpriteInfo(A){const e=A.hasOwnProperty("force")?A.force:null,t=A.hasOwnProperty("x"),n=A.hasOwnProperty("y");(t||n)&&this.setXY(t?A.x:this.x,n?A.y:this.y,e),A.hasOwnProperty("direction")&&this.setDirection(A.direction),A.hasOwnProperty("draggable")&&this.setDraggable(A.draggable),A.hasOwnProperty("rotationStyle")&&this.setRotationStyle(A.rotationStyle),A.hasOwnProperty("visible")&&this.setVisible(A.visible),A.hasOwnProperty("size")&&this.setSize(A.size)}startDrag(){this.dragging=!0}stopDrag(){this.dragging=!1}toJSON(){const A=this.getCostumes();return{id:this.id,name:this.getName(),isStage:this.isStage,isDisposed:this.isDisposed,x:this.x,y:this.y,size:this.size,direction:this.direction,draggable:this.draggable,currentCostume:this.currentCostume,costume:A[this.currentCostume],costumeCount:A.length,visible:this.visible,rotationStyle:this.rotationStyle,comments:this.comments,blocks:this.blocks._blocks,variables:this.variables,costumes:A,sounds:this.getSounds(),textToSpeechLanguage:this.textToSpeechLanguage,tempo:this.tempo,volume:this.volume,videoTransparency:this.videoTransparency,videoState:this.videoState}}dispose(){this.runtime.removeListener("CAMERA_CHANGED",this.cameraUpdateEvent),this.isOriginal||this.runtime.changeCloneCounter(-1),this.isDisposed=!0,this.runtime.stopForTarget(this),this.runtime.removeExecutable(this),this.sprite.removeClone(this),this.renderer&&null!==this.drawableID&&(this.renderer.destroyDrawable(this.drawableID,this.isStage?B.BACKGROUND_LAYER:B.SPRITE_LAYER),this.visible&&(this.emitVisualChange(),this.runtime.requestRedraw()))}getCostumeType(A){const e=this,t=this.getCostumes()[A];if(t)return t.customId="pm-costume-asset",Object.defineProperty(t,"_monitorUpToDate",{get(){return this._oldName===this.name&&(this._oldSizeX===this.size[0]&&(this._oldSizeY===this.size[1]&&(this._oldAssetId===this.assetId&&this._oldIndex===e.getCostumeIndexByName(this.name))))}}),t.toReporterContent=function(){this._oldName=this.name,this._oldSizeX=this.size[0],this._oldSizeY=this.size[1],this._oldAssetId=this.assetId,this._oldIndex=e.getCostumeIndexByName(this.name);const A=document.createElement("div");return A.innerHTML='<div style="\n                box-sizing: border-box;\n                width: 5rem;\n                height: 5rem;\n                display: flex;\n                flex-direction: column;\n                justify-content: flex-start;\n                font-size: 0.625rem;\n                overflow: hidden;\n                border: 2px solid hsla(0, 0%, 0%, 0.15);\n                border-radius: 0.5rem;\n                color: hsla(225, 15%, 40%, 1);\n                user-select: none;\n            ">\n                <div style="\n                    width: 100%; \n                    height: 100%; \n                    display: flex; \n                    align-items: center; \n                    justify-content: center;\n                ">\n                    <div style="\n                        position: absolute; \n                        font-weight: bold; \n                        left: 0.45rem; \n                        top: 0.55rem; \n                        width: 1em; \n                        height: 1em;\n                        white-space: nowrap;\n                    ">\n                        '.concat(g((e.getCostumeIndexByName(this.name)+1||"X").toString()),'\n                    </div>\n                    <img \n                        style="max-width: 32px; max-height: 32px;" \n                        src="').concat(g(c(this.asset)),'"\n                    ></img>\n                </div>\n                <div style="padding: 0.25rem; text-overflow: ellipsis; white-space: nowrap;">\n                    ').concat(g(this.name),'\n                    <div style="font-size: 0.5rem; margin-top: 0.125rem">\n                        ').concat(g(Math.round(this.size[0]).toString())," x ").concat(g(Math.round(this.size[1]).toString()),"\n                    </div>\n                </div>\n            </div>"),A},t}getSoundType(A){const e=this,t=this.getSounds()[A];if(t)return t.customId="pm-sound-asset",Object.defineProperty(t,"_monitorUpToDate",{get(){return this._oldName===this.name&&(this._oldAssetId===this.assetId&&(this._oldSampleRate===this.rate&&(this._oldSampleCount===this.sampleCount&&this._oldIndex===e.getSoundIndexByName(this.name))))}}),t.toReporterContent=function(){this._oldName=this.name,this._oldAssetId=this.assetId,this._oldSampleRate=this.rate,this._oldSampleCount=this.sampleCount,this._oldIndex=e.getSoundIndexByName(this.name);const A=document.createElement("div");return A.innerHTML='<div style="\n                box-sizing: border-box;\n                width: 5rem;\n                height: 5rem;\n                display: flex;\n                flex-direction: column;\n                justify-content: flex-start;\n                font-size: 0.625rem;\n                overflow: hidden;\n                border: 2px solid hsla(0, 0%, 0%, 0.15);\n                border-radius: 0.5rem;\n                color: hsla(225, 15%, 40%, 1);\n                user-select: none;\n            ">\n                <div style="\n                    width: 100%; \n                    height: 100%; \n                    display: flex; \n                    align-items: center; \n                    justify-content: center;\n                ">\n                    <div style="\n                        position: absolute; \n                        font-weight: bold; \n                        left: 0.45rem; \n                        top: 0.55rem; \n                        width: 1em; \n                        height: 1em;\n                        white-space: nowrap;\n                    ">\n                        '.concat(g((e.getSoundIndexByName(this.name)+1||"X").toString()),'\n                    </div>\n                    <img \n                        style="max-width: 32px; max-height: 32px;" \n                        src="static/assets/63e5827c1506216bd7c9927a4e5eb558.svg"\n                    ></img>\n                </div>\n                <div style="padding: 0.25rem; text-overflow: ellipsis; white-space: nowrap;">\n                    ').concat(g(this.name),'\n                    <div style="font-size: 0.5rem; margin-top: 0.125rem">\n                        ').concat(g((this.sampleCount/this.rate).toFixed(2)),"\n                    </div>\n                </div>\n            </div>"),A},t}get _monitorUpToDate(){return this._oldName===this.getName()&&(this._oldCostumeIdx===this.currentCostume&&this._oldCostumeAssetId===this.getCurrentCostume().assetId)}toString(){return this.getName()}toReporterContent(){this._oldName=this.getName(),this._oldCostumeIdx=this.currentCostume,this._oldCostumeAssetId=this.getCurrentCostume().assetId;const A=document.createElement("div");return A.innerHTML='<div style="\n            box-sizing: border-box;\n            width: 4rem;\n            height: 4rem;\n            display: flex;\n            flex-direction: column;\n            justify-content: flex-start;\n            font-size: 0.625rem;\n            overflow: hidden;\n            cursor: pointer;\n            border: 2px solid hsla(0, 0%, 0%, 0.15);\n            border-radius: 0.5rem;\n            color: hsla(225, 15%, 40%, 1);\n            user-select: none;\n        ">\n            <div style="\n                width: 100%; \n                height: 100%; \n                display: flex; \n                align-items: center; \n                justify-content: center;\n            ">\n                <img \n                    style="max-width: 32px; max-height: 32px;" \n                    src="'.concat(g(c(this.getCurrentCostume().asset)),'"\n                ></img>\n            </div>\n            <div style="padding: 0.25rem; text-overflow: ellipsis; white-space: nowrap;">\n                ').concat(g(this.getName()),"\n            </div>\n        </div>"),A.onclick=()=>this.runtime.vm.setEditingTarget(this.id),A}}A.exports=E},function(A,e,t){
/*! @license DOMPurify 2.5.8 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.5.8/LICENSE */
A.exports=function(){"use strict";function A(e){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(A){return typeof A}:function(A){return A&&"function"==typeof Symbol&&A.constructor===Symbol&&A!==Symbol.prototype?"symbol":typeof A})(e)}function e(A,t){return(e=Object.setPrototypeOf||function(A,e){return A.__proto__=e,A})(A,t)}function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}function n(A,i,r){return(n=t()?Reflect.construct:function(A,t,n){var i=[null];i.push.apply(i,t);var r=new(Function.bind.apply(A,i));return n&&e(r,n.prototype),r}).apply(null,arguments)}function i(A){return function(A){if(Array.isArray(A))return r(A)}(A)||function(A){if("undefined"!=typeof Symbol&&null!=A[Symbol.iterator]||null!=A["@@iterator"])return Array.from(A)}(A)||function(A,e){if(A){if("string"==typeof A)return r(A,e);var t=Object.prototype.toString.call(A).slice(8,-1);return"Object"===t&&A.constructor&&(t=A.constructor.name),"Map"===t||"Set"===t?Array.from(A):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?r(A,e):void 0}}(A)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(A,e){(null==e||e>A.length)&&(e=A.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=A[t];return n}var o=Object.hasOwnProperty,s=Object.setPrototypeOf,a=Object.isFrozen,B=Object.getPrototypeOf,c=Object.getOwnPropertyDescriptor,g=Object.freeze,E=Object.seal,Q=Object.create,u="undefined"!=typeof Reflect&&Reflect,l=u.apply,w=u.construct;l||(l=function(A,e,t){return A.apply(e,t)}),g||(g=function(A){return A}),E||(E=function(A){return A}),w||(w=function(A,e){return n(A,i(e))});var h,C=U(Array.prototype.forEach),I=U(Array.prototype.pop),M=U(Array.prototype.push),d=U(String.prototype.toLowerCase),m=U(String.prototype.toString),p=U(String.prototype.match),F=U(String.prototype.replace),D=U(String.prototype.indexOf),Y=U(String.prototype.trim),f=U(RegExp.prototype.test),N=(h=TypeError,function(){for(var A=arguments.length,e=new Array(A),t=0;t<A;t++)e[t]=arguments[t];return w(h,e)});function U(A){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return l(A,e,n)}}function y(A,e,t){var n;t=null!==(n=t)&&void 0!==n?n:d,s&&s(A,null);for(var i=e.length;i--;){var r=e[i];if("string"==typeof r){var o=t(r);o!==r&&(a(e)||(e[i]=o),r=o)}A[r]=!0}return A}function T(A){var e,t=Q(null);for(e in A)!0===l(o,A,[e])&&(t[e]=A[e]);return t}function x(A,e){for(;null!==A;){var t=c(A,e);if(t){if(t.get)return U(t.get);if("function"==typeof t.value)return U(t.value)}A=B(A)}return function(A){return console.warn("fallback value for",A),null}}var R=g(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),G=g(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),S=g(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),H=g(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),b=g(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),v=g(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),k=g(["#text"]),j=g(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),J=g(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),z=g(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),L=g(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),P=E(/\{\{[\w\W]*|[\w\W]*\}\}/gm),O=E(/<%[\w\W]*|[\w\W]*%>/gm),V=E(/\${[\w\W]*}/gm),W=E(/^data-[\-\w.\u00B7-\uFFFF]+$/),K=E(/^aria-[\-\w]+$/),X=E(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Z=E(/^(?:\w+script|data):/i),_=E(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),q=E(/^html$/i),$=E(/^[a-z][.\w]*(-[.\w]+)+$/i),AA=function(){return"undefined"==typeof window?null:window},eA=function(e,t){if("object"!==A(e)||"function"!=typeof e.createPolicy)return null;var n=null;t.currentScript&&t.currentScript.hasAttribute("data-tt-policy-suffix")&&(n=t.currentScript.getAttribute("data-tt-policy-suffix"));var i="dompurify"+(n?"#"+n:"");try{return e.createPolicy(i,{createHTML:function(A){return A},createScriptURL:function(A){return A}})}catch(A){return console.warn("TrustedTypes policy "+i+" could not be created."),null}};return function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:AA(),n=function(A){return e(A)};if(n.version="2.5.8",n.removed=[],!t||!t.document||9!==t.document.nodeType)return n.isSupported=!1,n;var r=t.document,o=t.document,s=t.DocumentFragment,a=t.HTMLTemplateElement,B=t.Node,c=t.Element,E=t.NodeFilter,Q=t.NamedNodeMap,u=void 0===Q?t.NamedNodeMap||t.MozNamedAttrMap:Q,l=t.HTMLFormElement,w=t.DOMParser,h=t.trustedTypes,U=c.prototype,tA=x(U,"cloneNode"),nA=x(U,"nextSibling"),iA=x(U,"childNodes"),rA=x(U,"parentNode");if("function"==typeof a){var oA=o.createElement("template");oA.content&&oA.content.ownerDocument&&(o=oA.content.ownerDocument)}var sA=eA(h,r),aA=sA?sA.createHTML(""):"",BA=o,cA=BA.implementation,gA=BA.createNodeIterator,EA=BA.createDocumentFragment,QA=BA.getElementsByTagName,uA=r.importNode,lA={};try{lA=T(o).documentMode?o.documentMode:{}}catch(A){}var wA={};n.isSupported="function"==typeof rA&&cA&&void 0!==cA.createHTMLDocument&&9!==lA;var hA,CA,IA=P,MA=O,dA=V,mA=W,pA=K,FA=Z,DA=_,YA=$,fA=X,NA=null,UA=y({},[].concat(i(R),i(G),i(S),i(b),i(k))),yA=null,TA=y({},[].concat(i(j),i(J),i(z),i(L))),xA=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),RA=null,GA=null,SA=!0,HA=!0,bA=!1,vA=!0,kA=!1,jA=!0,JA=!1,zA=!1,LA=!1,PA=!1,OA=!1,VA=!1,WA=!0,KA=!1,XA="user-content-",ZA=!0,_A=!1,qA={},$A=null,Ae=y({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),ee=null,te=y({},["audio","video","img","source","image","track"]),ne=null,ie=y({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),re="http://www.w3.org/1998/Math/MathML",oe="http://www.w3.org/2000/svg",se="http://www.w3.org/1999/xhtml",ae=se,Be=!1,ce=null,ge=y({},[re,oe,se],m),Ee=["application/xhtml+xml","text/html"],Qe="text/html",ue=null,le=o.createElement("form"),we=function(A){return A instanceof RegExp||A instanceof Function},he=function(e){ue&&ue===e||(e&&"object"===A(e)||(e={}),e=T(e),hA=hA=-1===Ee.indexOf(e.PARSER_MEDIA_TYPE)?Qe:e.PARSER_MEDIA_TYPE,CA="application/xhtml+xml"===hA?m:d,NA="ALLOWED_TAGS"in e?y({},e.ALLOWED_TAGS,CA):UA,yA="ALLOWED_ATTR"in e?y({},e.ALLOWED_ATTR,CA):TA,ce="ALLOWED_NAMESPACES"in e?y({},e.ALLOWED_NAMESPACES,m):ge,ne="ADD_URI_SAFE_ATTR"in e?y(T(ie),e.ADD_URI_SAFE_ATTR,CA):ie,ee="ADD_DATA_URI_TAGS"in e?y(T(te),e.ADD_DATA_URI_TAGS,CA):te,$A="FORBID_CONTENTS"in e?y({},e.FORBID_CONTENTS,CA):Ae,RA="FORBID_TAGS"in e?y({},e.FORBID_TAGS,CA):{},GA="FORBID_ATTR"in e?y({},e.FORBID_ATTR,CA):{},qA="USE_PROFILES"in e&&e.USE_PROFILES,SA=!1!==e.ALLOW_ARIA_ATTR,HA=!1!==e.ALLOW_DATA_ATTR,bA=e.ALLOW_UNKNOWN_PROTOCOLS||!1,vA=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,kA=e.SAFE_FOR_TEMPLATES||!1,jA=!1!==e.SAFE_FOR_XML,JA=e.WHOLE_DOCUMENT||!1,PA=e.RETURN_DOM||!1,OA=e.RETURN_DOM_FRAGMENT||!1,VA=e.RETURN_TRUSTED_TYPE||!1,LA=e.FORCE_BODY||!1,WA=!1!==e.SANITIZE_DOM,KA=e.SANITIZE_NAMED_PROPS||!1,ZA=!1!==e.KEEP_CONTENT,_A=e.IN_PLACE||!1,fA=e.ALLOWED_URI_REGEXP||fA,ae=e.NAMESPACE||se,xA=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&we(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(xA.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&we(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(xA.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(xA.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),kA&&(HA=!1),OA&&(PA=!0),qA&&(NA=y({},i(k)),yA=[],!0===qA.html&&(y(NA,R),y(yA,j)),!0===qA.svg&&(y(NA,G),y(yA,J),y(yA,L)),!0===qA.svgFilters&&(y(NA,S),y(yA,J),y(yA,L)),!0===qA.mathMl&&(y(NA,b),y(yA,z),y(yA,L))),e.ADD_TAGS&&(NA===UA&&(NA=T(NA)),y(NA,e.ADD_TAGS,CA)),e.ADD_ATTR&&(yA===TA&&(yA=T(yA)),y(yA,e.ADD_ATTR,CA)),e.ADD_URI_SAFE_ATTR&&y(ne,e.ADD_URI_SAFE_ATTR,CA),e.FORBID_CONTENTS&&($A===Ae&&($A=T($A)),y($A,e.FORBID_CONTENTS,CA)),ZA&&(NA["#text"]=!0),JA&&y(NA,["html","head","body"]),NA.table&&(y(NA,["tbody"]),delete RA.tbody),g&&g(e),ue=e)},Ce=y({},["mi","mo","mn","ms","mtext"]),Ie=y({},["annotation-xml"]),Me=y({},["title","style","font","a","script"]),de=y({},G);y(de,S),y(de,H);var me=y({},b);y(me,v);var pe=function(A){var e=rA(A);e&&e.tagName||(e={namespaceURI:ae,tagName:"template"});var t=d(A.tagName),n=d(e.tagName);return!!ce[A.namespaceURI]&&(A.namespaceURI===oe?e.namespaceURI===se?"svg"===t:e.namespaceURI===re?"svg"===t&&("annotation-xml"===n||Ce[n]):Boolean(de[t]):A.namespaceURI===re?e.namespaceURI===se?"math"===t:e.namespaceURI===oe?"math"===t&&Ie[n]:Boolean(me[t]):A.namespaceURI===se?!(e.namespaceURI===oe&&!Ie[n])&&!(e.namespaceURI===re&&!Ce[n])&&!me[t]&&(Me[t]||!de[t]):!("application/xhtml+xml"!==hA||!ce[A.namespaceURI]))},Fe=function(A){M(n.removed,{element:A});try{A.parentNode.removeChild(A)}catch(e){try{A.outerHTML=aA}catch(e){A.remove()}}},De=function(A,e){try{M(n.removed,{attribute:e.getAttributeNode(A),from:e})}catch(A){M(n.removed,{attribute:null,from:e})}if(e.removeAttribute(A),"is"===A&&!yA[A])if(PA||OA)try{Fe(e)}catch(A){}else try{e.setAttribute(A,"")}catch(A){}},Ye=function(A){var e,t;if(LA)A="<remove></remove>"+A;else{var n=p(A,/^[\r\n\t ]+/);t=n&&n[0]}"application/xhtml+xml"===hA&&ae===se&&(A='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+A+"</body></html>");var i=sA?sA.createHTML(A):A;if(ae===se)try{e=(new w).parseFromString(i,hA)}catch(A){}if(!e||!e.documentElement){e=cA.createDocument(ae,"template",null);try{e.documentElement.innerHTML=Be?aA:i}catch(A){}}var r=e.body||e.documentElement;return A&&t&&r.insertBefore(o.createTextNode(t),r.childNodes[0]||null),ae===se?QA.call(e,JA?"html":"body")[0]:JA?e.documentElement:r},fe=function(A){return gA.call(A.ownerDocument||A,A,E.SHOW_ELEMENT|E.SHOW_COMMENT|E.SHOW_TEXT|E.SHOW_PROCESSING_INSTRUCTION|E.SHOW_CDATA_SECTION,null,!1)},Ne=function(A){return A instanceof l&&("string"!=typeof A.nodeName||"string"!=typeof A.textContent||"function"!=typeof A.removeChild||!(A.attributes instanceof u)||"function"!=typeof A.removeAttribute||"function"!=typeof A.setAttribute||"string"!=typeof A.namespaceURI||"function"!=typeof A.insertBefore||"function"!=typeof A.hasChildNodes)},Ue=function(e){return"object"===A(B)?e instanceof B:e&&"object"===A(e)&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},ye=function(A,e,t){wA[A]&&C(wA[A],(function(A){A.call(n,e,t,ue)}))},Te=function(A){var e;if(ye("beforeSanitizeElements",A,null),Ne(A))return Fe(A),!0;if(f(/[\u0080-\uFFFF]/,A.nodeName))return Fe(A),!0;var t=CA(A.nodeName);if(ye("uponSanitizeElement",A,{tagName:t,allowedTags:NA}),A.hasChildNodes()&&!Ue(A.firstElementChild)&&(!Ue(A.content)||!Ue(A.content.firstElementChild))&&f(/<[/\w]/g,A.innerHTML)&&f(/<[/\w]/g,A.textContent))return Fe(A),!0;if("select"===t&&f(/<template/i,A.innerHTML))return Fe(A),!0;if(7===A.nodeType)return Fe(A),!0;if(jA&&8===A.nodeType&&f(/<[/\w]/g,A.data))return Fe(A),!0;if(!NA[t]||RA[t]){if(!RA[t]&&Re(t)){if(xA.tagNameCheck instanceof RegExp&&f(xA.tagNameCheck,t))return!1;if(xA.tagNameCheck instanceof Function&&xA.tagNameCheck(t))return!1}if(ZA&&!$A[t]){var i=rA(A)||A.parentNode,r=iA(A)||A.childNodes;if(r&&i)for(var o=r.length-1;o>=0;--o){var s=tA(r[o],!0);s.__removalCount=(A.__removalCount||0)+1,i.insertBefore(s,nA(A))}}return Fe(A),!0}return A instanceof c&&!pe(A)?(Fe(A),!0):"noscript"!==t&&"noembed"!==t&&"noframes"!==t||!f(/<\/no(script|embed|frames)/i,A.innerHTML)?(kA&&3===A.nodeType&&(e=A.textContent,e=F(e,IA," "),e=F(e,MA," "),e=F(e,dA," "),A.textContent!==e&&(M(n.removed,{element:A.cloneNode()}),A.textContent=e)),ye("afterSanitizeElements",A,null),!1):(Fe(A),!0)},xe=function(A,e,t){if(WA&&("id"===e||"name"===e)&&(t in o||t in le))return!1;if(HA&&!GA[e]&&f(mA,e));else if(SA&&f(pA,e));else if(!yA[e]||GA[e]){if(!(Re(A)&&(xA.tagNameCheck instanceof RegExp&&f(xA.tagNameCheck,A)||xA.tagNameCheck instanceof Function&&xA.tagNameCheck(A))&&(xA.attributeNameCheck instanceof RegExp&&f(xA.attributeNameCheck,e)||xA.attributeNameCheck instanceof Function&&xA.attributeNameCheck(e))||"is"===e&&xA.allowCustomizedBuiltInElements&&(xA.tagNameCheck instanceof RegExp&&f(xA.tagNameCheck,t)||xA.tagNameCheck instanceof Function&&xA.tagNameCheck(t))))return!1}else if(ne[e]);else if(f(fA,F(t,DA,"")));else if("src"!==e&&"xlink:href"!==e&&"href"!==e||"script"===A||0!==D(t,"data:")||!ee[A])if(bA&&!f(FA,F(t,DA,"")));else if(t)return!1;return!0},Re=function(A){return"annotation-xml"!==A&&p(A,YA)},Ge=function(e){var t,i,r,o;ye("beforeSanitizeAttributes",e,null);var s=e.attributes;if(s&&!Ne(e)){var a={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:yA};for(o=s.length;o--;){var B=t=s[o],c=B.name,g=B.namespaceURI;if(i="value"===c?t.value:Y(t.value),r=CA(c),a.attrName=r,a.attrValue=i,a.keepAttr=!0,a.forceKeepAttr=void 0,ye("uponSanitizeAttribute",e,a),i=a.attrValue,!a.forceKeepAttr&&(De(c,e),a.keepAttr))if(vA||!f(/\/>/i,i)){kA&&(i=F(i,IA," "),i=F(i,MA," "),i=F(i,dA," "));var E=CA(e.nodeName);if(xe(E,r,i))if(!KA||"id"!==r&&"name"!==r||(De(c,e),i=XA+i),jA&&f(/((--!?|])>)|<\/(style|title)/i,i))De(c,e);else{if(sA&&"object"===A(h)&&"function"==typeof h.getAttributeType)if(g);else switch(h.getAttributeType(E,r)){case"TrustedHTML":i=sA.createHTML(i);break;case"TrustedScriptURL":i=sA.createScriptURL(i)}try{g?e.setAttributeNS(g,c,i):e.setAttribute(c,i),Ne(e)?Fe(e):I(n.removed)}catch(A){}}}else De(c,e)}ye("afterSanitizeAttributes",e,null)}},Se=function A(e){var t,n=fe(e);for(ye("beforeSanitizeShadowDOM",e,null);t=n.nextNode();)ye("uponSanitizeShadowNode",t,null),Te(t),Ge(t),t.content instanceof s&&A(t.content);ye("afterSanitizeShadowDOM",e,null)};return n.sanitize=function(e){var i,o,a,c,g,E=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((Be=!e)&&(e="\x3c!--\x3e"),"string"!=typeof e&&!Ue(e)){if("function"!=typeof e.toString)throw N("toString is not a function");if("string"!=typeof(e=e.toString()))throw N("dirty is not a string, aborting")}if(!n.isSupported){if("object"===A(t.toStaticHTML)||"function"==typeof t.toStaticHTML){if("string"==typeof e)return t.toStaticHTML(e);if(Ue(e))return t.toStaticHTML(e.outerHTML)}return e}if(zA||he(E),n.removed=[],"string"==typeof e&&(_A=!1),_A){if(e.nodeName){var Q=CA(e.nodeName);if(!NA[Q]||RA[Q])throw N("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof B)1===(o=(i=Ye("\x3c!----\x3e")).ownerDocument.importNode(e,!0)).nodeType&&"BODY"===o.nodeName||"HTML"===o.nodeName?i=o:i.appendChild(o);else{if(!PA&&!kA&&!JA&&-1===e.indexOf("<"))return sA&&VA?sA.createHTML(e):e;if(!(i=Ye(e)))return PA?null:VA?aA:""}i&&LA&&Fe(i.firstChild);for(var u=fe(_A?e:i);a=u.nextNode();)3===a.nodeType&&a===c||(Te(a),Ge(a),a.content instanceof s&&Se(a.content),c=a);if(c=null,_A)return e;if(PA){if(OA)for(g=EA.call(i.ownerDocument);i.firstChild;)g.appendChild(i.firstChild);else g=i;return(yA.shadowroot||yA.shadowrootmod)&&(g=uA.call(r,g,!0)),g}var l=JA?i.outerHTML:i.innerHTML;return JA&&NA["!doctype"]&&i.ownerDocument&&i.ownerDocument.doctype&&i.ownerDocument.doctype.name&&f(q,i.ownerDocument.doctype.name)&&(l="<!DOCTYPE "+i.ownerDocument.doctype.name+">\n"+l),kA&&(l=F(l,IA," "),l=F(l,MA," "),l=F(l,dA," ")),sA&&VA?sA.createHTML(l):l},n.setConfig=function(A){he(A),zA=!0},n.clearConfig=function(){ue=null,zA=!1},n.isValidAttribute=function(A,e,t){ue||he({});var n=CA(A),i=CA(e);return xe(n,i,t)},n.addHook=function(A,e){"function"==typeof e&&(wA[A]=wA[A]||[],M(wA[A],e))},n.removeHook=function(A){if(wA[A])return I(wA[A])},n.removeHooks=function(A){wA[A]&&(wA[A]=[])},n.removeAllHooks=function(){wA={}},n}()}()},function(A,e){class t{static get svg(){return"http://www.w3.org/2000/svg"}static get xmlns(){return"http://www.w3.org/2000/xmlns"}static get xlink(){return"http://www.w3.org/1999/xlink"}static attributeNamespace(){return{href:t.xlink,xlink:t.xmlns,xmlns:"".concat(t.xmlns,"/"),"xmlns:xlink":"".concat(t.xmlns,"/")}}static create(A,e,n){return t.set(document.createElementNS(t.svg,A),e,n)}static get(A,e){const n=t.attributeNamespace[e],i=n?A.getAttributeNS(n,e):A.getAttribute(e);return"null"===i?null:i}static set(A,e,n){for(const i in e){let r=e[i];const o=t.attributeNamespace[i];"number"==typeof r&&n&&(r=n.number(r)),o?A.setAttributeNS(o,i,r):A.setAttribute(i,r)}return A}}A.exports=t},function(A,e,t){const n=t(68),i=t(22),{loadSoundFromAsset:r}=t(48),{loadCostumeFromAsset:o}=t(49),s=t(109),a=t(10),B=t(16);class c{constructor(A,e){this.runtime=e,A||(A=new i(e)),this.blocks=A,this.name="",this.costumes_=[],this.sounds=[],this.clones=[],this.soundBank=null,this.runtime&&this.runtime.audioEngine&&(this.soundBank=this.runtime.audioEngine.createBank())}set costumes(A){this.costumes_=[];for(const e of A)this.addCostumeAt(e,this.costumes_.length)}get costumes(){return this.costumes_}addCostumeAt(A,e){A.name||(A.name="");const t=this.costumes_.map(A=>A.name);A.name=a.unusedName(A.name,t),this.costumes_.splice(e,0,A)}deleteCostumeAt(A){return this.costumes.splice(A,1)[0]}createClone(A){const e=new n(this,this.runtime);if(e.isOriginal=0===this.clones.length,this.clones.push(e),e.initAudio(),e.isOriginal){const t="string"==typeof A?A:B.SPRITE_LAYER;e.initDrawable(t),this.runtime.fireTargetWasCreated(e)}else this.runtime.fireTargetWasCreated(e,this.clones[0]);return e}removeClone(A){this.runtime.fireTargetWasRemoved(A);const e=this.clones.indexOf(A);e>=0&&this.clones.splice(e,1)}duplicate(){const A=new c(null,this.runtime),e=this.blocks._blocks,t=Object.keys(e).map(A=>e[A]),n=JSON.parse(JSON.stringify(t));s(n),n.forEach(e=>{A.blocks.createBlock(e)});const i=this.runtime.targets.map(A=>A.sprite.name);A.name=a.unusedName(this.name,i);const B=[];return A.costumes=this.costumes_.map(A=>{const e=Object.assign({},A);return B.push(o(e,this.runtime)),e}),A.sounds=this.sounds.map(e=>{const t=Object.assign({},e),n=e.asset;return B.push(r(t,n,this.runtime,A.soundBank)),t}),Promise.all(B).then(()=>A)}dispose(){this.soundBank&&this.soundBank.dispose()}}A.exports=c},function(A,e){A.exports=class{constructor(A){this._ctx=A,this._cache={}}beginMeasurementSession(){}endMeasurementSession(){}setFontAndSize(A,e){this._ctx.font="".concat(e,"px ").concat(A,", sans-serif"),this._cache={}}measureText(A){const e=this._ctx.font+A;return this._cache[e]||(this._cache[e]=this._ctx.measureText(A).actualBoundingBoxRight),this._cache[e]}}},function(A,e,t){"undefined"!=typeof TextDecoder&&"undefined"!=typeof TextEncoder||t(81);const n=t(32);let i=null;const r={},o={},s="function"==typeof FinalizationRegistry?new FinalizationRegistry(A=>{const e=o[A];1===e?(delete o[A],delete r[A]):o[A]=e-1}):null,a=s?A=>{const e=A.assetId,t=o[e]||0;o[e]=t+1,s.register(A,e)}:()=>{};A.exports=class{constructor(A,e,t,n,i){this.assetType=A,this.assetId=e,this.setData(n,t||A.runtimeFormat,i),this.dependencies=[],a(this)}setData(A,e,t){if(A&&!e)throw new Error("Data provided without specifying its format");this.dataFormat=e,this.data=A,t&&(this.assetId=n(A)),this.clean=!t}decodeText(){return(new TextDecoder).decode(this.data)}encodeTextData(A,e,t){const n=new TextEncoder;this.setData(n.encode(A),e,t)}encodeDataURI(A){return A=A||this.assetType.contentType,"data:".concat(A,";base64,").concat(((A,e)=>{if(!Object.prototype.hasOwnProperty.call(r,A))if("undefined"==typeof btoa){const n=t(476);r[A]=n.fromByteArray(e)}else{if(null===i){i=new Array(256);for(let A=0;A<256;A++)i[A]=String.fromCharCode(A)}const{length:t}=e;let n="";for(let A=0,r=0;A<t;A=r){r=Math.min(r+32766,t);let o="";for(let t=A;t<r;t+=1)o+=i[e[t]];n+=btoa(o)}r[A]=n}return r[A]})(this.assetId,this.data))}}},function(A,e){A.exports={JPG:"jpg",JSON:"json",MP3:"mp3",OGG:"ogg",FLAC:"flac",PNG:"png",SB2:"sb2",SB3:"sb3",SVG:"svg",WAV:"wav",TTF:"ttf",OTF:"otf",WOFF:"woff",WOFF2:"woff2",TXT:"txt"}},function(A,e,t){"use strict";(function(e){A.exports=function(A){for(var t="undefined"!=typeof window&&"function"==typeof window.atob?window.atob(A):e.from(A,"base64").toString("binary"),n=new Uint8Array(t.length),i=0;i<t.length;++i)n[i]=t.charCodeAt(i);return n.buffer}}).call(this,t(20).Buffer)},function(A,e){A.exports=class{constructor(A,e,t){this.audioEngine=A,this.audioPlayer=e,this.lastEffect=t,this.value=this.DEFAULT_VALUE,this.initialized=!1,this.inputNode=null,this.outputNode=null,this.target=null}get name(){throw new Error("".concat(this.constructor.name,".name is not implemented"))}get DEFAULT_VALUE(){return 0}get _isPatch(){return this.initialized&&(this.value!==this.DEFAULT_VALUE||null===this.audioPlayer)}getInputNode(){return this._isPatch?this.inputNode:this.target.getInputNode()}initialize(){throw new Error("".concat(this.constructor.name,".initialize is not implemented."))}_set(){throw new Error("".concat(this.constructor.name,"._set is not implemented."))}set(A){this.initialized||this.initialize();const e=this._isPatch;if(e&&(this._lastPatch=this.audioEngine.currentTime),A!==this.value){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];this._set(A,...n)}this._isPatch!==e&&null!==this.target&&this.connect(this.target)}update(){}clear(){this.set(this.DEFAULT_VALUE)}connect(A){if(null===A)throw new Error("target may not be null");const e=A=>{if(A)return A===this||e(A.target)};if(e(A))throw new Error("Effect cannot connect to itself");this.target=A,null!==this.outputNode&&this.outputNode.disconnect(),(this._isPatch||this._lastPatch+this.audioEngine.DECAY_DURATION<this.audioEngine.currentTime)&&this.outputNode.connect(A.getInputNode()),null===this.lastEffect?null!==this.audioPlayer&&this.audioPlayer.connect(this):this.lastEffect.connect(this)}dispose(){this.inputNode=null,this.outputNode=null,this.target=null,this.initialized=!1}}},function(A,e,t){const n=t(126);A.exports=n},function(A,e,t){const n=t(450);A.exports=n},function(A,e,t){const n=t(486);A.exports=n},function(A,e,t){"use strict";var n=t(122),i=t.n(n),r=t(123),o=t.n(r),s=t(124),a=i()((function(A){return A[1]})),B=o()(s.a);a.push([A.i,'.sc-root {\n  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  position: relative;\n  --sc-accent-color: #ff4c4c;\n  --sc-accent-color-transparent: #ff4c4c59;\n}\n.sc-layers {\n  position: relative;\n}\n.sc-layers > * {\n  position: absolute;\n}\n.sc-scaled-overlays-outer {\n  overflow: hidden;\n  width: 100%;\n  height: 100%;\n  pointer-events: none;\n}\n.sc-scaled-overlays-inner {\n  transform-origin: top left;\n}\n.sc-root * {\n  box-sizing: border-box;\n}\n.sc-canvas {\n  width: 100%;\n  height: 100%;\n}\n\n.sc-question-root {\n  bottom: 0;\n  width: 100%;\n  color: black;\n  pointer-events: all;\n}\n.sc-question-inner {\n  margin: 0.5rem;\n  border: 1px solid hsla(0, 0%, 0%, 0.15);\n  border-radius: 0.5rem;\n  border-width: 2px;\n  padding: 1rem;\n  background: white;\n}\n.sc-question-text {\n  font-size: 12px;\n  padding-bottom: 8px;\n  font-weight: bold;\n}\n.sc-question-input-outer {\n  position: relative;\n}\n.sc-question-input {\n  width: 100%;\n  height: 2rem;\n  padding: 0 12px;\n  font-size: 10px;\n  border-width: 1px;\n  border-style: solid;\n  border-color: hsla(0, 0%, 0%, 0.15);\n  border-radius: 2rem;\n  outline: none;\n  transition: 0.25s ease-out;\n  box-shadow: none;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  color: inherit;\n}\n.sc-question-input:focus {\n  border-color: var(--sc-accent-color);\n  box-shadow: 0px 0px 0px 3px var(--sc-accent-color-transparent);\n}\n.sc-question-input:hover {\n  border-color: var(--sc-accent-color);\n}\n.sc-question-submit-button {\n  top: 4px;\n  right: 4px;\n  width: 24px;\n  height: 24px;\n  position: absolute;\n  outline: none;\n  border: none;\n  padding: 2px;\n  margin: 0;\n  border-radius: 100%;\n  background: none;\n  cursor: pointer;\n  color: white;\n  background-color: var(--sc-accent-color);\n  background-image: url('+B+');\n  overflow: hidden;\n}\n.sc-question-submit-button:focus {\n  outline: 2px solid black;\n}\n.sc-question-submit-button-image {\n  width: 100%;\n  height: 100%;\n}\n\n.sc-monitor-overlay {\n\n}\n.sc-monitor-root {\n  position: absolute;\n  top: 0;\n  left: 0;\n  background: hsla(215, 100%, 95%, 1);\n  color: #575e75;\n  border: 1px solid hsla(0, 0%, 0%, 0.15);\n  border-radius: 4px;\n  font-size: 12px;\n  overflow: hidden;\n  user-select: none;\n  -webkit-user-select: none;\n  display: flex;\n  flex-direction: column;\n  pointer-events: all;\n}\n.sc-monitor-inner {\n  display: flex;\n  flex-direction: column;\n  padding: 3px;\n}\n.sc-monitor-row {\n  display: flex;\n  flex-direction: row;\n}\n.sc-monitor-label {\n  font-weight: bold;\n  text-align: center;\n  margin: 0 5px;\n  white-space: nowrap;\n}\n.sc-monitor-slider {\n  margin: 0;\n  width: 100%;\n}\n.sc-monitor-value {\n  min-width: 40px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  text-align: center;\n  color: white;\n  margin: 0 5px;\n  border-radius: 4px;\n  padding: 0 2px;\n  white-space: pre-wrap;\n  background-color: #0fbd8c;\n}\n.sc-monitor-root[data-opcode^="motion_"] .sc-monitor-value-color {\n  background-color: #4c97ff;\n}\n.sc-monitor-root[data-opcode^="sensing_"] .sc-monitor-value-color {\n  background-color: #5cb1d6;\n}\n.sc-monitor-root[data-opcode^="data_"] .sc-monitor-value-color {\n  background-color: #ff8c1a;\n}\n.sc-monitor-root[data-opcode^="looks_"] .sc-monitor-value-color {\n  background-color: #9966ff;\n}\n.sc-monitor-root[data-opcode^="sound_"] .sc-monitor-value-color {\n  background-color: #cf63cf;\n}\n.sc-monitor-root[opcode^="control_"] .sc-monitor-value-color {\n  background-color: #FFAB19;\n}\n.sc-monitor-large-value {\n  min-height: 1.4rem;\n  min-width: 3rem;\n  padding: 0.1rem 0.25rem;\n  text-align: center;\n  color: white;\n  font-size: 1rem;\n  white-space: pre-wrap;\n}\n\n.sc-monitor-list-label {\n  background-color: white;\n  text-align: center;\n  font-weight: bold;\n  border-bottom: 1px solid hsla(0, 0%, 0%, 0.15);\n  padding: 3px;\n}\n.sc-monitor-list-footer {\n  display: flex;\n  background-color: white;\n  text-align: center;\n  font-weight: bold;\n  padding: 3px;\n}\n.sc-monitor-list-footer-text {\n  text-align: center;\n  flex-grow: 1;\n}\n.sc-monitor-row-delete, .sc-monitor-list-add {\n  font-weight: bold;\n  background: none;\n  border: none;\n  outline: none;\n  font-family: inherit;\n  color: inherit;\n  cursor: pointer;\n  margin: 0;\n  padding: 0;\n}\n.sc-monitor-rows-outer {\n  flex-grow: 1;\n}\n.sc-monitor-rows-inner {\n  height: 100%;\n  overflow-y: auto;\n  overflow-x: hidden;\n  position: relative;\n}\n.sc-monitor-rows-endpoint {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 1px;\n  height: 1px;\n  pointer-events: none;\n}\n\n.sc-monitor-row-root {\n  position: absolute;\n  top: 0;\n  left: 0;\n  display: flex;\n  justify-content: space-around;\n  align-items: center;\n  padding: 2px;\n  width: 100%;\n}\n.sc-monitor-row-index {\n  font-weight: bold;\n  color: hsla(225, 15%, 40%, 1);\n  margin: 0 3px;\n}\n.sc-monitor-row-value-outer {\n  display: flex;\n  align-items: center;\n  min-width: 40px;\n  height: 22px;\n  border: 1px solid hsla(0, 0%, 0%, 0.15);\n  background-color: #fc662c;\n  color: white;\n  margin: 0 3px;\n  border-radius: calc(0.5rem / 2);\n  flex-grow: 1;\n}\n.sc-monitor-row-value-editing .sc-monitor-row-value-outer {\n  background-color: #e25c28;\n}\n.sc-monitor-row-value-inner {\n  padding: 3px 5px;\n  width: 100%;\n  color: inherit;\n  background: none;\n  border: none;\n  font: inherit;\n  outline: none;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  user-select: text;\n  -webkit-user-select: text;\n  white-space: pre;\n}\n.sc-monitor-row-value-editing .sc-monitor-row-value-inner {\n  padding-right: 0;\n}\n.sc-monitor-row-delete {\n  display: none;\n  font-size: 150%;\n  padding: 0 2px;\n}\n.sc-monitor-row-value-editing .sc-monitor-row-delete {\n  display: block;\n}\n.sc-monitor-empty {\n  text-align: center;\n  padding: 5px;\n}\n\n.sc-controls-bar {\n  transform: translateY(-100%);\n  display: flex;\n  width: 100%;\n  justify-content: space-between;\n  flex-wrap: nowrap;\n}\n.sc-controls-bar > * {\n  display: flex;\n  align-items: center;\n  flex-wrap: nowrap;\n}\n\n.sc-context-menu {\n  position: absolute;\n  color: black;\n  box-shadow: 0px 0px 5px 1px hsla(0, 0%, 0%, 0.25);\n  min-width: 130px;\n  opacity: 0;\n  transition: .2s opacity;\n}\n.sc-context-menu-item {\n  display: block;\n  width: 100%;\n  background-color: white;\n  border: none;\n  border-radius: 0;\n  cursor: pointer;\n  text-align: left;\n  font-family: inherit;\n  font-size: 0.85em;\n  padding: 8px 12px;\n  margin: 0;\n  transition: .1s background-color, .1s color;\n}\n.sc-context-menu-item:focus {\n  outline: 2px solid black;\n}\n.sc-context-menu-item:hover,\n.sc-context-menu-item:active {\n  color: white;\n  background-color: var(--sc-accent-color);\n}\n.sc-context-menu-item:first-child {\n  border-radius: 4px 4px 0 0;\n}\n.sc-context-menu-item:last-child {\n  border-radius: 0 0 4px 4px;\n}\n\n.sc-dropping {\n  background-color: var(--sc-accent-color-transparent);\n}\n',""]),a.locals={root:"sc-root",layers:"sc-layers","scaled-overlays-outer":"sc-scaled-overlays-outer",scaledOverlaysOuter:"sc-scaled-overlays-outer","scaled-overlays-inner":"sc-scaled-overlays-inner",scaledOverlaysInner:"sc-scaled-overlays-inner",canvas:"sc-canvas","question-root":"sc-question-root",questionRoot:"sc-question-root","question-inner":"sc-question-inner",questionInner:"sc-question-inner","question-text":"sc-question-text",questionText:"sc-question-text","question-input-outer":"sc-question-input-outer",questionInputOuter:"sc-question-input-outer","question-input":"sc-question-input",questionInput:"sc-question-input","question-submit-button":"sc-question-submit-button",questionSubmitButton:"sc-question-submit-button","question-submit-button-image":"sc-question-submit-button-image",questionSubmitButtonImage:"sc-question-submit-button-image","monitor-overlay":"sc-monitor-overlay",monitorOverlay:"sc-monitor-overlay","monitor-root":"sc-monitor-root",monitorRoot:"sc-monitor-root","monitor-inner":"sc-monitor-inner",monitorInner:"sc-monitor-inner","monitor-row":"sc-monitor-row",monitorRow:"sc-monitor-row","monitor-label":"sc-monitor-label",monitorLabel:"sc-monitor-label","monitor-slider":"sc-monitor-slider",monitorSlider:"sc-monitor-slider","monitor-value":"sc-monitor-value",monitorValue:"sc-monitor-value","monitor-value-color":"sc-monitor-value-color",monitorValueColor:"sc-monitor-value-color","monitor-large-value":"sc-monitor-large-value",monitorLargeValue:"sc-monitor-large-value","monitor-list-label":"sc-monitor-list-label",monitorListLabel:"sc-monitor-list-label","monitor-list-footer":"sc-monitor-list-footer",monitorListFooter:"sc-monitor-list-footer","monitor-list-footer-text":"sc-monitor-list-footer-text",monitorListFooterText:"sc-monitor-list-footer-text","monitor-row-delete":"sc-monitor-row-delete",monitorRowDelete:"sc-monitor-row-delete","monitor-list-add":"sc-monitor-list-add",monitorListAdd:"sc-monitor-list-add","monitor-rows-outer":"sc-monitor-rows-outer",monitorRowsOuter:"sc-monitor-rows-outer","monitor-rows-inner":"sc-monitor-rows-inner",monitorRowsInner:"sc-monitor-rows-inner","monitor-rows-endpoint":"sc-monitor-rows-endpoint",monitorRowsEndpoint:"sc-monitor-rows-endpoint","monitor-row-root":"sc-monitor-row-root",monitorRowRoot:"sc-monitor-row-root","monitor-row-index":"sc-monitor-row-index",monitorRowIndex:"sc-monitor-row-index","monitor-row-value-outer":"sc-monitor-row-value-outer",monitorRowValueOuter:"sc-monitor-row-value-outer","monitor-row-value-editing":"sc-monitor-row-value-editing",monitorRowValueEditing:"sc-monitor-row-value-editing","monitor-row-value-inner":"sc-monitor-row-value-inner",monitorRowValueInner:"sc-monitor-row-value-inner","monitor-empty":"sc-monitor-empty",monitorEmpty:"sc-monitor-empty","controls-bar":"sc-controls-bar",controlsBar:"sc-controls-bar","context-menu":"sc-context-menu",contextMenu:"sc-context-menu","context-menu-item":"sc-context-menu-item",contextMenuItem:"sc-context-menu-item",dropping:"sc-dropping"},e.a=a},function(A,e,t){"use strict";(function(A){!function(A){function e(){}function t(){}var n=String.fromCharCode,i={}.toString,r=i.call(A.SharedArrayBuffer),o=i(),s=A.Uint8Array,a=s||Array,B=s?ArrayBuffer:a,c=B.isView||function(A){return A&&"length"in A},g=i.call(B.prototype);B=t.prototype;var E=A.TextEncoder,Q=new(s?Uint16Array:a)(32);e.prototype.decode=function(A){if(!c(A)){var e=i.call(A);if(e!==g&&e!==r&&e!==o)throw TypeError("Failed to execute 'decode' on 'TextDecoder': The provided value is not of type '(ArrayBuffer or ArrayBufferView)'");A=s?new a(A):A||[]}for(var t,B,E,u=e="",l=0,w=0|A.length,h=w-32|0,C=0,I=0,M=0,d=-1;l<w;){for(t=l<=h?32:w-l|0;M<t;l=l+1|0,M=M+1|0){switch((B=255&A[l])>>4){case 15:if(2!=(E=255&A[l=l+1|0])>>6||247<B){l=l-1|0;break}C=(7&B)<<6|63&E,I=5,B=256;case 14:C<<=6,C|=(15&B)<<6|63&(E=255&A[l=l+1|0]),I=2==E>>6?I+4|0:24,B=B+256&768;case 13:case 12:C<<=6,C|=(31&B)<<6|63&(E=255&A[l=l+1|0]),I=I+7|0,l<w&&2==E>>6&&C>>I&&1114112>C?(B=C,0<=(C=C-65536|0)&&(d=55296+(C>>10)|0,B=56320+(1023&C)|0,31>M?(Q[M]=d,M=M+1|0,d=-1):(E=d,d=B,B=E))):(l=l-(B>>=8)-1|0,B=65533),C=I=0,t=l<=h?32:w-l|0;default:Q[M]=B;continue;case 11:case 10:case 9:case 8:}Q[M]=65533}if(u+=n(Q[0],Q[1],Q[2],Q[3],Q[4],Q[5],Q[6],Q[7],Q[8],Q[9],Q[10],Q[11],Q[12],Q[13],Q[14],Q[15],Q[16],Q[17],Q[18],Q[19],Q[20],Q[21],Q[22],Q[23],Q[24],Q[25],Q[26],Q[27],Q[28],Q[29],Q[30],Q[31]),32>M&&(u=u.slice(0,M-32|0)),l<w){if(Q[0]=d,M=~d>>>31,d=-1,u.length<e.length)continue}else-1!==d&&(u+=n(d));e+=u,u=""}return e},B.encode=function(A){var e,t=0|(A=void 0===A?"":""+A).length,n=new a(8+(t<<1)|0),i=0,r=!s;for(e=0;e<t;e=e+1|0,i=i+1|0){var o=0|A.charCodeAt(e);if(127>=o)n[i]=o;else{if(2047>=o)n[i]=192|o>>6;else{A:{if(55296<=o)if(56319>=o){var B=0|A.charCodeAt(e=e+1|0);if(56320<=B&&57343>=B){if(65535<(o=(o<<10)+B-56613888|0)){n[i]=240|o>>18,n[i=i+1|0]=128|o>>12&63,n[i=i+1|0]=128|o>>6&63,n[i=i+1|0]=128|63&o;continue}break A}o=65533}else 57343>=o&&(o=65533);!r&&e<<1<i&&e<<1<(i-7|0)&&(r=!0,(B=new a(3*t)).set(n),n=B)}n[i]=224|o>>12,n[i=i+1|0]=128|o>>6&63}n[i=i+1|0]=128|63&o}}return s?n.subarray(0,i):n.slice(0,i)},E||(A.TextDecoder=e,A.TextEncoder=t)}(""+void 0==typeof A?""+void 0==typeof self?this:self:A)}).call(this,t(14))},function(A,e,t){const n=t(132),i=t(5);A.exports=new class extends n{constructor(){super(),this.services={},this.workerClass="undefined"==typeof Worker?null:Worker,this.workers=[]}callSync(A,e){const{provider:t,isRemote:n}=this._getServiceProvider(A);if(t){if(n)throw new Error("Cannot use 'callSync' on remote provider for service ".concat(A,"."));for(var i=arguments.length,r=new Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];return t[e].apply(t,r)}throw new Error("Provider not found for service: ".concat(A))}setServiceSync(A,e){this.services.hasOwnProperty(A)&&i.warn("Central dispatch replacing existing service provider for ".concat(A)),this.services[A]=e}setService(A,e){try{return this.setServiceSync(A,e),Promise.resolve()}catch(A){return Promise.reject(A)}}addWorker(A){-1===this.workers.indexOf(A)?(this.workers.push(A),A.onmessage=this._onMessage.bind(this,A),this._remoteCall(A,"dispatch","handshake").catch(A=>{i.error("Could not handshake with worker: ".concat(A))})):i.warn("Central dispatch ignoring attempt to add duplicate worker")}_getServiceProvider(A){const e=this.services[A];return e&&{provider:e,isRemote:Boolean(this.workerClass&&e instanceof this.workerClass||e.isRemote)}}_onDispatchMessage(A,e){let t;switch(e.method){case"setService":t=this.setService(e.args[0],A);break;default:i.error("Central dispatch received message for unknown method: ".concat(e.method))}return t}}},function(A,e){var t={black:"#000",red:"#c23621",green:"#25bc26",yellow:"#bbbb00",blue:"#492ee1",magenta:"#d338d3",cyan:"#33bbc8",gray:"#808080",purple:"#708"};A.exports=function(A,e){return e?"color: #fff; background: "+t[A]+";":"color: "+t[A]+";"}},function(A,e,t){const n=t(4);A.exports=function(A,e,t){return A&&A.id&&A.default?n(A,e,t):A}},function(A,e){var t="long",n="short",i="numeric";A.exports={number:{decimal:{style:"decimal"},integer:{style:"decimal",maximumFractionDigits:0},currency:{style:"currency",currency:"USD"},percent:{style:"percent"},default:{style:"decimal"}},date:{short:{month:i,day:i,year:"2-digit"},medium:{month:n,day:i,year:i},long:{month:t,day:i,year:i},full:{month:t,day:i,year:i,weekday:t},default:{month:n,day:i,year:i}},time:{short:{hour:i,minute:i},medium:{hour:i,minute:i,second:i},long:{hour:i,minute:i,second:i,timeZoneName:n},full:{hour:i,minute:i,second:i,timeZoneName:n},default:{hour:i,minute:i,second:i}},duration:{default:{hours:{minimumIntegerDigits:1,maximumFractionDigits:0},minutes:{minimumIntegerDigits:2,maximumFractionDigits:0},seconds:{minimumIntegerDigits:2,maximumFractionDigits:3}}},parseNumberPattern:function(A){if(A){var e={},t=A.match(/\b[A-Z]{3}\b/i),n=A.replace(/[^]/g,"").length;if(!n&&t&&(n=1),n?(e.style="currency",e.currencyDisplay=1===n?"symbol":2===n?"code":"name",e.currency=t?t[0].toUpperCase():"USD"):A.indexOf("%")>=0&&(e.style="percent"),!/[@#0]/.test(A))return e.style?e:void 0;if(e.useGrouping=A.indexOf(",")>=0,/E\+?[@#0]+/i.test(A)||A.indexOf("@")>=0){var i=A.replace(/E\+?[@#0]+|[^@#0]/gi,"");e.minimumSignificantDigits=Math.min(Math.max(i.replace(/[^@0]/g,"").length,1),21),e.maximumSignificantDigits=Math.min(Math.max(i.length,1),21)}else{for(var r=A.replace(/[^#0.]/g,"").split("."),o=r[0],s=o.length-1;"0"===o[s];)--s;e.minimumIntegerDigits=Math.min(Math.max(o.length-1-s,1),21);var a=r[1]||"";for(s=0;"0"===a[s];)++s;for(e.minimumFractionDigits=Math.min(Math.max(s,0),20);"#"===a[s];)++s;e.maximumFractionDigits=Math.min(Math.max(s,0),20)}return e}},parseDatePattern:function(A){if(A){for(var e={},r=0;r<A.length;){for(var o=A[r],s=1;A[++r]===o;)++s;switch(o){case"G":e.era=5===s?"narrow":4===s?t:n;break;case"y":case"Y":e.year=2===s?"2-digit":i;break;case"M":case"L":s=Math.min(Math.max(s-1,0),4),e.month=[i,"2-digit",n,t,"narrow"][s];break;case"E":case"e":case"c":e.weekday=5===s?"narrow":4===s?t:n;break;case"d":case"D":e.day=2===s?"2-digit":i;break;case"h":case"K":e.hour12=!0,e.hour=2===s?"2-digit":i;break;case"H":case"k":e.hour12=!1,e.hour=2===s?"2-digit":i;break;case"m":e.minute=2===s?"2-digit":i;break;case"s":case"S":e.second=2===s?"2-digit":i;break;case"z":case"Z":case"v":case"V":e.timeZoneName=1===s?n:t}}return Object.keys(e).length?e:void 0}}}},function(A,e){A.exports=function(A,e){if("string"==typeof A&&e[A])return A;for(var t=[].concat(A||[]),n=0,i=t.length;n<i;++n)for(var r=t[n].split("-");r.length;){var o=r.join("-");if(e[o])return o;r.pop()}}},function(A,e,t){"use strict";var n="one",i="two",r="few",o="many",s="other",a=[function(A){return 1===+A?n:s},function(A){var e=+A;return 0<=e&&e<=1?n:s},function(A){return 0===Math.floor(Math.abs(+A))||1===+A?n:s},function(A){var e=+A;return 0===e?"zero":1===e?n:2===e?i:3<=e%100&&e%100<=10?r:11<=e%100&&e%100<=99?o:s},function(A){var e=Math.floor(Math.abs(+A)),t=(A+".").split(".")[1].length;return 1===e&&0===t?n:s},function(A){var e=+A;return e%10==1&&e%100!=11?n:2<=e%10&&e%10<=4&&(e%100<12||14<e%100)?r:e%10==0||5<=e%10&&e%10<=9||11<=e%100&&e%100<=14?o:s},function(A){var e=+A;return e%10==1&&e%100!=11&&e%100!=71&&e%100!=91?n:e%10==2&&e%100!=12&&e%100!=72&&e%100!=92?i:(3<=e%10&&e%10<=4||e%10==9)&&(e%100<10||19<e%100)&&(e%100<70||79<e%100)&&(e%100<90||99<e%100)?r:0!==e&&e%1e6==0?o:s},function(A){var e=Math.floor(Math.abs(+A)),t=(A+".").split(".")[1].length,i=+(A+".").split(".")[1];return 0===t&&e%10==1&&e%100!=11||i%10==1&&i%100!=11?n:0===t&&2<=e%10&&e%10<=4&&(e%100<12||14<e%100)||2<=i%10&&i%10<=4&&(i%100<12||14<i%100)?r:s},function(A){var e=Math.floor(Math.abs(+A)),t=(A+".").split(".")[1].length;return 1===e&&0===t?n:2<=e&&e<=4&&0===t?r:0!==t?o:s},function(A){var e=+A;return 0===e?"zero":1===e?n:2===e?i:3===e?r:6===e?o:s},function(A){var e=Math.floor(Math.abs(+A)),t=+(""+A).replace(/^[^.]*.?|0+$/g,"");return 1===+A||0!==t&&(0===e||1===e)?n:s},function(A){var e=Math.floor(Math.abs(+A)),t=(A+".").split(".")[1].length,o=+(A+".").split(".")[1];return 0===t&&e%100==1||o%100==1?n:0===t&&e%100==2||o%100==2?i:0===t&&3<=e%100&&e%100<=4||3<=o%100&&o%100<=4?r:s},function(A){var e=Math.floor(Math.abs(+A));return 0===e||1===e?n:s},function(A){var e=Math.floor(Math.abs(+A)),t=(A+".").split(".")[1].length,i=+(A+".").split(".")[1];return 0===t&&(1===e||2===e||3===e)||0===t&&e%10!=4&&e%10!=6&&e%10!=9||0!==t&&i%10!=4&&i%10!=6&&i%10!=9?n:s},function(A){var e=+A;return 1===e?n:2===e?i:3<=e&&e<=6?r:7<=e&&e<=10?o:s},function(A){var e=+A;return 1===e||11===e?n:2===e||12===e?i:3<=e&&e<=10||13<=e&&e<=19?r:s},function(A){var e=Math.floor(Math.abs(+A)),t=(A+".").split(".")[1].length;return 0===t&&e%10==1?n:0===t&&e%10==2?i:0!==t||e%100!=0&&e%100!=20&&e%100!=40&&e%100!=60&&e%100!=80?0!==t?o:s:r},function(A){var e=Math.floor(Math.abs(+A)),t=(A+".").split(".")[1].length,r=+A;return 1===e&&0===t?n:2===e&&0===t?i:0===t&&(r<0||10<r)&&r%10==0?o:s},function(A){var e=Math.floor(Math.abs(+A)),t=+(""+A).replace(/^[^.]*.?|0+$/g,"");return 0===t&&e%10==1&&e%100!=11||0!==t?n:s},function(A){var e=+A;return 1===e?n:2===e?i:s},function(A){var e=+A;return 0===e?"zero":1===e?n:s},function(A){var e=Math.floor(Math.abs(+A)),t=+A;return 0===t?"zero":0!==e&&1!==e||0===t?s:n},function(A){var e=+(A+".").split(".")[1],t=+A;return t%10==1&&(t%100<11||19<t%100)?n:2<=t%10&&t%10<=9&&(t%100<11||19<t%100)?r:0!==e?o:s},function(A){var e=(A+".").split(".")[1].length,t=+(A+".").split(".")[1],i=+A;return i%10==0||11<=i%100&&i%100<=19||2===e&&11<=t%100&&t%100<=19?"zero":i%10==1&&i%100!=11||2===e&&t%10==1&&t%100!=11||2!==e&&t%10==1?n:s},function(A){var e=Math.floor(Math.abs(+A)),t=(A+".").split(".")[1].length,i=+(A+".").split(".")[1];return 0===t&&e%10==1&&e%100!=11||i%10==1&&i%100!=11?n:s},function(A){var e=Math.floor(Math.abs(+A)),t=(A+".").split(".")[1].length,i=+A;return 1===e&&0===t?n:0!==t||0===i||1!==i&&1<=i%100&&i%100<=19?r:s},function(A){var e=+A;return 1===e?n:0===e||2<=e%100&&e%100<=10?r:11<=e%100&&e%100<=19?o:s},function(A){var e=Math.floor(Math.abs(+A)),t=(A+".").split(".")[1].length;return 1===e&&0===t?n:0===t&&2<=e%10&&e%10<=4&&(e%100<12||14<e%100)?r:0===t&&1!==e&&0<=e%10&&e%10<=1||0===t&&5<=e%10&&e%10<=9||0===t&&12<=e%100&&e%100<=14?o:s},function(A){var e=Math.floor(Math.abs(+A));return 0<=e&&e<=1?n:s},function(A){var e=Math.floor(Math.abs(+A)),t=(A+".").split(".")[1].length;return 0===t&&e%10==1&&e%100!=11?n:0===t&&2<=e%10&&e%10<=4&&(e%100<12||14<e%100)?r:0===t&&e%10==0||0===t&&5<=e%10&&e%10<=9||0===t&&11<=e%100&&e%100<=14?o:s},function(A){var e=+A;return 0===Math.floor(Math.abs(+A))||1===e?n:2<=e&&e<=10?r:s},function(A){var e=Math.floor(Math.abs(+A)),t=+(A+".").split(".")[1],i=+A;return 0===i||1===i||0===e&&1===t?n:s},function(A){var e=Math.floor(Math.abs(+A)),t=(A+".").split(".")[1].length;return 0===t&&e%100==1?n:0===t&&e%100==2?i:0===t&&3<=e%100&&e%100<=4||0!==t?r:s},function(A){var e=+A;return 0<=e&&e<=1||11<=e&&e<=99?n:s},function(A){var e=+A;return 1===e||5===e||7===e||8===e||9===e||10===e?n:2===e||3===e?i:4===e?r:6===e?o:s},function(A){var e=Math.floor(Math.abs(+A));return e%10==1||e%10==2||e%10==5||e%10==7||e%10==8||e%100==20||e%100==50||e%100==70||e%100==80?n:e%10==3||e%10==4||e%1e3==100||e%1e3==200||e%1e3==300||e%1e3==400||e%1e3==500||e%1e3==600||e%1e3==700||e%1e3==800||e%1e3==900?r:0===e||e%10==6||e%100==40||e%100==60||e%100==90?o:s},function(A){var e=+A;return e%10!=2&&e%10!=3||e%100==12||e%100==13?s:r},function(A){var e=+A;return 1===e||3===e?n:2===e?i:4===e?r:s},function(A){var e=+A;return 0===e||7===e||8===e||9===e?"zero":1===e?n:2===e?i:3===e||4===e?r:5===e||6===e?o:s},function(A){var e=+A;return e%10==1&&e%100!=11?n:e%10==2&&e%100!=12?i:e%10==3&&e%100!=13?r:s},function(A){var e=+A;return 1===e||11===e?n:2===e||12===e?i:3===e||13===e?r:s},function(A){var e=+A;return 1===e?n:2===e||3===e?i:4===e?r:6===e?o:s},function(A){var e=+A;return 1===e||5===e?n:s},function(A){var e=+A;return 11===e||8===e||80===e||800===e?o:s},function(A){var e=Math.floor(Math.abs(+A));return 1===e?n:0===e||2<=e%100&&e%100<=20||e%100==40||e%100==60||e%100==80?o:s},function(A){var e=+A;return e%10==6||e%10==9||e%10==0&&0!==e?o:s},function(A){var e=Math.floor(Math.abs(+A));return e%10==1&&e%100!=11?n:e%10==2&&e%100!=12?i:e%10!=7&&e%10!=8||e%100==17||e%100==18?s:o},function(A){var e=+A;return 1===e?n:2===e||3===e?i:4===e?r:s},function(A){var e=+A;return 1<=e&&e<=4?n:s},function(A){var e=+A;return 1===e||5===e||7<=e&&e<=9?n:2===e||3===e?i:4===e?r:6===e?o:s},function(A){var e=+A;return 1===e?n:e%10==4&&e%100!=14?o:s},function(A){var e=+A;return e%10!=1&&e%10!=2||e%100==11||e%100==12?s:n},function(A){var e=+A;return e%10==6||e%10==9||10===e?r:s},function(A){var e=+A;return e%10==3&&e%100!=13?r:s}];A.exports={af:{cardinal:a[0]},ak:{cardinal:a[1]},am:{cardinal:a[2]},ar:{cardinal:a[3]},ars:{cardinal:a[3]},as:{cardinal:a[2],ordinal:a[34]},asa:{cardinal:a[0]},ast:{cardinal:a[4]},az:{cardinal:a[0],ordinal:a[35]},be:{cardinal:a[5],ordinal:a[36]},bem:{cardinal:a[0]},bez:{cardinal:a[0]},bg:{cardinal:a[0]},bh:{cardinal:a[1]},bn:{cardinal:a[2],ordinal:a[34]},br:{cardinal:a[6]},brx:{cardinal:a[0]},bs:{cardinal:a[7]},ca:{cardinal:a[4],ordinal:a[37]},ce:{cardinal:a[0]},cgg:{cardinal:a[0]},chr:{cardinal:a[0]},ckb:{cardinal:a[0]},cs:{cardinal:a[8]},cy:{cardinal:a[9],ordinal:a[38]},da:{cardinal:a[10]},de:{cardinal:a[4]},dsb:{cardinal:a[11]},dv:{cardinal:a[0]},ee:{cardinal:a[0]},el:{cardinal:a[0]},en:{cardinal:a[4],ordinal:a[39]},eo:{cardinal:a[0]},es:{cardinal:a[0]},et:{cardinal:a[4]},eu:{cardinal:a[0]},fa:{cardinal:a[2]},ff:{cardinal:a[12]},fi:{cardinal:a[4]},fil:{cardinal:a[13],ordinal:a[0]},fo:{cardinal:a[0]},fr:{cardinal:a[12],ordinal:a[0]},fur:{cardinal:a[0]},fy:{cardinal:a[4]},ga:{cardinal:a[14],ordinal:a[0]},gd:{cardinal:a[15],ordinal:a[40]},gl:{cardinal:a[4]},gsw:{cardinal:a[0]},gu:{cardinal:a[2],ordinal:a[41]},guw:{cardinal:a[1]},gv:{cardinal:a[16]},ha:{cardinal:a[0]},haw:{cardinal:a[0]},he:{cardinal:a[17]},hi:{cardinal:a[2],ordinal:a[41]},hr:{cardinal:a[7]},hsb:{cardinal:a[11]},hu:{cardinal:a[0],ordinal:a[42]},hy:{cardinal:a[12],ordinal:a[0]},ia:{cardinal:a[4]},io:{cardinal:a[4]},is:{cardinal:a[18]},it:{cardinal:a[4],ordinal:a[43]},iu:{cardinal:a[19]},iw:{cardinal:a[17]},jgo:{cardinal:a[0]},ji:{cardinal:a[4]},jmc:{cardinal:a[0]},ka:{cardinal:a[0],ordinal:a[44]},kab:{cardinal:a[12]},kaj:{cardinal:a[0]},kcg:{cardinal:a[0]},kk:{cardinal:a[0],ordinal:a[45]},kkj:{cardinal:a[0]},kl:{cardinal:a[0]},kn:{cardinal:a[2]},ks:{cardinal:a[0]},ksb:{cardinal:a[0]},ksh:{cardinal:a[20]},ku:{cardinal:a[0]},kw:{cardinal:a[19]},ky:{cardinal:a[0]},lag:{cardinal:a[21]},lb:{cardinal:a[0]},lg:{cardinal:a[0]},ln:{cardinal:a[1]},lt:{cardinal:a[22]},lv:{cardinal:a[23]},mas:{cardinal:a[0]},mg:{cardinal:a[1]},mgo:{cardinal:a[0]},mk:{cardinal:a[24],ordinal:a[46]},ml:{cardinal:a[0]},mn:{cardinal:a[0]},mo:{cardinal:a[25],ordinal:a[0]},mr:{cardinal:a[2],ordinal:a[47]},mt:{cardinal:a[26]},nah:{cardinal:a[0]},naq:{cardinal:a[19]},nb:{cardinal:a[0]},nd:{cardinal:a[0]},ne:{cardinal:a[0],ordinal:a[48]},nl:{cardinal:a[4]},nn:{cardinal:a[0]},nnh:{cardinal:a[0]},no:{cardinal:a[0]},nr:{cardinal:a[0]},nso:{cardinal:a[1]},ny:{cardinal:a[0]},nyn:{cardinal:a[0]},om:{cardinal:a[0]},or:{cardinal:a[0],ordinal:a[49]},os:{cardinal:a[0]},pa:{cardinal:a[1]},pap:{cardinal:a[0]},pl:{cardinal:a[27]},prg:{cardinal:a[23]},ps:{cardinal:a[0]},pt:{cardinal:a[28]},"pt-PT":{cardinal:a[4]},rm:{cardinal:a[0]},ro:{cardinal:a[25],ordinal:a[0]},rof:{cardinal:a[0]},ru:{cardinal:a[29]},rwk:{cardinal:a[0]},saq:{cardinal:a[0]},sc:{cardinal:a[4],ordinal:a[43]},scn:{cardinal:a[4],ordinal:a[43]},sd:{cardinal:a[0]},sdh:{cardinal:a[0]},se:{cardinal:a[19]},seh:{cardinal:a[0]},sh:{cardinal:a[7]},shi:{cardinal:a[30]},si:{cardinal:a[31]},sk:{cardinal:a[8]},sl:{cardinal:a[32]},sma:{cardinal:a[19]},smi:{cardinal:a[19]},smj:{cardinal:a[19]},smn:{cardinal:a[19]},sms:{cardinal:a[19]},sn:{cardinal:a[0]},so:{cardinal:a[0]},sq:{cardinal:a[0],ordinal:a[50]},sr:{cardinal:a[7]},ss:{cardinal:a[0]},ssy:{cardinal:a[0]},st:{cardinal:a[0]},sv:{cardinal:a[4],ordinal:a[51]},sw:{cardinal:a[4]},syr:{cardinal:a[0]},ta:{cardinal:a[0]},te:{cardinal:a[0]},teo:{cardinal:a[0]},ti:{cardinal:a[1]},tig:{cardinal:a[0]},tk:{cardinal:a[0],ordinal:a[52]},tl:{cardinal:a[13],ordinal:a[0]},tn:{cardinal:a[0]},tr:{cardinal:a[0]},ts:{cardinal:a[0]},tzm:{cardinal:a[33]},ug:{cardinal:a[0]},uk:{cardinal:a[29],ordinal:a[53]},ur:{cardinal:a[4]},uz:{cardinal:a[0]},ve:{cardinal:a[0]},vo:{cardinal:a[0]},vun:{cardinal:a[0]},wa:{cardinal:a[1]},wae:{cardinal:a[0]},xh:{cardinal:a[0]},xog:{cardinal:a[0]},yi:{cardinal:a[4]},zu:{cardinal:a[2]},lo:{ordinal:a[0]},ms:{ordinal:a[0]},vi:{ordinal:a[0]}}},function(A,e,t){const n=t(5),i={},r=new DOMParser,o=A=>(n.warn(A),{msg:A,isNoop:!0,isError:!0});function s(A,e){let t={};for(let i of e){var n=i.info.switches;if(!n)continue;t[i.info.opcode]=n.map(t=>{var n,s,a,B,c,g,E;switch(typeof t){case"object":break;case"string":t={opcode:t};break;default:return o(typeof t+" disallowed")}if(t.isNoop)return{isNoop:!0,msg:null!==(g=null!==(E=t.overwriteText)&&void 0!==E?E:i.info.switchText)&&void 0!==g?g:i.info.text};if(!t.opcode)return o("No defined opcode");let Q=e.find(A=>A.info.opcode===t.opcode);if(!Q)return o("Block ".concat(t.opcode," doesn't exist"));let u={},l=null!==(n=t.createArguments)&&void 0!==n?n:{};r.parseFromString(Q.xml,"text/xml").querySelectorAll('[type="'.concat(Q.json.type,'"] > value')).forEach(A=>{var e,n,r,o;let s=A.getAttribute("name");if(i.info.arguments[s]&&!(null!==(e=t.remapArguments)&&void 0!==e?e:{})[s])return;if(Object.values(null!==(n=t.remapArguments)&&void 0!==n?n:{}).includes(s))return;let a=A.getElementsByTagName("shadow")[0].getAttribute("type"),B=(null!==(r=null!==(o=l[s])&&void 0!==o?o:Q.info.arguments[s].defaultValue)&&void 0!==r?r:"").toString();u[s]={shadowType:a,value:B}});const w=Object.keys(i.info.arguments).filter(A=>{var e,n;return!!Q.info.arguments[A]&&!!(null!==(e=t.remapArguments)&&void 0!==e?e:{})[A]&&!Object.values(null!==(n=t.remapArguments)&&void 0!==n?n:{}).includes(A)}),h={};return r.parseFromString(i.xml,"text/xml").querySelectorAll('[type="'.concat(i.json.type,'"] > value')).forEach(A=>{var e;let n=A.getAttribute("name");if((null!==(e=t.remapArguments)&&void 0!==e?e:{})[n]&&(n=t.remapArguments[n]),!Q.info.arguments[n])return;let i=A.querySelector("shadow");i&&(i=i.getAttribute("type"),h[n]=i)}),r.parseFromString(Q.xml,"text/xml").querySelectorAll('[type="'.concat(Q.json.type,'"] > value')).forEach(A=>{let e=A.getAttribute("name");if(!h[e])return;let t=A.querySelector("shadow");t&&(t=t.getAttribute("type"),h[e]!=t?h[e]=t:delete h[e])}),{opcode:"".concat(A,"_").concat(t.opcode),msg:null!==(s=null!==(a=t.overwriteText)&&void 0!==a?a:Q.info.switchText)&&void 0!==s?s:Q.info.text,mapFieldValues:null!==(B=t.remapMenus)&&void 0!==B?B:{},remapInputName:null!==(c=t.remapArguments)&&void 0!==c?c:{},createInputs:u,splitInputs:w,remapShadowType:h}})}return t}A.exports=function(A){let{runtime:e}=A;for(let A of e._blockInfo)A.id in i||(i[A.id]=s(A.id,A.blocks));return i},A.exports.get_extension_switches=s,A.exports.noopSwitch={isNoop:!0}},function(A,e){A.exports=function(A){return A.webpackPolyfill||(A.deprecate=function(){},A.paths=[],A.children||(A.children=[]),Object.defineProperty(A,"loaded",{enumerable:!0,get:function(){return A.l}}),Object.defineProperty(A,"id",{enumerable:!0,get:function(){return A.i}}),A.webpackPolyfill=1),A}},function(A){A.exports={menuMap:{}}},function(A,e,t){function n(A,e){var t=Object.keys(A);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(A);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(A,e).enumerable}))),t.push.apply(t,n)}return t}function i(A,e,t){return(e=function(A){var e=function(A,e){if("object"!=typeof A||!A)return A;var t=A[Symbol.toPrimitive];if(void 0!==t){var n=t.call(A,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(A)}(A,"string");return"symbol"==typeof e?e:e+""}(e))in A?Object.defineProperty(A,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):A[e]=t,A}const r=t(27),{OrderedMap:o}=t(34),s=t(92),a=t(3),B=t(22),c=t(95),g=t(1),E=(t(11),t(219)),Q=t(96),u=t(61),l=t(43),w=t(225),h=t(15),C=t(36),I=t(5),M=t(84),d=t(16),m=t(19),p=t(24),F=t(226),D=t(227),{validateJSON:Y}=t(13),f=t(8),N=t(229),U=t(230),y=t(6),T=t(2),x=t(62),R=t(231),G=t(232),S=t(233),H=t(234),b=t(235),v=t(236),k=t(98),j=t(237),J=t(10),z=t(9),L=[m.SCALAR_TYPE,m.LIST_TYPE,m.BROADCAST_MESSAGE_TYPE],P={scratch3_control:t(238),scratch3_event:t(239),scratch3_looks:t(240),scratch3_motion:t(241),scratch3_operators:t(242),scratch3_sound:t(243),scratch3_sensing:t(244),scratch3_data:t(245),scratch3_procedures:t(246),pm_liveTests:t(247)},O=t(248),V=t(249),W=["#0FBD8C","#0DA57A","#0B8E69"],K=(()=>{const A={};return A[a.ANGLE]={shadow:{type:"math_angle",fieldName:"NUM"}},A[a.COLOR]={shadow:{type:"colour_picker",fieldName:"COLOUR"}},A[a.NUMBER]={shadow:{type:"math_number",fieldName:"NUM"}},A[a.STRING]={shadow:{type:"text",fieldName:"TEXT"}},A[a.BOOLEAN]={check:"Boolean",shadow:{type:"checkbox",fieldName:"CHECKBOX"}},A[a.MATRIX]={shadow:{type:"matrix",fieldName:"MATRIX"}},A[a.NOTE]={shadow:{type:"note",fieldName:"NOTE"}},A[a.IMAGE]={fieldType:"field_image"},A[a.POLYGON]={check:"math_polygon",shadow:{type:"polygon"}},A[a.CUSTOM]={fieldType:"field_customInput"},A[a.COSTUME]={shadow:{type:"looks_costume",fieldName:"COSTUME"}},A[a.SOUND]={shadow:{type:"sound_sounds_menu",fieldName:"SOUND_MENU"}},A[a.VARIABLE]={fieldType:"field_variable",fieldName:"VARIABLE"},A[a.LIST]={fieldType:"field_variable",fieldName:"LIST",variableType:"list"},A[a.BROADCAST]={fieldType:"field_variable",fieldName:"BROADCAST",variableType:"broadcast_msg"},A[a.SEPERATOR]={fieldType:"field_vertical_separator"},A})(),X=A=>{let e=0;return{canAddCloudVariable:()=>e<A.limit,addCloudVariable:()=>{e++},removeCloudVariable:()=>{e--},hasCloudVariables:()=>e>0,getNumberOfCloudVariables:()=>e}};let Z=-1,_=-1,q=-1;class $ extends r{constructor(){super(),this.targets=[],this.executableTargets=[],this.threads=[],this.threadMap=new Map,this.sequencer=new Q(this),this.flyoutBlocks=new B(this,!0),this.monitorBlocks=new B(this,!0),this._editingTarget=null,this._primitives={},this._blockInfo=[],this._hats={},this._scriptGlowsPreviousFrame=[],this._nonMonitorThreadCount=0,this._lastStepDoneThreads=null,this.tabManager=new N(this),this.modalManager=new U(this),this._cloneCounter=0,this._refreshTargets=!1,this.monitorBlockInfo={},this._monitorState=o({}),this._prevMonitorState=o({}),this.turboMode=!1,this.frameLoop=new V(this),this.currentStepTime=1e3/30,this.updateCurrentMSecs(),this.redrawRequested=!1,this._registerBlockPackages(),this.ioDevices={clock:new R(this),cloud:new G(this),keyboard:new S(this),mouse:new H(this),mouseWheel:new b(this),userData:new v,video:new k(this),touch:new j(this)},this.peripheralExtensions={},this.profiler=null,this.cloudOptions={limit:10},this.extensionRuntimeOptions={javascriptUnsandboxed:!1};const A=X(this.cloudOptions);this.hasCloudData=A.hasCloudVariables,this.canAddCloudVariable=A.canAddCloudVariable,this.getNumberOfCloudVariables=A.getNumberOfCloudVariables,this.addCloudVariable=this._initializeAddCloudVariable(A),this.removeCloudVariable=this._initializeRemoveCloudVariable(A),this.origin=null,this._stageTarget=null,this.addonBlocks={},this.stageWidth=$.STAGE_WIDTH,this.stageHeight=$.STAGE_HEIGHT,this.runtimeOptions={maxClones:$.MAX_CLONES,miscLimits:!0,fencing:!0,dangerousOptimizations:!1,disableOffscreenRendering:!1,disableDirectionClamping:!1},this.compilerOptions={enabled:!0,warpTimer:!1},this.optimizationUtil={sin:new Array(360),cos:new Array(360)};for(let A=0;A<360;A++)this.optimizationUtil.sin[A]=Math.round(1e10*Math.sin(Math.PI*A/180))/1e10,this.optimizationUtil.cos[A]=Math.round(1e10*Math.cos(Math.PI*A/180))/1e10;this.debug=!1,this._lastStepTime=Date.now(),this.interpolationEnabled=!1,this.interpolate=O,this._defaultStoredSettings=this._generateAllProjectOptions(),this.isPackaged=!1,this.isProjectPermissionManagerDisabled=!0,this.isPackagedProject=!1,this.externalCommunicationMethods={cloudVariables:!1,customExtensions:!1},this.on($.HAS_CLOUD_DATA_UPDATE,A=>{this.setExternalCommunicationMethod("cloudVariables",A)}),this.setMaxListeners(50),this.enforcePrivacy=!0,this.extensionButtons=new Map,this._extensionAudioObjects=new Map,this.fontManager=new D(this),this.cameraStates={default:{pos:[0,0],dir:0,scale:1}},this._extensionVariables={},this.serializers={"pm-rendered-target":{serialize:A=>({id:A.id,name:A.getName()}),deserialize:A=>{var e;let{id:t,name:n}=A;return null!==(e=this.getTargetById(t))&&void 0!==e?e:this.getSpriteTargetByName(n)}},"pm-costume-asset":{serialize:A=>({id:A.assetId,name:A.name}),deserialize:A=>{let{assetId:e,name:t}=A;for(let A=0;A<this.targets.length;A++){const n=this.targets[A].getCostumes().find(A=>A.assetId===e||A.name===t);if(n)return n}}},"pm-sound-asset":{serialize:A=>({id:A.assetId,name:A.name}),deserialize:A=>{let{assetId:e,name:t}=A;for(let A=0;A<this.targets.length;A++){const n=this.targets[A].getSounds().find(A=>A.assetId===e||A.name===t);if(n)return n}}}},this.variables=Object.create(null),this.extensionStorage=x()}static get STAGE_WIDTH(){return 480}static get STAGE_HEIGHT(){return 360}static get SCRIPT_GLOW_ON(){return"SCRIPT_GLOW_ON"}static get SCRIPT_GLOW_OFF(){return"SCRIPT_GLOW_OFF"}static get BLOCK_GLOW_ON(){return"BLOCK_GLOW_ON"}static get BLOCK_GLOW_OFF(){return"BLOCK_GLOW_OFF"}static get HAS_CLOUD_DATA_UPDATE(){return"HAS_CLOUD_DATA_UPDATE"}static get TURBO_MODE_ON(){return"TURBO_MODE_ON"}static get TURBO_MODE_OFF(){return"TURBO_MODE_OFF"}static get RUNTIME_OPTIONS_CHANGED(){return"RUNTIME_OPTIONS_CHANGED"}static get COMPILER_OPTIONS_CHANGED(){return"COMPILER_OPTIONS_CHANGED"}static get FRAMERATE_CHANGED(){return"FRAMERATE_CHANGED"}static get INTERPOLATION_CHANGED(){return"INTERPOLATION_CHANGED"}static get BEFORE_INTERPOLATE(){return"BEFORE_INTERPOLATE"}static get AFTER_INTERPOLATE(){return"AFTER_INTERPOLATE"}static get BEFORE_EXECUTE(){return"BEFORE_EXECUTE"}static get AFTER_EXECUTE(){return"AFTER_EXECUTE"}static get STAGE_SIZE_CHANGED(){return"STAGE_SIZE_CHANGED"}static get MOUSE_SCROLLED(){return"MOUSE_SCROLLED"}static get COMPILE_ERROR(){return"COMPILE_ERROR"}static get PROJECT_START(){return"PROJECT_START"}static get PROJECT_START_BEFORE_RESET(){return"PROJECT_START_BEFORE_RESET"}static get PROJECT_RUN_START(){return"PROJECT_RUN_START"}static get PROJECT_RUN_STOP(){return"PROJECT_RUN_STOP"}static get PROJECT_STOP_ALL(){return"PROJECT_STOP_ALL"}static get STOP_FOR_TARGET(){return"STOP_FOR_TARGET"}static get VISUAL_REPORT(){return"VISUAL_REPORT"}static get BLOCK_STACK_ERROR(){return"BLOCK_STACK_ERROR"}static get PROJECT_LOADED(){return"PROJECT_LOADED"}static get PROJECT_CHANGED(){return"PROJECT_CHANGED"}static get TOOLBOX_EXTENSIONS_NEED_UPDATE(){return"TOOLBOX_EXTENSIONS_NEED_UPDATE"}static get TARGETS_UPDATE(){return"TARGETS_UPDATE"}static get MONITORS_UPDATE(){return"MONITORS_UPDATE"}static get BLOCK_DRAG_UPDATE(){return"BLOCK_DRAG_UPDATE"}static get BLOCK_DRAG_END(){return"BLOCK_DRAG_END"}static get EXTENSION_ADDED(){return"EXTENSION_ADDED"}static get EXTENSION_REMOVED(){return"EXTENSION_REMOVED"}static get EXTENSION_FIELD_ADDED(){return"EXTENSION_FIELD_ADDED"}static get PERIPHERAL_LIST_UPDATE(){return"PERIPHERAL_LIST_UPDATE"}static get USER_PICKED_PERIPHERAL(){return"USER_PICKED_PERIPHERAL"}static get PERIPHERAL_CONNECTED(){return"PERIPHERAL_CONNECTED"}static get PERIPHERAL_DISCONNECTED(){return"PERIPHERAL_DISCONNECTED"}static get PERIPHERAL_REQUEST_ERROR(){return"PERIPHERAL_REQUEST_ERROR"}static get PERIPHERAL_CONNECTION_LOST_ERROR(){return"PERIPHERAL_CONNECTION_LOST_ERROR"}static get PERIPHERAL_SCAN_TIMEOUT(){return"PERIPHERAL_SCAN_TIMEOUT"}static get MIC_LISTENING(){return"MIC_LISTENING"}static get BLOCKSINFO_UPDATE(){return"BLOCKSINFO_UPDATE"}static get RUNTIME_STARTED(){return"RUNTIME_STARTED"}static get RUNTIME_STOPPED(){return"RUNTIME_STOPPED"}static get RUNTIME_PAUSED(){return"RUNTIME_PAUSED"}static get RUNTIME_PRE_PAUSED(){return"RUNTIME_PRE_PAUSED"}static get RUNTIME_UNPAUSED(){return"RUNTIME_UNPAUSED"}static get RUNTIME_DISPOSED(){return"RUNTIME_DISPOSED"}static get RUNTIME_STEP_START(){return"RUNTIME_STEP_START"}static get RUNTIME_STEP_END(){return"RUNTIME_STEP_END"}static get EDITOR_TABS_NEW(){return"EDITOR_TABS_NEW"}static get EDITOR_TABS_UPDATE(){return"EDITOR_TABS_UPDATE"}static get BLOCKS_NEED_UPDATE(){return"BLOCKS_NEED_UPDATE"}static get CAMERA_CHANGED(){return"CAMERA_CHANGED"}static get HATS_STARTED(){return"HATS_STARTED"}static get THREAD_STARTED(){return"THREAD_STARTED"}static get THREAD_FINISHED(){return"THREAD_FINISHED"}static get SPRITE_RENAMED(){return"SPRITE_RENAMED"}static get COSTUME_RENAMED(){return"COSTUME_RENAMED"}static get SOUND_RENAMED(){return"SOUND_RENAMED"}static get THREAD_STEP_INTERVAL(){return 1e3/60}static get THREAD_STEP_INTERVAL_COMPATIBILITY(){return 1e3/30}static get MAX_CLONES(){return 300}_initializeAddCloudVariable(A){return()=>{const e=this.hasCloudData();A.addCloudVariable(),!e&&this.hasCloudData()&&this.emit($.HAS_CLOUD_DATA_UPDATE,!0)}}_initializeRemoveCloudVariable(A){return()=>{const e=this.hasCloudData();A.removeCloudVariable(),e&&!this.hasCloudData()&&this.emit($.HAS_CLOUD_DATA_UPDATE,!1)}}_registerBlockPackages(){for(const A in P)if(P.hasOwnProperty(A)){const e=new P[A](this);if(e.getPrimitives){const A=e.getPrimitives();for(const t in A)A.hasOwnProperty(t)&&(this._primitives[t]=A[t].bind(e))}if(e.getHats){const A=e.getHats();for(const e in A)A.hasOwnProperty(e)&&(this._hats[e]=A[e])}e.getMonitored&&(this.monitorBlockInfo=Object.assign({},this.monitorBlockInfo,e.getMonitored())),this.compilerRegisterExtension(A,e)}}compilerRegisterExtension(A,e){this["ext_".concat(A)]=e}registerCompiledExtensionBlocks(A,e){if(!e)return;if(!e.ir)return;if(!e.js)return;const n=t(60);t(58).setExtensionIr(A,e.ir),n.setExtensionJs(A,e.js)}registerExtensionAudioContext(A,e,t){if("string"!=typeof A)throw new TypeError("Extension ID must be string");if(!A)throw new Error("No extension ID specified");const n={};e&&(n.audioContext=e),t&&(n.gainNode=t),this._extensionAudioObjects.set(A,n)}getMonitorState(){return this._monitorState}_makeExtensionMenuId(A,e){return"".concat(e,"_menu_").concat(A)}makeMessageContextForTarget(A){const e={};(A=A||this.getEditingTarget()||this.getTargetForStage())&&(e.targetType=A.isStage?h.STAGE:h.SPRITE)}_registerExtensionPrimitives(A){const e={id:A.id,name:M(A.name),showStatusButton:A.showStatusButton,blockIconURI:A.blockIconURI,menuIconURI:A.menuIconURI};if(A.color1){const t=f.hexToRgb(A.color1);if(e.color1=A.color1,e.color2=A.color2,!A.color2){const A=f.mixRgb(t,f.RGB_BLACK,.1);e.color2=f.rgbToHex(A)}if(e.color3=A.color3,!A.color3){const A=f.mixRgb(t,f.RGB_BLACK,.2);e.color3=f.rgbToHex(A)}}else e.color1=W[0],e.color2=W[1],e.color3=W[2];e.blockText=A.blockText,A.isDynamic&&(e.isDynamic=A.isDynamic,e.orderBlocks=A.orderBlocks),e.tbShow=A.tbShow||!1,this._blockInfo.push(e),this._fillExtensionCategory(e,A);for(const t in e.customFieldTypes)if(A.customFieldTypes.hasOwnProperty(t)){const A=e.customFieldTypes[t];this.emit($.EXTENSION_FIELD_ADDED,{name:"field_".concat(A.extendedName),implementation:A.fieldImplementation})}this.emit($.EXTENSION_ADDED,e)}_refreshExtensionPrimitives(A){const e=this._blockInfo.find(e=>e.id===A.id);e&&(e.name=M(A.name),this._fillExtensionCategory(e,A),this.emit($.BLOCKSINFO_UPDATE,e))}_removeExtensionPrimitive(A){const e=this._blockInfo.findIndex(e=>e.id===A),t=this._blockInfo[e];this._blockInfo.splice(e,1),this.emit($.EXTENSION_REMOVED);for(const A of this.targets)for(const e in A.blocks._blocks){const{opcode:n}=A.blocks.getBlock(e);t.blocks.find(A=>{var e;return(null===(e=A.json)||void 0===e?void 0:e.type)===n})&&A.blocks.deleteBlock(e,!0)}this.emit($.BLOCKS_NEED_UPDATE)}_fillExtensionCategory(A,e){A.blocks=[],A.customFieldTypes={},A.menus=[],A.menuInfo={};for(const t in e.menus)if(e.menus.hasOwnProperty(t)){const n=e.menus[t],i=this._buildMenuForScratchBlocks(t,n,A);A.menus.push(i),A.menuInfo[t]=n}for(const t in e.customFieldTypes)if(e.customFieldTypes.hasOwnProperty(t)){const n=e.customFieldTypes[t],i=this._buildCustomFieldInfo(t,n,e.id,A);A.customFieldTypes[t]=i}if(e.docsURI){const t={info:{},xml:"<button "+'text="'.concat(p(M({id:"tw.blocks.openDocs",default:"Open Documentation",description:"Button that opens site with more documentation about an extension"})),'" ')+'callbackKey="OPEN_EXTENSION_DOCS" '+'callbackData="'.concat(p(e.docsURI),'"></button>')};A.blocks.push(t)}for(const t of e.blocks)try{const e=this._convertForScratchBlocks(t,A);if(A.blocks.push(e),e.json){const A=e.json.type;t.blockType!==g.EVENT&&t.blockType!==g.BUTTON&&(this._primitives[A]=e.info.func),t.blockType!==g.EVENT&&t.blockType!==g.HAT||(this._hats[A]={edgeActivated:t.isEdgeActivated,restartExistingThreads:t.shouldRestartExistingThreads})}}catch(A){I.error("Error parsing block: ",{block:t,error:A})}}_convertMenuItems(A){if(Array.isArray(A)){const e=this.makeMessageContextForTarget();return A.map(A=>{const t=M(A,e);switch(typeof t){case"string":return[t,t];case"object":return Array.isArray(A)?A.slice(0,2):[M(A.text,e),A.value];default:throw new Error("Can't interpret menu item: ".concat(JSON.stringify(A)))}})}return A}_buildMenuForScratchBlocks(A,e,t){const n=this._makeExtensionMenuId(A,t.id),i=this._convertMenuItems(e.items);return{json:{message0:"%1",type:n,inputsInline:!0,output:"String",colour:e.isTypeable?"#FFFFFF":t.color1,colourSecondary:e.isTypeable?"#FFFFFF":t.color2,colourTertiary:e.isTypeable?"#FFFFFF":t.color3,outputShape:e.acceptReporters||e.isTypeable?w.OUTPUT_SHAPE_ROUND:w.OUTPUT_SHAPE_SQUARE,args0:[void 0!==e.variableType?{type:"field_variable",name:A,variableTypes:["scalar"===e.variableType?m.SCALAR_TYPE:e.variableType]}:e.isTypeable?{type:e.isNumeric?"field_numberdropdown":"field_textdropdown",name:A,options:i}:{type:"field_dropdown",name:A,options:i}]}}}_buildCustomFieldInfo(A,e,t,n){const i="".concat(t,"_").concat(A);return{fieldName:A,extendedName:i,argumentTypeInfo:{shadow:{type:i,fieldName:"field_".concat(i)}},scratchBlocksDefinition:this._buildCustomFieldTypeForScratchBlocks(i,e.output,e.outputShape,n),fieldImplementation:e.implementation}}_buildCustomFieldTypeForScratchBlocks(A,e,t,n){return{json:{type:A,message0:"%1",inputsInline:!0,output:e,colour:n.color1,colourSecondary:n.color2,colourTertiary:n.color3,outputShape:t,args0:[{name:"field_".concat(A),type:"field_".concat(A)}]}}}_convertForScratchBlocks(A,e){return"---"===A?this._convertSeparatorForScratchBlocks(A):A.blockType===g.LABEL?this._convertLabelForScratchBlocks(A):A.blockType===g.BUTTON?this._convertButtonForScratchBlocks(A):A.blockType===g.XML?this._convertXmlForScratchBlocks(A):this._convertBlockForScratchBlocks(A,e)}_convertBlockForScratchBlocks(A,e){var t,n,i,r,o,s,a;const B="".concat(e.id,"_").concat(A.opcode),c={type:B,inputsInline:!0,category:e.name,extensions:null!==(t=A.extensions)&&void 0!==t?t:[],colour:null!==(n=A.color1)&&void 0!==n?n:e.color1,colourSecondary:null!==(i=A.color2)&&void 0!==i?i:e.color2,colourTertiary:null!==(r=A.color3)&&void 0!==r?r:e.color3,blockText:null!==(o=A.blockText)&&void 0!==o?o:e.blockText,canDragDuplicate:!0===A.canDragDuplicate},E={argsMap:{},blockJSON:c,categoryInfo:e,blockInfo:A,inputList:[]},Q=A.blockIconURI||e.blockIconURI;if(Q){c.extensions.includes("scratch_extension")||c.extensions.push("scratch_extension"),c.message0="%1 %2";const A={type:"field_image",src:Q,width:40,height:40},e={type:"field_vertical_separator"};c.args0=[A,e]}let u=null!==(s=A.notchAccepts)&&void 0!==s?s:"normal";switch(A.blockType){case g.COMMAND:c.outputShape=w.OUTPUT_SHAPE_SQUARE,c.previousStatement=u,A.isTerminal||(c.nextStatement=u);break;case g.REPORTER:c.output=A.allowDropAnywhere?null:"String",c.outputShape=w.OUTPUT_SHAPE_ROUND;break;case g.BOOLEAN:c.output="Boolean",c.outputShape=w.OUTPUT_SHAPE_HEXAGONAL;break;case g.HAT:case g.EVENT:A.hasOwnProperty("isEdgeActivated")||(A.isEdgeActivated=!0),c.outputShape=w.OUTPUT_SHAPE_SQUARE,c.nextStatement=u;break;case g.CONDITIONAL:case g.LOOP:A.branchCount=null!==(a=A.branchCount)&&void 0!==a?a:1,c.outputShape=w.OUTPUT_SHAPE_SQUARE,c.previousStatement=u,A.isTerminal||(c.nextStatement=u)}A.branches=A.branches||Array(Math.max(A.branchCount||0,0)).fill({});const l=Array.isArray(A.text)?A.text:[A.text];let h=0,C=0,I=0;const d=this._convertPlaceholders.bind(this,E),m=this.makeMessageContextForTarget();for(;h<l.length||C<A.branches.length;){if(h<l.length){E.outLineNum=I;const A=M(l[h],m).replace(/\[(.+?)]/g,d);c["message".concat(I)]?c["message".concat(I)]+=A:c["message".concat(I)]=A,++h,++I}var F;if(C<A.branches.length)c["message".concat(I)]="%1",c["args".concat(I)]=[{type:"input_statement",name:"SUBSTACK".concat(C>0?C+1:""),check:null!==(F=A.branches[C].accepts)&&void 0!==F?F:"normal"}],++C,++I}var D,Y,f,N;(A.blockType!==g.REPORTER&&A.blockType!==g.BOOLEAN||A.disableMonitor||0!==E.inputList.length||(c.checkboxInFlyout=!0),(A.blockType===g.LOOP||"branchIndicator"in A||"branchIconURI"in A)&&""!==A.branchIndicator)&&(c["lastDummyAlign".concat(I)]="RIGHT",c["message".concat(I)]="%1",c["args".concat(I)]=[{type:"field_image",src:null!==(D=null!==(Y=A.branchIndicator)&&void 0!==Y?Y:A.branchIconURI)&&void 0!==D?D:"./static/blocks-media/repeat.svg",width:null!==(f=A.branchIndicatorWidth)&&void 0!==f?f:24,height:null!==(N=A.branchIndicatorHeight)&&void 0!==N?N:24,alt:"*",flip_rtl:!0}],++I);if(Array.isArray(A.alignments)){let e=0;for(const t of A.alignments)"string"==typeof t&&(c["lastDummyAlign".concat(e)]=t.toUpperCase()),e++}const U=A.blockShape;"number"==typeof U?c.outputShape=U:"string"==typeof U&&(U.startsWith("custom-")?c.outputShape=U:c.outputShape="custom-"+U),A.forceOutputType&&(c.output=A.forceOutputType);const y=A.mutations;"object"==typeof y&&"function"==typeof y.serialize&&"function"==typeof y.deserialize&&(c.mutations={serialize:y.serialize,deserialize:y.deserialize,init:"function"==typeof y.init?y.init:void 0});const T=A.isDynamic?'<mutation blockInfo="'.concat(p.escapeAttribute(JSON.stringify(A)),'"/>'):"",x=E.inputList.join(""),R=A.isSpriteSpecific?'id="'.concat(p.escapeAttribute(this.vm.editingTarget.id+"_"+B),'"'):"",G='<block type="'.concat(p.escapeAttribute(B),'" ').concat(R,">").concat(T).concat(x,"</block>");return{info:E.blockInfo,json:E.blockJSON,xml:G}}_convertSeparatorForScratchBlocks(A){return{info:A,xml:'<sep gap="36"/>'}}_convertLabelForScratchBlocks(A){const e=p.escapeAttribute(A.text);return{info:A,xml:'<label text="'.concat(e,'"></label>')}}_convertButtonForScratchBlocks(A){const e=this.makeMessageContextForTarget(),t=p.escapeAttribute(M(A.text,e)),n=p.escapeAttribute(A.opcode?A.opcode:A.func);return{info:A,xml:'<button text="'.concat(t,'" callbackKey="').concat(n,'"></button>')}}_convertXmlForScratchBlocks(A){return{info:A,xml:A.xml}}_constructInlineImageJson(A){var e,t;return A.dataURI||I.warn("Missing data URI in extension block with argument type IMAGE"),{type:"field_image",src:A.dataURI||"",width:null!==(e=A.width)&&void 0!==e?e:24,height:null!==(t=A.height)&&void 0!==t?t:24,flip_rtl:A.flipRTL||!1}}_constructVariableDropdown(A,e){const t="list"===A.type,n="broadcast"===A.type;return{type:"field_variable",name:e,variableTypes:t?["list"]:n?["broadcast_msg"]:[""],variable:n?"message1":null}}_convertPlaceholders(A,e,t){const n=A.blockInfo.arguments[t]||{};let i,r=K[n.type]||{};if(!K[n.type]&&A.categoryInfo.customFieldTypes[n.type]&&(r=A.categoryInfo.customFieldTypes[n.type].argumentTypeInfo),"field_image"===r.fieldType)i=this._constructInlineImageJson(n);else if("field_variable"===r.fieldType)i=this._constructVariableDropdown(n,t);else if("field_vertical_separator"===r.fieldType)i={type:"field_vertical_separator"};else if("field_customInput"===r.fieldType)i={type:"field_customInput",name:t,id:n.id,value:n.defaultValue};else{i={type:"input_value",name:t};const e=void 0===n.defaultValue?"":p.escapeAttribute(M(n.defaultValue,this.makeMessageContextForTarget()).toString());(r.check||n.check)&&(i.check=n.check||r.check);const B=r.shape||n.shape;let c,g,E,Q,u,l,w;if(B&&("number"==typeof B||B.startsWith("custom-")?i.shape=B:i.shape="custom-"+B),n.menu){const e=A.categoryInfo.menuInfo[n.menu];if(e.acceptReporters||e.isTypeable)c=t,g=this._makeExtensionMenuId(n.menu,A.categoryInfo.id),Q=n.menu;else if(void 0!==e.variableType){var o;const r=Object.keys(A.blockInfo.arguments),B=A.blockInfo.text.toString(),E=1===r.length&&B.length===r[0].length+2;var s,a;if(E)null!==(a=(s=A.blockJSON).extensions)&&void 0!==a||(s.extensions=[]),A.blockJSON.extensions.push("contextMenu_getVariableBlockAnyType");i.type=E?"field_variable_getter":"field_variable",i.variableTypes=["scalar"===e.variableType?m.SCALAR_TYPE:e.variableType],i.variableType=i.variableTypes[0],c=null,g=null,Q=t,w="scalar"===e.variableType?m.SCALAR_TYPE:e.variableType;const h=null!==(o=n.defaultValue)&&void 0!==o?o:[];u=h[0],l=h[1]}else i.type="field_dropdown",i.options=this._convertMenuItems(e.items),c=null,g=null,Q=t}else c=t,g=r.shadow&&r.shadow.type||null,Q=r.shadow&&r.shadow.fieldName||null;(n.fillIn||n.fillInGlobal)&&(g=n.fillInGlobal||"".concat(A.categoryInfo.id,"_").concat(n.fillIn)),c&&A.inputList.push('<value name="'.concat(p.escapeAttribute(t),'">')),g&&A.inputList.push('<shadow type="'.concat(p.escapeAttribute(g),'">')),E&&A.inputList.push('<block type="'.concat(p.escapeAttribute(E),'">')),"polygon"===g&&A.inputList.push('<mutation expanded="false" points="'.concat(n.nodes,'" color="').concat(A.blockJSON.colour,'" midle="[0,0]" scale="').concat(n.defaultSize||30,'"/>')),"matrix"===g&&A.inputList.push('<mutation width="'.concat(n.matrixWidth||5,'" height="').concat(n.matrixHeight||5,'"/>')),Q&&!u&&(e||"string"===n.type&&!n.menu)&&A.inputList.push('<field name="'.concat(Q,'">').concat(e,"</field>")),u&&A.inputList.push('<field name="'.concat(Q,'" id="').concat(u,'" variableType="').concat(w,'">').concat(l,"</field>")),E&&A.inputList.push("</block>"),g&&A.inputList.push("</shadow>"),c&&A.inputList.push("</value>")}const B="args".concat(A.outLineNum),c=A.blockJSON[B]=A.blockJSON[B]||[];i&&c.push(i);const g=c.length;return A.argsMap[t]=g,"%".concat(g)}getBlocksXML(A){return this._blockInfo.map(e=>{const{name:t,color1:n,color2:i}=e;let r=e.orderBlocks;const o=e.blocks.filter(e=>{let t=!0;return A&&e.info.filter&&(t=e.info.filter.includes(A.isStage?h.STAGE:h.SPRITE)),t&&!e.info.hideFromPalette});r=r||(A=>A);const s='colour="'.concat(p(n),'" secondaryColour="').concat(p(i),'"');let a="";e.menuIconURI?a=e.menuIconURI:e.blockIconURI&&(a=e.blockIconURI);const B=a?'iconURI="'.concat(p(a),'"'):"";let c="";e.showStatusButton&&(c='showStatusButton="true"');let g='<category name="'.concat(p.escapeAttribute(t),'"');return g+=' id="'.concat(p.escapeAttribute(e.id),'"'),g+=' options="extensionControls"',g+=" ".concat(c),g+=" ".concat(s),g+=" ".concat(B,">"),g+=r(o.map(A=>A.xml)).join(""),g+="</category>",{id:e.id,xml:g}})}getBlocksJSON(){return this._blockInfo.reduce((A,e)=>A.concat(e.blocks.map(A=>A.json)),[])}getScratchLinkSocket(A){return(this._linkSocketFactory||this._defaultScratchLinkSocketFactory)(A)}configureScratchLinkSocketFactory(A){this._linkSocketFactory=A}_defaultScratchLinkSocketFactory(A){return new F(A)}registerPeripheralExtension(A,e){this.peripheralExtensions[A]=e}scanForPeripheral(A){this.peripheralExtensions[A]&&this.peripheralExtensions[A].scan()}connectPeripheral(A,e){this.peripheralExtensions[A]&&this.peripheralExtensions[A].connect(e)}disconnectPeripheral(A){this.peripheralExtensions[A]&&this.peripheralExtensions[A].disconnect()}getPeripheralIsConnected(A){let e=!1;return this.peripheralExtensions[A]&&(e=this.peripheralExtensions[A].isConnected()),e}emitMicListening(A){this.emit($.MIC_LISTENING,A)}getOpcodeFunction(A){return this._primitives[A]}getIsHat(A){return this._hats.hasOwnProperty(A)}getIsEdgeActivatedHat(A){return this._hats.hasOwnProperty(A)&&this._hats[A].edgeActivated}attachAudioEngine(A){this.audioEngine=A}attachRenderer(A){this.renderer=A,this.renderer.setLayerGroupOrdering(d.LAYER_GROUPS),this.renderer.offscreenTouching=!this.runtimeOptions.fencing,this.renderer.renderOffscreen=this.runtimeOptions.disableOffscreenRendering,this.updatePrivacy()}registerSerializer(A,e,t){if("function"!=typeof e)throw new TypeError("serialize must be of type function");if("function"!=typeof t)throw new TypeError("deserialize must be of type function");this.serializers[A]={serialize:e,deserialize:t}}registerVariable(A,e){this._extensionVariables[A]=e}unregisterVariable(A){if(!this._extensionVariables[A])throw new Error("can not remove a variable type that does not exist. removing ".concat(A));delete this._extensionVariables[A]}newVariableInstance(A){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];if(L.includes(A))return t.splice(2,0,A),new m(...t);const i=this._extensionVariables[A];return i?new i(this,...t):{type:A,value:t,mustRecreate:!0}}attachV2BitmapAdapter(A){this.v2BitmapAdapter=A}attachStorage(A){if(this.storage=A,this.isPackaged){const e=A.createAsset;let t=0;A.createAsset=function(A,n,i,r,o){return r||(r=(++t).toString()),e.call(this,A,n,i,r,!1)}}}_pushThread(A,e,t){const n=new C(A);return n.target=e,n.stackClick=Boolean(t&&t.stackClick),n.updateMonitor=Boolean(t&&t.updateMonitor),n.blockContainer=n.updateMonitor?this.monitorBlocks:t&&t.targetBlockLocation||e.blocks,n.pushStack(A),this.threads.push(n),n.stackClick||n.updateMonitor||this.threadMap.set(n.getId(),n),t&&t.updateMonitor||!this.compilerOptions.enabled||n.tryCompile(),this.emit($.THREAD_STARTED,n),n}_stopThread(A){A.isKilled=!0,this.sequencer.retireThread(A)}_restartThread(A){const e=new C(A.topBlock);e.target=A.target,e.stackClick=A.stackClick,e.updateMonitor=A.updateMonitor,e.blockContainer=A.blockContainer,e.pushStack(A.topBlock),A.triedToCompile&&this.compilerOptions.enabled&&e.tryCompile(),e.stackClick||e.updateMonitor||this.threadMap.set(e.getId(),e);const t=this.threads.indexOf(A);return t>-1?(this.threads[t]=e,e):(this.threads.push(A),A)}emitCompileError(A,e){this.emit($.COMPILE_ERROR,A,e)}isActiveThread(A){return A.stack.length>0&&A.status!==C.STATUS_DONE&&this.threads.indexOf(A)>-1}isWaitingThread(A){return A.status===C.STATUS_PROMISE_WAIT||A.status===C.STATUS_YIELD_TICK||!this.isActiveThread(A)}toggleScript(A,e){e=Object.assign({target:this._editingTarget,stackClick:!1},e);for(let t=0;t<this.threads.length;t++)if(this.threads[t].topBlock===A&&this.threads[t].status!==C.STATUS_DONE){const n=e.target.blocks,i=n.getOpcode(n.getBlock(A));if(this.getIsEdgeActivatedHat(i)&&this.threads[t].stackClick!==e.stackClick)continue;return void this._stopThread(this.threads[t])}this._pushThread(A,e.target,e)}addMonitorScript(A,e){e||(e=this._editingTarget);for(let e=0;e<this.threads.length;e++)if(this.threads[e].topBlock===A&&this.threads[e].status!==C.STATUS_DONE&&this.threads[e].updateMonitor)return;this._pushThread(A,e,{updateMonitor:!0})}allScriptsDo(A,e){let t=this.executableTargets;e&&(t=[e]);for(let e=t.length-1;e>=0;e--){const n=t[e],i=n.blocks.getScripts();for(let e=0;e<i.length;e++){A(i[e],n)}}}allScriptsByOpcodeDo(A,e,t){let n=this.executableTargets;t&&(n=[t]);for(let t=n.length-1;t>=0;t--){const i=n[t],r=c.getScripts(i.blocks,A);for(let A=0;A<r.length;A++)e(r[A],i)}}startHats(A,e,t){if(!this._hats.hasOwnProperty(A))return;const n=[],i=this._hats[A];for(const A in e)e.hasOwnProperty(A)&&(e[A]=T.toString(e[A]).toUpperCase());const r=this.threads.length;return this.allScriptsByOpcodeDo(A,(A,t)=>{const{blockId:o,fieldsOfInputs:s}=A;for(const A in e)if(s[A].value!==e[A])return;if(i.restartExistingThreads){const A=this.threadMap.get(C.getIdFromTargetAndBlock(t,o));if(A)return void n.push(this._restartThread(A))}else for(let A=0;A<r;A++)if(this.threads[A].target===t&&this.threads[A].topBlock===o&&!this.threads[A].stackClick&&this.threads[A].status!==C.STATUS_DONE)return;n.push(this._pushThread(o,t))},t),n.forEach(A=>{this.paused&&A.pause(),A.isCompiled?A.executableHat&&(l.saveGlobalState(),l(A),l.restoreGlobalState()):(u(this.sequencer,A),A.goToNextBlock())}),this.emit($.HATS_STARTED,A,e,t,n),n}dispose(){this.stopAll(),this.targets.forEach(A=>{A.isOriginal&&A.deleteMonitors()}),this.targets.map(this.disposeTarget,this);const A=o({});A.equals(this._monitorState)||(this._monitorState=A,this.emit($.MONITORS_UPDATE,this._monitorState)),this.emit($.RUNTIME_DISPOSED),this.ioDevices.clock.resetProjectTimer(),this.fontManager.clear(),this.hasCloudData()&&this.emit($.HAS_CLOUD_DATA_UPDATE,!1),this.ioDevices.cloud.clear();const e=X(this.cloudOptions);this.hasCloudData=e.hasCloudVariables,this.canAddCloudVariable=e.canAddCloudVariable,this.getNumberOfCloudVariables=e.getNumberOfCloudVariables,this.addCloudVariable=this._initializeAddCloudVariable(e),this.removeCloudVariable=this._initializeRemoveCloudVariable(e)}addTarget(A){for(const e in A.variables){const t=A.variables[e];if(t.mustRecreate){const n=this.newVariableInstance(t.type,...t.value);if(n.mustRecreate){delete A.variables[e];continue}A.variables[e]=n}}this.targets.push(A),this.executableTargets.push(A),A.isStage&&!this._stageTarget&&(this._stageTarget=A)}moveExecutable(A,e){const t=this.executableTargets.indexOf(A);this.executableTargets.splice(t,1);let n=t+e;return n>this.executableTargets.length&&(n=this.executableTargets.length),n<=0&&(n=this.executableTargets.length>0&&this.executableTargets[0].isStage?1:0),this.executableTargets.splice(n,0,A),n}setExecutablePosition(A,e){const t=this.executableTargets.indexOf(A);return this.moveExecutable(A,e-t)}removeExecutable(A){const e=this.executableTargets.indexOf(A);e>-1&&this.executableTargets.splice(e,1)}disposeTarget(A){this.targets=this.targets.filter(e=>A!==e||(e.dispose(),!1)),this._stageTarget===A&&(this._stageTarget=null)}stopForTarget(A,e){this.emit($.STOP_FOR_TARGET,A,e);for(let t=0;t<this.threads.length;t++)this.threads[t]!==e&&this.threads[t].target===A&&this._stopThread(this.threads[t])}greenFlag(){this.emit($.PROJECT_START_BEFORE_RESET),this.stopAll(),this.emit($.PROJECT_START),this.updateCurrentMSecs(),this.ioDevices.clock.resetProjectTimer(),this.targets.forEach(A=>A.clearEdgeActivatedValues());for(let A=0;A<this.targets.length;A++)this.targets[A].onGreenFlag();this.startHats("event_whenflagclicked")}pause(){if(!this.paused){this.emit($.RUNTIME_PRE_PAUSED),this.paused=!0,this.audioEngine.audioContext.suspend();for(const A of this._extensionAudioObjects.values())A.audioContext&&A.audioContext.suspend();this.ioDevices.clock.pause();for(const A of this.threads)A.pause();this.emit($.RUNTIME_PAUSED)}}play(){if(this.paused){this.paused=!1,this.audioEngine.audioContext.resume();for(const A of this._extensionAudioObjects.values())A.audioContext&&A.audioContext.resume();this.ioDevices.clock.resume();for(const A of this.threads)A.play();this.emit($.RUNTIME_UNPAUSED)}}stopAll(){this.play(),this.emit($.PROJECT_STOP_ALL),this.variables=Object.create(null);const A=[];for(let e=0;e<this.targets.length;e++)this.targets[e].onStopAll(),this.targets[e].hasOwnProperty("isOriginal")&&!this.targets[e].isOriginal?this.targets[e].dispose():A.push(this.targets[e]);this.targets=A,null!==this.sequencer.activeThread&&this._stopThread(this.sequencer.activeThread),this.threads.forEach(A=>A.status!==C.STATUS_DONE&&this.emit($.THREAD_FINISHED,A)),this.threads=[],this.threadMap.clear()}_renderInterpolatedPositions(){const A=this._lastStepTime,e=Date.now()-A,t=Math.min(1,Math.max(0,e/this.currentStepTime));O.interpolate(this,t),this.renderer&&this.renderer.draw()}updateThreadMap(){this.threadMap.clear();for(const A of this.threads)A.stackClick||A.updateMonitor||this.threadMap.set(A.getId(),A)}_step(){this.frameLoop._stepCounter++,this.emit($.RUNTIME_STEP_START),this.interpolationEnabled&&O.setupInitialState(this),null!==this.profiler&&(-1===Z&&(Z=this.profiler.idByName("Runtime._step")),this.profiler.start(Z)),this.threads=this.threads.filter(A=>!A.isKilled),this.updateThreadMap();for(const A in this._hats){if(!this._hats.hasOwnProperty(A))continue;this._hats[A].edgeActivated&&this.startHats(A)}this.redrawRequested=!1,this._pushMonitors(),null!==this.profiler&&(-1===_&&(_=this.profiler.idByName("Sequencer.stepThreads")),this.profiler.start(_)),this.emit($.BEFORE_EXECUTE);const A=this.sequencer.stepThreads();null!==this.profiler&&this.profiler.stop(),this.emit($.AFTER_EXECUTE),this._updateGlows(A),this._emitProjectRunStatus(this.threads.length+A.length-this._getMonitorThreadCount([...this.threads,...A])),this._lastStepDoneThreads=A,this.renderer&&(null!==this.profiler&&(-1===q&&(q=this.profiler.idByName("RenderWebGL.draw")),this.profiler.start(q)),document.hidden||this.frameLoop._interpolationAnimation||this.renderer.draw(),null!==this.profiler&&this.profiler.stop()),this._refreshTargets&&(this.emit($.TARGETS_UPDATE,!1),this._refreshTargets=!1);let e=!1;if(this._monitorState.some(A=>"object"==typeof A.get("value")&&"_monitorUpToDate"in A.get("value")&&!A.get("value")._monitorUpToDate)){const A=this._monitorState;if(this._monitorState=this._monitorState.toOrderedMap(),A===this._monitorState)throw new Error("Expected OrderedMap.toOrderedMap() to produce a truly unique value");e=!0}this._prevMonitorState.equals(this._monitorState)&&!e||(this.emit($.MONITORS_UPDATE,this._monitorState),this._prevMonitorState=this._monitorState),null!==this.profiler&&(this.profiler.stop(),this.profiler.reportFrames()),this.interpolationEnabled&&(this._lastStepTime=Date.now()),this.emit($.RUNTIME_STEP_END)}_getMonitorThreadCount(A){let e=0;return A.forEach(A=>{A.updateMonitor&&e++}),e}_pushMonitors(){this.monitorBlocks.runAllMonitored(this)}setEditingTarget(A){const e=this._editingTarget;this._editingTarget=A,this._scriptGlowsPreviousFrame=[],this._updateGlows(),e!==this._editingTarget&&this.requestToolboxExtensionsUpdate()}setCompatibilityMode(A){A?this.setFramerate(30):this.setFramerate(60)}setFramerate(A){A>250&&(A=250),A<0&&(A=1),this.frameLoop.setFramerate(A),this.emit($.FRAMERATE_CHANGED,A)}setInterpolation(A){this.interpolationEnabled=A,this.frameLoop.setInterpolation(this.interpolationEnabled),this.emit($.INTERPOLATION_CHANGED,A)}setRuntimeOptions(A){this.runtimeOptions=Object.assign({},this.runtimeOptions,A),this.emit($.RUNTIME_OPTIONS_CHANGED,this.runtimeOptions),this.renderer&&(this.renderer.offscreenTouching=!this.runtimeOptions.fencing,this.runtimeOptions.disableOffscreenRendering===this.renderer.renderOffscreen&&this.renderer.setRenderOffscreen(!this.runtimeOptions.disableOffscreenRendering))}setCompilerOptions(A){this.compilerOptions=Object.assign({},this.compilerOptions,A),this.resetAllCaches(),this.emit($.COMPILER_OPTIONS_CHANGED,this.compilerOptions)}setStageSize(A,e){if(A=Math.round(Math.max(1,A)),e=Math.round(Math.max(1,e)),this.stageWidth!==A||this.stageHeight!==e){const t=A-this.stageWidth,n=e-this.stageHeight;if(this._monitorState.size>0){const A=t/2,e=n/2;for(const t of this._monitorState.valueSeq()){const n=t.set("x",t.get("x")+A).set("y",t.get("y")+e);this.requestUpdateMonitor(n)}this.emit($.MONITORS_UPDATE,this._monitorState)}this.stageWidth=A,this.stageHeight=e,this.renderer&&this.renderer.setStageSize(-A/2,A/2,-e/2,e/2),this.emit($.STAGE_SIZE_CHANGED,A,e)}}setInEditor(A){}convertToPackagedRuntime(){if(this.storage)throw new Error("convertToPackagedRuntime must be called before attachStorage");this.isPackaged=!0}resetAllCaches(){for(const A of this.targets)A.isOriginal&&A.blocks.resetCache();this.flyoutBlocks.resetCache(),this.monitorBlocks.resetCache()}addAddonBlock(A){const e=A.procedureCode,t=A.arguments,r=A.arguments.map((A,e)=>"arg".concat(e)),o=A.arguments.map(()=>"");if(this.addonBlocks[e]=function(A){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?n(Object(t),!0).forEach((function(e){i(A,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(t)):n(Object(t)).forEach((function(e){Object.defineProperty(A,e,Object.getOwnPropertyDescriptor(t,e))}))}return A}({namesIdsDefaults:[t,r,o]},A),!A.hidden){const A="a-b";let n=this._blockInfo.find(e=>e.id===A);if(!n){n={id:A,name:"Addons",color1:"#29beb8",color2:"#3aa8a4",color3:"#3aa8a4",menuIconURI:"".concat(encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48"><path d="M14.92 1.053A13.835 13.835 0 0 0 1.052 14.919v18.162a13.835 13.835 0 0 0 13.866 13.866h18.162a13.835 13.835 0 0 0 13.866-13.866V14.919A13.835 13.835 0 0 0 33.081 1.053zm16.6 12.746L41.72 24 31.52 34.201l-3.276-3.275L35.17 24l-6.926-6.926Zm-15.116.073 3.278 3.278L12.83 24l6.926 6.926L16.48 34.2 6.28 24Z" style="fill:#29beb8;fill-opacity:1;stroke:none;stroke-width:1.51371;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"/></svg>')),blocks:[],customFieldTypes:{},menus:[]},this._blockInfo.unshift(n)}n.blocks.push({info:{},xml:'<block type="procedures_call" gap="16"><mutation generateshadows="true" warp="false"'+' proccode="'.concat(p(e),'"')+' argumentnames="'.concat(p(JSON.stringify(t)),'"')+' argumentids="'.concat(p(JSON.stringify(r)),'"')+' argumentdefaults="'.concat(p(JSON.stringify(o)),'"')+"></mutation></block>"})}this.resetAllCaches()}getAddonBlock(A){return Object.prototype.hasOwnProperty.call(this.addonBlocks,A)?this.addonBlocks[A]:null}findProjectOptionsComment(){const A=this.getTargetForStage().comments;for(const e of Object.values(A))if(e.text.includes(" // _twconfig_"))return e;return null}parseProjectOptions(A){const e=null!=A?A:this.findProjectOptionsComment();if(!e)return;const t=e.text.split("\n").find(A=>A.endsWith(" // _twconfig_"));if(!t)return void I.warn("Config comment does not contain valid line");const n=t.slice(0,t.length-" // _twconfig_".length);let i;try{if(i=s.parse(n),!i||"object"!=typeof i)throw new Error("Invalid object")}catch(A){return void I.warn("Config comment has invalid JSON",A)}"number"==typeof i.framerate&&this.setFramerate(i.framerate),i.turbo&&(this.turboMode=!0,this.emit($.TURBO_MODE_ON)),i.interpolation&&this.setInterpolation(!0),i.runtimeOptions&&this.setRuntimeOptions(i.runtimeOptions),"boolean"==typeof i.hq&&this.renderer&&this.renderer.setUseHighQualityRender(i.hq);const r=+i.width||this.stageWidth,o=+i.height||this.stageHeight;r===this.stageWidth&&o===this.stageHeight||this.setStageSize(r,o)}_generateAllProjectOptions(){return{framerate:this.frameLoop.framerate,runtimeOptions:this.runtimeOptions,interpolation:this.interpolationEnabled,turbo:this.turboMode,hq:!this.renderer||this.renderer.useHighQualityRender,width:this.stageWidth,height:this.stageHeight}}generateDifferingProjectOptions(){const A=(e,t)=>{const n={};for(const i of Object.keys(t)){const r=t[i],o=e[i];if("object"==typeof r&&r){const e=A(o,r);Object.keys(e).length>0&&(n[i]=e)}else r!==o&&(n[i]=r)}return n};return A(this._defaultStoredSettings,this._generateAllProjectOptions())}storeProjectOptions(){const A=this.generateDifferingProjectOptions(),e="Configuration for https://penguinmod.com/\nYou can move, resize, and minimize this comment, but don't edit it by hand. This comment can be deleted to remove the stored settings.\n".concat(s.stringify(A)).concat(" // _twconfig_"),t=this.findProjectOptionsComment();if(t)t.text=e;else{this.getTargetForStage().createComment(z(),null,e,50,50,350,170,!1)}this.emitProjectChanged()}precompile(){this.allScriptsDo((A,e)=>{const t=e.blocks.getBlock(A);if(this.getIsHat(t.opcode)){const t=new C(A);t.target=e,t.blockContainer=e.blocks,t.tryCompile()}})}enableDebug(){this.resetAllCaches(),this.debug=!0}_updateGlows(A){const e=[];e.push.apply(e,this.threads),A&&e.push.apply(e,A);const t=[],n=[];for(let A=0;A<e.length;A++){const n=e[A],i=n.target;if(i===this._editingTarget){const A=n.blockGlowInFrame;if(n.requestScriptGlowInFrame||n.stackClick){let e=i.blocks.getTopLevelScript(A);e||(e=this.flyoutBlocks.getTopLevelScript(A)),e&&t.push(e)}}}for(let A=0;A<this._scriptGlowsPreviousFrame.length;A++){const e=this._scriptGlowsPreviousFrame[A];t.indexOf(e)<0?this.glowScript(e,!1):n.push(e)}for(let A=0;A<t.length;A++){const e=t[A];this._scriptGlowsPreviousFrame.indexOf(e)<0&&(this.glowScript(e,!0),n.push(e))}this._scriptGlowsPreviousFrame=n}_emitProjectRunStatus(A){0===this._nonMonitorThreadCount&&A>0&&this.emit($.PROJECT_RUN_START),this._nonMonitorThreadCount>0&&0===A&&this.emit($.PROJECT_RUN_STOP),this._nonMonitorThreadCount=A}quietGlow(A){const e=this._scriptGlowsPreviousFrame.indexOf(A);e>-1&&this._scriptGlowsPreviousFrame.splice(e,1)}glowBlock(A,e){e?this.emit($.BLOCK_GLOW_ON,{id:A}):this.emit($.BLOCK_GLOW_OFF,{id:A})}glowScript(A,e){e?this.emit($.SCRIPT_GLOW_ON,{id:A}):this.emit($.SCRIPT_GLOW_OFF,{id:A})}emitBlockDragUpdate(A){this.emit($.BLOCK_DRAG_UPDATE,A)}emitBlockEndDrag(A,e){this.emit($.BLOCK_DRAG_END,A,e)}visualReport(A,e){this.emit($.VISUAL_REPORT,{id:A,value:e})}requestAddMonitor(A){const e=A.get("id");this.requestUpdateMonitor(A)||(this._monitorState=this._monitorState.set(e,A))}requestUpdateMonitor(A){const e=A.get("id");return!!this._monitorState.has(e)&&(this._monitorState=this._monitorState.set(e,this._monitorState.get(e).mergeWith((A,e)=>null==e?A:e,A)),!0)}requestRemoveMonitor(A){this._monitorState=this._monitorState.delete(A)}requestHideMonitor(A){return this.requestUpdateMonitor(new Map([["id",A],["visible",!1]]))}requestShowMonitor(A){return this.requestUpdateMonitor(new Map([["id",A],["visible",!0]]))}requestRemoveMonitorByTargetId(A){this._monitorState=this._monitorState.filterNot(e=>e.targetId===A)}getTargetById(A){for(let e=0;e<this.targets.length;e++){const t=this.targets[e];if(t.id===A)return t}}getSpriteTargetByName(A){const e=Y(A);if(e.id)return this.getTargetById(e.id);for(let e=0;e<this.targets.length;e++){const t=this.targets[e];if(!t.isStage&&(t.sprite&&t.sprite.name===A))return t}}getTargetByDrawableId(A){for(let e=0;e<this.targets.length;e++){const t=this.targets[e];if(t.drawableID===A)return t}}changeCloneCounter(A){this._cloneCounter+=A}clonesAvailable(){return this._cloneCounter<this.runtimeOptions.maxClones}emitProjectLoaded(){for(const e of this.targets)for(const t in e.variables){var A;const n=e.variables[t];if(n.type===m.LIST_TYPE)for(const A in n.value){const t=n.value[A];if(t.customType){const{deserialize:i}=this.serializers[t.typeId];n.value[A]=i(t.serialized,e)}}if(null!==(A=n.value)&&void 0!==A&&A.customType){const A=n.value,{deserialize:t}=this.serializers[A.typeId];n.value=t(A.serialized,e)}}this.emit($.PROJECT_LOADED)}emitProjectChanged(){this.emit($.PROJECT_CHANGED)}fireTargetWasCreated(A,e){this.emit("targetWasCreated",A,e)}fireTargetWasRemoved(A){this.emit("targetWasRemoved",A)}getBranchAndTarget(A,e){for(const t of this.targets){const n=t.blocks.getBranch(A,e);if(n)return[n,t]}return null}getCamera(A){return"object"!=typeof this.cameraStates[A]&&(this.cameraStates[A]={pos:[0,0],dir:0,scale:1}),this.cameraStates[A]}updateCamera(A,e,t){var n;e.dir&&(e.dir=y.wrapClamp(e.dir,-179,180)),"object"!=typeof this.cameraStates[A]&&(this.cameraStates[A]={pos:[0,0],dir:0,scale:1}),this.cameraStates[A]=e=Object.assign(this.cameraStates[A],e),(null!==(n=!t)&&void 0!==n?n:e.silent)&&this.emitCameraChanged(A)}emitCameraChanged(A){for(let e=0;e<this.targets.length;e++)this.targets[e].cameraBound===A&&this.targets[e].cameraUpdateEvent();this.emit($.CAMERA_CHANGED,A),this.requestRedraw()}getTargetForStage(){if(this._stageTarget)return this._stageTarget;for(let A=0;A<this.targets.length;A++){const e=this.targets[A];if(e.isStage)return this._stageTarget=e,e}}getEditingTarget(){return this._editingTarget}getAllVarNamesOfType(A){let e=[];for(const t of this.targets){const n=t.getAllVariableNamesInScopeByType(A,!0);e=e.concat(n)}return e}getLabelForOpcode(A){var e,t,n;const[i,r]=J.splitFirst(A,"_");if(!i||!r)return;const o=this._blockInfo.find(A=>A.id===i);if(!o)return;const s=o.blocks.find(A=>A.info.opcode===r);if(!s)return;const a=this["ext_".concat(i)];let B=s.info.labelFn?a[s.info.labelFn]:void 0;return{category:null!==(e=null!==(t=s.info.color1)&&void 0!==t?t:o.color1)&&void 0!==e?e:"extension",label:null!==(n=s.info.label)&&void 0!==n?n:"".concat(o.name,": ").concat(s.info.text),labelFn:B}}createNewGlobalVariable(A,e,t){const n="string"==typeof t?t:m.SCALAR_TYPE,i=this.getAllVarNamesOfType(n),r=J.unusedName(A,i),o=this.newVariableInstance(n,e||z(),r);return this.getTargetForStage().variables[o.id]=o,o}requestRedraw(){this.redrawRequested=!0}requestTargetsUpdate(A){A.isOriginal&&(this._refreshTargets=!0)}requestBlocksUpdate(){this.emit($.BLOCKS_NEED_UPDATE)}requestToolboxExtensionsUpdate(){this.emit($.TOOLBOX_EXTENSIONS_NEED_UPDATE)}start(){this.frameLoop.running||(this.frameLoop.start(),this.emit($.RUNTIME_STARTED))}stop(){this.frameLoop.running&&(this.frameLoop.stop(),this.emit($.RUNTIME_STOPPED))}enableProfiling(A){E.available()&&(this.profiler=new E(A))}disableProfiling(){this.profiler=null}updateCurrentMSecs(){this.currentMSecs=Date.now()}updatePrivacy(){const A=this.enforcePrivacy&&Object.values(this.externalCommunicationMethods).some(A=>A);this.renderer&&this.renderer.setPrivateSkinAccess&&this.renderer.setPrivateSkinAccess(!A)}setEnforcePrivacy(A){this.enforcePrivacy=A,this.updatePrivacy()}setExternalCommunicationMethod(A,e){if(!Object.prototype.hasOwnProperty.call(this.externalCommunicationMethods,A))throw new Error("Unknown method: ".concat(A));this.externalCommunicationMethods[A]=e,this.updatePrivacy()}}A.exports=$},function(A,e,t){"use strict";t.r(e),t.d(e,"_parse",(function(){return n})),t.d(e,"parse",(function(){return i})),t.d(e,"stringify",(function(){return r}));const n=A=>{let e=0;const t=t=>{const{line:n,column:i}=(()=>{let t=0,n=0;for(let i=0;i<e;i++)"\n"===A[i]?(t++,n=0):n++;return{line:t+1,column:n+1}})();throw new SyntaxError("".concat(t," (Line ").concat(n," Column ").concat(i,")"))},n=e=>(e>=A.length&&t("Unexpected end of input"),A[e]),i=()=>n(e),r=()=>{e++},o=A=>{i()!==A&&t("Expected '".concat(A,"' but found '").concat(i(),"'")),r()},s=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(e+i+t>A.length)return"";if(1===t)return n(e+i);let r="";for(let A=0;A<t;A++)r+=n(e+i+A);return r},a=()=>{for(;;)if(/\s/.test(i()))r();else{const A=s(2,0);if("//"===A)for(r(),r();"\n"!==i();)r();else{if("/*"!==A)break;for(r(),r();"*/"!==s(2,0);)r();r(),r()}}},B=()=>{a();switch(i()){case'"':return E();case"{":return u();case"[":return Q();case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":return g();default:return c()}},c=()=>{if("null"===s(4,0)){for(let A=0;A<4;A++)r();return null}if("true"===s(4,0)){for(let A=0;A<4;A++)r();return!0}if("false"===s(5,0)){for(let A=0;A<5;A++)r();return!1}if("Infinity"===s(8,0)){for(let A=0;A<8;A++)r();return 1/0}if("NaN"===s(3,0)){for(let A=0;A<3;A++)r();return NaN}t("Unexpected character '".concat(i(),"'"))},g=()=>{if("-Infinity"===s(9,0)){for(let A=0;A<9;A++)r();return-1/0}let A="";for(;A+=i(),/[\d.e+-]/i.test(s());)r();r();const e=+A;return Number.isNaN(e)&&t("Not a number: ".concat(A)),e},E=()=>{o('"');let A="";for(;;){const e=i();if('"'===e)break;if("\\"===e)switch(r(),i()){case'"':A+='"';break;case"/":A+="/";break;case"\\":A+="\\";break;case"b":A+="\b";break;case"f":A+="\f";break;case"n":A+="\n";break;case"r":A+="\r";break;case"t":A+="\t";break;case"u":{let e="";for(let A=0;A<4;A++){r();const A=i();/[0-9a-f]/i.test(A)||t("Invalid hex code: ".concat(A)),e+=A}const n=Number.parseInt(e,16);A+=String.fromCharCode(n);break}default:t("Invalid escape code: \\".concat(i()))}else A+=e;r()}return o('"'),A},Q=()=>{o("["),a();const A=[];for(;a(),"]"!==i();){const e=B();if(A.push(e),a(),","!==i())break;r()}return o("]"),A},u=()=>{o("{"),a();const A={};for(;a(),"}"!==i();){const e=E();a(),o(":");const t=B();if(A[e]=t,a(),","!==i())break;r()}return o("}"),A};return B()},i=A=>{try{return JSON.parse(A)}catch(e){try{return n(A)}catch(A){throw e}}},r=A=>{if("string"==typeof A)return JSON.stringify(A);if("number"==typeof A||"boolean"==typeof A)return A.toString();if(null==A||"symbol"==typeof A)return"null";if(Array.isArray(A))return"[".concat(A.map(A=>r(A)).join(","),"]");if("object"==typeof A){let e="{",t=!0;const n=Object.keys(A);for(let i=0;i<n.length;i++){const o=n[i],s=A[o];void 0!==s&&(t||(e+=","),e+="".concat(JSON.stringify(o),":").concat(r(s)),t=!1)}return e+="}",e}if("bigint"==typeof A)throw new TypeError("Can not stringify bigint");throw new TypeError("Can not stringify: ".concat(A))}},function(A,e){const t=function(A){if("#text"===A.tagName)return A.textContent;const e=(A,e)=>{for(let n=0;n<e.children.length;n++)A.children.push(t(e.children[n]));return A.children[0]};let n=Object.create(null);if(n.tagName=A.tagName,n.children=[],!A.tagName)return console.warn("invalid dom; skiping to reading children"),n=e(n,A),n;for(let e=0;e<A.attributes.length;e++){const t=A.attributes[e],i=t.name;"xmlns"!==i&&(n[i]=t.value,"blockinfo"===i&&(n.blockInfo=JSON.parse(n.blockinfo),delete n.blockinfo))}return e(n,A),n};A.exports=function(A){let e;if("object"==typeof A)e=A;else{e=(new DOMParser).parseFromString(A,"application/xml"),"#document"===e.nodeName&&(e=e.children[0])}return t(e)}},function(A,e,t){e.getCached=function(){throw new Error("blocks.js has not initialized BlocksExecuteCache")},t(22)},function(A,e,t){e.getScripts=function(){throw new Error("blocks.js has not initialized BlocksRuntimeCache")},e._RuntimeScriptCache=class{constructor(A,e){this.container=A,this.blockId=e;const t=A.getBlock(e),n=A.getFields(t);if(this.fieldsOfInputs=Object.assign({},n),0===Object.keys(n).length){const e=A.getInputs(t);for(const t in e){if(!e.hasOwnProperty(t))continue;const n=e[t].block,i=A.getBlock(n),r=A.getFields(i);Object.assign(this.fieldsOfInputs,r)}}for(const A in this.fieldsOfInputs){const e=this.fieldsOfInputs[A]=Object.assign({},this.fieldsOfInputs[A]);e.value.toUpperCase&&(e.value=e.value.toUpperCase())}}},t(22)},function(A,e,t){const n=t(18),i=t(36),r=t(61),o=t(43);let s=-1,a=-1,B=-1;class c{constructor(A){this.timer=new n,this.runtime=A,this.activeThread=null}static get WARP_TIME(){return 500}stepThreads(){const A=.75*this.runtime.currentStepTime;this.runtime.updateCurrentMSecs(),this.timer.start();let e=1/0,t=!1;const n=[];for(;this.runtime.threads.length>0&&e>0&&this.timer.timeElapsed()<A&&(this.runtime.turboMode||!this.runtime.redrawRequested);){null!==this.runtime.profiler&&(-1===a&&(a=this.runtime.profiler.idByName("Sequencer.stepThreads#inner")),this.runtime.profiler.start(a)),e=0;let A=!1;const r=this.runtime.threads;for(let n=0;n<r.length;n++){const o=this.activeThread=r[n];0!==o.stack.length&&o.status!==i.STATUS_DONE?o.status!==i.STATUS_PAUSED?(o.status!==i.STATUS_YIELD_TICK||t||(o.status=i.STATUS_RUNNING),o.status!==i.STATUS_RUNNING&&o.status!==i.STATUS_YIELD||(null!==this.runtime.profiler&&(-1===s&&(s=this.runtime.profiler.idByName("Sequencer.stepThread")),this.runtime.profiler.increment(s)),this.stepThread(o),o.warpTimer=null),o.status===i.STATUS_RUNNING&&e++,0!==o.stack.length&&o.status!==i.STATUS_DONE||(A=!0)):o.timer&&!o.timer._pausedTime&&o.timer.pause():A=!0}if(t=!0,null!==this.runtime.profiler&&this.runtime.profiler.stop(),A){let A=0;for(let e=0;e<this.runtime.threads.length;e++){const t=this.runtime.threads[e];0!==t.stack.length&&t.status!==i.STATUS_DONE?(this.runtime.threads[A]=t,A++):(this.runtime.threadMap.delete(t.getId()),n.push(t))}this.runtime.threads.length=A}}return this.activeThread=null,n}stepThread(A){if(A.isCompiled)return void o(A);let e=A.peekStack();if(!e&&(A.popStack(),0===A.stack.length))return A.status=i.STATUS_DONE,void this.runtime.emit("THREAD_FINISHED",A);for(;e=A.peekStack();){let t=A.peekStackFrame().warpMode;if(t&&!A.warpTimer&&(A.warpTimer=new n,A.warpTimer.start()),null!==this.runtime.profiler&&(-1===B&&(B=this.runtime.profiler.idByName("execute")),this.runtime.profiler.increment(B)),null===A.target?this.retireThread(A):r(this,A),A.blockGlowInFrame=e,A.status===i.STATUS_YIELD){if(A.status=i.STATUS_RUNNING,t&&A.warpTimer.timeElapsed()<=c.WARP_TIME)continue;return}if(A.status===i.STATUS_PROMISE_WAIT)return;if(A.status===i.STATUS_YIELD_TICK)return;if(A.status===i.STATUS_DONE)return;for(A.peekStack()===e&&A.goToNextBlock();!A.peekStack();){if(A.popStack(),0===A.stack.length)return A.status=i.STATUS_DONE,void this.runtime.emit("THREAD_FINISHED",A);const e=A.peekStackFrame();if(t=e.warpMode,e.isLoop){if(!t||A.warpTimer.timeElapsed()>c.WARP_TIME)return}else{if(e.waitingReporter)return;A.goToNextBlock()}}}}stepToBranch(A,e,t){e||(e=1);const n=A.peekStack(),i=A.target.blocks.getBranch(n,e);A.peekStackFrame().isLoop=t,i?A.pushStack(i):A.pushStack(null)}stepToProcedure(A,e){const t=A.target.blocks.getProcedureDefinition(e);if(!t)return;const n=A.isRecursiveCall(e);if(A.pushStack(t),A.peekStackFrame().warpMode&&A.warpTimer.timeElapsed()>c.WARP_TIME)A.status=i.STATUS_YIELD;else{const e=A.target.blocks.getBlock(t),r=A.target.blocks.getBlock(e.inputs.custom_block.block);let o=!1;if(r&&r.mutation){const A=r.mutation.warp;"boolean"==typeof A?o=A:"string"==typeof A&&(o=JSON.parse(A))}o?A.peekStackFrame().warpMode=!0:n&&(A.status=i.STATUS_YIELD)}}retireThread(A){A.stack=[],A.stackFrame=[],A.requestScriptGlowInFrame=!1,A.status=i.STATUS_DONE,this.runtime.emit("THREAD_FINISHED",A),A.isCompiled&&(A.procedures=null,A.generator=null)}}A.exports=c},function(A,e){A.exports={IntermediateScript:class{constructor(){this.topBlockId=null,this.stack=null,this.isProcedure=!1,this.procedureCode="",this.arguments=[],this.isWarp=!1,this.isOptimized=!1,this.optimizationUtil={},this.yields=!0,this.warpTimer=!1,this.dependedProcedures=[],this.cachedCompileResult=null,this.executableHat=!1}},IntermediateRepresentation:class{constructor(){this.entry=null,this.procedures={}}}}},function(A,e,t){const n=t(16);class i{constructor(A){this.runtime=A,this.provider=null,this._skinId=-1,this._drawable=-1,this._ghost=0,this._forceTransparentPreview=!1}static get FORMAT_IMAGE_DATA(){return"image-data"}static get FORMAT_CANVAS(){return"canvas"}static get DIMENSIONS(){return[480,360]}static get ORDER(){return 1}setProvider(A){this.provider=A}enableVideo(){return this.provider?this.provider.enableVideo().then(()=>this._setupPreview()):null}disableVideo(){if(this._disablePreview(),!this.provider)return null;this.provider.disableVideo()}getFrame(A){let{dimensions:e=i.DIMENSIONS,mirror:t=this.mirror,format:n=i.FORMAT_IMAGE_DATA,cacheTimeout:r=this._frameCacheTimeout}=A;return this.provider?this.provider.getFrame({dimensions:e,mirror:t,format:n,cacheTimeout:r}):null}setPreviewGhost(A){this._ghost=A,-1!==this._drawable&&this.runtime.renderer.updateDrawableEffect(this._drawable,"ghost",this._forceTransparentPreview?100:A)}_disablePreview(){-1!==this._skinId&&(this.runtime.renderer.updateBitmapSkin(this._skinId,new ImageData(...i.DIMENSIONS),1),this.runtime.renderer.updateDrawableVisible(this._drawable,!1)),this._renderPreviewFrame=null}_setupPreview(){const{renderer:A}=this.runtime;A&&(-1===this._skinId&&-1===this._drawable&&(this._skinId=A.createBitmapSkin(new ImageData(...i.DIMENSIONS),1),this._drawable=A.createDrawable(n.VIDEO_LAYER),A.updateDrawableSkinId(this._drawable,this._skinId),A.markSkinAsPrivate&&A.markSkinAsPrivate(this._skinId)),this._renderPreviewFrame||(A.updateDrawableEffect(this._drawable,"ghost",this._forceTransparentPreview?100:this._ghost),A.updateDrawableVisible(this._drawable,!0),this._renderPreviewFrame=()=>{if(clearTimeout(this._renderPreviewTimeout),!this._renderPreviewFrame)return;this._renderPreviewTimeout=setTimeout(this._renderPreviewFrame,this.runtime.currentStepTime);const e=this.getFrame({format:i.FORMAT_IMAGE_DATA,cacheTimeout:this.runtime.currentStepTime});e?(A.updateBitmapSkin(this._skinId,e,1),this.runtime.requestRedraw()):A.updateBitmapSkin(this._skinId,new ImageData(...i.DIMENSIONS),1)},this._renderPreviewFrame()))}get videoReady(){return!!this.provider&&this.provider.videoReady}postData(A){let{forceTransparentPreview:e}=A;this._forceTransparentPreview=e,this.setPreviewGhost(this._ghost)}}A.exports=i},function(A,e,t){const n=t(4);A.exports=A=>{const e=n.namespace(),t=(A,t)=>{if(A&&"object"==typeof A);else{if("string"!=typeof A)throw new Error("unsupported data type in translate()");A={default:A}}return e(A,t)},i=A=>"_".concat(A),r=()=>A?A.getLocale():"undefined"!=typeof navigator?navigator.language:"en";let o={};return t.setup=A=>{A&&(o=A),e.setup({locale:r(),missingTranslation:"ignore",generateId:i,translations:o})},Object.defineProperty(t,"language",{configurable:!0,enumerable:!0,get:()=>r()}),t.setup({}),A&&A.on("LOCALE_CHANGED",()=>{t.setup(null)}),t}},function(A,e){A.exports={generateExtensionId:A=>{const e=A.replace(/[^a-z0-9]/gi,"").toLowerCase();return"sbx".concat(e)},argumentIndexToId:A=>A.toString()}},function(A,e,t){"use strict";var n=window.URL||window.webkitURL;A.exports=function(A,e){try{try{var t;try{(t=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder)).append(A),t=t.getBlob()}catch(e){t=new Blob([A])}return new Worker(n.createObjectURL(t))}catch(e){return new Worker("data:application/javascript,"+encodeURIComponent(A))}}catch(A){if(!e)throw Error("Inline worker is not supported");return new Worker(e)}}},function(A,e){class t{static _mergeVarRefObjects(A,e){for(const t in e)A[t]?A[t]=A[t].concat(e[t]):A[t]=e[t];return A}static getAllVarRefsForTargets(A,e){return A.map(A=>A.blocks.getAllVariableAndListReferences(null,e)).reduce(t._mergeVarRefObjects,{})}static updateVariableIdentifiers(A,e,t){A.map(A=>(A.referencingField.id=e,t&&(A.referencingField.value=t),A))}}A.exports=t},function(A,e,t){const n=t(69),i=t(70),r=t(104),o=t(105),s=t(413),a=t(417),B=(A,e)=>{const t=[],n=A=>{A.localName!==e&&void 0!==e||!A.getAttribute||t.push(A);for(let e=0;e<A.childNodes.length;e++)n(A.childNodes[e])};return n(A),t},c=A=>{const e=a(),t=document.createElement("span"),i=A.outerHTML,r=n.sanitize(i,{USE_PROFILES:{svg:!0},FORBID_TAGS:["a","audio","canvas","video"],ADD_DATA_URI_TAGS:["image"]});let o,s;try{t.innerHTML=r,e.appendChild(t),o=t.children[0].getBBox()}finally{e.removeChild(t)}s=0===o.width||0===o.height?0:(A=>{let e=0;const t=A=>{A.getAttribute&&(A.getAttribute("stroke")&&(e=Math.max(e,1)),A.getAttribute("stroke-width")&&(e=Math.max(e,Number(A.getAttribute("stroke-width"))||0)));for(let e=0;e<A.childNodes.length;e++)t(A.childNodes[e])};return t(A),e})(A)/2;const B=o.width+2*s,c=o.height+2*s,g=o.x-s,E=o.y-s;A.setAttribute("width",B),A.setAttribute("height",c),A.setAttribute("viewBox","".concat(g," ").concat(E," ").concat(B," ").concat(c))},g=(A,e)=>{e&&(A=>{const e=B(A,"linearGradient");for(const A of e)A.getAttribute("x2")||A.setAttribute("x2","0")})(A),s(A,window),(A=>{const e=B(A,"image"),t="image-rendering: optimizespeed; image-rendering: pixelated;";for(const A of e)A.getAttribute("style")?A.setAttribute("style","".concat(t," ").concat(A.getAttribute("style"))):A.setAttribute("style",t)})(A),e?((A=>{const e=[],t=A=>{"text"===A.localName&&e.push(A);for(let e=0;e<A.childNodes.length;e++)t(A.childNodes[e])};t(A),r(A);for(const t of e){t.removeAttribute("x"),t.removeAttribute("y"),t.setAttribute("alignment-baseline","text-before-edge"),t.setAttribute("xml:space","preserve"),t.getAttribute("font-size")||t.setAttribute("font-size","18");let e=t.textContent;const n=parseFloat(t.getAttribute("font-size")),r=2;let o=0,s=1.2;if("Handwriting"===t.getAttribute("font-family")?(s=2,o=-11*n/22):"Scratch"===t.getAttribute("font-family")?(s=.89,o=-3*n/22):"Curly"===t.getAttribute("font-family")?(s=1.38,o=-6*n/22):"Marker"===t.getAttribute("font-family")?(s=1.45,o=-6*n/22):"Sans Serif"===t.getAttribute("font-family")?(s=1.13,o=-3*n/22):"Serif"===t.getAttribute("font-family")&&(s=1.25,o=-4*n/22),0===t.transform.baseVal.numberOfItems){const e=A.createSVGTransform();t.transform.baseVal.appendItem(e)}const a=t.transform.baseVal.getItem(0).matrix;if(a.e+=a.a*r+a.c*o,a.f+=a.b*r+a.d*o,e&&0===t.childElementCount){t.textContent="";const A=e.split("\n");e="";for(const e of A){const A=i.create("tspan");A.setAttribute("x","0"),A.setAttribute("style","white-space: pre"),A.setAttribute("dy","".concat(s,"em")),A.textContent=e||" ",t.appendChild(A)}}}})(A),c(A),(A=>{const e=B(A);for(const A of e){if(!A.style)continue;const e=A.style.stroke||A.getAttribute("stroke");e&&e.match(/^url\(#.*\)$/)&&(A.style["stroke-linejoin"]="round",A.style["stroke-linecap"]="round")}})(A)):A.getAttribute("viewBox")?A.getAttribute("width")&&A.getAttribute("height")||(A.setAttribute("width",A.viewBox.baseVal.width),A.setAttribute("height",A.viewBox.baseVal.height)):c(A)};A.exports=(A,e)=>{const t=new DOMParser;A=o(A);const n=t.parseFromString(A,"text/xml");if(n.childNodes.length<1||"svg"!==n.documentElement.localName)throw new Error("Document does not appear to be SVG.");const i=n.documentElement;return g(i,e),i}},function(A,e){A.exports=function(A){const e=[],t=A=>{"text"===A.localName&&e.push(A);for(let e=0;e<A.childNodes.length;e++)t(A.childNodes[e])};t(A);for(const A of e)A.getAttribute("font-family")&&"Helvetica"!==A.getAttribute("font-family")?"Mystery"===A.getAttribute("font-family")?A.setAttribute("font-family","Curly"):"Gloria"===A.getAttribute("font-family")?A.setAttribute("font-family","Handwriting"):"Donegal"===A.getAttribute("font-family")&&A.setAttribute("font-family","Serif"):A.setAttribute("font-family","Sans Serif")}},function(A,e){A.exports=function(A){const e=A.match(/<svg [^>]*>/);e&&-1===e[0].indexOf("xmlns=")&&(A=A.replace("<svg ",'<svg xmlns="http://www.w3.org/2000/svg" ')),e&&-1!==e[0].indexOf("&ns_")&&-1===A.indexOf("<!DOCTYPE")&&(A=A.replace(e[0],e[0].replace(/&ns_[^;]+;/g,"http://ns.adobe.com/Extensibility/1.0/"))),A.includes("data:img/png")&&(A=A.replace(/(<image[^>]+?xlink:href=["'])data:img\/png/g,(A,e)=>"".concat(e,"data:image/png")));const t=/(<[^>]+?xmlns:(?!xml=)[^ ]+=)"http:\/\/www.w3.org\/XML\/1998\/namespace"/g;return null!==A.match(t)&&(A=A.replace(t,(A,e)=>"".concat(e,'"http://dummy.namespace"'))),A=(A=(A=A.replace(/<(\/?)\s*svg:/g,"<$1")).replace(/<metadata>[\s\S]*<\/metadata>/,"<metadata></metadata>")).replace(/<script[\s\S]*>[\s\S]*<\/script>/,"<script><\/script>")}},function(A,e,t){const n=t(107);A.exports=(A,e)=>{let t=(new XMLSerializer).serializeToString(A);return e&&(t=n(t,e)),t}},function(A,e,t){const n=t(418),i=A=>A.replace(/[<>&'"]/g,A=>{switch(A){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case"'":return"&apos;";case'"':return"&quot;"}});A.exports=function(A){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"!=typeof A)throw new Error("SVG to be inlined is not a string");const t={};if(e&&"object"==typeof e)for(const[A,n]of Object.entries(e))t[i(A)]=n;try{Object.assign(t,n())}catch(A){}const r=new Set,o=/font-family="([^"]*)"/g;let s=o.exec(A);for(;s;)r.add(s[1]),s=o.exec(A);if(r.size>0){let e="<defs><style>";for(const A of r)Object.prototype.hasOwnProperty.call(t,A)&&(e+="".concat(t[A]));return e+="</style></defs>",A=A.replace(/<svg[^>]*>/,"$&".concat(e))}return A}},function(A,e,t){let n,i;"undefined"==typeof TextEncoder?(n=t(30).TextEncoder,i=t(30).TextDecoder):(n=TextEncoder,i=TextDecoder);const r="<!".concat("-".repeat(2)),o="".concat("-".repeat(2),">"),s=new RegExp("".concat(r,"rotationCenter:(-?[\\d\\.]+):(-?[\\d\\.]+)").concat(o,"$")),a=function(A){let e="";for(let t=0;t<A.length;t+=32768){const n=A.subarray(t,t+32768);e+=String.fromCharCode.apply(null,n)}return btoa(e)};A.exports={parseVectorMetadata:A=>{const e=A.match(s);if(!e)return null;const t=+e[1],n=+e[2];return Number.isNaN(t)||Number.isNaN(n)?null:[t,n]},exportCostume:(A,e)=>{var t;const B=A.asset.data;if("svg"!==A.dataFormat)return B;let c=(new i).decode(B);c=c.replace(s,"");const g=A.rotationCenterX,E=A.rotationCenterY,Q="".concat(r,"rotationCenter:").concat(g,":").concat(E).concat(o);if(c+=Q,e&&null!==(t=vm)&&void 0!==t&&null!==(t=t.runtime)&&void 0!==t&&null!==(t=t.fontManager)&&void 0!==t&&t.fonts){const A=(A=>{let e="";for(const t of A){const A=a(t.asset.data);let n=t.asset.dataFormat.toLowerCase();"otf"===n&&(n="opentype"),"ttf"===n&&(n="truetype"),e+="@font-face {",e+='font-family: "'.concat(t.family,'";'),e+="src: url('data:font/".concat(n,";base64,").concat(A,"') format('").concat(n,"');"),e+="}"}return e})(vm.runtime.fontManager.fonts.filter(A=>!A.system).filter(A=>c.includes('font-family="&quot;'.concat(A.family,"&quot;, ").concat(A.fallback,'"'))));if(A){const e='<style type="text/css">'.concat(A,"</style>");c=c.replace(new RegExp("<svg[^>]*?>"),A=>"".concat(A).concat(e))}}return(new n).encode(c)}}},function(A,e,t){const n=t(9);A.exports=A=>{const e={};for(let t=0;t<A.length;t++){const i=n(),r=A[t].id;A[t].id=e[r]=i}for(let t=0;t<A.length;t++){for(const n in A[t].inputs){const i=A[t].inputs[n];i.block=e[i.block],i.shadow=e[i.shadow]}A[t].parent&&(A[t].parent=e[A[t].parent]),A[t].next&&(A[t].next=e[A[t].next])}}},function(A,e,t){const n=t(33),i=t(5);A.exports={deserializeSound:function(A,e,t,r){const o=r||A.md5,s=e.storage;if(!s)return i.warn("No storage module present; cannot load sound asset: ",o),Promise.resolve(null);if(!t)return Promise.resolve(null);let a=t.file(o);if(!a){const A=new RegExp("^([^/]*/)?".concat(o,"$"));a=t.file(A)[0]}if(!a)return i.error("Could not find sound file associated with the ".concat(A.name," sound.")),Promise.resolve(null);if(!n.support.uint8array)return i.error("JSZip uint8array is not supported in this browser."),Promise.resolve(null);let B=s.DataFormat.WAV;switch(A.dataFormat.toLowerCase()){case"mp3":B=s.DataFormat.MP3;break;case"ogg":B=s.DataFormat.OGG;break;case"flac":B=s.DataFormat.FLAC}return a.async("uint8array").then(A=>s.createAsset(s.AssetType.Sound,B,A,null,!0)).then(e=>{A.asset=e,A.assetId=e.assetId,A.md5="".concat(e.assetId,".").concat(e.dataFormat)})},deserializeCostume:function(A,e,t,r,o){const s=e.storage,a=A.assetId,B=r||"".concat(a,".").concat(A.dataFormat);if(!s)return i.warn("No storage module present; cannot load costume asset: ",B),Promise.resolve(null);if(A.asset)return Promise.resolve(s.createAsset(A.asset.assetType,A.asset.dataFormat,new Uint8Array(Object.keys(A.asset.data).map(e=>A.asset.data[e])),null,!0)).then(e=>{A.asset=e,A.assetId=e.assetId,A.md5="".concat(e.assetId,".").concat(e.dataFormat)});if(!t)return Promise.resolve(null);let c=t.file(B);if(!c){const A=new RegExp("^([^/]*/)?".concat(B,"$"));c=t.file(A)[0]}if(!c)return i.error("Could not find costume file associated with the ".concat(A.name," costume.")),Promise.resolve(null);let g=null;const E=A.dataFormat.toLowerCase();if("svg"===E?g=s.AssetType.ImageVector:["png","bmp","jpeg","jpg","gif"].indexOf(E)>=0?g=s.AssetType.ImageBitmap:i.error("Unexpected file format for costume: ".concat(E)),!n.support.uint8array)return i.error("JSZip uint8array is not supported in this browser."),Promise.resolve(null);let Q;if(A.textLayerMD5){const e=t.file(o);if(!e)return i.error("Could not find text layer file associated with the ".concat(A.name," costume.")),Promise.resolve(null);Q=e.async("uint8array").then(e=>s.createAsset(s.AssetType.ImageBitmap,"png",e,A.textLayerMD5)).then(e=>{A.textLayerAsset=e})}else Q=Promise.resolve(null);return Promise.all([Q,c.async("uint8array").then(A=>s.createAsset(g,E,A,null,!0)).then(e=>{A.asset=e,A.assetId=e.assetId,A.md5="".concat(e.assetId,".").concat(e.dataFormat)})])}}},function(A,e,t){const n=t(22),i=t(68),r=t(71),o=t(8),s=t(5),a=t(9),B=t(10),c=t(6),g=t(444),E=t(47),Q=t(19),u=t(57),l=t(16),w=t(100),{loadCostume:h}=t(49),{loadSound:C}=t(48),{deserializeCostume:I,deserializeSound:M}=t(110),d=["argument","control","data","event","looks","math","motion","operator","procedures","sensing","sound"],m=/\u001f|\./,p=A=>{const[e,t]=A.split(m),n=w.generateExtensionId(e);return"".concat(n,"_").concat(t)},F=function(A){const e=[{}];let t=0;const n=A.split(/(?=[^\\]%[nbs])/);for(let A=0;A<n.length;A++){const i=n[A].trim();if("%"===i.substring(0,1)){const A=i.substring(1,2),n={type:"input",inputName:"input"+t++};"n"===A?n.inputOp="math_number":"s"===A?n.inputOp="text":"b"===A&&(n.inputOp="boolean"),e.push(n)}}return e},D=function(A){return F(A).map(A=>A.inputName).filter(A=>A)},Y=function(A){let e=[];for(let t=0;t<A.length;t++){const n=A[t];e.push(n),n.children&&(e=e.concat(Y(n.children))),delete n.children}return e},f=function(A,e,t,n,i,r,o){const s=[];let a=null;for(let B=0;B<A.length;B++){const c=A[B],g=S(c,e,t,n,i,r,o),E=g[0];o=g[1],E&&(a&&(E.parent=a.id,a.next=E.id),a=E,s.push(E))}return[s,o]},N=function(){let A={};const e=(A,e,t)=>"".concat(A,"-").concat(B.replaceUnsafeChars(e),"-").concat(t);return function(t,n){return n&&(A={}),function(i,r){return n?(A["".concat(i,"-").concat(r)]=e(t,i,r),A["".concat(i,"-").concat(r)]):A["".concat(i,"-").concat(r)]?A["".concat(i,"-").concat(r)]:e(t,i,r)}}}(),U=function(){let A={};const e=[],t=a();return function(n){return n&&(A={}),{broadcastMsgMapUpdater:function(n,i){return""===(n=n.toLowerCase())&&(n=t),A[n]="broadcastMsgId-".concat(B.replaceUnsafeChars(n)),e.push(i),A[n]},globalBroadcastMsgs:A,allBroadcastFields:e,emptyMsgName:t}}}(),y=(A,e,t,n)=>{if(!g[A.cmd])return void s.warn("Could not find monitor block with opcode: ".concat(A.cmd));const i=g[A.cmd].opcode,r=i.indexOf("_"),o=i.substring(0,r);if("videoSensing"===o)return;if(-1===d.indexOf(o)&&""!==o&&!n.extensionIDs.has(o)&&!A.visible)return;let a=null;if(!A.hasOwnProperty("target"))for(let e=0;e<t.length;e++){const n=t[e];Object.keys(n.variables).filter(e=>{const t=n.variables[e];return t.type===Q.LIST_TYPE&&t.name===A.listName}).length>0&&(a=n,A.target=n.getName())}if(a=a||t.filter(e=>e.getName()===A.target)[0],!a)throw new Error("Cannot create monitor for target that cannot be found by name");const B=N(a.id,!1),[c,E]=S([A.cmd,A.param],null,B,n,{},null,null);"getVar:"===A.cmd?c.id=B(A.param,Q.SCALAR_TYPE):"contentsOfList:"===A.cmd?c.id=B(A.param,Q.LIST_TYPE):e.monitorBlockInfo.hasOwnProperty(c.opcode)?c.id=e.monitorBlockInfo[c.opcode].getId(a.id,c.fields):c.id=c.opcode,c.targetId=a.isStage?null:a.id,c.isMonitored=A.visible;const l=e.monitorBlocks._blocks[c.id];if(l)l.isMonitored=A.visible,l.targetId=c.targetId;else{const A=Y([c]);for(let t=0;t<A.length;t++)e.monitorBlocks.createBlock(A[t])}switch(A.mode){case 1:A.mode="default";break;case 2:A.mode="large";break;case 3:A.mode="slider"}e.requestAddMonitor(u({id:c.id,targetId:c.targetId,spriteName:c.targetId?A.target:null,opcode:c.opcode,params:e.monitorBlocks._getBlockParams(c),value:"",mode:A.mode,sliderMin:A.sliderMin,sliderMax:A.sliderMax,isDiscrete:A.isDiscrete,x:A.x,y:A.y,width:A.width,height:A.height,visible:A.visible}))},T=function(A,e,t,n){if(!A.hasOwnProperty("objName"))return null;const i={costumePromises:[],soundPromises:[],soundBank:e.audioEngine&&e.audioEngine.createBank(),children:[]},r=i.costumePromises;if(A.hasOwnProperty("costumes"))for(let i=0;i<A.costumes.length;i++){const o=A.costumes[i],s=o.bitmapResolution||1,a={name:o.costumeName,bitmapResolution:s,rotationCenterX:t?240*s:o.rotationCenterX,rotationCenterY:t?180*s:o.rotationCenterY,md5:o.baseLayerMD5,skinId:null},c=o.baseLayerMD5,g=B.splitFirst(c,"."),E=g[0];let Q;2===g.length&&g[1]?Q=g[1]:(Q="png",a.md5="".concat(a.md5,".").concat(Q)),a.dataFormat=Q,a.assetId=E,o.textLayerMD5&&(a.textLayerMD5=B.splitFirst(o.textLayerMD5,".")[0]);const u="".concat(o.baseLayerID,".").concat(Q),l=o.textLayerID?"".concat(o.textLayerID,".png"):null;r.push(I(a,e,n,u,l).then(()=>h(a.md5,a,e,2)))}const{soundBank:o,soundPromises:s}=i;if(A.hasOwnProperty("sounds"))for(let t=0;t<A.sounds.length;t++){const i=A.sounds[t],r={name:i.soundName,format:i.format,rate:i.rate,sampleCount:i.sampleCount,md5:i.md5,data:null},a=i.md5,c=B.splitFirst(a,"."),g=c[0],E=c[1].toLowerCase();r.dataFormat=E,r.assetId=g;const Q="".concat(i.soundID,".").concat(E);s.push(M(r,e,n,Q).then(()=>C(r,e,o)))}const a=i.children;if(A.children)for(let t=0;t<A.children.length;t++)a.push(T(A.children[t],e,!1,n));return i},x=function(A,e,t,o,s,a){if(!A.hasOwnProperty("objName"))return A.hasOwnProperty("listName")&&(A.cmd="contentsOfList:",A.param=A.listName,A.mode="list"),A.deferredMonitor=!0,Promise.resolve(A);const B=new n(e),g=new r(B,e);if(A.hasOwnProperty("objName")){if(o&&"Stage"!==A.objName){for(const e of A.children)e.hasOwnProperty("objName")||e.target!==A.objName||(e.target="Stage");A.objName="Stage"}g.name=A.objName}const u=a.costumePromises,{soundBank:h,soundPromises:C}=a,I=g.createClone(o?l.BACKGROUND_LAYER:l.SPRITE_LAYER),M=N(I.id,o),d=U(o),m=d.broadcastMsgMapUpdater;if(A.hasOwnProperty("variables"))for(let t=0;t<A.variables.length;t++){const n=A.variables[t],i=n.isPersistent&&o&&e.canAddCloudVariable(),r=new Q(M(n.name,Q.SCALAR_TYPE),n.name,Q.SCALAR_TYPE,i);i&&e.addCloudVariable(),r.value=n.value,I.variables[r.id]=r}const p={};if(A.hasOwnProperty("scriptComments")){A.scriptComments.map(A=>{const[e,t,n,i,r,o,s]=A,a=A[5]>=0,B=new E(null,s,a?null:1.5*e,a?null:2.2*t,1.5*n,2.2*i,!r);return a&&(B.blockId=o,p.hasOwnProperty(o)?p[o].push(B):p[o]=[B]),B}).forEach(A=>{I.comments[A.id]=A})}A.hasOwnProperty("scripts")&&function(A,e,t,n,i,r){let o=0;for(let s=0;s<A.length;s++){const a=A[s],B=a[0],c=a[1],g=a[2],E={},[Q,u]=f(g,t,n,i,E,r,o);o=u,Q[0]&&(Q[0].x=1.5*B,Q[0].y=2.2*c,Q[0].topLevel=!0,Q[0].parent=null);const l=Y(Q);for(let A=0;A<l.length;A++)e.createBlock(l[A])}}(A.scripts,B,m,M,t,p);for(const A in p){p[A].forEach(A=>{"number"==typeof A.blockId&&(A.blockId=null)})}if(B.updateTargetSpecificBlocks(o),A.hasOwnProperty("lists"))for(let e=0;e<A.lists.length;e++){const t=A.lists[e],n=new Q(M(t.listName,Q.LIST_TYPE),t.listName,Q.LIST_TYPE,!1);n.value=t.contents,I.variables[n.id]=n}A.hasOwnProperty("scratchX")&&(I.x=A.scratchX),A.hasOwnProperty("scratchY")&&(I.y=A.scratchY),A.hasOwnProperty("direction")&&(I.direction=A.direction),A.hasOwnProperty("isDraggable")&&(I.draggable=A.isDraggable),A.hasOwnProperty("scale")&&(I.size=100*A.scale),A.hasOwnProperty("visible")&&(I.visible=A.visible),A.hasOwnProperty("currentCostumeIndex")&&(I.currentCostume=c.clamp(Math.floor(A.currentCostumeIndex),0,A.costumes.length-1)),A.hasOwnProperty("rotationStyle")&&("none"===A.rotationStyle?I.rotationStyle=i.ROTATION_STYLE_NONE:"leftRight"===A.rotationStyle?I.rotationStyle=i.ROTATION_STYLE_LEFT_RIGHT:"upDown"===A.rotationStyle?I.rotationStyle=i.ROTATION_STYLE_UP_DOWN:"lookAt"===A.rotationStyle?I.rotationStyle=i.ROTATION_STYLE_LOOK_AT:"normal"===A.rotationStyle&&(I.rotationStyle=i.ROTATION_STYLE_ALL_AROUND)),A.hasOwnProperty("tempoBPM")&&(I.tempo=A.tempoBPM),A.hasOwnProperty("videoAlpha")&&(I.videoTransparency=100-100*A.videoAlpha),A.hasOwnProperty("info")&&A.info.hasOwnProperty("videoOn")&&(A.info.videoOn?I.videoState=i.VIDEO_STATE.ON:I.videoState=i.VIDEO_STATE.OFF),A.hasOwnProperty("indexInLibrary")&&(I.targetPaneOrder=A.indexInLibrary),I.isStage=o,Promise.all(u).then(A=>{g.costumes=A}),Promise.all(C).then(A=>{g.sounds=A,g.soundBank=h||null});const F=[];if(A.children)for(let n=0;n<A.children.length;n++)F.push(x(A.children[n],e,t,!1,s,a.children[n]));if(o){const e=A.info&&A.info.savedExtensions;if(Array.isArray(e))for(const A of e){const e=w.generateExtensionId(A.extensionName),n=A.javascriptURL;t.extensionURLs.set(e,n)}}return Promise.all(u.concat(C)).then(()=>Promise.all(F).then(A=>{if(I.isStage){const A=d.globalBroadcastMsgs,e=d.allBroadcastFields,t=d.emptyMsgName;if(A[t]){let n=1;for(;A["message".concat(n)];)n+=1;const i="message".concat(n);A[i]=A[t],delete A[t];for(let A=0;A<e.length;A++)""===e[A].value&&(e[A].value=i)}for(const e in A){const t=A[e],n=new Q(t,e,Q.BROADCAST_MESSAGE_TYPE,!1);I.variables[n.id]=n}}let n=[I];const i=[];for(let e=0;e<A.length;e++)A[e]&&(A[e].deferredMonitor?i.push(A[e]):n=n.concat(A[e]));for(let A=0;A<i.length;A++)y(i[A],e,n,t);return n}))},R=function(A){const e=A.map((A,e)=>(A.layerOrder=e,A)).sort((A,e)=>A.targetPaneOrder-e.targetPaneOrder);return e.forEach(A=>{delete A.targetPaneOrder}),e},G=function(A){const e=A[0],t=e&&g[e];return t?"function"==typeof t?t(A):t:e&&(A=>m.test(A))(e)?(A=>{const e=A[0],t=A.length-1,n=[];for(let A=0;A<t;A++)n.push({type:"input",inputOp:"text",inputName:w.argumentIndexToId(A)});return{opcode:p(e),argMap:n}})(A):(s.warn("Couldn't find SB2 block: ".concat(e)),null)},S=function(A,e,t,n,i,r,B){const c=r&&"number"==typeof B&&!isNaN(B)?r[B]:null,g=G(A);if(!g)return c&&c.forEach(A=>{A.blockId=null,A.x=A.y=0}),[null,B+1];const E=A[0],u=g.opcode.indexOf("_"),l=g.opcode.substring(0,u);-1===d.indexOf(l)&&""!==l&&n.extensionIDs.add(l);const w={id:a(),opcode:g.opcode,inputs:{},fields:{},next:null,shadow:!1,children:[]};c&&(w.comment=c[c.length-1].id,c.forEach(A=>{A.id===w.comment?A.blockId=w.id:(A.blockId=null,A.x=A.y=0)})),B++;const h=i.expectedArg;"call"===E&&(g.argMap=F(A[1]));for(let c=0;c<g.argMap.length;c++){const E=g.argMap[c],u=A[c+1];let l=!1;if("input"===E.type){const A=a();if(w.inputs[E.inputName]={name:E.inputName,block:null,shadow:null},"object"==typeof u&&u){let A;if(i.expectedArg=E,"object"==typeof u[0]&&u[0])[A,B]=f(u,e,t,n,i,r,B);else{const o=S(u,e,t,n,i,r,B);A=o[0]?[o[0]]:[],B=o[1]}if(i.expectedArg=h,A.length>0){let e=null;for(let t=0;t<A.length;t++)A[t].parent=0===t?w.id:e,e=A[t].id;w.inputs[E.inputName].block=A[0].id,w.children=w.children.concat(A)}l=!0}if(!E.inputOp){s.warn("Unknown input operation for input ".concat(E.inputName," of opcode ").concat(w.opcode,"."));continue}if("boolean"===E.inputOp||"substack"===E.inputOp)continue;let c=u,g=E.inputName;"math_number"===E.inputOp||"math_whole_number"===E.inputOp||"math_positive_number"===E.inputOp||"math_integer"===E.inputOp||"math_angle"===E.inputOp?(g="NUM",l&&(c=10)):"text"===E.inputOp?(g="TEXT",l&&(c="")):"colour_picker"===E.inputOp?(c=o.decimalToHex(u),g="COLOUR",l&&(c="#990000")):"event_broadcast_menu"===E.inputOp?(g="BROADCAST_OPTION",l&&(c="")):"sensing_of_object_menu"===E.inputOp?(l||"Stage"===c)&&(c="_stage_"):"note"===E.inputOp?l&&(c=60):"music.menu.DRUM"===E.inputOp||"music.menu.INSTRUMENT"===E.inputOp?l&&(c=1):"videoSensing.menu.ATTRIBUTE"===E.inputOp?l&&(c="motion"):"videoSensing.menu.SUBJECT"===E.inputOp?l&&(c="this sprite"):"videoSensing.menu.VIDEO_STATE"===E.inputOp?l&&(c="on"):l&&(c="");const Q={};if(Q[g]={name:g,value:c},"event_broadcast_menu"===E.inputOp){const A=e(c,Q[g]);Q[g].id=A,Q[g].variableType=E.variableType}w.children.push({id:A,opcode:E.inputOp,inputs:{},fields:Q,next:null,topLevel:!1,parent:w.id,shadow:!0}),w.inputs[E.inputName].shadow=A,w.inputs[E.inputName].block||(w.inputs[E.inputName].block=A)}else if("field"===E.type){if(w.fields[E.fieldName]={name:E.fieldName,value:u},"CURRENTMENU"===E.fieldName&&(w.fields[E.fieldName].value=u.toUpperCase(),"day of week"===u&&(w.fields[E.fieldName].value="DAYOFWEEK")),"VARIABLE"===E.fieldName)w.fields[E.fieldName].id=t(u,Q.SCALAR_TYPE);else if("LIST"===E.fieldName)w.fields[E.fieldName].id=t(u,Q.LIST_TYPE);else if("BROADCAST_OPTION"===E.fieldName){const A=e(u,w.fields[E.fieldName]);w.fields[E.fieldName].id=A}const A=E.variableType;"string"==typeof A&&(w.fields[E.fieldName].variableType=A)}}switch(E){case"comeToFront":w.fields.FRONT_BACK={name:"FRONT_BACK",value:"front"};break;case"goBackByLayers:":w.fields.FORWARD_BACKWARD={name:"FORWARD_BACKWARD",value:"backward"};break;case"backgroundIndex":w.fields.NUMBER_NAME={name:"NUMBER_NAME",value:"number"};break;case"sceneName":w.fields.NUMBER_NAME={name:"NUMBER_NAME",value:"name"};break;case"costumeIndex":w.fields.NUMBER_NAME={name:"NUMBER_NAME",value:"number"};break;case"costumeName":w.fields.NUMBER_NAME={name:"NUMBER_NAME",value:"name"}}if("stopScripts"===E)"other scripts in sprite"!==A[1]&&"other scripts in stage"!==A[1]||(w.mutation={tagName:"mutation",hasnext:"true",children:[]});else if("procDef"===E){const e=A.slice(1),t=a(),n="custom_block";w.inputs[n]={name:n,block:t,shadow:t},w.children=[{id:t,opcode:"procedures_prototype",inputs:{},fields:{},next:null,shadow:!0,children:[],mutation:{tagName:"mutation",proccode:e[0],argumentnames:JSON.stringify(e[1]),argumentids:JSON.stringify(D(e[0])),argumentdefaults:JSON.stringify(e[2]),warp:e[3],children:[]}}]}else if("call"===E)w.mutation={tagName:"mutation",children:[],proccode:A[1],argumentids:JSON.stringify(D(A[1]))};else if("getParam"===E){let e=A[2];switch(h&&"boolean"===h.inputOp&&"b"!==e&&(e="b"),e){case"r":w.opcode="argument_reporter_string_number";break;case"b":w.opcode="argument_reporter_boolean"}}return[w,B]};A.exports={deserialize:function(A,e,t,n){const i={extensionIDs:new Set,extensionURLs:new Map};return Promise.resolve(T(A,e,!t,n)).then(A=>Promise.resolve(A)).then(r=>x(A,e,i,!t,n,r)).then(R).then(A=>({targets:A,extensions:i}))}}},function(A,e){class t{constructor(){this.left=-1/0,this.right=1/0,this.bottom=-1/0,this.top=1/0}initFromBounds(A,e,t,n){this.left=A,this.right=e,this.bottom=t,this.top=n}initFromPointsAABB(A){this.left=1/0,this.right=-1/0,this.top=-1/0,this.bottom=1/0;for(let e=0;e<A.length;e++){const t=A[e][0],n=A[e][1];t<this.left&&(this.left=t),t>this.right&&(this.right=t),n>this.top&&(this.top=n),n<this.bottom&&(this.bottom=n)}}initFromModelMatrix(A){const e=A[12],t=A[13],n=Math.abs(.5*A[0])+Math.abs(.5*A[4]),i=Math.abs(.5*A[1])+Math.abs(.5*A[5]);this.left=-n+e,this.right=n+e,this.top=i+t,this.bottom=-i+t}intersects(A){return this.left<=A.right&&A.left<=this.right&&this.top>=A.bottom&&A.top>=this.bottom}contains(A){return A.left>this.left&&A.right<this.right&&A.top<this.top&&A.bottom>this.bottom}clamp(A,e,t,n){this.left=Math.max(this.left,A),this.right=Math.min(this.right,e),this.bottom=Math.max(this.bottom,t),this.top=Math.min(this.top,n),this.left=Math.min(this.left,e),this.right=Math.max(this.right,A),this.bottom=Math.min(this.bottom,n),this.top=Math.max(this.top,t)}snapToInt(){this.left=Math.floor(this.left),this.right=Math.ceil(this.right),this.bottom=Math.floor(this.bottom),this.top=Math.ceil(this.top)}static intersect(A,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new t;return n.left=Math.max(A.left,e.left),n.right=Math.min(A.right,e.right),n.top=Math.min(A.top,e.top),n.bottom=Math.max(A.bottom,e.bottom),n}static union(A,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new t;return n.left=Math.min(A.left,e.left),n.right=Math.max(A.right,e.right),n.top=Math.max(A.top,e.top),n.bottom=Math.min(A.bottom,e.bottom),n}get width(){return Math.abs(this.left-this.right)}get height(){return Math.abs(this.top-this.bottom)}}A.exports=t},function(A,e,t){const n=t(17),{rgbToHsv:i,hsvToRgb:r}=t(461),o=t(39),s=[0,0,0];A.exports=class{static transformColor(A,e,t){if(0===e[3])return e;let n=A.enabledEffects;"number"==typeof t&&(n&=t);const a=A.getUniforms(),B=0!=(n&o.EFFECT_INFO.color.mask),c=0!=(n&o.EFFECT_INFO.saturation.mask),g=0!=(n&o.EFFECT_INFO.brightness.mask),E=0!=(n&o.EFFECT_INFO.tintColor.mask);if(B||c||g||E){const A=e[3]/255;if(e[0]/=A,e[1]/=A,e[2]/=A,B){const A=i(e,s);A[0]=a.u_color+A[0]+1,r(A,e)}if(c){const A=i(e,s);A[1]=a.u_saturation*A[1],r(A,e)}if(g){const A=255*a.u_brightness;e[0]+=A,e[1]+=A,e[2]+=A}if(E){const A=(A=>{const e=A>>24&255;return{r:A>>16&255,g:A>>8&255,b:255&A,a:e>0?e:255}})(a.u_tintColor);e[0],A.r,e[1],A.g,e[2],A.b}e[0]*=A,e[1]*=A,e[2]*=A}return 0!=(n&o.EFFECT_INFO.ghost.mask)&&(e[0]*=a.u_ghost,e[1]*=a.u_ghost,e[2]*=a.u_ghost,e[3]*=a.u_ghost),e}static transformPoint(A,e,t){n.v3.copy(e,t);const i=A.enabledEffects,r=A.getUniforms();if(0!=(i&o.EFFECT_INFO.mosaic.mask)&&(t[0]=r.u_mosaic*t[0]%1,t[1]=r.u_mosaic*t[1]%1),0!=(i&o.EFFECT_INFO.pixelate.mask)){const e=A.skin.getUniforms(),n=e.u_skinSize[0]/r.u_pixelate,i=e.u_skinSize[1]/r.u_pixelate;t[0]=(Math.floor(t[0]*n)+.5)/n,t[1]=(Math.floor(t[1]*i)+.5)/i}if(0!=(i&o.EFFECT_INFO.whirl.mask)){const A=.5,e=t[0]-.5,n=t[1]-.5,i=Math.sqrt(Math.pow(e,2)+Math.pow(n,2)),o=Math.max(1-i/A,0),s=r.u_whirl*o*o,a=Math.sin(s),B=Math.cos(s),c=B,g=-a,E=a,Q=B;t[0]=c*e+E*n+.5,t[1]=g*e+Q*n+.5}if(0!=(i&o.EFFECT_INFO.fisheye.mask)){const A=(t[0]-.5)/.5,e=(t[1]-.5)/.5,n=Math.sqrt(A*A+e*e),i=Math.pow(Math.min(n,1),r.u_fisheye)*Math.max(1,n),o=A/n,s=e/n;t[0]=.5+i*o*.5,t[1]=.5+i*s*.5}return t}}},function(A,e,t){const n=t(53);n.enable(),A.exports=n("scratch-render")},function(A,e,t){const n=t(466),i=t(471);A.exports=class{constructor(A){this._measurementProvider=A,this._cache={}}wrapText(A,e){e=e.normalize();const t="".concat(A,"-").concat(e);if(this._cache[t])return this._cache[t];const r=this._measurementProvider.beginMeasurementSession(),o=new n(e);let s,a=0,B=null;const c=[];for(;s=o.nextBreak();){const t=e.slice(a,s.position).replace(/\n+$/,"");let n=(B||"").concat(t),r=this._measurementProvider.measureText(n);if(r>A){if(this._measurementProvider.measureText(t)>A){let e,o=0;for(;o!==(e=i.nextBreak(t,o));){const i=t.substring(o,e);n=(B||"").concat(i),r=this._measurementProvider.measureText(n),null===B||r<=A?B=n:(c.push(B),B=i),o=e}}else null!==B&&c.push(B),B=t}else B=n;s.required&&(null!==B&&c.push(B),B=null),a=s.position}return B=B||"",(B.length>0||0===c.length)&&c.push(B),this._cache[t]=c,this._measurementProvider.endMeasurementSession(r),c}}},function(A,e,t){var n,i;i=t(467),n=function(){function A(A){var e,t,n;(e="function"==typeof A.readUInt32BE&&"function"==typeof A.slice)||A instanceof Uint8Array?(e?(this.highStart=A.readUInt32BE(0),this.errorValue=A.readUInt32BE(4),t=A.readUInt32BE(8),A=A.slice(12)):(n=new DataView(A.buffer),this.highStart=n.getUint32(0),this.errorValue=n.getUint32(4),t=n.getUint32(8),A=A.subarray(12)),A=i(A,new Uint8Array(t)),A=i(A,new Uint8Array(t)),this.data=new Uint32Array(A.buffer)):(this.data=A.data,this.highStart=A.highStart,this.errorValue=A.errorValue)}return 11,5,6,32,64,63,2,32,31,2048,32,2080,2080,32,2112,4,A.prototype.get=function(A){var e;return A<0||A>1114111?this.errorValue:A<55296||A>56319&&A<=65535?(e=(this.data[A>>5]<<2)+(31&A),this.data[e]):A<=65535?(e=(this.data[2048+(A-55296>>5)]<<2)+(31&A),this.data[e]):A<this.highStart?(e=this.data[2080+(A>>11)],e=((e=this.data[e+(A>>5&63)])<<2)+(31&A),this.data[e]):this.data[this.data.length-4]},A}(),A.exports=n},function(A,e,t){const n=t(74),i={ImageBitmap:{contentType:"image/png",name:"ImageBitmap",runtimeFormat:n.PNG,immutable:!0},ImageVector:{contentType:"image/svg+xml",name:"ImageVector",runtimeFormat:n.SVG,immutable:!0},Project:{contentType:"application/json",name:"Project",runtimeFormat:n.JSON,immutable:!1},Sound:{contentType:"audio/x-wav",name:"Sound",runtimeFormat:n.WAV,immutable:!0},Sprite:{contentType:"application/json",name:"Sprite",runtimeFormat:n.JSON,immutable:!0},Font:{contentType:"font/ttf",name:"Font",runtimeFormat:n.TTF,immutable:!0},TextBubble:{contentType:"application/json",name:"TextBubbleProperties",runtimeFormat:n.JSON,immutable:!0},ExternalFile:{contentType:"text/plain",name:"ExternalFile",runtimeFormat:n.TXT,immutable:!1}};A.exports=i},function(A,e){A.exports=class{constructor(A){this.parent=A}load(A,e,t){return Promise.reject(new Error("No asset of type ".concat(A," for ID ").concat(e," with format ").concat(t)))}}},function(A,e,t){const n=t(76);A.exports=class extends n{get DEFAULT_VALUE(){return 100}get name(){return"volume"}initialize(){this.inputNode=this.audioEngine.audioContext.createGain(),this.outputNode=this.inputNode,this.initialized=!0}_set(A,e){this.value=A;const{gain:t}=this.outputNode,{currentTime:n,DECAY_DURATION:i}=this.audioEngine;"number"!=typeof e?t.linearRampToValueAtTime(A/100,n+i):t.linearRampToValueAtTime(A/100,n+(i+e))}dispose(){this.initialized&&(this.outputNode.disconnect(),this.inputNode=null,this.outputNode=null,this.target=null,this.initialized=!1)}}},function(A,e,t){const n=t(474);A.exports=n},function(A,e,t){"use strict";var n,i=function(){return void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n},r=function(){var A={};return function(e){if(void 0===A[e]){var t=document.querySelector(e);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(A){t=null}A[e]=t}return A[e]}}(),o=[];function s(A){for(var e=-1,t=0;t<o.length;t++)if(o[t].identifier===A){e=t;break}return e}function a(A,e){for(var t={},n=[],i=0;i<A.length;i++){var r=A[i],a=e.base?r[0]+e.base:r[0],B=t[a]||0,c="".concat(a," ").concat(B);t[a]=B+1;var g=s(c),E={css:r[1],media:r[2],sourceMap:r[3]};-1!==g?(o[g].references++,o[g].updater(E)):o.push({identifier:c,updater:w(E,e),references:1}),n.push(c)}return n}function B(A){var e=document.createElement("style"),n=A.attributes||{};if(void 0===n.nonce){var i=t.nc;i&&(n.nonce=i)}if(Object.keys(n).forEach((function(A){e.setAttribute(A,n[A])})),"function"==typeof A.insert)A.insert(e);else{var o=r(A.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(e)}return e}var c,g=(c=[],function(A,e){return c[A]=e,c.filter(Boolean).join("\n")});function E(A,e,t,n){var i=t?"":n.media?"@media ".concat(n.media," {").concat(n.css,"}"):n.css;if(A.styleSheet)A.styleSheet.cssText=g(e,i);else{var r=document.createTextNode(i),o=A.childNodes;o[e]&&A.removeChild(o[e]),o.length?A.insertBefore(r,o[e]):A.appendChild(r)}}function Q(A,e,t){var n=t.css,i=t.media,r=t.sourceMap;if(i?A.setAttribute("media",i):A.removeAttribute("media"),r&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),A.styleSheet)A.styleSheet.cssText=n;else{for(;A.firstChild;)A.removeChild(A.firstChild);A.appendChild(document.createTextNode(n))}}var u=null,l=0;function w(A,e){var t,n,i;if(e.singleton){var r=l++;t=u||(u=B(e)),n=E.bind(null,t,r,!1),i=E.bind(null,t,r,!0)}else t=B(e),n=Q.bind(null,t,e),i=function(){!function(A){if(null===A.parentNode)return!1;A.parentNode.removeChild(A)}(t)};return n(A),function(e){if(e){if(e.css===A.css&&e.media===A.media&&e.sourceMap===A.sourceMap)return;n(A=e)}else i()}}A.exports=function(A,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=i());var t=a(A=A||[],e);return function(A){if(A=A||[],"[object Array]"===Object.prototype.toString.call(A)){for(var n=0;n<t.length;n++){var i=s(t[n]);o[i].references--}for(var r=a(A,e),B=0;B<t.length;B++){var c=s(t[B]);0===o[c].references&&(o[c].updater(),o.splice(c,1))}t=r}}}},function(A,e,t){"use strict";A.exports=function(A){var e=[];return e.toString=function(){return this.map((function(e){var t=A(e);return e[2]?"@media ".concat(e[2]," {").concat(t,"}"):t})).join("")},e.i=function(A,t,n){"string"==typeof A&&(A=[[null,A,""]]);var i={};if(n)for(var r=0;r<this.length;r++){var o=this[r][0];null!=o&&(i[o]=!0)}for(var s=0;s<A.length;s++){var a=[].concat(A[s]);n&&i[a[0]]||(t&&(a[2]?a[2]="".concat(t," and ").concat(a[2]):a[2]=t),e.push(a))}},e}},function(A,e,t){"use strict";A.exports=function(A,e){return e||(e={}),"string"!=typeof(A=A&&A.__esModule?A.default:A)?A:(/^['"].*['"]$/.test(A)&&(A=A.slice(1,-1)),e.hash&&(A+=e.hash),/["'() \t\n]/.test(A)||e.needQuotes?'"'.concat(A.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):A)}},function(A,e,t){"use strict";e.a="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTIwLjc3NCA1LjcyOGExLjMxIDEuMzEgMCAwIDAtMS44NTcgMGwtOS43NDMgOS43NTYtNC4wOTQtNC4xMDZBMS4zMzYgMS4zMzYgMCAxIDAgMy4yMjMgMTMuM2w1LjAyMiA1LjAyMmExLjMxIDEuMzEgMCAwIDAgMS44NTcgMEwyMC43NzQgNy42NWExLjMxIDEuMzEgMCAwIDAgMC0xLjkyMiIgZmlsbD0iI2ZmZiIvPjwvc3ZnPg=="},function(A){A.exports=JSON.parse('{"var-x":"x position","var-y":"y position","var-direction":"direction","var-username":"username","var-costume-number":"costume number","var-costume-name":"costume name","var-backdrop-number":"backdrop number","var-backdrop-name":"backdrop name","var-size":"size","var-answer":"answer","var-mousedown":"mouse down?","var-mouseclicked":"mouse clicked?","var-mousex":"mouse x","var-mousey":"mouse y","var-getclipboard":"clipboard item","var-getdragmode":"draggable?","var-loudness":"loudness","var-loud":"loud?","var-timer":"timer","var-dayssince2000":"days since 2000","var-loggedin":"logged in?","var-volume":"volume","var-year":"year","var-month":"month","var-date":"date","var-day-of-week":"day of week","var-hour":"hour","var-minute":"minute","var-second":"second","var-get_counter":"counter","var-stretch-x":"stretch x","var-stretch-y":"stretch y","var-say-width":"bubble width","var-say-height":"bubble height","var-effect":"effect","var-color-effect":"color effect","var-fisheye-effect":"fisheye effect","var-whirl-effect":"whirl effect","var-pixelate-effect":"pixelate effect","var-mosaic-effect":"mosaic effect","var-brightness-effect":"brightness effect","var-ghost-effect":"ghost effect","var-saturation-effect":"saturation effect","var-red-effect":"red effect","var-green-effect":"green effect","var-blue-effect":"blue effect","var-opaque-effect":"opaque effect","var-tint-color":"tint color","var-visible":"visible?","var-layer":"layer","var-sound-effect":"effect","var-pitch-sound-effect":"pitch effect","var-pan-sound-effect":"pan left/right effect","list-empty":"(empty)","list-length":"length {n}","list-import":"import","list-export":"export"}')},function(A,e,t){function n(A,e){var t=Object.keys(A);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(A);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(A,e).enumerable}))),t.push.apply(t,n)}return t}function i(A){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?n(Object(t),!0).forEach((function(e){r(A,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(t)):n(Object(t)).forEach((function(e){Object.defineProperty(A,e,Object.getOwnPropertyDescriptor(t,e))}))}return A}function r(A,e,t){return(e=function(A){var e=function(A,e){if("object"!=typeof A||!A)return A;var t=A[Symbol.toPrimitive];if(void 0!==t){var n=t.call(A,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(A)}(A,"string");return"symbol"==typeof e?e:e+""}(e))in A?Object.defineProperty(A,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):A[e]=t,A}let o;o="undefined"==typeof TextEncoder?t(30).TextEncoder:TextEncoder;const s=t(27),a=t(33),B=t(20).Buffer,c=t(82),g=t(142),E=t(5),Q=t(6),u=t(91),l=t(10),w=t(68),h=t(16),C=t(71),I=t(22),M=t(47),d=t(4),m=t(62),p=t(19),F=t(109),{loadCostume:D}=t(49),{loadSound:Y}=t(48),{serializeSounds:f,serializeCostumes:N}=t(437);t(438);const{exportCostume:U}=t(108),y=t(23),T=["_mouse_","_stage_","_edge_","_myself_","_random_"],x="https://library.penguinmod.com/",R=t(58),G=t(60),S=t(43),{SyntheticModule:H}=t(439),b=[];d.setup({missingTranslation:"ignore"});A.exports=class extends s{constructor(){super(),r(this,"_projectZip",new a),this.runtime=new u,c.setService("runtime",(A=>{const e={};return e._refreshExtensionPrimitives=A._refreshExtensionPrimitives.bind(A),e._registerExtensionPrimitives=A._registerExtensionPrimitives.bind(A),e._removeExtensionPrimitive=A._removeExtensionPrimitive.bind(A),e})(this.runtime)).catch(A=>{E.error("Failed to register runtime service: ".concat(JSON.stringify(A)))}),this.editingTarget=null,this._dragTarget=null,this.runtime.on(u.SCRIPT_GLOW_ON,A=>{this.emit(u.SCRIPT_GLOW_ON,A)}),this.runtime.on(u.SCRIPT_GLOW_OFF,A=>{this.emit(u.SCRIPT_GLOW_OFF,A)}),this.runtime.on(u.BLOCK_GLOW_ON,A=>{this.emit(u.BLOCK_GLOW_ON,A)}),this.runtime.on(u.BLOCK_GLOW_OFF,A=>{this.emit(u.BLOCK_GLOW_OFF,A)}),this.runtime.on(u.PROJECT_START,()=>{this.emit(u.PROJECT_START)}),this.runtime.on(u.PROJECT_RUN_START,()=>{this.emit(u.PROJECT_RUN_START)}),this.runtime.on(u.PROJECT_RUN_STOP,()=>{this.emit(u.PROJECT_RUN_STOP)}),this.runtime.on(u.PROJECT_CHANGED,()=>{this.emit(u.PROJECT_CHANGED)}),this.runtime.on(u.VISUAL_REPORT,A=>{this.emit(u.VISUAL_REPORT,A)}),this.runtime.on(u.BLOCK_STACK_ERROR,A=>{this.emit(u.BLOCK_STACK_ERROR,A)}),this.runtime.on(u.TARGETS_UPDATE,A=>{this.emitTargetsUpdate(A)}),this.runtime.on(u.MONITORS_UPDATE,A=>{this.emit(u.MONITORS_UPDATE,A)}),this.runtime.on(u.BLOCK_DRAG_UPDATE,A=>{this.emit(u.BLOCK_DRAG_UPDATE,A)}),this.runtime.on(u.BLOCK_DRAG_END,(A,e)=>{this.emit(u.BLOCK_DRAG_END,A,e)}),this.runtime.on(u.EXTENSION_ADDED,A=>{this.emit(u.EXTENSION_ADDED,A)}),this.runtime.on(u.EXTENSION_REMOVED,()=>{this.emit(u.EXTENSION_REMOVED)}),this.runtime.on(u.EXTENSION_FIELD_ADDED,(A,e)=>{this.emit(u.EXTENSION_FIELD_ADDED,A,e)}),this.runtime.on(u.BLOCKSINFO_UPDATE,A=>{this.emit(u.BLOCKSINFO_UPDATE,A)}),this.runtime.on(u.BLOCKS_NEED_UPDATE,()=>{this.emitWorkspaceUpdate()}),this.runtime.on(u.TOOLBOX_EXTENSIONS_NEED_UPDATE,()=>{this.extensionManager.refreshBlocks()}),this.runtime.on(u.PERIPHERAL_LIST_UPDATE,A=>{this.emit(u.PERIPHERAL_LIST_UPDATE,A)}),this.runtime.on(u.USER_PICKED_PERIPHERAL,A=>{this.emit(u.USER_PICKED_PERIPHERAL,A)}),this.runtime.on(u.PERIPHERAL_CONNECTED,()=>this.emit(u.PERIPHERAL_CONNECTED)),this.runtime.on(u.PERIPHERAL_REQUEST_ERROR,()=>this.emit(u.PERIPHERAL_REQUEST_ERROR)),this.runtime.on(u.PERIPHERAL_DISCONNECTED,()=>this.emit(u.PERIPHERAL_DISCONNECTED)),this.runtime.on(u.PERIPHERAL_CONNECTION_LOST_ERROR,A=>this.emit(u.PERIPHERAL_CONNECTION_LOST_ERROR,A)),this.runtime.on(u.PERIPHERAL_SCAN_TIMEOUT,()=>this.emit(u.PERIPHERAL_SCAN_TIMEOUT)),this.runtime.on(u.MIC_LISTENING,A=>{this.emit(u.MIC_LISTENING,A)}),this.runtime.on(u.RUNTIME_STARTED,()=>{this.emit(u.RUNTIME_STARTED)}),this.runtime.on(u.RUNTIME_PAUSED,()=>{this.emit(u.RUNTIME_PAUSED)}),this.runtime.on(u.RUNTIME_UNPAUSED,()=>{this.emit(u.RUNTIME_UNPAUSED)}),this.runtime.on(u.RUNTIME_STOPPED,()=>{this.emit(u.RUNTIME_STOPPED)}),this.runtime.on(u.HAS_CLOUD_DATA_UPDATE,A=>{this.emit(u.HAS_CLOUD_DATA_UPDATE,A)}),this.runtime.on(u.RUNTIME_OPTIONS_CHANGED,A=>{this.emit(u.RUNTIME_OPTIONS_CHANGED,A)}),this.runtime.on(u.COMPILER_OPTIONS_CHANGED,A=>{this.emit(u.COMPILER_OPTIONS_CHANGED,A)}),this.runtime.on(u.FRAMERATE_CHANGED,A=>{this.emit(u.FRAMERATE_CHANGED,A)}),this.runtime.on(u.INTERPOLATION_CHANGED,A=>{this.emit(u.INTERPOLATION_CHANGED,A)}),this.runtime.on(u.BEFORE_INTERPOLATE,A=>{this.emit(u.BEFORE_INTERPOLATE,A)}),this.runtime.on(u.AFTER_INTERPOLATE,A=>{this.emit(u.AFTER_INTERPOLATE,A)}),this.runtime.on(u.STAGE_SIZE_CHANGED,(A,e)=>{this.emit(u.STAGE_SIZE_CHANGED,A,e)}),this.runtime.on(u.COMPILE_ERROR,(A,e)=>{this.emit(u.COMPILE_ERROR,A,e)}),this.runtime.on(u.TURBO_MODE_OFF,()=>{this.emit(u.TURBO_MODE_OFF)}),this.runtime.on(u.TURBO_MODE_ON,()=>{this.emit(u.TURBO_MODE_ON)}),this.extensionManager=new g(this),this.securityManager=this.extensionManager.securityManager,this.runtime.extensionManager=this.extensionManager,this.runtime.vm=this;for(const A of b)this.extensionManager.loadExtensionIdSync(A);this.blockListener=this.blockListener.bind(this),this.flyoutBlockListener=this.flyoutBlockListener.bind(this),this.monitorBlockListener=this.monitorBlockListener.bind(this),this.variableListener=this.variableListener.bind(this),this.addListener("workspaceUpdate",()=>{this.extensionManager.refreshDynamicCategorys()}),this.exports={Sprite:C,RenderedTarget:w,JSZip:a,JSGenerator:G,IRGenerator:R,jsexecute:S,loadCostume:D,loadSound:Y,Blocks:I,Comment:M,StageLayering:h,Variable:p,Thread:t(36),execute:t(61),centralDispatch:c},this.exports.i_will_not_ask_for_help_when_these_break=()=>(console.info("Note on i_will_not_ask_for_help_when_these_break: this function is only included for compatibility with TurboWarp, and you should avoid using it when possible.\nAll indexes are able to be accessed from the regular vm.exports property. Below is a map of all elements here to their vm.exports counterpart:\nIRGenerator -> IRGenerator\nJSGenerator -> JSGenerator\nThread -> Thread\nexecute -> execute\nScriptTreeGenerator -> IRGenerator.exports.ScriptTreeGenerator"),{IRGenerator:R,JSGenerator:G,ScriptTreeGenerator:R.exports.ScriptTreeGenerator,Thread:this.exports.Thread,execute:this.exports.execute})}start(){this.runtime.start()}stop(){this.runtime.stop()}greenFlag(){this.runtime.greenFlag()}setTurboMode(A){this.runtime.turboMode=!!A,this.runtime.turboMode?this.emit(u.TURBO_MODE_ON):this.emit(u.TURBO_MODE_OFF)}setCompatibilityMode(A){this.runtime.setCompatibilityMode(!!A)}setFramerate(A){this.runtime.setFramerate(A)}setInterpolation(A){this.runtime.setInterpolation(A)}setRuntimeOptions(A){this.runtime.setRuntimeOptions(A)}setCompilerOptions(A){this.runtime.setCompilerOptions(A)}setStageSize(A,e){this.runtime.setStageSize(A,e)}setInEditor(A){this.runtime.setInEditor(A)}convertToPackagedRuntime(){this.runtime.convertToPackagedRuntime()}addAddonBlock(A){this.runtime.addAddonBlock(A)}getAddonBlock(A){return this.runtime.getAddonBlock(A)}storeProjectOptions(){this.runtime.storeProjectOptions(),this.editingTarget.isStage&&this.emitWorkspaceUpdate()}enableDebug(){return this.runtime.enableDebug(),"enabled debug mode"}stopAll(){this.runtime.stopAll()}clear(){this.runtime.dispose(),this.editingTarget=null,this.emitTargetsUpdate(!1)}getPlaygroundData(){const A=this,e=this.runtime.threads.filter(e=>e.target===A.editingTarget),t=JSON.stringify(e,(A,e)=>{if("target"!==A&&"blockContainer"!==A)return e},2);this.emit("playgroundData",{blocks:this.editingTarget.blocks,threads:t})}postIOData(A,e){this.runtime.ioDevices[A]&&this.runtime.ioDevices[A].postData(e)}setVideoProvider(A){this.runtime.ioDevices.video.setProvider(A)}setCloudProvider(A){this.runtime.ioDevices.cloud.setProvider(A)}scanForPeripheral(A){this.runtime.scanForPeripheral(A)}connectPeripheral(A,e){this.runtime.connectPeripheral(A,e)}disconnectPeripheral(A){this.runtime.disconnectPeripheral(A)}getPeripheralIsConnected(A){return this.runtime.getPeripheralIsConnected(A)}isSB2(A){return Array.isArray(A.children)&&!Array.isArray(A.targets)}loadProject(A){return new Promise(async(e,n)=>{try{const i=[...new Uint8Array(A).slice(0,7)].map(A=>String.fromCharCode(A)).join("");if("Scratch"===i){const{SB1File:n}=t(498),i=new n(A),r=i.json;return r.projectVersion=2,e([r,i.zip])}if("string"==typeof A&&(A=JSON.parse(A)),"[object Object]"===A.toString())return A.projectVersion=this.isSB2(A)?2:3,e([A,null]);if("PK"!==i.slice(0,2)){const t=new TextDecoder("UTF-8");if("string"==typeof(A=t.decode(A))&&(A=JSON.parse(A)),"[object Object]"===A.toString())return A.projectVersion=this.isSB2(A)?2:3,e([A,null])}const r=await a.loadAsync(A),o=r.file("project.json");if(!o)return n("No project.json file inside the given project");const s=JSON.parse(await o.async("string"));return s.projectVersion=this.isSB2(s)?2:3,this._projectZip=r,e([s,r])}catch(A){n(A.toString())}}).then(A=>this.deserializeProject(A[0],A[1])).then(()=>this.runtime.emitProjectLoaded()).catch(A=>(console.error(A),A.hasOwnProperty("validationError")?Promise.reject(JSON.stringify(A,null,4)):Promise.reject(A)))}downloadProjectId(A){const e=this.runtime.storage;if(!e)return void E.error("No storage module present; cannot load project: ",A);const t=this;e.load(e.AssetType.Project,A).then(e=>e?t.loadProject(e.data):(E.error("Failed to fetch project with id: ".concat(A)),null))}_saveProjectZip(){const A=this.toJSON(),e=new a;if(e.file("project.json",A),this._addFileDescsToZip(this.serializeAssets(),e),this._projectZip)try{e.files=i(i({},e.files),Object.fromEntries(Object.entries(this._projectZip.files).filter(A=>A[0].startsWith("extraAssets/"))))}catch(A){console.warn("unable to get extra assets",A)}const t=new Date(1591657163e3);for(const A of Object.values(e.files))A.date=t;const n=[".json",".svg",".wav",".ttf",".otf"];for(const A of Object.values(e.files))n.some(e=>A.name.endsWith(e))?A.options.compression="DEFLATE":A.options.compression="STORE";return e}saveProjectSb3(A){return this._saveProjectZip().generateAsync({type:A||"blob",mimeType:"application/x.scratch.sb3",compression:"DEFLATE"})}saveProjectSb3Stream(A){return this._saveProjectZip().generateInternalStream({type:A||"arraybuffer",mimeType:"application/x.scratch.sb3",compression:"DEFLATE"})}saveProjectSb3DontZip(){const A=this.toJSON(),e={"project.json":(new o).encode(A)};for(const A of this.serializeAssets())e[A.fileName]=A.fileContent;return e}get assets(){return[...this.runtime.targets.reduce((A,e)=>A.concat(e.sprite.sounds.map(A=>A.asset)).concat(e.sprite.costumes.map(A=>A.asset)),[]),...this.runtime.fontManager.serializeAssets()]}serializeAssets(A){return[...N(this.runtime,A),...f(this.runtime,A),...this.runtime.fontManager.serializeAssets().map(A=>({fileName:"".concat(A.assetId,".").concat(A.dataFormat),fileContent:A.data}))]}_addFileDescsToZip(A,e){for(let t=0;t<A.length;t++){const n=A[t];e.file(n.fileName,n.fileContent)}}exportSprite(A,e){const t=this.toJSON(A),n=new a;return n.file("sprite.json",t),this._addFileDescsToZip(this.serializeAssets(A),n),n.generateAsync({type:"string"==typeof e?e:"blob",mimeType:"application/x.scratch.sprite3",compression:"DEFLATE",compressionOptions:{level:6}})}toJSON(A,e){const n=t(38);return l.stringify(n.serialize(this.runtime,A,e))}fromJSON(A){return E.warning("fromJSON is now just a wrapper around loadProject, please use that function instead."),this.loadProject(A)}deserializeProject(A,e){this.clear(),"undefined"!=typeof performance&&performance.mark("scratch-vm-deserialize-start");const n=this.runtime;return function(){const i=A.projectVersion;if(2===i){return t(111).deserialize(A,n,!1,e)}if(3===i){return t(38).deserialize(A,n,e,!1,this)}return Promise.reject("Unable to verify Scratch Project version.")}().then(A=>{let{targets:e,extensions:t}=A;if("undefined"!=typeof performance){performance.mark("scratch-vm-deserialize-end");try{performance.measure("scratch-vm-deserialize","scratch-vm-deserialize-start","scratch-vm-deserialize-end")}catch(A){E.error(A)}}return this.installTargets(e,t,!0)})}async _loadExtensions(A){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map;const t=[];for(const n of A){const A=e.get(n);if(this.extensionManager.isExtensionLoaded(n));else if(A){if(!await this.securityManager.canLoadExtensionFromProject(A))throw new Error("Permission to load extension denied: ".concat(n));t.push(this.extensionManager.loadExtensionURL(A))}else{if(!this.extensionManager.isBuiltinExtension(n))throw new Error("Unknown extension: ".concat(n));this.extensionManager.loadExtensionIdSync(n)}}return Promise.all(t)}async installTargets(A,e,t){return await this.extensionManager.allAsyncExtensionsLoaded(),A=A.filter(A=>!!A),this._loadExtensions(e.extensionIDs,e.extensionURLs).then(()=>{const n={};for(const A of e.extensionIDs)e.extensionData[A]&&("ext_".concat(A)in this.runtime&&"function"==typeof this.runtime["ext_".concat(A)].deserialize?this.runtime["ext_".concat(A)].deserialize(e.extensionData[A]):n[A]=e.extensionData[A]);n&&(this.runtime.extensionStorage=m(n)),A.forEach(A=>{if(this.runtime.addTarget(A),A.updateAllDrawableProperties(),A.isSprite()&&this.renameSprite(A.id,A.getName()),!("extensionData"in A))return;const t={};for(const n of e.extensionIDs)n in A.extensionData&&("ext_".concat(n)in this.runtime&&"function"==typeof this.runtime["ext_".concat(n)].deserializeForTarget?this.runtime["ext_".concat(n)].deserializeForTarget(A.extensionData[n],A):t[n]=A.extensionData[n]);n&&(A.extensionStorage=m(t)),delete A.extensionData}),this.runtime.executableTargets.sort((A,e)=>A.layerOrder-e.layerOrder),A.forEach(A=>{delete A.layerOrder}),t&&A.length>1?this.editingTarget=A[1]:this.editingTarget=A[0],t||this.editingTarget.fixUpVariableReferences(),t&&this.runtime.parseProjectOptions(),this.emitTargetsUpdate(!1),this.emitWorkspaceUpdate(),this.runtime.setEditingTarget(this.editingTarget),this.runtime.ioDevices.cloud.setStage(this.runtime.getTargetForStage())})}addSprite(A){"object"!=typeof A||A instanceof ArrayBuffer||ArrayBuffer.isView(A)||(A=JSON.stringify(A));return new Promise((e,n)=>{t(445)(A,!0,(A,t)=>{if(A)return n(A);e(t)})}).then(A=>{const e=A[0].projectVersion;return 2===e?this._addSprite2(A[0],A[1]):3===e?this._addSprite3(A[0],A[1]):Promise.reject("".concat("Sprite Upload Error:"," Unable to verify sprite version."))}).then(()=>this.runtime.emitProjectChanged()).catch(A=>A.hasOwnProperty("validationError")?Promise.reject(JSON.stringify(A)):Promise.reject("".concat("Sprite Upload Error:"," ").concat(A)))}_addSprite2(A,e){return t(111).deserialize(A,this.runtime,!0,e).then(A=>{let{targets:e,extensions:t}=A;return this.installTargets(e,t,!1)})}_addSprite3(A,e){return t(38).deserialize(A,this.runtime,e,!0).then(A=>{let{targets:e,extensions:t}=A;return this.installTargets(e,t,!1)})}addCostume(A,e,t,n){const i=t?this.runtime.getTargetById(t):this.editingTarget;return i?!0===e.fromPenguinModLibrary?new Promise((A,t)=>{fetch("".concat(x,"files/").concat(e.libraryId)).then(A=>A.arrayBuffer()).then(t=>{const r=e.dataFormat,o=this.runtime.storage,s=new o.Asset(o.AssetType["svg"===r?"ImageVector":"ImageBitmap"],null,o.DataFormat[r.toUpperCase()],new Uint8Array(t),!0),a={md5:s.assetId+"."+s.dataFormat,asset:s,name:e.name};D(a.md5,a,this.runtime,n).then(e=>{i.addCostume(a),i.setCostume(i.getCostumes().length-1),this.runtime.emitProjectChanged(),A(e,a)})}).catch(t)}):D(A,e,this.runtime,n).then(A=>{i.addCostume(A),i.setCostume(i.getCostumes().length-1),this.runtime.emitProjectChanged()}):Promise.reject()}addCostumeFromLibrary(A,e){return this.editingTarget?this.addCostume(A,e,this.editingTarget.id,2):Promise.reject()}duplicateCostume(A){const e=this.editingTarget.getCostumes()[A],t=Object.assign({},e),n="".concat(t.assetId,".").concat(t.dataFormat);return D(n,t,this.runtime).then(()=>{this.editingTarget.addCostume(t,A+1),this.editingTarget.setCostume(A+1),this.emitTargetsUpdate()})}duplicateSound(A){const e=this.editingTarget.getSounds()[A],t=Object.assign({},e);return Y(t,this.runtime,this.editingTarget.sprite.soundBank).then(()=>{this.editingTarget.addSound(t,A+1),this.emitTargetsUpdate()})}renameCostume(A,e){this.editingTarget.renameCostume(A,e),this.emitTargetsUpdate()}deleteCostume(A){const e=this.editingTarget.deleteCostume(A);if(e){const A=this.editingTarget;return this.runtime.emitProjectChanged(),()=>{A.addCostume(e),this.emitTargetsUpdate()}}return null}pause(){this.runtime.pause()}play(){this.runtime.play()}addSound(A,e){const t=e?this.runtime.getTargetById(e):this.editingTarget;return t?!0===A.fromPenguinModLibrary?new Promise((e,n)=>{fetch("".concat(x,"files/").concat(A.libraryId)).then(A=>A.arrayBuffer()).then(n=>{const i=this.runtime.storage,r=new i.Asset(i.AssetType.Sound,null,i.DataFormat.MP3,new Uint8Array(n),!0),o={md5:r.assetId+"."+r.dataFormat,asset:r,name:A.name};Y(o,this.runtime,t.sprite.soundBank).then(A=>{t.addSound(o),this.emitTargetsUpdate(),e(A,o)})}).catch(n)}):Y(A,this.runtime,t.sprite.soundBank).then(()=>{t.addSound(A),this.emitTargetsUpdate()}):Promise.reject(new Error("No target with ID: ".concat(e)))}renameSound(A,e){this.editingTarget.renameSound(A,e),this.emitTargetsUpdate()}getSoundBuffer(A){var e;const t=null===(e=this.editingTarget.sprite.sounds[A])||void 0===e?void 0:e.soundId;return t&&this.runtime&&this.runtime.audioEngine?this.editingTarget.sprite.soundBank.getSoundPlayer(t).buffer:null}updateSoundBuffer(A,e,t){const n=this.editingTarget.sprite.sounds[A];n&&n.broken&&delete n.broken;const i=n?n.soundId:null;if(i&&this.runtime&&this.runtime.audioEngine&&(this.editingTarget.sprite.soundBank.getSoundPlayer(i).buffer=e),t){n.format="";const A=this.runtime.storage;n.asset=A.createAsset(A.AssetType.Sound,A.DataFormat.WAV,t,null,!0),n.assetId=n.asset.assetId,n.dataFormat=A.DataFormat.WAV,n.md5="".concat(n.assetId,".").concat(n.dataFormat),n.sampleCount=e.length,n.rate=e.sampleRate}this.emitTargetsUpdate()}deleteSound(A){const e=this.editingTarget,t=this.editingTarget.deleteSound(A);if(t){this.runtime.emitProjectChanged();return()=>{e.addSound(t),this.emitTargetsUpdate()}}return null}getCostume(A){const e=this.editingTarget.getCostumes()[A].asset;if(!e||!this.runtime||!this.runtime.storage)return null;const t=e.dataFormat;return t===this.runtime.storage.DataFormat.SVG?e.decodeText():t===this.runtime.storage.DataFormat.PNG||t===this.runtime.storage.DataFormat.JPG?e.encodeDataURI():(E.error("Unhandled format: ".concat(e.dataFormat)),null)}getExportedCostume(A,e){return U(A,e)}getExportedCostumeBase64(A,e){const t=this.getExportedCostume(A,e);return y.uint8ArrayToBase64(t)}updateBitmap(A,e,t,n,i){return this._updateBitmap(this.editingTarget.getCostumes()[A],e,t,n,i)}_updateBitmap(A,e,t,n,i){if(!(A&&this.runtime&&this.runtime.renderer))return;A&&A.broken&&delete A.broken,A.rotationCenterX=t,A.rotationCenterY=n;const r=0===e.sourceWidth?0:e.width,o=0===e.sourceHeight?0:e.height,s=document.createElement("canvas");s.width=r,s.height=o;s.getContext("2d").putImageData(e,0,0),this.runtime.renderer.updateBitmapSkin(A.skinId,s,i,[t/i,n/i]),s.toBlob(e=>{const t=new FileReader;t.addEventListener("loadend",()=>{const e=this.runtime.storage;A.dataFormat=e.DataFormat.PNG,A.bitmapResolution=i,A.size=[r,o],A.asset=e.createAsset(e.AssetType.ImageBitmap,A.dataFormat,B.from(t.result),null,!0),A.assetId=A.asset.assetId,A.md5="".concat(A.assetId,".").concat(A.dataFormat),this.emitTargetsUpdate()}),e&&t.readAsArrayBuffer(e)})}updateSvg(A,e,t,n){return this._updateSvg(this.editingTarget.getCostumes()[A],e,t,n)}_updateSvg(A,e,t,n){A&&A.broken&&delete A.broken,A&&this.runtime&&this.runtime.renderer&&(A.rotationCenterX=t,A.rotationCenterY=n,this.runtime.renderer.updateSVGSkin(A.skinId,e,[t,n]),A.size=this.runtime.renderer.getSkinSize(A.skinId));const i=this.runtime.storage;A.dataFormat=i.DataFormat.SVG,A.bitmapResolution=1,A.asset=i.createAsset(i.AssetType.ImageVector,A.dataFormat,(new o).encode(e),null,!0),A.assetId=A.asset.assetId,A.md5="".concat(A.assetId,".").concat(A.dataFormat),this.emitTargetsUpdate()}addBackdrop(A,e){return!0===e.fromPenguinModLibrary?new Promise((A,t)=>{fetch("".concat(x,"files/").concat(e.libraryId)).then(A=>A.arrayBuffer()).then(t=>{const n=e.dataFormat,i=this.runtime.storage,r=new i.Asset(i.AssetType["svg"===n?"ImageVector":"ImageBitmap"],null,i.DataFormat[n.toUpperCase()],new Uint8Array(t),!0),o={md5:r.assetId+"."+r.dataFormat,asset:r,name:e.name};D(o.md5,o,this.runtime).then(e=>{const t=this.runtime.getTargetForStage();t.addCostume(o),t.setCostume(t.getCostumes().length-1),this.runtime.emitProjectChanged(),A(e,o)})}).catch(t)}):D(A,e,this.runtime).then(()=>{const A=this.runtime.getTargetForStage();A.addCostume(e),A.setCostume(A.getCostumes().length-1),this.runtime.emitProjectChanged()})}renameSprite(A,e){const t=this.runtime.getTargetById(A);if(!t)throw new Error("No target with the provided id.");{if(!t.isSprite())throw new Error("Cannot rename non-sprite targets.");const A=t.sprite;if(!A)throw new Error("No sprite associated with this target.");if(e&&-1===T.indexOf(e)){const n=this.runtime.targets.filter(A=>A.isSprite()&&A.id!==t.id).map(A=>A.sprite.name),i=A.name,r=l.unusedName(e,n);if(A.name=r,i===r)return;const o=this.runtime.targets;for(let A=0;A<o.length;A++){o[A].blocks.updateAssetName(i,e,"sprite")}r!==i&&this.emitTargetsUpdate()}}}deleteSprite(A){const e=this.runtime.getTargetById(A);if(e){const t=this.runtime.targets.map(A=>A.id).indexOf(e.id);if(!e.isSprite())throw new Error("Cannot delete non-sprite targets.");const n=e.sprite;if(!n)throw new Error("No sprite associated with this target.");const i=this.exportSprite(A,"uint8array"),r=()=>i.then(A=>this.addSprite(A));e.deleteMonitors();const o=this.editingTarget;for(let A=0;A<n.clones.length;A++){const e=n.clones[A];if(this.runtime.stopForTarget(n.clones[A]),this.runtime.disposeTarget(n.clones[A]),e===o){const A=Math.min(this.runtime.targets.length-1,t);this.runtime.targets.length>0?this.setEditingTarget(this.runtime.targets[A].id):this.editingTarget=null}}return this.emitTargetsUpdate(),r}throw new Error("No target with the provided id.")}deleteSpriteInternal(A){const e=this.runtime.getTargetById(A);if(e){const t=this.runtime.targets.map(A=>A.id).indexOf(e.id);if(!e.isSprite())throw new Error("Cannot delete non-sprite targets.");const n=e.sprite;if(!n)throw new Error("No sprite associated with this target.");const i=this.exportSprite(A,"uint8array"),r=()=>i.then(A=>this.addSprite(A));e.deleteMonitors();const o=this.editingTarget;for(let A=0;A<n.clones.length;A++){const e=n.clones[A];if(this.runtime.stopForTarget(n.clones[A]),this.runtime.disposeTarget(n.clones[A]),e===o){const A=Math.min(this.runtime.targets.length-1,t);this.runtime.targets.length>0?this.setEditingTarget(this.runtime.targets[A].id):this.editingTarget=null}}return this.emitTargetsUpdate(),r}throw new Error("No target with the provided id.")}duplicateSprite(A){const e=this.runtime.getTargetById(A);if(!e)throw new Error("No target with the provided id.");if(!e.isSprite())throw new Error("Cannot duplicate non-sprite targets.");if(!e.sprite)throw new Error("No sprite associated with this target.");return e.duplicate().then(A=>{this.runtime.addTarget(A),A.goBehindOther(e),this.setEditingTarget(A.id)})}attachAudioEngine(A){this.runtime.attachAudioEngine(A)}attachRenderer(A){this.runtime.attachRenderer(A)}get renderer(){return this.runtime&&this.runtime.renderer}attachV2SVGAdapter(){}attachV2BitmapAdapter(A){this.runtime.attachV2BitmapAdapter(A)}attachStorage(A){this.runtime.attachStorage(A)}setLocale(A,e){return A!==d.setup().locale&&d.setup({locale:A,translations:{[A]:e}}),this.emit("LOCALE_CHANGED",A),this.extensionManager.refreshBlocks()}getLocale(){return d.setup().locale}blockListener(A){this.editingTarget&&this.editingTarget.blocks.blocklyListen(A)}flyoutBlockListener(A){this.runtime.flyoutBlocks.blocklyListen(A)}monitorBlockListener(A){-1!==["create","change"].indexOf(A.type)&&this.runtime.monitorBlocks.blocklyListen(A)}variableListener(A){-1!==["var_create","var_rename","var_delete"].indexOf(A.type)&&this.runtime.getTargetForStage().blocks.blocklyListen(A)}setEditingTarget(A){if(this.editingTarget&&A===this.editingTarget.id)return;const e=this.runtime.getTargetById(A);e&&(this.editingTarget=e,this.emitTargetsUpdate(!1),this.emitWorkspaceUpdate(),this.runtime.setEditingTarget(e))}exportStandaloneBlocks(A){return t(38).serializeStandaloneBlocks(A,this.runtime)}shareBlocksToTarget(A,e,n){const i=t(38),{blocks:r,extensionURLs:o}=i.deserializeStandaloneBlocks(A);F(r);const s=this.runtime.getTargetById(e);if(n){this.runtime.getTargetById(n).resolveVariableSharingConflictsWithTarget(r,s)}const a=new Set(r.map(A=>i.getExtensionIdForOpcode(A.opcode)).filter(A=>!!A).filter(A=>!this.extensionManager.isExtensionLoaded(A)));return this._loadExtensions(a,o).then(()=>{r.forEach(A=>{s.blocks.createBlock(A)}),s.blocks.updateTargetSpecificBlocks(s.isStage)})}shareCostumeToTarget(A,e){const t=this.editingTarget.getCostumes()[A],n=Object.assign({},t),i="".concat(n.assetId,".").concat(n.dataFormat);return D(i,n,this.runtime).then(()=>{const A=this.runtime.getTargetById(e);A&&(A.addCostume(n),A.setCostume(A.getCostumes().length-1))})}shareSoundToTarget(A,e){const t=this.editingTarget.getSounds()[A],n=Object.assign({},t),i=this.runtime.getTargetById(e);return Y(n,this.runtime,i.sprite.soundBank).then(()=>{i&&(i.addSound(n),this.emitTargetsUpdate())})}refreshWorkspace(){this.editingTarget&&(this.emitWorkspaceUpdate(),this.runtime.setEditingTarget(this.editingTarget),this.emitTargetsUpdate(!1))}emitTargetsUpdate(A){let e;void 0===A&&(A=!0);const t=()=>(e||(e=this.runtime.targets.filter(A=>!A.hasOwnProperty("isOriginal")||A.isOriginal).map(A=>A.toJSON())),e);this.emit("targetsUpdate",{get targetList(){return t()},editingTarget:this.editingTarget?this.editingTarget.id:null}),A&&this.runtime.emitProjectChanged()}emitWorkspaceUpdate(){const A=this.runtime.getTargetForStage().variables;let e=[];for(const t in A)A[t].type===p.BROADCAST_MESSAGE_TYPE&&e.push(t);for(let A=0;A<this.runtime.targets.length;A++){const t=this.runtime.targets[A].blocks._blocks;for(const A in t)if(t[A].fields.BROADCAST_OPTION){const n=t[A].fields.BROADCAST_OPTION.id,i=e.indexOf(n);-1!==i&&(e=e.slice(0,i).concat(e.slice(i+1)))}}for(let A=0;A<e.length;A++){const t=e[A];delete this.runtime.getTargetForStage().variables[t]}const t=Object.assign({},this.runtime.getTargetForStage().variables),n=this.editingTarget.isStage?Object.create(null):Object.assign({},this.editingTarget.variables),i=Object.keys(t).map(A=>t[A]),r=Object.keys(n).map(A=>n[A]),o=Object.keys(this.editingTarget.comments).map(A=>this.editingTarget.comments[A]).filter(A=>null===A.blockId),s='<xml xmlns="http://www.w3.org/1999/xhtml">\n                            <variables>\n                                '.concat(i.map(A=>A.toXML()).join(),"\n                                ").concat(r.map(A=>A.toXML(!0)).join(),"\n                            </variables>\n                            ").concat(o.map(A=>A.toXML()).join(),"\n                            ").concat(this.editingTarget.blocks.toXML(this.editingTarget.comments),"\n                        </xml>");this.emit("workspaceUpdate",{xml:s})}getTargetIdForDrawableId(A){const e=this.runtime.getTargetByDrawableId(A);return e&&e.hasOwnProperty("id")&&e.hasOwnProperty("isStage")&&!e.isStage?e.id:null}reorderTarget(A,e){let t=this.runtime.targets;if((A=Q.clamp(A,0,t.length-1))===(e=Q.clamp(e,0,t.length-1)))return!1;const n=t[A];return t=t.slice(0,A).concat(t.slice(A+1)),t.splice(e,0,n),this.runtime.targets=t,this.emitTargetsUpdate(),!0}reorderCostume(A,e,t){const n=this.runtime.getTargetById(A);if(n){const A=n.reorderCostume(e,t);return A&&this.runtime.emitProjectChanged(),A}return!1}reorderSound(A,e,t){const n=this.runtime.getTargetById(A);if(n){const A=n.reorderSound(e,t);return A&&this.runtime.emitProjectChanged(),A}return!1}startDrag(A){const e=this.runtime.getTargetById(A);e&&(this._dragTarget=e,e.startDrag())}stopDrag(A){const e=this.runtime.getTargetById(A);e&&(this._dragTarget=null,e.stopDrag(),this.setEditingTarget(e.sprite&&e.sprite.clones[0]?e.sprite.clones[0].id:e.id))}postSpriteInfo(A){this._dragTarget?this._dragTarget.postSpriteInfo(A):this.editingTarget.postSpriteInfo(A),this.runtime.emitProjectChanged()}setVariableValue(A,e,t){const n=this.runtime.getTargetById(A);if(n){const A=n.lookupVariableById(e);if(A)return A.value=t,A.isCloud&&this.runtime.ioDevices.cloud.requestUpdateVariable(A.name,A.value),!0}return!1}getVariableValue(A,e){const t=this.runtime.getTargetById(A);if(t){const A=t.lookupVariableById(e);if(A)return A.value}return null}configureScratchLinkSocketFactory(A){this.runtime.configureScratchLinkSocketFactory(A)}}},function(A,e,t){"use strict";e.byteLength=function(A){var e=B(A),t=e[0],n=e[1];return 3*(t+n)/4-n},e.toByteArray=function(A){var e,t,n=B(A),o=n[0],s=n[1],a=new r(function(A,e,t){return 3*(e+t)/4-t}(0,o,s)),c=0,g=s>0?o-4:o;for(t=0;t<g;t+=4)e=i[A.charCodeAt(t)]<<18|i[A.charCodeAt(t+1)]<<12|i[A.charCodeAt(t+2)]<<6|i[A.charCodeAt(t+3)],a[c++]=e>>16&255,a[c++]=e>>8&255,a[c++]=255&e;2===s&&(e=i[A.charCodeAt(t)]<<2|i[A.charCodeAt(t+1)]>>4,a[c++]=255&e);1===s&&(e=i[A.charCodeAt(t)]<<10|i[A.charCodeAt(t+1)]<<4|i[A.charCodeAt(t+2)]>>2,a[c++]=e>>8&255,a[c++]=255&e);return a},e.fromByteArray=function(A){for(var e,t=A.length,i=t%3,r=[],o=0,s=t-i;o<s;o+=16383)r.push(c(A,o,o+16383>s?s:o+16383));1===i?(e=A[t-1],r.push(n[e>>2]+n[e<<4&63]+"==")):2===i&&(e=(A[t-2]<<8)+A[t-1],r.push(n[e>>10]+n[e>>4&63]+n[e<<2&63]+"="));return r.join("")};for(var n=[],i=[],r="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,a=o.length;s<a;++s)n[s]=o[s],i[o.charCodeAt(s)]=s;function B(A){var e=A.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=A.indexOf("=");return-1===t&&(t=e),[t,t===e?0:4-t%4]}function c(A,e,t){for(var i,r,o=[],s=e;s<t;s+=3)i=(A[s]<<16&16711680)+(A[s+1]<<8&65280)+(255&A[s+2]),o.push(n[(r=i)>>18&63]+n[r>>12&63]+n[r>>6&63]+n[63&r]);return o.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(A,e){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
e.read=function(A,e,t,n,i){var r,o,s=8*i-n-1,a=(1<<s)-1,B=a>>1,c=-7,g=t?i-1:0,E=t?-1:1,Q=A[e+g];for(g+=E,r=Q&(1<<-c)-1,Q>>=-c,c+=s;c>0;r=256*r+A[e+g],g+=E,c-=8);for(o=r&(1<<-c)-1,r>>=-c,c+=n;c>0;o=256*o+A[e+g],g+=E,c-=8);if(0===r)r=1-B;else{if(r===a)return o?NaN:1/0*(Q?-1:1);o+=Math.pow(2,n),r-=B}return(Q?-1:1)*o*Math.pow(2,r-n)},e.write=function(A,e,t,n,i,r){var o,s,a,B=8*r-i-1,c=(1<<B)-1,g=c>>1,E=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,Q=n?0:r-1,u=n?1:-1,l=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,o=c):(o=Math.floor(Math.log(e)/Math.LN2),e*(a=Math.pow(2,-o))<1&&(o--,a*=2),(e+=o+g>=1?E/a:E*Math.pow(2,1-g))*a>=2&&(o++,a/=2),o+g>=c?(s=0,o=c):o+g>=1?(s=(e*a-1)*Math.pow(2,i),o+=g):(s=e*Math.pow(2,g-1)*Math.pow(2,i),o=0));i>=8;A[t+Q]=255&s,Q+=u,s/=256,i-=8);for(o=o<<i|s,B+=i;B>0;A[t+Q]=255&o,Q+=u,o/=256,B-=8);A[t+Q-u]|=128*l}},function(A,e){var t={}.toString;A.exports=Array.isArray||function(A){return"[object Array]"==t.call(A)}},function(A,e,t){(function(A){var n=void 0!==A&&A||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function r(A,e){this._id=A,this._clearFn=e}e.setTimeout=function(){return new r(i.call(setTimeout,n,arguments),clearTimeout)},e.setInterval=function(){return new r(i.call(setInterval,n,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(A){A&&A.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(n,this._id)},e.enroll=function(A,e){clearTimeout(A._idleTimeoutId),A._idleTimeout=e},e.unenroll=function(A){clearTimeout(A._idleTimeoutId),A._idleTimeout=-1},e._unrefActive=e.active=function(A){clearTimeout(A._idleTimeoutId);var e=A._idleTimeout;e>=0&&(A._idleTimeoutId=setTimeout((function(){A._onTimeout&&A._onTimeout()}),e))},t(131),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==A&&A.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==A&&A.clearImmediate||this&&this.clearImmediate}).call(this,t(14))},function(A,e,t){(function(A,e){!function(A,t){"use strict";if(!A.setImmediate){var n,i,r,o,s,a=1,B={},c=!1,g=A.document,E=Object.getPrototypeOf&&Object.getPrototypeOf(A);E=E&&E.setTimeout?E:A,"[object process]"==={}.toString.call(A.process)?n=function(A){e.nextTick((function(){u(A)}))}:!function(){if(A.postMessage&&!A.importScripts){var e=!0,t=A.onmessage;return A.onmessage=function(){e=!1},A.postMessage("","*"),A.onmessage=t,e}}()?A.MessageChannel?((r=new MessageChannel).port1.onmessage=function(A){u(A.data)},n=function(A){r.port2.postMessage(A)}):g&&"onreadystatechange"in g.createElement("script")?(i=g.documentElement,n=function(A){var e=g.createElement("script");e.onreadystatechange=function(){u(A),e.onreadystatechange=null,i.removeChild(e),e=null},i.appendChild(e)}):n=function(A){setTimeout(u,0,A)}:(o="setImmediate$"+Math.random()+"$",s=function(e){e.source===A&&"string"==typeof e.data&&0===e.data.indexOf(o)&&u(+e.data.slice(o.length))},A.addEventListener?A.addEventListener("message",s,!1):A.attachEvent("onmessage",s),n=function(e){A.postMessage(o+e,"*")}),E.setImmediate=function(A){"function"!=typeof A&&(A=new Function(""+A));for(var e=new Array(arguments.length-1),t=0;t<e.length;t++)e[t]=arguments[t+1];var i={callback:A,args:e};return B[a]=i,n(a),a++},E.clearImmediate=Q}function Q(A){delete B[A]}function u(A){if(c)setTimeout(u,0,A);else{var e=B[A];if(e){c=!0;try{!function(A){var e=A.callback,t=A.args;switch(t.length){case 0:e();break;case 1:e(t[0]);break;case 2:e(t[0],t[1]);break;case 3:e(t[0],t[1],t[2]);break;default:e.apply(void 0,t)}}(e)}finally{Q(A),c=!1}}}}}("undefined"==typeof self?void 0===A?this:A:self)}).call(this,t(14),t(40))},function(A,e,t){const n=t(5);A.exports=class{constructor(){this.callbacks=[],this.nextResponseId=0}call(A,e){for(var t=arguments.length,n=new Array(t>2?t-2:0),i=2;i<t;i++)n[i-2]=arguments[i];return this.transferCall(A,e,null,...n)}transferCall(A,e,t){try{const{provider:o,isRemote:s}=this._getServiceProvider(A);if(o){for(var n=arguments.length,i=new Array(n>3?n-3:0),r=3;r<n;r++)i[r-3]=arguments[r];if(s)return this._remoteTransferCall(o,A,e,t,...i);const a=o[e].apply(o,i);return Promise.resolve(a)}return Promise.reject(new Error("Service not found: ".concat(A)))}catch(A){return Promise.reject(A)}}_isRemoteService(A){var e,t;return null!==(e=null===(t=this._getServiceProvider(A))||void 0===t?void 0:t.isRemote)&&void 0!==e&&e}_remoteCall(A,e,t){for(var n=arguments.length,i=new Array(n>3?n-3:0),r=3;r<n;r++)i[r-3]=arguments[r];return this._remoteTransferCall(A,e,t,null,...i)}_remoteTransferCall(A,e,t,n){for(var i=arguments.length,r=new Array(i>4?i-4:0),o=4;o<i;o++)r[o-4]=arguments[o];return new Promise((i,o)=>{const s=this._storeCallbacks(i,o);r.length>0&&"function"==typeof r[r.length-1].func&&(r.pop(),r.pop()),n?A.postMessage({service:e,method:t,responseId:s,args:r},n):A.postMessage({service:e,method:t,responseId:s,args:r})})}_storeCallbacks(A,e){const t=this.nextResponseId++;return this.callbacks[t]=[A,e],t}_deliverResponse(A,e){try{const[t,n]=this.callbacks[A];delete this.callbacks[A],e.error?n(e.error):t(e.result)}catch(A){n.error("Dispatch callback failed: ".concat(A))}}_onMessage(A,e){const t=e.data;let i;t.args=t.args||[],t.service?i="dispatch"===t.service?this._onDispatchMessage(A,t):this.call(t.service,t.method,...t.args):void 0===t.responseId?n.error("Dispatch caught malformed message from a worker: ".concat(JSON.stringify(e))):this._deliverResponse(t.responseId,t),i&&(void 0===t.responseId?n.error("Dispatch message missing required response ID: ".concat(JSON.stringify(e))):i.then(e=>A.postMessage({responseId:t.responseId,result:e}),e=>A.postMessage({responseId:t.responseId,error:"".concat(e)})))}_getServiceProvider(A){throw new Error("Could not get provider for ".concat(A,": _getServiceProvider not implemented"))}_onDispatchMessage(A,e){throw new Error("Unimplemented dispatch message handler cannot handle ".concat(e.method," method"))}}},function(A,e,t){var n=t(21),i=t(135),r=new n,o=Array.prototype.slice;(e=A.exports=function(A){var t=function(){return r.write(A,void 0,o.call(arguments)),t};return t.debug=function(){return r.write(A,"debug",o.call(arguments)),t},t.info=function(){return r.write(A,"info",o.call(arguments)),t},t.warn=function(){return r.write(A,"warn",o.call(arguments)),t},t.error=function(){return r.write(A,"error",o.call(arguments)),t},t.log=t.debug,t.suggest=e.suggest,t.format=r.format,t}).defaultBackend=e.defaultFormatter=null,e.pipe=function(A){return r.pipe(A)},e.end=e.unpipe=e.disable=function(A){return r.unpipe(A)},e.Transform=n,e.Filter=i,e.suggest=new i,e.enable=function(){return e.defaultFormatter?r.pipe(e.suggest).pipe(e.defaultFormatter).pipe(e.defaultBackend):r.pipe(e.suggest).pipe(e.defaultBackend)}},function(A,e){function t(){this._events={}}t.prototype={on:function(A,e){this._events||(this._events={});var t=this._events;return(t[A]||(t[A]=[])).push(e),this},removeListener:function(A,e){var t,n=this._events[A]||[];for(t=n.length-1;t>=0&&n[t];t--)n[t]!==e&&n[t].cb!==e||n.splice(t,1)},removeAllListeners:function(A){A?this._events[A]&&(this._events[A]=[]):this._events={}},listeners:function(A){return this._events&&this._events[A]||[]},emit:function(A){this._events||(this._events={});var e,t=Array.prototype.slice.call(arguments,1),n=this._events[A]||[];for(e=n.length-1;e>=0&&n[e];e--)n[e].apply(this,t);return this},when:function(A,e){return this.once(A,e,!0)},once:function(A,e,t){if(!e)return this;function n(){t||this.removeListener(A,n),e.apply(this,arguments)&&t&&this.removeListener(A,n)}return n.cb=e,this.on(A,n),this}},t.mixin=function(A){var e,n=t.prototype;for(e in n)n.hasOwnProperty(e)&&(A.prototype[e]=n[e])},A.exports=t},function(A,e,t){var n=t(21),i={debug:1,info:2,warn:3,error:4};function r(){this.enabled=!0,this.defaultResult=!0,this.clear()}function o(A,e){return A.n.test?A.n.test(e):A.n==e}n.mixin(r),r.prototype.allow=function(A,e){return this._white.push({n:A,l:i[e]}),this},r.prototype.deny=function(A,e){return this._black.push({n:A,l:i[e]}),this},r.prototype.clear=function(){return this._white=[],this._black=[],this},r.prototype.test=function(A,e){var t,n=Math.max(this._white.length,this._black.length);for(t=0;t<n;t++){if(this._white[t]&&o(this._white[t],A)&&i[e]>=this._white[t].l)return!0;if(this._black[t]&&o(this._black[t],A)&&i[e]<=this._black[t].l)return!1}return this.defaultResult},r.prototype.write=function(A,e,t){if(!this.enabled||this.test(A,e))return this.emit("item",A,e,t)},A.exports=r},function(A,e,t){var n=t(21),i=/\n+$/,r=new n;r.write=function(A,e,t){var n=t.length-1;if("undefined"!=typeof console&&console.log){if(console.log.apply)return console.log.apply(console,[A,e].concat(t));if(JSON&&JSON.stringify){t[n]&&"string"==typeof t[n]&&(t[n]=t[n].replace(i,""));try{for(n=0;n<t.length;n++)t[n]=JSON.stringify(t[n])}catch(A){}console.log(t.join(" "))}}},r.formatters=["color","minilog"],r.color=t(137),r.minilog=t(138),A.exports=r},function(A,e,t){var n=t(21),i=t(83),r={debug:["cyan"],info:["purple"],warn:["yellow",!0],error:["red",!0]},o=new n;o.write=function(A,e,t){console.log;console[e]&&console[e].apply&&console[e].apply(console,["%c"+A+" %c"+e,i("gray"),i.apply(i,r[e])].concat(t))},o.pipe=function(){},A.exports=o},function(A,e,t){var n=t(21),i=t(83),r={debug:["gray"],info:["purple"],warn:["yellow",!0],error:["red",!0]},o=new n;o.write=function(A,e,t){var n=console.log;"debug"!=e&&console[e]&&(n=console[e]);var o=0;if("info"!=e){for(;o<t.length&&"string"==typeof t[o];o++);n.apply(console,["%c"+A+" "+t.slice(0,o).join(" "),i.apply(i,r[e])].concat(t.slice(o)))}else n.apply(console,["%c"+A,i.apply(i,r[e])].concat(t))},o.pipe=function(){},A.exports=o},function(A,e,t){var n=t(21),i=[],r=new n;r.write=function(A,e,t){i.push([A,e,t])},r.get=function(){return i},r.empty=function(){i=[]},A.exports=r},function(A,e,t){var n=t(21),i=!1,r=new n;r.write=function(A,e,t){if("undefined"!=typeof window&&"undefined"!=typeof JSON&&JSON.stringify&&JSON.parse)try{i||(i=window.localStorage.minilog?JSON.parse(window.localStorage.minilog):[]),i.push([(new Date).toString(),A,e,t]),window.localStorage.minilog=JSON.stringify(i)}catch(A){}},A.exports=r},function(A,e,t){var n=t(21),i=(new Date).valueOf().toString(36);function r(A){this.url=A.url||"",this.cache=[],this.timer=null,this.interval=A.interval||3e4,this.enabled=!0,this.jQuery=window.jQuery,this.extras={}}n.mixin(r),r.prototype.write=function(A,e,t){this.timer||this.init(),this.cache.push([A,e].concat(t))},r.prototype.init=function(){if(this.enabled&&this.jQuery){var A=this;this.timer=setTimeout((function(){var e,t,n=[],r=A.url;if(0==A.cache.length)return A.init();for(e=0;e<A.cache.length;e++)try{JSON.stringify(A.cache[e]),n.push(A.cache[e])}catch(A){}A.jQuery.isEmptyObject(A.extras)?(t=JSON.stringify({logs:n}),r=A.url+"?client_id="+i):t=JSON.stringify(A.jQuery.extend({logs:n},A.extras)),A.jQuery.ajax(r,{type:"POST",cache:!1,processData:!1,data:t,contentType:"application/json",timeout:1e4}).success((function(e,t,n){e.interval&&(A.interval=Math.max(1e3,e.interval))})).error((function(){A.interval=3e4})).always((function(){A.init()})),A.cache=[]}),this.interval)}},r.prototype.end=function(){},r.jQueryWait=function(A){if("undefined"!=typeof window&&(window.jQuery||window.$))return A(window.jQuery||window.$);"undefined"!=typeof window&&setTimeout((function(){r.jQueryWait(A)}),200)},A.exports=r},function(A,e,t){const n=t(82),i=t(5),r=t(84),o=t(1),s=t(145),a=t(2),B=t(88),c=new URLSearchParams(location.search),g=false,E=c.has("livetests");const Q={coreExample:()=>t(146),pen:()=>t(147),wedo2:()=>t(148),music:()=>t(151),microbit:()=>t(214),text2speech:()=>t(215),translate:()=>t(216),videoSensing:()=>t(217),ev3:()=>t(252),makeymakey:()=>t(254),boost:()=>t(255),gdxfor:()=>t(256),text:()=>t(259),tw:()=>t(260),twFiles:()=>t(261),pmMotionExpansion:()=>t(262),pmOperatorsExpansion:()=>t(263),pmSensingExpansion:()=>t(265),pmControlsExpansion:()=>t(266),pmEventsExpansion:()=>t(268),pmInlineBlocks:()=>t(269),jgFiles:()=>t(270),jgWebsiteRequests:()=>t(271),jgJSON:()=>t(272),jgRuntime:()=>t(273),jgPrism:()=>t(274),jgIframe:()=>t(277),jgExtendedAudio:()=>t(278),jgScratchAuthenticate:()=>t(281),JgPermissionBlocks:()=>t(284),jgClones:()=>t(286),jgTween:()=>t(287),jgDebugging:()=>t(288),jgEasySave:()=>t(289),jgPackagerApplications:()=>t(290),jgTailgating:()=>t(292),jgScripts:()=>t(293),jg3d:()=>t(294),jg3dVr:()=>t(307),jgVr:()=>t(310),jgInterfaces:()=>t(311),jgJavascript:()=>t(323),jgPathfinding:()=>t(324),jgAnimation:()=>t(344),jgStorage:()=>t(345),jgTimers:()=>t(346),jgDev:()=>t(348),jgDooDoo:()=>t(350),jgBestExtension:()=>t(353),jgChristmas:()=>t(354),jwUnite:()=>t(359),jwProto:()=>t(360),jwPostLit:()=>t(361),jwReflex:()=>t(362),blockly2math:()=>t(363),jwXml:()=>t(364),jwVector:()=>t(365),jwArray:()=>t(366),jwTargets:()=>t(367),jwPsychic:()=>t(368),jwLambda:()=>t(370),jwNum:()=>t(371),jwColor:()=>t(373),jwStorage:()=>t(374),jwDate:()=>t(375),jwStructs:()=>t(376),Gamepad:()=>t(377),theshovelcanvaseffects:()=>t(378),shovellzcompresss:()=>t(379),shovelColorPicker:()=>t(381),shovelcss:()=>t(382),profanityAPI:()=>t(383),canvas:()=>t(384),newCanvas:()=>t(386),tempVars:()=>t(388),colors:()=>t(389),pmCamera:()=>t(390),sharkpoolPrinting:()=>t(391),SPjavascriptV2:()=>t(393),oddMessage:()=>t(394),lmsutilsblocks:()=>t(395),lmsTempVars2:()=>t(396),xeltallivclipblend:()=>t(397),DTcameracontrols:()=>t(398),iygPerlin:()=>t(399),fr3d:()=>t(402)},u=["argument","colour","control","data","event","looks","math","motion","operator","procedures","sensing","sound"],l=Object.getOwnPropertyNames(Q),w=[];(g||E)&&w.push("jgDev");A.exports=class{constructor(A){this.nextExtensionWorker=0,this.pendingExtensions=[],this.pendingWorkers=[],this.workerURLs=[],this._loadedExtensions=new Map,this.securityManager=new s,this.vm=A,this.runtime=A.runtime,this.loadingAsyncExtensions=0,this.asyncExtensionsLoadedCallbacks=[],this.builtinExtensions=Object.assign({},Q),n.setService("extensions",(A=>{const e={};return e.registerExtensionServiceSync=A.registerExtensionServiceSync.bind(A),e.allocateWorker=A.allocateWorker.bind(A),e.onWorkerInit=A.onWorkerInit.bind(A),e.registerExtensionService=A.registerExtensionService.bind(A),e})(this)).catch(A=>{i.error("ExtensionManager was unable to register extension service: ".concat(JSON.stringify(A)))}),w.forEach(A=>{this.loadExtensionURL(A)}),this.extUrlCodes={},this.keepOlder=[],this.extensionHashes={}}getCoreExtensionList(){return l}getBuiltInExtensionsList(){return this.builtinExtensions}getAddonBlockSwitches(){return B(this.vm)}isExtensionLoaded(A){return this._loadedExtensions.has(A)}isBuiltinExtension(A){return Object.prototype.hasOwnProperty.call(this.builtinExtensions,A)}loadExtensionIdSync(A){if(!this.isBuiltinExtension(A))return void i.warn("Could not find extension ".concat(A," in the built in extensions."));if(this.isExtensionLoaded(A)){const e="Rejecting attempt to load a second extension with ID ".concat(A);return void i.warn(e)}const e=new(this.builtinExtensions[A]())(this.runtime),t=this._registerInternalExtension(e),n=e.getInfo().id;this._loadedExtensions.set(A,t),this.runtime.compilerRegisterExtension(n,e)}addBuiltinExtension(A,e){this.builtinExtensions[A]=()=>e}_isValidExtensionURL(A){try{const e=new URL(A);return"https:"===e.protocol||"http:"===e.protocol||"data:"===e.protocol||"file:"===e.protocol}catch(A){return!1}}async loadExtensionURL(A){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(this.isBuiltinExtension(A))return this.loadExtensionIdSync(A),[A];if(this.isExtensionURLLoaded(A))return[];if(!this._isValidExtensionURL(A))throw new Error("Invalid extension URL: ".concat(A));A.includes("penguinmod.site")&&alert("Extensions using penguinmod.site are deprecated, please swap them over to use penguinmod.com instead.");const i=A.replace("penguinmod.site","penguinmod.com");this.runtime.setExternalCommunicationMethod("customExtensions",!0),this.loadingAsyncExtensions++;const r=await this.securityManager.getSandboxMode(i),o=await this.securityManager.rewriteExtensionURL(i),s=await fetch(o).then(A=>A.blob()),a=URL.createObjectURL(s),B=await new Promise(e=>{const t=new FileReader;t.onload=async t=>{let{target:{result:n}}=t;console.log(n),this.extUrlCodes[A]=n,e(await async function(A){const e=(new TextEncoder).encode(A),t=await crypto.subtle.digest("SHA-256",e);return[...new Uint8Array(t)].map(A=>A.toString(16).padStart(2,"0")).join("")}(n))},t.onerror=A=>{console.error("couldnt read the contents of url",url,A)},t.readAsText(s)});if(this.extensionHashes[A]=B,e&&e!==B&&this.securityManager.shouldUseLocal(A))return Promise.reject("useLocal");if("unsandboxed"===r){const{load:A}=t(405),e=await A(a,this.vm).catch(A=>this._failedLoadingExtensionScript(A)),r=this.nextExtensionWorker++,o=[];this.workerURLs[r]=i;for(const A of e){const e=A.getInfo(),t="unsandboxed.".concat(r,".").concat(e.id);n.setServiceSync(t,A),n.callSync("extensions","registerExtensionServiceSync",t),this._loadedExtensions.set(e.id,t),o.push(e.id),this.runtime.compilerRegisterExtension(e.id,A)}return this._finishedLoadingExtensionScript(),o}let c;if("worker"===r)c=t(409);else{if("iframe"!==r)throw new Error("Invalid sandbox mode: ".concat(r));c=(await t.e(1).then(t.t.bind(null,502,7))).default}return new Promise((A,e)=>{this.pendingExtensions.push({extensionURL:o,resolve:A,reject:e}),n.addWorker(new c)}).catch(A=>this._failedLoadingExtensionScript(A))}allAsyncExtensionsLoaded(){if(0!==this.loadingAsyncExtensions)return new Promise((A,e)=>{this.asyncExtensionsLoadedCallbacks.push({resolve:A,reject:e})})}refreshDynamicCategorys(A){const e=A=>n.call(A,"getInfo").then(e=>{(e=this._prepareExtensionInfo(A,e)).isDynamic&&n.call("runtime","_refreshExtensionPrimitives",e)}).catch(A=>{i.error("Failed to refresh built-in extension primitives: ".concat(A))});if(!this._loadedExtensions)return Promise.reject("_loadedExtensions is not readable yet");if(!A){const A=Array.from(this._loadedExtensions.values()).map(e);return Promise.all(A)}return this._loadedExtensions.has(A)?e(this._loadedExtensions.get(A)):Promise.reject(new Error("Unknown extension: ".concat(A)))}refreshBlocks(A){const e=A=>n.call(A,"getInfo").then(e=>{e=this._prepareExtensionInfo(A,e),n.call("runtime","_refreshExtensionPrimitives",e)}).catch(A=>{i.error("Failed to refresh built-in extension primitives: ".concat(A))});if(!A){const A=Array.from(this._loadedExtensions.values()).map(e);return Promise.all(A)}return this._loadedExtensions.has(A)?e(this._loadedExtensions.get(A)):Promise.reject(new Error("Unknown extension: ".concat(A)))}prepareSwap(A){const e=this._loadedExtensions.get(A),{provider:t,isRemote:i}=n._getServiceProvider(e);(i||"function"==typeof t.dispose)&&n.call(e,"dispose"),delete n.services[e],delete this.runtime["ext_".concat(A)],this._loadedExtensions.delete(A);const r=+e.split(".")[1];delete this.workerURLs[r]}removeExtension(A){const e=this._loadedExtensions.get(A),{provider:t,isRemote:i}=n._getServiceProvider(e);(i||"function"==typeof t.dispose)&&n.call(e,"dispose"),delete n.services[e],delete this.runtime["ext_".concat(A)],this._loadedExtensions.delete(A);const r=+e.split(".")[1];delete this.workerURLs[r],n.call("runtime","_removeExtensionPrimitive",A),this.refreshBlocks()}getExtensionIdFromOpcode(A){if("string"!=typeof A)return console.error("invalid opcode "+A),"";const e=A.indexOf("_"),t=A.substring(0,e).replace(/[^\w-]/g,"-");return-1===u.indexOf(t)&&""!==t?t:void 0}findUsedExtensions(){const A=[];for(const e of this.runtime.targets)for(const t in e.blocks._blocks){const n=e.blocks.getBlock(t),i=this.getExtensionIdFromOpcode(n.opcode);A.push(i)}return A}removeUnusedExtensions(){const A=[...this._loadedExtensions.keys()],e=this.findUsedExtensions(),t=A.filter(A=>!e.includes(A));for(const A of t)this.removeExtension(A)}allocateWorker(){const A=this.nextExtensionWorker++,e=this.pendingExtensions.shift();return this.pendingWorkers[A]=e,this.workerURLs[A]=e.extensionURL,[A,e.extensionURL]}registerExtensionServiceSync(A){const e=n.callSync(A,"getInfo");this._registerExtensionInfo(A,e)}registerExtensionService(A){n.call(A,"getInfo").then(e=>{this._loadedExtensions.set(e.id,A),this._registerExtensionInfo(A,e),this._finishedLoadingExtensionScript()})}_finishedLoadingExtensionScript(){this.loadingAsyncExtensions--,0===this.loadingAsyncExtensions&&(this.asyncExtensionsLoadedCallbacks.forEach(A=>A.resolve()),this.asyncExtensionsLoadedCallbacks=[])}_failedLoadingExtensionScript(A){throw this.loadingAsyncExtensions--,this.asyncExtensionsLoadedCallbacks.forEach(e=>e.reject(A)),this.asyncExtensionsLoadedCallbacks=[],A}onWorkerInit(A,e){const t=this.pendingWorkers[A];delete this.pendingWorkers[A],e?t.reject(e):t.resolve()}_registerInternalExtension(A){const e=A.getInfo(),t=this.nextExtensionWorker++,i="extension_".concat(t,"_").concat(e.id);return n.setServiceSync(i,A),n.callSync("extensions","registerExtensionServiceSync",i),i}_registerExtensionInfo(A,e){e=this._prepareExtensionInfo(A,e),n.call("runtime","_registerExtensionPrimitives",e).catch(e=>{i.error("Failed to register primitives for extension on service ".concat(A,":"),e)})}_prepareExtensionInfo(A,e){if(e=Object.assign({},e),!/^[a-z0-9]+$/i.test(e.id))throw new Error("Invalid extension id");return e.name=e.name||e.id,e.blocks=e.blocks||[],e.targetTypes=e.targetTypes||[],e.menus=e.menus||{},e.menus=this._prepareMenuInfo(A,e.menus),e.blocks=e.blocks.reduce((t,n)=>{try{let i;switch(n){case"---":i="---";break;default:i=this._prepareBlockInfo(A,n,e.menus)}t.push(i)}catch(A){i.error("Error processing block: ".concat(A.message,", Block:\n").concat(JSON.stringify(n)),A)}return t},[]),e}_prepareMenuInfo(A,e){const t=Object.getOwnPropertyNames(e);for(let i=0;i<t.length;i++){const r=t[i];let o=e[r];if(o.items||"string"==typeof o.variableType||(o={items:o},e[r]=o),"string"==typeof o.items){const e=o.items,t=n.services[A];o.items=this._getExtensionMenuItems.bind(this,t,e)}}return e}_getExtensionMenuItems(A,e){const t=this.runtime.getEditingTarget()||this.runtime.getTargetForStage(),n=t?t.id:null,i=this.runtime.makeMessageContextForTarget(t),o=A[e].call(A,n).map(A=>{switch(typeof(A=r(A,i))){case"object":return Array.isArray(A)?A.slice(0,2):[r(A.text,i),A.value];case"string":return[A,A];default:return A}});if(!o||o.length<1)throw new Error("Extension menu returned no items: ".concat(e));return o}_normalize(A,e){switch(e){case"string":return a.toString(A);case"bigint":case"number":return a.toNumber(A);case"boolean":return a.toBoolean(A);case"function":return new Function(A);default:return a.toString(A)}}_prepareBlockInfo(A,e,t){if(e.blockType===o.XML)return(e=Object.assign({},e)).xml=String(e.xml)||"",e;switch((e=Object.assign({},{blockType:o.COMMAND,terminal:!1,blockAllThreads:!1,arguments:{}},e)).text=e.text||e.opcode,e.blockType){case o.EVENT:e.func&&i.warn('Ignoring function "'.concat(e.func,'" for event block ').concat(e.opcode));break;case o.BUTTON:if(!e.opcode&&!e.func)throw new Error("Missing opcode or func for button: ".concat(e.text));e.func&&!e.opcode&&(e.opcode=e.func);const r=e.opcode,s=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n.call(A,r,...t)};e.func=s;break;case o.LABEL:break;default:{if(!e.opcode)throw new Error("Missing opcode for block");const r=e.func||e.opcode,o=e.isDynamic?A=>A&&A.mutation&&A.mutation.blockInfo:()=>e,s=(()=>{if(n._isRemoteService(A))return(e,t,i)=>n.call(A,r,e,t,i).then(A=>"number"==typeof A||"string"==typeof A||"boolean"==typeof A?A:"".concat(A)).catch(A=>(console.error("Custom extension block error",A),"".concat(A)));const e=n.services[A];return e?(e[r]||i.warn("Could not find extension block function called ".concat(r)),(A,t,n)=>e[r](A,t,n)):()=>{}})();e.func=(A,e,n)=>{var i,r;const a={angle:"number",Boolean:"boolean",color:"string",number:"number",string:"string",matrix:"string",note:"number",image:"string",polygon:"object",list:"exception",broadcast:"exception"},B=o(A);for(const e in B.arguments){var c;const n=a[B.arguments[e].type];!0!==B.arguments[e].exemptFromNormalization&&("exception"!==n&&n&&"string"!=typeof(null===(c=t[B.arguments[e].menu])||void 0===c?void 0:c.variableType)&&typeof A[e]!==n&&(A[e]=this._normalize(A[e],n)))}const g=s(A,e,B),E=null!==(i=null==g?void 0:g.value)&&void 0!==i&&i&&"Object"!==(null==g||null===(r=g.constructor)||void 0===r?void 0:r.name);return!n&&E?g.value:g};break}}return e}extensionUrlFromId(A){for(const[e,t]of this._loadedExtensions.entries()){if(e!==A)continue;const n=+t.split(".")[1];return this.workerURLs[n]}}getExtensionURLs(){const A={};for(const[e,t]of this._loadedExtensions.entries()){const n=+t.split(".")[1],i=this.workerURLs[n];"string"==typeof i&&(A[e]=i)}return A}isExtensionURLLoaded(A){return this.workerURLs.includes(A)}}},function(A,e,t){"use strict";var n=["number","date","time","ordinal","duration","spellout"],i=["plural","select","selectordinal"];function r(A,e){var t=A.pattern,n=t.length,i=[],r=A.index,s=o(A,e);for(s&&i.push(s),s&&A.tokens&&A.tokens.push(["text",t.slice(r,A.index)]);A.index<n;){if("}"===t[A.index]){if(!e)throw u(A);break}if(e&&A.tagsType&&"</"===t.slice(A.index,A.index+"</".length))break;i.push(B(A)),r=A.index,(s=o(A,e))&&i.push(s),s&&A.tokens&&A.tokens.push(["text",t.slice(r,A.index)])}return i}function o(A,e){for(var t=A.pattern,n=t.length,i="plural"===e||"selectordinal"===e,r=!!A.tagsType,o="{style}"===e,a="";A.index<n;){var B=t[A.index];if("{"===B||"}"===B||i&&"#"===B||r&&"<"===B||o&&s(B.charCodeAt(0)))break;if("'"===B)if("'"===(B=t[++A.index]))a+=B,++A.index;else if("{"===B||"}"===B||i&&"#"===B||r&&"<"===B||o)for(a+=B;++A.index<n;)if("'"===(B=t[A.index])&&"'"===t[A.index+1])a+="'",++A.index;else{if("'"===B){++A.index;break}a+=B}else a+="'";else a+=B,++A.index}return a}function s(A){return A>=9&&A<=13||32===A||133===A||160===A||6158===A||A>=8192&&A<=8205||8232===A||8233===A||8239===A||8287===A||8288===A||12288===A||65279===A}function a(A){for(var e=A.pattern,t=e.length,n=A.index;A.index<t&&s(e.charCodeAt(A.index));)++A.index;n<A.index&&A.tokens&&A.tokens.push(["space",A.pattern.slice(n,A.index)])}function B(A){var e=A.pattern;if("#"===e[A.index])return A.tokens&&A.tokens.push(["syntax","#"]),++A.index,["#"];var t=function(A){var e=A.tagsType;if(!e||"<"!==A.pattern[A.index])return;if("</"===A.pattern.slice(A.index,A.index+"</".length))throw u(A,null,"closing tag without matching opening tag");A.tokens&&A.tokens.push(["syntax","<"]);++A.index;var t=c(A,!0);if(!t)throw u(A,"placeholder id");A.tokens&&A.tokens.push(["id",t]);if(a(A),"/>"===A.pattern.slice(A.index,A.index+"/>".length))return A.tokens&&A.tokens.push(["syntax","/>"]),A.index+="/>".length,[t,e];if(">"!==A.pattern[A.index])throw u(A,">");A.tokens&&A.tokens.push(["syntax",">"]);++A.index;var n=r(A,e),i=A.index;if("</"!==A.pattern.slice(A.index,A.index+"</".length))throw u(A,"</"+t+">");A.tokens&&A.tokens.push(["syntax","</"]);A.index+="</".length;var o=c(A,!0);o&&A.tokens&&A.tokens.push(["id",o]);if(t!==o)throw A.index=i,u(A,"</"+t+">","</"+o+">");if(a(A),">"!==A.pattern[A.index])throw u(A,">");A.tokens&&A.tokens.push(["syntax",">"]);return++A.index,[t,e,{children:n}]}(A);if(t)return t;if("{"!==e[A.index])throw u(A,"{");A.tokens&&A.tokens.push(["syntax","{"]),++A.index,a(A);var i=c(A);if(!i)throw u(A,"placeholder id");A.tokens&&A.tokens.push(["id",i]),a(A);var o=e[A.index];if("}"===o)return A.tokens&&A.tokens.push(["syntax","}"]),++A.index,[i];if(","!==o)throw u(A,", or }");A.tokens&&A.tokens.push(["syntax",","]),++A.index,a(A);var s,B=c(A);if(!B)throw u(A,"placeholder type");if(A.tokens&&A.tokens.push(["type",B]),a(A),"}"===(o=e[A.index])){if(A.tokens&&A.tokens.push(["syntax","}"]),"plural"===B||"selectordinal"===B||"select"===B)throw u(A,B+" sub-messages");return++A.index,[i,B]}if(","!==o)throw u(A,", or }");if(A.tokens&&A.tokens.push(["syntax",","]),++A.index,a(A),"plural"===B||"selectordinal"===B){var Q=function(A){var e=A.pattern,t=e.length,n=0;if("offset:"===e.slice(A.index,A.index+"offset:".length)){A.tokens&&A.tokens.push(["offset","offset"],["syntax",":"]),A.index+="offset:".length,a(A);for(var i=A.index;A.index<t&&((r=e.charCodeAt(A.index))>=48&&r<=57);)++A.index;if(i===A.index)throw u(A,"offset number");A.tokens&&A.tokens.push(["number",e.slice(i,A.index)]),n=+e.slice(i,A.index)}var r;return n}(A);a(A),s=[i,B,Q,E(A,B)]}else if("select"===B)s=[i,B,E(A,B)];else if(n.indexOf(B)>=0)s=[i,B,g(A)];else{var l=A.index,w=g(A);a(A),"{"===e[A.index]&&(A.index=l,w=E(A,B)),s=[i,B,w]}if(a(A),"}"!==e[A.index])throw u(A,"}");return A.tokens&&A.tokens.push(["syntax","}"]),++A.index,s}function c(A,e){for(var t=A.pattern,n=t.length,i="";A.index<n;){var r=t[A.index];if("{"===r||"}"===r||","===r||"#"===r||"'"===r||s(r.charCodeAt(0))||e&&("<"===r||">"===r||"/"===r))break;i+=r,++A.index}return i}function g(A){var e=A.index,t=o(A,"{style}");if(!t)throw u(A,"placeholder style name");return A.tokens&&A.tokens.push(["style",A.pattern.slice(e,A.index)]),t}function E(A,e){for(var t=A.pattern,n=t.length,r={};A.index<n&&"}"!==t[A.index];){var o=c(A);if(!o)throw u(A,"sub-message selector");A.tokens&&A.tokens.push(["selector",o]),a(A),r[o]=Q(A,e),a(A)}if(!r.other&&i.indexOf(e)>=0)throw u(A,null,null,'"other" sub-message must be specified in '+e);return r}function Q(A,e){if("{"!==A.pattern[A.index])throw u(A,"{ to start sub-message");A.tokens&&A.tokens.push(["syntax","{"]),++A.index;var t=r(A,e);if("}"!==A.pattern[A.index])throw u(A,"} to end sub-message");return A.tokens&&A.tokens.push(["syntax","}"]),++A.index,t}function u(A,e,t,n){var i=A.pattern,r=i.slice(0,A.index).split(/\r?\n/),o=A.index,s=r.length,a=r.slice(-1)[0].length;return t=t||(A.index>=i.length?"end of message pattern":c(A)||i[A.index]),n||(n=function(A,e){return A?"Expected "+A+" but found "+e:"Unexpected "+e+" found"}(e,t)),new l(n+=" in "+i.replace(/\r?\n/g,"\n"),e,t,o,s,a)}function l(A,e,t,n,i,r){Error.call(this,A),this.name="SyntaxError",this.message=A,this.expected=e,this.found=t,this.offset=n,this.line=i,this.column=r}e=A.exports=function(A,e){return r({pattern:String(A),index:0,tagsType:e&&e.tagsType||null,tokens:e&&e.tokens||null},"")},l.prototype=Object.create(Error.prototype),e.SyntaxError=l},function(A,e,t){"use strict";var n=t(85),i=t(86),r=t(87);function o(A,e,t,n,i){var r=A.map((function(A){return function(A,e,t,n,i){if("string"==typeof A){var r=A;return function(){return r}}var a,B=A[0],c=A[1];if(e&&"#"===A[0]){B=e[0];var g=e[2],Q=(n.number||E.number)([B,"number"],t);return function(A){return Q(s(B,A)-g,A)}}"plural"===c||"selectordinal"===c?(a={},Object.keys(A[3]).forEach((function(e){a[e]=o(A[3][e],A,t,n,i)})),A=[A[0],A[1],A[2],a]):A[2]&&"object"==typeof A[2]&&(a={},Object.keys(A[2]).forEach((function(e){a[e]=o(A[2][e],A,t,n,i)})),A=[A[0],A[1],a]);var u=c&&(n[c]||E[c]);if(u){var l=u(A,t);return function(A){return l(s(B,A),A)}}return i?function(A){return String(s(B,A))}:function(A){return s(B,A)}}(A,e,t,n,i)}));return i?1===r.length?r[0]:function(A){for(var e="",t=0;t<r.length;++t)e+=r[t](A);return e}:function(A){return r.reduce((function(e,t){return e.concat(t(A))}),[])}}function s(A,e){if(e&&A in e)return e[A];for(var t=A.split("."),n=e,i=0,r=t.length;n&&i<r;++i)n=n[t[i]];return n}function a(A,e){var t=A[2],i=n.number[t]||n.parseNumberPattern(t)||n.number.default;return new Intl.NumberFormat(e,i).format}function B(A,e){var t=A[1],i=A[2],r=n[t][i]||n.parseDatePattern(i)||n[t].default;return new Intl.DateTimeFormat(e,r).format}function c(A,e){var t,n="selectordinal"===A[1]?"ordinal":"cardinal",o=A[2],s=A[3];if(Intl.PluralRules&&Intl.PluralRules.supportedLocalesOf(e).length>0)t=new Intl.PluralRules(e,{type:n});else{var a=i(e,r),B=a&&r[a][n]||g;t={select:B}}return function(A,e){return(s["="+ +A]||s[t.select(A-o)]||s.other)(e)}}function g(){return"other"}(e=A.exports=function(A,e,t){return o(A,null,e||"en",t||{},!0)}).toParts=function(A,e,t){return o(A,null,e||"en",t||{},!1)};var E={number:a,ordinal:a,spellout:a,duration:function(A,e){var t=A[2],i=n.duration[t]||n.duration.default,r=new Intl.NumberFormat(e,i.seconds).format,o=new Intl.NumberFormat(e,i.minutes).format,s=new Intl.NumberFormat(e,i.hours).format,a=/^fi$|^fi-|^da/.test(String(e))?".":":";return function(A,e){if(A=+A,!isFinite(A))return r(A);var t=~~(A/60/60),n=~~(A/60%60),i=(t?s(Math.abs(t))+a:"")+o(Math.abs(n))+a+r(Math.abs(A%60));return A<0?s(-1).replace(s(1),i):i}},date:B,time:B,plural:c,selectordinal:c,select:function(A,e){var t=A[2];return function(A,e){return(t[A]||t.other)(e)}}};e.types=E},function(A,e){A.exports=class{getSandboxMode(A){return Promise.resolve("worker")}canLoadExtensionFromProject(A){return Promise.resolve(!1)}rewriteExtensionURL(A){return Promise.resolve(A)}canFetch(A){return Promise.resolve(!0)}canOpenWindow(A){return Promise.resolve(!0)}canRedirect(A){return Promise.resolve(!0)}canRecordAudio(){return Promise.resolve(!0)}canRecordVideo(){return Promise.resolve(!0)}canReadClipboard(){return Promise.resolve(!0)}canNotify(){return Promise.resolve(!0)}canGeolocate(){return Promise.resolve(!0)}canEmbed(A){return Promise.resolve(!0)}canUnsandbox(){return Promise.resolve(!1)}canScreenshotCamera(){return Promise.resolve(!0)}canDownload(A,e){return Promise.resolve(!0)}shouldUseLocal(A){return Promise.resolve(!confirm("it seems that the extension ".concat(A," has been updated, use the up-to-date code?")))}}},function(A,e,t){},function(A,e,t){function n(A,e){var t=Object.keys(A);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(A);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(A,e).enumerable}))),t.push.apply(t,n)}return t}function i(A){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?n(Object(t),!0).forEach((function(e){r(A,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(t)):n(Object(t)).forEach((function(e){Object.defineProperty(A,e,Object.getOwnPropertyDescriptor(t,e))}))}return A}function r(A,e,t){return(e=function(A){var e=function(A,e){if("object"!=typeof A||!A)return A;var t=A[Symbol.toPrimitive];if(void 0!==t){var n=t.call(A,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(A)}(A,"string");return"symbol"==typeof e?e:e+""}(e))in A?Object.defineProperty(A,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):A[e]=t,A}const o=t(3),s=t(1),a=t(15),B=t(2),c=t(7),g=t(8),{translateForCamera:E}=t(41),Q=t(4),u=t(6),l=t(5),w=t(16),h="color",C="saturation",I="brightness",M="transparency",d="front",m="back",p="on",F="off",D={front:w.PEN_LAYER,back:w.SPRITE_LAYER};class Y{constructor(A){this.runtime=A,this._penDrawableId=-1,this._penSkinId=-1,this.printTextAttribute={weight:"400",italic:!1,size:"28",font:"Arial",color:"#000000",strokeColor:"#000000",strokeWidth:0},this._onTargetCreated=this._onTargetCreated.bind(this),this._onTargetMoved=this._onTargetMoved.bind(this),this._onCameraMoved=this._onCameraMoved.bind(this),A.on("targetWasCreated",this._onTargetCreated),A.on("RUNTIME_DISPOSED",this.clear.bind(this)),this.preloadedImages={},this.cameraBound=-1}static get DEFAULT_PEN_STATE(){return{penDown:!1,color:66.66,saturation:100,brightness:100,transparency:0,_shade:50,penAttributes:{color4f:[0,0,1,1],diameter:1}}}static get PEN_SIZE_RANGE(){return{min:1,max:1e308}}static get STATE_KEY(){return"Scratch.pen"}_clampPenSize(A){return this.runtime.renderer&&this.runtime.renderer.useHighQualityRender||!this.runtime.runtimeOptions.miscLimits?Math.max(0,A):u.clamp(A,Y.PEN_SIZE_RANGE.min,Y.PEN_SIZE_RANGE.max)}_getPenLayerID(){return this._penSkinId<0&&this.runtime.renderer&&(this._penSkinId=this.runtime.renderer.createPenSkin(),this._penDrawableId=this.runtime.renderer.createDrawable(w.PEN_LAYER),this.runtime.renderer.updateDrawableSkinId(this._penDrawableId,this._penSkinId),this.bitmapCanvas=document.createElement("canvas"),this.bitmapCanvas.width=this.runtime.stageWidth,this.bitmapCanvas.height=this.runtime.stageHeight,this.bitmapSkinID=this.runtime.renderer.createBitmapSkin(this.bitmapCanvas,1),this.bitmapDrawableID=this.runtime.renderer.createDrawable(w.PEN_LAYER),this.runtime.renderer.updateDrawableSkinId(this.bitmapDrawableID,this.bitmapSkinID),this.runtime.renderer.updateDrawableVisible(this.bitmapDrawableID,!1)),this._penSkinId}_getPenState(A){let e=A._customState["Scratch.pen"];return e||(e=c.simple(Y.DEFAULT_PEN_STATE),A.setCustomState(Y.STATE_KEY,e)),e}_onTargetCreated(A,e){if(e){const t=e.getCustomState(Y.STATE_KEY);t&&(A.setCustomState(Y.STATE_KEY,c.simple(t)),t.penDown&&(A.onTargetMoved=this._onTargetMoved))}}_onTargetMoved(A,e,t,n){if(!n){const n=this._getPenLayerID();if(n>=0){const i=this._getPenState(A),[r,o]=A._translatePossitionToCamera();A.cameraBound>=0&&([e,t]=E(this.runtime,A.cameraBound,e,t)),this.runtime.renderer.penLine(n,i.penAttributes,e,t,r,o),this.runtime.requestRedraw()}}}_onCameraMoved(A){if(A!==this.cameraBound)return;const e=this.runtime.cameraStates[A],t=this._getPenLayerID();t>=0&&this.runtime.renderer.penTranslate(t,...e.pos,e.scale,e.dir),this.runtime.requestRedraw()}bindToCamera(A){this.cameraBound=A,this._onCameraMoved()}removeCameraBinding(){this.cameraBound=-1;const A=this._getPenLayerID();A>=0&&this.runtime.renderer.penTranslate(A,0,0,1,0)}_wrapColor(A){return u.wrapClamp(A,0,100)}_initColorParam(){return[{text:Q({id:"pen.colorMenu.color",default:"color",description:"label for color element in color picker for pen extension"}),value:h},{text:Q({id:"pen.colorMenu.saturation",default:"saturation",description:"label for saturation element in color picker for pen extension"}),value:C},{text:Q({id:"pen.colorMenu.brightness",default:"brightness",description:"label for brightness element in color picker for pen extension"}),value:I},{text:Q({id:"pen.colorMenu.transparency",default:"transparency",description:"label for transparency element in color picker for pen extension"}),value:M}]}getLayerParam(){return[{text:Q({id:"pen.layerMenu.front",default:"front",description:"label for front"}),value:d},{text:Q({id:"pen.layerMenu.back",default:"back",description:"label for back"}),value:m}]}getItalicsToggleParam(){return[{text:Q({id:"pen.italicsToggle.on",default:"on",description:"label for on"}),value:p},{text:Q({id:"pen.italicsToggle.off",default:"off",description:"label for off"}),value:F}]}_clampColorParam(A){return u.clamp(A,0,100)}_alphaToTransparency(A){return 100*(1-A)}_transparencyToAlpha(A){return 1-A/100}_getFonts(){return[{text:"Sans Serif",value:"Sans Serif"},{text:"Serif",value:"Serif"},{text:"Handwriting",value:"Handwriting"},{text:"Marker",value:"Marker"},{text:"Curly",value:"Curly"},{text:"Pixel",value:"Pixel"},{text:"Playful",value:"Playful"},{text:"Bubbly",value:"Bubbly"},{text:"Arcade",value:"Arcade"},{text:"Bits and Bytes",value:"Bits and Bytes"},{text:"Technological",value:"Technological"},{text:"Scratch",value:"Scratch"},{text:"Archivo",value:"Archivo"},{text:"Archivo Black",value:"Archivo Black"},...this.runtime.fontManager.getFonts().map(A=>({text:A.name,value:A.family})),{text:"random font",value:"Random"}]}getInfo(){return{id:"pen",name:Q({id:"pen.categoryName",default:"Pen",description:"Label for the pen extension category"}),blockIconURI:"",blocks:[{blockType:s.LABEL,text:Q({id:"pm.pen.stageSelected",default:"Stage selected: less pen blocks",description:"Label that appears in the Pen category when the stage is selected"}),filter:[a.STAGE]},{opcode:"clear",blockType:s.COMMAND,text:Q({id:"pen.clear",default:"erase all",description:"erase all pen trails and stamps"})},{opcode:"stamp",blockType:s.COMMAND,text:Q({id:"pen.stamp",default:"stamp",description:"render current costume on the background"}),filter:[a.SPRITE]},{opcode:"penDown",blockType:s.COMMAND,text:Q({id:"pen.penDown",default:"pen down",description:"start leaving a trail when the sprite moves"}),filter:[a.SPRITE]},{opcode:"penUp",blockType:s.COMMAND,text:Q({id:"pen.penUp",default:"pen up",description:"stop leaving a trail behind the sprite"}),filter:[a.SPRITE]},{opcode:"setPenColorToColor",blockType:s.COMMAND,text:Q({id:"pen.setColor",default:"set pen color to [COLOR]",description:"set the pen color to a particular (RGB) value"}),arguments:{COLOR:{type:o.COLOR}},filter:[a.SPRITE]},{opcode:"changePenColorParamBy",blockType:s.COMMAND,text:Q({id:"pen.changeColorParam",default:"change pen [COLOR_PARAM] by [VALUE]",description:"change the state of a pen color parameter"}),arguments:{COLOR_PARAM:{type:o.STRING,menu:"colorParam",defaultValue:h},VALUE:{type:o.NUMBER,defaultValue:10}},filter:[a.SPRITE]},{opcode:"setPenColorParamTo",blockType:s.COMMAND,text:Q({id:"pen.setColorParam",default:"set pen [COLOR_PARAM] to [VALUE]",description:"set the state for a pen color parameter e.g. saturation"}),arguments:{COLOR_PARAM:{type:o.STRING,menu:"colorParam",defaultValue:h},VALUE:{type:o.NUMBER,defaultValue:50}},filter:[a.SPRITE]},{opcode:"changePenSizeBy",blockType:s.COMMAND,text:Q({id:"pen.changeSize",default:"change pen size by [SIZE]",description:"change the diameter of the trail left by a sprite"}),arguments:{SIZE:{type:o.NUMBER,defaultValue:1}},filter:[a.SPRITE]},{opcode:"setPenSizeTo",blockType:s.COMMAND,text:Q({id:"pen.setSize",default:"set pen size to [SIZE]",description:"set the diameter of a trail left by a sprite"}),arguments:{SIZE:{type:o.NUMBER,defaultValue:1}},filter:[a.SPRITE]},"---",{opcode:"drawRect",blockType:s.COMMAND,text:Q({id:"pen.drawRect",default:"use [COLOR] to draw a square on x:[X] y:[Y] width:[WIDTH] height:[HEIGHT]",description:"draw a square"}),arguments:{COLOR:{type:o.COLOR},X:{type:o.NUMBER,defaultValue:0},Y:{type:o.NUMBER,defaultValue:0},WIDTH:{type:o.NUMBER,defaultValue:10},HEIGHT:{type:o.NUMBER,defaultValue:10}}},{opcode:"drawArrayComplexShape",blockType:s.COMMAND,text:"draw polygon from points [SHAPE] with fill [COLOR]",arguments:{SHAPE:{type:o.STRING,defaultValue:"[-20, 20, 20, 20, 0, -20]"},COLOR:{type:o.COLOR}},hideFromPalette:!1},"---",{opcode:"preloadUriImage",blockType:s.COMMAND,text:"preload image [URI] as [NAME]",arguments:{URI:{type:o.STRING,defaultValue:"data:image/png;base64,"},NAME:{type:o.STRING,defaultValue:"preloaded image"}}},{opcode:"unloadUriImage",blockType:s.COMMAND,text:"unload image [NAME]",arguments:{NAME:{type:o.STRING,defaultValue:"preloaded image"}}},{opcode:"drawUriImage",blockType:s.COMMAND,text:Q({id:"pen.drawUriImage",default:"draw image [URI] at x:[X] y:[Y]",description:"draw image"}),arguments:{URI:{type:o.STRING,defaultValue:"data:image/png;base64,"},X:{type:o.NUMBER,defaultValue:0},Y:{type:o.NUMBER,defaultValue:0}}},{opcode:"drawUriImageWHR",blockType:s.COMMAND,text:Q({id:"pen.drawUriImageWHR",default:"draw image [URI] at x:[X] y:[Y] width:[WIDTH] height:[HEIGHT] pointed at: [ROTATE]",description:"draw image width height rotation"}),arguments:{URI:{type:o.STRING,defaultValue:"data:image/png;base64,"},X:{type:o.NUMBER,defaultValue:0},Y:{type:o.NUMBER,defaultValue:0},WIDTH:{type:o.NUMBER,defaultValue:64},HEIGHT:{type:o.NUMBER,defaultValue:64},ROTATE:{type:o.ANGLE,defaultValue:90}}},{opcode:"drawUriImageWHCX1Y1X2Y2R",blockType:s.COMMAND,text:"draw image [URI] at x:[X] y:[Y] width:[WIDTH] height:[HEIGHT] cropping from x:[CROPX] y:[CROPY] width:[CROPW] height:[CROPH] pointed at: [ROTATE]",arguments:{URI:{type:o.STRING,defaultValue:"data:image/png;base64,"},X:{type:o.NUMBER,defaultValue:0},Y:{type:o.NUMBER,defaultValue:0},WIDTH:{type:o.NUMBER,defaultValue:64},HEIGHT:{type:o.NUMBER,defaultValue:64},CROPX:{type:o.NUMBER,defaultValue:0},CROPY:{type:o.NUMBER,defaultValue:0},CROPW:{type:o.NUMBER,defaultValue:100},CROPH:{type:o.NUMBER,defaultValue:100},ROTATE:{type:o.ANGLE,defaultValue:90}}},"---",{opcode:"printText",blockType:s.COMMAND,text:Q({id:"pen.printText",default:"print [TEXT] on x:[X] y:[Y]",description:"print text"}),arguments:{TEXT:{type:o.STRING,defaultValue:"Foobars are yummy"},X:{type:o.NUMBER,defaultValue:0},Y:{type:o.NUMBER,defaultValue:0}}},{opcode:"setPrintFont",blockType:s.COMMAND,text:Q({id:"pen.setPrintFont",default:"set print font to [FONT]",description:"set print font"}),arguments:{FONT:{type:o.STRING,defaultValue:"Arial",menu:"FONT"}}},{opcode:"setPrintFontSize",blockType:s.COMMAND,text:Q({id:"pen.setPrintFontSize",default:"set print font size to [SIZE]",description:"set print font size"}),arguments:{SIZE:{type:o.NUMBER,defaultValue:24}}},{opcode:"setPrintFontColor",blockType:s.COMMAND,text:Q({id:"pen.setPrintFontColor",default:"set print font color to [COLOR]",description:"set print font color"}),arguments:{COLOR:{type:o.COLOR}}},{opcode:"setPrintFontStrokeColor",blockType:s.COMMAND,text:Q({id:"pen.setPrintFontStrokeColor",default:"set print stroke color to [COLOR]",description:"set print stroke color"}),arguments:{COLOR:{type:o.COLOR}}},{opcode:"setPrintFontStrokeWidth",blockType:s.COMMAND,text:Q({id:"pen.setPrintFontStrokeWidth",default:"set print stroke width to [WIDTH]",description:"set print stroke width"}),arguments:{WIDTH:{type:o.NUMBER,defaultValue:0}}},{opcode:"setPrintFontWeight",blockType:s.COMMAND,text:Q({id:"pen.setPrintFontWeight",default:"set print font weight to [WEIGHT]",description:"set print font weight"}),arguments:{WEIGHT:{type:o.NUMBER,defaultValue:700}}},{opcode:"setPrintFontItalics",blockType:s.COMMAND,text:Q({id:"pen.setPrintFontItalics",default:"turn print font italics [OPTION]",description:"toggle print font italics"}),arguments:{OPTION:{type:o.STRING,menu:"italicsToggleParam",defaultValue:p}}},{opcode:"drawComplexShape",blockType:s.COMMAND,text:"draw triangle [SHAPE] with fill [COLOR]",arguments:{SHAPE:{type:o.POLYGON,nodes:3},COLOR:{type:o.COLOR}},hideFromPalette:!0},{opcode:"draw4SidedComplexShape",blockType:s.COMMAND,text:"draw quadrilateral [SHAPE] with fill [COLOR]",arguments:{SHAPE:{type:o.POLYGON,nodes:4},COLOR:{type:o.COLOR}},hideFromPalette:!0},{opcode:"setPenShadeToNumber",blockType:s.COMMAND,text:Q({id:"pen.setShade",default:"LEGACY - set pen shade to [SHADE]",description:"legacy pen blocks - set pen shade"}),arguments:{SHADE:{type:o.NUMBER,defaultValue:1}},hideFromPalette:!0},{opcode:"changePenShadeBy",blockType:s.COMMAND,text:Q({id:"pen.changeShade",default:"LEGACY - change pen shade by [SHADE]",description:"legacy pen blocks - change pen shade"}),arguments:{SHADE:{type:o.NUMBER,defaultValue:1}},hideFromPalette:!0},{opcode:"setPenHueToNumber",blockType:s.COMMAND,text:Q({id:"pen.setHue",default:"LEGACY - set pen color to [HUE]",description:"legacy pen blocks - set pen color to number"}),arguments:{HUE:{type:o.NUMBER,defaultValue:1}},hideFromPalette:!0},{opcode:"changePenHueBy",blockType:s.COMMAND,text:Q({id:"pen.changeHue",default:"LEGACY - change pen color by [HUE]",description:"legacy pen blocks - change pen color"}),arguments:{HUE:{type:o.NUMBER,defaultValue:1}},hideFromPalette:!0},{opcode:"goPenLayer",blockType:s.COMMAND,hideFromPalette:!0,text:Q({id:"pen.GoPenLayer",default:"go to [OPTION] layer",description:"go to front layer(pen)"}),arguments:{OPTION:{type:o.STRING,menu:"layerParam",defaultValue:d}}}],menus:{colorParam:{acceptReporters:!0,items:this._initColorParam()},layerParam:{acceptReporters:!1,items:this.getLayerParam()},italicsToggleParam:{acceptReporters:!1,items:this.getItalicsToggleParam()},FONT:{items:"_getFonts",isTypeable:!0}}}}clear(){const A=this._getPenLayerID();A>=0&&(this.runtime.renderer.penClear(A),this.runtime.requestRedraw())}setPrintFont(A){this.printTextAttribute.font=A.FONT}setPrintFontSize(A){this.printTextAttribute.size=A.SIZE}setPrintFontColor(A){const e=B.toRgbColorObject(A.COLOR),t=g.rgbToHex(e);this.printTextAttribute.color=t}setPrintFontStrokeColor(A){const e=B.toRgbColorObject(A.COLOR),t=g.rgbToHex(e);this.printTextAttribute.strokeColor=t}setPrintFontStrokeWidth(A){this.printTextAttribute.strokeWidth=A.WIDTH}setPrintFontWeight(A){this.printTextAttribute.weight=A.WEIGHT}setPrintFontItalics(A){this.printTextAttribute.italic=A.OPTION===p}printText(A){const e=this._getBitmapCanvas();let t="";t+="".concat(this.printTextAttribute.italic?"italic ":""),t+="".concat(this.printTextAttribute.weight," "),t+="".concat(this.printTextAttribute.size,"px "),t+=this.printTextAttribute.font,e.font=t,e.strokeStyle=this.printTextAttribute.strokeWidth>0?this.printTextAttribute.strokeColor:this.printTextAttribute.color,e.lineWidth=this.printTextAttribute.strokeWidth,e.fillStyle=this.printTextAttribute.color,this.printTextAttribute.strokeWidth>0&&e.strokeText(A.TEXT,A.X,-A.Y),e.fillText(A.TEXT,A.X,-A.Y),this._drawContextToPen(e)}async _drawUriImage(A){var e;let{URI:t,X:n,Y:i,WIDTH:r,HEIGHT:o,ROTATE:s,CROPX:a,CROPY:B,CROPW:c,CROPH:g}=A;const E=null!==(e=this.preloadedImages[t])&&void 0!==e?e:await new Promise((A,e)=>{const n=new Image;n.onload=()=>A(n),n.onerror=A=>{console.error("failed to load",t,A),e("Image failed to load")},n.src=t});if(!E.complete)throw new Error("the provided image never loaded");if(E.width<=0)throw new Error("the image has an invalid width of ".concat(E.width));if(E.height<=0)throw new Error("the image has an invalid height of ".concat(E.height));const Q=this._getBitmapCanvas();if(Q.canvas.width<=0&&Q.canvas.height<=0)return;Q.rotate(u.degToRad(s-90));const l=null!=r?r:E.width,w=null!=o?o:E.height,h=[a,B,c,g,n-l/2,-i-w/2,l,w];"number"==typeof a&&"number"==typeof B&&g&&g||h.splice(0,4),Q.drawImage(E,...h),this._drawContextToPen(Q)}drawUriImage(A){const e=this.preloadedImages[A.URI],t=this._drawUriImage(A);if(!e)return t}drawUriImageWHR(A){const e=this.preloadedImages[A.URI],t=this._drawUriImage(A);if(!e)return t}drawUriImageWHCX1Y1X2Y2R(A){const e=this.preloadedImages[A.URI],t=this._drawUriImage(A);if(!e)return t}preloadUriImage(A){let{URI:e,NAME:t}=A;return new Promise(A=>{const n=new Image;n.crossOrigin="anonymous",n.onload=()=>{this.preloadedImages[B.toString(t)]=n,A()},n.onerror=A,n.src=B.toString(e)})}unloadUriImage(A){let{NAME:e}=A;const t=B.toString(e);this.preloadedImages.hasOwnProperty(t)&&(this.preloadedImages[t].remove(),delete this.preloadedImages[t])}drawRect(A){const e=this._getBitmapCanvas(),t=B.toRgbColorObject(A.COLOR),n=g.rgbToHex(t);e.fillStyle=n,e.strokeStyle=e.fillStyle,e.fillRect(A.X,-A.Y,A.WIDTH,A.HEIGHT),this._drawContextToPen(e)}_drawContextToPen(A){const e=this._getPenLayerID(),t=this.bitmapCanvas.width,n=this.bitmapCanvas.height;A.restore();const i=this.runtime.renderer._allSkins[this.bitmapSkinID],r=A.getImageData(0,0,t,n);i._setTexture(r),this.runtime.renderer.penStamp(e,this.bitmapDrawableID),this.runtime.requestRedraw()}_getBitmapCanvas(){const A=this._getPenLayerID(),e=this.runtime.renderer._allSkins[A],t=e._size[0],n=e._size[1];this.bitmapCanvas.width=t,this.bitmapCanvas.height=n;const i=this.bitmapCanvas.getContext("2d");return i.clearRect(0,0,t,n),i.translate(t/2,n/2),i.scale(e.renderQuality,e.renderQuality),i}stamp(A,e){this._stamp(e.target)}_stamp(A){const e=this._getPenLayerID();e>=0&&(this.runtime.renderer.penStamp(e,A.drawableID),this.runtime.requestRedraw())}penDown(A,e){this._penDown(e.target)}_penDown(A){const e=this._getPenState(A);e.penDown||(e.penDown=!0,A.onTargetMoved=this._onTargetMoved);const t=this._getPenLayerID();t>=0&&(this.runtime.renderer.penPoint(t,e.penAttributes,A.x,A.y),this.runtime.requestRedraw())}penUp(A,e){this._penUp(e.target)}_penUp(A){const e=this._getPenState(A);e.penDown&&(e.penDown=!1,A.onTargetMoved=null)}setPenColorToColor(A,e){this._setPenColorToColor(A.COLOR,e.target)}_setPenColorToColor(A,e){const t=this._getPenState(e),n=B.toRgbColorObject(A),i=g.rgbToHsv(n);t.color=i.h/360*100,t.saturation=100*i.s,t.brightness=100*i.v,n.hasOwnProperty("a")?t.transparency=100*(1-n.a/255):t.transparency=0,t._shade=t.brightness/2,this._updatePenColor(t)}_updatePenColor(A){const e=g.hsvToRgb({h:360*A.color/100,s:A.saturation/100,v:A.brightness/100});A.penAttributes.color4f[0]=e.r/255,A.penAttributes.color4f[1]=e.g/255,A.penAttributes.color4f[2]=e.b/255,A.penAttributes.color4f[3]=this._transparencyToAlpha(A.transparency)}_setOrChangeColorParam(A,e,t,n){switch(A){case h:t.color=this._wrapColor(e+(n?t.color:0));break;case C:t.saturation=this._clampColorParam(e+(n?t.saturation:0));break;case I:t.brightness=this._clampColorParam(e+(n?t.brightness:0));break;case M:t.transparency=this._clampColorParam(e+(n?t.transparency:0));break;default:l.warn("Tried to set or change unknown color parameter: ".concat(A))}this._updatePenColor(t)}changePenColorParamBy(A,e){const t=this._getPenState(e.target);this._setOrChangeColorParam(A.COLOR_PARAM,B.toNumber(A.VALUE),t,!0)}setPenColorParamTo(A,e){const t=this._getPenState(e.target);this._setOrChangeColorParam(A.COLOR_PARAM,B.toNumber(A.VALUE),t,!1)}changePenSizeBy(A,e){this._changePenSizeBy(B.toNumber(A.SIZE),e.target)}_changePenSizeBy(A,e){const t=this._getPenState(e).penAttributes;t.diameter=this._clampPenSize(t.diameter+A)}setPenSizeTo(A,e){this._setPenSizeTo(B.toNumber(A.SIZE),e.target)}_setPenSizeTo(A,e){this._getPenState(e).penAttributes.diameter=this._clampPenSize(A)}setPenHueToNumber(A,e){this._setPenHueToNumber(B.toNumber(A.HUE),e.target)}_setPenHueToNumber(A,e){const t=this._getPenState(e),n=A/2;this._setOrChangeColorParam(h,n,t,!1),this._setOrChangeColorParam(M,0,t,!1),this._legacyUpdatePenColor(t)}changePenHueBy(A,e){this._changePenHueBy(B.toNumber(A.HUE),e.target)}_changePenHueBy(A,e){const t=this._getPenState(e),n=A/2;this._setOrChangeColorParam(h,n,t,!0),this._legacyUpdatePenColor(t)}setPenShadeToNumber(A,e){this._setPenShadeToNumber(B.toNumber(A.SHADE),e.target)}_setPenShadeToNumber(A,e){const t=this._getPenState(e);let n=B.toNumber(A);n%=200,n<0&&(n+=200),t._shade=n,this._legacyUpdatePenColor(t)}changePenShadeBy(A,e){this._changePenShadeBy(A.SHADE,e.target)}_changePenShadeBy(A,e){const t=this._getPenState(e),n=B.toNumber(A);this._setPenShadeToNumber(t._shade+n,e)}_legacyUpdatePenColor(A){let e=g.hsvToRgb({h:360*A.color/100,s:1,v:1});const t=A._shade>100?200-A._shade:A._shade;e=t<50?g.mixRgb(g.RGB_BLACK,e,(10+t)/60):g.mixRgb(e,g.RGB_WHITE,(t-50)/60);const n=g.rgbToHsv(e);A.color=100*n.h/360,A.saturation=100*n.s,A.brightness=100*n.v,this._updatePenColor(A)}goPenLayer(A){this._getPenLayerID(),this._penDrawableId&&this.runtime.renderer._groupOrdering.at(-1)!==D[A.OPTION]&&(A.OPTION===d?(console.log("setting the layer order to",w.LAYER_GROUPS_PEN),this.runtime.renderer.setLayerGroupOrdering(w.LAYER_GROUPS_PEN),this._penDrawableId=this.runtime.renderer.setDrawableOrder(this._penDrawableId,1/0,w.PEN_LAYER)):(console.log("setting the layer order to",w.LAYER_GROUPS),this.runtime.renderer.setLayerGroupOrdering(w.LAYER_GROUPS),this._penDrawableId=this.runtime.renderer.setDrawableOrder(this._penDrawableId,-1/0,w.PEN_LAYER)))}_getPenColor(A){const e={},t=this._getPenState(A);return e.r=255*t.penAttributes.color4f[0],e.g=255*t.penAttributes.color4f[1],e.b=255*t.penAttributes.color4f[2],e.a=this._alphaToTransparency(t.penAttributes.color4f[3]),g.rgbToHex(e)}drawComplexShape(A,e){const t=e.target,n=this._getPenState(t),i=n.penAttributes,r=this._getPenColor(e.target),o=A.SHAPE,s=o.at(-1),a=this._getBitmapCanvas(),c=B.toRgbColorObject(A.COLOR),E=g.rgbToHex(c);a.fillStyle=E,a.strokeStyle=r,a.lineWidth=i.diameter,a.beginPath(),a.moveTo(s.x,-s.y);for(const A of o)a.lineTo(A.x,-A.y);a.closePath(),n.penDown&&a.stroke(),a.fill(),this._drawContextToPen(a)}draw4SidedComplexShape(A,e){this.drawComplexShape(A,e)}drawArrayComplexShape(A,e){const t=(A=>{let e;try{e=JSON.parse(A)}catch(A){e=[]}return Array.isArray(e)?e:[]})(B.toString(A.SHAPE));if(t.length<=0)return;t.length%2!=0&&t.push(0);const n=[];let r={},o=!0;for(const A of t)o?(r.x=B.toNumber(A),o=!1):(r.y=B.toNumber(A),n.push(r),r={},o=!0);this.drawComplexShape(i(i({},A),{},{SHAPE:n}),e)}}A.exports=Y},function(A,e,t){},function(A,e,t){(function(A,e){!function(t){"use strict";var n,i="function"==typeof(n=t.atob)?n:"function"==typeof A?function(e){
//!! Deliberately using an API that's deprecated in node.js because
//!! this file is for browsers and we expect them to cope with it.
//!! Discussion: github.com/node-browser-compat/atob/pull/9
return new A(e,"base64").toString("binary")}:"object"==typeof t.base64js?function(A){var e=t.base64js.b64ToByteArray(A);return Array.prototype.map.call(e,(function(A){return String.fromCharCode(A)})).join("")}:function(){throw new Error("You're probably in an old browser or an iOS webworker. It might help to include beatgammit's base64-js.")};t.atob=i,e&&e.exports&&(e.exports=i)}(window)}).call(this,t(20).Buffer,t(89)(A))},function(A,e,t){(function(e){!function(){"use strict";A.exports=function(A){return(A instanceof e?A:e.from(A.toString(),"binary")).toString("base64")}}()}).call(this,t(20).Buffer)},function(A,e,t){},function(A,e,t){},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e){A.exports=null},function(A,e,t){},function(A,e,t){},function(A,e,t){},function(A,e,t){},function(A,e,t){const n=t(93),i=t(9),r=function(A,e,t,o){var s,a,B,c;A.attributes.id||(A.attributes.id={},A.attributes.id.value=i()),null!==(a=(s=A.attributes).x)&&void 0!==a||(s.x={}),null!==(c=(B=A.attributes).y)&&void 0!==c||(B.y={});const g={id:A.attributes.id.value,opcode:A.attributes.type.value,inputs:{},fields:{},next:null,topLevel:t,parent:o,shadow:"shadow"===A.tagName,x:A.attributes.x.value,y:A.attributes.y.value};e[g.id]=g;for(let t=0;t<A.children.length;t++){const o=A.children[t];let s=null,a=null;for(let A=0;A<o.children.length;A++){const e=o.children[A];if(!e.tagName)continue;const t=e.tagName;"block"===t?s=e:"shadow"===t&&(a=e)}switch(!s&&a&&(s=a),o.tagName){case"field":{var E,Q,u,l;const A=o.attributes.name.value;null!==(Q=(E=o.attributes).id)&&void 0!==Q||(E.id={value:i()});const e=o.attributes.id.value;let t="";t=o.innerHTML?o.textContent:"",g.fields[A]={name:A,id:e,value:t},null!==(l=(u=o.attributes).variabletype)&&void 0!==l||(u.variabletype={});const n=o.attributes.variabletype.value;"string"==typeof n&&(g.fields[A].variableType=n);break}case"comment":g.comment=o.attributes.id.value;break;case"value":case"statement":{r(s,e,!1,g.id),a&&s!==a&&r(a,e,!1,g.id);const A=o.attributes.name.value;g.inputs[A]={name:A,block:s.attributes.id.value,shadow:a?a.attributes.id.value:null};break}case"next":if(!s||!s.attributes)continue;r(s,e,!1,g.id),g.next=s.attributes.id.value;break;case"mutation":g.mutation=n(o)}}};A.exports=function(A){if("object"!=typeof A)return;if("object"!=typeof A.xml)return;return function(A){const e={};for(let t=0;t<A.length;t++){const n=A[t];if(!n.tagName||!n.attributes)continue;const i=n.tagName;"block"!==i&&"shadow"!==i||r(n,e,!0,null)}const t=[];for(const A in e)e.hasOwnProperty(A)&&t.push(e[A]);return t}((new DOMParser).parseFromString(A.xml.outerHTML,"application/xml").childNodes)}},function(A,e){let t=0;const n={},i="object"==typeof window&&window.performance;class r{constructor(A){this.id=-1,this.totalTime=0,this.selfTime=0,this.arg=null,this.depth=A,this.count=0}}class o{constructor(){let A=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};this.records=[],this.increments=[],this.counters=[],this.nullFrame=new r(-1),this._stack=[new r(0)],this.onFrame=A,this.START=0,this.STOP=1}start(A,e){this.records.push(0,A,e,i.now())}stop(){this.records.push(1,i.now())}increment(A){this.increments[A]||(this.increments[A]=new r(-1),this.increments[A].id=A),this.increments[A].count+=1}frame(A,e){for(let t=0;t<this.counters.length;t++)if(this.counters[t].id===A&&this.counters[t].arg===e)return this.counters[t];const t=new r(-1);return t.id=A,t.arg=e,this.counters.push(t),t}reportFrames(){const A=this._stack;let e=1;for(let t=0;t<this.records.length;)if(0===this.records[t]){e>=A.length&&A.push(new r(e));const n=A[e++];n.id=this.records[t+1],n.arg=this.records[t+2],n.totalTime=this.records[t+3],n.selfTime=0,t+=4}else{if(1!==this.records[t])throw this.records.length=0,new Error("Unable to decode Profiler records.");{const n=this.records[t+1],i=A[--e];i.totalTime=n-i.totalTime,i.selfTime+=i.totalTime,A[e-1].selfTime-=i.totalTime,i.count=1,this.onFrame(i),t+=2}}for(let A=0;A<this.increments.length;A++)this.increments[A]&&this.increments[A].count>0&&(this.onFrame(this.increments[A]),this.increments[A].count=0);for(let A=0;A<this.counters.length;A++)this.counters[A].count>0&&(this.onFrame(this.counters[A]),this.counters[A].count=0);this.records.length=0}idByName(A){return o.idByName(A)}nameById(A){return o.nameById(A)}static idByName(A){return"number"!=typeof n[A]&&(n[A]=t++),n[A]}static nameById(A){for(const e in n)if(n[e]===A)return e;return null}static available(){return"object"==typeof window&&void 0!==window.performance}}o.START=0,o.STOP=1,A.exports=o},function(A,e,t){const n=t(58),i=t(60);A.exports=A=>{const e=new n(A).generate(),t={},r=A.target,o=A=>{if(A.cachedCompileResult)return A.cachedCompileResult;const t=new i(A,e,r).compile();return A.cachedCompileResult=t,t},s=o(e.entry);for(const A of Object.keys(e.procedures)){const n=o(e.procedures[A]);t[A]=n}return{startingFunction:s,procedures:t,executableHat:e.entry.executableHat}}},function(A,e){A.exports={statementBlocks:["looks_hideallsprites","looks_say","looks_sayforsecs","looks_setstretchto","looks_switchbackdroptoandwait","looks_think","looks_thinkforsecs","motion_align_scene","motion_glidesecstoxy","motion_glideto","motion_goto","motion_pointtowards","motion_scroll_right","motion_scroll_up","sensing_askandwait","sensing_setdragmode","sound_changeeffectby","sound_changevolumeby","sound_cleareffects","sound_play","sound_playuntildone","sound_stop","sound_seteffectto","sound_setvolumeto","sound_stopallsounds","looks_setStretch","looks_changeStretch","data_reverselist","data_arraylist","control_switch","control_switch_default","control_case","control_exitCase","control_case_next","control_backToGreenFlag","looks_setHorizTransform","looks_setVertTransform","looks_layersSetLayer","control_waitsecondsoruntil","control_delete_clones_of","control_stop_sprite","looks_changeVisibilityOfSprite","looks_previouscostume","looks_previousbackdrop","motion_pointinrandomdirection","motion_move_sprite_to_scene_side","sound_playallsounds","looks_stoptalking","sensing_setclipboard","motion_movebacksteps","motion_moveupdownsteps","motion_turnrightaroundxy","motion_turnleftaroundxy","motion_turnaround","motion_pointinrandomdirection","motion_pointtowardsxy","motion_glidedirectionstepsinseconds","motion_changebyxy","motion_ifonspritebounce","motion_ifonxybounce","motion_move_sprite_to_scene_side","control_javascript_command","looks_changeVisibilityOfSpriteShow","looks_changeVisibilityOfSpriteHide","sound_pause","sound_set_stop_fadeout_to","sound_play_at_seconds","sound_play_at_seconds_until_done","sound_pauseallsounds","argument_reporter_command"],outputBlocks:["motion_xscroll","motion_yscroll","sensing_loud","sensing_loudness","sensing_userid","sound_volume","control_if_return_else_return","looks_stretchGetX","looks_stretchGetY","sensing_getspritewithattrib","sensing_thing_is_text","sensing_mobile","sensing_thing_is_number","sensing_regextest","operator_indexOfTextInText","operator_constrainnumber","operator_advMath","operator_advMathExpanded","operator_lerpFunc","operator_stringify","operator_newLine","operator_readLineInMultilineText","operator_getLettersFromIndexToIndexInText","operator_getLettersFromIndexToIndexInTextFixed","operator_replaceAll","operator_regexmatch","data_itemexistslist","data_listisempty","data_listarray","looks_sayHeight","looks_sayWidth","sensing_isUpperCase","operator_toUpperLowerCase","looks_getSpriteVisible","looks_getEffectValue","looks_layersGetLayer","sound_isSoundPlaying","sound_getEffectValue","sound_getLength","sensing_directionTo","sensing_distanceTo","operator_boolify","operator_tabCharacter","operator_character_to_code","operator_code_to_character","sensing_keyhit","sensing_mousescrolling","sensing_mouseclicked","sensing_thing_has_text","sensing_thing_has_number","sensing_objecttouchingobject","sensing_objecttouchingclonesprite","looks_getOtherSpriteVisible","operator_gtorequal","operator_ltorequal","operator_notequal","operator_join3","operator_replaceFirst","operator_lastIndexOfTextInText","operator_countAppearTimes","operator_textIncludesLetterFrom","operator_textStartsOrEndsWith","sensing_fingerdown","sensing_fingertapped","sensing_fingerx","sensing_fingery","sensing_getclipboard","sensing_getdragmode","sensing_getoperatingsystem","sensing_getbrowser","sensing_geturl","operator_javascript_output","operator_javascript_boolean","sensing_getxyoftouchingsprite","operator_nand","operator_nor","operator_xor","operator_xnor","looks_getinputofcostume","sound_getTimePosition","sound_getSoundVolume"]}},function(A,e){A.exports=class{constructor(A){if(0===A.trim().length)throw new Error("prefix cannot be empty");this.prefix=A,this.count=0}next(){return"".concat(this.prefix).concat(this.count++)}}},function(A,e,t){const n=t(59);A.exports=new class extends n{constructor(){super(),this._startedBranch=null}get stackFrame(){return this.thread.compatibilityStackFrame}startBranch(A,e,t){this._branchInfo&&t&&this._branchInfo.onEnd.push(t),this._startedBranch=[A,e]}startProcedure(A,e){if(!e)return this.thread.procedures[A]();if("object"!=typeof e)throw new Error('procedure arguments can only be of type undefined|object. instead got "'.concat(typeof e,'"'));let t="this.thread.procedures[proccode](";const n=[];for(const A in e)n.push(String(e[A]));return t+="".concat(n.join(","),")"),new Function("Procedure ".concat(A),t)()}init(A,e,t,n){this.thread=A,this.sequencer=A.target.runtime.sequencer,this._startedBranch=null,this._branchInfo=n,A.stack[0]=e,A.compatibilityStackFrame=t}}},function(A,e){A.exports={supportsNullishCoalescing:(()=>{try{new Function("undefined ?? 3");return!0}catch(A){return!1}})()}},function(A,e){A.exports={OUTPUT_SHAPE_HEXAGONAL:1,OUTPUT_SHAPE_ROUND:2,OUTPUT_SHAPE_SQUARE:3,OUTPUT_SHAPE_LEAF:4,OUTPUT_SHAPE_PLUS:5,OUTPUT_SHAPE_OCTAGONAL:6,OUTPUT_SHAPE_BUMPED:7,OUTPUT_SHAPE_INDENTED:8,OUTPUT_SHAPE_SCRAPPED:9,OUTPUT_SHAPE_ARROW:10,OUTPUT_SHAPE_TICKET:11}},function(A,e){A.exports=class{constructor(A){this._type=A,this._onOpen=null,this._onClose=null,this._onError=null,this._handleMessage=null,this._ws=null}open(){if(!(this._onOpen&&this._onClose&&this._onError&&this._handleMessage))throw new Error("Must set open, close, message and error handlers before calling open on the socket");let A;switch(this._type){case"BLE":A="scratch/ble";break;case"BT":A="scratch/bt";break;default:throw new Error("Unknown ScratchLink socket Type: ".concat(this._type))}const e=(A,e)=>{e.onopen=e.onerror=null,e.close(),this._ws=A,this._ws.onopen=this._onOpen,this._ws.onclose=this._onClose,this._ws.onerror=this._onError,this._ws.onmessage=this._onMessage.bind(this)},t=new WebSocket("ws://127.0.0.1:20111/".concat(A)),n=new WebSocket("wss://device-manager.scratch.mit.edu:20110/".concat(A)),i=setTimeout(()=>{e(t,n),this._ws.onerror(new Event("timeout"))},15e3);let r,o;t.onopen=A=>{clearTimeout(i),e(t,n),this._ws.onopen(A)},n.onopen=A=>{clearTimeout(i),e(n,t),this._ws.onopen(A)};const s=()=>{r&&o&&(clearTimeout(i),e(t,n),this._ws.onerror(r))};t.onerror=A=>{r=A,s()},n.onerror=A=>{o=A,s()}}close(){this.isOpen()&&(this._ws.close(),this._ws=null)}sendMessage(A){const e=JSON.stringify(A);this._ws.send(e)}setOnOpen(A){this._onOpen=A}setOnClose(A){this._onClose=A}setOnError(A){this._onError=A}setHandleMessage(A){this._handleMessage=A}isOpen(){return this._ws&&this._ws.readyState===this._ws.OPEN}_onMessage(A){const e=JSON.parse(A.data);this._handleMessage(e)}}},function(A,e,t){const n=t(27),i=t(228),r=t(10),o=t(5);A.exports=class extends n{constructor(A){super(),this.runtime=A,this.fonts=[]}isValidFamily(A){return/^[-\w ]+$/.test(A)}hasFont(A){return!!this.fonts.find(e=>e.family===A)}getSafeName(A){return A=A.replace(/[^-\w ]/g,""),r.unusedName(A,this.fonts.map(A=>A.family))}changed(){this.emit("change")}addSystemFont(A,e){if(!this.isValidFamily(A))throw new Error("Invalid family");this.fonts.push({system:!0,family:A,fallback:e}),this.changed()}addCustomFont(A,e,t){if(!this.isValidFamily(A))throw new Error("Invalid family");this.fonts.push({system:!1,family:A,fallback:e,asset:t}),this.updateRenderer(),this.changed()}getFonts(){return this.fonts.map(A=>({system:A.system,name:A.family,family:'"'.concat(A.family,'", ').concat(A.fallback),data:A.asset?A.asset.data:null,format:A.asset?A.asset.dataFormat:null}))}deleteFont(A){const[e]=this.fonts.splice(A,1);e.system||this.updateRenderer(),this.changed()}clear(){const A=this.fonts.some(A=>!A.system);this.fonts=[],A&&this.updateRenderer(),this.changed()}updateRenderer(){if(!this.runtime.renderer||!this.runtime.renderer.setCustomFonts)return;const A={};for(const e of this.fonts)if(!e.system){const t=e.asset.encodeDataURI(),n='@font-face { font-family: "'.concat(e.family,'"; src: url("').concat(t,'"); }');A['"'.concat(e.family,'", ').concat(e.fallback)]=n}this.runtime.renderer.setCustomFonts(A)}serializeJSON(){return 0===this.fonts.length?null:this.fonts.map(A=>{const e={system:A.system,family:A.family,fallback:A.fallback};if(!A.system){const t=A.asset;e.md5ext="".concat(t.assetId,".").concat(t.dataFormat)}return e})}serializeAssets(){return this.fonts.filter(A=>!A.system).map(A=>A.asset)}async deserialize(A,e,t){if(t||this.clear(),Array.isArray(A))for(const t of A)if(t&&"object"==typeof t)try{const A=t.system,n=t.family,r=t.fallback;if("boolean"!=typeof A||"string"!=typeof n||"string"!=typeof r||this.hasFont(n))continue;if(A)this.addSystemFont(n,r);else{const A=t.md5ext;if("string"!=typeof A)continue;const o=await i.getByMd5ext(this.runtime,e,this.runtime.storage.AssetType.Font,A);this.addCustomFont(n,r,o)}}catch(A){o.error("could not add font",A)}}}},function(A,e,t){const n=t(10);A.exports=class{static getByMd5ext(A,e,t,i){const r=A.storage,o=n.splitFirst(i,"."),s=o[0],a=o[1].toLowerCase();if(e){let n=e.file(i);if(!n){const A=new RegExp("^([^/]*/)?".concat(i,"$"));n=e.file(A)[0]}if(n)return n.async("uint8array").then(e=>A.storage.createAsset(t,a,e,s,!1))}return r.load(t,s,a)}}},function(A,e){class t{constructor(A,e,t,n,i){this.runtime=A,this.extensionId_=e,this.tabId_=t,this.element_=null,this.name=n,this.icon=i}setName(A){this.name=A,this.update()}setIcon(A){this.icon=A,this.update()}setDOM(A){this.element_=A,this.update()}update(){this.runtime.emit("EDITOR_TABS_UPDATE")}}A.exports=class{constructor(A){this.runtime=A,this.tabs_={}}register(A,e,n,i){const r="".concat(A,"_").concat(e);if(r in this.tabs_)return console.warn("Tab",e,"for",A,"already exists."),this.tabs_[r];const o=new t(this.runtime,A,e,n,i);return this.tabs_[r]=o,this.runtime.emit("EDITOR_TABS_NEW",o),o}}},function(A,e){function t(A,e){var t=Object.keys(A);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(A);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(A,e).enumerable}))),t.push.apply(t,n)}return t}function n(A){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?t(Object(n),!0).forEach((function(e){i(A,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach((function(e){Object.defineProperty(A,e,Object.getOwnPropertyDescriptor(n,e))}))}return A}function i(A,e,t){return(e=function(A){var e=function(A,e){if("object"!=typeof A||!A)return A;var t=A[Symbol.toPrimitive];if(void 0!==t){var n=t.call(A,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(A)}(A,"string");return"symbol"==typeof e?e:e+""}(e))in A?Object.defineProperty(A,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):A[e]=t,A}A.exports=class{constructor(A){this.runtime=A,this.modals={},this._updateId=0}updateModalComponents(){this._updateId++,this._updateId>1e6&&(this._updateId=0)}createModal(A,e){this.modals[A]=n(n({},e),{},{id:A}),this.updateModalComponents()}deleteModal(A){A in this.modals&&delete this.modals[A],this.updateModalComponents()}}},function(A,e,t){const n=t(18);A.exports=class{constructor(A){this._projectTimer=new n({now:()=>A.currentMSecs}),this._projectTimer.start(),this._paused=!1,this.runtime=A}projectTimer(){return this._projectTimer.timeElapsed()/1e3}pause(){this._paused=!0,this._projectTimer.pause()}resume(){this._paused=!1,this._projectTimer.play()}resetProjectTimer(){this._projectTimer.start()}}},function(A,e,t){const n=t(19),i=t(5);A.exports=class{constructor(A){this.provider=null,this.runtime=A,this.stage=null}setProvider(A){this.provider=A}setStage(A){this.stage=A}postData(A){A.varUpdate&&this.updateCloudVariable(A.varUpdate)}requestCreateVariable(A){this.runtime.canAddCloudVariable()&&this.provider&&this.provider.createVariable(A.name,A.value)}requestUpdateVariable(A,e){this.provider&&this.provider.updateVariable(A,e)}requestRenameVariable(A,e){this.provider&&this.provider.renameVariable(A,e)}requestDeleteVariable(A){this.provider&&this.provider.deleteVariable(A)}updateCloudVariable(A){const e=A.name,t=this.stage.lookupVariableByNameAndType(e,n.SCALAR_TYPE);t&&t.isCloud?t.value=A.value:i.warn("Received an update for a cloud variable that does not exist: ".concat(e))}clear(){this.provider&&(this.provider.requestCloseConnection(),this.provider=null,this.stage=null)}}},function(A,e,t){const n=t(2),i={SPACE:"space",LEFT:"left arrow",UP:"up arrow",RIGHT:"right arrow",DOWN:"down arrow",ENTER:"enter",BACKSPACE:"backspace",DELETE:"delete",SHIFT:"shift",CAPS_LOCK:"caps lock",SCROLL_LOCK:"scroll lock",CONTROL:"control",ESCAPE:"escape",INSERT:"insert",HOME:"home",END:"end",PAGE_UP:"page up",PAGE_DOWN:"page down"},r=new Set(Object.values(i));A.exports=class{constructor(A){this._keysPressed=[],this._keysHit=[],this._keysHitOnStep={},this._keyTimestamps={},this.runtime=A,this.lastKeyPressed="",this._numeralKeyCodesToStringKey=new Map,this.runtime.on("RUNTIME_STEP_END",()=>{const A=[];for(const e of this._keysHit){const t=this._keysHitOnStep[e]||-1;this.runtime.frameLoop._stepCounter<=t&&A.push(e)}this._keysHit=A})}_keyStringToScratchKey(A){switch(A=n.toString(A)){case" ":return i.SPACE;case"ArrowLeft":case"Left":return i.LEFT;case"ArrowUp":case"Up":return i.UP;case"Right":case"ArrowRight":return i.RIGHT;case"Down":case"ArrowDown":return i.DOWN;case"Enter":return i.ENTER;case"Backspace":return i.BACKSPACE;case"Delete":return i.DELETE;case"Shift":return i.SHIFT;case"CapsLock":return i.CAPS_LOCK;case"ScrollLock":return i.SCROLL_LOCK;case"Control":return i.CONTROL;case"Escape":return i.ESCAPE;case"Insert":return i.INSERT;case"Home":return i.HOME;case"End":return i.END;case"PageUp":return i.PAGE_UP;case"PageDown":return i.PAGE_DOWN}return A.length>1?"":A}_keyArgToScratchKey(A){if("number"==typeof A){if(A>=48&&A<=90)return String.fromCharCode(A);switch(A){case 32:return i.SPACE;case 37:return i.LEFT;case 38:return i.UP;case 39:return i.RIGHT;case 40:return i.DOWN}}return(A=n.toString(A)).length>1&&r.has(A)?A:(A.length>1&&(A=A[0])," "===A?i.SPACE:"\r"===A?i.ENTER:""===A?i.ESCAPE:A.toUpperCase())}postData(A){if(!A.key)return;const e=this._keyStringToScratchKey(A.key),t=1===e.length?e.toUpperCase():e;if(""===t)return;const n=this._keysPressed.indexOf(t);if(A.isDown?(this.lastKeyPressed=e,this.runtime.emit("KEY_PRESSED",t),n<0&&(this.runtime.emit("KEY_HIT",t),this._keysPressed.push(t),this._keyTimestamps[t]=Date.now(),this._keysHit.push(t),this._keysHitOnStep[t]=this.runtime.frameLoop._stepCounter)):n>-1&&(this._keysPressed.splice(n,1),t in this._keyTimestamps&&delete this._keyTimestamps[t]),A.hasOwnProperty("keyCode")){const e=A.keyCode;if(this._numeralKeyCodesToStringKey.has(e)){const A=this._numeralKeyCodesToStringKey.get(e);if(A!==t){const e=this._keysPressed.indexOf(A);-1!==e&&(this._keysPressed.splice(e,1),t in this._keyTimestamps&&delete this._keyTimestamps[A])}}this._numeralKeyCodesToStringKey.set(e,t)}}getKeyIsDown(A){if("any"===A)return this._keysPressed.length>0;const e=this._keyArgToScratchKey(A);return this._keysPressed.indexOf(e)>-1}getKeyIsHit(A){if("any"===A)return this._keysHit.length>0;const e=this._keyArgToScratchKey(A);return this._keysHit.indexOf(e)>-1}getLastKeyPressed(){return this.lastKeyPressed}getAllKeysPressed(){return this._keysPressed}getKeyTimestamp(A){if("any"===A){let A=1/0,e=!1;for(const t in this._keyTimestamps){const n=this._keyTimestamps[t];n<A&&(A=n,e=!0)}return e?A:0}const e=this._keyArgToScratchKey(A);return e in this._keyTimestamps?this._keyTimestamps[e]:0}getKeyTimestamps(){return this._keyTimestamps}}},function(A,e,t){const n=t(6),{translateScreenPos:i}=t(41),r=A=>Math.round(1e3*A)/1e3;A.exports=class{constructor(A){this._clientX=0,this._clientY=0,this._scratchX=0,this._scratchY=0,this._buttons=new Set,this._isDown=!1,this.usesRightClickDown=!1,this._isClicked=!1,this._clickOnStep=-1,this.runtime=A,this.cameraBound=null,this.runtime.on("RUNTIME_STEP_END",()=>{this.runtime.frameLoop._stepCounter>this._clickOnStep&&(this._isClicked=!1)})}bindToCamera(A){this.cameraBound=A}removeCameraBinding(){this.cameraBound=null}_activateClickHats(A){this.runtime.startHats("event_whenthisspriteclicked",null,A),this.runtime.startHats("event_whenstageclicked",null,A),A.isStage?this.runtime.startHats("pmEventsExpansion_whenSpriteClicked",{SPRITE:"_stage_"}):A.sprite&&this.runtime.startHats("pmEventsExpansion_whenSpriteClicked",{SPRITE:A.sprite.name})}_pickTarget(A,e){if(this.runtime.renderer){const t=this.runtime.renderer.pick(A,e);for(let A=0;A<this.runtime.targets.length;A++){const e=this.runtime.targets[A];if(e.hasOwnProperty("drawableID")&&e.drawableID===t)return e}}return this.runtime.getTargetForStage()}postData(A){if("number"==typeof A.x&&(this._clientX=A.x,this._scratchX=n.clamp(this.runtime.stageWidth*(A.x/A.canvasWidth-.5),-this.runtime.stageWidth/2,this.runtime.stageWidth/2)),"number"==typeof A.y&&(this._clientY=A.y,this._scratchY=n.clamp(-this.runtime.stageHeight*(A.y/A.canvasHeight-.5),-this.runtime.stageHeight/2,this.runtime.stageHeight/2)),void 0!==A.isDown){const e=void 0===A.button?0:A.button;A.isDown?this._buttons.add(e):this._buttons.delete(e);const t=this._isDown;if(this._isDown=A.isDown,A.isDown&&(this._isClicked=!0,this._clickOnStep=this.runtime.frameLoop._stepCounter),t===this._isDown)return;if(A.wasDragged)return;if(!(A.x>0&&A.x<A.canvasWidth&&A.y>0&&A.y<A.canvasHeight))return;const n=this._pickTarget(A.x,A.y),i=!t&&this._isDown,r=t&&!this._isDown;(n.draggable&&r||!n.draggable&&i)&&this._activateClickHats(n)}}getClientX(){return this._clientX}getClientY(){return this._clientY}getScratchX(){const A=this.cameraBound?i(this.runtime,this.cameraBound,this._scratchX,this._scratchY)[0]:this._scratchX;return this.runtime.runtimeOptions.miscLimits?Math.round(A):r(A)}getScratchY(){const A=this.cameraBound?i(this.runtime,this.cameraBound,this._scratchX,this._scratchY)[1]:this._scratchY;return this.runtime.runtimeOptions.miscLimits?Math.round(A):r(A)}getIsDown(){return this._isDown}getIsClicked(){return this._isClicked}getButtonIsDown(A){return 2===A&&(this.usesRightClickDown=!0),this._buttons.has(A)}}},function(A,e){A.exports=class{constructor(A){this.runtime=A,this.scrollDelta=0,this.runtime.on("RUNTIME_STEP_END",()=>{this.scrollDelta=0})}_addToScrollingDistanceBlock(A){"ext_pmSensingExpansion"in this.runtime&&(this.runtime.ext_pmSensingExpansion.scrollDistance+=A)}postData(A){this.scrollDelta=A.deltaY,this._addToScrollingDistanceBlock(0-A.deltaY);const e={},t={};if(A.deltaY<0)e.KEY_OPTION="up arrow",t.KEY_OPTION="up";else{if(!(A.deltaY>0))return;e.KEY_OPTION="down arrow",t.KEY_OPTION="down"}this.runtime.startHats("event_whenkeypressed",e),this.runtime.startHats("event_whenmousescrolled",t)}getScrollDelta(){return this.scrollDelta}}},function(A,e){A.exports=class{constructor(){this._username="",this._loggedIn=!1}postData(A){this._username=A.username,this._loggedIn=!1,!0===A.loggedIn&&(this._loggedIn=!0)}getUsername(){return this._username}getLoggedIn(){return this._loggedIn}}},function(A,e,t){const n=t(6),i=A=>Math.round(1e3*A)/1e3;A.exports=class{constructor(A){this.fingers=Array.from(Array(5).keys()).map(()=>({_clientX:0,_clientY:0,_scratchX:0,_scratchY:0,_isDown:!1,_isTapped:!1,_tapOnStep:-1})),this.runtime=A,this.runtime.on("RUNTIME_STEP_END",()=>{for(const A of this.fingers)this.runtime.frameLoop._stepCounter>A._tapOnStep&&(A._isTapped=!1)})}postData(A){A.changedTouches.forEach(e=>{const t=this.fingers[e.identifier];t&&("number"==typeof e.x&&(t._clientX=e.x,t._scratchX=n.clamp(this.runtime.stageWidth*(e.x/A.canvasWidth-.5),-this.runtime.stageWidth/2,this.runtime.stageWidth/2)),"number"==typeof e.y&&(t._clientY=e.y,t._scratchY=n.clamp(-this.runtime.stageHeight*(e.y/A.canvasHeight-.5),-this.runtime.stageHeight/2,this.runtime.stageHeight/2)),void 0!==A.isDown&&(t._isDown=A.isDown),!0===A.isDown&&(t._isTapped=!0,t._tapOnStep=this.runtime.frameLoop._stepCounter))})}getClientX(A){const e=this.fingers[A];return e?e._clientX:0}getClientY(A){const e=this.fingers[A];return e?e._clientY:0}getScratchX(A){const e=this.fingers[A];return e?this.runtime.runtimeOptions.miscLimits?Math.round(e._scratchX):i(e._scratchX):0}getScratchY(A){const e=this.fingers[A];return e?this.runtime.runtimeOptions.miscLimits?Math.round(e._scratchY):i(e._scratchY):0}getIsDown(A){const e=this.fingers[A];return!!e&&e._isDown}getIsTapped(A){const e=this.fingers[A];return!!e&&e._isTapped}}},function(A,e,t){const n=t(2),i=t(28);A.exports=class{constructor(A){this.runtime=A,this._counter=0,this._error="",this.runtime.on("RUNTIME_DISPOSED",this.clearCounter.bind(this))}getPrimitives(){return{control_repeat:this.repeat,control_repeat_until:this.repeatUntil,control_while:this.repeatWhile,control_for_each:this.forEach,control_forever:this.forever,control_wait:this.wait,control_repeatForSeconds:this.repeatForSeconds,control_waittick:this.waitTick,control_waitsecondsoruntil:this.waitOrUntil,control_wait_until:this.waitUntil,control_if:this.if,control_if_else:this.ifElse,control_stop:this.stop,control_stop_sprite:this.stopSprite,control_create_clone_of:this.createClone,control_delete_this_clone:this.deleteClone,control_delete_clones_of:this.deleteClonesOf,control_get_counter:this.getCounter,control_incr_counter:this.incrCounter,control_decr_counter:this.decrCounter,control_set_counter:this.setCounter,control_clear_counter:this.clearCounter,control_all_at_once:this.allAtOnce,control_backToGreenFlag:this.backToGreenFlag,control_if_return_else_return:this.if_return_else_return,control_javascript_command:this.runJavascript}}getMonitored(){return{control_get_counter:{getId:()=>"get_counter"}}}backToGreenFlag(A,e){const t=e.thread.topBlock;this.runtime.emit("PROJECT_START_BEFORE_RESET"),this.runtime.threads.filter(A=>A.topBlock!==t).forEach(A=>A.stopThisScript()),this.runtime.emit("PROJECT_START"),this.runtime.updateCurrentMSecs(),this.runtime.ioDevices.clock.resetProjectTimer(),this.runtime.targets.forEach(A=>A.clearEdgeActivatedValues());for(let A=this.runtime.targets.length-1;A>=0;A--){const e=this.runtime.targets[A];e.onGreenFlag(),e.isOriginal||(this.runtime.disposeTarget(e),this.runtime.stopForTarget(e))}this.runtime.startHats("event_whenflagclicked")}if_return_else_return(A){return n.toBoolean(A.boolean)?A.TEXT1:A.TEXT2}getHats(){return{control_start_as_clone:{restartExistingThreads:!1}}}runJavascript(A){return new Promise(e=>{const t=n.toString(A.JS);i.execute(t).then(A=>{e(A.value)})})}repeat(A,e){const t=Math.round(n.toNumber(A.TIMES));void 0===e.stackFrame.loopCounter&&(e.stackFrame.loopCounter=t),e.stackFrame.loopCounter--,e.stackFrame.loopCounter>=0&&e.startBranch(1,!0)}repeatUntil(A,e){n.toBoolean(A.CONDITION)||e.startBranch(1,!0)}repeatWhile(A,e){n.toBoolean(A.CONDITION)&&e.startBranch(1,!0)}forEach(A,e){const t=e.target.lookupOrCreateVariable(A.VARIABLE.id,A.VARIABLE.name);void 0===e.stackFrame.index&&(e.stackFrame.index=0),e.stackFrame.index<Number(A.VALUE)&&(e.stackFrame.index++,t.value=e.stackFrame.index,e.startBranch(1,!0))}waitUntil(A,e){n.toBoolean(A.CONDITION)||e.yield()}forever(A,e){e.startBranch(1,!0)}wait(A,e){if(e.stackTimerNeedsInit()){const t=Math.max(0,1e3*n.toNumber(A.DURATION));e.startStackTimer(t),this.runtime.requestRedraw(),e.yield()}else e.stackTimerFinished()||e.yield()}repeatForSeconds(A,e){if(e.stackTimerNeedsInit()){const t=Math.max(0,1e3*n.toNumber(A.TIMES));e.startStackTimer(t),this.runtime.requestRedraw(),e.startBranch(1,!0),e.yield()}else e.stackTimerFinished()||(e.startBranch(1,!0),e.yield())}waitTick(A,e){e.yieldTick()}waitOrUntil(A,e){if(!n.toBoolean(A.CONDITION)){if(e.stackTimerNeedsInit()){const t=Math.max(0,1e3*n.toNumber(A.DURATION));return e.startStackTimer(t),this.runtime.requestRedraw(),void e.yield()}e.stackTimerFinished()||e.yield()}}if(A,e){n.toBoolean(A.CONDITION)&&e.startBranch(1,!1)}ifElse(A,e){n.toBoolean(A.CONDITION)?e.startBranch(1,!1):e.startBranch(2,!1)}stop(A,e){const t=A.STOP_OPTION;"all"===t?e.stopAll():"other scripts in sprite"===t||"other scripts in stage"===t?e.stopOtherTargetThreads():"this script"===t&&e.stopThisScript()}stopSprite(A,e){const t=A.STOP_OPTION;let n;n="_myself_"===t?e.target:"_stage_"===t?this.runtime.getTargetForStage():this.runtime.getSpriteTargetByName(t),n&&this.runtime.stopForTarget(n)}createClone(A,e){this._createClone(n.toString(A.CLONE_OPTION),e.target)}_createClone(A,e){let t;if(t="_myself_"===A?e:this.runtime.getSpriteTargetByName(A),!t)return;const n=t.makeClone();n&&(this.runtime.addTarget(n),n.goBehindOther(t))}deleteClone(A,e){e.target.isOriginal||(this.runtime.disposeTarget(e.target),this.runtime.stopForTarget(e.target))}deleteClonesOf(A,e){const t=n.toString(A.CLONE_OPTION);let i;if(i="_myself_"===t?e.target:this.runtime.getSpriteTargetByName(t),!i)return;const r=i.sprite;if(!r)return;if(!r.clones)return;[].concat(r.clones).forEach(A=>{A.isOriginal||A.isStage||(this.runtime.disposeTarget(A),this.runtime.stopForTarget(A))})}getCounter(){return this._counter}setCounter(A){const e=n.toNumber(A.VALUE);this._counter=e}clearCounter(){this._counter=0}incrCounter(){this._counter++}decrCounter(){this._counter--}allAtOnce(A){A.thread.peekStackFrame().warpMode=!1,A.startBranch(1,!1),A.thread.peekStackFrame().warpMode=!0}}},function(A,e,t){const n=t(2),i=t(28);A.exports=class{constructor(A){this.runtime=A,this.runtime.on("KEY_PRESSED",A=>{this.runtime.startHats("event_whenkeypressed",{KEY_OPTION:A}),this.runtime.startHats("event_whenkeypressed",{KEY_OPTION:"any"})}),this.runtime.on("KEY_HIT",A=>{this.runtime.startHats("event_whenkeyhit",{KEY_OPTION:A}),this.runtime.startHats("event_whenkeyhit",{KEY_OPTION:"any"})}),this.isStarting=!1,this.stopEventNeedsInit=!0,this.runtime.on("PROJECT_START_BEFORE_RESET",()=>{this.isStarting=!0,this.stopEventNeedsInit&&(this.stopEventNeedsInit=!1)}),this.runtime.on("PROJECT_STOP_ALL",()=>{this.isStarting?this.isStarting=!1:this.stopEventNeedsInit||(this.runtime.once("RUNTIME_STEP_START",()=>{this.runtime.startHats("event_whenstopclicked")}),this.isStarting=!1)}),this.runtime.on("RUNTIME_STEP_START",()=>{this.runtime.startHats("event_always")}),this.runtime.on("AFTER_EXECUTE",()=>{setTimeout(()=>{const A=this.runtime.getTargetForStage();if(!A)return;const e=A.variables;for(const A in e)void 0!==e[A].isSent&&(e[A].isSent=!1)},10)})}getPrimitives(){return{event_whenanything:this.whenanything,event_whenjavascript:this.whenjavascript,event_whentouchingobject:this.touchingObject,event_broadcast:this.broadcast,event_broadcastandwait:this.broadcastAndWait,event_whengreaterthan:this.hatGreaterThanPredicate}}whenanything(A){return n.toBoolean(A.ANYTHING)}whenjavascript(A){return new Promise(e=>{const t=n.toString(A.JS);i.execute(t).then(A=>{e(!0===A.value)})})}getHats(){return{event_whenflagclicked:{restartExistingThreads:!0},event_whenstopclicked:{restartExistingThreads:!0},event_always:{restartExistingThreads:!1},event_whenkeypressed:{restartExistingThreads:!1},event_whenkeyhit:{restartExistingThreads:!1},event_whenmousescrolled:{restartExistingThreads:!1},event_whenanything:{restartExistingThreads:!1,edgeActivated:!0},event_whenjavascript:{restartExistingThreads:!1,edgeActivated:!0},event_whenthisspriteclicked:{restartExistingThreads:!0},event_whentouchingobject:{restartExistingThreads:!1,edgeActivated:!0},event_whenstageclicked:{restartExistingThreads:!0},event_whenbackdropswitchesto:{restartExistingThreads:!0},event_whengreaterthan:{restartExistingThreads:!1,edgeActivated:!0},event_whenbroadcastreceived:{restartExistingThreads:!0}}}touchingObject(A,e){return e.target.isTouchingObject(A.TOUCHINGOBJECTMENU)}hatGreaterThanPredicate(A,e){const t=n.toString(A.WHENGREATERTHANMENU).toLowerCase(),i=n.toNumber(A.VALUE);switch(t){case"timer":return e.ioQuery("clock","projectTimer")>i;case"loudness":return this.runtime.audioEngine&&this.runtime.audioEngine.getLoudness()>i}return!1}broadcast(A,e){const t=e.runtime.getTargetForStage().lookupBroadcastMsg(A.BROADCAST_OPTION.id,A.BROADCAST_OPTION.name);if(t){const A=t.name;t.isSent=!0,e.startHats("event_whenbroadcastreceived",{BROADCAST_OPTION:A})}}broadcastAndWait(A,e){if(e.stackFrame.broadcastVar||(e.stackFrame.broadcastVar=e.runtime.getTargetForStage().lookupBroadcastMsg(A.BROADCAST_OPTION.id,A.BROADCAST_OPTION.name)),e.stackFrame.broadcastVar){const A=e.stackFrame.broadcastVar.name;if(!e.stackFrame.startedThreads&&(broadcastVar.isSent=!0,e.stackFrame.startedThreads=e.startHats("event_whenbroadcastreceived",{BROADCAST_OPTION:A}),0===e.stackFrame.startedThreads.length))return;const t=this;e.stackFrame.startedThreads.some(A=>-1!==t.runtime.threads.indexOf(A))&&(e.stackFrame.startedThreads.every(A=>t.runtime.isWaitingThread(A))?e.yieldTick():e.yield())}}}},function(A,e,t){const n=t(2),i=t(8),r=t(7),o=t(9),s=t(16),a=t(35),B=t(6);class c{constructor(A){this.runtime=A,this._onTargetChanged=this._onTargetChanged.bind(this),this._onResetBubbles=this._onResetBubbles.bind(this),this._onTargetWillExit=this._onTargetWillExit.bind(this),this._updateBubble=this._updateBubble.bind(this),this.SAY_BUBBLE_LIMITdefault=330,this.SAY_BUBBLE_LIMIT=this.SAY_BUBBLE_LIMITdefault,this.defaultBubble={MAX_LINE_WIDTH:170,MIN_WIDTH:50,STROKE_WIDTH:4,PADDING:10,CORNER_RADIUS:16,TAIL_HEIGHT:12,FONT:"Helvetica",FONT_SIZE:14,FONT_HEIGHT_RATIO:.9,LINE_HEIGHT:16,COLORS:{BUBBLE_FILL:"white",BUBBLE_STROKE:"rgba(0, 0, 0, 0.15)",TEXT_FILL:"#575E75"}},this.runtime.on("PROJECT_STOP_ALL",this._onResetBubbles),this.runtime.on("targetWasRemoved",this._onTargetWillExit),this.runtime.on(c.SAY_OR_THINK,this._updateBubble)}static get DEFAULT_BUBBLE_STATE(){return{drawableId:null,onSpriteRight:!0,skinId:null,text:"",type:"say",usageId:null,props:this.defaultBubble}}static get STATE_KEY(){return"Scratch.looks"}static get SAY_OR_THINK(){return"SAY"}static get EFFECT_GHOST_LIMIT(){return{min:0,max:100}}static get EFFECT_BRIGHTNESS_LIMIT(){return{min:-100,max:100}}_getBubbleState(A){let e=A.getCustomState(c.STATE_KEY);return e||(e=r.simple(c.DEFAULT_BUBBLE_STATE),A.setCustomState(c.STATE_KEY,e)),e}_resetBubbles(A){const e=this._getBubbleState(A);this.SAY_BUBBLE_LIMIT=this.SAY_BUBBLE_LIMITdefault,e.props=this.defaultBubble}_setBubbleProperty(A,e,t){const n=this._getBubbleState(A);n.props||(n.props=this.defaultBubble),e.forEach((A,e)=>{A.startsWith("COLORS")?n.props.COLORS[A.split(".")[1]]=t[e]:n.props[A]=t[e]}),A.setCustomState(c.STATE_KEY,n)}_onTargetChanged(A){this._getBubbleState(A).drawableId&&this._positionBubble(A)}_onTargetWillExit(A){const e=this._getBubbleState(A);e.drawableId&&e.skinId&&(this.runtime.renderer.destroyDrawable(e.drawableId,s.SPRITE_LAYER),this.runtime.renderer.destroySkin(e.skinId),e.drawableId=null,e.skinId=null,this.runtime.requestRedraw()),A.onTargetVisualChange=null}_onResetBubbles(){for(let A=0;A<this.runtime.targets.length;A++){this._getBubbleState(this.runtime.targets[A]).text="",this._onTargetWillExit(this.runtime.targets[A])}clearTimeout(this._bubbleTimeout)}_positionBubble(A){if(!A.visible)return;const e=this._getBubbleState(A),[t,n]=this.runtime.renderer.getCurrentSkinSize(e.drawableId);let i;try{i=A.getBoundsForBubble()}catch(e){i={left:A.x,right:A.x,top:A.y,bottom:A.y}}const r=this.runtime.renderer.getNativeSize(),o={left:-r[0]/2,right:r[0]/2,top:r[1]/2,bottom:-r[1]/2};e.onSpriteRight&&t+i.right>o.right&&i.left-t>o.left?(e.onSpriteRight=!1,this._renderBubble(A)):!e.onSpriteRight&&i.left-t<o.left&&t+i.right<o.right?(e.onSpriteRight=!0,this._renderBubble(A)):(this.runtime.renderer.updateDrawablePosition(e.drawableId,[e.onSpriteRight?Math.max(o.left,Math.min(o.right-t,i.right)):Math.min(o.right-t,Math.max(o.left,i.left-t)),Math.min(o.top,i.bottom+n)]),this.runtime.requestRedraw())}_renderBubble(A){if(!this.runtime.renderer)return;const e=this._getBubbleState(A),{type:t,text:n,onSpriteRight:i}=e;A.visible&&""!==n?(e.skinId?this.runtime.renderer.updateTextSkin(e.skinId,t,n,i,e.props):(A.onTargetVisualChange=this._onTargetChanged,e.drawableId=this.runtime.renderer.createDrawable(s.SPRITE_LAYER),e.skinId=this.runtime.renderer.createTextSkin(t,n,e.onSpriteRight,e.props),this.runtime.renderer.updateDrawableSkinId(e.drawableId,e.skinId)),this._positionBubble(A)):this._onTargetWillExit(A)}_formatBubbleText(A){return""===A?A:("number"==typeof A&&Math.abs(A)>=.01&&A%1!=0&&(A=A.toFixed(2)),A=String(A).slice(0,this.SAY_BUBBLE_LIMIT))}_updateBubble(A,e,t){const n=this._getBubbleState(A);n.type=e,n.text=this._formatBubbleText(t),n.usageId=o(),this._renderBubble(A)}_percentToRatio(A){return A/100}_doesFontSuport(A,e){const t=A+"px "+e;return document.fonts.check(t)}getPrimitives(){return{looks_say:this.say,looks_sayforsecs:this.sayforsecs,looks_think:this.think,looks_thinkforsecs:this.thinkforsecs,looks_setFont:this.setFont,looks_setColor:this.setColor,looks_setShape:this.setShape,looks_show:this.show,looks_hide:this.hide,looks_getSpriteVisible:this.getSpriteVisible,looks_getOtherSpriteVisible:this.getOtherSpriteVisible,looks_hideallsprites:()=>{},looks_switchcostumeto:this.switchCostume,looks_switchbackdropto:this.switchBackdrop,looks_switchbackdroptoandwait:this.switchBackdropAndWait,looks_nextcostume:this.nextCostume,looks_nextbackdrop:this.nextBackdrop,looks_previouscostume:this.previousCostume,looks_previousbackdrop:this.previousBackdrop,looks_changeeffectby:this.changeEffect,looks_seteffectto:this.setEffect,looks_cleargraphiceffects:this.clearEffects,looks_getEffectValue:this.getEffectValue,looks_changesizeby:this.changeSize,looks_setsizeto:this.setSize,looks_changestretchby:()=>{},looks_setstretchto:this.stretchSet,looks_gotofrontback:this.goToFrontBack,looks_goforwardbackwardlayers:this.goForwardBackwardLayers,looks_goTargetLayer:this.goTargetLayer,looks_layersSetLayer:this.setSpriteLayer,looks_layersGetLayer:this.getSpriteLayer,looks_size:this.getSize,looks_costumenumbername:this.getCostumeNumberName,looks_backdropnumbername:this.getBackdropNumberName,looks_setStretch:this.stretchSet,looks_changeStretch:this.changeStretch,looks_stretchGetX:this.getStretchX,looks_stretchGetY:this.getStretchY,looks_sayWidth:this.getBubbleWidth,looks_sayHeight:this.getBubbleHeight,looks_changeVisibilityOfSprite:this.showOrHideSprite,looks_changeVisibilityOfSpriteShow:this.showSprite,looks_changeVisibilityOfSpriteHide:this.hideSprite,looks_stoptalking:this.stopTalking,looks_getinputofcostume:this.getCostumeValue,looks_tintColor:this.getTintColor,looks_setTintColor:this.setTintColor}}getSpriteLayer(A,e){return e.target.getLayerOrder()}setSpriteLayer(A,e){const t=e.target,i=n.toNumber(A.NUM),r=t.getLayerOrder();t.goForwardLayers(i-r)}_getBubbleSize(A){const e=this._getBubbleState(A);return this.runtime.renderer.getSkinSize(e.skinId)}getBubbleWidth(A,e){const t=e.target;let n=0;try{n=this._getBubbleSize(t)[0]}catch(A){n=0}return n}getBubbleHeight(A,e){const t=e.target;let n=0;try{n=this._getBubbleSize(t)[1]}catch(A){n=0}return n}getStretchY(A,e){return e.target._getRenderedDirectionAndScale().stretch[1]}getStretchX(A,e){return e.target._getRenderedDirectionAndScale().stretch[0]}stretchSet(A,e){e.target.setStretch(A.X,A.Y)}changeStretch(A,e){let[t,i]=e.target._getRenderedDirectionAndScale().stretch,r=t+n.toNumber(A.X),o=i+n.toNumber(A.Y);e.target.setStretch(r,o)}setFont(A,e){this._setBubbleProperty(e.target,["FONT","FONT_SIZE"],[A.font,A.size])}setColor(A,e){const t=Number(A.color);isNaN(t)||(A.color=i.decimalToHex(t)),this._setBubbleProperty(e.target,["COLORS."+A.prop],[A.color])}setShape(A,e){"texlim"!==A.prop?this._setBubbleProperty(e.target,[A.prop],[A.color]):this.SAY_BUBBLE_LIMIT=Math.max(A.color,1)}getMonitored(){return{looks_size:{isSpriteSpecific:!0,getId:A=>"".concat(A,"_size")},looks_stretchGetX:{isSpriteSpecific:!0,getId:A=>"".concat(A,"_stretchGetX")},looks_stretchGetY:{isSpriteSpecific:!0,getId:A=>"".concat(A,"_stretchGetY")},looks_sayWidth:{isSpriteSpecific:!0,getId:A=>"".concat(A,"_sayWidth")},looks_sayHeight:{isSpriteSpecific:!0,getId:A=>"".concat(A,"_sayHeight")},looks_getEffectValue:{isSpriteSpecific:!0,getId:(A,e)=>a("".concat(A,"_getEffectValue"),e)},looks_tintColor:{isSpriteSpecific:!0,getId:A=>"".concat(A,"_tintColor")},looks_getSpriteVisible:{isSpriteSpecific:!0,getId:A=>"".concat(A,"_getSpriteVisible")},looks_layersGetLayer:{isSpriteSpecific:!0,getId:A=>"".concat(A,"_layersGetLayer")},looks_costumenumbername:{isSpriteSpecific:!0,getId:(A,e)=>a("".concat(A,"_costumenumbername"),e)},looks_backdropnumbername:{getId:(A,e)=>a("backdropnumbername",e)}}}say(A,e){const t=A.MESSAGE;this._say(t,e.target)}_say(A,e){this.runtime.emit(c.SAY_OR_THINK,e,"say",A)}stopTalking(A,e){this.say({MESSAGE:""},e)}sayforsecs(A,e){this.say(A,e);const t=e.target,n=this._getBubbleState(t).usageId;return new Promise(e=>{this._bubbleTimeout=setTimeout(()=>{this._bubbleTimeout=null,this._getBubbleState(t).usageId===n&&this._updateBubble(t,"say",""),e()},1e3*A.SECS)})}think(A,e){this.runtime.emit(c.SAY_OR_THINK,e.target,"think",A.MESSAGE)}thinkforsecs(A,e){this.think(A,e);const t=e.target,n=this._getBubbleState(t).usageId;return new Promise(e=>{this._bubbleTimeout=setTimeout(()=>{this._bubbleTimeout=null,this._getBubbleState(t).usageId===n&&this._updateBubble(t,"think",""),e()},1e3*A.SECS)})}show(A,e){e.target.setVisible(!0),this._renderBubble(e.target)}hide(A,e){e.target.setVisible(!1),this._renderBubble(e.target)}showOrHideSprite(A,e){const t=A.VISIBLE_OPTION,i=n.toString(A.VISIBLE_TYPE).toLowerCase();let r;r="_myself_"===t?e.target:"_stage_"===t?this.runtime.getTargetForStage():this.runtime.getSpriteTargetByName(t),r&&(r.setVisible("show"===i),this._renderBubble(r))}showSprite(A,e){this.showOrHideSprite({VISIBLE_OPTION:A.VISIBLE_OPTION,VISIBLE_TYPE:"show"},e)}hideSprite(A,e){this.showOrHideSprite({VISIBLE_OPTION:A.VISIBLE_OPTION,VISIBLE_TYPE:"hide"},e)}getSpriteVisible(A,e){return e.target.visible}getOtherSpriteVisible(A,e){const t=A.VISIBLE_OPTION;let n;if(n="_myself_"===t?e.target:"_stage_"===t?this.runtime.getTargetForStage():this.runtime.getSpriteTargetByName(t),n)return n.visible}getEffectValue(A,e){const t=n.toString(A.EFFECT).toLowerCase(),i=e.target.effects;if(!i.hasOwnProperty(t))return 0;return n.toNumber(i[t])}getTintColor(A,e){const t=e.target.effects;return"number"!=typeof t.tintColor?"#ffffff":i.decimalToHex(t.tintColor-1)}setTintColor(A,e){const t=n.toRgbColorObject(A.color),r=i.rgbToDecimal(t);e.target.setEffect("tintColor",r+1)}_setCostume(A,e,t){if("number"==typeof e)A.setCostume(t?e:e-1);else{const i=A.getCostumeIndexByName(e.toString());if(-1!==i)A.setCostume(i);else if("next costume"===e)A.setCostume(A.currentCostume+1);else if("previous costume"===e)A.setCostume(A.currentCostume-1);else if("random costume"===e){let e=B.inclusiveRandIntWithout(0,A.sprite.costumes_.length-1,A.currentCostume);e>=A.sprite.costumes_.length&&(e=0),A.setCostume(e)}else isNaN(e)||n.isWhiteSpace(e)||A.setCostume(t?Number(e):Number(e)-1)}return[]}costumeValueToDefaultNone(A){switch(A){case"width":case"height":case"rotation center x":case"rotation center y":return 0;default:return""}}getCostumeValue(A,e){let t=0;const i=e.target,r=A.COSTUME,o=n.toString(A.INPUT);if("number"==typeof r)t=0===r?0:r-1;else{let A=i.isStage?"backdrop":"costume";switch(n.toString(r)){case"next "+A:t=i.currentCostume+1,t>=i.sprite.costumes_.length&&(t=0);break;case"previous "+A:t=i.currentCostume-1,t<0&&(t=i.sprite.costumes_.length-1);break;case"random "+A:t=B.inclusiveRandIntWithout(0,i.sprite.costumes_.length-1,i.currentCostume),t>=i.sprite.costumes_.length&&(t=0);break;default:t=i.getCostumeIndexByName(n.toString(r))}}if(t<0)return this.costumeValueToDefaultNone(o);if(!i.sprite)return this.costumeValueToDefaultNone(o);if(!i.sprite.costumes_)return this.costumeValueToDefaultNone(o);const s=i.sprite.costumes_[t];if(!s)return this.costumeValueToDefaultNone(o);switch(o){case"width":return s.size[0];case"height":return s.size[1];case"rotation center x":return s.rotationCenterX;case"rotation center y":return s.rotationCenterY;case"drawing mode":return"svg"===s.dataFormat?"Vector":"Bitmap";default:return""}}_setBackdrop(A,e,t){if("number"==typeof e)A.setCostume(t?e:e-1);else{const i=A.getCostumeIndexByName(e.toString());if(-1!==i)A.setCostume(i);else if("next backdrop"===e)A.setCostume(A.currentCostume+1);else if("previous backdrop"===e)A.setCostume(A.currentCostume-1);else if("random backdrop"===e){const e=A.getCostumes().length;if(e>1){const t=0,n=e-1,i=A.currentCostume,r=B.inclusiveRandIntWithout(t,n,i);A.setCostume(r)}}else isNaN(e)||n.isWhiteSpace(e)||A.setCostume(t?Number(e):Number(e)-1)}const i=A.getCostumes()[A.currentCostume].name;return this.runtime.startHats("event_whenbackdropswitchesto",{BACKDROP:i})}switchCostume(A,e){this._setCostume(e.target,A.COSTUME)}nextCostume(A,e){this._setCostume(e.target,e.target.currentCostume+1,!0)}previousCostume(A,e){this._setCostume(e.target,e.target.currentCostume-1,!0)}switchBackdrop(A){this._setBackdrop(this.runtime.getTargetForStage(),A.BACKDROP)}switchBackdropAndWait(A,e){if(!e.stackFrame.startedThreads&&(e.stackFrame.startedThreads=this._setBackdrop(this.runtime.getTargetForStage(),A.BACKDROP),0===e.stackFrame.startedThreads.length))return;const t=this;e.stackFrame.startedThreads.some(A=>-1!==t.runtime.threads.indexOf(A))&&(e.stackFrame.startedThreads.every(A=>t.runtime.isWaitingThread(A))?e.yieldTick():e.yield())}nextBackdrop(){const A=this.runtime.getTargetForStage();this._setBackdrop(A,A.currentCostume+1,!0)}previousBackdrop(){const A=this.runtime.getTargetForStage();this._setBackdrop(A,A.currentCostume-1,!0)}clampEffect(A,e){let t=e;switch(A){case"ghost":t=B.clamp(e,c.EFFECT_GHOST_LIMIT.min,c.EFFECT_GHOST_LIMIT.max);break;case"brightness":t=B.clamp(e,c.EFFECT_BRIGHTNESS_LIMIT.min,c.EFFECT_BRIGHTNESS_LIMIT.max)}return t}changeEffect(A,e){const t=n.toString(A.EFFECT).toLowerCase(),i=n.toNumber(A.CHANGE);if(!e.target.effects.hasOwnProperty(t))return;let r=i+e.target.effects[t];r=this.clampEffect(t,r),e.target.setEffect(t,r)}setEffect(A,e){const t=n.toString(A.EFFECT).toLowerCase();let i=n.toNumber(A.VALUE);i=this.clampEffect(t,i),e.target.setEffect(t,i)}clearEffects(A,e){e.target.clearEffects(),this._resetBubbles(e.target)}changeSize(A,e){const t=n.toNumber(A.CHANGE);e.target.setSize(e.target.size+t)}setSize(A,e){const t=n.toNumber(A.SIZE);e.target.setSize(t)}goToFrontBack(A,e){e.target.isStage||("front"===A.FRONT_BACK?e.target.goToFront():e.target.goToBack())}goForwardBackwardLayers(A,e){e.target.isStage||("forward"===A.FORWARD_BACKWARD?e.target.goForwardLayers(n.toNumber(A.NUM)):e.target.goBackwardLayers(n.toNumber(A.NUM)))}goTargetLayer(A,e){let t;const n=A.VISIBLE_OPTION;t="_stage_"===n?this.runtime.getTargetForStage():this.runtime.getSpriteTargetByName(n),!e.target.isStage&&t&&("infront"===A.FORWARD_BACKWARD?(e.target.goBehindOther(t),e.target.goForwardLayers(1)):e.target.goBehindOther(t))}getSize(A,e){return Math.round(e.target.size)}getBackdropNumberName(A){const e=this.runtime.getTargetForStage();return"number"===A.NUMBER_NAME?e.currentCostume+1:e.getCostumes()[e.currentCostume].name}getCostumeNumberName(A,e){return"number"===A.NUMBER_NAME?e.target.currentCostume+1:e.target.getCostumes()[e.target.currentCostume].name}}A.exports=c},function(A,e,t){const n=t(2),i=t(6),r=t(18),o="top-left",s="top-right",a="bottom-left",B="bottom-right",c="top",g="left",E="right",Q="middle",u="bottom";A.exports=class{constructor(A){this.runtime=A}getPrimitives(){return{motion_movesteps:this.moveSteps,motion_movebacksteps:this.moveStepsBack,motion_moveupdownsteps:this.moveStepsUpDown,motion_gotoxy:this.goToXY,motion_goto:this.goTo,motion_turnright:this.turnRight,motion_turnleft:this.turnLeft,motion_turnrightaroundxy:this.turnRightAround,motion_turnleftaroundxy:this.turnLeftAround,motion_turnaround:this.turnAround,motion_pointinrandomdirection:this.pointInDirectionRandom,motion_pointtowardsxy:this.pointTowardsXY,motion_pointindirection:this.pointInDirection,motion_pointtowards:this.pointTowards,motion_glidesecstoxy:this.glide,motion_glideto:this.glideTo,motion_ifonedgebounce:this.ifOnEdgeBounce,motion_ifonxybounce:this.ifOnXYBounce,motion_ifonspritebounce:this.ifOnSpriteBounce,motion_setrotationstyle:this.setRotationStyle,motion_changexby:this.changeX,motion_setx:this.setX,motion_changeyby:this.changeY,motion_sety:this.setY,motion_changebyxy:this.changeXY,motion_xposition:this.getX,motion_yposition:this.getY,motion_direction:this.getDirection,motion_move_sprite_to_scene_side:this.moveToStageSide,motion_scroll_right:()=>{},motion_scroll_up:()=>{},motion_align_scene:()=>{},motion_xscroll:()=>{},motion_yscroll:()=>{}}}moveToStageSide(A,e){if(!this.runtime.renderer)return;const t=n.toString(A.ALIGNMENT),i=this.runtime.stageWidth/2,r=this.runtime.stageHeight/2,l=[];switch(t){case c:e.target.setXY(0,r),l.push("top");break;case g:e.target.setXY(0-i,0),l.push("left");break;case Q:e.target.setXY(0,0);break;case E:e.target.setXY(i,0),l.push("right");break;case u:e.target.setXY(0,0-r),l.push("bottom");break;case o:e.target.setXY(0-i,r),l.push("top"),l.push("left");break;case s:e.target.setXY(i,r),l.push("top"),l.push("right");break;case a:e.target.setXY(0-i,0-r),l.push("bottom"),l.push("left");break;case B:e.target.setXY(i,0-r),l.push("bottom"),l.push("right")}const w=e.target.drawableID,h=this.runtime.renderer._allDrawables[w],C=h._skin.getFenceBounds(h);l.forEach(A=>{switch(A){case"top":e.target.setXY(e.target.x,C.bottom);break;case"bottom":e.target.setXY(e.target.x,C.top);break;case"left":e.target.setXY(C.right,e.target.y);break;case"right":e.target.setXY(C.left,e.target.y)}})}getMonitored(){return{motion_xposition:{isSpriteSpecific:!0,getId:A=>"".concat(A,"_xposition")},motion_yposition:{isSpriteSpecific:!0,getId:A=>"".concat(A,"_yposition")},motion_direction:{isSpriteSpecific:!0,getId:A=>"".concat(A,"_direction")}}}moveSteps(A,e){const t=n.toNumber(A.STEPS);this._moveSteps(t,e.target)}moveStepsBack(A,e){const t=n.toNumber(A.STEPS);this._moveSteps(0-t,e.target)}moveStepsUpDown(A,e){const t=n.toString(A.DIRECTION),i=n.toNumber(A.STEPS);this.turnLeft({DEGREES:90},e),"up"===t?this._moveSteps(i,e.target):"down"===t&&this._moveSteps(0-i,e.target),this.turnRight({DEGREES:90},e)}_moveSteps(A,e){const t=i.degToRad(90-e.direction),n=A*Math.cos(t),r=A*Math.sin(t);e.setXY(e.x+n,e.y+r)}goToXY(A,e){const t=n.toNumber(A.X),i=n.toNumber(A.Y);e.target.setXY(t,i)}getTargetXY(A,e){let t=0,i=0;if("_mouse_"===A)t=e.ioQuery("mouse","getScratchX"),i=e.ioQuery("mouse","getScratchY");else if("_random_"===A){const A=this.runtime.stageWidth,e=this.runtime.stageHeight;t=Math.round(A*(Math.random()-.5)),i=Math.round(e*(Math.random()-.5))}else{A=n.toString(A);const e=this.runtime.getSpriteTargetByName(A);if(!e)return;t=e.x,i=e.y}return[t,i]}goTo(A,e){const t=this.getTargetXY(A.TO,e);t&&e.target.setXY(t[0],t[1])}turnRight(A,e){const t=n.toNumber(A.DEGREES);e.target.setDirection(e.target.direction+t)}turnLeft(A,e){const t=n.toNumber(A.DEGREES);e.target.setDirection(e.target.direction-t)}turnRightAround(A,e){this.turnLeftAround({DEGREES:-n.toNumber(A.DEGREES),X:n.toNumber(A.X),Y:n.toNumber(A.Y)},e)}turnLeftAround(A,e){const t=n.toNumber(A.DEGREES),i=n.toNumber(A.X),r=n.toNumber(A.Y),o=Math.PI*t/180,s=Math.cos(o),a=Math.sin(o),B=e.target.x-i,c=e.target.y-r,g={x:s*B-a*c+i,y:s*c+a*B+r};e.target.setXY(g.x,g.y)}pointInDirection(A,e){const t=n.toNumber(A.DIRECTION);e.target.setDirection(t)}turnAround(A,e){this.turnRight({DEGREES:180},e)}pointInDirectionRandom(A,e){this.pointTowards({TOWARDS:"_random_"},e)}pointTowardsXY(A,e){const t=n.toNumber(A.X),r=n.toNumber(A.Y),o=t-e.target.x,s=r-e.target.y,a=90-i.radToDeg(Math.atan2(s,o));e.target.setDirection(a)}pointTowards(A,e){let t=0,r=0;if("_mouse_"===A.TOWARDS)t=e.ioQuery("mouse","getScratchX"),r=e.ioQuery("mouse","getScratchY");else{if("_random_"===A.TOWARDS)return void e.target.setDirection(Math.round(360*Math.random())-180);{A.TOWARDS=n.toString(A.TOWARDS);const e=this.runtime.getSpriteTargetByName(A.TOWARDS);if(!e)return;t=e.x,r=e.y}}const o=t-e.target.x,s=r-e.target.y,a=90-i.radToDeg(Math.atan2(s,o));e.target.setDirection(a)}glide(A,e){if(e.stackFrame.timer){const A=e.stackFrame.timer.timeElapsed();if(A<1e3*e.stackFrame.duration){const t=A/(1e3*e.stackFrame.duration),n=t*(e.stackFrame.endX-e.stackFrame.startX),i=t*(e.stackFrame.endY-e.stackFrame.startY);e.target.setXY(e.stackFrame.startX+n,e.stackFrame.startY+i),e.yield()}else e.target.setXY(e.stackFrame.endX,e.stackFrame.endY)}else{if(e.stackFrame.timer=new r,e.stackFrame.timer.start(),e.stackFrame.duration=n.toNumber(A.SECS),e.stackFrame.startX=e.target.x,e.stackFrame.startY=e.target.y,e.stackFrame.endX=n.toNumber(A.X),e.stackFrame.endY=n.toNumber(A.Y),e.stackFrame.duration<=0)return void e.target.setXY(e.stackFrame.endX,e.stackFrame.endY);e.yield()}}glideTo(A,e){const t=this.getTargetXY(A.TO,e);t&&this.glide({SECS:A.SECS,X:t[0],Y:t[1]},e)}ifOnEdgeBounce(A,e){this._ifOnEdgeBounce(e.target)}_ifOnEdgeBounce(A){const e=A.getBounds();if(!e)return;const t=this.runtime.stageWidth,n=this.runtime.stageHeight,r=Math.max(0,t/2+e.left),o=Math.max(0,n/2-e.top),s=Math.max(0,t/2-e.right),a=Math.max(0,n/2+e.bottom);let B="",c=1/0;if(r<c&&(c=r,B="left"),o<c&&(c=o,B="top"),s<c&&(c=s,B="right"),a<c&&(c=a,B="bottom"),c>0)return;const g=i.degToRad(90-A.direction);let E=Math.cos(g),Q=-Math.sin(g);"left"===B?E=Math.max(.2,Math.abs(E)):"top"===B?Q=Math.max(.2,Math.abs(Q)):"right"===B?E=0-Math.max(.2,Math.abs(E)):"bottom"===B&&(Q=0-Math.max(.2,Math.abs(Q)));const u=i.radToDeg(Math.atan2(Q,E))+90;A.setDirection(u);const l=A.keepInFence(A.x,A.y);A.setXY(l[0],l[1])}ifOnXYBounce(A,e,t,r,o,s){const a=n.toNumber(A.X),B=n.toNumber(A.Y),c=e.target,g=c.getBounds();if(!g)return;const E=a>=g.left&&a<=g.right,Q=B>=g.bottom&&B<=g.top;if(!(!0===s||E&&Q))return;let u="",l=1/0;for(let A=0;A<4;A++){const e=["left","top","right","bottom"];let t,n;switch(e[A]){case"left":case"right":t=a-g[e[A]],n=B-c.y;break;case"top":case"bottom":t=a-c.x,n=B-g[e[A]]}const i=Math.sqrt(t*t+n*n);i<l&&(l=i,u=e[A])}const w=i.degToRad(90-c.direction);let h=Math.cos(w),C=-Math.sin(w);"left"===u?h=Math.max(.2,Math.abs(h)):"top"===u?C=Math.max(.2,Math.abs(C)):"right"===u?h=0-Math.max(.2,Math.abs(h)):"bottom"===u&&(C=0-Math.max(.2,Math.abs(C)));const I=i.radToDeg(Math.atan2(C,h))+90;c.setDirection(I);const M=c.keepInFence(c.x,c.y);c.setXY(M[0],M[1])}ifOnSpriteBounce(A,e){if("_mouse_"===A.SPRITE){const A=e.ioQuery("mouse","getScratchX"),t=e.ioQuery("mouse","getScratchY");return this.ifOnXYBounce({X:A,Y:t},e)}if("_random_"===A.SPRITE){const A=this.runtime.stageWidth,t=this.runtime.stageHeight,n=Math.round(A*(Math.random()-.5)),i=Math.round(t*(Math.random()-.5));return this.ifOnXYBounce({X:n,Y:i},e)}const t=n.toString(A.SPRITE);if(!this.runtime.getSpriteTargetByName(t))return;const i=e.target.spriteTouchingPoint(t);return i?this.ifOnXYBounce({X:i[0],Y:i[1]},e):void 0}setRotationStyle(A,e){e.target.setRotationStyle(A.STYLE)}changeX(A,e){const t=n.toNumber(A.DX);e.target.setXY(e.target.x+t,e.target.y)}setX(A,e){const t=n.toNumber(A.X);e.target.setXY(t,e.target.y)}changeY(A,e){const t=n.toNumber(A.DY);e.target.setXY(e.target.x,e.target.y+t)}setY(A,e){const t=n.toNumber(A.Y);e.target.setXY(e.target.x,t)}changeXY(A,e){const t=n.toNumber(A.DX),i=n.toNumber(A.DY);e.target.setXY(e.target.x+t,e.target.y+i)}getX(A,e){return this.limitPrecision(e.target.x)}getY(A,e){return this.limitPrecision(e.target.y)}getDirection(A,e){return e.target.direction}limitPrecision(A){const e=Math.round(A),t=A-e;return Math.abs(t)<1e-9?e:A}}},function(A,e,t){const n=t(2),i=t(6),r=t(28),{validateRegex:o}=t(13);A.exports=class{constructor(A){this.runtime=A}getPrimitives(){return{operator_add:this.add,operator_subtract:this.subtract,operator_multiply:this.multiply,operator_divide:this.divide,operator_power:this.power,operator_lt:this.lt,operator_equals:this.equals,operator_notequal:this.notequals,operator_gt:this.gt,operator_ltorequal:this.ltorequal,operator_gtorequal:this.gtorequal,operator_and:this.and,operator_nand:this.nand,operator_nor:this.nor,operator_xor:this.xor,operator_xnor:this.xnor,operator_or:this.or,operator_not:this.not,operator_random:this.random,operator_join:this.join,operator_join3:this.join3,operator_letter_of:this.letterOf,operator_length:this.length,operator_contains:this.contains,operator_mod:this.mod,operator_round:this.round,operator_mathop:this.mathop,operator_advlog:this.advlog,operator_regexmatch:this.regexmatch,operator_replaceAll:this.replaceAll,operator_replaceFirst:this.replaceFirst,operator_getLettersFromIndexToIndexInText:this.getLettersFromIndexToIndexInText,operator_getLettersFromIndexToIndexInTextFixed:this.getLettersFromIndexToIndexInTextFixed,operator_readLineInMultilineText:this.readLineInMultilineText,operator_newLine:this.newLine,operator_tabCharacter:this.tabCharacter,operator_stringify:this.stringify,operator_boolify:this.boolify,operator_lerpFunc:this.lerpFunc,operator_advMath:this.advMath,operator_advMathExpanded:this.advMathExpanded,operator_constrainnumber:this.constrainnumber,operator_trueBoolean:this.true,operator_falseBoolean:this.false,operator_randomBoolean:this.randomBoolean,operator_indexOfTextInText:this.indexOfTextInText,operator_lastIndexOfTextInText:this.lastIndexOfTextInText,operator_toUpperLowerCase:this.toCase,operator_character_to_code:this.charToCode,operator_code_to_character:this.codeToChar,operator_textStartsOrEndsWith:this.textStartsOrEndsWith,operator_countAppearTimes:this.countAppearTimes,operator_textIncludesLetterFrom:this.textIncludesLetterFrom,operator_javascript_output:this.javascriptOutput,operator_javascript_boolean:this.javascriptBoolean}}javascriptOutput(A){return new Promise((e,t)=>{const i=n.toString(A.JS);r.execute(i).then(A=>{e(A.value)})})}javascriptBoolean(A){return new Promise((e,t)=>{const i=n.toString(A.JS);r.execute(i).then(A=>{e(!0===A.value)})})}charToCode(A){const e=n.toString(A.ONE);return e?e.charCodeAt(0):NaN}codeToChar(A){const e=n.toNumber(A.ONE);return String.fromCharCode(e)}toCase(A){const e=n.toString(A.TEXT);switch(A.OPTION){case"upper":return e.toUpperCase();case"lower":return e.toLowerCase()}}indexOfTextInText(A){const e=n.toString(A.TEXT1),t=n.toString(A.TEXT2);let i=0;return t.includes(e)&&(i=t.indexOf(e)+1),i}lastIndexOfTextInText(A){const e=n.toString(A.TEXT1),t=n.toString(A.TEXT2);let i=0;return t.includes(e)&&(i=t.lastIndexOf(e)+1),i}textStartsOrEndsWith(A){const e=n.toString(A.TEXT1),t=n.toString(A.OPTION),i=n.toString(A.TEXT2);return"starts"===t?e.startsWith(i):e.endsWith(i)}countAppearTimes(A){const e=n.toString(A.TEXT2),t=n.toString(A.TEXT1),i=e.split(t);return i.length<=1?0:i.length-1}textIncludesLetterFrom(A){const e=n.toString(A.TEXT1),t=n.toString(A.TEXT2);let i=!1;return t.split("").forEach(A=>{e.includes(A)&&(i=!0)}),i}true(){return!0}false(){return!1}randomBoolean(){return Boolean(Math.round(Math.random()))}constrainnumber(A){return Math.min(Math.max(A.min,A.inp),A.max)}lerpFunc(A){const e=n.toNumber(A.ONE);return(n.toNumber(A.TWO)-e)*n.toNumber(A.AMOUNT)+e}advMath(A){const e=isNaN(n.toNumber(A.ONE))?0:n.toNumber(A.ONE),t=isNaN(n.toNumber(A.TWO))?0:n.toNumber(A.TWO);switch(n.toString(A.OPTION)){case"^":return e**t;case"root":return e**1/t;case"log":return Math.log(t)/Math.log(e);default:return 0}}advMathExpanded(A){const e=n.toNumber(A.ONE),t=n.toNumber(A.TWO),i=n.toNumber(A.THREE);switch(n.toString(A.OPTION)){case"root":return e*Math.pow(i,1/t);case"log":return e*Math.log(i)/Math.log(t);default:return 0}}stringify(A){return n.toString(A.ONE)}boolify(A){return n.toBoolean(A.ONE)}newLine(){return"\n"}tabCharacter(){return"\t"}readLineInMultilineText(A){const e=(n.toNumber(A.LINE)?n.toNumber(A.LINE):1)-1;return n.toString(A.TEXT).split("\n")[e]||""}getLettersFromIndexToIndexInTextFixed(A){const e=(n.toNumber(A.INDEX1)?n.toNumber(A.INDEX1):1)-1,t=n.toNumber(A.INDEX2)?n.toNumber(A.INDEX2):1;return n.toString(A.TEXT).substring(e,t)}getLettersFromIndexToIndexInText(A){const e=(n.toNumber(A.INDEX1)?n.toNumber(A.INDEX1):1)-1,t=(n.toNumber(A.INDEX2)?n.toNumber(A.INDEX2):1)-1;return n.toString(A.TEXT).substring(e,t)}replaceAll(A){return n.toString(A.text).replaceAll(A.term,A.res)}replaceFirst(A){return n.toString(A.text).replace(A.term,A.res)}regexmatch(A){if(!o(A.reg,A.regrule))return"[]";const e=new RegExp(A.reg,A.regrule),t=A.text.match(e);return JSON.stringify(t||[])}add(A){return n.toNumber(A.NUM1)+n.toNumber(A.NUM2)}subtract(A){return n.toNumber(A.NUM1)-n.toNumber(A.NUM2)}multiply(A){return n.toNumber(A.NUM1)*n.toNumber(A.NUM2)}divide(A){return n.toNumber(A.NUM1)/n.toNumber(A.NUM2)}power(A){return Math.pow(n.toNumber(A.NUM1),n.toNumber(A.NUM2))}lt(A){return n.compare(A.OPERAND1,A.OPERAND2)<0}equals(A){return 0===n.compare(A.OPERAND1,A.OPERAND2)}notequals(A){return!this.equals(A)}gt(A){return n.compare(A.OPERAND1,A.OPERAND2)>0}gtorequal(A){return!this.lt(A)}ltorequal(A){return!this.gt(A)}and(A){return n.toBoolean(A.OPERAND1)&&n.toBoolean(A.OPERAND2)}nand(A){return!(n.toBoolean(A.OPERAND1)&&n.toBoolean(A.OPERAND2))}nor(A){return!(n.toBoolean(A.OPERAND1)||n.toBoolean(A.OPERAND2))}xor(A){const e=n.toBoolean(A.OPERAND1),t=n.toBoolean(A.OPERAND2);return e?!t:t}xnor(A){return!this.xor(A)}or(A){return n.toBoolean(A.OPERAND1)||n.toBoolean(A.OPERAND2)}not(A){return!n.toBoolean(A.OPERAND)}random(A){return this._random(A.FROM,A.TO)}_random(A,e){const t=n.toNumber(A),i=n.toNumber(e),r=t<=i?t:i,o=t<=i?i:t;return r===o?r:n.isInt(A)&&n.isInt(e)?r+Math.floor(Math.random()*(o+1-r)):Math.random()*(o-r)+r}join(A){return n.toString(A.STRING1)+n.toString(A.STRING2)}join3(A){return n.toString(A.STRING1)+n.toString(A.STRING2)+n.toString(A.STRING3)}letterOf(A){const e=n.toNumber(A.LETTER)-1,t=n.toString(A.STRING);return e<0||e>=t.length?"":t.charAt(e)}length(A){return n.toString(A.STRING).length}contains(A){const e=function(A){return n.toString(A).toLowerCase()};return e(A.STRING1).includes(e(A.STRING2))}mod(A){const e=n.toNumber(A.NUM1),t=n.toNumber(A.NUM2);let i=e%t;return i/t<0&&(i+=t),i}round(A){return Math.round(n.toNumber(A.NUM))}mathop(A){const e=n.toString(A.OPERATOR).toLowerCase(),t=n.toNumber(A.NUM);switch(e){case"abs":return Math.abs(t);case"floor":return Math.floor(t);case"ceiling":return Math.ceil(t);case"sqrt":return Math.sqrt(t);case"sin":return Math.round(1e10*Math.sin(Math.PI*t/180))/1e10;case"cos":return Math.round(1e10*Math.cos(Math.PI*t/180))/1e10;case"tan":return i.tan(t);case"asin":return 180*Math.asin(t)/Math.PI;case"acos":return 180*Math.acos(t)/Math.PI;case"atan":return 180*Math.atan(t)/Math.PI;case"ln":return Math.log(t);case"log":return Math.log(t)/Math.LN10;case"log2":return Math.log2(t);case"e ^":return Math.exp(t);case"10 ^":return Math.pow(10,t)}return 0}advlog(A){return Math.log(n.toNumber(A.NUM2))/Math.log(n.toNumber(A.NUM1))}}},function(A,e,t){const n=t(6),i=t(2),r=t(7),o=t(35);class s{constructor(A){this.runtime=A,this.waitingSounds={},this.stopAllSounds=this.stopAllSounds.bind(this),this._stopWaitingSoundsForTarget=this._stopWaitingSoundsForTarget.bind(this),this._clearEffectsForAllTargets=this._clearEffectsForAllTargets.bind(this),this.runtime&&(this.runtime.on("PROJECT_STOP_ALL",this.stopAllSounds),this.runtime.on("PROJECT_STOP_ALL",this._clearEffectsForAllTargets),this.runtime.on("STOP_FOR_TARGET",this._stopWaitingSoundsForTarget),this.runtime.on("PROJECT_START",this._clearEffectsForAllTargets)),this._onTargetCreated=this._onTargetCreated.bind(this),this.runtime&&A.on("targetWasCreated",this._onTargetCreated)}static get STATE_KEY(){return"Scratch.sound"}static get DEFAULT_SOUND_STATE(){return{effects:{pitch:0,pan:0}}}static get MIDI_NOTE_RANGE(){return{min:36,max:96}}static get BEAT_RANGE(){return{min:0,max:100}}static get TEMPO_RANGE(){return{min:20,max:500}}static get EFFECT_RANGE(){return{pitch:{min:-360,max:360},pan:{min:-100,max:100}}}static get LARGER_EFFECT_RANGE(){return{pitch:{min:-1e3,max:1e3},pan:{min:-100,max:100}}}_getSoundState(A){let e=A.getCustomState(s.STATE_KEY);return e||(e=r.simple(s.DEFAULT_SOUND_STATE),A.setCustomState(s.STATE_KEY,e),A.soundEffects=e.effects),e}_onTargetCreated(A,e){if(e){const t=e.getCustomState(s.STATE_KEY);t&&A&&(A.setCustomState(s.STATE_KEY,r.simple(t)),this._syncEffectsForTarget(A))}}getPrimitives(){return{sound_play:this.playSound,sound_playallsounds:this.playSoundAllLolOpAOIUHFoiubea87fge87iufwhef87wye87fn,sound_playuntildone:this.playSoundAndWait,sound_stop:this.stopSpecificSound,sound_stopallsounds:this.stopAllSounds,sound_seteffectto:this.setEffect,sound_changeeffectby:this.changeEffect,sound_cleareffects:this.clearEffects,sound_sounds_menu:this.soundsMenu,sound_beats_menu:this.beatsMenu,sound_effects_menu:this.effectsMenu,sound_setvolumeto:this.setVolume,sound_changevolumeby:this.changeVolume,sound_volume:this.getVolume,sound_isSoundPlaying:this.isSoundPlaying,sound_getEffectValue:this.getEffectValue,sound_getLength:this.getLength,sound_set_stop_fadeout_to:this.setStopFadeout,sound_play_at_seconds:this.playAtSeconds,sound_play_at_seconds_until_done:this.playAtSecondsAndWait,sound_getSoundVolume:this.currentSoundVolume}}getMonitored(){return{sound_volume:{isSpriteSpecific:!0,getId:A=>"".concat(A,"_volume")},sound_getEffectValue:{isSpriteSpecific:!0,getId:(A,e)=>o("".concat(A,"_soundgetEffectValue"),e)}}}currentSoundVolume(A,e){}playAtSeconds(A,e){const t=i.toNumber(A.VALUE);t<0||this._playSoundAtTimePosition({sound:i.toString(A.SOUND_MENU),seconds:t},e,!0)}playAtSecondsAndWait(A,e){const t=i.toNumber(A.VALUE);if(!(t<0))return this._playSoundAtTimePosition({sound:i.toString(A.SOUND_MENU),seconds:t},e,!0)}_playSoundAtTimePosition(A,e,t){let{sound:n,seconds:i}=A;const r=this._getSoundIndex(n,e);if(r>=0){const{target:A}=e,{sprite:n}=A,{soundId:o}=n.sounds[r];if(n.soundBank)return!0===t?this._addWaitingSound(A.id,o):this._removeWaitingSound(A.id,o),n.soundBank.playSound(A,o,i)}}setStopFadeout(A,e){const t=i.toString(A.SOUND_MENU),n=this._getSoundIndex(t,e);if(n<0)return;const r=e.target.sprite;if(!r)return;if(!r.sounds)return;const{soundId:o}=r.sounds[n],s=r.soundBank;if(!s)return;const a=i.toNumber(A.VALUE);s.soundPlayers[o].stopFadeDecay=a<=0?0:a}getEffectValue(A,e){const t=e.target.soundEffects;if(!t)return 0;const n=i.toString(A.EFFECT).toLowerCase();if(!t.hasOwnProperty(n))return 0;return i.toNumber(t[n])}isSoundPlaying(A,e){const t=this._getSoundIndex(A.SOUND_MENU,e);if(t<0)return!1;const n=e.target.sprite;if(!n)return!1;const{soundId:i}=n.sounds[t],r=n.soundBank;if(!r)return!1;const o=r.soundPlayers;return!!o&&(!!o.hasOwnProperty(i)&&1==o[i].isPlaying)}getLength(A,e){const t=this._getSoundIndex(A.SOUND_MENU,e);if(t<0)return 0;const n=e.target.sprite;if(!n)return 0;const{soundId:r}=n.sounds[t],o=n.soundBank;if(!o)return 0;const s=o.soundPlayers;if(!s)return 0;if(!s.hasOwnProperty(r))return 0;const a=s[r].buffer;return a?i.toNumber(a.duration):0}stopSpecificSound(A,e){const t=this._getSoundIndex(A.SOUND_MENU,e);if(t<0)return;const n=e.target,i=n.sprite;if(!i)return;const{soundId:r}=i.sounds[t],o=i.soundBank;o&&o.stop(n,r)}playSound(A,e){this._playSound(A,e)}playSoundAndWait(A,e){return this._playSound(A,e,!0)}_playSound(A,e,t){const n=this._getSoundIndex(A.SOUND_MENU,e);if(n>=0){const{target:A}=e,{sprite:i}=A,{soundId:r}=i.sounds[n];if(i.soundBank)return!0===t?this._addWaitingSound(A.id,r):this._removeWaitingSound(A.id,r),i.soundBank.playSound(A,r)}}_addWaitingSound(A,e){this.waitingSounds[A]||(this.waitingSounds[A]=new Set),this.waitingSounds[A].add(e)}_removeWaitingSound(A,e){this.waitingSounds[A]&&this.waitingSounds[A].delete(e)}_getSoundIndex(A,e){const t=e.target.sprite.sounds.length;if(0===t)return-1;const i=this.getSoundIndexByName(A,e);if(-1!==i)return i;const r=parseInt(A,10);return isNaN(r)?-1:n.wrapClamp(r-1,0,t-1)}getSoundIndexByName(A,e){const t=e.target.sprite.sounds;for(let e=0;e<t.length;e++)if(t[e].name===A)return e;return-1}stopAllSounds(){if(null===this.runtime.targets)return;const A=this.runtime.targets;for(let e=0;e<A.length;e++)this._stopAllSoundsForTarget(A[e])}playSoundAllLolOpAOIUHFoiubea87fge87iufwhef87wye87fn(A,e){const t=e.target,n=t.sprite;if(n)for(let A=0;A<n.sounds.length;A++){const{soundId:e}=n.sounds[A];n.soundBank&&n.soundBank.playSound(t,e)}}_stopAllSoundsForTarget(A){A.sprite.soundBank&&(A.sprite.soundBank.stopAllSounds(A),this.waitingSounds[A.id]&&this.waitingSounds[A.id].clear())}_stopWaitingSoundsForTarget(A){if(A.sprite.soundBank&&this.waitingSounds[A.id]){for(const e of this.waitingSounds[A.id].values())A.sprite.soundBank.stop(A,e);this.waitingSounds[A.id].clear()}}setEffect(A,e){return this._updateEffect(A,e,!1)}changeEffect(A,e){return this._updateEffect(A,e,!0)}_updateEffect(A,e,t){const r=i.toString(A.EFFECT).toLowerCase(),o=i.toNumber(A.VALUE),a=this._getSoundState(e.target);if(!a.effects.hasOwnProperty(r))return;t?a.effects[r]+=o:a.effects[r]=o;const B=this.runtime.runtimeOptions.miscLimits,{min:c,max:g}=B?s.EFFECT_RANGE[r]:s.LARGER_EFFECT_RANGE[r];if(a.effects[r]=n.clamp(a.effects[r],c,g),this._syncEffectsForTarget(e.target),B)return Promise.resolve();this.runtime.requestRedraw()}_syncEffectsForTarget(A){A&&A.sprite.soundBank&&(A.soundEffects=this._getSoundState(A).effects,A.sprite.soundBank.setEffects(A))}clearEffects(A,e){this._clearEffectsForTarget(e.target)}_clearEffectsForTarget(A){const e=this._getSoundState(A);for(const A in e.effects)e.effects.hasOwnProperty(A)&&(e.effects[A]=0);this._syncEffectsForTarget(A)}_clearEffectsForAllTargets(){if(null===this.runtime.targets)return;const A=this.runtime.targets;for(let e=0;e<A.length;e++)this._clearEffectsForTarget(A[e])}setVolume(A,e){const t=i.toNumber(A.VOLUME);return this._updateVolume(t,e.target)}changeVolume(A,e){const t=i.toNumber(A.VOLUME)+e.target.volume;return this._updateVolume(t,e.target)}_updateVolume(A,e){if(A=n.clamp(A,0,100),e.volume=A,this._syncEffectsForTarget(e),this.runtime.runtimeOptions.miscLimits)return Promise.resolve();this.runtime.requestRedraw()}getVolume(A,e){return e.target.volume}soundsMenu(A){return A.SOUND_MENU}beatsMenu(A){return A.BEATS}effectsMenu(A){return A.EFFECT}}A.exports=s},function(A,e,t){const n=t(2),i=t(18),r=t(6),o=t(35),{validateRegex:s}=t(13);A.exports=class{constructor(A){this.runtime=A,this._answer="",this._timer=new i,this._cachedLoudness=-1,this._cachedLoudnessTimestamp=0,this._loudnessList=[],this._questionList=[],this.runtime.on("ANSWER",this._onAnswer.bind(this)),this.runtime.on("PROJECT_START",this._resetAnswer.bind(this)),this.runtime.on("PROJECT_STOP_ALL",this._clearAllQuestions.bind(this)),this.runtime.on("STOP_FOR_TARGET",this._clearTargetQuestions.bind(this)),this.runtime.on("RUNTIME_DISPOSED",this._resetAnswer.bind(this))}getPrimitives(){return{sensing_objecttouchingobject:this.objectTouchingObject,sensing_objecttouchingclonesprite:this.objectTouchingCloneOfSprite,sensing_touchingobject:this.touchingObject,sensing_touchingcolor:this.touchingColor,sensing_coloristouchingcolor:this.colorTouchingColor,sensing_distanceto:this.distanceTo,sensing_timer:this.getTimer,sensing_resettimer:this.resetTimer,sensing_of:this.getAttributeOf,sensing_mousex:this.getMouseX,sensing_mousey:this.getMouseY,sensing_setdragmode:this.setDragMode,sensing_mousedown:this.getMouseDown,sensing_keypressed:this.getKeyPressed,sensing_current:this.current,sensing_dayssince2000:this.daysSince2000,sensing_loudness:this.getLoudness,sensing_loud:this.isLoud,sensing_askandwait:this.askAndWait,sensing_answer:this.getAnswer,sensing_username:this.getUsername,sensing_loggedin:this.getLoggedIn,sensing_userid:()=>{},sensing_regextest:this.regextest,sensing_thing_is_number:this.thing_is_number,sensing_thing_has_number:this.thing_has_number,sensing_mobile:this.mobile,sensing_thing_is_text:this.thing_is_text,sensing_getspritewithattrib:this.getspritewithattrib,sensing_directionTo:this.getDirectionToFrom,sensing_distanceTo:this.getDistanceToFrom,sensing_isUpperCase:this.isCharecterUppercase,sensing_mouseclicked:this.mouseClicked,sensing_keyhit:this.keyHit,sensing_mousescrolling:this.mouseScrolling,sensing_fingerdown:this.fingerDown,sensing_fingertapped:this.fingerTapped,sensing_fingerx:this.getFingerX,sensing_fingery:this.getFingerY,sensing_setclipboard:this.setClipboard,sensing_getclipboard:this.getClipboard,sensing_getdragmode:this.getDragMode,sensing_getoperatingsystem:this.getOS,sensing_getbrowser:this.getBrowser,sensing_geturl:this.getUrl,sensing_getxyoftouchingsprite:this.getXYOfTouchingSprite}}getOS(){if(!("userAgent"in navigator))return"Unknown";const A=navigator.userAgent;return A.includes("Windows")?"Windows":A.includes("Android")?"Android":A.includes("iPad")||A.includes("iPod")||A.includes("iPhone")?"iOS":A.includes("Linux")?"Linux":A.includes("CrOS")?"ChromeOS":A.includes("Mac OS")?"MacOS":"Unknown"}getBrowser(){if(!("userAgent"in navigator))return"Unknown";const A=navigator.userAgent;if("userAgentData"in navigator){const A=JSON.stringify(navigator.userAgentData.brands);if(A.includes("Google Chrome"))return"Chrome";if(A.includes("Opera"))return"Opera";if(A.includes("Microsoft Edge"))return"Edge"}return A.includes("Chrome")?"Chrome":A.includes("Firefox")?"Firefox":A.includes("Safari")?"Safari":"Unknown"}getUrl(){return"href"in location?location.href:""}setClipboard(A){const e=n.toString(A.ITEM);navigator&&"clipboard"in navigator&&"writeText"in navigator.clipboard&&navigator.clipboard.writeText(e)}getClipboard(){return navigator&&"clipboard"in navigator&&"readText"in navigator.clipboard?navigator.clipboard.readText():""}getDragMode(A,e){return e.target.draggable}mouseClicked(A,e){return e.ioQuery("mouse","getIsClicked")}keyHit(A,e){return e.ioQuery("keyboard","getKeyIsHit",[A.KEY_OPTION])}mouseScrolling(A,e){const t=e.ioQuery("mouseWheel","getScrollDelta");switch(A.SCROLL_OPTION){case"up":return t<0;case"down":return t>0;default:return!1}}isCharecterUppercase(A){return/[A-Z]/g.test(A.text)}getDirectionToFrom(A,e){const t=A.x2-A.x1,n=A.y2-A.y1;return e.runtime.runtimeOptions.disableDirectionClamping?90-r.radToDeg(Math.atan2(n,t)):r.wrapClamp(90-r.radToDeg(Math.atan2(n,t)),-179,180)}getDistanceToFrom(A){const e=A.x2-A.x1,t=A.y2-A.y1;return Math.sqrt(e*e+t*t)}getspritewithattrib(A,e){const t=e.runtime.targets.map(A=>({id:A.id,name:A.sprite?A.sprite.name:"Unknown",variables:Object.values(A.variables).reduce((A,e)=>e.name?(A[e.name]=String(e.value),A):A,{})}));let n="No sprites found";for(let e=1,i=t[0];e<t.length;i=t[e++])if(i.variables[A.var]===A.val){n='{"id": "'.concat(i.id,'", "name": "').concat(i.name,'"}');break}return n}thing_is_number(A){return!n.toString(A.TEXT1).trim().endsWith(".")&&!this.thing_is_text(A)}thing_is_text(A){return isNaN(Number(A.TEXT1))}thing_has_number(A){return/\d/.test(n.toString(A.TEXT1))}mobile(){return"undefined"!=typeof window&&"ontouchstart"in window}regextest(A){if(!s(A.reg,A.regrule))return!1;return new RegExp(A.reg,A.regrule).test(A.text)}getMonitored(){return{sensing_answer:{getId:()=>"answer"},sensing_mousedown:{getId:()=>"mousedown"},sensing_mouseclicked:{getId:()=>"mouseclicked"},sensing_mousex:{getId:()=>"mousex"},sensing_mousey:{getId:()=>"mousey"},sensing_getclipboard:{getId:()=>"getclipboard"},sensing_getdragmode:{isSpriteSpecific:!0,getId:A=>"".concat(A,"_getdragmode")},sensing_loudness:{getId:()=>"loudness"},sensing_loud:{getId:()=>"loud"},sensing_timer:{getId:()=>"timer"},sensing_dayssince2000:{getId:()=>"dayssince2000"},sensing_current:{getId:(A,e)=>o("current",e)},sensing_loggedin:{getId:()=>"loggedin"}}}_onAnswer(A){this._answer=A;const e=this._questionList.shift();if(e){const[A,t,n,i,r]=e;i&&!r&&this.runtime.emit("SAY",n,"say",""),t(),this._askNextQuestion()}}_resetAnswer(){this._answer=""}_enqueueAsk(A,e,t,n,i){this._questionList.push([A,e,t,n,i])}_askNextQuestion(){if(this._questionList.length>0){const[A,e,t,n,i]=this._questionList[0];n&&!i?(this.runtime.emit("SAY",t,"say",A),this.runtime.emit("QUESTION","")):this.runtime.emit("QUESTION",A)}}_clearAllQuestions(){this._questionList=[],this.runtime.emit("QUESTION",null)}_clearTargetQuestions(A){const e=this._questionList.length>0&&this._questionList[0][2]===A;this._questionList=this._questionList.filter(e=>e[2]!==A),e&&(this.runtime.emit("SAY",A,"say",""),this._questionList.length>0?this._askNextQuestion():this.runtime.emit("QUESTION",null))}askAndWait(A,e){const t=e.target;return new Promise(e=>{const n=this._questionList.length>0;this._enqueueAsk(String(A.QUESTION),e,t,t.visible,t.isStage),n||this._askNextQuestion()})}getAnswer(){return this._answer}objectTouchingObject(A,e){const t="_myself_"===A.FULLTOUCHINGOBJECTMENU?e.target.getName():A.FULLTOUCHINGOBJECTMENU,n=A.SPRITETOUCHINGOBJECTMENU;if("_myself_"===n)return e.target.isTouchingObject(t);const i=this.runtime.getSpriteTargetByName(n);return!!i&&i.isTouchingObject(t)}objectTouchingCloneOfSprite(A,e){const t=A.FULLTOUCHINGOBJECTMENU;let n=A.SPRITETOUCHINGOBJECTMENU;if("_myself_"===n&&(n=e.target.getName()),"_myself_"===t)return e.target.isTouchingObject(n,!0);const i=this.runtime.getSpriteTargetByName(n);if(!i)return!1;if("_mouse_"===t){if(!this.runtime.ioDevices.mouse)return!1;const A=this.runtime.ioDevices.mouse.getClientX(),e=this.runtime.ioDevices.mouse.getClientY();return i.sprite.clones.filter(t=>!t.isOriginal&&t.isTouchingPoint(A,e)).length>0}if("_edge_"===t){return i.sprite.clones.filter(A=>!A.isOriginal&&A.isTouchingEdge()).length>0}const r=this.runtime.getSpriteTargetByName(t);return!!r&&r.isTouchingObject(n,!0)}touchingObject(A,e){return e.target.isTouchingObject(A.TOUCHINGOBJECTMENU)}getXYOfTouchingSprite(A,e){const t=A.SPRITE;if("_mouse_"===t){const t=e.ioQuery("mouse","getScratchX"),n=e.ioQuery("mouse","getScratchY");return"y"===A.XY?n:t}const n=e.target.spriteTouchingPoint(t);return n?"y"===A.XY?n[1]:n[0]:""}touchingColor(A,e){const t=n.toRgbColorList(A.COLOR);return e.target.isTouchingColor(t)}colorTouchingColor(A,e){const t=n.toRgbColorList(A.COLOR),i=n.toRgbColorList(A.COLOR2);return e.target.colorIsTouchingColor(i,t)}distanceTo(A,e){if(e.target.isStage)return 1e4;let t=0,i=0;if("_mouse_"===A.DISTANCETOMENU)t=e.ioQuery("mouse","getScratchX"),i=e.ioQuery("mouse","getScratchY");else{A.DISTANCETOMENU=n.toString(A.DISTANCETOMENU);const e=this.runtime.getSpriteTargetByName(A.DISTANCETOMENU);if(!e)return 1e4;t=e.x,i=e.y}const r=e.target.x-t,o=e.target.y-i;return Math.sqrt(r*r+o*o)}setDragMode(A,e){e.target.setDraggable("draggable"===A.DRAG_MODE)}getTimer(A,e){return e.ioQuery("clock","projectTimer")}resetTimer(A,e){e.ioQuery("clock","resetProjectTimer")}getMouseX(A,e){return e.ioQuery("mouse","getScratchX")}getMouseY(A,e){return e.ioQuery("mouse","getScratchY")}getMouseDown(A,e){return e.ioQuery("mouse","getIsDown")}getFingerX(A,e){return e.ioQuery("touch","getScratchX",[n.toNumber(A.FINGER_OPTION)-1])}getFingerY(A,e){return e.ioQuery("touch","getScratchY",[n.toNumber(A.FINGER_OPTION)-1])}fingerDown(A,e){return e.ioQuery("touch","getIsDown",[n.toNumber(A.FINGER_OPTION)-1])}fingerTapped(A,e){return e.ioQuery("touch","getIsTapped",[n.toNumber(A.FINGER_OPTION)-1])}current(A){const e=n.toString(A.CURRENTMENU).toLowerCase(),t=new Date;switch(e){case"year":return t.getFullYear();case"month":return t.getMonth()+1;case"date":return t.getDate();case"dayofweek":return t.getDay()+1;case"hour":return t.getHours();case"minute":return t.getMinutes();case"second":return t.getSeconds();case"timestamp":return Date.now()}return 0}getKeyPressed(A,e){return e.ioQuery("keyboard","getKeyIsDown",[A.KEY_OPTION])}daysSince2000(){const A=new Date(2e3,0,1),e=new Date,t=e.getTimezoneOffset()-A.getTimezoneOffset();let n=e.valueOf()-A.valueOf();return n+=60*(e.getTimezoneOffset()-t)*1e3,n/864e5}getLoudness(){if(void 0===this.runtime.audioEngine)return-1;if(null===this.runtime.currentStepTime)return-1;return this._timer.time()-this._cachedLoudnessTimestamp<this.runtime.currentStepTime||(this._cachedLoudnessTimestamp=this._timer.time(),this._cachedLoudness=this.runtime.audioEngine.getLoudness(),this.pushLoudness(this._cachedLoudness)),this._cachedLoudness}isLoud(){this.pushLoudness();let A=this._loudnessList.reduce((A,e)=>A+e,0);return A/=this._loudnessList.length,this.getLoudness()>A+15}pushLoudness(A){this._loudnessList.length>=30&&this._loudnessList.shift(),this._loudnessList.push(null!=A?A:this.getLoudness())}getAttributeOf(A){let e;if("_stage_"===A.OBJECT?e=this.runtime.getTargetForStage():(A.OBJECT=n.toString(A.OBJECT),e=this.runtime.getSpriteTargetByName(A.OBJECT)),!e)return 0;if(e.isStage)switch(A.PROPERTY){case"background #":case"backdrop #":return e.currentCostume+1;case"backdrop name":return e.getCostumes()[e.currentCostume].name;case"volume":return e.volume}else switch(A.PROPERTY){case"x position":return e.x;case"y position":return e.y;case"direction":return e.direction;case"costume #":return e.currentCostume+1;case"costume name":return e.getCostumes()[e.currentCostume].name;case"layer":return e.getLayerOrder();case"size":return e.size;case"volume":return e.volume}const t=A.PROPERTY,i=e.lookupVariableByNameAndType(t,"",!0);return i?i.value:0}getUsername(A,e){return e.ioQuery("userData","getUsername")}getLoggedIn(A,e){return e.ioQuery("userData","getLoggedIn")}}},function(A,e,t){function n(A,e,t){return(e=function(A){var e=function(A,e){if("object"!=typeof A||!A)return A;var t=A[Symbol.toPrimitive];if(void 0!==t){var n=t.call(A,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(A)}(A,"string");return"symbol"==typeof e?e:e+""}(e))in A?Object.defineProperty(A,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):A[e]=t,A}const i=t(2),{validateArray:r}=t(13);A.exports=class{constructor(A){n(this,"_listFilterItem",[""]),n(this,"_listFilterIndex",[0]),this.runtime=A}getPrimitives(){return{data_variable:this.getVariable,data_setvariableto:this.setVariableTo,data_changevariableby:this.changeVariableBy,data_hidevariable:this.hideVariable,data_showvariable:this.showVariable,data_listcontents:this.getListContents,data_addtolist:this.addToList,data_deleteoflist:this.deleteOfList,data_deletealloflist:this.deleteAllOfList,data_insertatlist:this.insertAtList,data_replaceitemoflist:this.replaceItemOfList,data_itemoflist:this.getItemOfList,data_itemnumoflist:this.getItemNumOfList,data_lengthoflist:this.lengthOfList,data_listcontainsitem:this.listContainsItem,data_hidelist:this.hideList,data_showlist:this.showList,data_reverselist:this.data_reverselist,data_itemexistslist:this.data_itemexistslist,data_listisempty:this.data_listisempty,data_listarray:this.data_listarray,data_arraylist:this.data_arraylist,data_listforeachnum:this.data_listforeachnum,data_listforeachitem:this.data_listforeachitem}}getVariable(A,e){return e.target.lookupOrCreateVariable(A.VARIABLE.id,A.VARIABLE.name).value}setVariableTo(A,e){const t=e.target.lookupOrCreateVariable(A.VARIABLE.id,A.VARIABLE.name);t.value=A.VALUE,t.isCloud&&e.ioQuery("cloud","requestUpdateVariable",[t.name,A.VALUE])}changeVariableBy(A,e){const t=e.target.lookupOrCreateVariable(A.VARIABLE.id,A.VARIABLE.name),n=i.toNumber(t.value)+i.toNumber(A.VALUE);t.value=n,t.isCloud&&e.ioQuery("cloud","requestUpdateVariable",[t.name,n])}changeMonitorVisibility(A,e){this.runtime.monitorBlocks.changeBlock({id:A,element:"checkbox",value:e},this.runtime)}showVariable(A){this.changeMonitorVisibility(A.VARIABLE.id,!0)}hideVariable(A){this.changeMonitorVisibility(A.VARIABLE.id,!1)}showList(A){this.changeMonitorVisibility(A.LIST.id,!0)}hideList(A){this.changeMonitorVisibility(A.LIST.id,!1)}getListContents(A,e){const t=e.target.lookupOrCreateList(A.LIST.id,A.LIST.name);if(e.thread.updateMonitor)return t._monitorUpToDate?t.value:(t._monitorUpToDate=!0,t.value.slice());let n=!0;for(let A=0;A<t.value.length;A++){const e=t.value[A];if("string"!=typeof e||1!==e.length){n=!1;break}}return n?t.value.join(""):t.value.join(" ")}addToList(A,e){const t=e.target.lookupOrCreateList(A.LIST.id,A.LIST.name);t.value.push(A.ITEM),t._monitorUpToDate=!1}deleteOfList(A,e){const t=e.target.lookupOrCreateList(A.LIST.id,A.LIST.name),n=i.toListIndex(A.INDEX,t.value.length,!0);n!==i.LIST_INVALID&&(n!==i.LIST_ALL?(t.value.splice(n-1,1),t._monitorUpToDate=!1):t.value=[])}deleteAllOfList(A,e){e.target.lookupOrCreateList(A.LIST.id,A.LIST.name).value=[]}insertAtList(A,e){const t=A.ITEM,n=e.target.lookupOrCreateList(A.LIST.id,A.LIST.name),r=i.toListIndex(A.INDEX,n.value.length+1,!1);r!==i.LIST_INVALID&&(n.value.splice(r-1,0,t),n._monitorUpToDate=!1)}replaceItemOfList(A,e){const t=A.ITEM,n=e.target.lookupOrCreateList(A.LIST.id,A.LIST.name),r=i.toListIndex(A.INDEX,n.value.length,!1);r!==i.LIST_INVALID&&(n.value[r-1]=t,n._monitorUpToDate=!1)}getItemOfList(A,e){const t=e.target.lookupOrCreateList(A.LIST.id,A.LIST.name),n=i.toListIndex(A.INDEX,t.value.length,!1);return n===i.LIST_INVALID?"":t.value[n-1]}getItemNumOfList(A,e){const t=A.ITEM,n=e.target.lookupOrCreateList(A.LIST.id,A.LIST.name);for(let A=0;A<n.value.length;A++)if(0===i.compare(n.value[A],t))return A+1;return 0}lengthOfList(A,e){return e.target.lookupOrCreateList(A.LIST.id,A.LIST.name).value.length}listContainsItem(A,e){const t=A.ITEM,n=e.target.lookupOrCreateList(A.LIST.id,A.LIST.name);if(n.value.indexOf(t)>=0)return!0;for(let A=0;A<n.value.length;A++)if(0===i.compare(n.value[A],t))return!0;return!1}data_reverselist(A,e){const t=e.target.lookupOrCreateList(A.LIST.id,A.LIST.name);t.value.reverse(),t._monitorUpToDate=!1}data_itemexistslist(A,e){const t=e.target.lookupOrCreateList(A.LIST.id,A.LIST.name);return i.toListIndex(A.INDEX,t.value.length,!1)!==i.LIST_INVALID}data_listisempty(A,e){return e.target.lookupOrCreateList(A.LIST.id,A.LIST.name).value.length<1}data_listarray(A,e){const t=e.target.lookupOrCreateList(A.LIST.id,A.LIST.name);return JSON.stringify(t.value)}data_arraylist(A,e){const t=e.target.lookupOrCreateList(A.LIST.id,A.LIST.name),n=A.VALUE;let i;if("object"==typeof n){if(Array.isArray(n))return void(t.value=n);var o;if("Object"!==(null===(o=n.constructor)||void 0===o?void 0:o.name)){if("function"==typeof n.toJSON&&(i=n.toJSON(),Array.isArray(i)))return void(t.value=i);i=n.toString()}}i=r(n).array.map(A=>"object"==typeof A?JSON.stringify(A):String(A)),t.value=i}data_listforeachnum(A,e){const t=e.target.lookupOrCreateList(A.LIST.id,A.LIST.name);void 0===e.stackFrame.loopCounter&&(e.stackFrame.loopCounter=t.value.length),e.stackFrame.loopCounter--,e.stackFrame.loopCounter>=0&&(this.setVariableTo({VARIABLE:A.INDEX,VALUE:e.stackFrame.loopCounter},e),e.startBranch(1,!0))}data_listforeachitem(A,e){const t=e.target.lookupOrCreateList(A.LIST.id,A.LIST.name);void 0===e.stackFrame.loopCounter&&(e.stackFrame.loopCounter=t.value.length),e.stackFrame.loopCounter--,e.stackFrame.loopCounter>=0&&(this.setVariableTo({VARIABLE:A.INDEX,VALUE:t.value[e.stackFrame.loopCounter]},e),e.startBranch(1,!0))}}},function(A,e,t){t(2);A.exports=class{constructor(A){this.runtime=A}getPrimitives(){return{procedures_definition:this.definition,procedures_call:this.call,procedures_set:this.set,argument_reporter_string_number:this.argumentReporterStringNumber,argument_reporter_boolean:this.argumentReporterBoolean,argument_reporter_command:this.argumentReporterCommand}}definition(){}call(A,e){if(!e.stackFrame.executed){const t=A.mutation.proccode,n=e.getProcedureParamNamesIdsAndDefaults(t);if(null===n)return;const[i,r,o]=n;e.initParams();for(let t=0;t<r.length;t++)A.hasOwnProperty(r[t])?e.pushParam(i[t],A[r[t]]):e.pushParam(i[t],o[t]);const s=e.runtime.getAddonBlock(t);if(s){const A=s.callback(e.thread.getAllparams(),e);return 1===e.thread.status&&(e.stackFrame.executed=!0),A}e.stackFrame.executed=!0,e.startProcedure(t)}}set(A,e){var t;const n=e.thread.blockContainer,i=n.getBlock(e.thread.isCompiled?e.thread.peekStack():e.thread.peekStackFrame().op.id);if(!i)return;const r=e.thread,o=n.getBlock(null===(t=i.inputs.PARAM)||void 0===t?void 0:t.block);if(o)try{null!==r.stackFrames[0].params?r.stackFrames[0].params[o.fields.VALUE.value]=A.VALUE:r.stackFrames[0].params={[o.fields.VALUE.value]:A.VALUE}}catch(A){}}argumentReporterStringNumber(A,e){const t=e.getParam(A.VALUE);return null===t?0:t}argumentReporterBoolean(A,e){const t=e.getParam(A.VALUE);return null===t?0:t}argumentReporterCommand(A,e){const t=e.getParam(A.VALUE)||{};if(null===t.entry)return;const[n,i]=e.getBranchAndTarget(t.callerId,t.entry)||[];n?e.thread.pushStack(n,i):e.thread.pushStack(null)}}},function(A,e,t){const n=t(2);A.exports=class{constructor(A){this.runtime=A}getPrimitives(){return{looks_setVertTransform:this.setVerticalTransform,looks_setHorizTransform:this.setHorizontalTransform}}setVerticalTransform(A,e){let{target:t}=e;const i=n.toNumber(A.PERCENT)/100;t.setTransform([i,t.transform[1]])}setHorizontalTransform(A,e){let{target:t}=e;const i=n.toNumber(A.PERCENT)/100;t.setTransform([t.transform[0],i])}}},function(A,e,t){function n(A,e){var t=Object.keys(A);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(A);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(A,e).enumerable}))),t.push.apply(t,n)}return t}function i(A){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?n(Object(t),!0).forEach((function(e){r(A,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(t)):n(Object(t)).forEach((function(e){Object.defineProperty(A,e,Object.getOwnPropertyDescriptor(t,e))}))}return A}function r(A,e,t){return(e=function(A){var e=function(A,e){if("object"!=typeof A||!A)return A;var t=A[Symbol.toPrimitive];if(void 0!==t){var n=t.call(A,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(A)}(A,"string");return"symbol"==typeof e?e:e+""}(e))in A?Object.defineProperty(A,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):A[e]=t,A}const{translateForCamera:o}=t(41);A.exports={setupInitialState:A=>{const e=A.renderer;for(const t of A.targets){const n=t._getRenderedDirectionAndScale();let r=i({},A.getCamera(t.cameraBound));if(r.dir=r.dir/180,r.scale=1+(r.scale-1)/100,e&&t.interpolationData){const A=t.drawableID;e.updateDrawablePosition(A,[t.x-r.pos[0],t.y-r.pos[1]]),e.updateDrawableDirectionScale(A,n.direction-r.dir,[n.scale[0]*r.scale,n.scale[1]*r.scale]),e.updateDrawableEffect(A,"ghost",t.effects.ghost)}t.visible&&!t.isStage?t.interpolationData={x:t.x-r.pos[0],y:t.y-r.pos[1],direction:n.direction-r.dir,scale:[n.scale[0]*r.scale,n.scale[1]*r.scale],costume:t.currentCostume,ghost:t.effects.ghost}:t.interpolationData=null}},interpolate:(A,e)=>{const t=A.renderer;if(t)for(const n of A.targets){const r=n.interpolationData;if(!r)continue;if(!n.visible||100===n.effects.ghost&&100===r.ghost)continue;A.emit(A.constructor.BEFORE_INTERPOLATE,n);let o=i({},A.getCamera(n.cameraBound));o.scale=1+(o.scale-1)/100;const s=n.drawableID,a=n.x-r.x-o.pos[0],B=n.y-r.y-o.pos[1],c=Math.abs(a),g=Math.abs(B);if(c>.1||g>.1){const A=t._allDrawables[s].getAABB(),n=Math.min(240,Math.max(50,1.5*(A.width+A.height)));if(Math.sqrt(c**2+g**2)<n){const A=r.x+a*e,n=r.y+B*e;t.updateDrawablePosition(s,[A,n])}}const E=n.effects.ghost-r.ghost,Q=Math.abs(E);if(Q>0&&Q<25){const A=n.effects.ghost+E*e;t.updateDrawableEffect(s,"ghost",A)}if(r.costume===n.currentCostume){let{direction:A,scale:i}=n._getRenderedDirectionAndScale();A-=o.dir/180;let a=!1;if(A!==r.direction&&(A%90!=0||r.direction%90!=0)){const t=A*Math.PI/180,n=r.direction*Math.PI/180;A=180*Math.atan2(Math.sin(t)*e+Math.sin(n)*(1-e),Math.cos(t)*e+Math.cos(n)*(1-e))/Math.PI,a=!0}const B=r.scale;if(i[0]=i[0]*o.scale,i[1]=i[1]*o.scale,(i[0]!==B[0]||i[1]!==B[1])&&Math.sign(i[0])===Math.sign(B[0])&&Math.sign(i[1])===Math.sign(B[1])){const A=i[0]-B[0],t=i[1]-B[1],n=Math.abs(A),r=Math.abs(t);n<100&&r<100&&(i[0]=B[0]+A*e,i[1]=B[1]+t*e,a=!0)}a&&t.updateDrawableDirectionScale(s,A,i)}A.emit(A.constructor.AFTER_INTERPOLATE,n)}}}},function(A,e){const t="function"==typeof requestAnimationFrame?requestAnimationFrame:A=>setTimeout(A,1e3/60),n="function"==typeof requestAnimationFrame?cancelAnimationFrame:clearTimeout,i=A=>{let e;const i=()=>{e=t(i),A()};return e=t(i),{cancel:()=>n(e)}};A.exports=class{constructor(A){this.runtime=A,this.running=!1,this.setFramerate(30),this.setInterpolation(!1),this.stepCallback=this.stepCallback.bind(this),this.interpolationCallback=this.interpolationCallback.bind(this),this._stepInterval=null,this._interpolationAnimation=null,this._stepAnimation=null,this._stepCounter=0}setFramerate(A){this.framerate=A,this._restart()}setInterpolation(A){this.interpolation=A,this._restart()}stepCallback(){this.runtime._step()}interpolationCallback(){this.runtime._renderInterpolatedPositions()}_restart(){this.running&&(this.stop(),this.start())}start(){this.running=!0,0===this.framerate?(this._stepAnimation=i(this.stepCallback),this.runtime.currentStepTime=1e3/60):(this.interpolation&&(this._interpolationAnimation=i(this.interpolationCallback)),this._stepInterval=setInterval(this.stepCallback,1e3/this.framerate),this.runtime.currentStepTime=1e3/this.framerate)}stop(){this.running=!1,clearInterval(this._stepInterval),this._interpolationAnimation&&this._interpolationAnimation.cancel(),this._stepAnimation&&this._stepAnimation.cancel(),this._interpolationAnimation=null,this._stepAnimation=null}}},function(A,e,t){const{motionVector:n,scratchAtan2:i}=t(251);A.exports=class{constructor(){this.frameNumber=0,this.lastAnalyzedFrame=0,this.motionAmount=0,this.motionDirection=0,this.curr=null,this.prev=null,this._arrays=new ArrayBuffer(345600),this._curr=new Uint8ClampedArray(this._arrays,0,172800),this._prev=new Uint8ClampedArray(this._arrays,172800,172800)}reset(){this.frameNumber=0,this.lastAnalyzedFrame=0,this.motionAmount=this.motionDirection=0,this.prev=this.curr=null}addFrame(A){this.frameNumber++,this.prev=this.curr,this.curr=new Uint32Array(A.buffer.slice(0));const e=this._prev;this._prev=this._curr,this._curr=e;for(let A=0;A<this.curr.length;A++)this._curr[A]=255&this.curr[A]}analyzeFrame(){if(!this.curr||!this.prev)return void(this.motionAmount=this.motionDirection=-1);if(this.lastAnalyzedFrame===this.frameNumber)return;this.lastAnalyzedFrame=this.frameNumber;const{_curr:A,_prev:e}=this;let t=0,r=0,o=0;for(let i=9;i<351;i+=17)for(let s=9;s<471;s+=17){let a=0,B=0,c=0,g=0,E=0,Q=480*(i-8)+s-8,u=Q+17;const l=480*(i+8)+s+8;for(;Q<=l;Q+=463,u+=480)for(;Q<=u;Q+=1){const t=e[Q]-A[Q],n=A[Q-1]-A[Q+1],i=A[Q-480]-A[Q+480];a+=n*n,B+=n*i,c+=i*i,E+=n*t,g+=i*t}const{u:w,v:h}=n(a,B,c,E,g);-17<w&&w<17&&-17<h&&h<17&&(t+=w,r+=h,o++)}t/=o,r/=o,this.motionAmount=Math.round(100*Math.hypot(t,r)),this.motionAmount>10&&(this.motionDirection=i(r,t))}getLocalMotion(A,e){if(this.curr&&this.prev){if(e.motionFrameNumber!==this.frameNumber){const{_prev:t,_curr:r}=this;A.updateCPURenderAttributes();const o=A.getFastBounds(),s=Math.max(Math.floor(o.left+240),1),a=Math.min(Math.floor(o.right+240),479),B=Math.max(Math.floor(180-o.top),1),c=Math.min(Math.floor(180-o.bottom),359);let g=0,E=0,Q=0,u=0,l=0,w=0;const h=[0,0,0];for(let e=B;e<c;e++)for(let n=s;n<a;n++)if(h[0]=n-240,h[1]=180-e,A.isTouching(h)){const A=480*e+n,i=t[A]-r[A],o=r[A-1]-r[A+1],s=r[A-480]-r[A+480];g+=o*o,E+=o*s,Q+=s*s,l+=o*i,u+=s*i,w++}let{u:C,v:I}=n(g,E,Q,l,u),M=0;w&&(M=w,w/=256,C/=w,I/=w),e.motionAmount=Math.round(.02*M*Math.hypot(C,I)),e.motionAmount>100&&(e.motionAmount=100),e.motionAmount>10/3&&(e.motionDirection=i(I,C)),e.motionFrameNumber=this.frameNumber}}else e.motionAmount=e.motionDirection=-1}}},function(A,e){const t=180/Math.PI,n={u:0,v:0},i=function(A){return(A+270)%360-180};A.exports={motionVector:function(A,e,t,i,r){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:n;const s=e*e-A*t;if(s){const n=-(r*e-i*t),a=-(e*i-A*r),B=8/s;o.u=n*B,o.v=a*B}else{const n=(e+A)*(e+A)+(t+e)*(t+e);if(n){const s=-(r+i)*(8/n);o.u=(e+A)*s,o.v=(t+e)*s}else o.u=0,o.v=0}return o},scratchDegrees:i,scratchAtan2:function(A,e){return i(Math.atan2(A,e)*t)}}},function(A,e,t){},function(A,e,t){const n=t(54);A.exports=class extends n{constructor(A,e,t,n){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=arguments.length>5?arguments[5]:void 0;super(),this._socket=A.getScratchLinkSocket("BT"),this._socket.setOnOpen(this.requestPeripheral.bind(this)),this._socket.setOnError(this._handleRequestError.bind(this)),this._socket.setOnClose(this.handleDisconnectError.bind(this)),this._socket.setHandleMessage(this._handleMessage.bind(this)),this._sendMessage=this._socket.sendMessage.bind(this._socket),this._availablePeripherals={},this._connectCallback=n,this._connected=!1,this._characteristicDidChangeCallback=null,this._resetCallback=i,this._discoverTimeoutID=null,this._extensionId=e,this._peripheralOptions=t,this._messageCallback=r,this._runtime=A,this._socket.open()}requestPeripheral(){this._availablePeripherals={},this._discoverTimeoutID&&window.clearTimeout(this._discoverTimeoutID),this._discoverTimeoutID=window.setTimeout(this._handleDiscoverTimeout.bind(this),15e3),this.sendRemoteRequest("discover",this._peripheralOptions).catch(A=>this._handleRequestError(A))}connectPeripheral(A){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const t={peripheralId:A};e&&(t.pin=e),this.sendRemoteRequest("connect",t).then(()=>{this._connected=!0,this._runtime.emit(this._runtime.constructor.PERIPHERAL_CONNECTED),this._connectCallback()}).catch(A=>{this._handleRequestError(A)})}disconnect(){this._connected&&(this._connected=!1),this._socket.isOpen()&&this._socket.close(),this._discoverTimeoutID&&window.clearTimeout(this._discoverTimeoutID),this._runtime.emit(this._runtime.constructor.PERIPHERAL_DISCONNECTED)}isConnected(){return this._connected}sendMessage(A){return this.sendRemoteRequest("send",A).catch(A=>{this.handleDisconnectError(A)})}didReceiveCall(A,e){switch(A){case"didDiscoverPeripheral":this._availablePeripherals[e.peripheralId]=e,this._runtime.emit(this._runtime.constructor.PERIPHERAL_LIST_UPDATE,this._availablePeripherals),this._discoverTimeoutID&&window.clearTimeout(this._discoverTimeoutID);break;case"userDidPickPeripheral":this._availablePeripherals[e.peripheralId]=e,this._runtime.emit(this._runtime.constructor.USER_PICKED_PERIPHERAL,this._availablePeripherals),this._discoverTimeoutID&&window.clearTimeout(this._discoverTimeoutID);break;case"userDidNotPickPeripheral":this._runtime.emit(this._runtime.constructor.PERIPHERAL_SCAN_TIMEOUT),this._discoverTimeoutID&&window.clearTimeout(this._discoverTimeoutID);break;case"didReceiveMessage":this._messageCallback(e);break;default:return"nah"}}handleDisconnectError(){this._connected&&(this.disconnect(),this._resetCallback&&this._resetCallback(),this._runtime.emit(this._runtime.constructor.PERIPHERAL_CONNECTION_LOST_ERROR,{message:"Scratch lost connection to",extensionId:this._extensionId}))}_handleRequestError(){this._runtime.emit(this._runtime.constructor.PERIPHERAL_REQUEST_ERROR,{message:"Scratch lost connection to",extensionId:this._extensionId})}_handleDiscoverTimeout(){this._discoverTimeoutID&&window.clearTimeout(this._discoverTimeoutID),this._runtime.emit(this._runtime.constructor.PERIPHERAL_SCAN_TIMEOUT)}}},function(A,e,t){},function(A,e,t){},function(A,e,t){},function(A,e,t){A.exports=function(){"use strict";function e(A,e,t,n,i,r,o){try{var s=A[r](o),a=s.value}catch(A){return void t(A)}s.done?e(a):Promise.resolve(a).then(n,i)}function n(A){return function(){var t=this,n=arguments;return new Promise((function(i,r){var o=A.apply(t,n);function s(A){e(o,i,r,s,a,"next",A)}function a(A){e(o,i,r,s,a,"throw",A)}s(void 0)}))}}function i(A,e){if(!(A instanceof e))throw new TypeError("Cannot call a class as a function")}function r(A,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(A,n.key,n)}}function o(A,e,t){return e&&r(A.prototype,e),t&&r(A,t),A}function s(A,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");A.prototype=Object.create(e&&e.prototype,{constructor:{value:A,writable:!0,configurable:!0}}),e&&function(A,e){(Object.setPrototypeOf||function(A,e){return A.__proto__=e,A})(A,e)}(A,e)}function a(A){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(A){return A.__proto__||Object.getPrototypeOf(A)})(A)}function B(A,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(A){if(void 0===A)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A}(A):e}!function(e){var t,n=Object.prototype,i=n.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",s=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag",B="object"==typeof A,c=e.regeneratorRuntime;if(c)B&&(A.exports=c);else{(c=e.regeneratorRuntime=B?A.exports:{}).wrap=M;var g="suspendedStart",E="suspendedYield",Q="executing",u="completed",l={},w={};w[o]=function(){return this};var h=Object.getPrototypeOf,C=h&&h(h(T([])));C&&C!==n&&i.call(C,o)&&(w=C);var I=F.prototype=m.prototype=Object.create(w);p.prototype=I.constructor=F,F.constructor=p,F[a]=p.displayName="GeneratorFunction",c.isGeneratorFunction=function(A){var e="function"==typeof A&&A.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},c.mark=function(A){return Object.setPrototypeOf?Object.setPrototypeOf(A,F):(A.__proto__=F,a in A||(A[a]="GeneratorFunction")),A.prototype=Object.create(I),A},c.awrap=function(A){return{__await:A}},D(Y.prototype),Y.prototype[s]=function(){return this},c.AsyncIterator=Y,c.async=function(A,e,t,n){var i=new Y(M(A,e,t,n));return c.isGeneratorFunction(e)?i:i.next().then((function(A){return A.done?A.value:i.next()}))},D(I),I[a]="Generator",I[o]=function(){return this},I.toString=function(){return"[object Generator]"},c.keys=function(A){var e=[];for(var t in A)e.push(t);return e.reverse(),function t(){for(;e.length;){var n=e.pop();if(n in A)return t.value=n,t.done=!1,t}return t.done=!0,t}},c.values=T,y.prototype={constructor:y,reset:function(A){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(U),!A)for(var e in this)"t"===e.charAt(0)&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var A=this.tryEntries[0].completion;if("throw"===A.type)throw A.arg;return this.rval},dispatchException:function(A){if(this.done)throw A;var e=this;function n(n,i){return s.type="throw",s.arg=A,e.next=n,i&&(e.method="next",e.arg=t),!!i}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=i.call(o,"catchLoc"),B=i.call(o,"finallyLoc");if(a&&B){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!B)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(A,e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var r=n;break}}r&&("break"===A||"continue"===A)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var o=r?r.completion:{};return o.type=A,o.arg=e,r?(this.method="next",this.next=r.finallyLoc,l):this.complete(o)},complete:function(A,e){if("throw"===A.type)throw A.arg;return"break"===A.type||"continue"===A.type?this.next=A.arg:"return"===A.type?(this.rval=this.arg=A.arg,this.method="return",this.next="end"):"normal"===A.type&&e&&(this.next=e),l},finish:function(A){for(var e=this.tryEntries.length-1;e>=0;--e){var t=this.tryEntries[e];if(t.finallyLoc===A)return this.complete(t.completion,t.afterLoc),U(t),l}},catch:function(A){for(var e=this.tryEntries.length-1;e>=0;--e){var t=this.tryEntries[e];if(t.tryLoc===A){var n=t.completion;if("throw"===n.type){var i=n.arg;U(t)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(A,e,n){return this.delegate={iterator:T(A),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=t),l}}}function M(A,e,t,n){var i=e&&e.prototype instanceof m?e:m,r=Object.create(i.prototype),o=new y(n||[]);return r._invoke=function(A,e,t){var n=g;return function(i,r){if(n===Q)throw new Error("Generator is already running");if(n===u){if("throw"===i)throw r;return x()}for(t.method=i,t.arg=r;;){var o=t.delegate;if(o){var s=f(o,t);if(s){if(s===l)continue;return s}}if("next"===t.method)t.sent=t._sent=t.arg;else if("throw"===t.method){if(n===g)throw n=u,t.arg;t.dispatchException(t.arg)}else"return"===t.method&&t.abrupt("return",t.arg);n=Q;var a=d(A,e,t);if("normal"===a.type){if(n=t.done?u:E,a.arg===l)continue;return{value:a.arg,done:t.done}}"throw"===a.type&&(n=u,t.method="throw",t.arg=a.arg)}}}(A,t,o),r}function d(A,e,t){try{return{type:"normal",arg:A.call(e,t)}}catch(A){return{type:"throw",arg:A}}}function m(){}function p(){}function F(){}function D(A){["next","throw","return"].forEach((function(e){A[e]=function(A){return this._invoke(e,A)}}))}function Y(A){var e;this._invoke=function(t,n){function r(){return new Promise((function(e,r){!function e(t,n,r,o){var s=d(A[t],A,n);if("throw"!==s.type){var a=s.arg,B=a.value;return B&&"object"==typeof B&&i.call(B,"__await")?Promise.resolve(B.__await).then((function(A){e("next",A,r,o)}),(function(A){e("throw",A,r,o)})):Promise.resolve(B).then((function(A){a.value=A,r(a)}),(function(A){return e("throw",A,r,o)}))}o(s.arg)}(t,n,e,r)}))}return e=e?e.then(r,r):r()}}function f(A,e){var n=A.iterator[e.method];if(n===t){if(e.delegate=null,"throw"===e.method){if(A.iterator.return&&(e.method="return",e.arg=t,f(A,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var i=d(n,A.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,l;var r=i.arg;return r?r.done?(e[A.resultName]=r.value,e.next=A.nextLoc,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,l):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function N(A){var e={tryLoc:A[0]};1 in A&&(e.catchLoc=A[1]),2 in A&&(e.finallyLoc=A[2],e.afterLoc=A[3]),this.tryEntries.push(e)}function U(A){var e=A.completion||{};e.type="normal",delete e.arg,A.completion=e}function y(A){this.tryEntries=[{tryLoc:"root"}],A.forEach(N,this),this.reset(!0)}function T(A){if(A){var e=A[o];if(e)return e.call(A);if("function"==typeof A.next)return A;if(!isNaN(A.length)){var n=-1,r=function e(){for(;++n<A.length;)if(i.call(A,n))return e.value=A[n],e.done=!1,e;return e.value=t,e.done=!0,e};return r.next=r}}return{next:x}}function x(){return{value:t,done:!0}}}(function(){return this||"object"==typeof self&&self}()||Function("return this")());var c=new Uint8Array([88,0,0,0]),g=new Uint8Array([26,165,74,6,73,7,72,8,71,9,70,10,69,11,68,12,67,13,66,14,65]),E=new Uint8Array([24,255,1,0,0,0,0,0,0,0,0,0,0,0,0]),Q=new Uint8Array([25,255,0,255,255,255,255]),u=new Uint8Array([27,255,0,0,0,0,0,0,0,0,0]),l={HEADER:c,INIT:g,DISCONNECT:new Uint8Array([84]),START_MEASUREMENTS:E,STOP_MEASUREMENTS:Q,SET_MEASUREMENT_PERIOD:u,GET_INFO:new Uint8Array([85]),GET_STATUS:new Uint8Array([16]),GET_SENSOR_IDS:new Uint8Array([81]),GET_SENSOR_INFO:new Uint8Array([80,0]),GET_DEFAULT_SENSORS_MASK:new Uint8Array([86])},w=function(A){return 0!==A},h=function(){function A(){i(this,A),this._listenerMap=new Map}return o(A,[{key:"on",value:function(A,e){this._listenerMap.has(A)||this._listenerMap.set(A,[]),this._listenerMap.get(A).push(e)}},{key:"off",value:function(A,e){var t=this._listenerMap.get(A);if(t&&t.length){var n=t.reduce((function(A,t,n){return"function"==typeof t&&t===e?A=n:A}),-1);if(n>-1)return t.splice(n,1),this._listenerMap.set(A,t),!0}return!1}},{key:"unbind",value:function(){this._listenerMap.clear()}},{key:"emit",value:function(A){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];var i=this._listenerMap.get(A);return!(!i||!i.length||(i.forEach((function(A){A.apply(void 0,t)})),0))}}]),A}();function C(A){return Array.from(new Uint8Array(A)).map((function(A){return A.toString(16).padStart(2,"0")})).join(" ")}var I,M=function A(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,A),this.type=e.type,this.mode=e.mode,this.minValue=e.minValue,this.maxValue=e.maxValue,this.uncertainty=e.uncertainty,this.minPeriod=e.minPeriod,this.maxPeriod=e.maxPeriod,this.typicalPeriod=e.typicalPeriod,this.granularity=e.granularity},d=function A(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,A),this.number=e.number,this.name=e.name,this.unit=e.unit,this.id=e.id,this.mutalExclusionMask=e.mutalExclusionMask,this.measurementInfo=e.measurementInfo},m=function(A){function e(A){var t;return i(this,e),(t=B(this,a(e).call(this))).number=A.number,t.name=A.name,t.unit=A.unit,t.specs=A,t.enabled=!1,t.values=[],t.value=null,t}return s(e,h),o(e,[{key:"clear",value:function(){this.value=null,this.values=[]}},{key:"setValue",value:function(A,e){this.value=A,e&&this.values.push(this.value),this.emit("value-changed",this)}},{key:"setEnabled",value:function(A){this.enabled!==A&&(this.enabled=A,this.emit("state-changed",this))}}]),e}(),p=function(A){function e(A){var n;if(i(this,e),n=B(this,a(e).call(this)),"undefined"==typeof TextDecoder){var r=t(30);I=r.TextDecoder}else I=TextDecoder;return n.device=A,n.sensors=[],n.opened=!1,n.rollingCounter=0,n.collecting=!1,n.measurementPeriod=10,n.response=null,n.remainingResponseLength=0,n.defaultSensorsMask=0,n.keepValues=!0,n.minMeasurementPeriod=10,n.serialNumber="",n.orderCode="",n.name="",n}return s(e,h),o(e,[{key:"getBatteryLevel",value:function(){var A=n(regeneratorRuntime.mark((function A(){var e;return regeneratorRuntime.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,this._getStatus();case 2:return e=A.sent,A.abrupt("return",e.battery);case 4:case"end":return A.stop()}}),A,this)})));return function(){return A.apply(this,arguments)}}()},{key:"getChargingState",value:function(){var A=n(regeneratorRuntime.mark((function A(){var e;return regeneratorRuntime.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,this._getStatus();case 2:return e=A.sent,A.abrupt("return",e.chargingStatus);case 4:case"end":return A.stop()}}),A,this)})));return function(){return A.apply(this,arguments)}}()},{key:"open",value:function(){var A=n(regeneratorRuntime.mark((function A(){var e,t=arguments;return regeneratorRuntime.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:return e=t.length>0&&void 0!==t[0]&&t[0],A.prev=1,A.next=4,this._connect();case 4:return A.next=6,this._init();case 6:return A.next=8,this._getStatus();case 8:return A.next=10,this._getDeviceInfo();case 10:return A.next=12,this._getDefaultSensorsMask();case 12:return A.next=14,this._getAvailableSensors();case 14:this._onOpened(),e&&this.start(),A.next=21;break;case 18:A.prev=18,A.t0=A.catch(1),console.error(A.t0);case 21:case"end":return A.stop()}}),A,this,[[1,18]])})));return function(){return A.apply(this,arguments)}}()},{key:"close",value:function(){var A=n(regeneratorRuntime.mark((function A(){return regeneratorRuntime.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,this._stopMeasurements();case 2:return A.next=4,this._sendCommand(l.DISCONNECT);case 4:return A.abrupt("return",this._disconnect());case 5:case"end":return A.stop()}}),A,this)})));return function(){return A.apply(this,arguments)}}()},{key:"enableDefaultSensors",value:function(){for(var A=1,e=0;e<32;++e){if((this.defaultSensorsMask&A)===A){var t=this.getSensor(e);t&&t.setEnabled(!0)}A<<=1}}},{key:"start",value:function(){var A=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.sensors.filter((function(A){return A.enabled}));0===e.length&&(this.enableDefaultSensors(),e=this.sensors.filter((function(A){return A.enabled}))),e.forEach((function(A){return A.clear()})),A&&(this.measurementPeriod=A),this._startMeasurements()}},{key:"stop",value:function(){this._stopMeasurements()}},{key:"getSensor",value:function(A){return this.sensors.find((function(e){return e.number===A}))}},{key:"_connect",value:function(){var A=n(regeneratorRuntime.mark((function A(){var e=this;return regeneratorRuntime.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:return A.abrupt("return",this.device.setup({onClosed:function(){return e._onClosed()},onResponse:function(A){return e._handleResponse(A)}}));case 1:case"end":return A.stop()}}),A,this)})));return function(){return A.apply(this,arguments)}}()},{key:"_disconnect",value:function(){var A=n(regeneratorRuntime.mark((function A(){return regeneratorRuntime.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:return A.abrupt("return",this.device.close());case 1:case"end":return A.stop()}}),A,this)})));return function(){return A.apply(this,arguments)}}()},{key:"_init",value:function(){return this.collecting=!1,this.rollingCounter=255,this.writeQueue=[],this._sendCommand(l.INIT)}},{key:"_handleResponse",value:function(A){if("command notified: ".concat(C(A.buffer)),this.remainingResponseLegnth>0){if(this.remainingResponseLegnth-=A.buffer.byteLength,this.response=new DataView((e=this.response.buffer,t=A.buffer.slice(0),(n=new Uint8Array(e.byteLength+t.byteLength)).set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer)),this.remainingResponseLegnth>0)return}else this.response=A;var e,t,n,i=this.response.getUint8(1);if(i>this.response.buffer.byteLength)this.remainingResponseLegnth=i-this.response.buffer.byteLength;else switch("handle command: ".concat(C(this.response.buffer)),this.response.getUint8(0)){case 32:this._processMeasurements(this.response);break;default:var r=this.response.getUint8(4),o=this.response.getUint8(5),s=new DataView(this.response.buffer,6);this._resolveWriteCommand(r,o,s),this.remainingResponseLegnth=0,this.response=null}}},{key:"_getSensorsWithMask",value:function(A){for(var e=[],t=1,n=0;n<32;++n){if((A&t)===t){var i=this.getSensor(n);i&&(e.push(i),"available: [".concat(A,"] ").concat(e[e.length-1].number))}t<<=1}return e}},{key:"_processMeasurements",value:function(A){var e=[],t=!0,n=0,i=0,r=A.getUint8(4);switch(r){case 6:e=this._getSensorsWithMask(A.getUint16(5,!0)),n=A.getUint8(7,!0),i=9;break;case 7:e=this._getSensorsWithMask(A.getUint32(5,!0)),n=A.getUint8(9,!0),i=11;break;case 10:case 8:e[0]=this.getSensor(A.getUint8(6)),n=A.getUint8(7,!0),i=8;break;case 11:case 9:e[0]=this.getSensor(A.getUint8(6)),n=A.getUint8(7,!0),i=8,t=!1;break;case 12:case 13:case 14:"Purposely Ignoring packet type: ".concat(r);break;default:"Unknown packet type: ".concat(r)}for(var o=0;o<n;++o)for(var s=0;s<e.length;++s)t?e[s].setValue(A.getFloat32(i,!0),this.keepValues):e[s].setValue(A.getInt32(i,!0),this.keepValues),i+=4}},{key:"_resolveWriteCommand",value:function(A,e,t){var n=this.writeQueue.find((function(t){return t.command===A&&t.rollingCounter===e}));n&&(n.resolve(t),this.writeQueue=this.writeQueue.filter((function(A){return A!==n})))}},{key:"_onOpened",value:function(){this.opened=!0,this.emit("device-opened")}},{key:"_onClosed",value:function(){this.opened=!1,this.emit("device-closed")}},{key:"_decRollingCounter",value:function(){return this.rollingCounter-=1,this.rollingCounter}},{key:"_calculateChecksum",value:function(A){for(var e=A[1],t=-1*A[3],n=0;n<e;++n)t+=A[n],t&=255;return t<0||t>255?0:t}},{key:"_sendCommand",value:function(A){var e=new Uint8Array(l.HEADER.byteLength+A.byteLength);return e.set(new Uint8Array(l.HEADER),0),e.set(new Uint8Array(A),l.HEADER.byteLength),e[1]=e.length,e[2]=this._decRollingCounter(),e[3]=this._calculateChecksum(e),this._queueWriteCommand(e,0,e.length)}},{key:"_writeCommand",value:function(){var A=n(regeneratorRuntime.mark((function A(e,t,n){var i;return regeneratorRuntime.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:if(!(n>0)){A.next=12;break}return A.prev=1,n>20?(i=e.subarray(t,t+20),n-=20,t+=20):(i=e.subarray(t,t+n),n=0),A.next=5,this.device.writeCommand(i);case 5:A.next=10;break;case 7:A.prev=7,A.t0=A.catch(1),"Write Failure: ".concat(A.t0);case 10:A.next=0;break;case 12:case"end":return A.stop()}}),A,this,[[1,7]])})));return function(e,t,n){return A.apply(this,arguments)}}()},{key:"_queueWriteCommand",value:function(A,e,t){var n=this;"command queued: ".concat(C(A));var i=new Promise((function(e,t){n.writeQueue.push({command:A[4],rollingCounter:A[2],resolve:e,reject:t}),setTimeout((function(){n.writeQueue=n.writeQueue.filter((function(e){return e.command===A[4]&&e.rollingCounter!==A[2]})),t(new Error("write command timed out after 5s. Command: ".concat(A[4].toString(16)," Rolling Counter: ").concat(A[2].toString(16))))}),1e4)}));return this._writeCommand(A,e,t),i}},{key:"_getStatus",value:function(){var A=n(regeneratorRuntime.mark((function A(){var e,t;return regeneratorRuntime.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,this._sendCommand(l.GET_STATUS);case 2:return e=A.sent,t={masterFirmwareVersion:"".concat(e.getUint8(2),".").concat(e.getUint8(3)),bleFirmwareVersion:"".concat(e.getUint8(6),".").concat(e.getUint8(9)),battery:e.getUint8(10),chargingStatus:"".concat(e.getUint8(11))},A.abrupt("return",t);case 5:case"end":return A.stop()}}),A,this)})));return function(){return A.apply(this,arguments)}}()},{key:"_getAvailableSensors",value:function(){var A=n(regeneratorRuntime.mark((function A(){var e,t,n=this;return regeneratorRuntime.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,this._sendCommand(l.GET_SENSOR_IDS).then((function(A){n.availableSensors=A.getUint32(0,!0),"Get Available Sensors Returned ".concat(n.availableSensors)}));case 2:e=1,t=0;case 4:if(!(t<31)){A.next=12;break}if((this.availableSensors&e)!==e){A.next=8;break}return A.next=8,this._getSensorInfo(t);case 8:e<<=1;case 9:++t,A.next=4;break;case 12:case"end":return A.stop()}}),A,this)})));return function(){return A.apply(this,arguments)}}()},{key:"_getDefaultSensorsMask",value:function(){var A=this;return this._sendCommand(l.GET_DEFAULT_SENSORS_MASK).then((function(e){A.defaultSensorsMask=e.getUint32(0,!0)}))}},{key:"_getDeviceInfo",value:function(){var A=this;return this._sendCommand(l.GET_INFO).then((function(e){var t=new I("utf-8");A.orderCode=t.decode(new Uint8Array(e.buffer,6,16).filter(w)),A.serialNumber=t.decode(new Uint8Array(e.buffer,22,16).filter(w)),A.name=t.decode(new Uint8Array(e.buffer,38,32).filter(w))}))}},{key:"_getSensorInfo",value:function(){var A=n(regeneratorRuntime.mark((function A(e){var t,n=this;return regeneratorRuntime.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:return(t=new Uint8Array(l.GET_SENSOR_INFO))[1]=e,A.abrupt("return",this._sendCommand(t).then((function(A){var e=A.getUint32(2,!0);if(e>0){var t=new I("utf-8"),i=new M({type:A.getUint8(6),mode:A.getUint8(7),minValue:A.getFloat64(108,!0),maxValue:A.getFloat64(116,!0),uncertainty:A.getFloat64(100,!0),minPeriod:A.getUint32(124,!0)/1e3,maxPeriod:((A.getUint32(132,!0)<<32)+A.getUint32(128,!0))/1e3,typicalPeriod:A.getUint32(136,!0)/1e3,granularity:A.getUint32(140,!0)/1e3}),r=new d({number:A.getUint8(0),name:t.decode(new Uint8Array(A.buffer,14,60).filter(w)),unit:t.decode(new Uint8Array(A.buffer,74,32).filter(w)),mutalExclusiveMask:A.getUint32(144,!0),measurementInfo:i,sensorId:e}),o=new m(r);n.sensors.push(o),o.on("state-changed",(function(){"Sensor Restart: ".concat(o.number),o.enabled&&(n.measurementPeriod=o.specs.measurementInfo.typicalPeriod,n.sensors.forEach((function(A){if(o.number!==A.number&&A.enabled){var e=1<<A.number;(e&o.specs.mutalExclusiveMask)===e?A.enabled=!1:A.specs.measurementInfo.typicalPeriod>n.measurementPeriod&&(n.measurementPeriod=A.specs.measurementInfo.typicalPeriod)}}))),n._restartMeasurements()}))}})));case 3:case"end":return A.stop()}}),A,this)})));return function(e){return A.apply(this,arguments)}}()},{key:"_restartMeasurements",value:function(){var A=n(regeneratorRuntime.mark((function A(){var e;return regeneratorRuntime.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:if(e=this.collecting,!this.collecting){A.next=10;break}return A.prev=2,A.next=5,this._stopMeasurements();case 5:A.next=10;break;case 7:A.prev=7,A.t0=A.catch(2),console.error(A.t0);case 10:if(this.collecting||!e){A.next=19;break}return A.prev=11,A.next=14,this._startMeasurements();case 14:A.next=19;break;case 16:A.prev=16,A.t1=A.catch(11),console.error(A.t1);case 19:case"end":return A.stop()}}),A,this,[[2,7],[11,16]])})));return function(){return A.apply(this,arguments)}}()},{key:"_setMeasurementPeriod",value:function(A){var e=new Uint8Array(l.SET_MEASUREMENT_PERIOD),t=1e3*this.minMeasurementPeriod;return A<t&&(A=t),"MeasurementPeriod: ".concat(A),e[3]=A>>0&255,e[4]=A>>8&255,e[5]=A>>16&255,e[6]=A>>24&255,this._sendCommand(e)}},{key:"_getEnabledChannelMask",value:function(){var A=0;return this.sensors.filter((function(A){return A.enabled})).forEach((function(e){A+=1<<e.number})),A}},{key:"_startMeasurements",value:function(){var A=this;return this._setMeasurementPeriod(1e3*this.measurementPeriod).then((function(){var e=A._getEnabledChannelMask();"ChannelMask: ".concat(e);var t=new Uint8Array(l.START_MEASUREMENTS);return t[3]=e>>0&255,t[4]=e>>8&255,t[5]=e>>16&255,t[6]=e>>24&255,A._sendCommand(t).then((function(e){0===e.getUint8(0)&&(A.collecting=!0,A.emit("measurements-started"))}))}))}},{key:"_stopMeasurements",value:function(){var A=this;return this._sendCommand(l.STOP_MEASUREMENTS).then((function(e){0===e.getUint8(0)&&(A.collecting=!1,A.emit("measurements-stopped"))}))}}]),e}(),F=function(){function A(e){i(this,A),this.webBluetoothNativeDevice=e,this.deviceCommand=null,this.deviceResponse=null}return o(A,[{key:"writeCommand",value:function(){var A=n(regeneratorRuntime.mark((function A(e){return regeneratorRuntime.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:return A.abrupt("return",this.deviceCommand.writeValue(e));case 1:case"end":return A.stop()}}),A,this)})));return function(e){return A.apply(this,arguments)}}()},{key:"setup",value:function(){var A=n(regeneratorRuntime.mark((function A(e){var t,n,i,r,o=this;return regeneratorRuntime.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:return t=e.onClosed,n=e.onResponse,this.webBluetoothNativeDevice.addEventListener("gattserverdisconnected",t),A.prev=2,A.next=5,this.webBluetoothNativeDevice.gatt.connect();case 5:return i=A.sent,A.next=8,i.getPrimaryService("d91714ef-28b9-4f91-ba16-f0d9a604f112");case 8:return r=A.sent,A.next=11,r.getCharacteristics();case 11:A.sent.forEach((function(A){switch(A.uuid){case"f4bf14a6-c7d5-4b6d-8aa8-df1a7c83adcb":o.deviceCommand=A;break;case"b41e6675-a329-40e0-aa01-44d2f444babe":o.deviceResponse=A,o.deviceResponse.addEventListener("characteristicvaluechanged",(function(A){var e=A.target.value;n(e)})),o.deviceResponse.startNotifications();break;default:"No case found for ".concat(A.uuid)}})),A.next=18;break;case 15:A.prev=15,A.t0=A.catch(2),console.error(A.t0);case 18:if(this.deviceCommand&&this.deviceResponse){A.next=20;break}throw new Error("Expected command and response characteristics not found.");case 20:case"end":return A.stop()}}),A,this,[[2,15]])})));return function(e){return A.apply(this,arguments)}}()},{key:"close",value:function(){var A=n(regeneratorRuntime.mark((function A(){return regeneratorRuntime.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:return A.abrupt("return",this.webBluetoothNativeDevice.gatt.disconnect());case 1:case"end":return A.stop()}}),A,this)})));return function(){return A.apply(this,arguments)}}()},{key:"godirectAdapter",get:function(){return!0}}]),A}(),D={createDevice:function(){var A=n(regeneratorRuntime.mark((function A(e){var t,n,i,r,o,s,a,B=arguments;return regeneratorRuntime.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:if(t=B.length>1&&void 0!==B[1]?B[1]:{},n=t.open,i=void 0===n||n,r=t.startMeasurements,o=void 0===r||r,(s=e).godirectAdapter||(s=new F(e)),a=new p(s),!i){A.next=14;break}return A.prev=5,A.next=8,a.open(o);case 8:A.next=14;break;case 10:throw A.prev=10,A.t0=A.catch(5),console.error(A.t0),A.t0;case 14:return A.abrupt("return",a);case 15:case"end":return A.stop()}}),A,this,[[5,10]])})));return function(e){return A.apply(this,arguments)}}(),selectDevice:function(){var A=n(regeneratorRuntime.mark((function A(){var e;return regeneratorRuntime.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:if(navigator.bluetooth){A.next=2;break}return A.abrupt("return",Promise.reject(new Error("No Web Bluetooth support.")));case 2:return A.next=4,navigator.bluetooth.requestDevice({filters:[{namePrefix:"GDX"}],optionalServices:["d91714ef-28b9-4f91-ba16-f0d9a604f112"]});case 4:return e=A.sent,A.abrupt("return",D.createDevice(e));case 6:case"end":return A.stop()}}),A,this)})));return function(){return A.apply(this,arguments)}}()};return D}()},function(A,e,t){const n=t(23);A.exports=class{constructor(A,e){let{service:t,commandChar:n,responseChar:i}=e;this.socket=A,this._service=t,this._commandChar=n,this._responseChar=i,this._onResponse=this._onResponse.bind(this),this._deviceOnResponse=null}get godirectAdapter(){return!0}writeCommand(A){const e=n.uint8ArrayToBase64(A);return this.socket.write(this._service,this._commandChar,e,"base64")}setup(A){let{onResponse:e}=A;return this._deviceOnResponse=e,this.socket.startNotifications(this._service,this._responseChar,this._onResponse)}_onResponse(A){const e=n.base64ToUint8Array(A),t=new DataView(e.buffer);return this._deviceOnResponse(t)}}},function(A,e,t){const n=t(4),i=t(3),r=t(1),o=t(2),s=(t(8),t(7)),a=t(18),B="";A.exports=class{constructor(A){this.runtime=A,this._onTargetWillExit=this._onTargetWillExit.bind(this),this.runtime.on("targetWasRemoved",this._onTargetWillExit),this._onTargetCreated=this._onTargetCreated.bind(this),this.runtime.on("targetWasCreated",this._onTargetCreated),this.runtime.on("PROJECT_STOP_ALL",this.stopAll.bind(this))}get FONT_IDS(){return["Sans Serif","Serif","Handwriting","Marker","Curly","Pixel","Playful","Bubbly","Arcade","Bits and Bytes","Technological","Scratch","Archivo","Archivo Black"]}get DEFAULT_TEXT_STATE(){return{skinId:null,text:"Welcome to my project!",font:"Handwriting",color:"hsla(225, 15%, 40%, 1)",size:24,maxWidth:480,align:"center",strokeWidth:0,strokeColor:"black",rainbow:!1,visible:!1,targetSize:null,fullText:null}}get STATE_KEY(){return"Scratch.text"}_getFonts(){return[{text:"Sans Serif",value:"Sans Serif"},{text:"Serif",value:"Serif"},{text:"Handwriting",value:"Handwriting"},{text:"Marker",value:"Marker"},{text:"Curly",value:"Curly"},{text:"Pixel",value:"Pixel"},{text:"Playful",value:"Playful"},{text:"Bubbly",value:"Bubbly"},{text:"Arcade",value:"Arcade"},{text:"Bits and Bytes",value:"Bits and Bytes"},{text:"Technological",value:"Technological"},{text:"Scratch",value:"Scratch"},{text:"Archivo",value:"Archivo"},{text:"Archivo Black",value:"Archivo Black"},...this.runtime.fontManager.getFonts().map(A=>({text:A.name,value:A.family})),{text:"random font",value:"Random"}]}getInfo(){return{id:"text",name:"Animated Text",blockIconURI:B,menuIconURI:"",color1:"#9966ff",color2:"#8a5ce6",color3:"#7a52cc",blocks:[{opcode:"setText",text:n({id:"text.setText",default:"show text [TEXT]",description:""}),blockType:r.COMMAND,arguments:{TEXT:{type:i.STRING,defaultValue:"Welcome to my project!"}}},{opcode:"animateText",text:n({id:"text.animateText",default:"[ANIMATE] text [TEXT]",description:""}),blockType:r.COMMAND,arguments:{ANIMATE:{type:i.STRING,menu:"ANIMATE",defaultValue:"rainbow"},TEXT:{type:i.STRING,defaultValue:"Here we go!"}}},{opcode:"clearText",text:n({id:"text.clearText",default:"show sprite",description:""}),blockType:r.COMMAND,arguments:{}},"---",{opcode:"setFont",text:n({id:"text.setFont",default:"set font to [FONT]",description:""}),blockType:r.COMMAND,arguments:{FONT:{type:i.STRING,menu:"FONT",defaultValue:"Pixel"}}},{opcode:"setColor",text:n({id:"text.setColor",default:"set text color to [COLOR]",description:""}),blockType:r.COMMAND,arguments:{COLOR:{type:i.COLOR}}},{opcode:"setWidth",text:n({id:"text.setWidth",default:"set width to [WIDTH] aligned [ALIGN]",description:""}),blockType:r.COMMAND,arguments:{WIDTH:{type:i.NUMBER,defaultValue:200},ALIGN:{type:i.STRING,defaultValue:"left",menu:"ALIGN"}}},{opcode:"rainbow",text:n({id:"text.rainbow",default:"rainbow for [SECS] seconds",description:""}),blockType:r.COMMAND,arguments:{SECS:{type:i.NUMBER,defaultValue:1}}},"---",{opcode:"addLine",text:n({id:"text.addLine",default:"add line [TEXT]",description:""}),blockType:r.COMMAND,arguments:{TEXT:{type:i.STRING,defaultValue:"more lines!"}}},"---",{opcode:"setOutlineWidth",text:n({id:"text.setOutlineWidth",default:"set outline width to [WIDTH]",description:""}),blockType:r.COMMAND,arguments:{WIDTH:{type:i.NUMBER,defaultValue:1}}},{opcode:"setOutlineColor",text:n({id:"text.setOutlineColor",default:"set outline color to [COLOR]",description:""}),blockType:r.COMMAND,arguments:{COLOR:{type:i.COLOR}}},"---",{opcode:"getVisible",text:"is text visible?",blockType:r.BOOLEAN},{opcode:"getWidth",text:"get width of the text",blockType:r.REPORTER},{opcode:"getHeight",text:"get height of the text",blockType:r.REPORTER},{opcode:"getDisplayedText",blockType:r.REPORTER,text:"displayed text"},{opcode:"getRender",blockType:r.REPORTER,text:"get data uri of last rendered text"},{opcode:"setAlignment",blockType:r.COMMAND,text:"(NOT USABLE YET) align text to [ALIGN]",hideFromPalette:!0,arguments:{ALIGN:{type:i.STRING,menu:"twAlign"}}},{opcode:"setWidthValue",blockType:r.COMMAND,text:"(NOT USABLE YET) set width to [WIDTH]",hideFromPalette:!0,arguments:{WIDTH:{type:i.NUMBER,defaultValue:200}}},{opcode:"resetWidth",blockType:r.COMMAND,text:"(NOT USABLE YET) reset text width",hideFromPalette:!0},"---",{opcode:"getLines",blockType:r.REPORTER,text:"(NOT USABLE YET) # of lines",hideFromPalette:!0,disableMonitor:!0},"---",{opcode:"startAnimate",blockType:r.COMMAND,text:"(NOT USABLE YET) start [ANIMATE] animation",hideFromPalette:!0,arguments:{ANIMATE:{type:i.STRING,menu:"twAnimate",defaultValue:"rainbow"}}},{opcode:"animateUntilDone",blockType:r.COMMAND,text:"(NOT USABLE YET) animate [ANIMATE] until done",hideFromPalette:!0,arguments:{ANIMATE:{type:i.STRING,menu:"twAnimate",defaultValue:"rainbow"}}},{opcode:"isAnimating",blockType:r.BOOLEAN,text:"(NOT USABLE YET) is animating?",hideFromPalette:!0,disableMonitor:!0},"---",{opcode:"setAnimateDuration",blockType:r.COMMAND,text:"(NOT USABLE YET) set [ANIMATE] duration to [NUM] seconds",hideFromPalette:!0,arguments:{ANIMATE:{type:i.STRING,menu:"twAnimateDuration",defaultValue:"rainbow"},NUM:{type:i.NUMBER,defaultValue:3}}},{opcode:"resetAnimateDuration",blockType:r.COMMAND,text:"(NOT USABLE YET) reset [ANIMATE] duration",hideFromPalette:!0,arguments:{ANIMATE:{type:i.STRING,menu:"twAnimateDuration",defaultValue:"rainbow"}}},{opcode:"getAnimateDuration",blockType:r.REPORTER,text:"(NOT USABLE YET) [ANIMATE] duration",hideFromPalette:!0,arguments:{ANIMATE:{type:i.STRING,menu:"twAnimateDuration",defaultValue:"rainbow"}}},"---",{opcode:"setTypeDelay",blockType:r.COMMAND,text:"(NOT USABLE YET) set typing delay to [NUM] seconds",hideFromPalette:!0,arguments:{NUM:{type:i.NUMBER,defaultValue:.1}}},{opcode:"resetTypeDelay",blockType:r.COMMAND,text:"(NOT USABLE YET) reset typing delay",hideFromPalette:!0},{opcode:"getTypeDelay",blockType:r.REPORTER,text:"(NOT USABLE YET) typing delay",hideFromPalette:!0,disableMonitor:!0},"---",{opcode:"textActive",blockType:r.BOOLEAN,text:"(TURBOWARP BLOCK) is showing text?",hideFromPalette:!0,disableMonitor:!0},{opcode:"getTextAttribute",blockType:r.REPORTER,text:"(NOT USABLE YET) text [ATTRIBUTE]",arguments:{ATTRIBUTE:{type:i.STRING,menu:"twAnimate"}},disableMonitor:!0,hideFromPalette:!0}],menus:{FONT:{items:"_getFonts",isTypeable:!0},ALIGN:{items:[{text:"left",value:"left"},{text:"center",value:"center"},{text:"right",value:"right"}]},ANIMATE:{items:[{text:"type",value:"type"},{text:"rainbow",value:"rainbow"},{text:"zoom",value:"zoom"}]},twAnimate:{acceptReporters:!0,items:[{text:"type",value:"type"},{text:"rainbow",value:"rainbow"},{text:"zoom",value:"zoom"}]},twAnimateDuration:{acceptReporters:!0,items:[{text:"rainbow",value:"rainbow"},{text:"zoom",value:"zoom"}]},twAlign:{acceptReporters:!0,items:[{text:"left",value:"left"},{text:"center",value:"center"},{text:"right",value:"right"}]}}}}setText(A,e){const t=this._getTextState(e.target);t.text=this._formatText(A.TEXT),t.visible=!0,t.animating=!1,this._renderText(e.target)}clearText(A,e){const t=e.target,n=this._getTextState(t);n.visible=!1,n.animating=!1;const i=t.getCostumes()[t.currentCostume];i&&this.runtime.renderer.updateDrawableSkinId(t.drawableID,i.skinId)}stopAll(){this.runtime.targets.forEach(A=>{this.clearText({},{target:A})})}addLine(A,e){const t=this._getTextState(e.target);t.text+="\n".concat(this._formatText(A.TEXT)),t.visible=!0,t.animating=!1,this._renderText(e.target)}setFont(A,e){const t=this._getTextState(e.target);"Random"===A.FONT?t.font=this._randomFontOtherThan(t.font):t.font=A.FONT,this._renderText(e.target)}_randomFontOtherThan(A){const e=this.FONT_IDS.filter(e=>e!==A);return e[Math.floor(Math.random()*e.length)]}setColor(A,e){this._getTextState(e.target).color=o.toString(A.COLOR),this._renderText(e.target)}setWidth(A,e){const t=this._getTextState(e.target);t.maxWidth=o.toNumber(A.WIDTH),t.align=A.ALIGN,this._renderText(e.target)}setSize(A,e){this._getTextState(e.target).size=o.toNumber(A.SIZE),this._renderText(e.target)}setAlign(A,e){const t=this._getTextState(e.target);t.maxWidth=o.toNumber(A.WIDTH),t.align=A.ALIGN,this._renderText(e.target)}setOutlineWidth(A,e){this._getTextState(e.target).strokeWidth=o.toNumber(A.WIDTH),this._renderText(e.target)}setOutlineColor(A,e){const t=this._getTextState(e.target);t.strokeColor=o.toString(A.COLOR),t.visible=!0,this._renderText(e.target)}textActive(A,e){return this.getVisible(A,e)}getVisible(A,e){return this._getTextState(e.target).visible}getDisplayedText(A,e){return this._getTextState(e.target).text}getRender(A,e){const t=this._getTextSkin(e.target);if(t)return t._canvas.toDataURL()}getWidth(A,e){const t=this._getTextSkin(e.target);return t?t.width:0}getHeight(A,e){const t=this._getTextSkin(e.target);return t?t.height:0}_getTextSkin(A){const e=this._getTextState(A);if(!e)return;if(!e.skinId)return;return this.runtime.renderer._allSkins[e.skinId]}_animateText(A,e){var t;const n=e.target,i=this._getTextState(n);if(null===i.fullText)return i.fullText=this._formatText(A.TEXT),i.text=null!==(t=i.fullText[0])&&void 0!==t?t:"",i.visible=!0,i.animating=!0,this._renderText(n),this.runtime.requestRedraw(),new Promise(A=>{const e=setInterval(()=>{i.animating&&i.visible&&i.text!==i.fullText?i.text=i.fullText.substring(0,i.text.length+1):(i.fullText=null,clearInterval(e),A()),this._renderText(n),this.runtime.requestRedraw()},60)})}_zoomText(A,e){const t=e.target,n=this._getTextState(t);if(null!==n.targetSize)return;const i=new a,r=1e3*o.toNumber(A.SECS||.5);return n.text=this._formatText(A.TEXT),n.visible=!0,n.animating=!0,n.targetSize=t.size,t.setSize(0),this._renderText(t),this.runtime.requestRedraw(),i.start(),new Promise(A=>{const e=setInterval(()=>{const o=i.timeElapsed();n.animating&&n.visible&&o<r?t.setSize(n.targetSize*o/r):(t.setSize(n.targetSize),n.targetSize=null,clearInterval(e),A()),this._renderText(t),this.runtime.requestRedraw()},this.runtime.currentStepTime)})}animateText(A,e){switch(A.ANIMATE){case"rainbow":return this.rainbow(A,e);case"type":return this._animateText(A,e);case"zoom":return this._zoomText(A,e)}}rainbow(A,e){const t=e.target,n=this._getTextState(t);if(n.rainbow)return;const i=new a,r=1e3*o.toNumber(A.SECS||2);return A.TEXT||(A.TEXT=n.text,n.visible)?(n.text=this._formatText(A.TEXT),n.visible=!0,n.animating=!0,n.rainbow=!0,this._renderText(t),i.start(),new Promise(A=>{const e=setInterval(()=>{const o=i.timeElapsed();n.animating&&n.visible&&o<r?(n.rainbow=!0,t.setEffect("color",o/-5)):(n.rainbow=!1,t.setEffect("color",0),clearInterval(e),A()),this._renderText(t)},this.runtime.currentStepTime)})):void 0}_getTextState(A){let e=A.getCustomState(this.STATE_KEY);return e||(e=s.simple(this.DEFAULT_TEXT_STATE),A.setCustomState(this.STATE_KEY,e)),e}_formatText(A){return""===A?A:("number"==typeof A&&Math.abs(A)>=.01&&A%1!=0&&(A=A.toFixed(2)),A=o.toString(A))}_renderText(A){if(!this.runtime.renderer)return;const e=this._getTextState(A);if(!e.visible)return;const t=null===e.skinId;e.skinId=this.runtime.renderer.updateTextCostumeSkin(e),this.runtime.renderer.updateDrawableSkinId(A.drawableID,e.skinId),t&&queueMicrotask(()=>{var A;null===(A=this.runtime.renderer._allSkins[e.skinId])||void 0===A||A.setTextAndStyle(e)})}_onTargetCreated(A,e){if(e){const t=e.getCustomState(this.STATE_KEY);if(t){A.setCustomState(this.STATE_KEY,s.simple(t));const e=A.getCustomState(this.STATE_KEY);e.skinId=null,e.rainbow=!1,e.targetSize=null,e.fullText=null,e.animating=!1;const n=()=>{this._renderText(A),A.off("EVENT_TARGET_VISUAL_CHANGE",n)};A.on("EVENT_TARGET_VISUAL_CHANGE",n)}}}_onTargetWillExit(A){const e=this._getTextState(A);e.skinId&&(this.runtime.renderer.destroySkin(e.skinId),e.skinId=null)}setAlignment(A){}setWidthValue(A){}resetWidth(A){}getLines(A){}startAnimate(A){}animateUntilDone(A){}isAnimating(A){}setAnimateDuration(A){}resetAnimateDuration(A){}getAnimateDuration(A){}setTypeDelay(A){}resetTypeDelay(A){}getTypeDelay(A){}textActive(A){}getTextAttribute(A){}}},function(A,e,t){const n=t(4),i=t(1),r=t(3),o=t(2),s="data:image/svg+xml;base64,".concat(btoa(''));A.exports=class{constructor(A){this.runtime=A}getInfo(){return{id:"tw",name:"TurboWarp",color1:"#ff4c4c",color2:"#e64444",color3:"#c73a3a",docsURI:"https://docs.turbowarp.org/blocks",menuIconURI:s,blockIconURI:s,blocks:[{opcode:"getLastKeyPressed",text:n({id:"tw.blocks.lastKeyPressed",default:"last key pressed",description:"Block that returns the last key that was pressed"}),blockType:i.REPORTER},{opcode:"getButtonIsDown",text:n({id:"tw.blocks.buttonIsDown",default:"[MOUSE_BUTTON] mouse button down?",description:"Block that returns whether a specific mouse button is down"}),blockType:i.BOOLEAN,arguments:{MOUSE_BUTTON:{type:r.NUMBER,menu:"mouseButton",defaultValue:"0"}}}],menus:{mouseButton:{items:[{text:n({id:"tw.blocks.mouseButton.primary",default:"(0) primary",description:"Dropdown item to select primary (usually left) mouse button"}),value:"0"},{text:n({id:"tw.blocks.mouseButton.middle",default:"(1) middle",description:"Dropdown item to select middle mouse button"}),value:"1"},{text:n({id:"tw.blocks.mouseButton.secondary",default:"(2) secondary",description:"Dropdown item to select secondary (usually right) mouse button"}),value:"2"}],acceptReporters:!0}}}}getLastKeyPressed(A,e){return e.ioQuery("keyboard","getLastKeyPressed")}getButtonIsDown(A,e){const t=o.toNumber(A.MOUSE_BUTTON);return e.ioQuery("mouse","getButtonIsDown",[t])}}},function(A,e,t){},function(A,e,t){},function(A,e,t){function n(A,e){var t=Object.keys(A);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(A);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(A,e).enumerable}))),t.push.apply(t,n)}return t}function i(A){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?n(Object(t),!0).forEach((function(e){r(A,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(t)):n(Object(t)).forEach((function(e){Object.defineProperty(A,e,Object.getOwnPropertyDescriptor(t,e))}))}return A}function r(A,e,t){return(e=function(A){var e=function(A,e){if("object"!=typeof A||!A)return A;var t=A[Symbol.toPrimitive];if(void 0!==t){var n=t.call(A,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(A)}(A,"string");return"symbol"==typeof e?e:e+""}(e))in A?Object.defineProperty(A,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):A[e]=t,A}const o=t(1),s=t(3),a=t(99),B=t(2),c=t(264),g='<sep gap="36"/>',E="\n%b26> \n%b27> \n%b28> \n%b29> \n%b30> \n%b31> "+"\n".concat(g,"\n%b34> ")+"\n%b35> "+"\n".concat(g,'\n<block type="operator_nand">\n    <value name="OPERAND1">\n        <shadow type="checkbox" />\n    </value>\n    <value name="OPERAND2">\n        <shadow type="checkbox" />\n    </value>\n</block>\n<block type="operator_nor">\n    <value name="OPERAND1">\n        <shadow type="checkbox" />\n    </value>\n    <value name="OPERAND2">\n        <shadow type="checkbox" />\n    </value>\n</block>\n<block type="operator_xor">\n    <value name="OPERAND1">\n        <shadow type="checkbox" />\n    </value>\n    <value name="OPERAND2">\n        <shadow type="checkbox" />\n    </value>\n</block>\n<block type="operator_xnor">\n    <value name="OPERAND1">\n        <shadow type="checkbox" />\n    </value>\n    <value name="OPERAND2">\n        <shadow type="checkbox" />\n    </value>\n</block>\n<block type="operator_randomBoolean" />\n').concat(g,"\n%b20> ")+'\n<block type="operator_countAppearTimes">\n    <value name="TEXT1">\n        <shadow type="text">\n            <field name="TEXT">a</field>\n        </shadow>\n    </value>\n    <value name="TEXT2">\n        <shadow type="text">\n            <field name="TEXT">abc abc abc</field>\n        </shadow>\n    </value>\n</block>\n<block type="operator_readLineInMultilineText">\n    <value name="LINE">\n        <shadow type="math_number">\n            <field name="NUM">1</field>\n        </shadow>\n    </value>\n    <value name="TEXT">\n        <shadow type="text">\n            <field name="TEXT">Text with multiple lines here</field>\n        </shadow>\n    </value>\n</block>\n<block type="operator_textIncludesLetterFrom">\n    <value name="TEXT1">\n        <shadow type="text">\n            <field name="TEXT">abcdef</field>\n        </shadow>\n    </value>\n    <value name="TEXT2">\n        <shadow type="text">\n            <field name="TEXT">fgh</field>\n        </shadow>\n    </value>\n</block>\n'.concat(g,"\n%b21> ")+"\n%b22> \n%b23> "+"\n".concat(g,"\n%b24> ")+"\n%b25> "+'\n<block type="operator_character_to_code">\n    <value name="ONE">\n        <shadow type="text">\n            <field name="TEXT">a</field>\n        </shadow>\n    </value>\n</block>\n<block type="operator_code_to_character">\n    <value name="ONE">\n        <shadow type="text">\n            <field name="TEXT">97</field>\n        </shadow>\n    </value>\n</block>\n'.concat(g,"\n")+"\n%b18> "+"\n".concat(g,"\n%b6> ")+"\n%b7> "+"\n".concat(g,"\n%b12> ")+"\n%b15> \n%b13> \n%b14> \n%b19> \n%b11> \n%b36> "+"\n".concat(g,"\n%b16> ")+"\n%b17> "+"\n".concat(g,"\n%b32> ")+"\n%b33> "+"\n".concat(g,"\n")+"\n".concat(g,"\n%b8> ")+"\n%b9> \n%b10> "+"\n".concat(g,"\n"),Q=a(vm);function u(A){const e=["apple","banana","pear","orange","mango","strawberry","pineapple","grape","kiwi"],t=[],n={};for(let i=0;i<A;i++)t.push("[STRING".concat(i+1,"]")),n["STRING".concat(i+1)]={type:s.STRING,defaultValue:e[i]+(i===A-1?"":" ")};const i="join".concat(A),r="join ".concat(t.join(" "));return{opcode:i,text:Q({id:i,default:r}),blockType:o.REPORTER,disableMonitor:!0,arguments:n}}function l(A){const e=[];for(let t=3;t<A;t++)e.push(u(t+1));return e.map((e,t)=>{const n=[];for(let e=3;e<A;e++)e!=t+3?n.push("join".concat(e+1)):n.push({isNoop:!0});return e.switchText="join x".concat(t+4),e.switches=n,e})}function w(A,e,t){switch(t){case 1:const t={};for(let n=0;n<A;n++){let i="".concat(e," ");for(let e=0;e<A;e++)i+="[STRING".concat(e+1,"]");t["join".concat(n+1)]=i}return t}}A.exports=class{constructor(A){this.runtime=A,Q.setup({"zh-cn":i({},w(9,"",1)),"zh-tw":i({},w(9,"",1))}),this.replacers=Object.create(null),this.runtime.registerCompiledExtensionBlocks("pmOperatorsExpansion",this.getCompileInfo())}orderCategoryBlocks(A){let e=E,t=0;for(const n of A)e=e.replace("%b".concat(t,">"),n),t++;return[e]}getInfo(){return{id:"pmOperatorsExpansion",name:"Operators Expansion",color1:"#59C059",color2:"#46B946",color3:"#389438",isDynamic:!0,orderBlocks:this.orderCategoryBlocks,blocks:[...l(9),{opcode:"partOfRatio",text:"[PART] part of ratio [RATIO]",blockType:o.REPORTER,disableMonitor:!0,arguments:{PART:{type:s.STRING,menu:"part"},RATIO:{type:s.STRING,defaultValue:"1:2"}},switches:[{isNoop:!0},"simplifyRatio"],switchText:"part of ratio"},{opcode:"simplifyRatio",text:"simplify ratio [RATIO]",blockType:o.REPORTER,disableMonitor:!0,arguments:{RATIO:{type:s.STRING,defaultValue:"1:2"}},switches:["partOfRatio",{isNoop:!0}],switchText:"simplify ratio"},{opcode:"pi",text:"",blockType:o.REPORTER,disableMonitor:!0,switches:[{isNoop:!0},"euler","infinity"]},{opcode:"euler",text:"e",blockType:o.REPORTER,disableMonitor:!0,switches:["pi",{isNoop:!0},"infinity"]},{opcode:"infinity",text:"",blockType:o.REPORTER,disableMonitor:!0,switches:["pi","euler",{isNoop:!0}]},{opcode:"truncateNumber",text:"truncate number [NUM]",blockType:o.REPORTER,disableMonitor:!0,arguments:{NUM:{type:s.NUMBER,defaultValue:"2.5"}}},{opcode:"isNumberMultipleOf",text:"is [NUM] multiple of [MULTIPLE]?",blockType:o.BOOLEAN,disableMonitor:!0,arguments:{NUM:{type:s.NUMBER,defaultValue:"20"},MULTIPLE:{type:s.NUMBER,defaultValue:"10"}},switches:[{isNoop:!0},"isInteger","isPrime","isEven"],switchText:"is multiple of?"},{opcode:"isInteger",text:"is [NUM] an integer?",blockType:o.BOOLEAN,disableMonitor:!0,arguments:{NUM:{type:s.NUMBER,defaultValue:"0.5"}},switches:["isNumberMultipleOf",{isNoop:!0},"isPrime","isEven"],switchText:"is integer?"},{opcode:"isPrime",text:"is [NUM] a prime number?",blockType:o.BOOLEAN,disableMonitor:!0,arguments:{NUM:{type:s.NUMBER,defaultValue:"13"}},switches:["isNumberMultipleOf","isInteger",{isNoop:!0},"isEven"],switchText:"is prime?"},{opcode:"isEven",text:"is [NUM] even?",blockType:o.BOOLEAN,disableMonitor:!0,arguments:{NUM:{type:s.NUMBER,defaultValue:"4"}},switches:["isNumberMultipleOf","isInteger","isPrime",{isNoop:!0}],switchText:"is even?"},{opcode:"reverseChars",text:"reverse [TEXT]",blockType:o.REPORTER,disableMonitor:!0,arguments:{TEXT:{type:s.STRING,defaultValue:"Hello!"}},switches:[{isNoop:!0},"shuffleChars"],switchText:"reverse text"},{opcode:"shuffleChars",text:"shuffle [TEXT]",blockType:o.REPORTER,disableMonitor:!0,arguments:{TEXT:{type:s.STRING,defaultValue:"Hello!"}},switches:["reverseChars",{isNoop:!0}],switchText:"shuffle text"},{opcode:"exactlyEqual",text:"[ONE] exactly equals [TWO]?",blockType:o.BOOLEAN,disableMonitor:!0,arguments:{ONE:{type:s.STRING,defaultValue:"a"},TWO:{type:s.STRING,defaultValue:"b"}}},{opcode:"betweenNumbers",text:"is [NUM] between [MIN] and [MAX]?",blockType:o.BOOLEAN,disableMonitor:!0,arguments:{NUM:{type:s.NUMBER,defaultValue:5},MIN:{type:s.NUMBER,defaultValue:0},MAX:{type:s.NUMBER,defaultValue:10}}},{opcode:"evaluateMath",text:"answer to [EQUATION]",blockType:o.REPORTER,disableMonitor:!0,arguments:{EQUATION:{type:s.STRING,defaultValue:"5 * 2"}}},{opcode:"setReplacer",text:"set replacer [REPLACER] to [TEXT]",blockType:o.COMMAND,arguments:{REPLACER:{type:s.STRING,defaultValue:"${replacer}"},TEXT:{type:s.STRING,defaultValue:"world"}},switches:[{isNoop:!0},"resetReplacers"],switchText:"set replacer"},{opcode:"resetReplacers",text:"reset replacers",blockType:o.COMMAND,switches:["setReplacer",{isNoop:!0}],switchText:"reset replacers"},{opcode:"applyReplacers",text:"apply replacers to [TEXT]",blockType:o.REPORTER,disableMonitor:!0,arguments:{TEXT:{type:s.STRING,defaultValue:"Hello ${replacer}!"}}},{opcode:"textAfter",text:"text after [TEXT] in [BASE]",blockType:o.REPORTER,disableMonitor:!0,arguments:{TEXT:{type:s.STRING,defaultValue:"Hello"},BASE:{type:s.STRING,defaultValue:"Hello world!"}},switches:[{isNoop:!0},"textBefore"],switchText:"text after"},{opcode:"textBefore",text:"text before [TEXT] in [BASE]",blockType:o.REPORTER,disableMonitor:!0,arguments:{TEXT:{type:s.STRING,defaultValue:"world"},BASE:{type:s.STRING,defaultValue:"Hello world!"}},switches:["textAfter",{isNoop:!0}],switchText:"text before"},{opcode:"shiftLeft",text:"[num1] << [num2]",blockType:o.REPORTER,disableMonitor:!0,arguments:{num1:{type:s.NUMBER,defaultValue:"1"},num2:{type:s.NUMBER,defaultValue:"5"}},switches:[{isNoop:!0},"shiftRight","binnaryAnd","binnaryOr","binnaryXor","binnaryNot"],switchText:"lshift"},{opcode:"shiftRight",text:"[num1] >> [num2]",blockType:o.REPORTER,disableMonitor:!0,arguments:{num1:{type:s.NUMBER,defaultValue:"32"},num2:{type:s.NUMBER,defaultValue:"5"}},switches:["shiftLeft",{isNoop:!0},"binnaryAnd","binnaryOr","binnaryXor","binnaryNot"],switchText:"rshift"},{opcode:"binnaryAnd",text:"[num1] & [num2]",blockType:o.REPORTER,disableMonitor:!0,arguments:{num1:{type:s.NUMBER,defaultValue:"32"},num2:{type:s.NUMBER,defaultValue:"5"}},switches:["shiftLeft","shiftRight",{isNoop:!0},"binnaryOr","binnaryXor","binnaryNot"],switchText:"and"},{opcode:"binnaryOr",text:"[num1] | [num2]",blockType:o.REPORTER,disableMonitor:!0,arguments:{num1:{type:s.NUMBER,defaultValue:"7"},num2:{type:s.NUMBER,defaultValue:"8"}},switches:["shiftLeft","shiftRight","binnaryAnd",{isNoop:!0},"binnaryXor","binnaryNot"],switchText:"or"},{opcode:"binnaryXor",text:"[num1] ^ [num2]",blockType:o.REPORTER,disableMonitor:!0,arguments:{num1:{type:s.NUMBER,defaultValue:"7"},num2:{type:s.NUMBER,defaultValue:"2"}},switches:["shiftLeft","shiftRight","binnaryAnd","binnaryOr",{isNoop:!0},"binnaryNot"],switchText:"xor"},{opcode:"binnaryNot",text:"~ [num1]",blockType:o.REPORTER,disableMonitor:!0,arguments:{num1:{type:s.NUMBER,defaultValue:"2"}},switches:["shiftLeft","shiftRight","binnaryAnd","binnaryOr","binnaryXor",{isNoop:!0}],switchText:"not"},{opcode:"speedToPitch",text:"speed [SPEED] to pitch",blockType:o.REPORTER,disableMonitor:!0,arguments:{SPEED:{type:s.NUMBER,defaultValue:"2"}},switches:[{isNoop:!0},{opcode:"pitchToSpeed",remapArguments:{SPEED:"PITCH"}}],switchText:"speed to pitch"},{opcode:"pitchToSpeed",text:"pitch [PITCH] to speed",blockType:o.REPORTER,disableMonitor:!0,arguments:{PITCH:{type:s.NUMBER,defaultValue:"120"}},switches:[{opcode:"speedToPitch",remapArguments:{PITCH:"SPEED"}},{isNoop:!0}],switchText:"pitch to speed"},{opcode:"orIfFalsey",text:"[ONE] or else [TWO]",blockType:o.REPORTER,allowDropAnywhere:!0,disableMonitor:!0,arguments:{ONE:{type:s.STRING,defaultValue:"a"},TWO:{type:s.STRING,defaultValue:"b"}}},{opcode:"ifIsTruthy",text:"if [ONE] is true then [TWO]",blockType:o.REPORTER,allowDropAnywhere:!0,disableMonitor:!0,arguments:{ONE:{type:s.BOOLEAN},TWO:{type:s.STRING,defaultValue:"perfect!"}}},{opcode:"atan2",text:"atan2 of x [X] y [Y]",blockType:o.REPORTER,arguments:{X:{type:s.NUMBER,defaultValue:"45"},Y:{type:s.NUMBER,defaultValue:"90"}}}],menus:{part:{acceptReporters:!0,items:["first","last"].map(A=>({text:A,value:A}))}}}}getCompileInfo(){return{ir:{shiftLeft:(A,e)=>({kind:"input",num1:A.descendInputOfBlock(e,"num1"),num2:A.descendInputOfBlock(e,"num2")}),shiftRight:(A,e)=>({kind:"input",num1:A.descendInputOfBlock(e,"num1"),num2:A.descendInputOfBlock(e,"num2")}),binnaryAnd:(A,e)=>({kind:"input",num1:A.descendInputOfBlock(e,"num1"),num2:A.descendInputOfBlock(e,"num2")}),binnaryOr:(A,e)=>({kind:"input",num1:A.descendInputOfBlock(e,"num1"),num2:A.descendInputOfBlock(e,"num2")}),binnaryXor:(A,e)=>({kind:"input",num1:A.descendInputOfBlock(e,"num1"),num2:A.descendInputOfBlock(e,"num2")}),binnaryNot:(A,e)=>({kind:"input",num1:A.descendInputOfBlock(e,"num1")}),orIfFalsey:(A,e)=>({kind:"input",one:A.descendInputOfBlock(e,"ONE"),two:A.descendInputOfBlock(e,"TWO")}),ifIsTruthy:(A,e)=>({kind:"input",one:A.descendInputOfBlock(e,"ONE"),two:A.descendInputOfBlock(e,"TWO")}),speedToPitch:(A,e)=>({kind:"input",speed:A.descendInputOfBlock(e,"SPEED")}),pitchToSpeed:(A,e)=>({kind:"input",pitch:A.descendInputOfBlock(e,"PITCH")}),atan2:(A,e)=>({kind:"input",x:A.descendInputOfBlock(e,"X"),y:A.descendInputOfBlock(e,"Y")})},js:{shiftLeft:(A,e,t)=>{let{TypedInput:n,TYPE_NUMBER:i}=t;const r=e.descendInput(A.num1).asNumber(),o=e.descendInput(A.num2).asNumber();return new n("(".concat(r," << ").concat(o,")"),i)},shiftRight:(A,e,t)=>{let{TypedInput:n,TYPE_NUMBER:i}=t;const r=e.descendInput(A.num1).asNumber(),o=e.descendInput(A.num2).asNumber();return new n("(".concat(r," >> ").concat(o,")"),i)},binnaryAnd:(A,e,t)=>{let{TypedInput:n,TYPE_NUMBER:i}=t;const r=e.descendInput(A.num1).asNumber(),o=e.descendInput(A.num2).asNumber();return new n("(".concat(r," & ").concat(o,")"),i)},binnaryOr:(A,e,t)=>{let{TypedInput:n,TYPE_NUMBER:i}=t;const r=e.descendInput(A.num1).asNumber(),o=e.descendInput(A.num2).asNumber();return new n("(".concat(r," | ").concat(o,")"),i)},binnaryXor:(A,e,t)=>{let{TypedInput:n,TYPE_NUMBER:i}=t;const r=e.descendInput(A.num1).asNumber(),o=e.descendInput(A.num2).asNumber();return new n("(".concat(r," ^ ").concat(o,")"),i)},binnaryNot:(A,e,t)=>{let{TypedInput:n,TYPE_NUMBER:i}=t;const r=e.descendInput(A.num1).asNumber();return new n("(~".concat(r,")"),i)},orIfFalsey:(A,e,t)=>{let{TypedInput:n,TYPE_UNKNOWN:i}=t;const r=e.descendInput(A.one).asUnknown(),o=e.descendInput(A.two).asUnknown();return new n("(".concat(r," || ").concat(o,")"),i)},ifIsTruthy:(A,e,t)=>{let{TypedInput:n,TYPE_UNKNOWN:i}=t;const r=e.descendInput(A.one).asBoolean(),o=e.descendInput(A.two).asUnknown();return new n("(".concat(r," && ").concat(o,")"),i)},speedToPitch:(A,e,t)=>{let{TypedInput:n,TYPE_NUMBER_NAN:i}=t;const r=e.descendInput(A.speed).asNumber();return new n("((1200 * Math.log2(".concat(r,")) / 10)"),i)},pitchToSpeed:(A,e,t)=>{let{TypedInput:n,TYPE_NUMBER_NAN:i}=t;const r=e.descendInput(A.pitch).asNumber();return new n("(Math.pow(2, (".concat(r," * 10) / 1200))"),i)},atan2:(A,e,t)=>{let{TypedInput:n,TYPE_NUMBER_NAN:i}=t;const r=e.descendInput(A.x).asNumber(),o=e.descendInput(A.y).asNumber();return new n("(Math.atan2((".concat(o," * 180) / Math.PI, (").concat(r," * 180) / Math.PI))"),i)}}}}reduce(A,e){let t=function A(e,t){return t?A(t,e%t):e};return t=t(A,e),[A/t,e/t]}checkPrime(A){if((A=Math.trunc(A))<=1)return!1;for(let e=2;e<A;e++)if(A%e==0)return!1;return!0}pi(){return Math.PI}euler(){return Math.E}infinity(){return 1/0}partOfRatio(A){const e=B.toString(A.RATIO),t=B.toString(A.PART).toLowerCase();if(!e.includes(":"))return"";const n=e.split(":")[Number("last"===t)];return B.toNumber(n)}simplifyRatio(A){const e=B.toString(A.RATIO);if(!e.includes(":"))return"";const t=e.split(":"),n=B.toNumber(t[0]),i=B.toNumber(t[1]),r=this.reduce(n,i);return"".concat(B.toNumber(r[0]),":").concat(B.toNumber(r[1]))}truncateNumber(A){const e=B.toNumber(A.NUM);return Math.trunc(e)}isNumberMultipleOf(A){return B.toNumber(A.NUM)%B.toNumber(A.MULTIPLE)==0}isInteger(A){const e=B.toNumber(A.NUM);return Math.trunc(e)===e}isPrime(A){const e=B.toNumber(A.NUM);return this.checkPrime(e)}isEven(A){return B.toNumber(A.NUM)%2==0}evaluateMath(A){const e=B.toString(A.EQUATION);if(0===e.trim().length)return 0;let t=0;try{t=c.evaluate(e)}catch(A){t=0}if("object"==typeof t&&"entries"in t){const A=t.entries;if(0===A.length)return 0;const e=A.length-1;return Number(A[e])}return Number(t)}exactlyEqual(A){return A.ONE===A.TWO}betweenNumbers(A){const e=B.toNumber(A.NUM);let t=B.toNumber(A.MIN),n=B.toNumber(A.MAX);if(n<t){const A=n;n=t,t=A}return e<=n&&e>=t}reverseChars(A){return B.toString(A.TEXT).split("").reverse().join("")}shuffleChars(A){return B.toString(A.TEXT).split("").sort(()=>Math.random()-.5).join("")}join4(A){return B.toString(A.STRING1)+B.toString(A.STRING2)+B.toString(A.STRING3)+B.toString(A.STRING4)}join5(A){return B.toString(A.STRING1)+B.toString(A.STRING2)+B.toString(A.STRING3)+B.toString(A.STRING4)+B.toString(A.STRING5)}join6(A){return B.toString(A.STRING1)+B.toString(A.STRING2)+B.toString(A.STRING3)+B.toString(A.STRING4)+B.toString(A.STRING5)+B.toString(A.STRING6)}join7(A){return B.toString(A.STRING1)+B.toString(A.STRING2)+B.toString(A.STRING3)+B.toString(A.STRING4)+B.toString(A.STRING5)+B.toString(A.STRING6)+B.toString(A.STRING7)}join8(A){return B.toString(A.STRING1)+B.toString(A.STRING2)+B.toString(A.STRING3)+B.toString(A.STRING4)+B.toString(A.STRING5)+B.toString(A.STRING6)+B.toString(A.STRING7)+B.toString(A.STRING8)}join9(A){return B.toString(A.STRING1)+B.toString(A.STRING2)+B.toString(A.STRING3)+B.toString(A.STRING4)+B.toString(A.STRING5)+B.toString(A.STRING6)+B.toString(A.STRING7)+B.toString(A.STRING8)+B.toString(A.STRING9)}setReplacer(A){const e=B.toString(A.REPLACER),t=B.toString(A.TEXT);this.replacers[e]=t}resetReplacers(){this.replacers=Object.create(null)}applyReplacers(A){let e=B.toString(A.TEXT);for(const A in this.replacers){const t=this.replacers[A];e=e.replaceAll(A,t)}return e}textAfter(A){const e=B.toString(A.TEXT),t=B.toString(A.BASE),n=t.indexOf(e);return n<0?"":t.substring(n+e.length)}textBefore(A){const e=B.toString(A.TEXT),t=B.toString(A.BASE),n=t.indexOf(e);return n<0?"":t.substring(0,n)}orIfFalsey(A){return""}ifIsTruthy(A){return""}shiftLeft(A){return""}shiftRight(A){return""}binnaryAnd(A){return!1}binnaryOr(A){return!1}binnaryXor(A){return!1}binnaryNot(A){return!1}speedToPitch(A){return 0}pitchToSpeed(A){return 1}atan2(A){return 0}}},function(A,e,t){(function(e){var t;t=()=>(()=>{var A={1977:function(A,e){var t;!function(n){"use strict";var i=Math.cosh||function(A){return Math.abs(A)<1e-9?1-A:.5*(Math.exp(A)+Math.exp(-A))},r=Math.sinh||function(A){return Math.abs(A)<1e-9?A:.5*(Math.exp(A)-Math.exp(-A))},o=function(){throw SyntaxError("Invalid Param")};function s(A,e){var t=Math.abs(A),n=Math.abs(e);return 0===A?Math.log(n):0===e?Math.log(t):t<3e3&&n<3e3?.5*Math.log(A*A+e*e):(A/=2,e/=2,.5*Math.log(A*A+e*e)+Math.LN2)}function a(A,e){if(!(this instanceof a))return new a(A,e);var t=function(A,e){var t={re:0,im:0};if(null==A)t.re=t.im=0;else if(void 0!==e)t.re=A,t.im=e;else switch(typeof A){case"object":if("im"in A&&"re"in A)t.re=A.re,t.im=A.im;else if("abs"in A&&"arg"in A){if(!Number.isFinite(A.abs)&&Number.isFinite(A.arg))return a.INFINITY;t.re=A.abs*Math.cos(A.arg),t.im=A.abs*Math.sin(A.arg)}else if("r"in A&&"phi"in A){if(!Number.isFinite(A.r)&&Number.isFinite(A.phi))return a.INFINITY;t.re=A.r*Math.cos(A.phi),t.im=A.r*Math.sin(A.phi)}else 2===A.length?(t.re=A[0],t.im=A[1]):o();break;case"string":t.im=t.re=0;var n=A.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),i=1,r=0;null===n&&o();for(var s=0;s<n.length;s++){var B=n[s];" "===B||"\t"===B||"\n"===B||("+"===B?i++:"-"===B?r++:"i"===B||"I"===B?(i+r===0&&o()," "===n[s+1]||isNaN(n[s+1])?t.im+=parseFloat((r%2?"-":"")+"1"):(t.im+=parseFloat((r%2?"-":"")+n[s+1]),s++),i=r=0):((i+r===0||isNaN(B))&&o(),"i"===n[s+1]||"I"===n[s+1]?(t.im+=parseFloat((r%2?"-":"")+B),s++):t.re+=parseFloat((r%2?"-":"")+B),i=r=0))}i+r>0&&o();break;case"number":t.im=0,t.re=A;break;default:o()}return isNaN(t.re)||isNaN(t.im),t}(A,e);this.re=t.re,this.im=t.im}a.prototype={re:0,im:0,sign:function(){var A=this.abs();return new a(this.re/A,this.im/A)},add:function(A,e){var t=new a(A,e);return this.isInfinite()&&t.isInfinite()?a.NAN:this.isInfinite()||t.isInfinite()?a.INFINITY:new a(this.re+t.re,this.im+t.im)},sub:function(A,e){var t=new a(A,e);return this.isInfinite()&&t.isInfinite()?a.NAN:this.isInfinite()||t.isInfinite()?a.INFINITY:new a(this.re-t.re,this.im-t.im)},mul:function(A,e){var t=new a(A,e);return this.isInfinite()&&t.isZero()||this.isZero()&&t.isInfinite()?a.NAN:this.isInfinite()||t.isInfinite()?a.INFINITY:0===t.im&&0===this.im?new a(this.re*t.re,0):new a(this.re*t.re-this.im*t.im,this.re*t.im+this.im*t.re)},div:function(A,e){var t=new a(A,e);if(this.isZero()&&t.isZero()||this.isInfinite()&&t.isInfinite())return a.NAN;if(this.isInfinite()||t.isZero())return a.INFINITY;if(this.isZero()||t.isInfinite())return a.ZERO;A=this.re,e=this.im;var n,i,r=t.re,o=t.im;return 0===o?new a(A/r,e/r):Math.abs(r)<Math.abs(o)?new a((A*(i=r/o)+e)/(n=r*i+o),(e*i-A)/n):new a((A+e*(i=o/r))/(n=o*i+r),(e-A*i)/n)},pow:function(A,e){var t=new a(A,e);if(A=this.re,e=this.im,t.isZero())return a.ONE;if(0===t.im){if(0===e&&A>0)return new a(Math.pow(A,t.re),0);if(0===A)switch((t.re%4+4)%4){case 0:return new a(Math.pow(e,t.re),0);case 1:return new a(0,Math.pow(e,t.re));case 2:return new a(-Math.pow(e,t.re),0);case 3:return new a(0,-Math.pow(e,t.re))}}if(0===A&&0===e&&t.re>0&&t.im>=0)return a.ZERO;var n=Math.atan2(e,A),i=s(A,e);return A=Math.exp(t.re*i-t.im*n),e=t.im*i+t.re*n,new a(A*Math.cos(e),A*Math.sin(e))},sqrt:function(){var A,e,t=this.re,n=this.im,i=this.abs();if(t>=0){if(0===n)return new a(Math.sqrt(t),0);A=.5*Math.sqrt(2*(i+t))}else A=Math.abs(n)/Math.sqrt(2*(i-t));return e=t<=0?.5*Math.sqrt(2*(i-t)):Math.abs(n)/Math.sqrt(2*(i+t)),new a(A,n<0?-e:e)},exp:function(){var A=Math.exp(this.re);return this.im,new a(A*Math.cos(this.im),A*Math.sin(this.im))},expm1:function(){var A=this.re,e=this.im;return new a(Math.expm1(A)*Math.cos(e)+function(A){var e=Math.PI/4;if(-e>A||A>e)return Math.cos(A)-1;var t=A*A;return t*(t*(t*(t*(t*(t*(t*(t/20922789888e3-1/87178291200)+1/479001600)-1/3628800)+1/40320)-1/720)+1/24)-.5)}(e),Math.exp(A)*Math.sin(e))},log:function(){var A=this.re,e=this.im;return new a(s(A,e),Math.atan2(e,A))},abs:function(){return A=this.re,e=this.im,t=Math.abs(A),n=Math.abs(e),t<3e3&&n<3e3?Math.sqrt(t*t+n*n):(t<n?(t=n,n=A/e):n=e/A,t*Math.sqrt(1+n*n));var A,e,t,n},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){var A=this.re,e=this.im;return new a(Math.sin(A)*i(e),Math.cos(A)*r(e))},cos:function(){var A=this.re,e=this.im;return new a(Math.cos(A)*i(e),-Math.sin(A)*r(e))},tan:function(){var A=2*this.re,e=2*this.im,t=Math.cos(A)+i(e);return new a(Math.sin(A)/t,r(e)/t)},cot:function(){var A=2*this.re,e=2*this.im,t=Math.cos(A)-i(e);return new a(-Math.sin(A)/t,r(e)/t)},sec:function(){var A=this.re,e=this.im,t=.5*i(2*e)+.5*Math.cos(2*A);return new a(Math.cos(A)*i(e)/t,Math.sin(A)*r(e)/t)},csc:function(){var A=this.re,e=this.im,t=.5*i(2*e)-.5*Math.cos(2*A);return new a(Math.sin(A)*i(e)/t,-Math.cos(A)*r(e)/t)},asin:function(){var A=this.re,e=this.im,t=new a(e*e-A*A+1,-2*A*e).sqrt(),n=new a(t.re-e,t.im+A).log();return new a(n.im,-n.re)},acos:function(){var A=this.re,e=this.im,t=new a(e*e-A*A+1,-2*A*e).sqrt(),n=new a(t.re-e,t.im+A).log();return new a(Math.PI/2-n.im,n.re)},atan:function(){var A=this.re,e=this.im;if(0===A){if(1===e)return new a(0,1/0);if(-1===e)return new a(0,-1/0)}var t=A*A+(1-e)*(1-e),n=new a((1-e*e-A*A)/t,-2*A/t).log();return new a(-.5*n.im,.5*n.re)},acot:function(){var A=this.re,e=this.im;if(0===e)return new a(Math.atan2(1,A),0);var t=A*A+e*e;return 0!==t?new a(A/t,-e/t).atan():new a(0!==A?A/0:0,0!==e?-e/0:0).atan()},asec:function(){var A=this.re,e=this.im;if(0===A&&0===e)return new a(0,1/0);var t=A*A+e*e;return 0!==t?new a(A/t,-e/t).acos():new a(0!==A?A/0:0,0!==e?-e/0:0).acos()},acsc:function(){var A=this.re,e=this.im;if(0===A&&0===e)return new a(Math.PI/2,1/0);var t=A*A+e*e;return 0!==t?new a(A/t,-e/t).asin():new a(0!==A?A/0:0,0!==e?-e/0:0).asin()},sinh:function(){var A=this.re,e=this.im;return new a(r(A)*Math.cos(e),i(A)*Math.sin(e))},cosh:function(){var A=this.re,e=this.im;return new a(i(A)*Math.cos(e),r(A)*Math.sin(e))},tanh:function(){var A=2*this.re,e=2*this.im,t=i(A)+Math.cos(e);return new a(r(A)/t,Math.sin(e)/t)},coth:function(){var A=2*this.re,e=2*this.im,t=i(A)-Math.cos(e);return new a(r(A)/t,-Math.sin(e)/t)},csch:function(){var A=this.re,e=this.im,t=Math.cos(2*e)-i(2*A);return new a(-2*r(A)*Math.cos(e)/t,2*i(A)*Math.sin(e)/t)},sech:function(){var A=this.re,e=this.im,t=Math.cos(2*e)+i(2*A);return new a(2*i(A)*Math.cos(e)/t,-2*r(A)*Math.sin(e)/t)},asinh:function(){var A=this.im;this.im=-this.re,this.re=A;var e=this.asin();return this.re=-this.im,this.im=A,A=e.re,e.re=-e.im,e.im=A,e},acosh:function(){var A=this.acos();if(A.im<=0){var e=A.re;A.re=-A.im,A.im=e}else e=A.im,A.im=-A.re,A.re=e;return A},atanh:function(){var A=this.re,e=this.im,t=A>1&&0===e,n=1-A,i=1+A,r=n*n+e*e,o=0!==r?new a((i*n-e*e)/r,(e*n+i*e)/r):new a(-1!==A?A/0:0,0!==e?e/0:0),B=o.re;return o.re=s(o.re,o.im)/2,o.im=Math.atan2(o.im,B)/2,t&&(o.im=-o.im),o},acoth:function(){var A=this.re,e=this.im;if(0===A&&0===e)return new a(0,Math.PI/2);var t=A*A+e*e;return 0!==t?new a(A/t,-e/t).atanh():new a(0!==A?A/0:0,0!==e?-e/0:0).atanh()},acsch:function(){var A=this.re,e=this.im;if(0===e)return new a(0!==A?Math.log(A+Math.sqrt(A*A+1)):1/0,0);var t=A*A+e*e;return 0!==t?new a(A/t,-e/t).asinh():new a(0!==A?A/0:0,0!==e?-e/0:0).asinh()},asech:function(){var A=this.re,e=this.im;if(this.isZero())return a.INFINITY;var t=A*A+e*e;return 0!==t?new a(A/t,-e/t).acosh():new a(0!==A?A/0:0,0!==e?-e/0:0).acosh()},inverse:function(){if(this.isZero())return a.INFINITY;if(this.isInfinite())return a.ZERO;var A=this.re,e=this.im,t=A*A+e*e;return new a(A/t,-e/t)},conjugate:function(){return new a(this.re,-this.im)},neg:function(){return new a(-this.re,-this.im)},ceil:function(A){return A=Math.pow(10,A||0),new a(Math.ceil(this.re*A)/A,Math.ceil(this.im*A)/A)},floor:function(A){return A=Math.pow(10,A||0),new a(Math.floor(this.re*A)/A,Math.floor(this.im*A)/A)},round:function(A){return A=Math.pow(10,A||0),new a(Math.round(this.re*A)/A,Math.round(this.im*A)/A)},equals:function(A,e){var t=new a(A,e);return Math.abs(t.re-this.re)<=a.EPSILON&&Math.abs(t.im-this.im)<=a.EPSILON},clone:function(){return new a(this.re,this.im)},toString:function(){var A=this.re,e=this.im,t="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(A)<a.EPSILON&&(A=0),Math.abs(e)<a.EPSILON&&(e=0),0===e?t+A:(0!==A?(t+=A,t+=" ",e<0?(e=-e,t+="-"):t+="+",t+=" "):e<0&&(e=-e,t+="-"),1!==e&&(t+=e),t+"i"))},toVector:function(){return[this.re,this.im]},valueOf:function(){return 0===this.im?this.re:null},isNaN:function(A){function e(){return A.apply(this,arguments)}return e.toString=function(){return A.toString()},e}((function(){return isNaN(this.re)||isNaN(this.im)})),isZero:function(){return 0===this.im&&0===this.re},isFinite:function(A){function e(){return A.apply(this,arguments)}return e.toString=function(){return A.toString()},e}((function(){return isFinite(this.re)&&isFinite(this.im)})),isInfinite:function(){return!(this.isNaN()||this.isFinite())}},a.ZERO=new a(0,0),a.ONE=new a(1,0),a.I=new a(0,1),a.PI=new a(Math.PI,0),a.E=new a(Math.E,0),a.INFINITY=new a(1/0,1/0),a.NAN=new a(NaN,NaN),a.EPSILON=1e-15,void 0===(t=function(){return a}.apply(e,[]))||(A.exports=t)}()},7928:A=>{"use strict";var e=Object.assign||function(A){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(A[n]=t[n])}return A},t={"{":"\\{","}":"\\}","\\":"\\textbackslash{}","#":"\\#",$:"\\$","%":"\\%","&":"\\&","^":"\\textasciicircum{}",_:"\\_","~":"\\textasciitilde{}"},n={"":"\\--","":"\\---"," ":"~","\t":"\\qquad{}","\r\n":"\\newline{}","\n":"\\newline{}"},i=function(A,t){return e({},A,t)};A.exports=function(A){for(var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=r.preserveFormatting,s=void 0!==o&&o,a=r.escapeMapFn,B=void 0===a?i:a,c=String(A),g="",E=B(e({},t),s?e({},n):{}),Q=Object.keys(E),u=function(){var A=!1;Q.forEach((function(e,t){A||c.length>=e.length&&c.slice(0,e.length)===e&&(g+=E[Q[t]],c=c.slice(e.length,c.length),A=!0)})),A||(g+=c.slice(0,1),c=c.slice(1,c.length))};c;)u();return g}},5628:function(A){!function(e){"use strict";var t={s:1,n:0,d:1};function n(A,e){if(isNaN(A=parseInt(A,10)))throw c();return A*e}function i(A,e){if(0===e)throw B();var t=Object.create(a.prototype);t.s=A<0?-1:1;var n=s(A=A<0?-A:A,e);return t.n=A/n,t.d=e/n,t}function r(A){for(var e={},t=A,n=2,i=4;i<=t;){for(;t%n==0;)t/=n,e[n]=(e[n]||0)+1;i+=1+2*n++}return t!==A?t>1&&(e[t]=(e[t]||0)+1):e[A]=(e[A]||0)+1,e}var o=function(A,e){var i,r=0,o=1,s=1,a=0,E=0,Q=0,u=1,l=1,w=0,h=1,C=1,I=1,M=1e7;if(null==A);else if(void 0!==e){if(s=(r=A)*(o=e),r%1!=0||o%1!=0)throw g()}else switch(typeof A){case"object":if("d"in A&&"n"in A)r=A.n,o=A.d,"s"in A&&(r*=A.s);else{if(!(0 in A))throw c();r=A[0],1 in A&&(o=A[1])}s=r*o;break;case"number":if(A<0&&(s=A,A=-A),A%1==0)r=A;else if(A>0){for(A>=1&&(A/=l=Math.pow(10,Math.floor(1+Math.log(A)/Math.LN10)));h<=M&&I<=M;){if(A===(i=(w+C)/(h+I))){h+I<=M?(r=w+C,o=h+I):I>h?(r=C,o=I):(r=w,o=h);break}A>i?(w+=C,h+=I):(C+=w,I+=h),h>M?(r=C,o=I):(r=w,o=h)}r*=l}else(isNaN(A)||isNaN(e))&&(o=r=NaN);break;case"string":if(null===(h=A.match(/\d+|./g)))throw c();if("-"===h[w]?(s=-1,w++):"+"===h[w]&&w++,h.length===w+1?E=n(h[w++],s):"."===h[w+1]||"."===h[w]?("."!==h[w]&&(a=n(h[w++],s)),(1+ ++w===h.length||"("===h[w+1]&&")"===h[w+3]||"'"===h[w+1]&&"'"===h[w+3])&&(E=n(h[w],s),u=Math.pow(10,h[w].length),w++),("("===h[w]&&")"===h[w+2]||"'"===h[w]&&"'"===h[w+2])&&(Q=n(h[w+1],s),l=Math.pow(10,h[w+1].length)-1,w+=3)):"/"===h[w+1]||":"===h[w+1]?(E=n(h[w],s),u=n(h[w+2],1),w+=3):"/"===h[w+3]&&" "===h[w+1]&&(a=n(h[w],s),E=n(h[w+2],s),u=n(h[w+4],1),w+=5),h.length<=w){s=r=Q+(o=u*l)*a+l*E;break}default:throw c()}if(0===o)throw B();t.s=s<0?-1:1,t.n=Math.abs(r),t.d=Math.abs(o)};function s(A,e){if(!A)return e;if(!e)return A;for(;;){if(!(A%=e))return e;if(!(e%=A))return A}}function a(A,e){if(o(A,e),!(this instanceof a))return i(t.s*t.n,t.d);A=s(t.d,t.n),this.s=t.s,this.n=t.n/A,this.d=t.d/A}var B=function(){return new Error("Division by Zero")},c=function(){return new Error("Invalid argument")},g=function(){return new Error("Parameters must be integer")};a.prototype={s:1,n:0,d:1,abs:function(){return i(this.n,this.d)},neg:function(){return i(-this.s*this.n,this.d)},add:function(A,e){return o(A,e),i(this.s*this.n*t.d+t.s*this.d*t.n,this.d*t.d)},sub:function(A,e){return o(A,e),i(this.s*this.n*t.d-t.s*this.d*t.n,this.d*t.d)},mul:function(A,e){return o(A,e),i(this.s*t.s*this.n*t.n,this.d*t.d)},div:function(A,e){return o(A,e),i(this.s*t.s*this.n*t.d,this.d*t.n)},clone:function(){return i(this.s*this.n,this.d)},mod:function(A,e){if(isNaN(this.n)||isNaN(this.d))return new a(NaN);if(void 0===A)return i(this.s*this.n%this.d,1);if(o(A,e),0===t.n&&0===this.d)throw B();return i(this.s*(t.d*this.n)%(t.n*this.d),t.d*this.d)},gcd:function(A,e){return o(A,e),i(s(t.n,this.n)*s(t.d,this.d),t.d*this.d)},lcm:function(A,e){return o(A,e),0===t.n&&0===this.n?i(0,1):i(t.n*this.n,s(t.n,this.n)*s(t.d,this.d))},ceil:function(A){return A=Math.pow(10,A||0),isNaN(this.n)||isNaN(this.d)?new a(NaN):i(Math.ceil(A*this.s*this.n/this.d),A)},floor:function(A){return A=Math.pow(10,A||0),isNaN(this.n)||isNaN(this.d)?new a(NaN):i(Math.floor(A*this.s*this.n/this.d),A)},round:function(A){return A=Math.pow(10,A||0),isNaN(this.n)||isNaN(this.d)?new a(NaN):i(Math.round(A*this.s*this.n/this.d),A)},inverse:function(){return i(this.s*this.d,this.n)},pow:function(A,e){if(o(A,e),1===t.d)return t.s<0?i(Math.pow(this.s*this.d,t.n),Math.pow(this.n,t.n)):i(Math.pow(this.s*this.n,t.n),Math.pow(this.d,t.n));if(this.s<0)return null;var n=r(this.n),s=r(this.d),a=1,B=1;for(var c in n)if("1"!==c){if("0"===c){a=0;break}if(n[c]*=t.n,n[c]%t.d!=0)return null;n[c]/=t.d,a*=Math.pow(c,n[c])}for(var c in s)if("1"!==c){if(s[c]*=t.n,s[c]%t.d!=0)return null;s[c]/=t.d,B*=Math.pow(c,s[c])}return t.s<0?i(B,a):i(a,B)},equals:function(A,e){return o(A,e),this.s*this.n*t.d==t.s*t.n*this.d},compare:function(A,e){o(A,e);var n=this.s*this.n*t.d-t.s*t.n*this.d;return(0<n)-(n<0)},simplify:function(A){if(isNaN(this.n)||isNaN(this.d))return this;A=A||.001;for(var e=this.abs(),t=e.toContinued(),n=1;n<t.length;n++){for(var r=i(t[n-1],1),o=n-2;o>=0;o--)r=r.inverse().add(t[o]);if(Math.abs(r.sub(e).valueOf())<A)return r.mul(this.s)}return this},divisible:function(A,e){return o(A,e),!(!(t.n*this.d)||this.n*t.d%(t.n*this.d))},valueOf:function(){return this.s*this.n/this.d},toFraction:function(A){var e,t="",n=this.n,i=this.d;return this.s<0&&(t+="-"),1===i?t+=n:(A&&(e=Math.floor(n/i))>0&&(t+=e,t+=" ",n%=i),t+=n,t+="/",t+=i),t},toLatex:function(A){var e,t="",n=this.n,i=this.d;return this.s<0&&(t+="-"),1===i?t+=n:(A&&(e=Math.floor(n/i))>0&&(t+=e,n%=i),t+="\\frac{",t+=n,t+="}{",t+=i,t+="}"),t},toContinued:function(){var A,e=this.n,t=this.d,n=[];if(isNaN(e)||isNaN(t))return n;do{n.push(Math.floor(e/t)),A=e%t,e=t,t=A}while(1!==e);return n},toString:function(A){var e=this.n,t=this.d;if(isNaN(e)||isNaN(t))return"NaN";A=A||15;var n=function(A,e){for(;e%2==0;e/=2);for(;e%5==0;e/=5);if(1===e)return 0;for(var t=10%e,n=1;1!==t;n++)if(t=10*t%e,n>2e3)return 0;return n}(0,t),i=function(A,e,t){for(var n=1,i=function(A,e,t){for(var n=1;e>0;A=A*A%t,e>>=1)1&e&&(n=n*A%t);return n}(10,t,e),r=0;r<300;r++){if(n===i)return r;n=10*n%e,i=10*i%e}return 0}(0,t,n),r=this.s<0?"-":"";if(r+=e/t|0,e%=t,(e*=10)&&(r+="."),n){for(var o=i;o--;)r+=e/t|0,e%=t,e*=10;for(r+="(",o=n;o--;)r+=e/t|0,e%=t,e*=10;r+=")"}else for(o=A;e&&o--;)r+=e/t|0,e%=t,e*=10;return r}},Object.defineProperty(a,"__esModule",{value:!0}),a.default=a,a.Fraction=a,A.exports=a}()},3228:A=>{A.exports=function A(e,t){"use strict";var n,i,r=/(^([+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?)?$|^0x[0-9a-f]+$|\d+)/gi,o=/(^[ ]*|[ ]*$)/g,s=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,a=/^0x[0-9a-f]+$/i,B=/^0/,c=function(e){return A.insensitive&&(""+e).toLowerCase()||""+e},g=c(e).replace(o,"")||"",E=c(t).replace(o,"")||"",Q=g.replace(r,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),u=E.replace(r,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),l=parseInt(g.match(a),16)||1!==Q.length&&g.match(s)&&Date.parse(g),w=parseInt(E.match(a),16)||l&&E.match(s)&&Date.parse(E)||null;if(w){if(l<w)return-1;if(l>w)return 1}for(var h=0,C=Math.max(Q.length,u.length);h<C;h++){if(n=!(Q[h]||"").match(B)&&parseFloat(Q[h])||Q[h]||0,i=!(u[h]||"").match(B)&&parseFloat(u[h])||u[h]||0,isNaN(n)!==isNaN(i))return isNaN(n)?1:-1;if(typeof n!=typeof i&&(n+="",i+=""),n<i)return-1;if(n>i)return 1}return 0}},6377:(A,e,t)=>{var n=t(4832),i=t(8652),r=t(801),o=t(2030),s=t(3618),a=t(9049),B=t(1971);B.alea=n,B.xor128=i,B.xorwow=r,B.xorshift7=o,B.xor4096=s,B.tychei=a,A.exports=B},4832:function(A,e,t){var n;!function(A,i,r){function o(A){var e,t=this,n=(e=4022871197,function(A){A=String(A);for(var t=0;t<A.length;t++){var n=.02519603282416938*(e+=A.charCodeAt(t));n-=e=n>>>0,e=(n*=e)>>>0,e+=4294967296*(n-=e)}return 2.3283064365386963e-10*(e>>>0)});t.next=function(){var A=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=A-(t.c=0|A)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(A),t.s0<0&&(t.s0+=1),t.s1-=n(A),t.s1<0&&(t.s1+=1),t.s2-=n(A),t.s2<0&&(t.s2+=1),n=null}function s(A,e){return e.c=A.c,e.s0=A.s0,e.s1=A.s1,e.s2=A.s2,e}function a(A,e){var t=new o(A),n=e&&e.state,i=t.next;return i.int32=function(){return 4294967296*t.next()|0},i.double=function(){return i()+11102230246251565e-32*(2097152*i()|0)},i.quick=i,n&&("object"==typeof n&&s(n,t),i.state=function(){return s(t,{})}),i}i&&i.exports?i.exports=a:t.amdD&&t.amdO?void 0===(n=function(){return a}.call(e,t,e,i))||(i.exports=n):this.alea=a}(0,A=t.nmd(A),t.amdD)},9049:function(A,e,t){var n;!function(A,i,r){function o(A){var e=this,t="";e.next=function(){var A=e.b,t=e.c,n=e.d,i=e.a;return A=A<<25^A>>>7^t,t=t-n|0,n=n<<24^n>>>8^i,i=i-A|0,e.b=A=A<<20^A>>>12^t,e.c=t=t-n|0,e.d=n<<16^t>>>16^i,e.a=i-A|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,A===Math.floor(A)?(e.a=A/4294967296|0,e.b=0|A):t+=A;for(var n=0;n<t.length+20;n++)e.b^=0|t.charCodeAt(n),e.next()}function s(A,e){return e.a=A.a,e.b=A.b,e.c=A.c,e.d=A.d,e}function a(A,e){var t=new o(A),n=e&&e.state,i=function(){return(t.next()>>>0)/4294967296};return i.double=function(){do{var A=((t.next()>>>11)+(t.next()>>>0)/4294967296)/(1<<21)}while(0===A);return A},i.int32=t.next,i.quick=i,n&&("object"==typeof n&&s(n,t),i.state=function(){return s(t,{})}),i}i&&i.exports?i.exports=a:t.amdD&&t.amdO?void 0===(n=function(){return a}.call(e,t,e,i))||(i.exports=n):this.tychei=a}(0,A=t.nmd(A),t.amdD)},8652:function(A,e,t){var n;!function(A,i,r){function o(A){var e=this,t="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var A=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^A^A>>>8},A===(0|A)?e.x=A:t+=A;for(var n=0;n<t.length+64;n++)e.x^=0|t.charCodeAt(n),e.next()}function s(A,e){return e.x=A.x,e.y=A.y,e.z=A.z,e.w=A.w,e}function a(A,e){var t=new o(A),n=e&&e.state,i=function(){return(t.next()>>>0)/4294967296};return i.double=function(){do{var A=((t.next()>>>11)+(t.next()>>>0)/4294967296)/(1<<21)}while(0===A);return A},i.int32=t.next,i.quick=i,n&&("object"==typeof n&&s(n,t),i.state=function(){return s(t,{})}),i}i&&i.exports?i.exports=a:t.amdD&&t.amdO?void 0===(n=function(){return a}.call(e,t,e,i))||(i.exports=n):this.xor128=a}(0,A=t.nmd(A),t.amdD)},3618:function(A,e,t){var n;!function(A,i,r){function o(A){var e=this;e.next=function(){var A,t,n=e.w,i=e.X,r=e.i;return e.w=n=n+1640531527|0,t=i[r+34&127],A=i[r=r+1&127],t^=t<<13,A^=A<<17,t^=t>>>15,A^=A>>>12,t=i[r]=t^A,e.i=r,t+(n^n>>>16)|0},function(A,e){var t,n,i,r,o,s=[],a=128;for(e===(0|e)?(n=e,e=null):(e+="\0",n=0,a=Math.max(a,e.length)),i=0,r=-32;r<a;++r)e&&(n^=e.charCodeAt((r+32)%e.length)),0===r&&(o=n),n^=n<<10,n^=n>>>15,n^=n<<4,n^=n>>>13,r>=0&&(o=o+1640531527|0,i=0==(t=s[127&r]^=n+o)?i+1:0);for(i>=128&&(s[127&(e&&e.length||0)]=-1),i=127,r=512;r>0;--r)n=s[i+34&127],t=s[i=i+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,s[i]=n^t;A.w=o,A.X=s,A.i=i}(e,A)}function s(A,e){return e.i=A.i,e.w=A.w,e.X=A.X.slice(),e}function a(A,e){null==A&&(A=+new Date);var t=new o(A),n=e&&e.state,i=function(){return(t.next()>>>0)/4294967296};return i.double=function(){do{var A=((t.next()>>>11)+(t.next()>>>0)/4294967296)/(1<<21)}while(0===A);return A},i.int32=t.next,i.quick=i,n&&(n.X&&s(n,t),i.state=function(){return s(t,{})}),i}i&&i.exports?i.exports=a:t.amdD&&t.amdO?void 0===(n=function(){return a}.call(e,t,e,i))||(i.exports=n):this.xor4096=a}(0,A=t.nmd(A),t.amdD)},2030:function(A,e,t){var n;!function(A,i,r){function o(A){var e=this;e.next=function(){var A,t,n=e.x,i=e.i;return A=n[i],t=(A^=A>>>7)^A<<24,t^=(A=n[i+1&7])^A>>>10,t^=(A=n[i+3&7])^A>>>3,t^=(A=n[i+4&7])^A<<7,A=n[i+7&7],t^=(A^=A<<13)^A<<9,n[i]=t,e.i=i+1&7,t},function(A,e){var t,n=[];if(e===(0|e))n[0]=e;else for(e=""+e,t=0;t<e.length;++t)n[7&t]=n[7&t]<<15^e.charCodeAt(t)+n[t+1&7]<<13;for(;n.length<8;)n.push(0);for(t=0;t<8&&0===n[t];++t);for(8==t?n[7]=-1:n[t],A.x=n,A.i=0,t=256;t>0;--t)A.next()}(e,A)}function s(A,e){return e.x=A.x.slice(),e.i=A.i,e}function a(A,e){null==A&&(A=+new Date);var t=new o(A),n=e&&e.state,i=function(){return(t.next()>>>0)/4294967296};return i.double=function(){do{var A=((t.next()>>>11)+(t.next()>>>0)/4294967296)/(1<<21)}while(0===A);return A},i.int32=t.next,i.quick=i,n&&(n.x&&s(n,t),i.state=function(){return s(t,{})}),i}i&&i.exports?i.exports=a:t.amdD&&t.amdO?void 0===(n=function(){return a}.call(e,t,e,i))||(i.exports=n):this.xorshift7=a}(0,A=t.nmd(A),t.amdD)},801:function(A,e,t){var n;!function(A,i,r){function o(A){var e=this,t="";e.next=function(){var A=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^A^A<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,A===(0|A)?e.x=A:t+=A;for(var n=0;n<t.length+64;n++)e.x^=0|t.charCodeAt(n),n==t.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function s(A,e){return e.x=A.x,e.y=A.y,e.z=A.z,e.w=A.w,e.v=A.v,e.d=A.d,e}function a(A,e){var t=new o(A),n=e&&e.state,i=function(){return(t.next()>>>0)/4294967296};return i.double=function(){do{var A=((t.next()>>>11)+(t.next()>>>0)/4294967296)/(1<<21)}while(0===A);return A},i.int32=t.next,i.quick=i,n&&("object"==typeof n&&s(n,t),i.state=function(){return s(t,{})}),i}i&&i.exports?i.exports=a:t.amdD&&t.amdO?void 0===(n=function(){return a}.call(e,t,e,i))||(i.exports=n):this.xorwow=a}(0,A=t.nmd(A),t.amdD)},1971:function(A,e,t){var n;!function(i,r,o){var s,a=256,B=o.pow(a,6),c=o.pow(2,52),g=2*c,E=255;function Q(A,e,t){var n=[],E=w(function A(e,t){var n,i=[],r=typeof e;if(t&&"object"==r)for(n in e)try{i.push(A(e[n],t-1))}catch(e){}return i.length?i:"string"==r?e:e+"\0"}((e=1==e?{entropy:!0}:e||{}).entropy?[A,h(r)]:null==A?function(){try{var A;return s&&(A=s.randomBytes)?A=A(a):(A=new Uint8Array(a),(i.crypto||i.msCrypto).getRandomValues(A)),h(A)}catch(A){var e=i.navigator,t=e&&e.plugins;return[+new Date,i,t,i.screen,h(r)]}}():A,3),n),Q=new u(n),C=function(){for(var A=Q.g(6),e=B,t=0;A<c;)A=(A+t)*a,e*=a,t=Q.g(1);for(;A>=g;)A/=2,e/=2,t>>>=1;return(A+t)/e};return C.int32=function(){return 0|Q.g(4)},C.quick=function(){return Q.g(4)/4294967296},C.double=C,w(h(Q.S),r),(e.pass||t||function(A,e,t,n){return n&&(n.S&&l(n,Q),A.state=function(){return l(Q,{})}),t?(o.random=A,e):A})(C,E,"global"in e?e.global:this==o,e.state)}function u(A){var e,t=A.length,n=this,i=0,r=n.i=n.j=0,o=n.S=[];for(t||(A=[t++]);i<a;)o[i]=i++;for(i=0;i<a;i++)o[i]=o[r=E&r+A[i%t]+(e=o[i])],o[r]=e;(n.g=function(A){for(var e,t=0,i=n.i,r=n.j,o=n.S;A--;)e=o[i=E&i+1],t=t*a+o[E&(o[i]=o[r=E&r+e])+(o[r]=e)];return n.i=i,n.j=r,t})(a)}function l(A,e){return e.i=A.i,e.j=A.j,e.S=A.S.slice(),e}function w(A,e){for(var t,n=A+"",i=0;i<n.length;)e[E&i]=E&(t^=19*e[E&i])+n.charCodeAt(i++);return h(e)}function h(A){return String.fromCharCode.apply(0,A)}if(w(o.random(),r),A.exports){A.exports=Q;try{s=t(5042)}catch(A){}}else void 0===(n=function(){return Q}.call(e,t,e,A))||(A.exports=n)}("undefined"!=typeof self?self:this,[],Math)},4279:A=>{function e(){}e.prototype={on:function(A,e,t){var n=this.e||(this.e={});return(n[A]||(n[A]=[])).push({fn:e,ctx:t}),this},once:function(A,e,t){var n=this;function i(){n.off(A,i),e.apply(t,arguments)}return i._=e,this.on(A,i,t)},emit:function(A){for(var e=[].slice.call(arguments,1),t=((this.e||(this.e={}))[A]||[]).slice(),n=0,i=t.length;n<i;n++)t[n].fn.apply(t[n].ctx,e);return this},off:function(A,e){var t=this.e||(this.e={}),n=t[A],i=[];if(n&&e)for(var r=0,o=n.length;r<o;r++)n[r].fn!==e&&n[r].fn._!==e&&i.push(n[r]);return i.length?t[A]=i:delete t[A],this}},A.exports=e,A.exports.TinyEmitter=e},5042:()=>{},7061:(A,e,t)=>{var n=t(8698).default;function i(){"use strict";A.exports=i=function(){return t},A.exports.__esModule=!0,A.exports.default=A.exports;var e,t={},r=Object.prototype,o=r.hasOwnProperty,s=Object.defineProperty||function(A,e,t){A[e]=t.value},a="function"==typeof Symbol?Symbol:{},B=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",g=a.toStringTag||"@@toStringTag";function E(A,e,t){return Object.defineProperty(A,e,{value:t,enumerable:!0,configurable:!0,writable:!0}),A[e]}try{E({},"")}catch(e){E=function(A,e,t){return A[e]=t}}function Q(A,e,t,n){var i=e&&e.prototype instanceof I?e:I,r=Object.create(i.prototype),o=new x(n||[]);return s(r,"_invoke",{value:N(A,t,o)}),r}function u(A,e,t){try{return{type:"normal",arg:A.call(e,t)}}catch(A){return{type:"throw",arg:A}}}t.wrap=Q;var l="suspendedStart",w="executing",h="completed",C={};function I(){}function M(){}function d(){}var m={};E(m,B,(function(){return this}));var p=Object.getPrototypeOf,F=p&&p(p(R([])));F&&F!==r&&o.call(F,B)&&(m=F);var D=d.prototype=I.prototype=Object.create(m);function Y(A){["next","throw","return"].forEach((function(e){E(A,e,(function(A){return this._invoke(e,A)}))}))}function f(A,e){function t(i,r,s,a){var B=u(A[i],A,r);if("throw"!==B.type){var c=B.arg,g=c.value;return g&&"object"==n(g)&&o.call(g,"__await")?e.resolve(g.__await).then((function(A){t("next",A,s,a)}),(function(A){t("throw",A,s,a)})):e.resolve(g).then((function(A){c.value=A,s(c)}),(function(A){return t("throw",A,s,a)}))}a(B.arg)}var i;s(this,"_invoke",{value:function(A,n){function r(){return new e((function(e,i){t(A,n,e,i)}))}return i=i?i.then(r,r):r()}})}function N(A,t,n){var i=l;return function(r,o){if(i===w)throw new Error("Generator is already running");if(i===h){if("throw"===r)throw o;return{value:e,done:!0}}for(n.method=r,n.arg=o;;){var s=n.delegate;if(s){var a=U(s,n);if(a){if(a===C)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===l)throw i=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=w;var B=u(A,t,n);if("normal"===B.type){if(i=n.done?h:"suspendedYield",B.arg===C)continue;return{value:B.arg,done:n.done}}"throw"===B.type&&(i=h,n.method="throw",n.arg=B.arg)}}}function U(A,t){var n=t.method,i=A.iterator[n];if(i===e)return t.delegate=null,"throw"===n&&A.iterator.return&&(t.method="return",t.arg=e,U(A,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),C;var r=u(i,A.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,C;var o=r.arg;return o?o.done?(t[A.resultName]=o.value,t.next=A.nextLoc,"return"!==t.method&&(t.method="next",t.arg=e),t.delegate=null,C):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,C)}function y(A){var e={tryLoc:A[0]};1 in A&&(e.catchLoc=A[1]),2 in A&&(e.finallyLoc=A[2],e.afterLoc=A[3]),this.tryEntries.push(e)}function T(A){var e=A.completion||{};e.type="normal",delete e.arg,A.completion=e}function x(A){this.tryEntries=[{tryLoc:"root"}],A.forEach(y,this),this.reset(!0)}function R(A){if(A||""===A){var t=A[B];if(t)return t.call(A);if("function"==typeof A.next)return A;if(!isNaN(A.length)){var i=-1,r=function t(){for(;++i<A.length;)if(o.call(A,i))return t.value=A[i],t.done=!1,t;return t.value=e,t.done=!0,t};return r.next=r}}throw new TypeError(n(A)+" is not iterable")}return M.prototype=d,s(D,"constructor",{value:d,configurable:!0}),s(d,"constructor",{value:M,configurable:!0}),M.displayName=E(d,g,"GeneratorFunction"),t.isGeneratorFunction=function(A){var e="function"==typeof A&&A.constructor;return!!e&&(e===M||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(A){return Object.setPrototypeOf?Object.setPrototypeOf(A,d):(A.__proto__=d,E(A,g,"GeneratorFunction")),A.prototype=Object.create(D),A},t.awrap=function(A){return{__await:A}},Y(f.prototype),E(f.prototype,c,(function(){return this})),t.AsyncIterator=f,t.async=function(A,e,n,i,r){void 0===r&&(r=Promise);var o=new f(Q(A,e,n,i),r);return t.isGeneratorFunction(e)?o:o.next().then((function(A){return A.done?A.value:o.next()}))},Y(D),E(D,g,"Generator"),E(D,B,(function(){return this})),E(D,"toString",(function(){return"[object Generator]"})),t.keys=function(A){var e=Object(A),t=[];for(var n in e)t.push(n);return t.reverse(),function A(){for(;t.length;){var n=t.pop();if(n in e)return A.value=n,A.done=!1,A}return A.done=!0,A}},t.values=R,x.prototype={constructor:x,reset:function(A){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!A)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=e)},stop:function(){this.done=!0;var A=this.tryEntries[0].completion;if("throw"===A.type)throw A.arg;return this.rval},dispatchException:function(A){if(this.done)throw A;var t=this;function n(n,i){return s.type="throw",s.arg=A,t.next=n,i&&(t.method="next",t.arg=e),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i],s=r.completion;if("root"===r.tryLoc)return n("end");if(r.tryLoc<=this.prev){var a=o.call(r,"catchLoc"),B=o.call(r,"finallyLoc");if(a&&B){if(this.prev<r.catchLoc)return n(r.catchLoc,!0);if(this.prev<r.finallyLoc)return n(r.finallyLoc)}else if(a){if(this.prev<r.catchLoc)return n(r.catchLoc,!0)}else{if(!B)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return n(r.finallyLoc)}}}},abrupt:function(A,e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===A||"continue"===A)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var r=i?i.completion:{};return r.type=A,r.arg=e,i?(this.method="next",this.next=i.finallyLoc,C):this.complete(r)},complete:function(A,e){if("throw"===A.type)throw A.arg;return"break"===A.type||"continue"===A.type?this.next=A.arg:"return"===A.type?(this.rval=this.arg=A.arg,this.method="return",this.next="end"):"normal"===A.type&&e&&(this.next=e),C},finish:function(A){for(var e=this.tryEntries.length-1;e>=0;--e){var t=this.tryEntries[e];if(t.finallyLoc===A)return this.complete(t.completion,t.afterLoc),T(t),C}},catch:function(A){for(var e=this.tryEntries.length-1;e>=0;--e){var t=this.tryEntries[e];if(t.tryLoc===A){var n=t.completion;if("throw"===n.type){var i=n.arg;T(t)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(A,t,n){return this.delegate={iterator:R(A),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=e),C}},t}A.exports=i,A.exports.__esModule=!0,A.exports.default=A.exports},8698:A=>{function e(t){return A.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(A){return typeof A}:function(A){return A&&"function"==typeof Symbol&&A.constructor===Symbol&&A!==Symbol.prototype?"symbol":typeof A},A.exports.__esModule=!0,A.exports.default=A.exports,e(t)}A.exports=e,A.exports.__esModule=!0,A.exports.default=A.exports},4687:(A,e,t)=>{var n=t(7061)();A.exports=n;try{regeneratorRuntime=n}catch(A){"object"==typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}},509:(A,e,t)=>{"use strict";var n=t(9985),i=t(3691),r=TypeError;A.exports=function(A){if(n(A))return A;throw new r(i(A)+" is not a function")}},2655:(A,e,t)=>{"use strict";var n=t(9429),i=t(3691),r=TypeError;A.exports=function(A){if(n(A))return A;throw new r(i(A)+" is not a constructor")}},3550:(A,e,t)=>{"use strict";var n=t(9985),i=String,r=TypeError;A.exports=function(A){if("object"==typeof A||n(A))return A;throw new r("Can't set "+i(A)+" as a prototype")}},7370:(A,e,t)=>{"use strict";var n=t(4201),i=t(5391),r=t(2560).f,o=n("unscopables"),s=Array.prototype;void 0===s[o]&&r(s,o,{configurable:!0,value:i(null)}),A.exports=function(A){s[o][A]=!0}},1514:(A,e,t)=>{"use strict";var n=t(730).charAt;A.exports=function(A,e,t){return e+(t?n(A,e).length:1)}},767:(A,e,t)=>{"use strict";var n=t(3622),i=TypeError;A.exports=function(A,e){if(n(e,A))return A;throw new i("Incorrect invocation")}},5027:(A,e,t)=>{"use strict";var n=t(8999),i=String,r=TypeError;A.exports=function(A){if(n(A))return A;throw new r(i(A)+" is not an object")}},1655:(A,e,t)=>{"use strict";var n=t(3689);A.exports=n((function(){if("function"==typeof ArrayBuffer){var A=new ArrayBuffer(8);Object.isExtensible(A)&&Object.defineProperty(A,"a",{value:8})}}))},2872:(A,e,t)=>{"use strict";var n=t(690),i=t(7578),r=t(6310);A.exports=function(A){for(var e=n(this),t=r(e),o=arguments.length,s=i(o>1?arguments[1]:void 0,t),a=o>2?arguments[2]:void 0,B=void 0===a?t:i(a,t);B>s;)e[s++]=A;return e}},7612:(A,e,t)=>{"use strict";var n=t(2960).forEach,i=t(6834)("forEach");A.exports=i?[].forEach:function(A){return n(this,A,arguments.length>1?arguments[1]:void 0)}},1055:(A,e,t)=>{"use strict";var n=t(4071),i=t(2615),r=t(690),o=t(1228),s=t(3292),a=t(9429),B=t(6310),c=t(6522),g=t(5185),E=t(1664),Q=Array;A.exports=function(A){var e=r(A),t=a(this),u=arguments.length,l=u>1?arguments[1]:void 0,w=void 0!==l;w&&(l=n(l,u>2?arguments[2]:void 0));var h,C,I,M,d,m,p=E(e),F=0;if(!p||this===Q&&s(p))for(h=B(e),C=t?new this(h):Q(h);h>F;F++)m=w?l(e[F],F):e[F],c(C,F,m);else for(d=(M=g(e,p)).next,C=t?new this:[];!(I=i(d,M)).done;F++)m=w?o(M,l,[I.value,F],!0):I.value,c(C,F,m);return C.length=F,C}},4328:(A,e,t)=>{"use strict";var n=t(5290),i=t(7578),r=t(6310),o=function(A){return function(e,t,o){var s,a=n(e),B=r(a),c=i(o,B);if(A&&t!=t){for(;B>c;)if((s=a[c++])!=s)return!0}else for(;B>c;c++)if((A||c in a)&&a[c]===t)return A||c||0;return!A&&-1}};A.exports={includes:o(!0),indexOf:o(!1)}},2960:(A,e,t)=>{"use strict";var n=t(4071),i=t(8844),r=t(4413),o=t(690),s=t(6310),a=t(7120),B=i([].push),c=function(A){var e=1===A,t=2===A,i=3===A,c=4===A,g=6===A,E=7===A,Q=5===A||g;return function(u,l,w,h){for(var C,I,M=o(u),d=r(M),m=n(l,w),p=s(d),F=0,D=h||a,Y=e?D(u,p):t||E?D(u,0):void 0;p>F;F++)if((Q||F in d)&&(I=m(C=d[F],F,M),A))if(e)Y[F]=I;else if(I)switch(A){case 3:return!0;case 5:return C;case 6:return F;case 2:B(Y,C)}else switch(A){case 4:return!1;case 7:B(Y,C)}return g?-1:i||c?c:Y}};A.exports={forEach:c(0),map:c(1),filter:c(2),some:c(3),every:c(4),find:c(5),findIndex:c(6),filterReject:c(7)}},9042:(A,e,t)=>{"use strict";var n=t(3689),i=t(4201),r=t(3615),o=i("species");A.exports=function(A){return r>=51||!n((function(){var e=[];return(e.constructor={})[o]=function(){return{foo:1}},1!==e[A](Boolean).foo}))}},6834:(A,e,t)=>{"use strict";var n=t(3689);A.exports=function(A,e){var t=[][A];return!!t&&n((function(){t.call(null,e||function(){return 1},1)}))}},8820:(A,e,t)=>{"use strict";var n=t(509),i=t(690),r=t(4413),o=t(6310),s=TypeError,a=function(A){return function(e,t,a,B){n(t);var c=i(e),g=r(c),E=o(c),Q=A?E-1:0,u=A?-1:1;if(a<2)for(;;){if(Q in g){B=g[Q],Q+=u;break}if(Q+=u,A?Q<0:E<=Q)throw new s("Reduce of empty array with no initial value")}for(;A?Q>=0:E>Q;Q+=u)Q in g&&(B=t(B,g[Q],Q,c));return B}};A.exports={left:a(!1),right:a(!0)}},5649:(A,e,t)=>{"use strict";var n=t(7697),i=t(2297),r=TypeError,o=Object.getOwnPropertyDescriptor,s=n&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(A){return A instanceof TypeError}}();A.exports=s?function(A,e){if(i(A)&&!o(A,"length").writable)throw new r("Cannot set read only .length");return A.length=e}:function(A,e){return A.length=e}},9015:(A,e,t)=>{"use strict";var n=t(7578),i=t(6310),r=t(6522),o=Array,s=Math.max;A.exports=function(A,e,t){for(var a=i(A),B=n(e,a),c=n(void 0===t?a:t,a),g=o(s(c-B,0)),E=0;B<c;B++,E++)r(g,E,A[B]);return g.length=E,g}},6004:(A,e,t)=>{"use strict";var n=t(8844);A.exports=n([].slice)},382:(A,e,t)=>{"use strict";var n=t(9015),i=Math.floor,r=function(A,e){var t=A.length,a=i(t/2);return t<8?o(A,e):s(A,r(n(A,0,a),e),r(n(A,a),e),e)},o=function(A,e){for(var t,n,i=A.length,r=1;r<i;){for(n=r,t=A[r];n&&e(A[n-1],t)>0;)A[n]=A[--n];n!==r++&&(A[n]=t)}return A},s=function(A,e,t,n){for(var i=e.length,r=t.length,o=0,s=0;o<i||s<r;)A[o+s]=o<i&&s<r?n(e[o],t[s])<=0?e[o++]:t[s++]:o<i?e[o++]:t[s++];return A};A.exports=r},5271:(A,e,t)=>{"use strict";var n=t(2297),i=t(9429),r=t(8999),o=t(4201)("species"),s=Array;A.exports=function(A){var e;return n(A)&&(e=A.constructor,(i(e)&&(e===s||n(e.prototype))||r(e)&&null===(e=e[o]))&&(e=void 0)),void 0===e?s:e}},7120:(A,e,t)=>{"use strict";var n=t(5271);A.exports=function(A,e){return new(n(A))(0===e?0:e)}},1228:(A,e,t)=>{"use strict";var n=t(5027),i=t(2125);A.exports=function(A,e,t,r){try{return r?e(n(t)[0],t[1]):e(t)}catch(e){i(A,"throw",e)}}},6431:(A,e,t)=>{"use strict";var n=t(4201)("iterator"),i=!1;try{var r=0,o={next:function(){return{done:!!r++}},return:function(){i=!0}};o[n]=function(){return this},Array.from(o,(function(){throw 2}))}catch(A){}A.exports=function(A,e){try{if(!e&&!i)return!1}catch(A){return!1}var t=!1;try{var r={};r[n]=function(){return{next:function(){return{done:t=!0}}}},A(r)}catch(A){}return t}},6648:(A,e,t)=>{"use strict";var n=t(8844),i=n({}.toString),r=n("".slice);A.exports=function(A){return r(i(A),8,-1)}},926:(A,e,t)=>{"use strict";var n=t(3043),i=t(9985),r=t(6648),o=t(4201)("toStringTag"),s=Object,a="Arguments"===r(function(){return arguments}());A.exports=n?r:function(A){var e,t,n;return void 0===A?"Undefined":null===A?"Null":"string"==typeof(t=function(A,e){try{return A[e]}catch(A){}}(e=s(A),o))?t:a?r(e):"Object"===(n=r(e))&&i(e.callee)?"Arguments":n}},800:(A,e,t)=>{"use strict";var n=t(5391),i=t(2148),r=t(6045),o=t(4071),s=t(767),a=t(981),B=t(8734),c=t(1934),g=t(7807),E=t(4241),Q=t(7697),u=t(5375).fastKey,l=t(618),w=l.set,h=l.getterFor;A.exports={getConstructor:function(A,e,t,c){var g=A((function(A,i){s(A,E),w(A,{type:e,index:n(null),first:void 0,last:void 0,size:0}),Q||(A.size=0),a(i)||B(i,A[c],{that:A,AS_ENTRIES:t})})),E=g.prototype,l=h(e),C=function(A,e,t){var n,i,r=l(A),o=I(A,e);return o?o.value=t:(r.last=o={index:i=u(e,!0),key:e,value:t,previous:n=r.last,next:void 0,removed:!1},r.first||(r.first=o),n&&(n.next=o),Q?r.size++:A.size++,"F"!==i&&(r.index[i]=o)),A},I=function(A,e){var t,n=l(A),i=u(e);if("F"!==i)return n.index[i];for(t=n.first;t;t=t.next)if(t.key===e)return t};return r(E,{clear:function(){for(var A=l(this),e=A.index,t=A.first;t;)t.removed=!0,t.previous&&(t.previous=t.previous.next=void 0),delete e[t.index],t=t.next;A.first=A.last=void 0,Q?A.size=0:this.size=0},delete:function(A){var e=this,t=l(e),n=I(e,A);if(n){var i=n.next,r=n.previous;delete t.index[n.index],n.removed=!0,r&&(r.next=i),i&&(i.previous=r),t.first===n&&(t.first=i),t.last===n&&(t.last=r),Q?t.size--:e.size--}return!!n},forEach:function(A){for(var e,t=l(this),n=o(A,arguments.length>1?arguments[1]:void 0);e=e?e.next:t.first;)for(n(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(A){return!!I(this,A)}}),r(E,t?{get:function(A){var e=I(this,A);return e&&e.value},set:function(A,e){return C(this,0===A?0:A,e)}}:{add:function(A){return C(this,A=0===A?0:A,A)}}),Q&&i(E,"size",{configurable:!0,get:function(){return l(this).size}}),g},setStrong:function(A,e,t){var n=e+" Iterator",i=h(e),r=h(n);c(A,e,(function(A,e){w(this,{type:n,target:A,state:i(A),kind:e,last:void 0})}),(function(){for(var A=r(this),e=A.kind,t=A.last;t&&t.removed;)t=t.previous;return A.target&&(A.last=t=t?t.next:A.state.first)?g("keys"===e?t.key:"values"===e?t.value:[t.key,t.value],!1):(A.target=void 0,g(void 0,!0))}),t?"entries":"values",!t,!0),E(e)}}},319:(A,e,t)=>{"use strict";var n=t(9989),i=t(9037),r=t(8844),o=t(5266),s=t(1880),a=t(5375),B=t(8734),c=t(767),g=t(9985),E=t(981),Q=t(8999),u=t(3689),l=t(6431),w=t(5997),h=t(3457);A.exports=function(A,e,t){var C=-1!==A.indexOf("Map"),I=-1!==A.indexOf("Weak"),M=C?"set":"add",d=i[A],m=d&&d.prototype,p=d,F={},D=function(A){var e=r(m[A]);s(m,A,"add"===A?function(A){return e(this,0===A?0:A),this}:"delete"===A?function(A){return!(I&&!Q(A))&&e(this,0===A?0:A)}:"get"===A?function(A){return I&&!Q(A)?void 0:e(this,0===A?0:A)}:"has"===A?function(A){return!(I&&!Q(A))&&e(this,0===A?0:A)}:function(A,t){return e(this,0===A?0:A,t),this})};if(o(A,!g(d)||!(I||m.forEach&&!u((function(){(new d).entries().next()})))))p=t.getConstructor(e,A,C,M),a.enable();else if(o(A,!0)){var Y=new p,f=Y[M](I?{}:-0,1)!==Y,N=u((function(){Y.has(1)})),U=l((function(A){new d(A)})),y=!I&&u((function(){for(var A=new d,e=5;e--;)A[M](e,e);return!A.has(-0)}));U||((p=e((function(A,e){c(A,m);var t=h(new d,A,p);return E(e)||B(e,t[M],{that:t,AS_ENTRIES:C}),t}))).prototype=m,m.constructor=p),(N||y)&&(D("delete"),D("has"),C&&D("get")),(y||f)&&D(M),I&&m.clear&&delete m.clear}return F[A]=p,n({global:!0,constructor:!0,forced:p!==d},F),w(p,A),I||t.setStrong(p,A,C),p}},8758:(A,e,t)=>{"use strict";var n=t(6812),i=t(9152),r=t(2474),o=t(2560);A.exports=function(A,e,t){for(var s=i(e),a=o.f,B=r.f,c=0;c<s.length;c++){var g=s[c];n(A,g)||t&&n(t,g)||a(A,g,B(e,g))}}},7413:(A,e,t)=>{"use strict";var n=t(4201)("match");A.exports=function(A){var e=/./;try{"/./"[A](e)}catch(t){try{return e[n]=!1,"/./"[A](e)}catch(A){}}return!1}},1748:(A,e,t)=>{"use strict";var n=t(3689);A.exports=!n((function(){function A(){}return A.prototype.constructor=null,Object.getPrototypeOf(new A)!==A.prototype}))},1568:(A,e,t)=>{"use strict";var n=t(8844),i=t(4684),r=t(4327),o=/"/g,s=n("".replace);A.exports=function(A,e,t,n){var a=r(i(A)),B="<"+e;return""!==t&&(B+=" "+t+'="'+s(r(n),o,"&quot;")+'"'),B+">"+a+"</"+e+">"}},7807:A=>{"use strict";A.exports=function(A,e){return{value:A,done:e}}},5773:(A,e,t)=>{"use strict";var n=t(7697),i=t(2560),r=t(5684);A.exports=n?function(A,e,t){return i.f(A,e,r(1,t))}:function(A,e,t){return A[e]=t,A}},5684:A=>{"use strict";A.exports=function(A,e){return{enumerable:!(1&A),configurable:!(2&A),writable:!(4&A),value:e}}},6522:(A,e,t)=>{"use strict";var n=t(8360),i=t(2560),r=t(5684);A.exports=function(A,e,t){var o=n(e);o in A?i.f(A,o,r(0,t)):A[o]=t}},2148:(A,e,t)=>{"use strict";var n=t(8702),i=t(2560);A.exports=function(A,e,t){return t.get&&n(t.get,e,{getter:!0}),t.set&&n(t.set,e,{setter:!0}),i.f(A,e,t)}},1880:(A,e,t)=>{"use strict";var n=t(9985),i=t(2560),r=t(8702),o=t(5014);A.exports=function(A,e,t,s){s||(s={});var a=s.enumerable,B=void 0!==s.name?s.name:e;if(n(t)&&r(t,B,s),s.global)a?A[e]=t:o(e,t);else{try{s.unsafe?A[e]&&(a=!0):delete A[e]}catch(A){}a?A[e]=t:i.f(A,e,{value:t,enumerable:!1,configurable:!s.nonConfigurable,writable:!s.nonWritable})}return A}},6045:(A,e,t)=>{"use strict";var n=t(1880);A.exports=function(A,e,t){for(var i in e)n(A,i,e[i],t);return A}},5014:(A,e,t)=>{"use strict";var n=t(9037),i=Object.defineProperty;A.exports=function(A,e){try{i(n,A,{value:e,configurable:!0,writable:!0})}catch(t){n[A]=e}return e}},8494:(A,e,t)=>{"use strict";var n=t(3691),i=TypeError;A.exports=function(A,e){if(!delete A[e])throw new i("Cannot delete property "+n(e)+" of "+n(A))}},7697:(A,e,t)=>{"use strict";var n=t(3689);A.exports=!n((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}))},2659:A=>{"use strict";var e="object"==typeof document&&document.all,t=void 0===e&&void 0!==e;A.exports={all:e,IS_HTMLDDA:t}},6420:(A,e,t)=>{"use strict";var n=t(9037),i=t(8999),r=n.document,o=i(r)&&i(r.createElement);A.exports=function(A){return o?r.createElement(A):{}}},5565:A=>{"use strict";var e=TypeError;A.exports=function(A){if(A>9007199254740991)throw e("Maximum allowed index exceeded");return A}},6338:A=>{"use strict";A.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},3265:(A,e,t)=>{"use strict";var n=t(6420)("span").classList,i=n&&n.constructor&&n.constructor.prototype;A.exports=i===Object.prototype?void 0:i},7365:(A,e,t)=>{"use strict";var n=t(71).match(/firefox\/(\d+)/i);A.exports=!!n&&+n[1]},2532:(A,e,t)=>{"use strict";var n=t(8563),i=t(806);A.exports=!n&&!i&&"object"==typeof window&&"object"==typeof document},8563:A=>{"use strict";A.exports="object"==typeof Deno&&Deno&&"object"==typeof Deno.version},7298:(A,e,t)=>{"use strict";var n=t(71);A.exports=/MSIE|Trident/.test(n)},3221:(A,e,t)=>{"use strict";var n=t(71);A.exports=/ipad|iphone|ipod/i.test(n)&&"undefined"!=typeof Pebble},4764:(A,e,t)=>{"use strict";var n=t(71);A.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(n)},806:(A,e,t)=>{"use strict";var n=t(9037),i=t(6648);A.exports="process"===i(n.process)},7486:(A,e,t)=>{"use strict";var n=t(71);A.exports=/web0s(?!.*chrome)/i.test(n)},71:A=>{"use strict";A.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},3615:(A,e,t)=>{"use strict";var n,i,r=t(9037),o=t(71),s=r.process,a=r.Deno,B=s&&s.versions||a&&a.version,c=B&&B.v8;c&&(i=(n=c.split("."))[0]>0&&n[0]<4?1:+(n[0]+n[1])),!i&&o&&(!(n=o.match(/Edge\/(\d+)/))||n[1]>=74)&&(n=o.match(/Chrome\/(\d+)/))&&(i=+n[1]),A.exports=i},7922:(A,e,t)=>{"use strict";var n=t(71).match(/AppleWebKit\/(\d+)\./);A.exports=!!n&&+n[1]},2739:A=>{"use strict";A.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},9989:(A,e,t)=>{"use strict";var n=t(9037),i=t(2474).f,r=t(5773),o=t(1880),s=t(5014),a=t(8758),B=t(5266);A.exports=function(A,e){var t,c,g,E,Q,u=A.target,l=A.global,w=A.stat;if(t=l?n:w?n[u]||s(u,{}):(n[u]||{}).prototype)for(c in e){if(E=e[c],g=A.dontCallGetSet?(Q=i(t,c))&&Q.value:t[c],!B(l?c:u+(w?".":"#")+c,A.forced)&&void 0!==g){if(typeof E==typeof g)continue;a(E,g)}(A.sham||g&&g.sham)&&r(E,"sham",!0),o(t,c,E,A)}}},3689:A=>{"use strict";A.exports=function(A){try{return!!A()}catch(A){return!0}}},8678:(A,e,t)=>{"use strict";t(4043);var n=t(6576),i=t(1880),r=t(6308),o=t(3689),s=t(4201),a=t(5773),B=s("species"),c=RegExp.prototype;A.exports=function(A,e,t,g){var E=s(A),Q=!o((function(){var e={};return e[E]=function(){return 7},7!==""[A](e)})),u=Q&&!o((function(){var e=!1,t=/a/;return"split"===A&&((t={}).constructor={},t.constructor[B]=function(){return t},t.flags="",t[E]=/./[E]),t.exec=function(){return e=!0,null},t[E](""),!e}));if(!Q||!u||t){var l=n(/./[E]),w=e(E,""[A],(function(A,e,t,i,o){var s=n(A),a=e.exec;return a===r||a===c.exec?Q&&!o?{done:!0,value:l(e,t,i)}:{done:!0,value:s(t,e,i)}:{done:!1}}));i(String.prototype,A,w[0]),i(c,E,w[1])}g&&a(c[E],"sham",!0)}},1594:(A,e,t)=>{"use strict";var n=t(3689);A.exports=!n((function(){return Object.isExtensible(Object.preventExtensions({}))}))},1735:(A,e,t)=>{"use strict";var n=t(7215),i=Function.prototype,r=i.apply,o=i.call;A.exports="object"==typeof Reflect&&Reflect.apply||(n?o.bind(r):function(){return o.apply(r,arguments)})},4071:(A,e,t)=>{"use strict";var n=t(6576),i=t(509),r=t(7215),o=n(n.bind);A.exports=function(A,e){return i(A),void 0===e?A:r?o(A,e):function(){return A.apply(e,arguments)}}},7215:(A,e,t)=>{"use strict";var n=t(3689);A.exports=!n((function(){var A=function(){}.bind();return"function"!=typeof A||A.hasOwnProperty("prototype")}))},6761:(A,e,t)=>{"use strict";var n=t(8844),i=t(509),r=t(8999),o=t(6812),s=t(6004),a=t(7215),B=Function,c=n([].concat),g=n([].join),E={};A.exports=a?B.bind:function(A){var e=i(this),t=e.prototype,n=s(arguments,1),a=function(){var t=c(n,s(arguments));return this instanceof a?function(A,e,t){if(!o(E,e)){for(var n=[],i=0;i<e;i++)n[i]="a["+i+"]";E[e]=B("C,a","return new C("+g(n,",")+")")}return E[e](A,t)}(e,t.length,t):e.apply(A,t)};return r(t)&&(a.prototype=t),a}},2615:(A,e,t)=>{"use strict";var n=t(7215),i=Function.prototype.call;A.exports=n?i.bind(i):function(){return i.apply(i,arguments)}},1236:(A,e,t)=>{"use strict";var n=t(7697),i=t(6812),r=Function.prototype,o=n&&Object.getOwnPropertyDescriptor,s=i(r,"name"),a=s&&"something"===function(){}.name,B=s&&(!n||n&&o(r,"name").configurable);A.exports={EXISTS:s,PROPER:a,CONFIGURABLE:B}},2743:(A,e,t)=>{"use strict";var n=t(8844),i=t(509);A.exports=function(A,e,t){try{return n(i(Object.getOwnPropertyDescriptor(A,e)[t]))}catch(A){}}},6576:(A,e,t)=>{"use strict";var n=t(6648),i=t(8844);A.exports=function(A){if("Function"===n(A))return i(A)}},8844:(A,e,t)=>{"use strict";var n=t(7215),i=Function.prototype,r=i.call,o=n&&i.bind.bind(r,r);A.exports=n?o:function(A){return function(){return r.apply(A,arguments)}}},6058:(A,e,t)=>{"use strict";var n=t(9037),i=t(9985);A.exports=function(A,e){return arguments.length<2?(t=n[A],i(t)?t:void 0):n[A]&&n[A][e];var t}},1664:(A,e,t)=>{"use strict";var n=t(926),i=t(4849),r=t(981),o=t(9478),s=t(4201)("iterator");A.exports=function(A){if(!r(A))return i(A,s)||i(A,"@@iterator")||o[n(A)]}},5185:(A,e,t)=>{"use strict";var n=t(2615),i=t(509),r=t(5027),o=t(3691),s=t(1664),a=TypeError;A.exports=function(A,e){var t=arguments.length<2?s(A):e;if(i(t))return r(n(t,A));throw new a(o(A)+" is not iterable")}},2643:(A,e,t)=>{"use strict";var n=t(8844),i=t(2297),r=t(9985),o=t(6648),s=t(4327),a=n([].push);A.exports=function(A){if(r(A))return A;if(i(A)){for(var e=A.length,t=[],n=0;n<e;n++){var B=A[n];"string"==typeof B?a(t,B):"number"!=typeof B&&"Number"!==o(B)&&"String"!==o(B)||a(t,s(B))}var c=t.length,g=!0;return function(A,e){if(g)return g=!1,e;if(i(this))return e;for(var n=0;n<c;n++)if(t[n]===A)return e}}}},4849:(A,e,t)=>{"use strict";var n=t(509),i=t(981);A.exports=function(A,e){var t=A[e];return i(t)?void 0:n(t)}},7017:(A,e,t)=>{"use strict";var n=t(8844),i=t(690),r=Math.floor,o=n("".charAt),s=n("".replace),a=n("".slice),B=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,c=/\$([$&'`]|\d{1,2})/g;A.exports=function(A,e,t,n,g,E){var Q=t+A.length,u=n.length,l=c;return void 0!==g&&(g=i(g),l=B),s(E,l,(function(i,s){var B;switch(o(s,0)){case"$":return"$";case"&":return A;case"`":return a(e,0,t);case"'":return a(e,Q);case"<":B=g[a(s,1,-1)];break;default:var c=+s;if(0===c)return i;if(c>u){var E=r(c/10);return 0===E?i:E<=u?void 0===n[E-1]?o(s,1):n[E-1]+o(s,1):i}B=n[c-1]}return void 0===B?"":B}))}},9037:function(A){"use strict";var t=function(A){return A&&A.Math===Math&&A};A.exports=t("object"==typeof globalThis&&globalThis)||t("object"==typeof window&&window)||t("object"==typeof self&&self)||t("object"==typeof e&&e)||function(){return this}()||this||Function("return this")()},6812:(A,e,t)=>{"use strict";var n=t(8844),i=t(690),r=n({}.hasOwnProperty);A.exports=Object.hasOwn||function(A,e){return r(i(A),e)}},7248:A=>{"use strict";A.exports={}},920:A=>{"use strict";A.exports=function(A,e){try{1===arguments.length?console.error(A):console.error(A,e)}catch(A){}}},2688:(A,e,t)=>{"use strict";var n=t(6058);A.exports=n("document","documentElement")},8506:(A,e,t)=>{"use strict";var n=t(7697),i=t(3689),r=t(6420);A.exports=!n&&!i((function(){return 7!==Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a}))},4413:(A,e,t)=>{"use strict";var n=t(8844),i=t(3689),r=t(6648),o=Object,s=n("".split);A.exports=i((function(){return!o("z").propertyIsEnumerable(0)}))?function(A){return"String"===r(A)?s(A,""):o(A)}:o},3457:(A,e,t)=>{"use strict";var n=t(9985),i=t(8999),r=t(9385);A.exports=function(A,e,t){var o,s;return r&&n(o=e.constructor)&&o!==t&&i(s=o.prototype)&&s!==t.prototype&&r(A,s),A}},6738:(A,e,t)=>{"use strict";var n=t(8844),i=t(9985),r=t(4091),o=n(Function.toString);i(r.inspectSource)||(r.inspectSource=function(A){return o(A)}),A.exports=r.inspectSource},5375:(A,e,t)=>{"use strict";var n=t(9989),i=t(8844),r=t(7248),o=t(8999),s=t(6812),a=t(2560).f,B=t(2741),c=t(6062),g=t(7049),E=t(4630),Q=t(1594),u=!1,l=E("meta"),w=0,h=function(A){a(A,l,{value:{objectID:"O"+w++,weakData:{}}})},C=A.exports={enable:function(){C.enable=function(){},u=!0;var A=B.f,e=i([].splice),t={};t[l]=1,A(t).length&&(B.f=function(t){for(var n=A(t),i=0,r=n.length;i<r;i++)if(n[i]===l){e(n,i,1);break}return n},n({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:c.f}))},fastKey:function(A,e){if(!o(A))return"symbol"==typeof A?A:("string"==typeof A?"S":"P")+A;if(!s(A,l)){if(!g(A))return"F";if(!e)return"E";h(A)}return A[l].objectID},getWeakData:function(A,e){if(!s(A,l)){if(!g(A))return!0;if(!e)return!1;h(A)}return A[l].weakData},onFreeze:function(A){return Q&&u&&g(A)&&!s(A,l)&&h(A),A}};r[l]=!0},618:(A,e,t)=>{"use strict";var n,i,r,o=t(9834),s=t(9037),a=t(8999),B=t(5773),c=t(6812),g=t(4091),E=t(2713),Q=t(7248),u="Object already initialized",l=s.TypeError,w=s.WeakMap;if(o||g.state){var h=g.state||(g.state=new w);h.get=h.get,h.has=h.has,h.set=h.set,n=function(A,e){if(h.has(A))throw new l(u);return e.facade=A,h.set(A,e),e},i=function(A){return h.get(A)||{}},r=function(A){return h.has(A)}}else{var C=E("state");Q[C]=!0,n=function(A,e){if(c(A,C))throw new l(u);return e.facade=A,B(A,C,e),e},i=function(A){return c(A,C)?A[C]:{}},r=function(A){return c(A,C)}}A.exports={set:n,get:i,has:r,enforce:function(A){return r(A)?i(A):n(A,{})},getterFor:function(A){return function(e){var t;if(!a(e)||(t=i(e)).type!==A)throw new l("Incompatible receiver, "+A+" required");return t}}}},3292:(A,e,t)=>{"use strict";var n=t(4201),i=t(9478),r=n("iterator"),o=Array.prototype;A.exports=function(A){return void 0!==A&&(i.Array===A||o[r]===A)}},2297:(A,e,t)=>{"use strict";var n=t(6648);A.exports=Array.isArray||function(A){return"Array"===n(A)}},9985:(A,e,t)=>{"use strict";var n=t(2659),i=n.all;A.exports=n.IS_HTMLDDA?function(A){return"function"==typeof A||A===i}:function(A){return"function"==typeof A}},9429:(A,e,t)=>{"use strict";var n=t(8844),i=t(3689),r=t(9985),o=t(926),s=t(6058),a=t(6738),B=function(){},c=[],g=s("Reflect","construct"),E=/^\s*(?:class|function)\b/,Q=n(E.exec),u=!E.test(B),l=function(A){if(!r(A))return!1;try{return g(B,c,A),!0}catch(A){return!1}},w=function(A){if(!r(A))return!1;switch(o(A)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return u||!!Q(E,a(A))}catch(A){return!0}};w.sham=!0,A.exports=!g||i((function(){var A;return l(l.call)||!l(Object)||!l((function(){A=!0}))||A}))?w:l},5266:(A,e,t)=>{"use strict";var n=t(3689),i=t(9985),r=/#|\.prototype\./,o=function(A,e){var t=a[s(A)];return t===c||t!==B&&(i(e)?n(e):!!e)},s=o.normalize=function(A){return String(A).replace(r,".").toLowerCase()},a=o.data={},B=o.NATIVE="N",c=o.POLYFILL="P";A.exports=o},981:A=>{"use strict";A.exports=function(A){return null==A}},8999:(A,e,t)=>{"use strict";var n=t(9985),i=t(2659),r=i.all;A.exports=i.IS_HTMLDDA?function(A){return"object"==typeof A?null!==A:n(A)||A===r}:function(A){return"object"==typeof A?null!==A:n(A)}},3931:A=>{"use strict";A.exports=!1},1245:(A,e,t)=>{"use strict";var n=t(8999),i=t(6648),r=t(4201)("match");A.exports=function(A){var e;return n(A)&&(void 0!==(e=A[r])?!!e:"RegExp"===i(A))}},734:(A,e,t)=>{"use strict";var n=t(6058),i=t(9985),r=t(3622),o=t(9525),s=Object;A.exports=o?function(A){return"symbol"==typeof A}:function(A){var e=n("Symbol");return i(e)&&r(e.prototype,s(A))}},8734:(A,e,t)=>{"use strict";var n=t(4071),i=t(2615),r=t(5027),o=t(3691),s=t(3292),a=t(6310),B=t(3622),c=t(5185),g=t(1664),E=t(2125),Q=TypeError,u=function(A,e){this.stopped=A,this.result=e},l=u.prototype;A.exports=function(A,e,t){var w,h,C,I,M,d,m,p=t&&t.that,F=!(!t||!t.AS_ENTRIES),D=!(!t||!t.IS_RECORD),Y=!(!t||!t.IS_ITERATOR),f=!(!t||!t.INTERRUPTED),N=n(e,p),U=function(A){return w&&E(w,"normal",A),new u(!0,A)},y=function(A){return F?(r(A),f?N(A[0],A[1],U):N(A[0],A[1])):f?N(A,U):N(A)};if(D)w=A.iterator;else if(Y)w=A;else{if(!(h=g(A)))throw new Q(o(A)+" is not iterable");if(s(h)){for(C=0,I=a(A);I>C;C++)if((M=y(A[C]))&&B(l,M))return M;return new u(!1)}w=c(A,h)}for(d=D?A.next:w.next;!(m=i(d,w)).done;){try{M=y(m.value)}catch(A){E(w,"throw",A)}if("object"==typeof M&&M&&B(l,M))return M}return new u(!1)}},2125:(A,e,t)=>{"use strict";var n=t(2615),i=t(5027),r=t(4849);A.exports=function(A,e,t){var o,s;i(A);try{if(!(o=r(A,"return"))){if("throw"===e)throw t;return t}o=n(o,A)}catch(A){s=!0,o=A}if("throw"===e)throw t;if(s)throw o;return i(o),t}},974:(A,e,t)=>{"use strict";var n=t(2013).IteratorPrototype,i=t(5391),r=t(5684),o=t(5997),s=t(9478),a=function(){return this};A.exports=function(A,e,t,B){var c=e+" Iterator";return A.prototype=i(n,{next:r(+!B,t)}),o(A,c,!1,!0),s[c]=a,A}},1934:(A,e,t)=>{"use strict";var n=t(9989),i=t(2615),r=t(3931),o=t(1236),s=t(9985),a=t(974),B=t(1868),c=t(9385),g=t(5997),E=t(5773),Q=t(1880),u=t(4201),l=t(9478),w=t(2013),h=o.PROPER,C=o.CONFIGURABLE,I=w.IteratorPrototype,M=w.BUGGY_SAFARI_ITERATORS,d=u("iterator"),m="keys",p="values",F="entries",D=function(){return this};A.exports=function(A,e,t,o,u,w,Y){a(t,e,o);var f,N,U,y=function(A){if(A===u&&S)return S;if(!M&&A&&A in R)return R[A];switch(A){case m:case p:case F:return function(){return new t(this,A)}}return function(){return new t(this)}},T=e+" Iterator",x=!1,R=A.prototype,G=R[d]||R["@@iterator"]||u&&R[u],S=!M&&G||y(u),H="Array"===e&&R.entries||G;if(H&&(f=B(H.call(new A)))!==Object.prototype&&f.next&&(r||B(f)===I||(c?c(f,I):s(f[d])||Q(f,d,D)),g(f,T,!0,!0),r&&(l[T]=D)),h&&u===p&&G&&G.name!==p&&(!r&&C?E(R,"name",p):(x=!0,S=function(){return i(G,this)})),u)if(N={values:y(p),keys:w?S:y(m),entries:y(F)},Y)for(U in N)(M||x||!(U in R))&&Q(R,U,N[U]);else n({target:e,proto:!0,forced:M||x},N);return r&&!Y||R[d]===S||Q(R,d,S,{name:u}),l[e]=S,N}},2013:(A,e,t)=>{"use strict";var n,i,r,o=t(3689),s=t(9985),a=t(8999),B=t(5391),c=t(1868),g=t(1880),E=t(4201),Q=t(3931),u=E("iterator"),l=!1;[].keys&&("next"in(r=[].keys())?(i=c(c(r)))!==Object.prototype&&(n=i):l=!0),!a(n)||o((function(){var A={};return n[u].call(A)!==A}))?n={}:Q&&(n=B(n)),s(n[u])||g(n,u,(function(){return this})),A.exports={IteratorPrototype:n,BUGGY_SAFARI_ITERATORS:l}},9478:A=>{"use strict";A.exports={}},6310:(A,e,t)=>{"use strict";var n=t(3126);A.exports=function(A){return n(A.length)}},8702:(A,e,t)=>{"use strict";var n=t(8844),i=t(3689),r=t(9985),o=t(6812),s=t(7697),a=t(1236).CONFIGURABLE,B=t(6738),c=t(618),g=c.enforce,E=c.get,Q=String,u=Object.defineProperty,l=n("".slice),w=n("".replace),h=n([].join),C=s&&!i((function(){return 8!==u((function(){}),"length",{value:8}).length})),I=String(String).split("String"),M=A.exports=function(A,e,t){"Symbol("===l(Q(e),0,7)&&(e="["+w(Q(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),t&&t.getter&&(e="get "+e),t&&t.setter&&(e="set "+e),(!o(A,"name")||a&&A.name!==e)&&(s?u(A,"name",{value:e,configurable:!0}):A.name=e),C&&t&&o(t,"arity")&&A.length!==t.arity&&u(A,"length",{value:t.arity});try{t&&o(t,"constructor")&&t.constructor?s&&u(A,"prototype",{writable:!1}):A.prototype&&(A.prototype=void 0)}catch(A){}var n=g(A);return o(n,"source")||(n.source=h(I,"string"==typeof e?e:"")),A};Function.prototype.toString=M((function(){return r(this)&&E(this).source||B(this)}),"toString")},1745:A=>{"use strict";var e=Math.expm1,t=Math.exp;A.exports=!e||e(10)>22025.465794806718||e(10)<22025.465794806718||-2e-17!==e(-2e-17)?function(A){var e=+A;return 0===e?e:e>-1e-6&&e<1e-6?e+e*e/2:t(e)-1}:e},4736:A=>{"use strict";var e=Math.log,t=Math.LOG10E;A.exports=Math.log10||function(A){return e(A)*t}},3956:A=>{"use strict";var e=Math.log;A.exports=Math.log1p||function(A){var t=+A;return t>-1e-8&&t<1e-8?t-t*t/2:e(1+t)}},5680:A=>{"use strict";A.exports=Math.sign||function(A){var e=+A;return 0===e||e!=e?e:e<0?-1:1}},8828:A=>{"use strict";var e=Math.ceil,t=Math.floor;A.exports=Math.trunc||function(A){var n=+A;return(n>0?t:e)(n)}},231:(A,e,t)=>{"use strict";var n,i,r,o,s,a=t(9037),B=t(4071),c=t(2474).f,g=t(9886).set,E=t(4410),Q=t(4764),u=t(3221),l=t(7486),w=t(806),h=a.MutationObserver||a.WebKitMutationObserver,C=a.document,I=a.process,M=a.Promise,d=c(a,"queueMicrotask"),m=d&&d.value;if(!m){var p=new E,F=function(){var A,e;for(w&&(A=I.domain)&&A.exit();e=p.get();)try{e()}catch(A){throw p.head&&n(),A}A&&A.enter()};Q||w||l||!h||!C?!u&&M&&M.resolve?((o=M.resolve(void 0)).constructor=M,s=B(o.then,o),n=function(){s(F)}):w?n=function(){I.nextTick(F)}:(g=B(g,a),n=function(){g(F)}):(i=!0,r=C.createTextNode(""),new h(F).observe(r,{characterData:!0}),n=function(){r.data=i=!i}),m=function(A){p.head||n(),p.add(A)}}A.exports=m},2582:(A,e,t)=>{"use strict";var n=t(509),i=TypeError,r=function(A){var e,t;this.promise=new A((function(A,n){if(void 0!==e||void 0!==t)throw new i("Bad Promise constructor");e=A,t=n})),this.resolve=n(e),this.reject=n(t)};A.exports.f=function(A){return new r(A)}},2124:(A,e,t)=>{"use strict";var n=t(1245),i=TypeError;A.exports=function(A){if(n(A))throw new i("The method doesn't accept regular expressions");return A}},4818:(A,e,t)=>{"use strict";var n=t(9037),i=t(3689),r=t(8844),o=t(4327),s=t(1435).trim,a=t(6350),B=r("".charAt),c=n.parseFloat,g=n.Symbol,E=g&&g.iterator,Q=1/c(a+"-0")!=-1/0||E&&!i((function(){c(Object(E))}));A.exports=Q?function(A){var e=s(o(A)),t=c(e);return 0===t&&"-"===B(e,0)?-0:t}:c},7897:(A,e,t)=>{"use strict";var n=t(9037),i=t(3689),r=t(8844),o=t(4327),s=t(1435).trim,a=t(6350),B=n.parseInt,c=n.Symbol,g=c&&c.iterator,E=/^[+-]?0x/i,Q=r(E.exec),u=8!==B(a+"08")||22!==B(a+"0x16")||g&&!i((function(){B(Object(g))}));A.exports=u?function(A,e){var t=s(o(A));return B(t,e>>>0||(Q(E,t)?16:10))}:B},5391:(A,e,t)=>{"use strict";var n,i=t(5027),r=t(8920),o=t(2739),s=t(7248),a=t(2688),B=t(6420),c=t(2713),g="prototype",E="script",Q=c("IE_PROTO"),u=function(){},l=function(A){return"<script>"+A+"</"+E+">"},w=function(A){A.write(l("")),A.close();var e=A.parentWindow.Object;return A=null,e},h=function(){try{n=new ActiveXObject("htmlfile")}catch(A){}var A,e;h="undefined"!=typeof document?document.domain&&n?w(n):((e=B("iframe")).style.display="none",a.appendChild(e),e.src=String("javascript:"),(A=e.contentWindow.document).open(),A.write(l("document.F=Object")),A.close(),A.F):w(n);for(var t=o.length;t--;)delete h[g][o[t]];return h()};s[Q]=!0,A.exports=Object.create||function(A,e){var t;return null!==A?(u[g]=i(A),t=new u,u[g]=null,t[Q]=A):t=h(),void 0===e?t:r.f(t,e)}},8920:(A,e,t)=>{"use strict";var n=t(7697),i=t(5648),r=t(2560),o=t(5027),s=t(5290),a=t(300);e.f=n&&!i?Object.defineProperties:function(A,e){o(A);for(var t,n=s(e),i=a(e),B=i.length,c=0;B>c;)r.f(A,t=i[c++],n[t]);return A}},2560:(A,e,t)=>{"use strict";var n=t(7697),i=t(8506),r=t(5648),o=t(5027),s=t(8360),a=TypeError,B=Object.defineProperty,c=Object.getOwnPropertyDescriptor,g="enumerable",E="configurable",Q="writable";e.f=n?r?function(A,e,t){if(o(A),e=s(e),o(t),"function"==typeof A&&"prototype"===e&&"value"in t&&Q in t&&!t[Q]){var n=c(A,e);n&&n[Q]&&(A[e]=t.value,t={configurable:E in t?t[E]:n[E],enumerable:g in t?t[g]:n[g],writable:!1})}return B(A,e,t)}:B:function(A,e,t){if(o(A),e=s(e),o(t),i)try{return B(A,e,t)}catch(A){}if("get"in t||"set"in t)throw new a("Accessors not supported");return"value"in t&&(A[e]=t.value),A}},2474:(A,e,t)=>{"use strict";var n=t(7697),i=t(2615),r=t(9556),o=t(5684),s=t(5290),a=t(8360),B=t(6812),c=t(8506),g=Object.getOwnPropertyDescriptor;e.f=n?g:function(A,e){if(A=s(A),e=a(e),c)try{return g(A,e)}catch(A){}if(B(A,e))return o(!i(r.f,A,e),A[e])}},6062:(A,e,t)=>{"use strict";var n=t(6648),i=t(5290),r=t(2741).f,o=t(9015),s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];A.exports.f=function(A){return s&&"Window"===n(A)?function(A){try{return r(A)}catch(A){return o(s)}}(A):r(i(A))}},2741:(A,e,t)=>{"use strict";var n=t(4948),i=t(2739).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(A){return n(A,i)}},7518:(A,e)=>{"use strict";e.f=Object.getOwnPropertySymbols},1868:(A,e,t)=>{"use strict";var n=t(6812),i=t(9985),r=t(690),o=t(2713),s=t(1748),a=o("IE_PROTO"),B=Object,c=B.prototype;A.exports=s?B.getPrototypeOf:function(A){var e=r(A);if(n(e,a))return e[a];var t=e.constructor;return i(t)&&e instanceof t?t.prototype:e instanceof B?c:null}},7049:(A,e,t)=>{"use strict";var n=t(3689),i=t(8999),r=t(6648),o=t(1655),s=Object.isExtensible,a=n((function(){s(1)}));A.exports=a||o?function(A){return!!i(A)&&(!o||"ArrayBuffer"!==r(A))&&(!s||s(A))}:s},3622:(A,e,t)=>{"use strict";var n=t(8844);A.exports=n({}.isPrototypeOf)},4948:(A,e,t)=>{"use strict";var n=t(8844),i=t(6812),r=t(5290),o=t(4328).indexOf,s=t(7248),a=n([].push);A.exports=function(A,e){var t,n=r(A),B=0,c=[];for(t in n)!i(s,t)&&i(n,t)&&a(c,t);for(;e.length>B;)i(n,t=e[B++])&&(~o(c,t)||a(c,t));return c}},300:(A,e,t)=>{"use strict";var n=t(4948),i=t(2739);A.exports=Object.keys||function(A){return n(A,i)}},9556:(A,e)=>{"use strict";var t={}.propertyIsEnumerable,n=Object.getOwnPropertyDescriptor,i=n&&!t.call({1:2},1);e.f=i?function(A){var e=n(this,A);return!!e&&e.enumerable}:t},9385:(A,e,t)=>{"use strict";var n=t(2743),i=t(5027),r=t(3550);A.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var A,e=!1,t={};try{(A=n(Object.prototype,"__proto__","set"))(t,[]),e=t instanceof Array}catch(A){}return function(t,n){return i(t),r(n),e?A(t,n):t.__proto__=n,t}}():void 0)},5073:(A,e,t)=>{"use strict";var n=t(3043),i=t(926);A.exports=n?{}.toString:function(){return"[object "+i(this)+"]"}},5899:(A,e,t)=>{"use strict";var n=t(2615),i=t(9985),r=t(8999),o=TypeError;A.exports=function(A,e){var t,s;if("string"===e&&i(t=A.toString)&&!r(s=n(t,A)))return s;if(i(t=A.valueOf)&&!r(s=n(t,A)))return s;if("string"!==e&&i(t=A.toString)&&!r(s=n(t,A)))return s;throw new o("Can't convert object to primitive value")}},9152:(A,e,t)=>{"use strict";var n=t(6058),i=t(8844),r=t(2741),o=t(7518),s=t(5027),a=i([].concat);A.exports=n("Reflect","ownKeys")||function(A){var e=r.f(s(A)),t=o.f;return t?a(e,t(A)):e}},496:(A,e,t)=>{"use strict";var n=t(9037);A.exports=n},9302:A=>{"use strict";A.exports=function(A){try{return{error:!1,value:A()}}catch(A){return{error:!0,value:A}}}},7073:(A,e,t)=>{"use strict";var n=t(9037),i=t(7919),r=t(9985),o=t(5266),s=t(6738),a=t(4201),B=t(2532),c=t(8563),g=t(3931),E=t(3615),Q=i&&i.prototype,u=a("species"),l=!1,w=r(n.PromiseRejectionEvent),h=o("Promise",(function(){var A=s(i),e=A!==String(i);if(!e&&66===E)return!0;if(g&&(!Q.catch||!Q.finally))return!0;if(!E||E<51||!/native code/.test(A)){var t=new i((function(A){A(1)})),n=function(A){A((function(){}),(function(){}))};if((t.constructor={})[u]=n,!(l=t.then((function(){}))instanceof n))return!0}return!e&&(B||c)&&!w}));A.exports={CONSTRUCTOR:h,REJECTION_EVENT:w,SUBCLASSING:l}},7919:(A,e,t)=>{"use strict";var n=t(9037);A.exports=n.Promise},2945:(A,e,t)=>{"use strict";var n=t(5027),i=t(8999),r=t(2582);A.exports=function(A,e){if(n(A),i(e)&&e.constructor===A)return e;var t=r.f(A);return(0,t.resolve)(e),t.promise}},562:(A,e,t)=>{"use strict";var n=t(7919),i=t(6431),r=t(7073).CONSTRUCTOR;A.exports=r||!i((function(A){n.all(A).then(void 0,(function(){}))}))},8055:(A,e,t)=>{"use strict";var n=t(2560).f;A.exports=function(A,e,t){t in A||n(A,t,{configurable:!0,get:function(){return e[t]},set:function(A){e[t]=A}})}},4410:A=>{"use strict";var e=function(){this.head=null,this.tail=null};e.prototype={add:function(A){var e={item:A,next:null},t=this.tail;t?t.next=e:this.head=e,this.tail=e},get:function(){var A=this.head;if(A)return null===(this.head=A.next)&&(this.tail=null),A.item}},A.exports=e},6100:(A,e,t)=>{"use strict";var n=t(2615),i=t(5027),r=t(9985),o=t(6648),s=t(6308),a=TypeError;A.exports=function(A,e){var t=A.exec;if(r(t)){var B=n(t,A,e);return null!==B&&i(B),B}if("RegExp"===o(A))return n(s,A,e);throw new a("RegExp#exec called on incompatible receiver")}},6308:(A,e,t)=>{"use strict";var n,i,r=t(2615),o=t(8844),s=t(4327),a=t(9633),B=t(7901),c=t(3430),g=t(5391),E=t(618).get,Q=t(2100),u=t(6422),l=c("native-string-replace",String.prototype.replace),w=RegExp.prototype.exec,h=w,C=o("".charAt),I=o("".indexOf),M=o("".replace),d=o("".slice),m=(i=/b*/g,r(w,n=/a/,"a"),r(w,i,"a"),0!==n.lastIndex||0!==i.lastIndex),p=B.BROKEN_CARET,F=void 0!==/()??/.exec("")[1];(m||F||p||Q||u)&&(h=function(A){var e,t,n,i,o,B,c,Q=this,u=E(Q),D=s(A),Y=u.raw;if(Y)return Y.lastIndex=Q.lastIndex,e=r(h,Y,D),Q.lastIndex=Y.lastIndex,e;var f=u.groups,N=p&&Q.sticky,U=r(a,Q),y=Q.source,T=0,x=D;if(N&&(U=M(U,"y",""),-1===I(U,"g")&&(U+="g"),x=d(D,Q.lastIndex),Q.lastIndex>0&&(!Q.multiline||Q.multiline&&"\n"!==C(D,Q.lastIndex-1))&&(y="(?: "+y+")",x=" "+x,T++),t=new RegExp("^(?:"+y+")",U)),F&&(t=new RegExp("^"+y+"$(?!\\s)",U)),m&&(n=Q.lastIndex),i=r(w,N?t:Q,x),N?i?(i.input=d(i.input,T),i[0]=d(i[0],T),i.index=Q.lastIndex,Q.lastIndex+=i[0].length):Q.lastIndex=0:m&&i&&(Q.lastIndex=Q.global?i.index+i[0].length:n),F&&i&&i.length>1&&r(l,i[0],t,(function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(i[o]=void 0)})),i&&f)for(i.groups=B=g(null),o=0;o<f.length;o++)B[(c=f[o])[0]]=i[c[1]];return i}),A.exports=h},9633:(A,e,t)=>{"use strict";var n=t(5027);A.exports=function(){var A=n(this),e="";return A.hasIndices&&(e+="d"),A.global&&(e+="g"),A.ignoreCase&&(e+="i"),A.multiline&&(e+="m"),A.dotAll&&(e+="s"),A.unicode&&(e+="u"),A.unicodeSets&&(e+="v"),A.sticky&&(e+="y"),e}},3477:(A,e,t)=>{"use strict";var n=t(2615),i=t(6812),r=t(3622),o=t(9633),s=RegExp.prototype;A.exports=function(A){var e=A.flags;return void 0!==e||"flags"in s||i(A,"flags")||!r(s,A)?e:n(o,A)}},7901:(A,e,t)=>{"use strict";var n=t(3689),i=t(9037).RegExp,r=n((function(){var A=i("a","y");return A.lastIndex=2,null!==A.exec("abcd")})),o=r||n((function(){return!i("a","y").sticky})),s=r||n((function(){var A=i("^r","gy");return A.lastIndex=2,null!==A.exec("str")}));A.exports={BROKEN_CARET:s,MISSED_STICKY:o,UNSUPPORTED_Y:r}},2100:(A,e,t)=>{"use strict";var n=t(3689),i=t(9037).RegExp;A.exports=n((function(){var A=i(".","s");return!(A.dotAll&&A.test("\n")&&"s"===A.flags)}))},6422:(A,e,t)=>{"use strict";var n=t(3689),i=t(9037).RegExp;A.exports=n((function(){var A=i("(?<a>b)","g");return"b"!==A.exec("b").groups.a||"bc"!=="b".replace(A,"$<a>c")}))},4684:(A,e,t)=>{"use strict";var n=t(981),i=TypeError;A.exports=function(A){if(n(A))throw new i("Can't call method on "+A);return A}},4241:(A,e,t)=>{"use strict";var n=t(6058),i=t(2148),r=t(4201),o=t(7697),s=r("species");A.exports=function(A){var e=n(A);o&&e&&!e[s]&&i(e,s,{configurable:!0,get:function(){return this}})}},5997:(A,e,t)=>{"use strict";var n=t(2560).f,i=t(6812),r=t(4201)("toStringTag");A.exports=function(A,e,t){A&&!t&&(A=A.prototype),A&&!i(A,r)&&n(A,r,{configurable:!0,value:e})}},2713:(A,e,t)=>{"use strict";var n=t(3430),i=t(4630),r=n("keys");A.exports=function(A){return r[A]||(r[A]=i(A))}},4091:(A,e,t)=>{"use strict";var n=t(9037),i=t(5014),r="__core-js_shared__",o=n[r]||i(r,{});A.exports=o},3430:(A,e,t)=>{"use strict";var n=t(3931),i=t(4091);(A.exports=function(A,e){return i[A]||(i[A]=void 0!==e?e:{})})("versions",[]).push({version:"3.33.1",mode:n?"pure":"global",copyright:" 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.33.1/LICENSE",source:"https://github.com/zloirock/core-js"})},6373:(A,e,t)=>{"use strict";var n=t(5027),i=t(2655),r=t(981),o=t(4201)("species");A.exports=function(A,e){var t,s=n(A).constructor;return void 0===s||r(t=n(s)[o])?e:i(t)}},4580:(A,e,t)=>{"use strict";var n=t(3689);A.exports=function(A){return n((function(){var e=""[A]('"');return e!==e.toLowerCase()||e.split('"').length>3}))}},730:(A,e,t)=>{"use strict";var n=t(8844),i=t(8700),r=t(4327),o=t(4684),s=n("".charAt),a=n("".charCodeAt),B=n("".slice),c=function(A){return function(e,t){var n,c,g=r(o(e)),E=i(t),Q=g.length;return E<0||E>=Q?A?"":void 0:(n=a(g,E))<55296||n>56319||E+1===Q||(c=a(g,E+1))<56320||c>57343?A?s(g,E):n:A?B(g,E,E+2):c-56320+(n-55296<<10)+65536}};A.exports={codeAt:c(!1),charAt:c(!0)}},534:(A,e,t)=>{"use strict";var n=t(8700),i=t(4327),r=t(4684),o=RangeError;A.exports=function(A){var e=i(r(this)),t="",s=n(A);if(s<0||s===1/0)throw new o("Wrong number of repetitions");for(;s>0;(s>>>=1)&&(e+=e))1&s&&(t+=e);return t}},5984:(A,e,t)=>{"use strict";var n=t(1236).PROPER,i=t(3689),r=t(6350);A.exports=function(A){return i((function(){return!!r[A]()||""!==""[A]()||n&&r[A].name!==A}))}},1435:(A,e,t)=>{"use strict";var n=t(8844),i=t(4684),r=t(4327),o=t(6350),s=n("".replace),a=RegExp("^["+o+"]+"),B=RegExp("(^|[^"+o+"])["+o+"]+$"),c=function(A){return function(e){var t=r(i(e));return 1&A&&(t=s(t,a,"")),2&A&&(t=s(t,B,"$1")),t}};A.exports={start:c(1),end:c(2),trim:c(3)}},146:(A,e,t)=>{"use strict";var n=t(3615),i=t(3689),r=t(9037).String;A.exports=!!Object.getOwnPropertySymbols&&!i((function(){var A=Symbol("symbol detection");return!r(A)||!(Object(A)instanceof Symbol)||!Symbol.sham&&n&&n<41}))},3032:(A,e,t)=>{"use strict";var n=t(2615),i=t(6058),r=t(4201),o=t(1880);A.exports=function(){var A=i("Symbol"),e=A&&A.prototype,t=e&&e.valueOf,s=r("toPrimitive");e&&!e[s]&&o(e,s,(function(A){return n(t,this)}),{arity:1})}},6549:(A,e,t)=>{"use strict";var n=t(146);A.exports=n&&!!Symbol.for&&!!Symbol.keyFor},9886:(A,e,t)=>{"use strict";var n,i,r,o,s=t(9037),a=t(1735),B=t(4071),c=t(9985),g=t(6812),E=t(3689),Q=t(2688),u=t(6004),l=t(6420),w=t(1500),h=t(4764),C=t(806),I=s.setImmediate,M=s.clearImmediate,d=s.process,m=s.Dispatch,p=s.Function,F=s.MessageChannel,D=s.String,Y=0,f={},N="onreadystatechange";E((function(){n=s.location}));var U=function(A){if(g(f,A)){var e=f[A];delete f[A],e()}},y=function(A){return function(){U(A)}},T=function(A){U(A.data)},x=function(A){s.postMessage(D(A),n.protocol+"//"+n.host)};I&&M||(I=function(A){w(arguments.length,1);var e=c(A)?A:p(A),t=u(arguments,1);return f[++Y]=function(){a(e,void 0,t)},i(Y),Y},M=function(A){delete f[A]},C?i=function(A){d.nextTick(y(A))}:m&&m.now?i=function(A){m.now(y(A))}:F&&!h?(o=(r=new F).port2,r.port1.onmessage=T,i=B(o.postMessage,o)):s.addEventListener&&c(s.postMessage)&&!s.importScripts&&n&&"file:"!==n.protocol&&!E(x)?(i=x,s.addEventListener("message",T,!1)):i=N in l("script")?function(A){Q.appendChild(l("script"))[N]=function(){Q.removeChild(this),U(A)}}:function(A){setTimeout(y(A),0)}),A.exports={set:I,clear:M}},3648:(A,e,t)=>{"use strict";var n=t(8844);A.exports=n(1..valueOf)},7578:(A,e,t)=>{"use strict";var n=t(8700),i=Math.max,r=Math.min;A.exports=function(A,e){var t=n(A);return t<0?i(t+e,0):r(t,e)}},5290:(A,e,t)=>{"use strict";var n=t(4413),i=t(4684);A.exports=function(A){return n(i(A))}},8700:(A,e,t)=>{"use strict";var n=t(8828);A.exports=function(A){var e=+A;return e!=e||0===e?0:n(e)}},3126:(A,e,t)=>{"use strict";var n=t(8700),i=Math.min;A.exports=function(A){return A>0?i(n(A),9007199254740991):0}},690:(A,e,t)=>{"use strict";var n=t(4684),i=Object;A.exports=function(A){return i(n(A))}},8732:(A,e,t)=>{"use strict";var n=t(2615),i=t(8999),r=t(734),o=t(4849),s=t(5899),a=t(4201),B=TypeError,c=a("toPrimitive");A.exports=function(A,e){if(!i(A)||r(A))return A;var t,a=o(A,c);if(a){if(void 0===e&&(e="default"),t=n(a,A,e),!i(t)||r(t))return t;throw new B("Can't convert object to primitive value")}return void 0===e&&(e="number"),s(A,e)}},8360:(A,e,t)=>{"use strict";var n=t(8732),i=t(734);A.exports=function(A){var e=n(A,"string");return i(e)?e:e+""}},3043:(A,e,t)=>{"use strict";var n={};n[t(4201)("toStringTag")]="z",A.exports="[object z]"===String(n)},4327:(A,e,t)=>{"use strict";var n=t(926),i=String;A.exports=function(A){if("Symbol"===n(A))throw new TypeError("Cannot convert a Symbol value to a string");return i(A)}},3691:A=>{"use strict";var e=String;A.exports=function(A){try{return e(A)}catch(A){return"Object"}}},4630:(A,e,t)=>{"use strict";var n=t(8844),i=0,r=Math.random(),o=n(1..toString);A.exports=function(A){return"Symbol("+(void 0===A?"":A)+")_"+o(++i+r,36)}},9525:(A,e,t)=>{"use strict";var n=t(146);A.exports=n&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},5648:(A,e,t)=>{"use strict";var n=t(7697),i=t(3689);A.exports=n&&i((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},1500:A=>{"use strict";var e=TypeError;A.exports=function(A,t){if(A<t)throw new e("Not enough arguments");return A}},9834:(A,e,t)=>{"use strict";var n=t(9037),i=t(9985),r=n.WeakMap;A.exports=i(r)&&/native code/.test(String(r))},5405:(A,e,t)=>{"use strict";var n=t(496),i=t(6812),r=t(6145),o=t(2560).f;A.exports=function(A){var e=n.Symbol||(n.Symbol={});i(e,A)||o(e,A,{value:r.f(A)})}},6145:(A,e,t)=>{"use strict";var n=t(4201);e.f=n},4201:(A,e,t)=>{"use strict";var n=t(9037),i=t(3430),r=t(6812),o=t(4630),s=t(146),a=t(9525),B=n.Symbol,c=i("wks"),g=a?B.for||B:B&&B.withoutSetter||o;A.exports=function(A){return r(c,A)||(c[A]=s&&r(B,A)?B[A]:g("Symbol."+A)),c[A]}},6350:A=>{"use strict";A.exports="\t\n\v\f\r \u2028\u2029\ufeff"},4338:(A,e,t)=>{"use strict";var n=t(9989),i=t(3689),r=t(2297),o=t(8999),s=t(690),a=t(6310),B=t(5565),c=t(6522),g=t(7120),E=t(9042),Q=t(4201),u=t(3615),l=Q("isConcatSpreadable"),w=u>=51||!i((function(){var A=[];return A[l]=!1,A.concat()[0]!==A})),h=function(A){if(!o(A))return!1;var e=A[l];return void 0!==e?!!e:r(A)};n({target:"Array",proto:!0,arity:1,forced:!w||!E("concat")},{concat:function(A){var e,t,n,i,r,o=s(this),E=g(o,0),Q=0;for(e=-1,n=arguments.length;e<n;e++)if(h(r=-1===e?o:arguments[e]))for(i=a(r),B(Q+i),t=0;t<i;t++,Q++)t in r&&c(E,Q,r[t]);else B(Q+1),c(E,Q++,r);return E.length=Q,E}})},5791:(A,e,t)=>{"use strict";var n=t(9989),i=t(2960).every;n({target:"Array",proto:!0,forced:!t(6834)("every")},{every:function(A){return i(this,A,arguments.length>1?arguments[1]:void 0)}})},7895:(A,e,t)=>{"use strict";var n=t(9989),i=t(2872),r=t(7370);n({target:"Array",proto:!0},{fill:i}),r("fill")},8077:(A,e,t)=>{"use strict";var n=t(9989),i=t(2960).filter;n({target:"Array",proto:!0,forced:!t(9042)("filter")},{filter:function(A){return i(this,A,arguments.length>1?arguments[1]:void 0)}})},5728:(A,e,t)=>{"use strict";var n=t(9989),i=t(2960).find,r=t(7370),o="find",s=!0;o in[]&&Array(1)[o]((function(){s=!1})),n({target:"Array",proto:!0,forced:s},{find:function(A){return i(this,A,arguments.length>1?arguments[1]:void 0)}}),r(o)},9693:(A,e,t)=>{"use strict";var n=t(9989),i=t(7612);n({target:"Array",proto:!0,forced:[].forEach!==i},{forEach:i})},7722:(A,e,t)=>{"use strict";var n=t(9989),i=t(1055);n({target:"Array",stat:!0,forced:!t(6431)((function(A){Array.from(A)}))},{from:i})},6801:(A,e,t)=>{"use strict";var n=t(9989),i=t(4328).includes,r=t(3689),o=t(7370);n({target:"Array",proto:!0,forced:r((function(){return!Array(1).includes()}))},{includes:function(A){return i(this,A,arguments.length>1?arguments[1]:void 0)}}),o("includes")},7195:(A,e,t)=>{"use strict";var n=t(9989),i=t(6576),r=t(4328).indexOf,o=t(6834),s=i([].indexOf),a=!!s&&1/s([1],1,-0)<0;n({target:"Array",proto:!0,forced:a||!o("indexOf")},{indexOf:function(A){var e=arguments.length>1?arguments[1]:void 0;return a?s(this,A,e)||0:r(this,A,e)}})},3975:(A,e,t)=>{"use strict";t(9989)({target:"Array",stat:!0},{isArray:t(2297)})},752:(A,e,t)=>{"use strict";var n=t(5290),i=t(7370),r=t(9478),o=t(618),s=t(2560).f,a=t(1934),B=t(7807),c=t(3931),g=t(7697),E="Array Iterator",Q=o.set,u=o.getterFor(E);A.exports=a(Array,"Array",(function(A,e){Q(this,{type:E,target:n(A),index:0,kind:e})}),(function(){var A=u(this),e=A.target,t=A.index++;if(!e||t>=e.length)return A.target=void 0,B(void 0,!0);switch(A.kind){case"keys":return B(t,!1);case"values":return B(e[t],!1)}return B([t,e[t]],!1)}),"values");var l=r.Arguments=r.Array;if(i("keys"),i("values"),i("entries"),!c&&g&&"values"!==l.name)try{s(l,"name",{value:"values"})}catch(A){}},6203:(A,e,t)=>{"use strict";var n=t(9989),i=t(8844),r=t(4413),o=t(5290),s=t(6834),a=i([].join);n({target:"Array",proto:!0,forced:r!==Object||!s("join",",")},{join:function(A){return a(o(this),void 0===A?",":A)}})},886:(A,e,t)=>{"use strict";var n=t(9989),i=t(2960).map;n({target:"Array",proto:!0,forced:!t(9042)("map")},{map:function(A){return i(this,A,arguments.length>1?arguments[1]:void 0)}})},278:(A,e,t)=>{"use strict";var n=t(9989),i=t(8820).left,r=t(6834),o=t(3615);n({target:"Array",proto:!0,forced:!t(806)&&o>79&&o<83||!r("reduce")},{reduce:function(A){var e=arguments.length;return i(this,A,e,e>1?arguments[1]:void 0)}})},3374:(A,e,t)=>{"use strict";var n=t(9989),i=t(8844),r=t(2297),o=i([].reverse),s=[1,2];n({target:"Array",proto:!0,forced:String(s)===String(s.reverse())},{reverse:function(){return r(this)&&(this.length=this.length),o(this)}})},9730:(A,e,t)=>{"use strict";var n=t(9989),i=t(2297),r=t(9429),o=t(8999),s=t(7578),a=t(6310),B=t(5290),c=t(6522),g=t(4201),E=t(9042),Q=t(6004),u=E("slice"),l=g("species"),w=Array,h=Math.max;n({target:"Array",proto:!0,forced:!u},{slice:function(A,e){var t,n,g,E=B(this),u=a(E),C=s(A,u),I=s(void 0===e?u:e,u);if(i(E)&&(t=E.constructor,(r(t)&&(t===w||i(t.prototype))||o(t)&&null===(t=t[l]))&&(t=void 0),t===w||void 0===t))return Q(E,C,I);for(n=new(void 0===t?w:t)(h(I-C,0)),g=0;C<I;C++,g++)C in E&&c(n,g,E[C]);return n.length=g,n}})},8742:(A,e,t)=>{"use strict";var n=t(9989),i=t(2960).some;n({target:"Array",proto:!0,forced:!t(6834)("some")},{some:function(A){return i(this,A,arguments.length>1?arguments[1]:void 0)}})},5137:(A,e,t)=>{"use strict";var n=t(9989),i=t(8844),r=t(509),o=t(690),s=t(6310),a=t(8494),B=t(4327),c=t(3689),g=t(382),E=t(6834),Q=t(7365),u=t(7298),l=t(3615),w=t(7922),h=[],C=i(h.sort),I=i(h.push),M=c((function(){h.sort(void 0)})),d=c((function(){h.sort(null)})),m=E("sort"),p=!c((function(){if(l)return l<70;if(!(Q&&Q>3)){if(u)return!0;if(w)return w<603;var A,e,t,n,i="";for(A=65;A<76;A++){switch(e=String.fromCharCode(A),A){case 66:case 69:case 70:case 72:t=3;break;case 68:case 71:t=4;break;default:t=2}for(n=0;n<47;n++)h.push({k:e+n,v:t})}for(h.sort((function(A,e){return e.v-A.v})),n=0;n<h.length;n++)e=h[n].k.charAt(0),i.charAt(i.length-1)!==e&&(i+=e);return"DGBEFHACIJK"!==i}}));n({target:"Array",proto:!0,forced:M||!d||!m||!p},{sort:function(A){void 0!==A&&r(A);var e=o(this);if(p)return void 0===A?C(e):C(e,A);var t,n,i=[],c=s(e);for(n=0;n<c;n++)n in e&&I(i,e[n]);for(g(i,function(A){return function(e,t){return void 0===t?-1:void 0===e?1:void 0!==A?+A(e,t)||0:B(e)>B(t)?1:-1}}(A)),t=s(i),n=0;n<t;)e[n]=i[n++];for(;n<c;)a(e,n++);return e}})},2506:(A,e,t)=>{"use strict";var n=t(9989),i=t(690),r=t(7578),o=t(8700),s=t(6310),a=t(5649),B=t(5565),c=t(7120),g=t(6522),E=t(8494),Q=t(9042)("splice"),u=Math.max,l=Math.min;n({target:"Array",proto:!0,forced:!Q},{splice:function(A,e){var t,n,Q,w,h,C,I=i(this),M=s(I),d=r(A,M),m=arguments.length;for(0===m?t=n=0:1===m?(t=0,n=M-d):(t=m-2,n=l(u(o(e),0),M-d)),B(M+t-n),Q=c(I,n),w=0;w<n;w++)(h=d+w)in I&&g(Q,w,I[h]);if(Q.length=n,t<n){for(w=d;w<M-n;w++)C=w+t,(h=w+n)in I?I[C]=I[h]:E(I,C);for(w=M;w>M-n+t;w--)E(I,w-1)}else if(t>n)for(w=M-n;w>d;w--)C=w+t-1,(h=w+n-1)in I?I[C]=I[h]:E(I,C);for(w=0;w<t;w++)I[w+d]=arguments[w+2];return a(I,M-n+t),Q}})},2227:(A,e,t)=>{"use strict";var n=t(9989),i=t(8844),r=Date,o=i(r.prototype.getTime);n({target:"Date",stat:!0},{now:function(){return o(new r)}})},8150:(A,e,t)=>{"use strict";var n=t(9989),i=t(3689),r=t(690),o=t(8732);n({target:"Date",proto:!0,arity:1,forced:i((function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}))},{toJSON:function(A){var e=r(this),t=o(e,"number");return"number"!=typeof t||isFinite(t)?e.toISOString():null}})},24:(A,e,t)=>{"use strict";var n=t(8844),i=t(1880),r=Date.prototype,o="Invalid Date",s="toString",a=n(r[s]),B=n(r.getTime);String(new Date(NaN))!==o&&i(r,s,(function(){var A=B(this);return A==A?a(this):o}))},1517:(A,e,t)=>{"use strict";var n=t(9989),i=t(6761);n({target:"Function",proto:!0,forced:Function.bind!==i},{bind:i})},4284:(A,e,t)=>{"use strict";var n=t(7697),i=t(1236).EXISTS,r=t(8844),o=t(2148),s=Function.prototype,a=r(s.toString),B=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,c=r(B.exec);n&&!i&&o(s,"name",{configurable:!0,get:function(){try{return c(B,a(this))[1]}catch(A){return""}}})},8324:(A,e,t)=>{"use strict";var n=t(9989),i=t(6058),r=t(1735),o=t(2615),s=t(8844),a=t(3689),B=t(9985),c=t(734),g=t(6004),E=t(2643),Q=t(146),u=String,l=i("JSON","stringify"),w=s(/./.exec),h=s("".charAt),C=s("".charCodeAt),I=s("".replace),M=s(1..toString),d=/[\uD800-\uDFFF]/g,m=/^[\uD800-\uDBFF]$/,p=/^[\uDC00-\uDFFF]$/,F=!Q||a((function(){var A=i("Symbol")("stringify detection");return"[null]"!==l([A])||"{}"!==l({a:A})||"{}"!==l(Object(A))})),D=a((function(){return'"\\udf06\\ud834"'!==l("\udf06\ud834")||'"\\udead"'!==l("\udead")})),Y=function(A,e){var t=g(arguments),n=E(e);if(B(n)||void 0!==A&&!c(A))return t[1]=function(A,e){if(B(n)&&(e=o(n,this,u(A),e)),!c(e))return e},r(l,null,t)},f=function(A,e,t){var n=h(t,e-1),i=h(t,e+1);return w(m,A)&&!w(p,i)||w(p,A)&&!w(m,n)?"\\u"+M(C(A,0),16):A};l&&n({target:"JSON",stat:!0,arity:3,forced:F||D},{stringify:function(A,e,t){var n=g(arguments),i=r(F?Y:l,null,n);return D&&"string"==typeof i?I(i,d,f):i}})},9322:(A,e,t)=>{"use strict";t(319)("Map",(function(A){return function(){return A(this,arguments.length?arguments[0]:void 0)}}),t(800))},6646:(A,e,t)=>{"use strict";t(9322)},6557:(A,e,t)=>{"use strict";var n=t(9989),i=t(3956),r=Math.acosh,o=Math.log,s=Math.sqrt,a=Math.LN2;n({target:"Math",stat:!0,forced:!r||710!==Math.floor(r(Number.MAX_VALUE))||r(1/0)!==1/0},{acosh:function(A){var e=+A;return e<1?NaN:e>94906265.62425156?o(e)+a:i(e-1+s(e-1)*s(e+1))}})},2428:(A,e,t)=>{"use strict";var n=t(9989),i=Math.asinh,r=Math.log,o=Math.sqrt;n({target:"Math",stat:!0,forced:!(i&&1/i(0)>0)},{asinh:function A(e){var t=+e;return isFinite(t)&&0!==t?t<0?-A(-t):r(t+o(t*t+1)):t}})},5263:(A,e,t)=>{"use strict";var n=t(9989),i=Math.atanh,r=Math.log;n({target:"Math",stat:!0,forced:!(i&&1/i(-0)<0)},{atanh:function(A){var e=+A;return 0===e?e:r((1+e)/(1-e))/2}})},4712:(A,e,t)=>{"use strict";var n=t(9989),i=t(5680),r=Math.abs,o=Math.pow;n({target:"Math",stat:!0},{cbrt:function(A){var e=+A;return i(e)*o(r(e),1/3)}})},7221:(A,e,t)=>{"use strict";var n=t(9989),i=t(1745),r=Math.cosh,o=Math.abs,s=Math.E;n({target:"Math",stat:!0,forced:!r||r(710)===1/0},{cosh:function(A){var e=i(o(A)-1)+1;return(e+1/(e*s*s))*(s/2)}})},4992:(A,e,t)=>{"use strict";var n=t(9989),i=t(1745);n({target:"Math",stat:!0,forced:i!==Math.expm1},{expm1:i})},5239:(A,e,t)=>{"use strict";t(9989)({target:"Math",stat:!0},{log10:t(4736)})},2076:(A,e,t)=>{"use strict";t(9989)({target:"Math",stat:!0},{log1p:t(3956)})},8813:(A,e,t)=>{"use strict";var n=t(9989),i=Math.log,r=Math.LN2;n({target:"Math",stat:!0},{log2:function(A){return i(A)/r}})},6976:(A,e,t)=>{"use strict";t(9989)({target:"Math",stat:!0},{sign:t(5680)})},2700:(A,e,t)=>{"use strict";var n=t(9989),i=t(3689),r=t(1745),o=Math.abs,s=Math.exp,a=Math.E;n({target:"Math",stat:!0,forced:i((function(){return-2e-17!==Math.sinh(-2e-17)}))},{sinh:function(A){var e=+A;return o(e)<1?(r(e)-r(-e))/2:(s(e-1)-s(-e-1))*(a/2)}})},1554:(A,e,t)=>{"use strict";var n=t(9989),i=t(1745),r=Math.exp;n({target:"Math",stat:!0},{tanh:function(A){var e=+A,t=i(e),n=i(-e);return t===1/0?1:n===1/0?-1:(t-n)/(r(e)+r(-e))}})},9288:(A,e,t)=>{"use strict";var n=t(9989),i=t(3931),r=t(7697),o=t(9037),s=t(496),a=t(8844),B=t(5266),c=t(6812),g=t(3457),E=t(3622),Q=t(734),u=t(8732),l=t(3689),w=t(2741).f,h=t(2474).f,C=t(2560).f,I=t(3648),M=t(1435).trim,d="Number",m=o[d],p=s[d],F=m.prototype,D=o.TypeError,Y=a("".slice),f=a("".charCodeAt),N=B(d,!m(" 0o1")||!m("0b1")||m("+0x1")),U=function(A){var e,t=arguments.length<1?0:m(function(A){var e=u(A,"number");return"bigint"==typeof e?e:function(A){var e,t,n,i,r,o,s,a,B=u(A,"number");if(Q(B))throw new D("Cannot convert a Symbol value to a number");if("string"==typeof B&&B.length>2)if(B=M(B),43===(e=f(B,0))||45===e){if(88===(t=f(B,2))||120===t)return NaN}else if(48===e){switch(f(B,1)){case 66:case 98:n=2,i=49;break;case 79:case 111:n=8,i=55;break;default:return+B}for(o=(r=Y(B,2)).length,s=0;s<o;s++)if((a=f(r,s))<48||a>i)return NaN;return parseInt(r,n)}return+B}(e)}(A));return E(F,e=this)&&l((function(){I(e)}))?g(Object(t),this,U):t};U.prototype=F,N&&!i&&(F.constructor=U),n({global:!0,constructor:!0,wrap:!0,forced:N},{Number:U});var y=function(A,e){for(var t,n=r?w(e):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),i=0;n.length>i;i++)c(e,t=n[i])&&!c(A,t)&&C(A,t,h(e,t))};i&&p&&y(s[d],p),(N||i)&&y(s[d],m)},3584:(A,e,t)=>{"use strict";t(9989)({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{EPSILON:Math.pow(2,-52)})},5993:(A,e,t)=>{"use strict";t(9989)({target:"Number",stat:!0},{isNaN:function(A){return A!=A}})},7389:(A,e,t)=>{"use strict";var n=t(9989),i=t(8844),r=t(8700),o=t(3648),s=t(534),a=t(3689),B=RangeError,c=String,g=Math.floor,E=i(s),Q=i("".slice),u=i(1..toFixed),l=function(A,e,t){return 0===e?t:e%2==1?l(A,e-1,t*A):l(A*A,e/2,t)},w=function(A,e,t){for(var n=-1,i=t;++n<6;)i+=e*A[n],A[n]=i%1e7,i=g(i/1e7)},h=function(A,e){for(var t=6,n=0;--t>=0;)n+=A[t],A[t]=g(n/e),n=n%e*1e7},C=function(A){for(var e=6,t="";--e>=0;)if(""!==t||0===e||0!==A[e]){var n=c(A[e]);t=""===t?n:t+E("0",7-n.length)+n}return t};n({target:"Number",proto:!0,forced:a((function(){return"0.000"!==u(8e-5,3)||"1"!==u(.9,0)||"1.25"!==u(1.255,2)||"1000000000000000128"!==u(0xde0b6b3a7640080,0)}))||!a((function(){u({})}))},{toFixed:function(A){var e,t,n,i,s=o(this),a=r(A),g=[0,0,0,0,0,0],u="",I="0";if(a<0||a>20)throw new B("Incorrect fraction digits");if(s!=s)return"NaN";if(s<=-1e21||s>=1e21)return c(s);if(s<0&&(u="-",s=-s),s>1e-21)if(t=(e=function(A){for(var e=0,t=A;t>=4096;)e+=12,t/=4096;for(;t>=2;)e+=1,t/=2;return e}(s*l(2,69,1))-69)<0?s*l(2,-e,1):s/l(2,e,1),t*=4503599627370496,(e=52-e)>0){for(w(g,0,t),n=a;n>=7;)w(g,1e7,0),n-=7;for(w(g,l(10,n,1),0),n=e-1;n>=23;)h(g,1<<23),n-=23;h(g,1<<n),w(g,1,1),h(g,2),I=C(g)}else w(g,0,t),w(g,1<<-e,0),I=C(g)+E("0",a);return a>0?u+((i=I.length)<=a?"0."+E("0",a-i)+I:Q(I,0,i-a)+"."+Q(I,i-a)):u+I}})},5284:(A,e,t)=>{"use strict";var n=t(9989),i=t(8844),r=t(3689),o=t(3648),s=i(1..toPrecision);n({target:"Number",proto:!0,forced:r((function(){return"1"!==s(1,void 0)}))||!r((function(){s({})}))},{toPrecision:function(A){return void 0===A?s(o(this)):s(o(this),A)}})},1013:(A,e,t)=>{"use strict";t(9989)({target:"Object",stat:!0,sham:!t(7697)},{create:t(5391)})},5082:(A,e,t)=>{"use strict";var n=t(9989),i=t(7697),r=t(8920).f;n({target:"Object",stat:!0,forced:Object.defineProperties!==r,sham:!i},{defineProperties:r})},739:(A,e,t)=>{"use strict";var n=t(9989),i=t(7697),r=t(2560).f;n({target:"Object",stat:!0,forced:Object.defineProperty!==r,sham:!i},{defineProperty:r})},1919:(A,e,t)=>{"use strict";var n=t(9989),i=t(3689),r=t(5290),o=t(2474).f,s=t(7697);n({target:"Object",stat:!0,forced:!s||i((function(){o(1)})),sham:!s},{getOwnPropertyDescriptor:function(A,e){return o(r(A),e)}})},9474:(A,e,t)=>{"use strict";var n=t(9989),i=t(7697),r=t(9152),o=t(5290),s=t(2474),a=t(6522);n({target:"Object",stat:!0,sham:!i},{getOwnPropertyDescriptors:function(A){for(var e,t,n=o(A),i=s.f,B=r(n),c={},g=0;B.length>g;)void 0!==(t=i(n,e=B[g++]))&&a(c,e,t);return c}})},9434:(A,e,t)=>{"use strict";var n=t(9989),i=t(146),r=t(3689),o=t(7518),s=t(690);n({target:"Object",stat:!0,forced:!i||r((function(){o.f(1)}))},{getOwnPropertySymbols:function(A){var e=o.f;return e?e(s(A)):[]}})},8052:(A,e,t)=>{"use strict";var n=t(9989),i=t(3689),r=t(690),o=t(1868),s=t(1748);n({target:"Object",stat:!0,forced:i((function(){o(1)})),sham:!s},{getPrototypeOf:function(A){return o(r(A))}})},9358:(A,e,t)=>{"use strict";var n=t(9989),i=t(690),r=t(300);n({target:"Object",stat:!0,forced:t(3689)((function(){r(1)}))},{keys:function(A){return r(i(A))}})},228:(A,e,t)=>{"use strict";var n=t(3043),i=t(1880),r=t(5073);n||i(Object.prototype,"toString",r,{unsafe:!0})},939:(A,e,t)=>{"use strict";var n=t(9989),i=t(4818);n({global:!0,forced:parseFloat!==i},{parseFloat:i})},2320:(A,e,t)=>{"use strict";var n=t(9989),i=t(7897);n({global:!0,forced:parseInt!==i},{parseInt:i})},1692:(A,e,t)=>{"use strict";var n=t(9989),i=t(2615),r=t(509),o=t(2582),s=t(9302),a=t(8734);n({target:"Promise",stat:!0,forced:t(562)},{all:function(A){var e=this,t=o.f(e),n=t.resolve,B=t.reject,c=s((function(){var t=r(e.resolve),o=[],s=0,c=1;a(A,(function(A){var r=s++,a=!1;c++,i(t,e,A).then((function(A){a||(a=!0,o[r]=A,--c||n(o))}),B)})),--c||n(o)}));return c.error&&B(c.value),t.promise}})},5089:(A,e,t)=>{"use strict";var n=t(9989),i=t(3931),r=t(7073).CONSTRUCTOR,o=t(7919),s=t(6058),a=t(9985),B=t(1880),c=o&&o.prototype;if(n({target:"Promise",proto:!0,forced:r,real:!0},{catch:function(A){return this.then(void 0,A)}}),!i&&a(o)){var g=s("Promise").prototype.catch;c.catch!==g&&B(c,"catch",g,{unsafe:!0})}},6697:(A,e,t)=>{"use strict";var n,i,r,o=t(9989),s=t(3931),a=t(806),B=t(9037),c=t(2615),g=t(1880),E=t(9385),Q=t(5997),u=t(4241),l=t(509),w=t(9985),h=t(8999),C=t(767),I=t(6373),M=t(9886).set,d=t(231),m=t(920),p=t(9302),F=t(4410),D=t(618),Y=t(7919),f=t(7073),N=t(2582),U="Promise",y=f.CONSTRUCTOR,T=f.REJECTION_EVENT,x=f.SUBCLASSING,R=D.getterFor(U),G=D.set,S=Y&&Y.prototype,H=Y,b=S,v=B.TypeError,k=B.document,j=B.process,J=N.f,z=J,L=!!(k&&k.createEvent&&B.dispatchEvent),P="unhandledrejection",O=function(A){var e;return!(!h(A)||!w(e=A.then))&&e},V=function(A,e){var t,n,i,r=e.value,o=1===e.state,s=o?A.ok:A.fail,a=A.resolve,B=A.reject,g=A.domain;try{s?(o||(2===e.rejection&&_(e),e.rejection=1),!0===s?t=r:(g&&g.enter(),t=s(r),g&&(g.exit(),i=!0)),t===A.promise?B(new v("Promise-chain cycle")):(n=O(t))?c(n,t,a,B):a(t)):B(r)}catch(A){g&&!i&&g.exit(),B(A)}},W=function(A,e){A.notified||(A.notified=!0,d((function(){for(var t,n=A.reactions;t=n.get();)V(t,A);A.notified=!1,e&&!A.rejection&&X(A)})))},K=function(A,e,t){var n,i;L?((n=k.createEvent("Event")).promise=e,n.reason=t,n.initEvent(A,!1,!0),B.dispatchEvent(n)):n={promise:e,reason:t},!T&&(i=B["on"+A])?i(n):A===P&&m("Unhandled promise rejection",t)},X=function(A){c(M,B,(function(){var e,t=A.facade,n=A.value;if(Z(A)&&(e=p((function(){a?j.emit("unhandledRejection",n,t):K(P,t,n)})),A.rejection=a||Z(A)?2:1,e.error))throw e.value}))},Z=function(A){return 1!==A.rejection&&!A.parent},_=function(A){c(M,B,(function(){var e=A.facade;a?j.emit("rejectionHandled",e):K("rejectionhandled",e,A.value)}))},q=function(A,e,t){return function(n){A(e,n,t)}},$=function(A,e,t){A.done||(A.done=!0,t&&(A=t),A.value=e,A.state=2,W(A,!0))},AA=function(A,e,t){if(!A.done){A.done=!0,t&&(A=t);try{if(A.facade===e)throw new v("Promise can't be resolved itself");var n=O(e);n?d((function(){var t={done:!1};try{c(n,e,q(AA,t,A),q($,t,A))}catch(e){$(t,e,A)}})):(A.value=e,A.state=1,W(A,!1))}catch(e){$({done:!1},e,A)}}};if(y&&(b=(H=function(A){C(this,b),l(A),c(n,this);var e=R(this);try{A(q(AA,e),q($,e))}catch(A){$(e,A)}}).prototype,(n=function(A){G(this,{type:U,done:!1,notified:!1,parent:!1,reactions:new F,rejection:!1,state:0,value:void 0})}).prototype=g(b,"then",(function(A,e){var t=R(this),n=J(I(this,H));return t.parent=!0,n.ok=!w(A)||A,n.fail=w(e)&&e,n.domain=a?j.domain:void 0,0===t.state?t.reactions.add(n):d((function(){V(n,t)})),n.promise})),i=function(){var A=new n,e=R(A);this.promise=A,this.resolve=q(AA,e),this.reject=q($,e)},N.f=J=function(A){return A===H||void 0===A?new i(A):z(A)},!s&&w(Y)&&S!==Object.prototype)){r=S.then,x||g(S,"then",(function(A,e){var t=this;return new H((function(A,e){c(r,t,A,e)})).then(A,e)}),{unsafe:!0});try{delete S.constructor}catch(A){}E&&E(S,b)}o({global:!0,constructor:!0,wrap:!0,forced:y},{Promise:H}),Q(H,U,!1,!0),u(U)},3964:(A,e,t)=>{"use strict";t(6697),t(1692),t(5089),t(8829),t(2092),t(7905)},8829:(A,e,t)=>{"use strict";var n=t(9989),i=t(2615),r=t(509),o=t(2582),s=t(9302),a=t(8734);n({target:"Promise",stat:!0,forced:t(562)},{race:function(A){var e=this,t=o.f(e),n=t.reject,B=s((function(){var o=r(e.resolve);a(A,(function(A){i(o,e,A).then(t.resolve,n)}))}));return B.error&&n(B.value),t.promise}})},2092:(A,e,t)=>{"use strict";var n=t(9989),i=t(2615),r=t(2582);n({target:"Promise",stat:!0,forced:t(7073).CONSTRUCTOR},{reject:function(A){var e=r.f(this);return i(e.reject,void 0,A),e.promise}})},7905:(A,e,t)=>{"use strict";var n=t(9989),i=t(6058),r=t(3931),o=t(7919),s=t(7073).CONSTRUCTOR,a=t(2945),B=i("Promise"),c=r&&!s;n({target:"Promise",stat:!0,forced:r||s},{resolve:function(A){return a(c&&this===B?o:this,A)}})},50:(A,e,t)=>{"use strict";var n=t(9989),i=t(6058),r=t(1735),o=t(6761),s=t(2655),a=t(5027),B=t(8999),c=t(5391),g=t(3689),E=i("Reflect","construct"),Q=Object.prototype,u=[].push,l=g((function(){function A(){}return!(E((function(){}),[],A)instanceof A)})),w=!g((function(){E((function(){}))})),h=l||w;n({target:"Reflect",stat:!0,forced:h,sham:h},{construct:function(A,e){s(A),a(e);var t=arguments.length<3?A:s(arguments[2]);if(w&&!l)return E(A,e,t);if(A===t){switch(e.length){case 0:return new A;case 1:return new A(e[0]);case 2:return new A(e[0],e[1]);case 3:return new A(e[0],e[1],e[2]);case 4:return new A(e[0],e[1],e[2],e[3])}var n=[null];return r(u,n,e),new(r(o,A,n))}var i=t.prototype,g=c(B(i)?i:Q),h=r(A,g,e);return B(h)?h:g}})},6034:(A,e,t)=>{"use strict";var n=t(9989),i=t(9037),r=t(5997);n({global:!0},{Reflect:{}}),r(i.Reflect,"Reflect",!0)},2003:(A,e,t)=>{"use strict";var n=t(7697),i=t(9037),r=t(8844),o=t(5266),s=t(3457),a=t(5773),B=t(2741).f,c=t(3622),g=t(1245),E=t(4327),Q=t(3477),u=t(7901),l=t(8055),w=t(1880),h=t(3689),C=t(6812),I=t(618).enforce,M=t(4241),d=t(4201),m=t(2100),p=t(6422),F=d("match"),D=i.RegExp,Y=D.prototype,f=i.SyntaxError,N=r(Y.exec),U=r("".charAt),y=r("".replace),T=r("".indexOf),x=r("".slice),R=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,G=/a/g,S=/a/g,H=new D(G)!==G,b=u.MISSED_STICKY,v=u.UNSUPPORTED_Y;if(o("RegExp",n&&(!H||b||m||p||h((function(){return S[F]=!1,D(G)!==G||D(S)===S||"/a/i"!==String(D(G,"i"))}))))){for(var k=function(A,e){var t,n,i,r,o,B,u=c(Y,this),l=g(A),w=void 0===e,h=[],M=A;if(!u&&l&&w&&A.constructor===k)return A;if((l||c(Y,A))&&(A=A.source,w&&(e=Q(M))),A=void 0===A?"":E(A),e=void 0===e?"":E(e),M=A,m&&"dotAll"in G&&(n=!!e&&T(e,"s")>-1)&&(e=y(e,/s/g,"")),t=e,b&&"sticky"in G&&(i=!!e&&T(e,"y")>-1)&&v&&(e=y(e,/y/g,"")),p&&(A=(r=function(A){for(var e,t=A.length,n=0,i="",r=[],o={},s=!1,a=!1,B=0,c="";n<=t;n++){if("\\"===(e=U(A,n)))e+=U(A,++n);else if("]"===e)s=!1;else if(!s)switch(!0){case"["===e:s=!0;break;case"("===e:N(R,x(A,n+1))&&(n+=2,a=!0),i+=e,B++;continue;case">"===e&&a:if(""===c||C(o,c))throw new f("Invalid capture group name");o[c]=!0,r[r.length]=[c,B],a=!1,c="";continue}a?c+=e:i+=e}return[i,r]}(A))[0],h=r[1]),o=s(D(A,e),u?this:Y,k),(n||i||h.length)&&(B=I(o),n&&(B.dotAll=!0,B.raw=k(function(A){for(var e,t=A.length,n=0,i="",r=!1;n<=t;n++)"\\"!==(e=U(A,n))?r||"."!==e?("["===e?r=!0:"]"===e&&(r=!1),i+=e):i+="[\\s\\S]":i+=e+U(A,++n);return i}(A),t)),i&&(B.sticky=!0),h.length&&(B.groups=h)),A!==M)try{a(o,"source",""===M?"(?:)":M)}catch(A){}return o},j=B(D),J=0;j.length>J;)l(k,D,j[J++]);Y.constructor=k,k.prototype=Y,w(i,"RegExp",k,{constructor:!0})}M("RegExp")},8518:(A,e,t)=>{"use strict";var n=t(7697),i=t(2100),r=t(6648),o=t(2148),s=t(618).get,a=RegExp.prototype,B=TypeError;n&&i&&o(a,"dotAll",{configurable:!0,get:function(){if(this!==a){if("RegExp"===r(this))return!!s(this).dotAll;throw new B("Incompatible receiver, RegExp required")}}})},4043:(A,e,t)=>{"use strict";var n=t(9989),i=t(6308);n({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},3440:(A,e,t)=>{"use strict";var n=t(7697),i=t(7901).MISSED_STICKY,r=t(6648),o=t(2148),s=t(618).get,a=RegExp.prototype,B=TypeError;n&&i&&o(a,"sticky",{configurable:!0,get:function(){if(this!==a){if("RegExp"===r(this))return!!s(this).sticky;throw new B("Incompatible receiver, RegExp required")}}})},7409:(A,e,t)=>{"use strict";t(4043);var n,i,r=t(9989),o=t(2615),s=t(9985),a=t(5027),B=t(4327),c=(n=!1,(i=/[ac]/).exec=function(){return n=!0,/./.exec.apply(this,arguments)},!0===i.test("abc")&&n),g=/./.test;r({target:"RegExp",proto:!0,forced:!c},{test:function(A){var e=a(this),t=B(A),n=e.exec;if(!s(n))return o(g,e,t);var i=o(n,e,t);return null!==i&&(a(i),!0)}})},2826:(A,e,t)=>{"use strict";var n=t(1236).PROPER,i=t(1880),r=t(5027),o=t(4327),s=t(3689),a=t(3477),B="toString",c=RegExp.prototype[B],g=s((function(){return"/a/b"!==c.call({source:"a",flags:"b"})})),E=n&&c.name!==B;(g||E)&&i(RegExp.prototype,B,(function(){var A=r(this);return"/"+o(A.source)+"/"+o(a(A))}),{unsafe:!0})},7985:(A,e,t)=>{"use strict";t(319)("Set",(function(A){return function(){return A(this,arguments.length?arguments[0]:void 0)}}),t(800))},9649:(A,e,t)=>{"use strict";t(7985)},3843:(A,e,t)=>{"use strict";var n=t(9989),i=t(8844),r=t(2124),o=t(4684),s=t(4327),a=t(7413),B=i("".indexOf);n({target:"String",proto:!0,forced:!a("includes")},{includes:function(A){return!!~B(s(o(this)),s(r(A)),arguments.length>1?arguments[1]:void 0)}})},1694:(A,e,t)=>{"use strict";var n=t(730).charAt,i=t(4327),r=t(618),o=t(1934),s=t(7807),a="String Iterator",B=r.set,c=r.getterFor(a);o(String,"String",(function(A){B(this,{type:a,string:i(A),index:0})}),(function(){var A,e=c(this),t=e.string,i=e.index;return i>=t.length?s(void 0,!0):(A=n(t,i),e.index+=A.length,s(A,!1))}))},2462:(A,e,t)=>{"use strict";var n=t(2615),i=t(8678),r=t(5027),o=t(981),s=t(3126),a=t(4327),B=t(4684),c=t(4849),g=t(1514),E=t(6100);i("match",(function(A,e,t){return[function(e){var t=B(this),i=o(e)?void 0:c(e,A);return i?n(i,e,t):new RegExp(e)[A](a(t))},function(A){var n=r(this),i=a(A),o=t(e,n,i);if(o.done)return o.value;if(!n.global)return E(n,i);var B=n.unicode;n.lastIndex=0;for(var c,Q=[],u=0;null!==(c=E(n,i));){var l=a(c[0]);Q[u]=l,""===l&&(n.lastIndex=g(i,s(n.lastIndex),B)),u++}return 0===u?null:Q}]}))},9588:(A,e,t)=>{"use strict";t(9989)({target:"String",proto:!0},{repeat:t(534)})},7267:(A,e,t)=>{"use strict";var n=t(1735),i=t(2615),r=t(8844),o=t(8678),s=t(3689),a=t(5027),B=t(9985),c=t(981),g=t(8700),E=t(3126),Q=t(4327),u=t(4684),l=t(1514),w=t(4849),h=t(7017),C=t(6100),I=t(4201)("replace"),M=Math.max,d=Math.min,m=r([].concat),p=r([].push),F=r("".indexOf),D=r("".slice),Y="$0"==="a".replace(/./,"$0"),f=!!/./[I]&&""===/./[I]("a","$0");o("replace",(function(A,e,t){var r=f?"$":"$0";return[function(A,t){var n=u(this),r=c(A)?void 0:w(A,I);return r?i(r,A,n,t):i(e,Q(n),A,t)},function(A,i){var o=a(this),s=Q(A);if("string"==typeof i&&-1===F(i,r)&&-1===F(i,"$<")){var c=t(e,o,s,i);if(c.done)return c.value}var u=B(i);u||(i=Q(i));var w,I=o.global;I&&(w=o.unicode,o.lastIndex=0);for(var Y,f=[];null!==(Y=C(o,s))&&(p(f,Y),I);)""===Q(Y[0])&&(o.lastIndex=l(s,E(o.lastIndex),w));for(var N,U="",y=0,T=0;T<f.length;T++){for(var x,R=Q((Y=f[T])[0]),G=M(d(g(Y.index),s.length),0),S=[],H=1;H<Y.length;H++)p(S,void 0===(N=Y[H])?N:String(N));var b=Y.groups;if(u){var v=m([R],S,G,s);void 0!==b&&p(v,b),x=Q(n(i,void 0,v))}else x=h(R,s,G,S,b,i);G>=y&&(U+=D(s,y,G)+x,y=G+R.length)}return U+D(s,y)}]}),!!s((function(){var A=/./;return A.exec=function(){var A=[];return A.groups={a:"7"},A},"7"!=="".replace(A,"$<a>")}))||!Y||f)},7729:(A,e,t)=>{"use strict";var n=t(9989),i=t(1568);n({target:"String",proto:!0,forced:t(4580)("sub")},{sub:function(){return i(this,"sub","","")}})},372:(A,e,t)=>{"use strict";var n=t(9989),i=t(8844),r=t(4684),o=t(8700),s=t(4327),a=i("".slice),B=Math.max,c=Math.min;n({target:"String",proto:!0,forced:!"".substr||"b"!=="ab".substr(-1)},{substr:function(A,e){var t,n,i=s(r(this)),g=i.length,E=o(A);return E===1/0&&(E=0),E<0&&(E=B(g+E,0)),(t=void 0===e?g:o(e))<=0||t===1/0||E>=(n=c(E+t,g))?"":a(i,E,n)}})},8436:(A,e,t)=>{"use strict";var n=t(9989),i=t(1435).trim;n({target:"String",proto:!0,forced:t(5984)("trim")},{trim:function(){return i(this)}})},7855:(A,e,t)=>{"use strict";var n=t(9989),i=t(9037),r=t(2615),o=t(8844),s=t(3931),a=t(7697),B=t(146),c=t(3689),g=t(6812),E=t(3622),Q=t(5027),u=t(5290),l=t(8360),w=t(4327),h=t(5684),C=t(5391),I=t(300),M=t(2741),d=t(6062),m=t(7518),p=t(2474),F=t(2560),D=t(8920),Y=t(9556),f=t(1880),N=t(2148),U=t(3430),y=t(2713),T=t(7248),x=t(4630),R=t(4201),G=t(6145),S=t(5405),H=t(3032),b=t(5997),v=t(618),k=t(2960).forEach,j=y("hidden"),J="Symbol",z="prototype",L=v.set,P=v.getterFor(J),O=Object[z],V=i.Symbol,W=V&&V[z],K=i.RangeError,X=i.TypeError,Z=i.QObject,_=p.f,q=F.f,$=d.f,AA=Y.f,eA=o([].push),tA=U("symbols"),nA=U("op-symbols"),iA=U("wks"),rA=!Z||!Z[z]||!Z[z].findChild,oA=function(A,e,t){var n=_(O,e);n&&delete O[e],q(A,e,t),n&&A!==O&&q(O,e,n)},sA=a&&c((function(){return 7!==C(q({},"a",{get:function(){return q(this,"a",{value:7}).a}})).a}))?oA:q,aA=function(A,e){var t=tA[A]=C(W);return L(t,{type:J,tag:A,description:e}),a||(t.description=e),t},BA=function(A,e,t){A===O&&BA(nA,e,t),Q(A);var n=l(e);return Q(t),g(tA,n)?(t.enumerable?(g(A,j)&&A[j][n]&&(A[j][n]=!1),t=C(t,{enumerable:h(0,!1)})):(g(A,j)||q(A,j,h(1,{})),A[j][n]=!0),sA(A,n,t)):q(A,n,t)},cA=function(A,e){Q(A);var t=u(e),n=I(t).concat(uA(t));return k(n,(function(e){a&&!r(gA,t,e)||BA(A,e,t[e])})),A},gA=function(A){var e=l(A),t=r(AA,this,e);return!(this===O&&g(tA,e)&&!g(nA,e))&&(!(t||!g(this,e)||!g(tA,e)||g(this,j)&&this[j][e])||t)},EA=function(A,e){var t=u(A),n=l(e);if(t!==O||!g(tA,n)||g(nA,n)){var i=_(t,n);return!i||!g(tA,n)||g(t,j)&&t[j][n]||(i.enumerable=!0),i}},QA=function(A){var e=$(u(A)),t=[];return k(e,(function(A){g(tA,A)||g(T,A)||eA(t,A)})),t},uA=function(A){var e=A===O,t=$(e?nA:u(A)),n=[];return k(t,(function(A){!g(tA,A)||e&&!g(O,A)||eA(n,tA[A])})),n};B||(f(W=(V=function(){if(E(W,this))throw new X("Symbol is not a constructor");var A=arguments.length&&void 0!==arguments[0]?w(arguments[0]):void 0,e=x(A),t=function(A){var n=void 0===this?i:this;n===O&&r(t,nA,A),g(n,j)&&g(n[j],e)&&(n[j][e]=!1);var o=h(1,A);try{sA(n,e,o)}catch(A){if(!(A instanceof K))throw A;oA(n,e,o)}};return a&&rA&&sA(O,e,{configurable:!0,set:t}),aA(e,A)})[z],"toString",(function(){return P(this).tag})),f(V,"withoutSetter",(function(A){return aA(x(A),A)})),Y.f=gA,F.f=BA,D.f=cA,p.f=EA,M.f=d.f=QA,m.f=uA,G.f=function(A){return aA(R(A),A)},a&&(N(W,"description",{configurable:!0,get:function(){return P(this).description}}),s||f(O,"propertyIsEnumerable",gA,{unsafe:!0}))),n({global:!0,constructor:!0,wrap:!0,forced:!B,sham:!B},{Symbol:V}),k(I(iA),(function(A){S(A)})),n({target:J,stat:!0,forced:!B},{useSetter:function(){rA=!0},useSimple:function(){rA=!1}}),n({target:"Object",stat:!0,forced:!B,sham:!a},{create:function(A,e){return void 0===e?C(A):cA(C(A),e)},defineProperty:BA,defineProperties:cA,getOwnPropertyDescriptor:EA}),n({target:"Object",stat:!0,forced:!B},{getOwnPropertyNames:QA}),H(),b(V,J),T[j]=!0},6544:(A,e,t)=>{"use strict";var n=t(9989),i=t(7697),r=t(9037),o=t(8844),s=t(6812),a=t(9985),B=t(3622),c=t(4327),g=t(2148),E=t(8758),Q=r.Symbol,u=Q&&Q.prototype;if(i&&a(Q)&&(!("description"in u)||void 0!==Q().description)){var l={},w=function(){var A=arguments.length<1||void 0===arguments[0]?void 0:c(arguments[0]),e=B(u,this)?new Q(A):void 0===A?Q():Q(A);return""===A&&(l[e]=!0),e};E(w,Q),w.prototype=u,u.constructor=w;var h="Symbol(description detection)"===String(Q("description detection")),C=o(u.valueOf),I=o(u.toString),M=/^Symbol\((.*)\)[^)]+$/,d=o("".replace),m=o("".slice);g(u,"description",{configurable:!0,get:function(){var A=C(this);if(s(l,A))return"";var e=I(A),t=h?m(e,7,-1):d(e,M,"$1");return""===t?void 0:t}}),n({global:!0,constructor:!0,forced:!0},{Symbol:w})}},8074:(A,e,t)=>{"use strict";var n=t(9989),i=t(6058),r=t(6812),o=t(4327),s=t(3430),a=t(6549),B=s("string-to-symbol-registry"),c=s("symbol-to-string-registry");n({target:"Symbol",stat:!0,forced:!a},{for:function(A){var e=o(A);if(r(B,e))return B[e];var t=i("Symbol")(e);return B[e]=t,c[t]=e,t}})},4254:(A,e,t)=>{"use strict";t(5405)("iterator")},9749:(A,e,t)=>{"use strict";t(7855),t(8074),t(1445),t(8324),t(9434)},1445:(A,e,t)=>{"use strict";var n=t(9989),i=t(6812),r=t(734),o=t(3691),s=t(3430),a=t(6549),B=s("symbol-to-string-registry");n({target:"Symbol",stat:!0,forced:!a},{keyFor:function(A){if(!r(A))throw new TypeError(o(A)+" is not a symbol");if(i(B,A))return B[A]}})},7522:(A,e,t)=>{"use strict";var n=t(9037),i=t(6338),r=t(3265),o=t(7612),s=t(5773),a=function(A){if(A&&A.forEach!==o)try{s(A,"forEach",o)}catch(e){A.forEach=o}};for(var B in i)i[B]&&a(n[B]&&n[B].prototype);a(r)},6265:(A,e,t)=>{"use strict";var n=t(9037),i=t(6338),r=t(3265),o=t(752),s=t(5773),a=t(4201),B=a("iterator"),c=a("toStringTag"),g=o.values,E=function(A,e){if(A){if(A[B]!==g)try{s(A,B,g)}catch(e){A[B]=g}if(A[c]||s(A,c,e),i[e])for(var t in o)if(A[t]!==o[t])try{s(A,t,o[t])}catch(e){A[t]=o[t]}}};for(var Q in i)E(n[Q]&&n[Q].prototype,Q);E(r,"DOMTokenList")},9979:(A,e,t)=>{"use strict";var n=t(9989),i=t(2615);n({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return i(URL.prototype.toString,this)}})},4814:function(A){A.exports=function(){"use strict";function A(){return!0}function e(){return!1}function t(){}const n="Argument is not a typed-function.";return function i(){function r(A){return"object"==typeof A&&null!==A&&A.constructor===Object}const o=[{name:"number",test:function(A){return"number"==typeof A}},{name:"string",test:function(A){return"string"==typeof A}},{name:"boolean",test:function(A){return"boolean"==typeof A}},{name:"Function",test:function(A){return"function"==typeof A}},{name:"Array",test:Array.isArray},{name:"Date",test:function(A){return A instanceof Date}},{name:"RegExp",test:function(A){return A instanceof RegExp}},{name:"Object",test:r},{name:"null",test:function(A){return null===A}},{name:"undefined",test:function(A){return void 0===A}}],s={name:"any",test:A,isAny:!0};let a,B,c=0,g={createCount:0};function E(A){const e=a.get(A);if(e)return e;let t='Unknown type "'+A+'"';const n=A.toLowerCase();let i;for(i of B)if(i.toLowerCase()===n){t+='. Did you mean "'+i+'" ?';break}throw new TypeError(t)}function Q(A){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"any";const t=e?E(e).index:B.length,n=[];for(let e=0;e<A.length;++e){if(!A[e]||"string"!=typeof A[e].name||"function"!=typeof A[e].test)throw new TypeError("Object with properties {name: string, test: function} expected");const i=A[e].name;if(a.has(i))throw new TypeError('Duplicate type name "'+i+'"');n.push(i),a.set(i,{name:i,test:A[e].test,isAny:A[e].isAny,index:t+e,conversionsTo:[]})}const i=B.slice(t);B=B.slice(0,t).concat(n).concat(i);for(let A=t+n.length;A<B.length;++A)a.get(B[A]).index=A}function u(){a=new Map,B=[],c=0,Q([s],!1)}function l(A){const e=B.filter(e=>{const t=a.get(e);return!t.isAny&&t.test(A)});return e.length?e:["any"]}function w(A){return A&&"function"==typeof A&&"_typedFunctionData"in A}function h(A,e,t){if(!w(A))throw new TypeError(n);const i=t&&t.exact,r=m(Array.isArray(e)?e.join(","):e),o=C(r);if(!i||o in A.signatures){const e=A._typedFunctionData.signatureMap.get(o);if(e)return e}const s=r.length;let a,B;if(i){let e;for(e in a=[],A.signatures)a.push(A._typedFunctionData.signatureMap.get(e))}else a=A._typedFunctionData.signatures;for(let A=0;A<s;++A){const e=r[A],t=[];let n;for(n of a){const i=Y(n.params,A);if(i&&(!e.restParam||i.restParam)){if(!i.hasAny){const A=d(i);if(e.types.some(e=>!A.has(e.name)))continue}t.push(n)}}if(a=t,0===a.length)break}for(B of a)if(B.params.length<=s)return B;throw new TypeError("Signature not found (signature: "+(A.name||"unnamed")+"("+C(r,", ")+"))")}function C(A){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",";return A.map(A=>A.name).join(e)}function I(A){const e=0===A.indexOf("..."),t=(e?A.length>3?A.slice(3):"any":A).split("|").map(A=>E(A.trim()));let n=!1,i=e?"...":"";return{types:t.map((function(A){return n=A.isAny||n,i+=A.name+"|",{name:A.name,typeIndex:A.index,test:A.test,isAny:A.isAny,conversion:null,conversionIndex:-1}})),name:i.slice(0,-1),hasAny:n,hasConversion:!1,restParam:e}}function M(A){const e=function(A){if(0===A.length)return[];const e=A.map(E);A.length>1&&e.sort((A,e)=>A.index-e.index);let t=e[0].conversionsTo;if(1===A.length)return t;t=t.concat([]);const n=new Set(A);for(let A=1;A<e.length;++A){let i;for(i of e[A].conversionsTo)n.has(i.from)||(t.push(i),n.add(i.from))}return t}(A.types.map(A=>A.name));let t=A.hasAny,n=A.name;const i=e.map((function(A){const e=E(A.from);return t=e.isAny||t,n+="|"+A.from,{name:A.from,typeIndex:e.index,test:e.test,isAny:e.isAny,conversion:A,conversionIndex:A.index}}));return{types:A.types.concat(i),name:n,hasAny:t,hasConversion:i.length>0,restParam:A.restParam}}function d(A){return A.typeSet||(A.typeSet=new Set,A.types.forEach(e=>A.typeSet.add(e.name))),A.typeSet}function m(A){const e=[];if("string"!=typeof A)throw new TypeError("Signatures must be strings");const t=A.trim();if(""===t)return e;const n=t.split(",");for(let A=0;A<n.length;++A){const t=I(n[A].trim());if(t.restParam&&A!==n.length-1)throw new SyntaxError('Unexpected rest parameter "'+n[A]+'": only allowed for the last parameter');if(0===t.types.length)return null;e.push(t)}return e}function p(A){const e=P(A);return!!e&&e.restParam}function F(e){if(e&&0!==e.types.length){if(1===e.types.length)return E(e.types[0].name).test;if(2===e.types.length){const A=E(e.types[0].name).test,t=E(e.types[1].name).test;return function(e){return A(e)||t(e)}}{const A=e.types.map((function(A){return E(A.name).test}));return function(e){for(let t=0;t<A.length;t++)if(A[t](e))return!0;return!1}}}return A}function D(A){let e,t,n;if(p(A)){e=L(A).map(F);const t=e.length,n=F(P(A)),i=function(A){for(let e=t;e<A.length;e++)if(!n(A[e]))return!1;return!0};return function(A){for(let t=0;t<e.length;t++)if(!e[t](A[t]))return!1;return i(A)&&A.length>=t+1}}return 0===A.length?function(A){return 0===A.length}:1===A.length?(t=F(A[0]),function(A){return t(A[0])&&1===A.length}):2===A.length?(t=F(A[0]),n=F(A[1]),function(A){return t(A[0])&&n(A[1])&&2===A.length}):(e=A.map(F),function(A){for(let t=0;t<e.length;t++)if(!e[t](A[t]))return!1;return A.length===e.length})}function Y(A,e){return e<A.length?A[e]:p(A)?P(A):null}function f(A,e){const t=Y(A,e);return t?d(t):new Set}function N(A){return null===A.conversion||void 0===A.conversion}function U(A,e){const t=new Set;return A.forEach(A=>{const n=f(A.params,e);let i;for(i of n)t.add(i)}),t.has("any")?["any"]:Array.from(t)}function y(A,e,t){let n,i;const r=A||"unnamed";let o,s=t;for(o=0;o<e.length;o++){const A=[];if(s.forEach(t=>{const n=F(Y(t.params,o));(o<t.params.length||p(t.params))&&n(e[o])&&A.push(t)}),0===A.length){if(i=U(s,o),i.length>0){const A=l(e[o]);return n=new TypeError("Unexpected type of argument in function "+r+" (expected: "+i.join(" or ")+", actual: "+A.join(" | ")+", index: "+o+")"),n.data={category:"wrongType",fn:r,index:o,actual:A,expected:i},n}}else s=A}const a=s.map((function(A){return p(A.params)?1/0:A.params.length}));if(e.length<Math.min.apply(null,a))return i=U(s,o),n=new TypeError("Too few arguments in function "+r+" (expected: "+i.join(" or ")+", index: "+e.length+")"),n.data={category:"tooFewArgs",fn:r,index:e.length,expected:i},n;const B=Math.max.apply(null,a);if(e.length>B)return n=new TypeError("Too many arguments in function "+r+" (expected: "+B+", actual: "+e.length+")"),n.data={category:"tooManyArgs",fn:r,index:e.length,expectedLength:B},n;const c=[];for(let A=0;A<e.length;++A)c.push(l(e[A]).join("|"));return n=new TypeError('Arguments of type "'+c.join(", ")+'" do not match any of the defined signatures of function '+r+"."),n.data={category:"mismatch",actual:c},n}function T(A){let e=B.length+1;for(let t=0;t<A.types.length;t++)N(A.types[t])&&(e=Math.min(e,A.types[t].typeIndex));return e}function x(A){let e=c+1;for(let t=0;t<A.types.length;t++)N(A.types[t])||(e=Math.min(e,A.types[t].conversionIndex));return e}function R(A,e){if(A.hasAny){if(!e.hasAny)return 1}else if(e.hasAny)return-1;if(A.restParam){if(!e.restParam)return 1}else if(e.restParam)return-1;if(A.hasConversion){if(!e.hasConversion)return 1}else if(e.hasConversion)return-1;const t=T(A)-T(e);if(t<0)return-1;if(t>0)return 1;const n=x(A)-x(e);return n<0?-1:n>0?1:0}function G(A,e){const t=A.params,n=e.params,i=P(t),r=P(n),o=p(t),s=p(n);if(o&&i.hasAny){if(!s||!r.hasAny)return 1}else if(s&&r.hasAny)return-1;let a,B=0,c=0;for(a of t)a.hasAny&&++B,a.hasConversion&&++c;let g=0,E=0;for(a of n)a.hasAny&&++g,a.hasConversion&&++E;if(B!==g)return B-g;if(o&&i.hasConversion){if(!s||!r.hasConversion)return 1}else if(s&&r.hasConversion)return-1;if(c!==E)return c-E;if(o){if(!s)return 1}else if(s)return-1;const Q=(t.length-n.length)*(o?-1:1);if(0!==Q)return Q;const u=[];let l,w=0;for(let A=0;A<t.length;++A){const e=R(t[A],n[A]);u.push(e),w+=e}if(0!==w)return w;for(l of u)if(0!==l)return l;return 0}function S(A,e){let t=e;if(A.some(A=>A.hasConversion)){const n=p(A),i=A.map(H);t=function(){const A=[],t=n?arguments.length-1:arguments.length;for(let e=0;e<t;e++)A[e]=i[e](arguments[e]);return n&&(A[t]=arguments[t].map(i[t])),e.apply(this,A)}}let n=t;if(p(A)){const e=A.length-1;n=function(){return t.apply(this,O(arguments,0,e).concat([O(arguments,e)]))}}return n}function H(A){let e,t,n,i;const r=[],o=[];switch(A.types.forEach((function(A){A.conversion&&(r.push(E(A.conversion.from).test),o.push(A.conversion.convert))})),o.length){case 0:return function(A){return A};case 1:return e=r[0],n=o[0],function(A){return e(A)?n(A):A};case 2:return e=r[0],t=r[1],n=o[0],i=o[1],function(A){return e(A)?n(A):t(A)?i(A):A};default:return function(A){for(let e=0;e<o.length;e++)if(r[e](A))return o[e](A);return A}}}function b(A){return function A(e,t,n){if(t<e.length){const o=e[t];let s=[];if(o.restParam){const A=o.types.filter(N);A.length<o.types.length&&s.push({types:A,name:"..."+A.map(A=>A.name).join("|"),hasAny:A.some(A=>A.isAny),hasConversion:!1,restParam:!0}),s.push(o)}else s=o.types.map((function(A){return{types:[A],name:A.name,hasAny:A.isAny,hasConversion:A.conversion,restParam:!1}}));return i=s,r=function(i){return A(e,t+1,n.concat([i]))},Array.prototype.concat.apply([],i.map(r))}var i,r;return[n]}(A,0,[])}function v(A,e){const t=Math.max(A.length,e.length);for(let n=0;n<t;n++){const t=f(A,n),i=f(e,n);let r,o=!1;for(r of i)if(t.has(r)){o=!0;break}if(!o)return!1}const n=A.length,i=e.length,r=p(A),o=p(e);return r?o?n===i:i>=n:o?n>=i:n===i}function k(A,e,t){const n=[];let i;for(i of A){let A=t[i];if("number"!=typeof A)throw new TypeError('No definition for referenced signature "'+i+'"');if(A=e[A],"function"!=typeof A)return!1;n.push(A)}return n}function j(A,e,t){const n=function(A){return A.map(A=>X(A)?W(A.referToSelf.callback):K(A)?V(A.referTo.references,A.referTo.callback):A)}(A),i=new Array(n.length).fill(!1);let r=!0;for(;r;){r=!1;let A=!0;for(let o=0;o<n.length;++o){if(i[o])continue;const s=n[o];if(X(s))n[o]=s.referToSelf.callback(t),n[o].referToSelf=s.referToSelf,i[o]=!0,A=!1;else if(K(s)){const t=k(s.referTo.references,n,e);t?(n[o]=s.referTo.callback.apply(this,t),n[o].referTo=s.referTo,i[o]=!0,A=!1):r=!0}}if(A&&r)throw new SyntaxError("Circular reference detected in resolving typed.referTo")}return n}function J(A,n){if(g.createCount++,0===Object.keys(n).length)throw new SyntaxError("No signatures provided");g.warnAgainstDeprecatedThis&&function(A){const e=/\bthis(\(|\.signatures\b)/;Object.keys(A).forEach(t=>{const n=A[t];if(e.test(n.toString()))throw new SyntaxError("Using `this` to self-reference a function is deprecated since typed-function@3. Use typed.referTo and typed.referToSelf instead.")})}(n);const i=[],r=[],o={},s=[];let a;for(a in n){if(!Object.prototype.hasOwnProperty.call(n,a))continue;const A=m(a);if(!A)continue;i.forEach((function(e){if(v(e,A))throw new TypeError('Conflicting signatures "'+C(e)+'" and "'+C(A)+'".')})),i.push(A);const e=r.length;r.push(n[a]);const t=A.map(M);let B;for(B of b(t)){const A=C(B);s.push({params:B,name:A,fn:e}),B.every(A=>!A.hasConversion)&&(o[A]=e)}}s.sort(G);const B=j(r,o,sA);let c;for(c in o)Object.prototype.hasOwnProperty.call(o,c)&&(o[c]=B[o[c]]);const E=[],Q=new Map;for(c of s)Q.has(c.name)||(c.fn=B[c.fn],E.push(c),Q.set(c.name,c));const u=E[0]&&E[0].params.length<=2&&!p(E[0].params),l=E[1]&&E[1].params.length<=2&&!p(E[1].params),w=E[2]&&E[2].params.length<=2&&!p(E[2].params),h=E[3]&&E[3].params.length<=2&&!p(E[3].params),I=E[4]&&E[4].params.length<=2&&!p(E[4].params),d=E[5]&&E[5].params.length<=2&&!p(E[5].params),Y=u&&l&&w&&h&&I&&d;for(let A=0;A<E.length;++A)E[A].test=D(E[A].params);const f=u?F(E[0].params[0]):e,N=l?F(E[1].params[0]):e,U=w?F(E[2].params[0]):e,y=h?F(E[3].params[0]):e,T=I?F(E[4].params[0]):e,x=d?F(E[5].params[0]):e,R=u?F(E[0].params[1]):e,H=l?F(E[1].params[1]):e,k=w?F(E[2].params[1]):e,J=h?F(E[3].params[1]):e,z=I?F(E[4].params[1]):e,L=d?F(E[5].params[1]):e;for(let A=0;A<E.length;++A)E[A].implementation=S(E[A].params,E[A].fn);const P=u?E[0].implementation:t,O=l?E[1].implementation:t,V=w?E[2].implementation:t,W=h?E[3].implementation:t,K=I?E[4].implementation:t,X=d?E[5].implementation:t,Z=u?E[0].params.length:-1,_=l?E[1].params.length:-1,q=w?E[2].params.length:-1,$=h?E[3].params.length:-1,AA=I?E[4].params.length:-1,eA=d?E[5].params.length:-1,tA=Y?6:0,nA=E.length,iA=E.map(A=>A.test),rA=E.map(A=>A.implementation),oA=function(){for(let A=tA;A<nA;A++)if(iA[A](arguments))return rA[A].apply(this,arguments);return g.onMismatch(A,arguments,E)};function sA(A,e){return arguments.length===Z&&f(A)&&R(e)?P.apply(this,arguments):arguments.length===_&&N(A)&&H(e)?O.apply(this,arguments):arguments.length===q&&U(A)&&k(e)?V.apply(this,arguments):arguments.length===$&&y(A)&&J(e)?W.apply(this,arguments):arguments.length===AA&&T(A)&&z(e)?K.apply(this,arguments):arguments.length===eA&&x(A)&&L(e)?X.apply(this,arguments):oA.apply(this,arguments)}try{Object.defineProperty(sA,"name",{value:A})}catch(A){}return sA.signatures=o,sA._typedFunctionData={signatures:E,signatureMap:Q},sA}function z(A,e,t){throw y(A,e,t)}function L(A){return O(A,0,A.length-1)}function P(A){return A[A.length-1]}function O(A,e,t){return Array.prototype.slice.call(A,e,t)}function V(A,e){return{referTo:{references:A,callback:e}}}function W(A){if("function"!=typeof A)throw new TypeError("Callback function expected as first argument");return{referToSelf:{callback:A}}}function K(A){return A&&"object"==typeof A.referTo&&Array.isArray(A.referTo.references)&&"function"==typeof A.referTo.callback}function X(A){return A&&"object"==typeof A.referToSelf&&"function"==typeof A.referToSelf.callback}function Z(A,e){if(!A)return e;if(e&&e!==A){const t=new Error("Function names do not match (expected: "+A+", actual: "+e+")");throw t.data={actual:e,expected:A},t}return A}function _(A){let e;for(const t in A)Object.prototype.hasOwnProperty.call(A,t)&&(w(A[t])||"string"==typeof A[t].signature)&&(e=Z(e,A[t].name));return e}function q(A,e){let t;for(t in e)if(Object.prototype.hasOwnProperty.call(e,t)){if(t in A&&e[t]!==A[t]){const n=new Error('Signature "'+t+'" is defined twice');throw n.data={signature:t,sourceFunction:e[t],destFunction:A[t]},n}A[t]=e[t]}}u(),Q(o);const $=g;function AA(A){if(!A||"string"!=typeof A.from||"string"!=typeof A.to||"function"!=typeof A.convert)throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");if(A.to===A.from)throw new SyntaxError('Illegal to define conversion from "'+A.from+'" to itself.')}return g=function(A){const e="string"==typeof A;let t=e?A:"";const n={};for(let A=e?1:0;A<arguments.length;++A){const i=arguments[A];let o,s={};if("function"==typeof i?(o=i.name,"string"==typeof i.signature?s[i.signature]=i:w(i)&&(s=i.signatures)):r(i)&&(s=i,e||(o=_(i))),0===Object.keys(s).length){const e=new TypeError("Argument to 'typed' at index "+A+" is not a (typed) function, nor an object with signatures as keys and functions as values.");throw e.data={index:A,argument:i},e}e||(t=Z(t,o)),q(n,s)}return J(t||"",n)},g.create=i,g.createCount=$.createCount,g.onMismatch=z,g.throwMismatchError=z,g.createError=y,g.clear=u,g.clearConversions=function(){let A;for(A of B)a.get(A).conversionsTo=[];c=0},g.addTypes=Q,g._findType=E,g.referTo=function(){const A=L(arguments).map(A=>C(m(A))),e=P(arguments);if("function"!=typeof e)throw new TypeError("Callback function expected as last argument");return V(A,e)},g.referToSelf=W,g.convert=function(A,e){const t=E(e);if(t.test(A))return A;const n=t.conversionsTo;if(0===n.length)throw new Error("There are no conversions to "+e+" defined.");for(let e=0;e<n.length;e++)if(E(n[e].from).test(A))return n[e].convert(A);throw new Error("Cannot convert "+A+" to "+e)},g.findSignature=h,g.find=function(A,e,t){return h(A,e,t).implementation},g.isTypedFunction=w,g.warnAgainstDeprecatedThis=!0,g.addType=function(A,e){let t="any";!1!==e&&a.has("Object")&&(t="Object"),g.addTypes([A],t)},g.addConversion=function(A){AA(A);const e=E(A.to);if(!e.conversionsTo.every((function(e){return e.from!==A.from})))throw new Error('There is already a conversion from "'+A.from+'" to "'+e.name+'"');e.conversionsTo.push({from:A.from,convert:A.convert,index:c++})},g.addConversions=function(A){A.forEach(g.addConversion)},g.removeConversion=function(A){AA(A);const e=E(A.to),t=function(A,e){for(let t=0;t<A.length;t++)if(e(A[t]))return A[t]}(e.conversionsTo,e=>e.from===A.from);if(!t)throw new Error("Attempt to remove nonexistent conversion from "+A.from+" to "+A.to);if(t.convert!==A.convert)throw new Error("Conversion to remove does not match existing conversion");const n=e.conversionsTo.indexOf(t);e.conversionsTo.splice(n,1)},g.resolve=function(A,e){if(!w(A))throw new TypeError(n);const t=A._typedFunctionData.signatures;for(let A=0;A<t.length;++A)if(t[A].test(e))return t[A];return null},g}()}()}},t={};function n(e){var i=t[e];if(void 0!==i)return i.exports;var r=t[e]={id:e,loaded:!1,exports:{}};return A[e].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}n.amdD=function(){throw new Error("define cannot be used indirect")},n.amdO={},n.d=(A,e)=>{for(var t in e)n.o(e,t)&&!n.o(A,t)&&Object.defineProperty(A,t,{enumerable:!0,get:e[t]})},n.o=(A,e)=>Object.prototype.hasOwnProperty.call(A,e),n.r=A=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(A,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(A,"__esModule",{value:!0})},n.nmd=A=>(A.paths=[],A.children||(A.children=[]),A);var i={};return(()=>{"use strict";n.d(i,{default:()=>tw});var A={};function e(A){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(A){return typeof A}:function(A){return A&&"function"==typeof Symbol&&A.constructor===Symbol&&A!==Symbol.prototype?"symbol":typeof A})(A)}function t(A){return"number"==typeof A}function r(A){return!(!A||"object"!==e(A)||"function"!=typeof A.constructor)&&(!0===A.isBigNumber&&"object"===e(A.constructor.prototype)&&!0===A.constructor.prototype.isBigNumber||"function"==typeof A.constructor.isDecimal&&!0===A.constructor.isDecimal(A))}function o(A){return A&&"object"===e(A)&&!0===Object.getPrototypeOf(A).isComplex||!1}function s(A){return A&&"object"===e(A)&&!0===Object.getPrototypeOf(A).isFraction||!1}function a(A){return A&&!0===A.constructor.prototype.isUnit||!1}function B(A){return"string"==typeof A}n.r(A),n.d(A,{createAbs:()=>Zi,createAccessorNode:()=>Wc,createAcos:()=>pB,createAcosh:()=>JB,createAcot:()=>zB,createAcoth:()=>LB,createAcsc:()=>PB,createAcsch:()=>OB,createAdd:()=>xc,createAddScalar:()=>Ar,createAnd:()=>Fa,createApply:()=>_i,createApplyTransform:()=>Dl,createArg:()=>mo,createArrayNode:()=>Xc,createAsec:()=>VB,createAsech:()=>WB,createAsin:()=>KB,createAsinh:()=>XB,createAssignmentNode:()=>ng,createAtan:()=>ZB,createAtan2:()=>_B,createAtanh:()=>qB,createAtomicMass:()=>tl,createAvogadro:()=>nl,createBellNumbers:()=>UQ,createBigNumberClass:()=>Tt,createBignumber:()=>gi,createBin:()=>Js,createBitAnd:()=>wo,createBitNot:()=>ho,createBitOr:()=>Co,createBitXor:()=>Mo,createBlockNode:()=>rg,createBohrMagneton:()=>Hu,createBohrRadius:()=>zu,createBoltzmann:()=>il,createBoolean:()=>ci,createCatalan:()=>TQ,createCbrt:()=>nr,createCeil:()=>cr,createChain:()=>wE,createChainClass:()=>gE,createClassicalElectronRadius:()=>Lu,createClone:()=>yn,createColumn:()=>So,createColumnTransform:()=>Yl,createCombinations:()=>XE,createCombinationsWithRep:()=>qE,createCompare:()=>Ya,createCompareNatural:()=>ya,createCompareText:()=>xa,createCompile:()=>kg,createComplex:()=>Ei,createComplexClass:()=>Rt,createComposition:()=>RQ,createConcat:()=>Go,createConcatTransform:()=>Jl,createConditionalNode:()=>sg,createConductanceQuantum:()=>bu,createConj:()=>po,createConstantNode:()=>wg,createCorr:()=>OE,createCos:()=>Ac,createCosh:()=>ec,createCot:()=>tc,createCoth:()=>nc,createCoulomb:()=>Gu,createCount:()=>Ho,createCreateUnit:()=>mB,createCross:()=>bo,createCsc:()=>ic,createCsch:()=>rc,createCtranspose:()=>Fs,createCube:()=>gr,createCumSum:()=>SE,createCumSumTransform:()=>Vl,createDeepEqual:()=>_a,createDenseMatrixClass:()=>Un,createDerivative:()=>_Q,createDet:()=>hE,createDeuteronMass:()=>Xu,createDiag:()=>vo,createDiff:()=>As,createDiffTransform:()=>zl,createDistance:()=>TE,createDivide:()=>UE,createDivideScalar:()=>qs,createDot:()=>Sc,createDotDivide:()=>aa,createDotMultiply:()=>$r,createDotPow:()=>oa,createE:()=>uu,createEfimovFactor:()=>el,createEigs:()=>mE,createElectricConstant:()=>xu,createElectronMass:()=>Pu,createElementaryCharge:()=>Su,createEqual:()=>Ga,createEqualScalar:()=>ri,createEqualText:()=>ba,createErf:()=>ys,createEvaluate:()=>Jg,createExp:()=>Er,createExpm:()=>pE,createExpm1:()=>Qr,createFactorial:()=>BQ,createFalse:()=>au,createFaraday:()=>rl,createFermiCoupling:()=>Ou,createFft:()=>Ys,createFibonacciHeapClass:()=>BB,createFilter:()=>jo,createFilterTransform:()=>Nl,createFineStructure:()=>Vu,createFirstRadiation:()=>ol,createFix:()=>lr,createFlatten:()=>Lo,createFloor:()=>Cr,createForEach:()=>Oo,createForEachTransform:()=>yl,createFormat:()=>js,createFraction:()=>Qi,createFractionClass:()=>St,createFreqz:()=>eu,createFunctionAssignmentNode:()=>Ig,createFunctionNode:()=>Hg,createGamma:()=>oQ,createGasConstant:()=>al,createGcd:()=>Gr,createGetMatrixDataType:()=>Ko,createGravitationConstant:()=>Nu,createGravity:()=>hl,createHartreeEnergy:()=>Wu,createHasNumericValue:()=>Zn,createHelp:()=>lE,createHelpClass:()=>cE,createHex:()=>Ls,createHypot:()=>Rc,createI:()=>mu,createIdentity:()=>Zo,createIfft:()=>fs,createIm:()=>Fo,createImmutableDenseMatrixClass:()=>oB,createIndex:()=>bc,createIndexClass:()=>sB,createIndexNode:()=>dg,createIndexTransform:()=>Tl,createInfinity:()=>cu,createIntersect:()=>xE,createInv:()=>CE,createInverseConductanceQuantum:()=>vu,createInvmod:()=>Zr,createIsInteger:()=>kn,createIsNaN:()=>Ai,createIsNegative:()=>Vn,createIsNumeric:()=>Kn,createIsPositive:()=>qn,createIsPrime:()=>Xs,createIsZero:()=>$n,createKldivergence:()=>gQ,createKlitzing:()=>Ju,createKron:()=>_o,createLN10:()=>hu,createLN2:()=>wu,createLOG10E:()=>Iu,createLOG2E:()=>Cu,createLarger:()=>Oa,createLargerEq:()=>Ka,createLcm:()=>Hr,createLeafCount:()=>SQ,createLeftShift:()=>Ia,createLgamma:()=>sQ,createLog:()=>ta,createLog10:()=>br,createLog1p:()=>na,createLog2:()=>vr,createLoschmidt:()=>sl,createLsolve:()=>ca,createLsolveAll:()=>Qa,createLup:()=>Pg,createLusolve:()=>sE,createLyap:()=>NE,createMad:()=>vE,createMagneticConstant:()=>Tu,createMagneticFluxQuantum:()=>ku,createMap:()=>qo,createMapTransform:()=>xl,createMatrix:()=>ui,createMatrixClass:()=>bt,createMatrixFromColumns:()=>mi,createMatrixFromFunction:()=>wi,createMatrixFromRows:()=>Ii,createMax:()=>iB,createMaxTransform:()=>Sl,createMean:()=>HE,createMeanTransform:()=>Hl,createMedian:()=>bE,createMin:()=>rB,createMinTransform:()=>bl,createMod:()=>Yr,createMode:()=>bs,createMolarMass:()=>ll,createMolarMassC12:()=>wl,createMolarPlanckConstant:()=>Bl,createMolarVolume:()=>cl,createMultinomial:()=>QQ,createMultiply:()=>Jr,createMultiplyScalar:()=>kr,createNaN:()=>gu,createNeutronMass:()=>Zu,createNode:()=>kc,createNorm:()=>Gc,createNot:()=>To,createNthRoot:()=>Lr,createNthRoots:()=>ra,createNuclearMagneton:()=>ju,createNull:()=>Bu,createNumber:()=>si,createNumeric:()=>Zs,createObjectNode:()=>pg,createOct:()=>zs,createOnes:()=>es,createOperatorNode:()=>Dg,createOr:()=>xo,createParenthesisNode:()=>fg,createParse:()=>bg,createParser:()=>Lg,createParserClass:()=>zg,createPartitionSelect:()=>tB,createPermutations:()=>lQ,createPhi:()=>lu,createPi:()=>Eu,createPickRandom:()=>dQ,createPinv:()=>IE,createPlanckCharge:()=>dl,createPlanckConstant:()=>Uu,createPlanckLength:()=>Cl,createPlanckMass:()=>Il,createPlanckTemperature:()=>ml,createPlanckTime:()=>Ml,createPolynomialRoot:()=>BE,createPow:()=>$s,createPrint:()=>Os,createPrintTransform:()=>Xl,createProd:()=>ks,createProtonMass:()=>Ku,createQr:()=>Og,createQuantileSeq:()=>LE,createQuantileSeqTransform:()=>Ol,createQuantumOfCirculation:()=>_u,createRandom:()=>pQ,createRandomInt:()=>DQ,createRange:()=>rs,createRangeClass:()=>Ht,createRangeNode:()=>Ug,createRangeTransform:()=>vl,createRationalize:()=>$Q,createRe:()=>Do,createReducedPlanckConstant:()=>yu,createRelationalNode:()=>Tg,createReplacer:()=>nu,createReshape:()=>ss,createResize:()=>as,createResolve:()=>WQ,createResultSet:()=>ZA,createReviver:()=>tu,createRightArithShift:()=>da,createRightLogShift:()=>pa,createRotate:()=>Bs,createRotationMatrix:()=>gs,createRound:()=>ea,createRow:()=>Es,createRowTransform:()=>kl,createRydberg:()=>qu,createSQRT1_2:()=>Mu,createSQRT2:()=>du,createSackurTetrode:()=>gl,createSchur:()=>fE,createSec:()=>oc,createSech:()=>sc,createSecondRadiation:()=>El,createSetCartesian:()=>Qc,createSetDifference:()=>lc,createSetDistinct:()=>hc,createSetIntersect:()=>Ic,createSetIsSubset:()=>dc,createSetMultiplicity:()=>pc,createSetPowerset:()=>Dc,createSetSize:()=>fc,createSetSymDifference:()=>Uc,createSetUnion:()=>Tc,createSign:()=>Pr,createSimplify:()=>JQ,createSimplifyConstant:()=>PQ,createSimplifyCore:()=>VQ,createSin:()=>ac,createSinh:()=>Bc,createSize:()=>Qs,createSlu:()=>iE,createSmaller:()=>ka,createSmallerEq:()=>za,createSolveODE:()=>Us,createSort:()=>nB,createSpaClass:()=>cB,createSparse:()=>MB,createSparseMatrixClass:()=>oi,createSpeedOfLight:()=>fu,createSplitUnit:()=>Fi,createSqrt:()=>Or,createSqrtm:()=>FE,createSquare:()=>Vr,createSqueeze:()=>ls,createStd:()=>PE,createStdTransform:()=>Ll,createStefanBoltzmann:()=>Ql,createStirlingS2:()=>fQ,createString:()=>ai,createSubset:()=>ws,createSubsetTransform:()=>jl,createSubtract:()=>Kr,createSubtractScalar:()=>tr,createSum:()=>RE,createSumTransform:()=>Pl,createSylvester:()=>YE,createSymbolNode:()=>xg,createSymbolicEqual:()=>XQ,createTan:()=>cc,createTanh:()=>gc,createTau:()=>Qu,createThomsonCrossSection:()=>$u,createTo:()=>Ws,createTrace:()=>Hc,createTranspose:()=>ms,createTrue:()=>su,createTypeOf:()=>ei,createTyped:()=>PA,createUnaryMinus:()=>Wi,createUnaryPlus:()=>Xi,createUnequal:()=>$a,createUnitClass:()=>CB,createUnitFunction:()=>IB,createUppercaseE:()=>Fu,createUppercasePi:()=>pu,createUsolve:()=>ga,createUsolveAll:()=>la,createVacuumImpedance:()=>Ru,createVariance:()=>JE,createVarianceTransform:()=>Kl,createVersion:()=>Du,createWeakMixingAngle:()=>Al,createWienDisplacement:()=>ul,createXgcd:()=>Xr,createXor:()=>Ro,createZeros:()=>Ds,createZeta:()=>Hs,createZpk2tf:()=>Au}),n(4043),n(7409),n(9288),n(6801),n(8742),n(228),n(3843),n(8052),n(3975),n(24),n(2003),n(8518),n(3440),n(2826),n(4284);var c=Array.isArray;function g(A){return A&&!0===A.constructor.prototype.isMatrix||!1}function E(A){return Array.isArray(A)||g(A)}function Q(A){return A&&A.isDenseMatrix&&!0===A.constructor.prototype.isMatrix||!1}function u(A){return A&&A.isSparseMatrix&&!0===A.constructor.prototype.isMatrix||!1}function l(A){return A&&!0===A.constructor.prototype.isRange||!1}function w(A){return A&&!0===A.constructor.prototype.isIndex||!1}function h(A){return"boolean"==typeof A}function C(A){return A&&!0===A.constructor.prototype.isResultSet||!1}function I(A){return A&&!0===A.constructor.prototype.isHelp||!1}function M(A){return"function"==typeof A}function d(A){return A instanceof Date}function m(A){return A instanceof RegExp}function p(A){return!(!A||"object"!==e(A)||A.constructor!==Object||o(A)||s(A))}function F(A){return null===A}function D(A){return void 0===A}function Y(A){return A&&!0===A.isAccessorNode&&!0===A.constructor.prototype.isNode||!1}function f(A){return A&&!0===A.isArrayNode&&!0===A.constructor.prototype.isNode||!1}function N(A){return A&&!0===A.isAssignmentNode&&!0===A.constructor.prototype.isNode||!1}function U(A){return A&&!0===A.isBlockNode&&!0===A.constructor.prototype.isNode||!1}function y(A){return A&&!0===A.isConditionalNode&&!0===A.constructor.prototype.isNode||!1}function T(A){return A&&!0===A.isConstantNode&&!0===A.constructor.prototype.isNode||!1}function x(A){return T(A)||v(A)&&1===A.args.length&&T(A.args[0])&&"-+~".includes(A.op)}function R(A){return A&&!0===A.isFunctionAssignmentNode&&!0===A.constructor.prototype.isNode||!1}function G(A){return A&&!0===A.isFunctionNode&&!0===A.constructor.prototype.isNode||!1}function S(A){return A&&!0===A.isIndexNode&&!0===A.constructor.prototype.isNode||!1}function H(A){return A&&!0===A.isNode&&!0===A.constructor.prototype.isNode||!1}function b(A){return A&&!0===A.isObjectNode&&!0===A.constructor.prototype.isNode||!1}function v(A){return A&&!0===A.isOperatorNode&&!0===A.constructor.prototype.isNode||!1}function k(A){return A&&!0===A.isParenthesisNode&&!0===A.constructor.prototype.isNode||!1}function j(A){return A&&!0===A.isRangeNode&&!0===A.constructor.prototype.isNode||!1}function J(A){return A&&!0===A.isRelationalNode&&!0===A.constructor.prototype.isNode||!1}function z(A){return A&&!0===A.isSymbolNode&&!0===A.constructor.prototype.isNode||!1}function L(A){return A&&!0===A.constructor.prototype.isChain||!1}function P(A){var t=e(A);return"object"===t?null===A?"null":r(A)?"BigNumber":A.constructor&&A.constructor.name?A.constructor.name:"Object":t}var O=n(4814);function V(A){return"boolean"==typeof A||!!isFinite(A)&&A===Math.round(A)}n(6976),n(8813),n(5239),n(2076),n(4712),n(4992),n(4338),n(7267),n(2462),n(939),n(7195),n(886),n(2320),n(6203),n(9730),n(2506),n(3584),n(6557),n(2428),n(5263),n(7221),n(2700),n(1554);var W=Math.sign||function(A){return A>0?1:A<0?-1:0},K=Math.log2||function(A){return Math.log(A)/Math.LN2},X=Math.log10||function(A){return Math.log(A)/Math.LN10},Z=Math.log1p||function(A){return Math.log(A+1)},_=Math.cbrt||function(A){if(0===A)return A;var e,t=A<0;return t&&(A=-A),e=isFinite(A)?(A/((e=Math.exp(Math.log(A)/3))*e)+2*e)/3:A,t?-e:e},q=Math.expm1||function(A){return A>=2e-4||A<=-2e-4?Math.exp(A)-1:A+A*A/2+A*A*A/6};function $(A,e,t){var n={2:"0b",8:"0o",16:"0x"}[e],i="";if(t){if(t<1)throw new Error("size must be in greater than 0");if(!V(t))throw new Error("size must be an integer");if(A>Math.pow(2,t-1)-1||A<-Math.pow(2,t-1))throw new Error("Value must be in range [-2^".concat(t-1,", 2^").concat(t-1,"-1]"));if(!V(A))throw new Error("Value must be an integer");A<0&&(A+=Math.pow(2,t)),i="i".concat(t)}var r="";return A<0&&(A=-A,r="-"),"".concat(r).concat(n).concat(A.toString(e)).concat(i)}function AA(A,e){if("function"==typeof e)return e(A);if(A===1/0)return"Infinity";if(A===-1/0)return"-Infinity";if(isNaN(A))return"NaN";var n,i,r="auto";if(e&&(e.notation&&(r=e.notation),t(e)?n=e:t(e.precision)&&(n=e.precision),e.wordSize&&"number"!=typeof(i=e.wordSize)))throw new Error('Option "wordSize" must be a number');switch(r){case"fixed":return tA(A,n);case"exponential":return nA(A,n);case"engineering":return function(A,e){if(isNaN(A)||!isFinite(A))return String(A);var n=iA(eA(A),e),i=n.exponent,r=n.coefficients,o=i%3==0?i:i<0?i-3-i%3:i-i%3;if(t(e))for(;e>r.length||i-o+1>r.length;)r.push(0);else for(var s=Math.abs(i-o)-(r.length-1),a=0;a<s;a++)r.push(0);for(var B=Math.abs(i-o),c=1;B>0;)c++,B--;var g=r.slice(c).join(""),E=t(e)&&g.length||g.match(/[1-9]/)?"."+g:"",Q=r.slice(0,c).join("")+E+"e"+(i>=0?"+":"")+o.toString();return n.sign+Q}(A,n);case"bin":return $(A,2,i);case"oct":return $(A,8,i);case"hex":return $(A,16,i);case"auto":return function(A,e,t){if(isNaN(A)||!isFinite(A))return String(A);var n=t&&void 0!==t.lowerExp?t.lowerExp:-3,i=t&&void 0!==t.upperExp?t.upperExp:5,r=eA(A),o=e?iA(r,e):r;if(o.exponent<n||o.exponent>=i)return nA(A,e);var s=o.coefficients,a=o.exponent;s.length<e&&(s=s.concat(rA(e-s.length))),s=s.concat(rA(a-s.length+1+(s.length<e?e-s.length:0)));var B=a>0?a:0;return B<(s=rA(-a).concat(s)).length-1&&s.splice(B+1,0,"."),o.sign+s.join("")}(A,n,e&&e).replace(/((\.\d*?)(0+))($|e)/,(function(){var A=arguments[2],e=arguments[4];return"."!==A?A+e:e}));default:throw new Error('Unknown notation "'+r+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function eA(A){var e=String(A).toLowerCase().match(/^(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!e)throw new SyntaxError("Invalid number "+A);var t=e[1],n=e[2],i=parseFloat(e[4]||"0"),r=n.indexOf(".");i+=-1!==r?r-1:n.length-1;var o=n.replace(".","").replace(/^0*/,(function(A){return i-=A.length,""})).replace(/0*$/,"").split("").map((function(A){return parseInt(A)}));return 0===o.length&&(o.push(0),i++),{sign:t,coefficients:o,exponent:i}}function tA(A,e){if(isNaN(A)||!isFinite(A))return String(A);var t=eA(A),n="number"==typeof e?iA(t,t.exponent+1+e):t,i=n.coefficients,r=n.exponent+1,o=r+(e||0);return i.length<o&&(i=i.concat(rA(o-i.length))),r<0&&(i=rA(1-r).concat(i),r=1),r<i.length&&i.splice(r,0,0===r?"0.":"."),n.sign+i.join("")}function nA(A,e){if(isNaN(A)||!isFinite(A))return String(A);var t=eA(A),n=e?iA(t,e):t,i=n.coefficients,r=n.exponent;i.length<e&&(i=i.concat(rA(e-i.length)));var o=i.shift();return n.sign+o+(i.length>0?"."+i.join(""):"")+"e"+(r>=0?"+":"")+r}function iA(A,e){for(var t={sign:A.sign,coefficients:A.coefficients,exponent:A.exponent},n=t.coefficients;e<=0;)n.unshift(0),t.exponent++,e++;if(n.length>e&&n.splice(e,n.length-e)[0]>=5){var i=e-1;for(n[i]++;10===n[i];)n.pop(),0===i&&(n.unshift(0),t.exponent++,i++),n[--i]++}return t}function rA(A){for(var e=[],t=0;t<A;t++)e.push(0);return e}var oA=Number.EPSILON||2220446049250313e-31;function sA(A,e,t){if(null==t)return A===e;if(A===e)return!0;if(isNaN(A)||isNaN(e))return!1;if(isFinite(A)&&isFinite(e)){var n=Math.abs(A-e);return n<oA||n<=Math.max(Math.abs(A),Math.abs(e))*t}return!1}var aA=Math.acosh||function(A){return Math.log(Math.sqrt(A*A-1)+A)},BA=Math.asinh||function(A){return Math.log(Math.sqrt(A*A+1)+A)},cA=Math.atanh||function(A){return Math.log((1+A)/(1-A))/2},gA=Math.cosh||function(A){return(Math.exp(A)+Math.exp(-A))/2},EA=Math.sinh||function(A){return(Math.exp(A)-Math.exp(-A))/2},QA=Math.tanh||function(A){var e=Math.exp(2*A);return(e-1)/(e+1)};function uA(A){var t=e(A);if("number"===t||"string"===t||"boolean"===t||null==A)return A;if("function"==typeof A.clone)return A.clone();if(Array.isArray(A))return A.map((function(A){return uA(A)}));if(A instanceof Date)return new Date(A.valueOf());if(r(A))return A;if(p(A))return lA(A,uA);throw new TypeError("Cannot clone: unknown type of value (value: ".concat(A,")"))}function lA(A,e){var t={};for(var n in A)MA(A,n)&&(t[n]=e(A[n]));return t}function wA(A,e){for(var t in e)MA(e,t)&&(A[t]=e[t]);return A}function hA(A,e){var t,n,i;if(Array.isArray(A)){if(!Array.isArray(e))return!1;if(A.length!==e.length)return!1;for(n=0,i=A.length;n<i;n++)if(!hA(A[n],e[n]))return!1;return!0}if("function"==typeof A)return A===e;if(A instanceof Object){if(Array.isArray(e)||!(e instanceof Object))return!1;for(t in A)if(!(t in e)||!hA(A[t],e[t]))return!1;for(t in e)if(!(t in A))return!1;return!0}return A===e}function CA(A,t){for(var n in A)if(MA(A,n)){var i=A[n];"object"===e(i)&&null!==i?CA(i,t):t[n]=i}}function IA(A,e,t){var n,i=!0;Object.defineProperty(A,e,{get:function(){return i&&(n=t(),i=!1),n},set:function(A){n=A,i=!1},configurable:!0,enumerable:!0})}function MA(A,e){return A&&Object.hasOwnProperty.call(A,e)}function dA(A){return Object.keys(A).map((function(e){return A[e]}))}function mA(A,e,t,n){function i(n){var i=function(A,e){for(var t={},n=0;n<e.length;n++){var i=e[n],r=A[i];void 0!==r&&(t[i]=r)}return t}(n,e.map(FA));return function(A,e,t){if(!e.filter((function(A){return!function(A){return A&&"?"===A[0]}(A)})).every((function(A){return void 0!==t[A]}))){var n=e.filter((function(A){return void 0===t[A]}));throw new Error('Cannot create function "'.concat(A,'", ')+"some dependencies are missing: ".concat(n.map((function(A){return'"'.concat(A,'"')})).join(", "),"."))}}(A,e,n),t(i)}return i.isFactory=!0,i.fn=A,i.dependencies=e.slice().sort(),n&&(i.meta=n),i}function pA(A){return"function"==typeof A&&"string"==typeof A.fn&&Array.isArray(A.dependencies)}function FA(A){return A&&"?"===A[0]?A.slice(1):A}function DA(A,e){if(!(A instanceof e))throw new TypeError("Cannot call a class as a function")}function YA(A){var t=function(A,t){if("object"!==e(A)||null===A)return A;var n=A[Symbol.toPrimitive];if(void 0!==n){var i=n.call(A,"string");if("object"!==e(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(A)}(A);return"symbol"===e(t)?t:String(t)}function fA(A,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(A,YA(n.key),n)}}function NA(A,e,t){return e&&fA(A.prototype,e),t&&fA(A,t),Object.defineProperty(A,"prototype",{writable:!1}),A}function UA(A,e){if(RA(A)&&TA(A,e))return A[e];if("function"==typeof A[e]&&xA(A,e))throw new Error('Cannot access method "'+e+'" as a property');throw new Error('No access to property "'+e+'"')}function yA(A,e,t){if(RA(A)&&TA(A,e))return A[e]=t,t;throw new Error('No access to property "'+e+'"')}function TA(A,t){return!(!A||"object"!==e(A)||!MA(GA,t)&&(t in Object.prototype||t in Function.prototype))}function xA(A,e){return!(null==A||"function"!=typeof A[e]||MA(A,e)&&Object.getPrototypeOf&&e in Object.getPrototypeOf(A)||!MA(SA,e)&&(e in Object.prototype||e in Function.prototype))}function RA(A){return"object"===e(A)&&A&&A.constructor===Object}n(5137),n(9693),n(7522),n(8077),n(5791),n(739),n(9358),n(752),n(6646),n(1694),n(6265),n(7722),n(9749),n(6544),n(4254);var GA={length:!0,name:!0},SA={toString:!0,valueOf:!0,toLocaleString:!0};function HA(A,e){var t="undefined"!=typeof Symbol&&A[Symbol.iterator]||A["@@iterator"];if(!t){if(Array.isArray(A)||(t=function(A,e){if(A){if("string"==typeof A)return bA(A,e);var t=Object.prototype.toString.call(A).slice(8,-1);return"Object"===t&&A.constructor&&(t=A.constructor.name),"Map"===t||"Set"===t?Array.from(A):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?bA(A,e):void 0}}(A))||e&&A&&"number"==typeof A.length){t&&(A=t);var n=0,i=function(){};return{s:i,n:function(){return n>=A.length?{done:!0}:{done:!1,value:A[n++]}},e:function(A){throw A},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){t=t.call(A)},n:function(){var A=t.next();return o=A.done,A},e:function(A){s=!0,r=A},f:function(){try{o||null==t.return||t.return()}finally{if(s)throw r}}}}function bA(A,e){(null==e||e>A.length)&&(e=A.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=A[t];return n}var vA=function(){function A(e){DA(this,A),this.wrappedObject=e}return NA(A,[{key:"keys",value:function(){return Object.keys(this.wrappedObject)}},{key:"get",value:function(A){return UA(this.wrappedObject,A)}},{key:"set",value:function(A,e){return yA(this.wrappedObject,A,e),this}},{key:"has",value:function(A){return A in this.wrappedObject}}]),A}();function kA(){return new Map}function jA(A){if(!A)return kA();if(JA(A))return A;if(p(A))return new vA(A);throw new Error("createMap can create maps from objects or Maps")}function JA(A){return!!A&&(A instanceof Map||A instanceof vA||"function"==typeof A.set&&"function"==typeof A.get&&"function"==typeof A.keys&&"function"==typeof A.has)}function zA(A){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];for(var i=0,r=t;i<r.length;i++){var o=r[i];if(o)if(JA(o)){var s,a=HA(o.keys());try{for(a.s();!(s=a.n()).done;){var B=s.value;A.set(B,o.get(B))}}catch(A){a.e(A)}finally{a.f()}}else if(p(o))for(var c=0,g=Object.keys(o);c<g.length;c++){var E=g[c];A.set(E,o[E])}}return A}var LA=function(){return LA=O.create,O},PA=mA("typed",["?BigNumber","?Complex","?DenseMatrix","?Fraction"],(function(A){var e=A.BigNumber,n=A.Complex,i=A.DenseMatrix,x=A.Fraction,P=LA();return P.clear(),P.addTypes([{name:"number",test:t},{name:"Complex",test:o},{name:"BigNumber",test:r},{name:"Fraction",test:s},{name:"Unit",test:a},{name:"identifier",test:function(A){return B&&/^(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])*$/.test(A)}},{name:"string",test:B},{name:"Chain",test:L},{name:"Array",test:c},{name:"Matrix",test:g},{name:"DenseMatrix",test:Q},{name:"SparseMatrix",test:u},{name:"Range",test:l},{name:"Index",test:w},{name:"boolean",test:h},{name:"ResultSet",test:C},{name:"Help",test:I},{name:"function",test:M},{name:"Date",test:d},{name:"RegExp",test:m},{name:"null",test:F},{name:"undefined",test:D},{name:"AccessorNode",test:Y},{name:"ArrayNode",test:f},{name:"AssignmentNode",test:N},{name:"BlockNode",test:U},{name:"ConditionalNode",test:y},{name:"ConstantNode",test:T},{name:"FunctionNode",test:G},{name:"FunctionAssignmentNode",test:R},{name:"IndexNode",test:S},{name:"Node",test:H},{name:"ObjectNode",test:b},{name:"OperatorNode",test:v},{name:"ParenthesisNode",test:k},{name:"RangeNode",test:j},{name:"RelationalNode",test:J},{name:"SymbolNode",test:z},{name:"Map",test:JA},{name:"Object",test:p}]),P.addConversions([{from:"number",to:"BigNumber",convert:function(A){if(e||OA(A),A.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length>15)throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+A+"). Use function bignumber(x) to convert to BigNumber.");return new e(A)}},{from:"number",to:"Complex",convert:function(A){return n||VA(A),new n(A,0)}},{from:"BigNumber",to:"Complex",convert:function(A){return n||VA(A),new n(A.toNumber(),0)}},{from:"Fraction",to:"BigNumber",convert:function(A){throw new TypeError("Cannot implicitly convert a Fraction to BigNumber or vice versa. Use function bignumber(x) to convert to BigNumber or fraction(x) to convert to Fraction.")}},{from:"Fraction",to:"Complex",convert:function(A){return n||VA(A),new n(A.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(A){x||WA(A);var e=new x(A);if(e.valueOf()!==A)throw new TypeError("Cannot implicitly convert a number to a Fraction when there will be a loss of precision (value: "+A+"). Use function fraction(x) to convert to Fraction.");return e}},{from:"string",to:"number",convert:function(A){var e=Number(A);if(isNaN(e))throw new Error('Cannot convert "'+A+'" to a number');return e}},{from:"string",to:"BigNumber",convert:function(A){e||OA(A);try{return new e(A)}catch(e){throw new Error('Cannot convert "'+A+'" to BigNumber')}}},{from:"string",to:"Fraction",convert:function(A){x||WA(A);try{return new x(A)}catch(e){throw new Error('Cannot convert "'+A+'" to Fraction')}}},{from:"string",to:"Complex",convert:function(A){n||VA(A);try{return new n(A)}catch(e){throw new Error('Cannot convert "'+A+'" to Complex')}}},{from:"boolean",to:"number",convert:function(A){return+A}},{from:"boolean",to:"BigNumber",convert:function(A){return e||OA(A),new e(+A)}},{from:"boolean",to:"Fraction",convert:function(A){return x||WA(A),new x(+A)}},{from:"boolean",to:"string",convert:function(A){return String(A)}},{from:"Array",to:"Matrix",convert:function(A){return i||function(){throw new Error("Cannot convert array into a Matrix: no class 'DenseMatrix' provided")}(),new i(A)}},{from:"Matrix",to:"Array",convert:function(A){return A.valueOf()}}]),P.onMismatch=function(A,e,t){var n=P.createError(A,e,t);if(["wrongType","mismatch"].includes(n.data.category)&&1===e.length&&E(e[0])&&t.some((function(A){return!A.params.includes(",")}))){var i=new TypeError("Function '".concat(A,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(A,")'."));throw i.data=n.data,i}throw n},P.onMismatch=function(A,e,t){var n=P.createError(A,e,t);if(["wrongType","mismatch"].includes(n.data.category)&&1===e.length&&E(e[0])&&t.some((function(A){return!A.params.includes(",")}))){var i=new TypeError("Function '".concat(A,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(A,")'."));throw i.data=n.data,i}throw n},P}));function OA(A){throw new Error("Cannot convert value ".concat(A," into a BigNumber: no class 'BigNumber' provided"))}function VA(A){throw new Error("Cannot convert value ".concat(A," into a Complex number: no class 'Complex' provided"))}function WA(A){throw new Error("Cannot convert value ".concat(A," into a Fraction, no class 'Fraction' provided."))}n(8150),n(9979);var KA,XA,ZA=mA("ResultSet",[],(function(){function A(e){if(!(this instanceof A))throw new SyntaxError("Constructor must be called with the new operator");this.entries=e||[]}return A.prototype.type="ResultSet",A.prototype.isResultSet=!0,A.prototype.valueOf=function(){return this.entries},A.prototype.toString=function(){return"["+this.entries.join(", ")+"]"},A.prototype.toJSON=function(){return{mathjs:"ResultSet",entries:this.entries}},A.fromJSON=function(e){return new A(e.entries)},A}),{isClass:!0}),_A=(n(1013),9e15),qA=1e9,$A="0123456789abcdef",Ae="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",ee="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",te={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-_A,maxE:_A,crypto:!1},ne=!0,ie="[DecimalError] ",re=ie+"Invalid argument: ",oe=ie+"Precision limit exceeded",se=ie+"crypto unavailable",ae="[object Decimal]",Be=Math.floor,ce=Math.pow,ge=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Ee=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Qe=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,ue=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,le=1e7,we=Ae.length-1,he=ee.length-1,Ce={toStringTag:ae};function Ie(A){var e,t,n,i=A.length-1,r="",o=A[0];if(i>0){for(r+=o,e=1;e<i;e++)(t=7-(n=A[e]+"").length)&&(r+=ye(t)),r+=n;(t=7-(n=(o=A[e])+"").length)&&(r+=ye(t))}else if(0===o)return"0";for(;o%10==0;)o/=10;return r+o}function Me(A,e,t){if(A!==~~A||A<e||A>t)throw Error(re+A)}function de(A,e,t,n){var i,r,o,s;for(r=A[0];r>=10;r/=10)--e;return--e<0?(e+=7,i=0):(i=Math.ceil((e+1)/7),e%=7),r=ce(10,7-e),s=A[i]%r|0,null==n?e<3?(0==e?s=s/100|0:1==e&&(s=s/10|0),o=t<4&&99999==s||t>3&&49999==s||5e4==s||0==s):o=(t<4&&s+1==r||t>3&&s+1==r/2)&&(A[i+1]/r/100|0)==ce(10,e-2)-1||(s==r/2||0==s)&&0==(A[i+1]/r/100|0):e<4?(0==e?s=s/1e3|0:1==e?s=s/100|0:2==e&&(s=s/10|0),o=(n||t<4)&&9999==s||!n&&t>3&&4999==s):o=((n||t<4)&&s+1==r||!n&&t>3&&s+1==r/2)&&(A[i+1]/r/1e3|0)==ce(10,e-3)-1,o}function me(A,e,t){for(var n,i,r=[0],o=0,s=A.length;o<s;){for(i=r.length;i--;)r[i]*=e;for(r[0]+=$A.indexOf(A.charAt(o++)),n=0;n<r.length;n++)r[n]>t-1&&(void 0===r[n+1]&&(r[n+1]=0),r[n+1]+=r[n]/t|0,r[n]%=t)}return r.reverse()}Ce.absoluteValue=Ce.abs=function(){var A=new this.constructor(this);return A.s<0&&(A.s=1),Fe(A)},Ce.ceil=function(){return Fe(new this.constructor(this),this.e+1,2)},Ce.clampedTo=Ce.clamp=function(A,e){var t=this,n=t.constructor;if(A=new n(A),e=new n(e),!A.s||!e.s)return new n(NaN);if(A.gt(e))throw Error(re+e);return t.cmp(A)<0?A:t.cmp(e)>0?e:new n(t)},Ce.comparedTo=Ce.cmp=function(A){var e,t,n,i,r=this,o=r.d,s=(A=new r.constructor(A)).d,a=r.s,B=A.s;if(!o||!s)return a&&B?a!==B?a:o===s?0:!o^a<0?1:-1:NaN;if(!o[0]||!s[0])return o[0]?a:s[0]?-B:0;if(a!==B)return a;if(r.e!==A.e)return r.e>A.e^a<0?1:-1;for(e=0,t=(n=o.length)<(i=s.length)?n:i;e<t;++e)if(o[e]!==s[e])return o[e]>s[e]^a<0?1:-1;return n===i?0:n>i^a<0?1:-1},Ce.cosine=Ce.cos=function(){var A,e,t=this,n=t.constructor;return t.d?t.d[0]?(A=n.precision,e=n.rounding,n.precision=A+Math.max(t.e,t.sd())+7,n.rounding=1,t=function(A,e){var t,n,i;if(e.isZero())return e;(n=e.d.length)<32?i=(1/ke(4,t=Math.ceil(n/3))).toString():(t=16,i="2.3283064365386962890625e-10"),A.precision+=t,e=ve(A,1,e.times(i),new A(1));for(var r=t;r--;){var o=e.times(e);e=o.times(o).minus(o).times(8).plus(1)}return A.precision-=t,e}(n,je(n,t)),n.precision=A,n.rounding=e,Fe(2==XA||3==XA?t.neg():t,A,e,!0)):new n(1):new n(NaN)},Ce.cubeRoot=Ce.cbrt=function(){var A,e,t,n,i,r,o,s,a,B,c=this,g=c.constructor;if(!c.isFinite()||c.isZero())return new g(c);for(ne=!1,(r=c.s*ce(c.s*c,1/3))&&Math.abs(r)!=1/0?n=new g(r.toString()):(t=Ie(c.d),(r=((A=c.e)-t.length+1)%3)&&(t+=1==r||-2==r?"0":"00"),r=ce(t,1/3),A=Be((A+1)/3)-(A%3==(A<0?-1:2)),(n=new g(t=r==1/0?"5e"+A:(t=r.toExponential()).slice(0,t.indexOf("e")+1)+A)).s=c.s),o=(A=g.precision)+3;;)if(B=(a=(s=n).times(s).times(s)).plus(c),n=pe(B.plus(c).times(s),B.plus(a),o+2,1),Ie(s.d).slice(0,o)===(t=Ie(n.d)).slice(0,o)){if("9999"!=(t=t.slice(o-3,o+1))&&(i||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(Fe(n,A+1,1),e=!n.times(n).times(n).eq(c));break}if(!i&&(Fe(s,A+1,0),s.times(s).times(s).eq(c))){n=s;break}o+=4,i=1}return ne=!0,Fe(n,A,g.rounding,e)},Ce.decimalPlaces=Ce.dp=function(){var A,e=this.d,t=NaN;if(e){if(t=7*((A=e.length-1)-Be(this.e/7)),A=e[A])for(;A%10==0;A/=10)t--;t<0&&(t=0)}return t},Ce.dividedBy=Ce.div=function(A){return pe(this,new this.constructor(A))},Ce.dividedToIntegerBy=Ce.divToInt=function(A){var e=this.constructor;return Fe(pe(this,new e(A),0,1,1),e.precision,e.rounding)},Ce.equals=Ce.eq=function(A){return 0===this.cmp(A)},Ce.floor=function(){return Fe(new this.constructor(this),this.e+1,3)},Ce.greaterThan=Ce.gt=function(A){return this.cmp(A)>0},Ce.greaterThanOrEqualTo=Ce.gte=function(A){var e=this.cmp(A);return 1==e||0===e},Ce.hyperbolicCosine=Ce.cosh=function(){var A,e,t,n,i,r=this,o=r.constructor,s=new o(1);if(!r.isFinite())return new o(r.s?1/0:NaN);if(r.isZero())return s;t=o.precision,n=o.rounding,o.precision=t+Math.max(r.e,r.sd())+4,o.rounding=1,(i=r.d.length)<32?e=(1/ke(4,A=Math.ceil(i/3))).toString():(A=16,e="2.3283064365386962890625e-10"),r=ve(o,1,r.times(e),new o(1),!0);for(var a,B=A,c=new o(8);B--;)a=r.times(r),r=s.minus(a.times(c.minus(a.times(c))));return Fe(r,o.precision=t,o.rounding=n,!0)},Ce.hyperbolicSine=Ce.sinh=function(){var A,e,t,n,i=this,r=i.constructor;if(!i.isFinite()||i.isZero())return new r(i);if(e=r.precision,t=r.rounding,r.precision=e+Math.max(i.e,i.sd())+4,r.rounding=1,(n=i.d.length)<3)i=ve(r,2,i,i,!0);else{A=(A=1.4*Math.sqrt(n))>16?16:0|A,i=ve(r,2,i=i.times(1/ke(5,A)),i,!0);for(var o,s=new r(5),a=new r(16),B=new r(20);A--;)o=i.times(i),i=i.times(s.plus(o.times(a.times(o).plus(B))))}return r.precision=e,r.rounding=t,Fe(i,e,t,!0)},Ce.hyperbolicTangent=Ce.tanh=function(){var A,e,t=this,n=t.constructor;return t.isFinite()?t.isZero()?new n(t):(A=n.precision,e=n.rounding,n.precision=A+7,n.rounding=1,pe(t.sinh(),t.cosh(),n.precision=A,n.rounding=e)):new n(t.s)},Ce.inverseCosine=Ce.acos=function(){var A,e=this,t=e.constructor,n=e.abs().cmp(1),i=t.precision,r=t.rounding;return-1!==n?0===n?e.isNeg()?Ne(t,i,r):new t(0):new t(NaN):e.isZero()?Ne(t,i+4,r).times(.5):(t.precision=i+6,t.rounding=1,e=e.asin(),A=Ne(t,i+4,r).times(.5),t.precision=i,t.rounding=r,A.minus(e))},Ce.inverseHyperbolicCosine=Ce.acosh=function(){var A,e,t=this,n=t.constructor;return t.lte(1)?new n(t.eq(1)?0:NaN):t.isFinite()?(A=n.precision,e=n.rounding,n.precision=A+Math.max(Math.abs(t.e),t.sd())+4,n.rounding=1,ne=!1,t=t.times(t).minus(1).sqrt().plus(t),ne=!0,n.precision=A,n.rounding=e,t.ln()):new n(t)},Ce.inverseHyperbolicSine=Ce.asinh=function(){var A,e,t=this,n=t.constructor;return!t.isFinite()||t.isZero()?new n(t):(A=n.precision,e=n.rounding,n.precision=A+2*Math.max(Math.abs(t.e),t.sd())+6,n.rounding=1,ne=!1,t=t.times(t).plus(1).sqrt().plus(t),ne=!0,n.precision=A,n.rounding=e,t.ln())},Ce.inverseHyperbolicTangent=Ce.atanh=function(){var A,e,t,n,i=this,r=i.constructor;return i.isFinite()?i.e>=0?new r(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(A=r.precision,e=r.rounding,n=i.sd(),Math.max(n,A)<2*-i.e-1?Fe(new r(i),A,e,!0):(r.precision=t=n-i.e,i=pe(i.plus(1),new r(1).minus(i),t+A,1),r.precision=A+4,r.rounding=1,i=i.ln(),r.precision=A,r.rounding=e,i.times(.5))):new r(NaN)},Ce.inverseSine=Ce.asin=function(){var A,e,t,n,i=this,r=i.constructor;return i.isZero()?new r(i):(e=i.abs().cmp(1),t=r.precision,n=r.rounding,-1!==e?0===e?((A=Ne(r,t+4,n).times(.5)).s=i.s,A):new r(NaN):(r.precision=t+6,r.rounding=1,i=i.div(new r(1).minus(i.times(i)).sqrt().plus(1)).atan(),r.precision=t,r.rounding=n,i.times(2)))},Ce.inverseTangent=Ce.atan=function(){var A,e,t,n,i,r,o,s,a,B=this,c=B.constructor,g=c.precision,E=c.rounding;if(B.isFinite()){if(B.isZero())return new c(B);if(B.abs().eq(1)&&g+4<=he)return(o=Ne(c,g+4,E).times(.25)).s=B.s,o}else{if(!B.s)return new c(NaN);if(g+4<=he)return(o=Ne(c,g+4,E).times(.5)).s=B.s,o}for(c.precision=s=g+10,c.rounding=1,A=t=Math.min(28,s/7+2|0);A;--A)B=B.div(B.times(B).plus(1).sqrt().plus(1));for(ne=!1,e=Math.ceil(s/7),n=1,a=B.times(B),o=new c(B),i=B;-1!==A;)if(i=i.times(a),r=o.minus(i.div(n+=2)),i=i.times(a),void 0!==(o=r.plus(i.div(n+=2))).d[e])for(A=e;o.d[A]===r.d[A]&&A--;);return t&&(o=o.times(2<<t-1)),ne=!0,Fe(o,c.precision=g,c.rounding=E,!0)},Ce.isFinite=function(){return!!this.d},Ce.isInteger=Ce.isInt=function(){return!!this.d&&Be(this.e/7)>this.d.length-2},Ce.isNaN=function(){return!this.s},Ce.isNegative=Ce.isNeg=function(){return this.s<0},Ce.isPositive=Ce.isPos=function(){return this.s>0},Ce.isZero=function(){return!!this.d&&0===this.d[0]},Ce.lessThan=Ce.lt=function(A){return this.cmp(A)<0},Ce.lessThanOrEqualTo=Ce.lte=function(A){return this.cmp(A)<1},Ce.logarithm=Ce.log=function(A){var e,t,n,i,r,o,s,a,B=this,c=B.constructor,g=c.precision,E=c.rounding;if(null==A)A=new c(10),e=!0;else{if(t=(A=new c(A)).d,A.s<0||!t||!t[0]||A.eq(1))return new c(NaN);e=A.eq(10)}if(t=B.d,B.s<0||!t||!t[0]||B.eq(1))return new c(t&&!t[0]?-1/0:1!=B.s?NaN:t?0:1/0);if(e)if(t.length>1)r=!0;else{for(i=t[0];i%10==0;)i/=10;r=1!==i}if(ne=!1,o=Se(B,s=g+5),n=e?fe(c,s+10):Se(A,s),de((a=pe(o,n,s,1)).d,i=g,E))do{if(o=Se(B,s+=10),n=e?fe(c,s+10):Se(A,s),a=pe(o,n,s,1),!r){+Ie(a.d).slice(i+1,i+15)+1==1e14&&(a=Fe(a,g+1,0));break}}while(de(a.d,i+=10,E));return ne=!0,Fe(a,g,E)},Ce.minus=Ce.sub=function(A){var e,t,n,i,r,o,s,a,B,c,g,E,Q=this,u=Q.constructor;if(A=new u(A),!Q.d||!A.d)return Q.s&&A.s?Q.d?A.s=-A.s:A=new u(A.d||Q.s!==A.s?Q:NaN):A=new u(NaN),A;if(Q.s!=A.s)return A.s=-A.s,Q.plus(A);if(B=Q.d,E=A.d,s=u.precision,a=u.rounding,!B[0]||!E[0]){if(E[0])A.s=-A.s;else{if(!B[0])return new u(3===a?-0:0);A=new u(Q)}return ne?Fe(A,s,a):A}if(t=Be(A.e/7),c=Be(Q.e/7),B=B.slice(),r=c-t){for((g=r<0)?(e=B,r=-r,o=E.length):(e=E,t=c,o=B.length),r>(n=Math.max(Math.ceil(s/7),o)+2)&&(r=n,e.length=1),e.reverse(),n=r;n--;)e.push(0);e.reverse()}else{for((g=(n=B.length)<(o=E.length))&&(o=n),n=0;n<o;n++)if(B[n]!=E[n]){g=B[n]<E[n];break}r=0}for(g&&(e=B,B=E,E=e,A.s=-A.s),o=B.length,n=E.length-o;n>0;--n)B[o++]=0;for(n=E.length;n>r;){if(B[--n]<E[n]){for(i=n;i&&0===B[--i];)B[i]=le-1;--B[i],B[n]+=le}B[n]-=E[n]}for(;0===B[--o];)B.pop();for(;0===B[0];B.shift())--t;return B[0]?(A.d=B,A.e=Ye(B,t),ne?Fe(A,s,a):A):new u(3===a?-0:0)},Ce.modulo=Ce.mod=function(A){var e,t=this,n=t.constructor;return A=new n(A),!t.d||!A.s||A.d&&!A.d[0]?new n(NaN):!A.d||t.d&&!t.d[0]?Fe(new n(t),n.precision,n.rounding):(ne=!1,9==n.modulo?(e=pe(t,A.abs(),0,3,1)).s*=A.s:e=pe(t,A,0,n.modulo,1),e=e.times(A),ne=!0,t.minus(e))},Ce.naturalExponential=Ce.exp=function(){return Ge(this)},Ce.naturalLogarithm=Ce.ln=function(){return Se(this)},Ce.negated=Ce.neg=function(){var A=new this.constructor(this);return A.s=-A.s,Fe(A)},Ce.plus=Ce.add=function(A){var e,t,n,i,r,o,s,a,B,c,g=this,E=g.constructor;if(A=new E(A),!g.d||!A.d)return g.s&&A.s?g.d||(A=new E(A.d||g.s===A.s?g:NaN)):A=new E(NaN),A;if(g.s!=A.s)return A.s=-A.s,g.minus(A);if(B=g.d,c=A.d,s=E.precision,a=E.rounding,!B[0]||!c[0])return c[0]||(A=new E(g)),ne?Fe(A,s,a):A;if(r=Be(g.e/7),n=Be(A.e/7),B=B.slice(),i=r-n){for(i<0?(t=B,i=-i,o=c.length):(t=c,n=r,o=B.length),i>(o=(r=Math.ceil(s/7))>o?r+1:o+1)&&(i=o,t.length=1),t.reverse();i--;)t.push(0);t.reverse()}for((o=B.length)-(i=c.length)<0&&(i=o,t=c,c=B,B=t),e=0;i;)e=(B[--i]=B[i]+c[i]+e)/le|0,B[i]%=le;for(e&&(B.unshift(e),++n),o=B.length;0==B[--o];)B.pop();return A.d=B,A.e=Ye(B,n),ne?Fe(A,s,a):A},Ce.precision=Ce.sd=function(A){var e,t=this;if(void 0!==A&&A!==!!A&&1!==A&&0!==A)throw Error(re+A);return t.d?(e=Ue(t.d),A&&t.e+1>e&&(e=t.e+1)):e=NaN,e},Ce.round=function(){var A=this,e=A.constructor;return Fe(new e(A),A.e+1,e.rounding)},Ce.sine=Ce.sin=function(){var A,e,t=this,n=t.constructor;return t.isFinite()?t.isZero()?new n(t):(A=n.precision,e=n.rounding,n.precision=A+Math.max(t.e,t.sd())+7,n.rounding=1,t=function(A,e){var t,n=e.d.length;if(n<3)return e.isZero()?e:ve(A,2,e,e);t=(t=1.4*Math.sqrt(n))>16?16:0|t,e=ve(A,2,e=e.times(1/ke(5,t)),e);for(var i,r=new A(5),o=new A(16),s=new A(20);t--;)i=e.times(e),e=e.times(r.plus(i.times(o.times(i).minus(s))));return e}(n,je(n,t)),n.precision=A,n.rounding=e,Fe(XA>2?t.neg():t,A,e,!0)):new n(NaN)},Ce.squareRoot=Ce.sqrt=function(){var A,e,t,n,i,r,o=this,s=o.d,a=o.e,B=o.s,c=o.constructor;if(1!==B||!s||!s[0])return new c(!B||B<0&&(!s||s[0])?NaN:s?o:1/0);for(ne=!1,0==(B=Math.sqrt(+o))||B==1/0?(((e=Ie(s)).length+a)%2==0&&(e+="0"),B=Math.sqrt(e),a=Be((a+1)/2)-(a<0||a%2),n=new c(e=B==1/0?"5e"+a:(e=B.toExponential()).slice(0,e.indexOf("e")+1)+a)):n=new c(B.toString()),t=(a=c.precision)+3;;)if(n=(r=n).plus(pe(o,r,t+2,1)).times(.5),Ie(r.d).slice(0,t)===(e=Ie(n.d)).slice(0,t)){if("9999"!=(e=e.slice(t-3,t+1))&&(i||"4999"!=e)){+e&&(+e.slice(1)||"5"!=e.charAt(0))||(Fe(n,a+1,1),A=!n.times(n).eq(o));break}if(!i&&(Fe(r,a+1,0),r.times(r).eq(o))){n=r;break}t+=4,i=1}return ne=!0,Fe(n,a,c.rounding,A)},Ce.tangent=Ce.tan=function(){var A,e,t=this,n=t.constructor;return t.isFinite()?t.isZero()?new n(t):(A=n.precision,e=n.rounding,n.precision=A+10,n.rounding=1,(t=t.sin()).s=1,t=pe(t,new n(1).minus(t.times(t)).sqrt(),A+10,0),n.precision=A,n.rounding=e,Fe(2==XA||4==XA?t.neg():t,A,e,!0)):new n(NaN)},Ce.times=Ce.mul=function(A){var e,t,n,i,r,o,s,a,B,c=this,g=c.constructor,E=c.d,Q=(A=new g(A)).d;if(A.s*=c.s,!(E&&E[0]&&Q&&Q[0]))return new g(!A.s||E&&!E[0]&&!Q||Q&&!Q[0]&&!E?NaN:E&&Q?0*A.s:A.s/0);for(t=Be(c.e/7)+Be(A.e/7),(a=E.length)<(B=Q.length)&&(r=E,E=Q,Q=r,o=a,a=B,B=o),r=[],n=o=a+B;n--;)r.push(0);for(n=B;--n>=0;){for(e=0,i=a+n;i>n;)s=r[i]+Q[n]*E[i-n-1]+e,r[i--]=s%le|0,e=s/le|0;r[i]=(r[i]+e)%le|0}for(;!r[--o];)r.pop();return e?++t:r.shift(),A.d=r,A.e=Ye(r,t),ne?Fe(A,g.precision,g.rounding):A},Ce.toBinary=function(A,e){return Je(this,2,A,e)},Ce.toDecimalPlaces=Ce.toDP=function(A,e){var t=this,n=t.constructor;return t=new n(t),void 0===A?t:(Me(A,0,qA),void 0===e?e=n.rounding:Me(e,0,8),Fe(t,A+t.e+1,e))},Ce.toExponential=function(A,e){var t,n=this,i=n.constructor;return void 0===A?t=De(n,!0):(Me(A,0,qA),void 0===e?e=i.rounding:Me(e,0,8),t=De(n=Fe(new i(n),A+1,e),!0,A+1)),n.isNeg()&&!n.isZero()?"-"+t:t},Ce.toFixed=function(A,e){var t,n,i=this,r=i.constructor;return void 0===A?t=De(i):(Me(A,0,qA),void 0===e?e=r.rounding:Me(e,0,8),t=De(n=Fe(new r(i),A+i.e+1,e),!1,A+n.e+1)),i.isNeg()&&!i.isZero()?"-"+t:t},Ce.toFraction=function(A){var e,t,n,i,r,o,s,a,B,c,g,E,Q=this,u=Q.d,l=Q.constructor;if(!u)return new l(Q);if(B=t=new l(1),n=a=new l(0),o=(r=(e=new l(n)).e=Ue(u)-Q.e-1)%7,e.d[0]=ce(10,o<0?7+o:o),null==A)A=r>0?e:B;else{if(!(s=new l(A)).isInt()||s.lt(B))throw Error(re+s);A=s.gt(e)?r>0?e:B:s}for(ne=!1,s=new l(Ie(u)),c=l.precision,l.precision=r=7*u.length*2;g=pe(s,e,0,1,1),1!=(i=t.plus(g.times(n))).cmp(A);)t=n,n=i,i=B,B=a.plus(g.times(i)),a=i,i=e,e=s.minus(g.times(i)),s=i;return i=pe(A.minus(t),n,0,1,1),a=a.plus(i.times(B)),t=t.plus(i.times(n)),a.s=B.s=Q.s,E=pe(B,n,r,1).minus(Q).abs().cmp(pe(a,t,r,1).minus(Q).abs())<1?[B,n]:[a,t],l.precision=c,ne=!0,E},Ce.toHexadecimal=Ce.toHex=function(A,e){return Je(this,16,A,e)},Ce.toNearest=function(A,e){var t=this,n=t.constructor;if(t=new n(t),null==A){if(!t.d)return t;A=new n(1),e=n.rounding}else{if(A=new n(A),void 0===e?e=n.rounding:Me(e,0,8),!t.d)return A.s?t:A;if(!A.d)return A.s&&(A.s=t.s),A}return A.d[0]?(ne=!1,t=pe(t,A,0,e,1).times(A),ne=!0,Fe(t)):(A.s=t.s,t=A),t},Ce.toNumber=function(){return+this},Ce.toOctal=function(A,e){return Je(this,8,A,e)},Ce.toPower=Ce.pow=function(A){var e,t,n,i,r,o,s=this,a=s.constructor,B=+(A=new a(A));if(!(s.d&&A.d&&s.d[0]&&A.d[0]))return new a(ce(+s,B));if((s=new a(s)).eq(1))return s;if(n=a.precision,r=a.rounding,A.eq(1))return Fe(s,n,r);if((e=Be(A.e/7))>=A.d.length-1&&(t=B<0?-B:B)<=9007199254740991)return i=Te(a,s,t,n),A.s<0?new a(1).div(i):Fe(i,n,r);if((o=s.s)<0){if(e<A.d.length-1)return new a(NaN);if(0==(1&A.d[e])&&(o=1),0==s.e&&1==s.d[0]&&1==s.d.length)return s.s=o,s}return(e=0!=(t=ce(+s,B))&&isFinite(t)?new a(t+"").e:Be(B*(Math.log("0."+Ie(s.d))/Math.LN10+s.e+1)))>a.maxE+1||e<a.minE-1?new a(e>0?o/0:0):(ne=!1,a.rounding=s.s=1,t=Math.min(12,(e+"").length),(i=Ge(A.times(Se(s,n+t)),n)).d&&de((i=Fe(i,n+5,1)).d,n,r)&&(e=n+10,+Ie((i=Fe(Ge(A.times(Se(s,e+t)),e),e+5,1)).d).slice(n+1,n+15)+1==1e14&&(i=Fe(i,n+1,0))),i.s=o,ne=!0,a.rounding=r,Fe(i,n,r))},Ce.toPrecision=function(A,e){var t,n=this,i=n.constructor;return void 0===A?t=De(n,n.e<=i.toExpNeg||n.e>=i.toExpPos):(Me(A,1,qA),void 0===e?e=i.rounding:Me(e,0,8),t=De(n=Fe(new i(n),A,e),A<=n.e||n.e<=i.toExpNeg,A)),n.isNeg()&&!n.isZero()?"-"+t:t},Ce.toSignificantDigits=Ce.toSD=function(A,e){var t=this.constructor;return void 0===A?(A=t.precision,e=t.rounding):(Me(A,1,qA),void 0===e?e=t.rounding:Me(e,0,8)),Fe(new t(this),A,e)},Ce.toString=function(){var A=this,e=A.constructor,t=De(A,A.e<=e.toExpNeg||A.e>=e.toExpPos);return A.isNeg()&&!A.isZero()?"-"+t:t},Ce.truncated=Ce.trunc=function(){return Fe(new this.constructor(this),this.e+1,1)},Ce.valueOf=Ce.toJSON=function(){var A=this,e=A.constructor,t=De(A,A.e<=e.toExpNeg||A.e>=e.toExpPos);return A.isNeg()?"-"+t:t};var pe=function(){function A(A,e,t){var n,i=0,r=A.length;for(A=A.slice();r--;)n=A[r]*e+i,A[r]=n%t|0,i=n/t|0;return i&&A.unshift(i),A}function e(A,e,t,n){var i,r;if(t!=n)r=t>n?1:-1;else for(i=r=0;i<t;i++)if(A[i]!=e[i]){r=A[i]>e[i]?1:-1;break}return r}function t(A,e,t,n){for(var i=0;t--;)A[t]-=i,i=A[t]<e[t]?1:0,A[t]=i*n+A[t]-e[t];for(;!A[0]&&A.length>1;)A.shift()}return function(n,i,r,o,s,a){var B,c,g,E,Q,u,l,w,h,C,I,M,d,m,p,F,D,Y,f,N,U=n.constructor,y=n.s==i.s?1:-1,T=n.d,x=i.d;if(!(T&&T[0]&&x&&x[0]))return new U(n.s&&i.s&&(T?!x||T[0]!=x[0]:x)?T&&0==T[0]||!x?0*y:y/0:NaN);for(a?(Q=1,c=n.e-i.e):(a=le,Q=7,c=Be(n.e/Q)-Be(i.e/Q)),f=x.length,D=T.length,C=(h=new U(y)).d=[],g=0;x[g]==(T[g]||0);g++);if(x[g]>(T[g]||0)&&c--,null==r?(m=r=U.precision,o=U.rounding):m=s?r+(n.e-i.e)+1:r,m<0)C.push(1),u=!0;else{if(m=m/Q+2|0,g=0,1==f){for(E=0,x=x[0],m++;(g<D||E)&&m--;g++)p=E*a+(T[g]||0),C[g]=p/x|0,E=p%x|0;u=E||g<D}else{for((E=a/(x[0]+1)|0)>1&&(x=A(x,E,a),T=A(T,E,a),f=x.length,D=T.length),F=f,M=(I=T.slice(0,f)).length;M<f;)I[M++]=0;(N=x.slice()).unshift(0),Y=x[0],x[1]>=a/2&&++Y;do{E=0,(B=e(x,I,f,M))<0?(d=I[0],f!=M&&(d=d*a+(I[1]||0)),(E=d/Y|0)>1?(E>=a&&(E=a-1),1==(B=e(l=A(x,E,a),I,w=l.length,M=I.length))&&(E--,t(l,f<w?N:x,w,a))):(0==E&&(B=E=1),l=x.slice()),(w=l.length)<M&&l.unshift(0),t(I,l,M,a),-1==B&&(B=e(x,I,f,M=I.length))<1&&(E++,t(I,f<M?N:x,M,a)),M=I.length):0===B&&(E++,I=[0]),C[g++]=E,B&&I[0]?I[M++]=T[F]||0:(I=[T[F]],M=1)}while((F++<D||void 0!==I[0])&&m--);u=void 0!==I[0]}C[0]||C.shift()}if(1==Q)h.e=c,KA=u;else{for(g=1,E=C[0];E>=10;E/=10)g++;h.e=g+c*Q-1,Fe(h,s?r+h.e+1:r,o,u)}return h}}();function Fe(A,e,t,n){var i,r,o,s,a,B,c,g,E,Q=A.constructor;A:if(null!=e){if(!(g=A.d))return A;for(i=1,s=g[0];s>=10;s/=10)i++;if((r=e-i)<0)r+=7,o=e,a=(c=g[E=0])/ce(10,i-o-1)%10|0;else if((E=Math.ceil((r+1)/7))>=(s=g.length)){if(!n)break A;for(;s++<=E;)g.push(0);c=a=0,i=1,o=(r%=7)-7+1}else{for(c=s=g[E],i=1;s>=10;s/=10)i++;a=(o=(r%=7)-7+i)<0?0:c/ce(10,i-o-1)%10|0}if(n=n||e<0||void 0!==g[E+1]||(o<0?c:c%ce(10,i-o-1)),B=t<4?(a||n)&&(0==t||t==(A.s<0?3:2)):a>5||5==a&&(4==t||n||6==t&&(r>0?o>0?c/ce(10,i-o):0:g[E-1])%10&1||t==(A.s<0?8:7)),e<1||!g[0])return g.length=0,B?(e-=A.e+1,g[0]=ce(10,(7-e%7)%7),A.e=-e||0):g[0]=A.e=0,A;if(0==r?(g.length=E,s=1,E--):(g.length=E+1,s=ce(10,7-r),g[E]=o>0?(c/ce(10,i-o)%ce(10,o)|0)*s:0),B)for(;;){if(0==E){for(r=1,o=g[0];o>=10;o/=10)r++;for(o=g[0]+=s,s=1;o>=10;o/=10)s++;r!=s&&(A.e++,g[0]==le&&(g[0]=1));break}if(g[E]+=s,g[E]!=le)break;g[E--]=0,s=1}for(r=g.length;0===g[--r];)g.pop()}return ne&&(A.e>Q.maxE?(A.d=null,A.e=NaN):A.e<Q.minE&&(A.e=0,A.d=[0])),A}function De(A,e,t){if(!A.isFinite())return He(A);var n,i=A.e,r=Ie(A.d),o=r.length;return e?(t&&(n=t-o)>0?r=r.charAt(0)+"."+r.slice(1)+ye(n):o>1&&(r=r.charAt(0)+"."+r.slice(1)),r=r+(A.e<0?"e":"e+")+A.e):i<0?(r="0."+ye(-i-1)+r,t&&(n=t-o)>0&&(r+=ye(n))):i>=o?(r+=ye(i+1-o),t&&(n=t-i-1)>0&&(r=r+"."+ye(n))):((n=i+1)<o&&(r=r.slice(0,n)+"."+r.slice(n)),t&&(n=t-o)>0&&(i+1===o&&(r+="."),r+=ye(n))),r}function Ye(A,e){var t=A[0];for(e*=7;t>=10;t/=10)e++;return e}function fe(A,e,t){if(e>we)throw ne=!0,t&&(A.precision=t),Error(oe);return Fe(new A(Ae),e,1,!0)}function Ne(A,e,t){if(e>he)throw Error(oe);return Fe(new A(ee),e,t,!0)}function Ue(A){var e=A.length-1,t=7*e+1;if(e=A[e]){for(;e%10==0;e/=10)t--;for(e=A[0];e>=10;e/=10)t++}return t}function ye(A){for(var e="";A--;)e+="0";return e}function Te(A,e,t,n){var i,r=new A(1),o=Math.ceil(n/7+4);for(ne=!1;;){if(t%2&&ze((r=r.times(e)).d,o)&&(i=!0),0===(t=Be(t/2))){t=r.d.length-1,i&&0===r.d[t]&&++r.d[t];break}ze((e=e.times(e)).d,o)}return ne=!0,r}function xe(A){return 1&A.d[A.d.length-1]}function Re(A,e,t){for(var n,i=new A(e[0]),r=0;++r<e.length;){if(!(n=new A(e[r])).s){i=n;break}i[t](n)&&(i=n)}return i}function Ge(A,e){var t,n,i,r,o,s,a,B=0,c=0,g=0,E=A.constructor,Q=E.rounding,u=E.precision;if(!A.d||!A.d[0]||A.e>17)return new E(A.d?A.d[0]?A.s<0?0:1/0:1:A.s?A.s<0?0:A:NaN);for(null==e?(ne=!1,a=u):a=e,s=new E(.03125);A.e>-2;)A=A.times(s),g+=5;for(a+=n=Math.log(ce(2,g))/Math.LN10*2+5|0,t=r=o=new E(1),E.precision=a;;){if(r=Fe(r.times(A),a,1),t=t.times(++c),Ie((s=o.plus(pe(r,t,a,1))).d).slice(0,a)===Ie(o.d).slice(0,a)){for(i=g;i--;)o=Fe(o.times(o),a,1);if(null!=e)return E.precision=u,o;if(!(B<3&&de(o.d,a-n,Q,B)))return Fe(o,E.precision=u,Q,ne=!0);E.precision=a+=10,t=r=s=new E(1),c=0,B++}o=s}}function Se(A,e){var t,n,i,r,o,s,a,B,c,g,E,Q=1,u=A,l=u.d,w=u.constructor,h=w.rounding,C=w.precision;if(u.s<0||!l||!l[0]||!u.e&&1==l[0]&&1==l.length)return new w(l&&!l[0]?-1/0:1!=u.s?NaN:l?0:u);if(null==e?(ne=!1,c=C):c=e,w.precision=c+=10,n=(t=Ie(l)).charAt(0),!(Math.abs(r=u.e)<15e14))return B=fe(w,c+2,C).times(r+""),u=Se(new w(n+"."+t.slice(1)),c-10).plus(B),w.precision=C,null==e?Fe(u,C,h,ne=!0):u;for(;n<7&&1!=n||1==n&&t.charAt(1)>3;)n=(t=Ie((u=u.times(A)).d)).charAt(0),Q++;for(r=u.e,n>1?(u=new w("0."+t),r++):u=new w(n+"."+t.slice(1)),g=u,a=o=u=pe(u.minus(1),u.plus(1),c,1),E=Fe(u.times(u),c,1),i=3;;){if(o=Fe(o.times(E),c,1),Ie((B=a.plus(pe(o,new w(i),c,1))).d).slice(0,c)===Ie(a.d).slice(0,c)){if(a=a.times(2),0!==r&&(a=a.plus(fe(w,c+2,C).times(r+""))),a=pe(a,new w(Q),c,1),null!=e)return w.precision=C,a;if(!de(a.d,c-10,h,s))return Fe(a,w.precision=C,h,ne=!0);w.precision=c+=10,B=o=u=pe(g.minus(1),g.plus(1),c,1),E=Fe(u.times(u),c,1),i=s=1}a=B,i+=2}}function He(A){return String(A.s*A.s/0)}function be(A,e){var t,n,i;for((t=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(t<0&&(t=n),t+=+e.slice(n+1),e=e.substring(0,n)):t<0&&(t=e.length),n=0;48===e.charCodeAt(n);n++);for(i=e.length;48===e.charCodeAt(i-1);--i);if(e=e.slice(n,i)){if(i-=n,A.e=t=t-n-1,A.d=[],n=(t+1)%7,t<0&&(n+=7),n<i){for(n&&A.d.push(+e.slice(0,n)),i-=7;n<i;)A.d.push(+e.slice(n,n+=7));n=7-(e=e.slice(n)).length}else n-=i;for(;n--;)e+="0";A.d.push(+e),ne&&(A.e>A.constructor.maxE?(A.d=null,A.e=NaN):A.e<A.constructor.minE&&(A.e=0,A.d=[0]))}else A.e=0,A.d=[0];return A}function ve(A,e,t,n,i){var r,o,s,a,B=A.precision,c=Math.ceil(B/7);for(ne=!1,a=t.times(t),s=new A(n);;){if(o=pe(s.times(a),new A(e++*e++),B,1),s=i?n.plus(o):n.minus(o),n=pe(o.times(a),new A(e++*e++),B,1),void 0!==(o=s.plus(n)).d[c]){for(r=c;o.d[r]===s.d[r]&&r--;);if(-1==r)break}r=s,s=n,n=o,o=r}return ne=!0,o.d.length=c+1,o}function ke(A,e){for(var t=A;--e;)t*=A;return t}function je(A,e){var t,n=e.s<0,i=Ne(A,A.precision,1),r=i.times(.5);if((e=e.abs()).lte(r))return XA=n?4:1,e;if((t=e.divToInt(i)).isZero())XA=n?3:2;else{if((e=e.minus(t.times(i))).lte(r))return XA=xe(t)?n?2:3:n?4:1,e;XA=xe(t)?n?1:4:n?3:2}return e.minus(i).abs()}function Je(A,e,t,n){var i,r,o,s,a,B,c,g,E,Q=A.constructor,u=void 0!==t;if(u?(Me(t,1,qA),void 0===n?n=Q.rounding:Me(n,0,8)):(t=Q.precision,n=Q.rounding),A.isFinite()){for(u?(i=2,16==e?t=4*t-3:8==e&&(t=3*t-2)):i=e,(o=(c=De(A)).indexOf("."))>=0&&(c=c.replace(".",""),(E=new Q(1)).e=c.length-o,E.d=me(De(E),10,i),E.e=E.d.length),r=a=(g=me(c,10,i)).length;0==g[--a];)g.pop();if(g[0]){if(o<0?r--:((A=new Q(A)).d=g,A.e=r,g=(A=pe(A,E,t,n,0,i)).d,r=A.e,B=KA),o=g[t],s=i/2,B=B||void 0!==g[t+1],B=n<4?(void 0!==o||B)&&(0===n||n===(A.s<0?3:2)):o>s||o===s&&(4===n||B||6===n&&1&g[t-1]||n===(A.s<0?8:7)),g.length=t,B)for(;++g[--t]>i-1;)g[t]=0,t||(++r,g.unshift(1));for(a=g.length;!g[a-1];--a);for(o=0,c="";o<a;o++)c+=$A.charAt(g[o]);if(u){if(a>1)if(16==e||8==e){for(o=16==e?4:3,--a;a%o;a++)c+="0";for(a=(g=me(c,i,e)).length;!g[a-1];--a);for(o=1,c="1.";o<a;o++)c+=$A.charAt(g[o])}else c=c.charAt(0)+"."+c.slice(1);c=c+(r<0?"p":"p+")+r}else if(r<0){for(;++r;)c="0"+c;c="0."+c}else if(++r>a)for(r-=a;r--;)c+="0";else r<a&&(c=c.slice(0,r)+"."+c.slice(r))}else c=u?"0p+0":"0";c=(16==e?"0x":2==e?"0b":8==e?"0o":"")+c}else c=He(A);return A.s<0?"-"+c:c}function ze(A,e){if(A.length>e)return A.length=e,!0}function Le(A){return new this(A).abs()}function Pe(A){return new this(A).acos()}function Oe(A){return new this(A).acosh()}function Ve(A,e){return new this(A).plus(e)}function We(A){return new this(A).asin()}function Ke(A){return new this(A).asinh()}function Xe(A){return new this(A).atan()}function Ze(A){return new this(A).atanh()}function _e(A,e){A=new this(A),e=new this(e);var t,n=this.precision,i=this.rounding,r=n+4;return A.s&&e.s?A.d||e.d?!e.d||A.isZero()?(t=e.s<0?Ne(this,n,i):new this(0)).s=A.s:!A.d||e.isZero()?(t=Ne(this,r,1).times(.5)).s=A.s:e.s<0?(this.precision=r,this.rounding=1,t=this.atan(pe(A,e,r,1)),e=Ne(this,r,1),this.precision=n,this.rounding=i,t=A.s<0?t.minus(e):t.plus(e)):t=this.atan(pe(A,e,r,1)):(t=Ne(this,r,1).times(e.s>0?.25:.75)).s=A.s:t=new this(NaN),t}function qe(A){return new this(A).cbrt()}function $e(A){return Fe(A=new this(A),A.e+1,2)}function At(A,e,t){return new this(A).clamp(e,t)}function et(A){if(!A||"object"!=typeof A)throw Error(ie+"Object expected");var e,t,n,i=!0===A.defaults,r=["precision",1,qA,"rounding",0,8,"toExpNeg",-_A,0,"toExpPos",0,_A,"maxE",0,_A,"minE",-_A,0,"modulo",0,9];for(e=0;e<r.length;e+=3)if(t=r[e],i&&(this[t]=te[t]),void 0!==(n=A[t])){if(!(Be(n)===n&&n>=r[e+1]&&n<=r[e+2]))throw Error(re+t+": "+n);this[t]=n}if(t="crypto",i&&(this[t]=te[t]),void 0!==(n=A[t])){if(!0!==n&&!1!==n&&0!==n&&1!==n)throw Error(re+t+": "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw Error(se);this[t]=!0}else this[t]=!1}return this}function tt(A){return new this(A).cos()}function nt(A){return new this(A).cosh()}function it(A,e){return new this(A).div(e)}function rt(A){return new this(A).exp()}function ot(A){return Fe(A=new this(A),A.e+1,3)}function st(){var A,e,t=new this(0);for(ne=!1,A=0;A<arguments.length;)if((e=new this(arguments[A++])).d)t.d&&(t=t.plus(e.times(e)));else{if(e.s)return ne=!0,new this(1/0);t=e}return ne=!0,t.sqrt()}function at(A){return A instanceof Ut||A&&A.toStringTag===ae||!1}function Bt(A){return new this(A).ln()}function ct(A,e){return new this(A).log(e)}function gt(A){return new this(A).log(2)}function Et(A){return new this(A).log(10)}function Qt(){return Re(this,arguments,"lt")}function ut(){return Re(this,arguments,"gt")}function lt(A,e){return new this(A).mod(e)}function wt(A,e){return new this(A).mul(e)}function ht(A,e){return new this(A).pow(e)}function Ct(A){var e,t,n,i,r=0,o=new this(1),s=[];if(void 0===A?A=this.precision:Me(A,1,qA),n=Math.ceil(A/7),this.crypto)if(crypto.getRandomValues)for(e=crypto.getRandomValues(new Uint32Array(n));r<n;)(i=e[r])>=429e7?e[r]=crypto.getRandomValues(new Uint32Array(1))[0]:s[r++]=i%1e7;else{if(!crypto.randomBytes)throw Error(se);for(e=crypto.randomBytes(n*=4);r<n;)(i=e[r]+(e[r+1]<<8)+(e[r+2]<<16)+((127&e[r+3])<<24))>=214e7?crypto.randomBytes(4).copy(e,r):(s.push(i%1e7),r+=4);r=n/4}else for(;r<n;)s[r++]=1e7*Math.random()|0;for(A%=7,(n=s[--r])&&A&&(i=ce(10,7-A),s[r]=(n/i|0)*i);0===s[r];r--)s.pop();if(r<0)t=0,s=[0];else{for(t=-1;0===s[0];t-=7)s.shift();for(n=1,i=s[0];i>=10;i/=10)n++;n<7&&(t-=7-n)}return o.e=t,o.d=s,o}function It(A){return Fe(A=new this(A),A.e+1,this.rounding)}function Mt(A){return(A=new this(A)).d?A.d[0]?A.s:0*A.s:A.s||NaN}function dt(A){return new this(A).sin()}function mt(A){return new this(A).sinh()}function pt(A){return new this(A).sqrt()}function Ft(A,e){return new this(A).sub(e)}function Dt(){var A=0,e=arguments,t=new this(e[A]);for(ne=!1;t.s&&++A<e.length;)t=t.plus(e[A]);return ne=!0,Fe(t,this.precision,this.rounding)}function Yt(A){return new this(A).tan()}function ft(A){return new this(A).tanh()}function Nt(A){return Fe(A=new this(A),A.e+1,1)}Ce[Symbol.for("nodejs.util.inspect.custom")]=Ce.toString,Ce[Symbol.toStringTag]="Decimal";var Ut=Ce.constructor=function A(e){var t,n,i;function r(A){var e,t,n,i=this;if(!(i instanceof r))return new r(A);if(i.constructor=r,at(A))return i.s=A.s,void(ne?!A.d||A.e>r.maxE?(i.e=NaN,i.d=null):A.e<r.minE?(i.e=0,i.d=[0]):(i.e=A.e,i.d=A.d.slice()):(i.e=A.e,i.d=A.d?A.d.slice():A.d));if("number"==(n=typeof A)){if(0===A)return i.s=1/A<0?-1:1,i.e=0,void(i.d=[0]);if(A<0?(A=-A,i.s=-1):i.s=1,A===~~A&&A<1e7){for(e=0,t=A;t>=10;t/=10)e++;return void(ne?e>r.maxE?(i.e=NaN,i.d=null):e<r.minE?(i.e=0,i.d=[0]):(i.e=e,i.d=[A]):(i.e=e,i.d=[A]))}return 0*A!=0?(A||(i.s=NaN),i.e=NaN,void(i.d=null)):be(i,A.toString())}if("string"!==n)throw Error(re+A);return 45===(t=A.charCodeAt(0))?(A=A.slice(1),i.s=-1):(43===t&&(A=A.slice(1)),i.s=1),ue.test(A)?be(i,A):function(A,e){var t,n,i,r,o,s,a,B,c;if(e.indexOf("_")>-1){if(e=e.replace(/(\d)_(?=\d)/g,"$1"),ue.test(e))return be(A,e)}else if("Infinity"===e||"NaN"===e)return+e||(A.s=NaN),A.e=NaN,A.d=null,A;if(Ee.test(e))t=16,e=e.toLowerCase();else if(ge.test(e))t=2;else{if(!Qe.test(e))throw Error(re+e);t=8}for((r=e.search(/p/i))>0?(a=+e.slice(r+1),e=e.substring(2,r)):e=e.slice(2),o=(r=e.indexOf("."))>=0,n=A.constructor,o&&(r=(s=(e=e.replace(".","")).length)-r,i=Te(n,new n(t),r,2*r)),r=c=(B=me(e,t,le)).length-1;0===B[r];--r)B.pop();return r<0?new n(0*A.s):(A.e=Ye(B,c),A.d=B,ne=!1,o&&(A=pe(A,i,4*s)),a&&(A=A.times(Math.abs(a)<54?ce(2,a):Ut.pow(2,a))),ne=!0,A)}(i,A)}if(r.prototype=Ce,r.ROUND_UP=0,r.ROUND_DOWN=1,r.ROUND_CEIL=2,r.ROUND_FLOOR=3,r.ROUND_HALF_UP=4,r.ROUND_HALF_DOWN=5,r.ROUND_HALF_EVEN=6,r.ROUND_HALF_CEIL=7,r.ROUND_HALF_FLOOR=8,r.EUCLID=9,r.config=r.set=et,r.clone=A,r.isDecimal=at,r.abs=Le,r.acos=Pe,r.acosh=Oe,r.add=Ve,r.asin=We,r.asinh=Ke,r.atan=Xe,r.atanh=Ze,r.atan2=_e,r.cbrt=qe,r.ceil=$e,r.clamp=At,r.cos=tt,r.cosh=nt,r.div=it,r.exp=rt,r.floor=ot,r.hypot=st,r.ln=Bt,r.log=ct,r.log10=Et,r.log2=gt,r.max=Qt,r.min=ut,r.mod=lt,r.mul=wt,r.pow=ht,r.random=Ct,r.round=It,r.sign=Mt,r.sin=dt,r.sinh=mt,r.sqrt=pt,r.sub=Ft,r.sum=Dt,r.tan=Yt,r.tanh=ft,r.trunc=Nt,void 0===e&&(e={}),e&&!0!==e.defaults)for(i=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],t=0;t<i.length;)e.hasOwnProperty(n=i[t++])||(e[n]=this[n]);return r.config(e),r}(te);Ae=new Ut(Ae),ee=new Ut(ee);const yt=Ut;var Tt=mA("BigNumber",["?on","config"],(function(A){var e=A.on,t=A.config,n=yt.clone({precision:t.precision,modulo:yt.EUCLID});return n.prototype=Object.create(n.prototype),n.prototype.type="BigNumber",n.prototype.isBigNumber=!0,n.prototype.toJSON=function(){return{mathjs:"BigNumber",value:this.toString()}},n.fromJSON=function(A){return new n(A.value)},e&&e("config",(function(A,e){A.precision!==e.precision&&n.config({precision:A.precision})})),n}),{isClass:!0}),xt=n(1977),Rt=mA("Complex",[],(function(){return Object.defineProperty(xt,"name",{value:"Complex"}),xt.prototype.constructor=xt,xt.prototype.type="Complex",xt.prototype.isComplex=!0,xt.prototype.toJSON=function(){return{mathjs:"Complex",re:this.re,im:this.im}},xt.prototype.toPolar=function(){return{r:this.abs(),phi:this.arg()}},xt.prototype.format=function(A){var e=this.im,n=this.re,i=AA(this.re,A),r=AA(this.im,A),o=t(A)?A:A?A.precision:null;if(null!==o){var s=Math.pow(10,-o);Math.abs(n/e)<s&&(n=0),Math.abs(e/n)<s&&(e=0)}return 0===e?i:0===n?1===e?"i":-1===e?"-i":r+"i":e<0?-1===e?i+" - i":i+" - "+r.substring(1)+"i":1===e?i+" + i":i+" + "+r+"i"},xt.fromPolar=function(A){switch(arguments.length){case 1:var n=arguments[0];if("object"===e(n))return xt(n);throw new TypeError("Input has to be an object with r and phi keys.");case 2:var i=arguments[0],r=arguments[1];if(t(i)){if(a(r)&&r.hasBase("ANGLE")&&(r=r.toNumber("rad")),t(r))return new xt({r:i,phi:r});throw new TypeError("Phi is not a number nor an angle unit.")}throw new TypeError("Radius r is not a number.");default:throw new SyntaxError("Wrong number of arguments in function fromPolar")}},xt.prototype.valueOf=xt.prototype.toString,xt.fromJSON=function(A){return new xt(A)},xt.compare=function(A,e){return A.re>e.re?1:A.re<e.re?-1:A.im>e.im?1:A.im<e.im?-1:0},xt}),{isClass:!0}),Gt=n(5628),St=mA("Fraction",[],(function(){return Object.defineProperty(Gt,"name",{value:"Fraction"}),Gt.prototype.constructor=Gt,Gt.prototype.type="Fraction",Gt.prototype.isFraction=!0,Gt.prototype.toJSON=function(){return{mathjs:"Fraction",n:this.s*this.n,d:this.d}},Gt.fromJSON=function(A){return new Gt(A)},Gt}),{isClass:!0}),Ht=(n(3964),mA("Range",[],(function(){function A(e,t,n){if(!(this instanceof A))throw new SyntaxError("Constructor must be called with the new operator");var i=null!=e,o=null!=t,s=null!=n;if(i)if(r(e))e=e.toNumber();else if("number"!=typeof e)throw new TypeError("Parameter start must be a number");if(o)if(r(t))t=t.toNumber();else if("number"!=typeof t)throw new TypeError("Parameter end must be a number");if(s)if(r(n))n=n.toNumber();else if("number"!=typeof n)throw new TypeError("Parameter step must be a number");this.start=i?parseFloat(e):0,this.end=o?parseFloat(t):0,this.step=s?parseFloat(n):1}return A.prototype.type="Range",A.prototype.isRange=!0,A.parse=function(e){if("string"!=typeof e)return null;var t=e.split(":").map((function(A){return parseFloat(A)}));if(t.some((function(A){return isNaN(A)})))return null;switch(t.length){case 2:return new A(t[0],t[1]);case 3:return new A(t[0],t[2],t[1]);default:return null}},A.prototype.clone=function(){return new A(this.start,this.end,this.step)},A.prototype.size=function(){var A=0,e=this.start,t=this.step,n=this.end-e;return W(t)===W(n)?A=Math.ceil(n/t):0===n&&(A=0),isNaN(A)&&(A=0),[A]},A.prototype.min=function(){var A=this.size()[0];return A>0?this.step>0?this.start:this.start+(A-1)*this.step:void 0},A.prototype.max=function(){var A=this.size()[0];return A>0?this.step>0?this.start+(A-1)*this.step:this.start:void 0},A.prototype.forEach=function(A){var e=this.start,t=this.step,n=this.end,i=0;if(t>0)for(;e<n;)A(e,[i],this),e+=t,i++;else if(t<0)for(;e>n;)A(e,[i],this),e+=t,i++},A.prototype.map=function(A){var e=[];return this.forEach((function(t,n,i){e[n[0]]=A(t,n,i)})),e},A.prototype.toArray=function(){var A=[];return this.forEach((function(e,t){A[t[0]]=e})),A},A.prototype.valueOf=function(){return this.toArray()},A.prototype.format=function(A){var e=AA(this.start,A);return 1!==this.step&&(e+=":"+AA(this.step,A)),e+":"+AA(this.end,A)},A.prototype.toString=function(){return this.format()},A.prototype.toJSON=function(){return{mathjs:"Range",start:this.start,end:this.end,step:this.step}},A.fromJSON=function(e){return new A(e.start,e.end,e.step)},A}),{isClass:!0})),bt=mA("Matrix",[],(function(){function A(){if(!(this instanceof A))throw new SyntaxError("Constructor must be called with the new operator")}return A.prototype.type="Matrix",A.prototype.isMatrix=!0,A.prototype.storage=function(){throw new Error("Cannot invoke storage on a Matrix interface")},A.prototype.datatype=function(){throw new Error("Cannot invoke datatype on a Matrix interface")},A.prototype.create=function(A,e){throw new Error("Cannot invoke create on a Matrix interface")},A.prototype.subset=function(A,e,t){throw new Error("Cannot invoke subset on a Matrix interface")},A.prototype.get=function(A){throw new Error("Cannot invoke get on a Matrix interface")},A.prototype.set=function(A,e,t){throw new Error("Cannot invoke set on a Matrix interface")},A.prototype.resize=function(A,e){throw new Error("Cannot invoke resize on a Matrix interface")},A.prototype.reshape=function(A,e){throw new Error("Cannot invoke reshape on a Matrix interface")},A.prototype.clone=function(){throw new Error("Cannot invoke clone on a Matrix interface")},A.prototype.size=function(){throw new Error("Cannot invoke size on a Matrix interface")},A.prototype.map=function(A,e){throw new Error("Cannot invoke map on a Matrix interface")},A.prototype.forEach=function(A){throw new Error("Cannot invoke forEach on a Matrix interface")},A.prototype[Symbol.iterator]=function(){throw new Error("Cannot iterate a Matrix interface")},A.prototype.toArray=function(){throw new Error("Cannot invoke toArray on a Matrix interface")},A.prototype.valueOf=function(){throw new Error("Cannot invoke valueOf on a Matrix interface")},A.prototype.format=function(A){throw new Error("Cannot invoke format on a Matrix interface")},A.prototype.toString=function(){throw new Error("Cannot invoke toString on a Matrix interface")},A}),{isClass:!0}),vt=n(4687);function kt(){return(kt=Object.assign?Object.assign.bind():function(A){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(A[n]=t[n])}return A}).apply(this,arguments)}function jt(A,e){(null==e||e>A.length)&&(e=A.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=A[t];return n}function Jt(A,e){if(A){if("string"==typeof A)return jt(A,e);var t=Object.prototype.toString.call(A).slice(8,-1);return"Object"===t&&A.constructor&&(t=A.constructor.name),"Map"===t||"Set"===t?Array.from(A):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?jt(A,e):void 0}}function zt(A){return function(A){if(Array.isArray(A))return jt(A)}(A)||function(A){if("undefined"!=typeof Symbol&&null!=A[Symbol.iterator]||null!=A["@@iterator"])return Array.from(A)}(A)||Jt(A)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lt(A,e,t){var n=new(0,A.constructor)(2),i="";if(t){if(t<1)throw new Error("size must be in greater than 0");if(!V(t))throw new Error("size must be an integer");if(A.greaterThan(n.pow(t-1).sub(1))||A.lessThan(n.pow(t-1).mul(-1)))throw new Error("Value must be in range [-2^".concat(t-1,", 2^").concat(t-1,"-1]"));if(!A.isInteger())throw new Error("Value must be an integer");A.lessThan(0)&&(A=A.add(n.pow(t))),i="i".concat(t)}switch(e){case 2:return"".concat(A.toBinary()).concat(i);case 8:return"".concat(A.toOctal()).concat(i);case 16:return"".concat(A.toHexadecimal()).concat(i);default:throw new Error("Base ".concat(e," not supported "))}}function Pt(A,e){return void 0!==e?A.toExponential(e-1):A.toExponential()}function Ot(A,e){var t=A.length-e.length,n=A.length;return A.substring(t,n)===e}function Vt(A,t){var n=function(A,t){return"number"==typeof A?AA(A,t):r(A)?function(A,e){if("function"==typeof e)return e(A);if(!A.isFinite())return A.isNaN()?"NaN":A.gt(0)?"Infinity":"-Infinity";var t,n,i="auto";if(void 0!==e&&(e.notation&&(i=e.notation),"number"==typeof e?t=e:void 0!==e.precision&&(t=e.precision),e.wordSize&&"number"!=typeof(n=e.wordSize)))throw new Error('Option "wordSize" must be a number');switch(i){case"fixed":return function(A,e){return A.toFixed(e)}(A,t);case"exponential":return Pt(A,t);case"engineering":return function(A,e){var t=A.e,n=t%3==0?t:t<0?t-3-t%3:t-t%3,i=A.mul(Math.pow(10,-n)).toPrecision(e);return-1!==i.indexOf("e")&&(i=new(0,A.constructor)(i).toFixed()),i+"e"+(t>=0?"+":"")+n.toString()}(A,t);case"bin":return Lt(A,2,n);case"oct":return Lt(A,8,n);case"hex":return Lt(A,16,n);case"auto":var r=e&&void 0!==e.lowerExp?e.lowerExp:-3,o=e&&void 0!==e.upperExp?e.upperExp:5;if(A.isZero())return"0";var s=A.toSignificantDigits(t),a=s.e;return(a>=r&&a<o?s.toFixed():Pt(A,t)).replace(/((\.\d*?)(0+))($|e)/,(function(){var A=arguments[2],e=arguments[4];return"."!==A?A+e:e}));default:throw new Error('Unknown notation "'+i+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}(A,t):function(A){return A&&"object"===e(A)&&"number"==typeof A.s&&"number"==typeof A.n&&"number"==typeof A.d||!1}(A)?t&&"decimal"===t.fraction?A.toString():A.s*A.n+"/"+A.d:Array.isArray(A)?function A(e,t){if(Array.isArray(e)){for(var n="[",i=e.length,r=0;r<i;r++)0!==r&&(n+=", "),n+=A(e[r],t);return n+"]"}return Vt(e,t)}(A,t):B(A)?Wt(A):"function"==typeof A?A.syntax?String(A.syntax):"function":A&&"object"===e(A)?"function"==typeof A.format?A.format(t):A&&A.toString(t)!=={}.toString()?A.toString(t):"{"+Object.keys(A).map((function(e){return Wt(e)+": "+Vt(A[e],t)})).join(", ")+"}":String(A)}(A,t);return t&&"object"===e(t)&&"truncate"in t&&n.length>t.truncate?n.substring(0,t.truncate-3)+"...":n}function Wt(A){for(var e=String(A),t="",n=0;n<e.length;){var i=e.charAt(n);t+=i in Kt?Kt[i]:i,n++}return'"'+t+'"'}n(278),n(7895),n(7729),n(7389),n(5284);var Kt={'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t"};function Xt(A){return String(A).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Zt(A,e){if(!B(A))throw new TypeError("Unexpected type of argument in function compareText (expected: string or Array or Matrix, actual: "+P(A)+", index: 0)");if(!B(e))throw new TypeError("Unexpected type of argument in function compareText (expected: string or Array or Matrix, actual: "+P(e)+", index: 1)");return A===e?0:A>e?1:-1}function _t(A,e,t){if(!(this instanceof _t))throw new SyntaxError("Constructor must be called with the new operator");this.actual=A,this.expected=e,this.relation=t,this.message="Dimension mismatch ("+(Array.isArray(A)?"["+A.join(", ")+"]":A)+" "+(this.relation||"!=")+" "+(Array.isArray(e)?"["+e.join(", ")+"]":e)+")",this.stack=(new Error).stack}function qt(A,e,t){if(!(this instanceof qt))throw new SyntaxError("Constructor must be called with the new operator");this.index=A,arguments.length<3?(this.min=0,this.max=e):(this.min=e,this.max=t),void 0!==this.min&&this.index<this.min?this.message="Index out of range ("+this.index+" < "+this.min+")":void 0!==this.max&&this.index>=this.max?this.message="Index out of range ("+this.index+" > "+(this.max-1)+")":this.message="Index out of range ("+this.index+")",this.stack=(new Error).stack}function $t(A){for(var e=[];Array.isArray(A);)e.push(A.length),A=A[0];return e}function An(A,e){if(0===e.length){if(Array.isArray(A))throw new _t(A.length,0)}else!function A(e,t,n){var i,r=e.length;if(r!==t[n])throw new _t(r,t[n]);if(n<t.length-1){var o=n+1;for(i=0;i<r;i++){var s=e[i];if(!Array.isArray(s))throw new _t(t.length-1,t.length,"<");A(e[i],t,o)}}else for(i=0;i<r;i++)if(Array.isArray(e[i]))throw new _t(t.length+1,t.length,">")}(A,e,0)}function en(A,e){var t=A.isMatrix?A._size:$t(A);e._sourceSize.forEach((function(A,e){if(null!==A&&A!==t[e])throw new _t(A,t[e])}))}function tn(A,e){if(void 0!==A){if(!t(A)||!V(A))throw new TypeError("Index must be an integer (value: "+A+")");if(A<0||"number"==typeof e&&A>=e)throw new qt(A,e)}}function nn(A){for(var e=0;e<A._dimensions.length;++e){var t=A._dimensions[e];if(t._data&&c(t._data)){if(0===t._size[0])return!0}else if(t.isRange){if(t.start===t.end)return!0}else if(B(t)&&0===t.length)return!0}return!1}function rn(A,e,n){if(!Array.isArray(e))throw new TypeError("Array expected");if(0===e.length)throw new Error("Resizing to scalar is not supported");return e.forEach((function(A){if(!t(A)||!V(A)||A<0)throw new TypeError("Invalid size, must contain positive integers (size: "+Vt(e)+")")})),(t(A)||r(A))&&(A=[A]),function A(e,t,n,i){var r,o,s=e.length,a=t[n],B=Math.min(s,a);if(e.length=a,n<t.length-1){var c=n+1;for(r=0;r<B;r++)o=e[r],Array.isArray(o)||(o=[o],e[r]=o),A(o,t,c,i);for(r=B;r<a;r++)o=[],e[r]=o,A(o,t,c,i)}else{for(r=0;r<B;r++)for(;Array.isArray(e[r]);)e[r]=e[r][0];for(r=B;r<a;r++)e[r]=i}}(A,e,0,void 0!==n?n:0),A}function on(A,e){var t=gn(A),n=t.length;if(!Array.isArray(A)||!Array.isArray(e))throw new TypeError("Array expected");if(0===e.length)throw new _t(0,n,"!=");var i=an(e=sn(e,n));if(n!==i)throw new _t(i,n,"!=");try{return function(A,e){for(var t,n=A,i=e.length-1;i>0;i--){var r=e[i];t=[];for(var o=n.length/r,s=0;s<o;s++)t.push(n.slice(s*r,(s+1)*r));n=t}return n}(t,e)}catch(A){if(A instanceof _t)throw new _t(i,n,"!=");throw A}}function sn(A,e){var t=an(A),n=A.slice(),i=A.indexOf(-1);if(A.indexOf(-1,i+1)>=0)throw new Error("More than one wildcard in sizes");if(i>=0){if(e%t!=0)throw new Error("Could not replace wildcard, since "+e+" is no multiple of "+-t);n[i]=-e/t}return n}function an(A){return A.reduce((function(A,e){return A*e}),1)}function Bn(A,e){for(var t=e||$t(A);Array.isArray(A)&&1===A.length;)A=A[0],t.shift();for(var n=t.length;1===t[n-1];)n--;return n<t.length&&(A=function A(e,t,n){var i,r;if(n<t){var o=n+1;for(i=0,r=e.length;i<r;i++)e[i]=A(e[i],t,o)}else for(;Array.isArray(e);)e=e[0];return e}(A,n,0),t.length=n),A}function cn(A,e,t,n){var i=n||$t(A);if(t)for(var r=0;r<t;r++)A=[A],i.unshift(1);for(A=function A(e,t,n){var i,r;if(Array.isArray(e)){var o=n+1;for(i=0,r=e.length;i<r;i++)e[i]=A(e[i],t,o)}else for(var s=n;s<t;s++)e=[e];return e}(A,e,0);i.length<e;)i.push(1);return A}function gn(A){if(!Array.isArray(A))return A;var e=[];return A.forEach((function A(t){Array.isArray(t)?t.forEach(A):e.push(t)})),e}function En(A,e){return Array.prototype.map.call(A,e)}function Qn(A,e){Array.prototype.forEach.call(A,e)}function un(A,e){if(1!==$t(A).length)throw new Error("Only one dimensional matrices supported");return Array.prototype.filter.call(A,e)}function ln(A,e){if(1!==$t(A).length)throw new Error("Only one dimensional matrices supported");return Array.prototype.filter.call(A,(function(A){return e.test(A)}))}function wn(A,e){return Array.prototype.join.call(A,e)}function hn(A){if(!Array.isArray(A))throw new TypeError("Array input expected");if(0===A.length)return A;var e=[],t=0;e[0]={value:A[0],identifier:0};for(var n=1;n<A.length;n++)A[n]===A[n-1]?t++:t=0,e.push({value:A[n],identifier:t});return e}function Cn(A){if(!Array.isArray(A))throw new TypeError("Array input expected");if(0===A.length)return A;for(var e=[],t=0;t<A.length;t++)e.push(A[t].value);return e}function In(A,e){for(var t,n=0,i=0;i<A.length;i++){var r=A[i],o=Array.isArray(r);if(0===i&&o&&(n=r.length),o&&r.length!==n)return;var s=o?In(r,e):e(r);if(void 0===t)t=s;else if(t!==s)return"mixed"}return t}function Mn(A,e){return-1!==A.indexOf(e)}function dn(A,e,t,n){if(n<t){if(A.length!==e.length)throw new _t(A.length,e.length);for(var i=[],r=0;r<A.length;r++)i[r]=dn(A[r],e[r],t,n+1);return i}return A.concat(e)}function mn(){var A=Array.prototype.slice.call(arguments,0,-1),e=Array.prototype.slice.call(arguments,-1);if(1===A.length)return A[0];if(A.length>1)return A.slice(1).reduce((function(A,t){return dn(A,t,e,0)}),A[0]);throw new Error("Wrong number of arguments in function concat")}function pn(A,e){for(var t=e.length,n=A.length,i=0;i<n;i++){var r=t-n+i;if(A[i]<e[r]&&A[i]>1||A[i]>e[r])throw new Error("shape missmatch: missmatch is found in arg with shape (".concat(A,") not possible to broadcast dimension ").concat(n," with size ").concat(A[i]," to size ").concat(e[r]))}}function Fn(A,e){var t=$t(A);if(hA(t,e))return A;pn(t,e);var n,i,r,o=function(){for(var A=arguments.length,e=new Array(A),t=0;t<A;t++)e[t]=arguments[t];for(var n=e.map((function(A){return A.length})),i=Math.max.apply(Math,zt(n)),r=new Array(i).fill(null),o=0;o<e.length;o++)for(var s=e[o],a=n[o],B=0;B<a;B++){var c=i-a+B;s[B]>r[c]&&(r[c]=s[B])}for(var g=0;g<e.length;g++)pn(e[g],r);return r}(t,e),s=o.length,a=[].concat(zt(Array(s-t.length).fill(1)),zt(t)),B=function(A){return kt([],A)}(A);t.length<s&&(t=$t(B=on(B,a)));for(var c=0;c<s;c++)t[c]<o[c]&&(n=B,i=o[c],r=c,t=$t(B=mn.apply(void 0,zt(Array(i).fill(n)).concat([r]))));return B}function Dn(A){var e=0,t=1,n=Object.create(null),i=Object.create(null),r=0,o=function(A){var o=i[A];if(o&&(delete n[o],delete i[A],--e,t===o)){if(!e)return r=0,void(t=1);for(;!Object.prototype.hasOwnProperty.call(n,++t););}};return A=Math.abs(A),{hit:function(s){var a=i[s],B=++r;if(n[B]=s,i[s]=B,!a){if(++e<=A)return;return s=n[t],o(s),s}if(delete n[a],t===a)for(;!Object.prototype.hasOwnProperty.call(n,++t););},delete:o,clear:function(){e=r=0,t=1,n=Object.create(null),i=Object.create(null)}}}function Yn(A){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.hasher,i=t.limit;return i=null==i?Number.POSITIVE_INFINITY:i,n=null==n?JSON.stringify:n,function t(){"object"!==e(t.cache)&&(t.cache={values:new Map,lru:Dn(i||Number.POSITIVE_INFINITY)});for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];var s=n(r);if(t.cache.values.has(s))return t.cache.lru.hit(s),t.cache.values.get(s);var a=A.apply(A,r);return t.cache.values.set(s,a),t.cache.values.delete(t.cache.lru.hit(s)),a}}function fn(A){return Object.keys(A.signatures||{}).reduce((function(A,e){var t=(e.match(/,/g)||[]).length+1;return Math.max(A,t)}),-1)}function Nn(A,e){(null==e||e>A.length)&&(e=A.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=A[t];return n}_t.prototype=new RangeError,_t.prototype.constructor=RangeError,_t.prototype.name="DimensionError",_t.prototype.isDimensionError=!0,qt.prototype=new RangeError,qt.prototype.constructor=RangeError,qt.prototype.name="IndexError",qt.prototype.isIndexError=!0,n(8324);var Un=mA("DenseMatrix",["Matrix"],(function(A){var e=A.Matrix;function n(A,e){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(e&&!B(e))throw new Error("Invalid datatype: "+e);if(g(A))"DenseMatrix"===A.type?(this._data=uA(A._data),this._size=uA(A._size),this._datatype=e||A._datatype):(this._data=A.toArray(),this._size=A.size(),this._datatype=e||A._datatype);else if(A&&c(A.data)&&c(A.size))this._data=A.data,this._size=A.size,An(this._data,this._size),this._datatype=e||A.datatype;else if(c(A))this._data=Q(A),this._size=$t(this._data),An(this._data,this._size),this._datatype=e;else{if(A)throw new TypeError("Unsupported type of data ("+P(A)+")");this._data=[],this._size=[0],this._datatype=e}}function i(A,e,t,n){var r=n===t-1,o=e.dimension(n);return r?o.map((function(e){return tn(e,A.length),A[e]})).valueOf():o.map((function(r){return tn(r,A.length),i(A[r],e,t,n+1)})).valueOf()}function o(A,e,t,n,i){var r=i===n-1,s=e.dimension(i);r?s.forEach((function(e,n){tn(e),A[e]=t[n[0]]})):s.forEach((function(r,s){tn(r),o(A[r],e,t[s[0]],n,i+1)}))}function s(A,e,t){if(0===e.length){for(var n=A._data;c(n);)n=n[0];return n}return A._size=e.slice(0),A._data=rn(A._data,A._size,t),A}function a(A,e,t){for(var n=A._size.slice(0),i=!1;n.length<e.length;)n.push(0),i=!0;for(var r=0,o=e.length;r<o;r++)e[r]>n[r]&&(n[r]=e[r],i=!0);i&&s(A,n,t)}function Q(A){return g(A)?Q(A.valueOf()):c(A)?A.map(Q):A}return n.prototype=new e,n.prototype.createDenseMatrix=function(A,e){return new n(A,e)},Object.defineProperty(n,"name",{value:"DenseMatrix"}),n.prototype.constructor=n,n.prototype.type="DenseMatrix",n.prototype.isDenseMatrix=!0,n.prototype.getDataType=function(){return In(this._data,P)},n.prototype.storage=function(){return"dense"},n.prototype.datatype=function(){return this._datatype},n.prototype.create=function(A,e){return new n(A,e)},n.prototype.subset=function(A,e,t){switch(arguments.length){case 1:return function(A,e){if(!w(e))throw new TypeError("Invalid index");if(e.isScalar())return A.get(e.min());var t=e.size();if(t.length!==A._size.length)throw new _t(t.length,A._size.length);for(var r=e.min(),o=e.max(),s=0,a=A._size.length;s<a;s++)tn(r[s],A._size[s]),tn(o[s],A._size[s]);return new n(i(A._data,e,t.length,0),A._datatype)}(this,A);case 2:case 3:return function(A,e,t,n){if(!e||!0!==e.isIndex)throw new TypeError("Invalid index");var i,r=e.size(),s=e.isScalar();if(g(t)?(i=t.size(),t=t.valueOf()):i=$t(t),s){if(0!==i.length)throw new TypeError("Scalar expected");A.set(e.min(),t,n)}else{if(!hA(i,r))try{i=$t(t=0===i.length?Fn([t],r):Fn(t,r))}catch(A){}if(r.length<A._size.length)throw new _t(r.length,A._size.length,"<");if(i.length<r.length){for(var B=0,c=0;1===r[B]&&1===i[B];)B++;for(;1===r[B];)c++,B++;t=cn(t,r.length,c,i)}if(!hA(r,i))throw new _t(r,i,">");a(A,e.max().map((function(A){return A+1})),n);var E=r.length;o(A._data,e,t,E,0)}return A}(this,A,e,t);default:throw new SyntaxError("Wrong number of arguments")}},n.prototype.get=function(A){if(!c(A))throw new TypeError("Array expected");if(A.length!==this._size.length)throw new _t(A.length,this._size.length);for(var e=0;e<A.length;e++)tn(A[e],this._size[e]);for(var t=this._data,n=0,i=A.length;n<i;n++){var r=A[n];tn(r,t.length),t=t[r]}return t},n.prototype.set=function(A,e,t){if(!c(A))throw new TypeError("Array expected");if(A.length<this._size.length)throw new _t(A.length,this._size.length,"<");var n,i,r;a(this,A.map((function(A){return A+1})),t);var o=this._data;for(n=0,i=A.length-1;n<i;n++)tn(r=A[n],o.length),o=o[r];return tn(r=A[A.length-1],o.length),o[r]=e,this},n.prototype.resize=function(A,e,t){if(!E(A))throw new TypeError("Array or Matrix expected");var n=A.valueOf().map((function(A){return Array.isArray(A)&&1===A.length?A[0]:A}));return s(t?this.clone():this,n,e)},n.prototype.reshape=function(A,e){var t=e?this.clone():this;t._data=on(t._data,A);var n=t._size.reduce((function(A,e){return A*e}));return t._size=sn(A,n),t},n.prototype.clone=function(){return new n({data:uA(this._data),size:uA(this._size),datatype:this._datatype})},n.prototype.size=function(){return this._size.slice(0)},n.prototype.map=function(A){var e=this,t=fn(A),i=function n(i,r){return c(i)?i.map((function(A,e){return n(A,r.concat(e))})):1===t?A(i):2===t?A(i,r):A(i,r,e)}(this._data,[]);return new n(i,void 0!==this._datatype?In(i,P):void 0)},n.prototype.forEach=function(A){var e=this;!function t(n,i){c(n)?n.forEach((function(A,e){t(A,i.concat(e))})):A(n,i,e)}(this._data,[])},n.prototype[Symbol.iterator]=vt.mark((function A(){var e;return vt.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:return e=vt.mark((function A(e,t){var n;return vt.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!c(e)){i.next=9;break}n=0;case 2:if(!(n<e.length)){i.next=7;break}return i.delegateYield(A(e[n],t.concat(n)),"t0",4);case 4:n++,i.next=2;break;case 7:i.next=11;break;case 9:return i.next=11,{value:e,index:t};case 11:case"end":return i.stop()}}),A)})),A.delegateYield(e(this._data,[]),"t0",2);case 2:case"end":return A.stop()}}),A,this)})),n.prototype.rows=function(){var A=[];if(2!==this.size().length)throw new TypeError("Rows can only be returned for a 2D matrix.");var e,t=function(A,e){var t="undefined"!=typeof Symbol&&A[Symbol.iterator]||A["@@iterator"];if(!t){if(Array.isArray(A)||(t=function(A,e){if(A){if("string"==typeof A)return Nn(A,e);var t=Object.prototype.toString.call(A).slice(8,-1);return"Object"===t&&A.constructor&&(t=A.constructor.name),"Map"===t||"Set"===t?Array.from(A):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Nn(A,e):void 0}}(A))){t&&(A=t);var n=0,i=function(){};return{s:i,n:function(){return n>=A.length?{done:!0}:{done:!1,value:A[n++]}},e:function(A){throw A},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){t=t.call(A)},n:function(){var A=t.next();return o=A.done,A},e:function(A){s=!0,r=A},f:function(){try{o||null==t.return||t.return()}finally{if(s)throw r}}}}(this._data);try{for(t.s();!(e=t.n()).done;){var i=e.value;A.push(new n([i],this._datatype))}}catch(A){t.e(A)}finally{t.f()}return A},n.prototype.columns=function(){var A=this,e=[],t=this.size();if(2!==t.length)throw new TypeError("Rows can only be returned for a 2D matrix.");for(var i=this._data,r=function(t){var r=i.map((function(A){return[A[t]]}));e.push(new n(r,A._datatype))},o=0;o<t[1];o++)r(o);return e},n.prototype.toArray=function(){return uA(this._data)},n.prototype.valueOf=function(){return this._data},n.prototype.format=function(A){return Vt(this._data,A)},n.prototype.toString=function(){return Vt(this._data)},n.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},n.prototype.diagonal=function(A){if(A){if(r(A)&&(A=A.toNumber()),!t(A)||!V(A))throw new TypeError("The parameter k must be an integer number")}else A=0;for(var e=A>0?A:0,i=A<0?-A:0,o=this._size[0],s=this._size[1],a=Math.min(o-i,s-e),B=[],c=0;c<a;c++)B[c]=this._data[c+i][c+e];return new n({data:B,size:[a],datatype:this._datatype})},n.diagonal=function(A,e,i,o){if(!c(A))throw new TypeError("Array expected, size parameter");if(2!==A.length)throw new Error("Only two dimensions matrix are supported");if(A=A.map((function(A){if(r(A)&&(A=A.toNumber()),!t(A)||!V(A)||A<1)throw new Error("Size values must be positive integers");return A})),i){if(r(i)&&(i=i.toNumber()),!t(i)||!V(i))throw new TypeError("The parameter k must be an integer number")}else i=0;var s,a=i>0?i:0,B=i<0?-i:0,E=A[0],Q=A[1],u=Math.min(E-B,Q-a);if(c(e)){if(e.length!==u)throw new Error("Invalid value array length");s=function(A){return e[A]}}else if(g(e)){var l=e.size();if(1!==l.length||l[0]!==u)throw new Error("Invalid matrix length");s=function(A){return e.get([A])}}else s=function(){return e};o||(o=r(s(0))?s(0).mul(0):0);var w=[];if(A.length>0){w=rn(w,A,o);for(var h=0;h<u;h++)w[h+B][h+a]=s(h)}return new n({data:w,size:[E,Q]})},n.fromJSON=function(A){return new n(A)},n.prototype.swapRows=function(A,e){if(!(t(A)&&V(A)&&t(e)&&V(e)))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return tn(A,this._size[0]),tn(e,this._size[0]),n._swapRows(A,e,this._data),this},n._swapRows=function(A,e,t){var n=t[A];t[A]=t[e],t[e]=n},n}),{isClass:!0}),yn=mA("clone",["typed"],(function(A){return(0,A.typed)("clone",{any:uA})}));function Tn(A){var e,t,n=A.length,i=A[0].length,r=[];for(t=0;t<i;t++){var o=[];for(e=0;e<n;e++)o.push(A[e][t]);r.push(o)}return r}function xn(A){for(var e=0;e<A.length;e++)if(E(A[e]))return!0;return!1}function Rn(A,e){g(A)&&(A=A.valueOf());for(var t=0,n=A.length;t<n;t++){var i=A[t];Array.isArray(i)?Rn(i,e):e(i)}}function Gn(A,e,t){return A&&"function"==typeof A.map?A.map((function(A){return Gn(A,e,t)})):e(A)}function Sn(A,e,t){var n=Array.isArray(A)?$t(A):A.size();if(e<0||e>=n.length)throw new qt(e,n.length);return g(A)?A.create(Hn(A.valueOf(),e,t)):Hn(A,e,t)}function Hn(A,e,t){var n,i,r,o;if(e<=0){if(Array.isArray(A[0])){for(o=Tn(A),i=[],n=0;n<o.length;n++)i[n]=Hn(o[n],e-1,t);return i}for(r=A[0],n=1;n<A.length;n++)r=t(r,A[n]);return r}for(i=[],n=0;n<A.length;n++)i[n]=Hn(A[n],e-1,t);return i}function bn(A,e,t,n,i,r,o,s,a,B,c){var g,E,Q,u,l=A._values,w=A._index,h=A._ptr;if(n)for(E=h[e],Q=h[e+1],g=E;g<Q;g++)t[u=w[g]]!==r?(t[u]=r,o.push(u),B?(n[u]=a?s(l[g],c):s(c,l[g]),i[u]=r):n[u]=l[g]):(n[u]=a?s(l[g],n[u]):s(n[u],l[g]),i[u]=r);else for(E=h[e],Q=h[e+1],g=E;g<Q;g++)t[u=w[g]]!==r?(t[u]=r,o.push(u)):i[u]=r}var vn="isInteger",kn=mA(vn,["typed"],(function(A){var e=A.typed;return e(vn,{number:V,BigNumber:function(A){return A.isInt()},Fraction:function(A){return 1===A.d&&isFinite(A.n)},"Array | Matrix":e.referToSelf((function(A){return function(e){return Gn(e,A)}}))})})),jn=(n(5728),n(5993),"number");function Jn(A){return A<0}function zn(A){return A>0}function Ln(A){return 0===A}function Pn(A){return Number.isNaN(A)}Jn.signature=jn,zn.signature=jn,Ln.signature=jn,Pn.signature=jn;var On="isNegative",Vn=mA(On,["typed"],(function(A){var e=A.typed;return e(On,{number:Jn,BigNumber:function(A){return A.isNeg()&&!A.isZero()&&!A.isNaN()},Fraction:function(A){return A.s<0},Unit:e.referToSelf((function(A){return function(t){return e.find(A,t.valueType())(t.value)}})),"Array | Matrix":e.referToSelf((function(A){return function(e){return Gn(e,A)}}))})})),Wn="isNumeric",Kn=mA(Wn,["typed"],(function(A){var e=A.typed;return e(Wn,{"number | BigNumber | Fraction | boolean":function(){return!0},"Complex | Unit | string | null | undefined | Node":function(){return!1},"Array | Matrix":e.referToSelf((function(A){return function(e){return Gn(e,A)}}))})})),Xn=(n(8436),"hasNumericValue"),Zn=mA(Xn,["typed","isNumeric"],(function(A){var e=A.typed,t=A.isNumeric;return e(Xn,{boolean:function(){return!0},string:function(A){return A.trim().length>0&&!isNaN(Number(A))},any:function(A){return t(A)}})})),_n="isPositive",qn=mA(_n,["typed"],(function(A){var e=A.typed;return e(_n,{number:zn,BigNumber:function(A){return!A.isNeg()&&!A.isZero()&&!A.isNaN()},Fraction:function(A){return A.s>0&&A.n>0},Unit:e.referToSelf((function(A){return function(t){return e.find(A,t.valueType())(t.value)}})),"Array | Matrix":e.referToSelf((function(A){return function(e){return Gn(e,A)}}))})})),$n=mA("isZero",["typed"],(function(A){var e=A.typed;return e("isZero",{number:Ln,BigNumber:function(A){return A.isZero()},Complex:function(A){return 0===A.re&&0===A.im},Fraction:function(A){return 1===A.d&&0===A.n},Unit:e.referToSelf((function(A){return function(t){return e.find(A,t.valueType())(t.value)}})),"Array | Matrix":e.referToSelf((function(A){return function(e){return Gn(e,A)}}))})})),Ai=mA("isNaN",["typed"],(function(A){return(0,A.typed)("isNaN",{number:Pn,BigNumber:function(A){return A.isNaN()},Fraction:function(A){return!1},Complex:function(A){return A.isNaN()},Unit:function(A){return Number.isNaN(A.value)},"Array | Matrix":function(A){return Gn(A,Number.isNaN)}})})),ei=mA("typeOf",["typed"],(function(A){return(0,A.typed)("typeOf",{any:P})}));function ti(A,e,t){if(null==t)return A.eq(e);if(A.eq(e))return!0;if(A.isNaN()||e.isNaN())return!1;if(A.isFinite()&&e.isFinite()){var n=A.minus(e).abs();if(n.isZero())return!0;var i=A.constructor.max(A.abs(),e.abs());return n.lte(i.times(t))}return!1}var ni=mA("compareUnits",["typed"],(function(A){var e=A.typed;return{"Unit, Unit":e.referToSelf((function(A){return function(t,n){if(!t.equalBase(n))throw new Error("Cannot compare units with different base");return e.find(A,[t.valueType(),n.valueType()])(t.value,n.value)}}))}})),ii="equalScalar",ri=mA(ii,["typed","config"],(function(A){var e=A.typed,t=A.config,n=ni({typed:e});return e(ii,{"boolean, boolean":function(A,e){return A===e},"number, number":function(A,e){return sA(A,e,t.epsilon)},"BigNumber, BigNumber":function(A,e){return A.eq(e)||ti(A,e,t.epsilon)},"Fraction, Fraction":function(A,e){return A.equals(e)},"Complex, Complex":function(A,e){return function(A,e,t){return sA(A.re,e.re,t)&&sA(A.im,e.im,t)}(A,e,t.epsilon)}},n)})),oi=(mA(ii,["typed","config"],(function(A){var e=A.typed,t=A.config;return e(ii,{"number, number":function(A,e){return sA(A,e,t.epsilon)}})})),mA("SparseMatrix",["typed","equalScalar","Matrix"],(function(A){var e=A.typed,n=A.equalScalar,i=A.Matrix;function o(A,e){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");if(e&&!B(e))throw new Error("Invalid datatype: "+e);if(g(A))!function(A,e,t){"SparseMatrix"===e.type?(A._values=e._values?uA(e._values):void 0,A._index=uA(e._index),A._ptr=uA(e._ptr),A._size=uA(e._size),A._datatype=t||e._datatype):s(A,e.valueOf(),t||e._datatype)}(this,A,e);else if(A&&c(A.index)&&c(A.ptr)&&c(A.size))this._values=A.values,this._index=A.index,this._ptr=A.ptr,this._size=A.size,this._datatype=e||A.datatype;else if(c(A))s(this,A,e);else{if(A)throw new TypeError("Unsupported type of data ("+P(A)+")");this._values=[],this._index=[],this._ptr=[0],this._size=[0,0],this._datatype=e}}function s(A,t,i){A._values=[],A._index=[],A._ptr=[],A._datatype=i;var r=t.length,o=0,s=n,a=0;if(B(i)&&(s=e.find(n,[i,i])||n,a=e.convert(0,i)),r>0){var g=0;do{A._ptr.push(A._index.length);for(var E=0;E<r;E++){var Q=t[E];if(c(Q)){if(0===g&&o<Q.length&&(o=Q.length),g<Q.length){var u=Q[g];s(u,a)||(A._values.push(u),A._index.push(E))}}else 0===g&&o<1&&(o=1),s(Q,a)||(A._values.push(Q),A._index.push(E))}g++}while(g<o)}A._ptr.push(A._index.length),A._size=[r,o]}function a(A,e,t,n){if(t-e==0)return t;for(var i=e;i<t;i++)if(n[i]===A)return i;return e}function Q(A,e,t,n,i,r,o){i.splice(A,0,n),r.splice(A,0,e);for(var s=t+1;s<o.length;s++)o[s]++}function u(A,t,i,r){var o=r||0,s=n,a=0;B(A._datatype)&&(s=e.find(n,[A._datatype,A._datatype])||n,a=e.convert(0,A._datatype),o=e.convert(o,A._datatype));var c,g,E,Q=!s(o,a),u=A._size[0],l=A._size[1];if(i>l){for(g=l;g<i;g++)if(A._ptr[g]=A._values.length,Q)for(c=0;c<u;c++)A._values.push(o),A._index.push(c);A._ptr[i]=A._values.length}else i<l&&(A._ptr.splice(i+1,l-i),A._values.splice(A._ptr[i],A._values.length),A._index.splice(A._ptr[i],A._index.length));if(l=i,t>u){if(Q){var w=0;for(g=0;g<l;g++){A._ptr[g]=A._ptr[g]+w,E=A._ptr[g+1]+w;var h=0;for(c=u;c<t;c++,h++)A._values.splice(E+h,0,o),A._index.splice(E+h,0,c),w++}A._ptr[l]=A._values.length}}else if(t<u){var C=0;for(g=0;g<l;g++){A._ptr[g]=A._ptr[g]-C;var I=A._ptr[g],M=A._ptr[g+1]-C;for(E=I;E<M;E++)(c=A._index[E])>t-1&&(A._values.splice(E,1),A._index.splice(E,1),C++)}A._ptr[g]=A._values.length}return A._size[0]=t,A._size[1]=i,A}function l(A,e,t,n,i){var r,o,s=n[0],a=n[1],B=[];for(r=0;r<s;r++)for(B[r]=[],o=0;o<a;o++)B[r][o]=0;for(o=0;o<a;o++)for(var c=t[o],g=t[o+1],E=c;E<g;E++)B[r=e[E]][o]=A?i?uA(A[E]):A[E]:1;return B}return o.prototype=new i,o.prototype.createSparseMatrix=function(A,e){return new o(A,e)},Object.defineProperty(o,"name",{value:"SparseMatrix"}),o.prototype.constructor=o,o.prototype.type="SparseMatrix",o.prototype.isSparseMatrix=!0,o.prototype.getDataType=function(){return In(this._values,P)},o.prototype.storage=function(){return"sparse"},o.prototype.datatype=function(){return this._datatype},o.prototype.create=function(A,e){return new o(A,e)},o.prototype.density=function(){var A=this._size[0],e=this._size[1];return 0!==A&&0!==e?this._index.length/(A*e):0},o.prototype.subset=function(A,e,t){if(!this._values)throw new Error("Cannot invoke subset on a Pattern only matrix");switch(arguments.length){case 1:return function(A,e){if(!w(e))throw new TypeError("Invalid index");if(e.isScalar())return A.get(e.min());var t,n,i,r,s=e.size();if(s.length!==A._size.length)throw new _t(s.length,A._size.length);var a=e.min(),B=e.max();for(t=0,n=A._size.length;t<n;t++)tn(a[t],A._size[t]),tn(B[t],A._size[t]);var c=A._values,g=A._index,E=A._ptr,Q=e.dimension(0),u=e.dimension(1),l=[],h=[];Q.forEach((function(A,e){h[A]=e[0],l[A]=!0}));var C=c?[]:void 0,I=[],M=[];return u.forEach((function(A){for(M.push(I.length),i=E[A],r=E[A+1];i<r;i++)t=g[i],!0===l[t]&&(I.push(h[t]),C&&C.push(c[i]))})),M.push(I.length),new o({values:C,index:I,ptr:M,size:s,datatype:A._datatype})}(this,A);case 2:case 3:return function(A,e,t,n){if(!e||!0!==e.isIndex)throw new TypeError("Invalid index");var i,r=e.size(),o=e.isScalar();if(g(t)?(i=t.size(),t=t.toArray()):i=$t(t),o){if(0!==i.length)throw new TypeError("Scalar expected");A.set(e.min(),t,n)}else{if(1!==r.length&&2!==r.length)throw new _t(r.length,A._size.length,"<");if(i.length<r.length){for(var s=0,a=0;1===r[s]&&1===i[s];)s++;for(;1===r[s];)a++,s++;t=cn(t,r.length,a,i)}if(!hA(r,i))throw new _t(r,i,">");if(1===r.length)e.dimension(0).forEach((function(e,i){tn(e),A.set([e,0],t[i[0]],n)}));else{var B=e.dimension(0),c=e.dimension(1);B.forEach((function(e,i){tn(e),c.forEach((function(r,o){tn(r),A.set([e,r],t[i[0]][o[0]],n)}))}))}}return A}(this,A,e,t);default:throw new SyntaxError("Wrong number of arguments")}},o.prototype.get=function(A){if(!c(A))throw new TypeError("Array expected");if(A.length!==this._size.length)throw new _t(A.length,this._size.length);if(!this._values)throw new Error("Cannot invoke get on a Pattern only matrix");var e=A[0],t=A[1];tn(e,this._size[0]),tn(t,this._size[1]);var n=a(e,this._ptr[t],this._ptr[t+1],this._index);return n<this._ptr[t+1]&&this._index[n]===e?this._values[n]:0},o.prototype.set=function(A,t,i){if(!c(A))throw new TypeError("Array expected");if(A.length!==this._size.length)throw new _t(A.length,this._size.length);if(!this._values)throw new Error("Cannot invoke set on a Pattern only matrix");var r=A[0],o=A[1],s=this._size[0],g=this._size[1],E=n,l=0;B(this._datatype)&&(E=e.find(n,[this._datatype,this._datatype])||n,l=e.convert(0,this._datatype)),(r>s-1||o>g-1)&&(u(this,Math.max(r+1,s),Math.max(o+1,g),i),s=this._size[0],g=this._size[1]),tn(r,s),tn(o,g);var w=a(r,this._ptr[o],this._ptr[o+1],this._index);return w<this._ptr[o+1]&&this._index[w]===r?E(t,l)?function(A,e,t,n,i){t.splice(A,1),n.splice(A,1);for(var r=e+1;r<i.length;r++)i[r]--}(w,o,this._values,this._index,this._ptr):this._values[w]=t:E(t,l)||Q(w,r,o,t,this._values,this._index,this._ptr),this},o.prototype.resize=function(A,e,n){if(!E(A))throw new TypeError("Array or Matrix expected");var i=A.valueOf().map((function(A){return Array.isArray(A)&&1===A.length?A[0]:A}));if(2!==i.length)throw new Error("Only two dimensions matrix are supported");return i.forEach((function(A){if(!t(A)||!V(A)||A<0)throw new TypeError("Invalid size, must contain positive integers (size: "+Vt(i)+")")})),u(n?this.clone():this,i[0],i[1],e)},o.prototype.reshape=function(A,e){if(!c(A))throw new TypeError("Array expected");if(2!==A.length)throw new Error("Sparse matrices can only be reshaped in two dimensions");A.forEach((function(e){if(!t(e)||!V(e)||e<=-2||0===e)throw new TypeError("Invalid size, must contain positive integers or -1 (size: "+Vt(A)+")")}));var n=this._size[0]*this._size[1];if(n!==(A=sn(A,n))[0]*A[1])throw new Error("Reshaping sparse matrix will result in the wrong number of elements");var i=e?this.clone():this;if(this._size[0]===A[0]&&this._size[1]===A[1])return i;for(var r=[],o=0;o<i._ptr.length;o++)for(var s=0;s<i._ptr[o+1]-i._ptr[o];s++)r.push(o);for(var B=i._values.slice(),g=i._index.slice(),E=0;E<i._index.length;E++){var u=g[E],l=r[E],w=u*i._size[1]+l;r[E]=w%A[1],g[E]=Math.floor(w/A[1])}i._values.length=0,i._index.length=0,i._ptr.length=A[1]+1,i._size=A.slice();for(var h=0;h<i._ptr.length;h++)i._ptr[h]=0;for(var C=0;C<B.length;C++){var I=g[C],M=r[C],d=B[C];Q(a(I,i._ptr[M],i._ptr[M+1],i._index),I,M,d,i._values,i._index,i._ptr)}return i},o.prototype.clone=function(){return new o({values:this._values?uA(this._values):void 0,index:uA(this._index),ptr:uA(this._ptr),size:uA(this._size),datatype:this._datatype})},o.prototype.size=function(){return this._size.slice(0)},o.prototype.map=function(A,t){if(!this._values)throw new Error("Cannot invoke map on a Pattern only matrix");var i=this,r=this._size[0],s=this._size[1],a=fn(A);return function(A,t,i,r,s,a,c){var g=[],E=[],Q=[],u=n,l=0;B(A._datatype)&&(u=e.find(n,[A._datatype,A._datatype])||n,l=e.convert(0,A._datatype));for(var w=function(A,e,t){A=a(A,e,t),u(A,l)||(g.push(A),E.push(e))},h=0;h<=s;h++){Q.push(g.length);var C=A._ptr[h],I=A._ptr[h+1];if(c)for(var M=C;M<I;M++){var d=A._index[M];d>=0&&d<=i&&w(A._values[M],d-0,h-0)}else{for(var m={},p=C;p<I;p++)m[A._index[p]]=A._values[p];for(var F=0;F<=i;F++)w(F in m?m[F]:0,F-0,h-0)}}return Q.push(g.length),new o({values:g,index:E,ptr:Q,size:[i-0+1,s-0+1]})}(this,0,r-1,0,s-1,(function(e,t,n){return 1===a?A(e):2===a?A(e,[t,n]):A(e,[t,n],i)}),t)},o.prototype.forEach=function(A,e){if(!this._values)throw new Error("Cannot invoke forEach on a Pattern only matrix");for(var t=this._size[0],n=this._size[1],i=0;i<n;i++){var r=this._ptr[i],o=this._ptr[i+1];if(e)for(var s=r;s<o;s++){var a=this._index[s];A(this._values[s],[a,i],this)}else{for(var B={},c=r;c<o;c++)B[this._index[c]]=this._values[c];for(var g=0;g<t;g++)A(g in B?B[g]:0,[g,i],this)}}},o.prototype[Symbol.iterator]=vt.mark((function A(){var e,t,n,i,r,o;return vt.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:if(this._values){A.next=2;break}throw new Error("Cannot iterate a Pattern only matrix");case 2:e=this._size[1],t=0;case 4:if(!(t<e)){A.next=18;break}n=this._ptr[t],i=this._ptr[t+1],r=n;case 8:if(!(r<i)){A.next=15;break}return o=this._index[r],A.next=12,{value:this._values[r],index:[o,t]};case 12:r++,A.next=8;break;case 15:t++,A.next=4;break;case 18:case"end":return A.stop()}}),A,this)})),o.prototype.toArray=function(){return l(this._values,this._index,this._ptr,this._size,!0)},o.prototype.valueOf=function(){return l(this._values,this._index,this._ptr,this._size,!1)},o.prototype.format=function(A){for(var e=this._size[0],t=this._size[1],n=this.density(),i="Sparse Matrix ["+Vt(e,A)+" x "+Vt(t,A)+"] density: "+Vt(n,A)+"\n",r=0;r<t;r++)for(var o=this._ptr[r],s=this._ptr[r+1],a=o;a<s;a++)i+="\n    ("+Vt(this._index[a],A)+", "+Vt(r,A)+") ==> "+(this._values?Vt(this._values[a],A):"X");return i},o.prototype.toString=function(){return Vt(this.toArray())},o.prototype.toJSON=function(){return{mathjs:"SparseMatrix",values:this._values,index:this._index,ptr:this._ptr,size:this._size,datatype:this._datatype}},o.prototype.diagonal=function(A){if(A){if(r(A)&&(A=A.toNumber()),!t(A)||!V(A))throw new TypeError("The parameter k must be an integer number")}else A=0;var e=A>0?A:0,n=A<0?-A:0,i=this._size[0],s=this._size[1],a=Math.min(i-n,s-e),B=[],c=[],g=[];g[0]=0;for(var E=e;E<s&&B.length<a;E++)for(var Q=this._ptr[E],u=this._ptr[E+1],l=Q;l<u;l++){var w=this._index[l];if(w===E-e+n){B.push(this._values[l]),c[B.length-1]=w-n;break}}return g.push(B.length),new o({values:B,index:c,ptr:g,size:[a,1]})},o.fromJSON=function(A){return new o(A)},o.diagonal=function(A,i,s,a,E){if(!c(A))throw new TypeError("Array expected, size parameter");if(2!==A.length)throw new Error("Only two dimensions matrix are supported");if(A=A.map((function(A){if(r(A)&&(A=A.toNumber()),!t(A)||!V(A)||A<1)throw new Error("Size values must be positive integers");return A})),s){if(r(s)&&(s=s.toNumber()),!t(s)||!V(s))throw new TypeError("The parameter k must be an integer number")}else s=0;var Q=n,u=0;B(E)&&(Q=e.find(n,[E,E])||n,u=e.convert(0,E));var l,w=s>0?s:0,h=s<0?-s:0,C=A[0],I=A[1],M=Math.min(C-h,I-w);if(c(i)){if(i.length!==M)throw new Error("Invalid value array length");l=function(A){return i[A]}}else if(g(i)){var d=i.size();if(1!==d.length||d[0]!==M)throw new Error("Invalid matrix length");l=function(A){return i.get([A])}}else l=function(){return i};for(var m=[],p=[],F=[],D=0;D<I;D++){F.push(m.length);var Y=D-w;if(Y>=0&&Y<M){var f=l(Y);Q(f,u)||(p.push(Y+h),m.push(f))}}return F.push(m.length),new o({values:m,index:p,ptr:F,size:[C,I]})},o.prototype.swapRows=function(A,e){if(!(t(A)&&V(A)&&t(e)&&V(e)))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return tn(A,this._size[0]),tn(e,this._size[0]),o._swapRows(A,e,this._size[1],this._values,this._index,this._ptr),this},o._forEachRow=function(A,e,t,n,i){for(var r=n[A],o=n[A+1],s=r;s<o;s++)i(t[s],e[s])},o._swapRows=function(A,e,t,n,i,r){for(var o=0;o<t;o++){var s=r[o],B=r[o+1],c=a(A,s,B,i),g=a(e,s,B,i);if(c<B&&g<B&&i[c]===A&&i[g]===e){if(n){var E=n[c];n[c]=n[g],n[g]=E}}else if(c<B&&i[c]===A&&(g>=B||i[g]!==e)){var Q=n?n[c]:void 0;i.splice(g,0,e),n&&n.splice(g,0,Q),i.splice(g<=c?c+1:c,1),n&&n.splice(g<=c?c+1:c,1)}else if(g<B&&i[g]===e&&(c>=B||i[c]!==A)){var u=n?n[g]:void 0;i.splice(c,0,A),n&&n.splice(c,0,u),i.splice(c<=g?g+1:g,1),n&&n.splice(c<=g?g+1:g,1)}}},o}),{isClass:!0})),si=mA("number",["typed"],(function(A){var e=A.typed,t=e("number",{"":function(){return 0},number:function(A){return A},string:function(A){if("NaN"===A)return NaN;var e,t,n=(t=(e=A).match(/(0[box])([0-9a-fA-F]*)\.([0-9a-fA-F]*)/))?{input:e,radix:{"0b":2,"0o":8,"0x":16}[t[1]],integerPart:t[2],fractionalPart:t[3]}:null;if(n)return function(A){for(var e=parseInt(A.integerPart,A.radix),t=0,n=0;n<A.fractionalPart.length;n++)t+=parseInt(A.fractionalPart[n],A.radix)/Math.pow(A.radix,n+1);var i=e+t;if(isNaN(i))throw new SyntaxError('String "'+A.input+'" is no valid number');return i}(n);var i=0,r=A.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);r&&(i=Number(r[2]),A=r[1]);var o=Number(A);if(isNaN(o))throw new SyntaxError('String "'+A+'" is no valid number');if(r){if(o>Math.pow(2,i)-1)throw new SyntaxError('String "'.concat(A,'" is out of range'));o>=Math.pow(2,i-1)&&(o-=Math.pow(2,i))}return o},BigNumber:function(A){return A.toNumber()},Fraction:function(A){return A.valueOf()},Unit:e.referToSelf((function(A){return function(e){var t=e.clone();return t.value=A(e.value),t}})),null:function(A){return 0},"Unit, string | Unit":function(A,e){return A.toNumber(e)},"Array | Matrix":e.referToSelf((function(A){return function(e){return Gn(e,A)}}))});return t.fromJSON=function(A){return parseFloat(A.value)},t})),ai=mA("string",["typed"],(function(A){var e=A.typed;return e("string",{"":function(){return""},number:AA,null:function(A){return"null"},boolean:function(A){return A+""},string:function(A){return A},"Array | Matrix":e.referToSelf((function(A){return function(e){return Gn(e,A)}})),any:function(A){return String(A)}})})),Bi="boolean",ci=mA(Bi,["typed"],(function(A){var e=A.typed;return e(Bi,{"":function(){return!1},boolean:function(A){return A},number:function(A){return!!A},null:function(A){return!1},BigNumber:function(A){return!A.isZero()},string:function(A){var e=A.toLowerCase();if("true"===e)return!0;if("false"===e)return!1;var t=Number(A);if(""!==A&&!isNaN(t))return!!t;throw new Error('Cannot convert "'+A+'" to a boolean')},"Array | Matrix":e.referToSelf((function(A){return function(e){return Gn(e,A)}}))})})),gi=mA("bignumber",["typed","BigNumber"],(function(A){var e=A.typed,t=A.BigNumber;return e("bignumber",{"":function(){return new t(0)},number:function(A){return new t(A+"")},string:function(A){var e=A.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);if(e){var n=e[2],i=t(e[1]),r=new t(2).pow(Number(n));if(i.gt(r.sub(1)))throw new SyntaxError('String "'.concat(A,'" is out of range'));var o=new t(2).pow(Number(n)-1);return i.gte(o)?i.sub(r):i}return new t(A)},BigNumber:function(A){return A},Unit:e.referToSelf((function(A){return function(e){var t=e.clone();return t.value=A(e.value),t}})),Fraction:function(A){return new t(A.n).div(A.d).times(A.s)},null:function(A){return new t(0)},"Array | Matrix":e.referToSelf((function(A){return function(e){return Gn(e,A)}}))})})),Ei=mA("complex",["typed","Complex"],(function(A){var e=A.typed,t=A.Complex;return e("complex",{"":function(){return t.ZERO},number:function(A){return new t(A,0)},"number, number":function(A,e){return new t(A,e)},"BigNumber, BigNumber":function(A,e){return new t(A.toNumber(),e.toNumber())},Fraction:function(A){return new t(A.valueOf(),0)},Complex:function(A){return A.clone()},string:function(A){return t(A)},null:function(A){return t(0)},Object:function(A){if("re"in A&&"im"in A)return new t(A.re,A.im);if("r"in A&&"phi"in A||"abs"in A&&"arg"in A)return new t(A);throw new Error("Expected object with properties (re and im) or (r and phi) or (abs and arg)")},"Array | Matrix":e.referToSelf((function(A){return function(e){return Gn(e,A)}}))})})),Qi=mA("fraction",["typed","Fraction"],(function(A){var e=A.typed,t=A.Fraction;return e("fraction",{number:function(A){if(!isFinite(A)||isNaN(A))throw new Error(A+" cannot be represented as a fraction");return new t(A)},string:function(A){return new t(A)},"number, number":function(A,e){return new t(A,e)},null:function(A){return new t(0)},BigNumber:function(A){return new t(A.toString())},Fraction:function(A){return A},Unit:e.referToSelf((function(A){return function(e){var t=e.clone();return t.value=A(e.value),t}})),Object:function(A){return new t(A)},"Array | Matrix":e.referToSelf((function(A){return function(e){return Gn(e,A)}}))})})),ui=mA("matrix",["typed","Matrix","DenseMatrix","SparseMatrix"],(function(A){var e=A.typed,t=(A.Matrix,A.DenseMatrix),n=A.SparseMatrix;return e("matrix",{"":function(){return i([])},string:function(A){return i([],A)},"string, string":function(A,e){return i([],A,e)},Array:function(A){return i(A)},Matrix:function(A){return i(A,A.storage())},"Array | Matrix, string":i,"Array | Matrix, string, string":i});function i(A,e,i){if("dense"===e||"default"===e||void 0===e)return new t(A,i);if("sparse"===e)return new n(A,i);throw new TypeError("Unknown matrix type "+JSON.stringify(e)+".")}})),li="matrixFromFunction",wi=mA(li,["typed","matrix","isZero"],(function(A){var e=A.typed,t=A.matrix,n=A.isZero;return e(li,{"Array | Matrix, function, string, string":function(A,e,t,n){return i(A,e,t,n)},"Array | Matrix, function, string":function(A,e,t){return i(A,e,t)},"Matrix, function":function(A,e){return i(A,e,"dense")},"Array, function":function(A,e){return i(A,e,"dense").toArray()},"Array | Matrix, string, function":function(A,e,t){return i(A,t,e)},"Array | Matrix, string, string, function":function(A,e,t,n){return i(A,n,e,t)}});function i(A,e,i,r){var o;return(o=void 0!==r?t(i,r):t(i)).resize(A),o.forEach((function(A,t){var i=e(t);n(i)||o.set(t,i)})),o}}));function hi(A,e){(null==e||e>A.length)&&(e=A.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=A[t];return n}var Ci="matrixFromRows",Ii=mA(Ci,["typed","matrix","flatten","size"],(function(A){var e=A.typed,t=A.matrix,n=A.flatten,i=A.size;return e(Ci,{"...Array":function(A){return r(A)},"...Matrix":function(A){return t(r(A.map((function(A){return A.toArray()}))))}});function r(A){if(0===A.length)throw new TypeError("At least one row is needed to construct a matrix.");var e,t=o(A[0]),i=[],r=function(A,e){var t="undefined"!=typeof Symbol&&A[Symbol.iterator]||A["@@iterator"];if(!t){if(Array.isArray(A)||(t=function(A,e){if(A){if("string"==typeof A)return hi(A,e);var t=Object.prototype.toString.call(A).slice(8,-1);return"Object"===t&&A.constructor&&(t=A.constructor.name),"Map"===t||"Set"===t?Array.from(A):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?hi(A,e):void 0}}(A))){t&&(A=t);var n=0,i=function(){};return{s:i,n:function(){return n>=A.length?{done:!0}:{done:!1,value:A[n++]}},e:function(A){throw A},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){t=t.call(A)},n:function(){var A=t.next();return o=A.done,A},e:function(A){s=!0,r=A},f:function(){try{o||null==t.return||t.return()}finally{if(s)throw r}}}}(A);try{for(r.s();!(e=r.n()).done;){var s=e.value,a=o(s);if(a!==t)throw new TypeError("The vectors had different length: "+(0|t)+"  "+(0|a));i.push(n(s))}}catch(A){r.e(A)}finally{r.f()}return i}function o(A){var e=i(A);if(1===e.length)return e[0];if(2===e.length){if(1===e[0])return e[1];if(1===e[1])return e[0];throw new TypeError("At least one of the arguments is not a vector.")}throw new TypeError("Only one- or two-dimensional vectors are supported.")}}));function Mi(A,e){(null==e||e>A.length)&&(e=A.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=A[t];return n}var di="matrixFromColumns",mi=mA(di,["typed","matrix","flatten","size"],(function(A){var e=A.typed,t=A.matrix,n=A.flatten,i=A.size;return e(di,{"...Array":function(A){return r(A)},"...Matrix":function(A){return t(r(A.map((function(A){return A.toArray()}))))}});function r(A){if(0===A.length)throw new TypeError("At least one column is needed to construct a matrix.");for(var e=o(A[0]),t=[],i=0;i<e;i++)t[i]=[];var r,s=function(A,e){var t="undefined"!=typeof Symbol&&A[Symbol.iterator]||A["@@iterator"];if(!t){if(Array.isArray(A)||(t=function(A,e){if(A){if("string"==typeof A)return Mi(A,e);var t=Object.prototype.toString.call(A).slice(8,-1);return"Object"===t&&A.constructor&&(t=A.constructor.name),"Map"===t||"Set"===t?Array.from(A):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Mi(A,e):void 0}}(A))){t&&(A=t);var n=0,i=function(){};return{s:i,n:function(){return n>=A.length?{done:!0}:{done:!1,value:A[n++]}},e:function(A){throw A},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){t=t.call(A)},n:function(){var A=t.next();return o=A.done,A},e:function(A){s=!0,r=A},f:function(){try{o||null==t.return||t.return()}finally{if(s)throw r}}}}(A);try{for(s.s();!(r=s.n()).done;){var a=r.value,B=o(a);if(B!==e)throw new TypeError("The vectors had different length: "+(0|e)+"  "+(0|B));for(var c=n(a),g=0;g<e;g++)t[g].push(c[g])}}catch(A){s.e(A)}finally{s.f()}return t}function o(A){var e=i(A);if(1===e.length)return e[0];if(2===e.length){if(1===e[0])return e[1];if(1===e[1])return e[0];throw new TypeError("At least one of the arguments is not a vector.")}throw new TypeError("Only one- or two-dimensional vectors are supported.")}})),pi="splitUnit",Fi=mA(pi,["typed"],(function(A){return(0,A.typed)(pi,{"Unit, Array":function(A,e){return A.splitUnit(e)}})})),Di="number",Yi="number, number";function fi(A){return Math.abs(A)}function Ni(A,e){return A+e}function Ui(A,e){return A-e}function yi(A,e){return A*e}function Ti(A){return-A}function xi(A){return A}function Ri(A){return _(A)}function Gi(A){return A*A*A}function Si(A){return Math.exp(A)}function Hi(A){return q(A)}function bi(A,e){if(!V(A)||!V(e))throw new Error("Parameters in function lcm must be integer numbers");if(0===A||0===e)return 0;for(var t,n=A*e;0!==e;)e=A%(t=e),A=t;return Math.abs(n/A)}function vi(A){return X(A)}function ki(A){return K(A)}function ji(A){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,t=e<0;if(t&&(e=-e),0===e)throw new Error("Root must be non-zero");if(A<0&&Math.abs(e)%2!=1)throw new Error("Root must be odd when a is negative.");if(0===A)return t?1/0:0;if(!isFinite(A))return t?0:A;var n=Math.pow(Math.abs(A),1/e);return n=A<0?-n:n,t?1/n:n}function Ji(A){return W(A)}function zi(A){return A*A}function Li(A,e){var t,n,i,r=0,o=1,s=1,a=0;if(!V(A)||!V(e))throw new Error("Parameters in function xgcd must be integer numbers");for(;e;)i=A-(n=Math.floor(A/e))*e,t=r,r=o-n*r,o=t,t=s,s=a-n*s,a=t,A=e,e=i;return A<0?[-A,-o,-a]:[A,A?o:0,a]}function Pi(A,e){return A*A<1&&e===1/0||A*A>1&&e===-1/0?0:Math.pow(A,e)}function Oi(A){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!V(e)||e<0||e>15)throw new Error("Number of decimals in function round must be an integer from 0 to 15 inclusive");return parseFloat(tA(A,e))}fi.signature=Di,Ni.signature=Yi,Ui.signature=Yi,yi.signature=Yi,Ti.signature=Di,xi.signature=Di,Ri.signature=Di,Gi.signature=Di,Si.signature=Di,Hi.signature=Di,bi.signature=Yi,vi.signature=Di,ki.signature=Di,Ji.signature=Di,zi.signature=Di,Li.signature=Yi,Pi.signature=Yi;var Vi="unaryMinus",Wi=mA(Vi,["typed"],(function(A){var e=A.typed;return e(Vi,{number:Ti,"Complex | BigNumber | Fraction":function(A){return A.neg()},Unit:e.referToSelf((function(A){return function(t){var n=t.clone();return n.value=e.find(A,n.valueType())(t.value),n}})),"Array | Matrix":e.referToSelf((function(A){return function(e){return Gn(e,A,!0)}}))})})),Ki="unaryPlus",Xi=mA(Ki,["typed","config","BigNumber"],(function(A){var e=A.typed,t=A.config,n=A.BigNumber;return e(Ki,{number:xi,Complex:function(A){return A},BigNumber:function(A){return A},Fraction:function(A){return A},Unit:function(A){return A.clone()},"Array | Matrix":e.referToSelf((function(A){return function(e){return Gn(e,A,!0)}})),"boolean | string":function(A){return"BigNumber"===t.number?new n(+A):+A}})})),Zi=mA("abs",["typed"],(function(A){var e=A.typed;return e("abs",{number:fi,"Complex | BigNumber | Fraction | Unit":function(A){return A.abs()},"Array | Matrix":e.referToSelf((function(A){return function(e){return Gn(e,A,!0)}}))})})),_i=mA("apply",["typed","isInteger"],(function(A){var e=A.typed,t=A.isInteger;return e("apply",{"Array | Matrix, number | BigNumber, function":function(A,e,n){if(!t(e))throw new TypeError("Integer number expected for dimension");var i=Array.isArray(A)?$t(A):A.size();if(e<0||e>=i.length)throw new qt(e,i.length);return g(A)?A.create(qi(A.valueOf(),e,n)):qi(A,e,n)}})}));function qi(A,e,t){var n,i,r;if(e<=0){if(Array.isArray(A[0])){for(r=function(A){var e,t,n=A.length,i=A[0].length,r=[];for(t=0;t<i;t++){var o=[];for(e=0;e<n;e++)o.push(A[e][t]);r.push(o)}return r}(A),i=[],n=0;n<r.length;n++)i[n]=qi(r[n],e-1,t);return i}return t(A)}for(i=[],n=0;n<A.length;n++)i[n]=qi(A[n],e-1,t);return i}var $i="addScalar",Ar=mA($i,["typed"],(function(A){var e=A.typed;return e($i,{"number, number":Ni,"Complex, Complex":function(A,e){return A.add(e)},"BigNumber, BigNumber":function(A,e){return A.plus(e)},"Fraction, Fraction":function(A,e){return A.add(e)},"Unit, Unit":e.referToSelf((function(A){return function(t,n){if(null===t.value||void 0===t.value)throw new Error("Parameter x contains a unit with undefined value");if(null===n.value||void 0===n.value)throw new Error("Parameter y contains a unit with undefined value");if(!t.equalBase(n))throw new Error("Units do not match");var i=t.clone();return i.value=e.find(A,[i.valueType(),n.valueType()])(i.value,n.value),i.fixPrefix=!1,i}}))})})),er="subtractScalar",tr=mA(er,["typed"],(function(A){var e=A.typed;return e(er,{"number, number":Ui,"Complex, Complex":function(A,e){return A.sub(e)},"BigNumber, BigNumber":function(A,e){return A.minus(e)},"Fraction, Fraction":function(A,e){return A.sub(e)},"Unit, Unit":e.referToSelf((function(A){return function(t,n){if(null===t.value||void 0===t.value)throw new Error("Parameter x contains a unit with undefined value");if(null===n.value||void 0===n.value)throw new Error("Parameter y contains a unit with undefined value");if(!t.equalBase(n))throw new Error("Units do not match");var i=t.clone();return i.value=e.find(A,[i.valueType(),n.valueType()])(i.value,n.value),i.fixPrefix=!1,i}}))})})),nr=mA("cbrt",["config","typed","isNegative","unaryMinus","matrix","Complex","BigNumber","Fraction"],(function(A){var e=A.config,t=A.typed,n=A.isNegative,i=A.unaryMinus,a=A.matrix,B=A.Complex,c=A.BigNumber,g=A.Fraction;return t("cbrt",{number:Ri,Complex:E,"Complex, boolean":E,BigNumber:function(A){return A.cbrt()},Unit:function(A){if(A.value&&o(A.value)){var e=A.clone();return e.value=1,(e=e.pow(1/3)).value=E(A.value),e}var t,a=n(A.value);a&&(A.value=i(A.value)),t=r(A.value)?new c(1).div(3):s(A.value)?new g(1,3):1/3;var B=A.pow(t);return a&&(B.value=i(B.value)),B}});function E(A,t){var n=A.arg()/3,i=A.abs(),r=new B(Ri(i),0).mul(new B(0,n).exp());if(t){var o=[r,new B(Ri(i),0).mul(new B(0,n+2*Math.PI/3).exp()),new B(Ri(i),0).mul(new B(0,n-2*Math.PI/3).exp())];return"Array"===e.matrix?o:a(o)}return r}}));function ir(A,e){return function(A){if(Array.isArray(A))return A}(A)||function(A,e){var t=null==A?null:"undefined"!=typeof Symbol&&A[Symbol.iterator]||A["@@iterator"];if(null!=t){var n,i,r,o,s=[],a=!0,B=!1;try{if(r=(t=t.call(A)).next,0===e){if(Object(t)!==t)return;a=!1}else for(;!(a=(n=r.call(t)).done)&&(s.push(n.value),s.length!==e);a=!0);}catch(A){B=!0,i=A}finally{try{if(!a&&null!=t.return&&(o=t.return(),Object(o)!==o))return}finally{if(B)throw i}}return s}}(A,e)||Jt(A,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var rr=mA("matAlgo11xS0s",["typed","equalScalar"],(function(A){var e=A.typed,t=A.equalScalar;return function(A,n,i,r){var o=A._values,s=A._index,a=A._ptr,B=A._size,c=A._datatype;if(!o)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var g,E=B[0],Q=B[1],u=t,l=0,w=i;"string"==typeof c&&(g=c,u=e.find(t,[g,g]),l=e.convert(0,g),n=e.convert(n,g),w=e.find(i,[g,g]));for(var h=[],C=[],I=[],M=0;M<Q;M++){I[M]=C.length;for(var d=a[M],m=a[M+1],p=d;p<m;p++){var F=s[p],D=r?w(n,o[p]):w(o[p],n);u(D,l)||(C.push(F),h.push(D))}}return I[Q]=C.length,A.createSparseMatrix({values:h,index:C,ptr:I,size:[E,Q],datatype:g})}})),or=mA("matAlgo12xSfs",["typed","DenseMatrix"],(function(A){var e=A.typed,t=A.DenseMatrix;return function(A,n,i,r){var o=A._values,s=A._index,a=A._ptr,B=A._size,c=A._datatype;if(!o)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var g,E=B[0],Q=B[1],u=i;"string"==typeof c&&(g=c,n=e.convert(n,g),u=e.find(i,[g,g]));for(var l=[],w=[],h=[],C=0;C<Q;C++){for(var I=C+1,M=a[C],d=a[C+1],m=M;m<d;m++){var p=s[m];w[p]=o[m],h[p]=I}for(var F=0;F<E;F++)0===C&&(l[F]=[]),h[F]===I?l[F][C]=r?u(n,w[F]):u(w[F],n):l[F][C]=r?u(n,0):u(0,n)}return new t({data:l,size:[E,Q],datatype:g})}})),sr=mA("matAlgo14xDs",["typed"],(function(A){var e=A.typed;return function(A,t,n,i){var r,o=A._data,s=A._size,a=A._datatype,B=n;"string"==typeof a&&(r=a,t=e.convert(t,r),B=e.find(n,[r,r]));var c=s.length>0?function A(e,t,n,i,r,o,s){var a=[];if(t===n.length-1)for(var B=0;B<i;B++)a[B]=s?e(o,r[B]):e(r[B],o);else for(var c=0;c<i;c++)a[c]=A(e,t+1,n,n[t+1],r[c],o,s);return a}(B,0,s,s[0],o,t,i):[];return A.createDenseMatrix({data:c,size:uA(s),datatype:r})}})),ar="ceil",Br=mA(ar,["typed","config","round"],(function(A){var e=A.typed,t=A.config,n=A.round;return e(ar,{number:function(A){return sA(A,n(A),t.epsilon)?n(A):Math.ceil(A)},"number, number":function(A,e){if(sA(A,n(A,e),t.epsilon))return n(A,e);var i=ir("".concat(A,"e").split("e"),2),r=i[0],o=i[1],s=Math.ceil(Number("".concat(r,"e").concat(Number(o)+e))),a=ir("".concat(s,"e").split("e"),2);return r=a[0],o=a[1],Number("".concat(r,"e").concat(Number(o)-e))}})})),cr=mA(ar,["typed","config","round","matrix","equalScalar","zeros","DenseMatrix"],(function(A){var e=A.typed,t=A.config,n=A.round,i=A.matrix,r=A.equalScalar,o=A.zeros,s=A.DenseMatrix,a=rr({typed:e,equalScalar:r}),B=or({typed:e,DenseMatrix:s}),c=sr({typed:e}),g=Br({typed:e,config:t,round:n});return e("ceil",{number:g.signatures.number,"number,number":g.signatures["number,number"],Complex:function(A){return A.ceil()},"Complex, number":function(A,e){return A.ceil(e)},"Complex, BigNumber":function(A,e){return A.ceil(e.toNumber())},BigNumber:function(A){return ti(A,n(A),t.epsilon)?n(A):A.ceil()},"BigNumber, BigNumber":function(A,e){return ti(A,n(A,e),t.epsilon)?n(A,e):A.toDecimalPlaces(e.toNumber(),yt.ROUND_CEIL)},Fraction:function(A){return A.ceil()},"Fraction, number":function(A,e){return A.ceil(e)},"Fraction, BigNumber":function(A,e){return A.ceil(e.toNumber())},"Array | Matrix":e.referToSelf((function(A){return function(e){return Gn(e,A,!0)}})),"Array, number | BigNumber":e.referToSelf((function(A){return function(e,t){return Gn(e,(function(e){return A(e,t)}),!0)}})),"SparseMatrix, number | BigNumber":e.referToSelf((function(A){return function(e,t){return a(e,t,A,!1)}})),"DenseMatrix, number | BigNumber":e.referToSelf((function(A){return function(e,t){return c(e,t,A,!1)}})),"number | Complex | Fraction | BigNumber, Array":e.referToSelf((function(A){return function(e,t){return c(i(t),e,A,!0).valueOf()}})),"number | Complex | Fraction | BigNumber, Matrix":e.referToSelf((function(A){return function(e,t){return r(e,0)?o(t.size(),t.storage()):"dense"===t.storage()?c(t,e,A,!0):B(t,e,A,!0)}}))})})),gr=mA("cube",["typed"],(function(A){return(0,A.typed)("cube",{number:Gi,Complex:function(A){return A.mul(A).mul(A)},BigNumber:function(A){return A.times(A).times(A)},Fraction:function(A){return A.pow(3)},Unit:function(A){return A.pow(3)}})})),Er=mA("exp",["typed"],(function(A){return(0,A.typed)("exp",{number:Si,Complex:function(A){return A.exp()},BigNumber:function(A){return A.exp()}})})),Qr=mA("expm1",["typed","Complex"],(function(A){var e=A.typed,t=A.Complex;return e("expm1",{number:Hi,Complex:function(A){var e=Math.exp(A.re);return new t(e*Math.cos(A.im)-1,e*Math.sin(A.im))},BigNumber:function(A){return A.exp().minus(1)}})})),ur=mA("fix",["typed","ceil","floor"],(function(A){var e=A.typed,t=A.ceil,n=A.floor;return e("fix",{number:function(A){return A>0?n(A):t(A)},"number, number":function(A,e){return A>0?n(A,e):t(A,e)}})})),lr=mA("fix",["typed","Complex","matrix","ceil","floor","equalScalar","zeros","DenseMatrix"],(function(A){var e=A.typed,t=A.Complex,n=A.matrix,i=A.ceil,r=A.floor,o=A.equalScalar,s=A.zeros,a=A.DenseMatrix,B=or({typed:e,DenseMatrix:a}),c=sr({typed:e}),g=ur({typed:e,ceil:i,floor:r});return e("fix",{number:g.signatures.number,"number, number | BigNumber":g.signatures["number,number"],Complex:function(A){return new t(A.re>0?Math.floor(A.re):Math.ceil(A.re),A.im>0?Math.floor(A.im):Math.ceil(A.im))},"Complex, number":function(A,e){return new t(A.re>0?r(A.re,e):i(A.re,e),A.im>0?r(A.im,e):i(A.im,e))},"Complex, BigNumber":function(A,e){var n=e.toNumber();return new t(A.re>0?r(A.re,n):i(A.re,n),A.im>0?r(A.im,n):i(A.im,n))},BigNumber:function(A){return A.isNegative()?i(A):r(A)},"BigNumber, number | BigNumber":function(A,e){return A.isNegative()?i(A,e):r(A,e)},Fraction:function(A){return A.s<0?A.ceil():A.floor()},"Fraction, number | BigNumber":function(A,e){return A.s<0?i(A,e):r(A,e)},"Array | Matrix":e.referToSelf((function(A){return function(e){return Gn(e,A,!0)}})),"Array | Matrix, number | BigNumber":e.referToSelf((function(A){return function(e,t){return Gn(e,(function(e){return A(e,t)}),!0)}})),"number | Complex | Fraction | BigNumber, Array":e.referToSelf((function(A){return function(e,t){return c(n(t),e,A,!0).valueOf()}})),"number | Complex | Fraction | BigNumber, Matrix":e.referToSelf((function(A){return function(e,t){return o(e,0)?s(t.size(),t.storage()):"dense"===t.storage()?c(t,e,A,!0):B(t,e,A,!0)}}))})})),wr="floor",hr=mA(wr,["typed","config","round"],(function(A){var e=A.typed,t=A.config,n=A.round;return e(wr,{number:function(A){return sA(A,n(A),t.epsilon)?n(A):Math.floor(A)},"number, number":function(A,e){if(sA(A,n(A,e),t.epsilon))return n(A,e);var i=ir("".concat(A,"e").split("e"),2),r=i[0],o=i[1],s=Math.floor(Number("".concat(r,"e").concat(Number(o)+e))),a=ir("".concat(s,"e").split("e"),2);return r=a[0],o=a[1],Number("".concat(r,"e").concat(Number(o)-e))}})})),Cr=mA(wr,["typed","config","round","matrix","equalScalar","zeros","DenseMatrix"],(function(A){var e=A.typed,t=A.config,n=A.round,i=A.matrix,r=A.equalScalar,o=A.zeros,s=A.DenseMatrix,a=rr({typed:e,equalScalar:r}),B=or({typed:e,DenseMatrix:s}),c=sr({typed:e}),g=hr({typed:e,config:t,round:n});return e("floor",{number:g.signatures.number,"number,number":g.signatures["number,number"],Complex:function(A){return A.floor()},"Complex, number":function(A,e){return A.floor(e)},"Complex, BigNumber":function(A,e){return A.floor(e.toNumber())},BigNumber:function(A){return ti(A,n(A),t.epsilon)?n(A):A.floor()},"BigNumber, BigNumber":function(A,e){return ti(A,n(A,e),t.epsilon)?n(A,e):A.toDecimalPlaces(e.toNumber(),yt.ROUND_FLOOR)},Fraction:function(A){return A.floor()},"Fraction, number":function(A,e){return A.floor(e)},"Fraction, BigNumber":function(A,e){return A.floor(e.toNumber())},"Array | Matrix":e.referToSelf((function(A){return function(e){return Gn(e,A,!0)}})),"Array, number | BigNumber":e.referToSelf((function(A){return function(e,t){return Gn(e,(function(e){return A(e,t)}),!0)}})),"SparseMatrix, number | BigNumber":e.referToSelf((function(A){return function(e,t){return a(e,t,A,!1)}})),"DenseMatrix, number | BigNumber":e.referToSelf((function(A){return function(e,t){return c(e,t,A,!1)}})),"number | Complex | Fraction | BigNumber, Array":e.referToSelf((function(A){return function(e,t){return c(i(t),e,A,!0).valueOf()}})),"number | Complex | Fraction | BigNumber, Matrix":e.referToSelf((function(A){return function(e,t){return r(e,0)?o(t.size(),t.storage()):"dense"===t.storage()?c(t,e,A,!0):B(t,e,A,!0)}}))})}));function Ir(A,e,t){return(e=YA(e))in A?Object.defineProperty(A,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):A[e]=t,A}var Mr=mA("matAlgo02xDS0",["typed","equalScalar"],(function(A){var e=A.typed,t=A.equalScalar;return function(A,n,i,r){var o=A._data,s=A._size,a=A._datatype,B=n._values,c=n._index,g=n._ptr,E=n._size,Q=n._datatype;if(s.length!==E.length)throw new _t(s.length,E.length);if(s[0]!==E[0]||s[1]!==E[1])throw new RangeError("Dimension mismatch. Matrix A ("+s+") must match Matrix B ("+E+")");if(!B)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var u,l=s[0],w=s[1],h=t,C=0,I=i;"string"==typeof a&&a===Q&&(u=a,h=e.find(t,[u,u]),C=e.convert(0,u),I=e.find(i,[u,u]));for(var M=[],d=[],m=[],p=0;p<w;p++){m[p]=d.length;for(var F=g[p],D=g[p+1],Y=F;Y<D;Y++){var f=c[Y],N=r?I(B[Y],o[f][p]):I(o[f][p],B[Y]);h(N,C)||(d.push(f),M.push(N))}}return m[w]=d.length,n.createSparseMatrix({values:M,index:d,ptr:m,size:[l,w],datatype:u})}})),dr=mA("matAlgo03xDSf",["typed"],(function(A){var e=A.typed;return function(A,t,n,i){var r=A._data,o=A._size,s=A._datatype,a=t._values,B=t._index,c=t._ptr,g=t._size,E=t._datatype;if(o.length!==g.length)throw new _t(o.length,g.length);if(o[0]!==g[0]||o[1]!==g[1])throw new RangeError("Dimension mismatch. Matrix A ("+o+") must match Matrix B ("+g+")");if(!a)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var Q,u=o[0],l=o[1],w=0,h=n;"string"==typeof s&&s===E&&(Q=s,w=e.convert(0,Q),h=e.find(n,[Q,Q]));for(var C=[],I=0;I<u;I++)C[I]=[];for(var M=[],d=[],m=0;m<l;m++){for(var p=m+1,F=c[m],D=c[m+1],Y=F;Y<D;Y++){var f=B[Y];M[f]=i?h(a[Y],r[f][m]):h(r[f][m],a[Y]),d[f]=p}for(var N=0;N<u;N++)d[N]===p?C[N][m]=M[N]:C[N][m]=i?h(w,r[N][m]):h(r[N][m],w)}return A.createDenseMatrix({data:C,size:[u,l],datatype:Q})}})),mr=mA("matAlgo05xSfSf",["typed","equalScalar"],(function(A){var e=A.typed,t=A.equalScalar;return function(A,n,i){var r=A._values,o=A._index,s=A._ptr,a=A._size,B=A._datatype,c=n._values,g=n._index,E=n._ptr,Q=n._size,u=n._datatype;if(a.length!==Q.length)throw new _t(a.length,Q.length);if(a[0]!==Q[0]||a[1]!==Q[1])throw new RangeError("Dimension mismatch. Matrix A ("+a+") must match Matrix B ("+Q+")");var l,w=a[0],h=a[1],C=t,I=0,M=i;"string"==typeof B&&B===u&&(l=B,C=e.find(t,[l,l]),I=e.convert(0,l),M=e.find(i,[l,l]));var d,m,p,F,D=r&&c?[]:void 0,Y=[],f=[],N=D?[]:void 0,U=D?[]:void 0,y=[],T=[];for(m=0;m<h;m++){f[m]=Y.length;var x=m+1;for(p=s[m],F=s[m+1];p<F;p++)d=o[p],Y.push(d),y[d]=x,N&&(N[d]=r[p]);for(p=E[m],F=E[m+1];p<F;p++)y[d=g[p]]!==x&&Y.push(d),T[d]=x,U&&(U[d]=c[p]);if(D)for(p=f[m];p<Y.length;){var R=y[d=Y[p]],G=T[d];if(R===x||G===x){var S=M(R===x?N[d]:I,G===x?U[d]:I);C(S,I)?Y.splice(p,1):(D.push(S),p++)}}}return f[h]=Y.length,A.createSparseMatrix({values:D,index:Y,ptr:f,size:[w,h],datatype:l})}})),pr=mA("matAlgo13xDD",["typed"],(function(A){var e=A.typed;return function(A,t,n){var i,r=A._data,o=A._size,s=A._datatype,a=t._data,B=t._size,c=t._datatype,g=[];if(o.length!==B.length)throw new _t(o.length,B.length);for(var E=0;E<o.length;E++){if(o[E]!==B[E])throw new RangeError("Dimension mismatch. Matrix A ("+o+") must match Matrix B ("+B+")");g[E]=o[E]}var Q=n;"string"==typeof s&&s===c&&(i=s,Q=e.find(n,[i,i]));var u=g.length>0?function A(e,t,n,i,r,o){var s=[];if(t===n.length-1)for(var a=0;a<i;a++)s[a]=e(r[a],o[a]);else for(var B=0;B<i;B++)s[B]=A(e,t+1,n,n[t+1],r[B],o[B]);return s}(Q,0,g,g[0],r,a):[];return A.createDenseMatrix({data:u,size:g,datatype:i})}})),Fr=mA("broadcast",["concat"],(function(A){var e=A.concat;return function(A,e){var i=Math.max(A._size.length,e._size.length);if(A._size.length===e._size.length&&A._size.every((function(A,t){return A===e._size[t]})))return[A,e];for(var r=t(A._size,i,0),o=t(e._size,i,0),s=[],a=0;a<i;a++)s[a]=Math.max(r[a],o[a]);pn(r,s),pn(o,s);var B=A.clone(),c=e.clone();B._size.length<i?B.reshape(t(B._size,i,1)):c._size.length<i&&c.reshape(t(c._size,i,1));for(var g=0;g<i;g++)B._size[g]<s[g]&&(B=n(B,s[g],g)),c._size[g]<s[g]&&(c=n(c,s[g],g));return[B,c]};function t(A,e,t){return[].concat(zt(Array(e-A.length).fill(t)),zt(A))}function n(A,t,n){return e.apply(void 0,zt(Array(t).fill(A)).concat([n]))}})),Dr=mA("matrixAlgorithmSuite",["typed","matrix","concat"],(function(A){var e=A.typed,t=A.matrix,n=A.concat,i=pr({typed:e}),r=sr({typed:e}),o=Fr({concat:n});return function(A){var n,s=A.elop,a=A.SD||A.DS;s?(n={"DenseMatrix, DenseMatrix":function(A,e){return i.apply(void 0,zt(o(A,e)).concat([s]))},"Array, Array":function(A,e){return i.apply(void 0,zt(o(t(A),t(e))).concat([s])).valueOf()},"Array, DenseMatrix":function(A,e){return i.apply(void 0,zt(o(t(A),e)).concat([s]))},"DenseMatrix, Array":function(A,e){return i.apply(void 0,zt(o(A,t(e))).concat([s]))}},A.SS&&(n["SparseMatrix, SparseMatrix"]=function(e,t){return A.SS.apply(A,zt(o(e,t)).concat([s,!1]))}),A.DS&&(n["DenseMatrix, SparseMatrix"]=function(e,t){return A.DS.apply(A,zt(o(e,t)).concat([s,!1]))},n["Array, SparseMatrix"]=function(e,n){return A.DS.apply(A,zt(o(t(e),n)).concat([s,!1]))}),a&&(n["SparseMatrix, DenseMatrix"]=function(A,e){return a.apply(void 0,zt(o(e,A)).concat([s,!0]))},n["SparseMatrix, Array"]=function(A,e){return a.apply(void 0,zt(o(t(e),A)).concat([s,!0]))})):(n={"DenseMatrix, DenseMatrix":e.referToSelf((function(A){return function(e,t){return i.apply(void 0,zt(o(e,t)).concat([A]))}})),"Array, Array":e.referToSelf((function(A){return function(e,n){return i.apply(void 0,zt(o(t(e),t(n))).concat([A])).valueOf()}})),"Array, DenseMatrix":e.referToSelf((function(A){return function(e,n){return i.apply(void 0,zt(o(t(e),n)).concat([A]))}})),"DenseMatrix, Array":e.referToSelf((function(A){return function(e,n){return i.apply(void 0,zt(o(e,t(n))).concat([A]))}}))},A.SS&&(n["SparseMatrix, SparseMatrix"]=e.referToSelf((function(e){return function(t,n){return A.SS.apply(A,zt(o(t,n)).concat([e,!1]))}}))),A.DS&&(n["DenseMatrix, SparseMatrix"]=e.referToSelf((function(e){return function(t,n){return A.DS.apply(A,zt(o(t,n)).concat([e,!1]))}})),n["Array, SparseMatrix"]=e.referToSelf((function(e){return function(n,i){return A.DS.apply(A,zt(o(t(n),i)).concat([e,!1]))}}))),a&&(n["SparseMatrix, DenseMatrix"]=e.referToSelf((function(A){return function(e,t){return a.apply(void 0,zt(o(t,e)).concat([A,!0]))}})),n["SparseMatrix, Array"]=e.referToSelf((function(A){return function(e,n){return a.apply(void 0,zt(o(t(n),e)).concat([A,!0]))}}))));var B=A.scalar||"any";(A.Ds||A.Ss)&&(s?(n["DenseMatrix,"+B]=function(A,e){return r(A,e,s,!1)},n[B+", DenseMatrix"]=function(A,e){return r(e,A,s,!0)},n["Array,"+B]=function(A,e){return r(t(A),e,s,!1).valueOf()},n[B+", Array"]=function(A,e){return r(t(e),A,s,!0).valueOf()}):(n["DenseMatrix,"+B]=e.referToSelf((function(A){return function(e,t){return r(e,t,A,!1)}})),n[B+", DenseMatrix"]=e.referToSelf((function(A){return function(e,t){return r(t,e,A,!0)}})),n["Array,"+B]=e.referToSelf((function(A){return function(e,n){return r(t(e),n,A,!1).valueOf()}})),n[B+", Array"]=e.referToSelf((function(A){return function(e,n){return r(t(n),e,A,!0).valueOf()}}))));var c=void 0!==A.sS?A.sS:A.Ss;return s?(A.Ss&&(n["SparseMatrix,"+B]=function(e,t){return A.Ss(e,t,s,!1)}),c&&(n[B+", SparseMatrix"]=function(A,e){return c(e,A,s,!0)})):(A.Ss&&(n["SparseMatrix,"+B]=e.referToSelf((function(e){return function(t,n){return A.Ss(t,n,e,!1)}}))),c&&(n[B+", SparseMatrix"]=e.referToSelf((function(A){return function(e,t){return c(t,e,A,!0)}})))),s&&s.signatures&&wA(n,s.signatures),n}})),Yr=mA("mod",["typed","config","round","matrix","equalScalar","zeros","DenseMatrix","concat"],(function(A){var e=A.typed,t=A.config,n=A.round,i=A.matrix,r=A.equalScalar,o=A.zeros,s=A.DenseMatrix,a=A.concat,B=Cr({typed:e,config:t,round:n,matrix:i,equalScalar:r,zeros:o,DenseMatrix:s}),c=Mr({typed:e,equalScalar:r}),g=dr({typed:e}),E=mr({typed:e,equalScalar:r}),Q=rr({typed:e,equalScalar:r}),u=or({typed:e,DenseMatrix:s});return e("mod",{"number, number":function(A,e){return 0===e?A:A-e*B(A/e)},"BigNumber, BigNumber":function(A,e){if(e.isNeg())throw new Error("Cannot calculate mod for a negative divisor");return e.isZero()?A:A.mod(e)},"Fraction, Fraction":function(A,e){if(e.compare(0)<0)throw new Error("Cannot calculate mod for a negative divisor");return A.compare(0)>=0?A.mod(e):A.mod(e).add(e).mod(e)}},Dr({typed:e,matrix:i,concat:a})({SS:E,DS:g,SD:c,Ss:Q,sS:u}))})),fr=mA("matAlgo01xDSid",["typed"],(function(A){var e=A.typed;return function(A,t,n,i){var r=A._data,o=A._size,s=A._datatype,a=t._values,B=t._index,c=t._ptr,g=t._size,E=t._datatype;if(o.length!==g.length)throw new _t(o.length,g.length);if(o[0]!==g[0]||o[1]!==g[1])throw new RangeError("Dimension mismatch. Matrix A ("+o+") must match Matrix B ("+g+")");if(!a)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var Q,u,l=o[0],w=o[1],h="string"==typeof s&&s===E?s:void 0,C=h?e.find(n,[h,h]):n,I=[];for(Q=0;Q<l;Q++)I[Q]=[];var M=[],d=[];for(u=0;u<w;u++){for(var m=u+1,p=c[u],F=c[u+1],D=p;D<F;D++)M[Q=B[D]]=i?C(a[D],r[Q][u]):C(r[Q][u],a[D]),d[Q]=m;for(Q=0;Q<l;Q++)d[Q]===m?I[Q][u]=M[Q]:I[Q][u]=r[Q][u]}return A.createDenseMatrix({data:I,size:[l,w],datatype:h})}})),Nr=mA("matAlgo04xSidSid",["typed","equalScalar"],(function(A){var e=A.typed,t=A.equalScalar;return function(A,n,i){var r=A._values,o=A._index,s=A._ptr,a=A._size,B=A._datatype,c=n._values,g=n._index,E=n._ptr,Q=n._size,u=n._datatype;if(a.length!==Q.length)throw new _t(a.length,Q.length);if(a[0]!==Q[0]||a[1]!==Q[1])throw new RangeError("Dimension mismatch. Matrix A ("+a+") must match Matrix B ("+Q+")");var l,w=a[0],h=a[1],C=t,I=0,M=i;"string"==typeof B&&B===u&&(l=B,C=e.find(t,[l,l]),I=e.convert(0,l),M=e.find(i,[l,l]));var d,m,p,F,D,Y=r&&c?[]:void 0,f=[],N=[],U=r&&c?[]:void 0,y=r&&c?[]:void 0,T=[],x=[];for(m=0;m<h;m++){N[m]=f.length;var R=m+1;for(F=s[m],D=s[m+1],p=F;p<D;p++)d=o[p],f.push(d),T[d]=R,U&&(U[d]=r[p]);for(F=E[m],D=E[m+1],p=F;p<D;p++)if(T[d=g[p]]===R){if(U){var G=M(U[d],c[p]);C(G,I)?T[d]=null:U[d]=G}}else f.push(d),x[d]=R,y&&(y[d]=c[p]);if(U&&y)for(p=N[m];p<f.length;)T[d=f[p]]===R?(Y[p]=U[d],p++):x[d]===R?(Y[p]=y[d],p++):f.splice(p,1)}return N[h]=f.length,A.createSparseMatrix({values:Y,index:f,ptr:N,size:[w,h],datatype:l})}})),Ur=mA("matAlgo10xSids",["typed","DenseMatrix"],(function(A){var e=A.typed,t=A.DenseMatrix;return function(A,n,i,r){var o=A._values,s=A._index,a=A._ptr,B=A._size,c=A._datatype;if(!o)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var g,E=B[0],Q=B[1],u=i;"string"==typeof c&&(g=c,n=e.convert(n,g),u=e.find(i,[g,g]));for(var l=[],w=[],h=[],C=0;C<Q;C++){for(var I=C+1,M=a[C],d=a[C+1],m=M;m<d;m++){var p=s[m];w[p]=o[m],h[p]=I}for(var F=0;F<E;F++)0===C&&(l[F]=[]),h[F]===I?l[F][C]=r?u(n,w[F]):u(w[F],n):l[F][C]=n}return new t({data:l,size:[E,Q],datatype:g})}}));function yr(A,e,t,n){if(!(this instanceof yr))throw new SyntaxError("Constructor must be called with the new operator");this.fn=A,this.count=e,this.min=t,this.max=n,this.message="Wrong number of arguments in function "+A+" ("+e+" provided, "+t+(null!=n?"-"+n:"")+" expected)",this.stack=(new Error).stack}yr.prototype=new Error,yr.prototype.constructor=Error,yr.prototype.name="ArgumentsError",yr.prototype.isArgumentsError=!0;var Tr="number | BigNumber | Fraction | Matrix | Array",xr="".concat(Tr,", ").concat(Tr,", ...").concat(Tr);function Rr(A){return!A.some((function(A){return Array.isArray(A)}))}var Gr=mA("gcd",["typed","config","round","matrix","equalScalar","zeros","BigNumber","DenseMatrix","concat"],(function(A){var e,t=A.typed,n=A.matrix,i=A.config,r=A.round,o=A.equalScalar,s=A.zeros,a=A.BigNumber,B=A.DenseMatrix,c=A.concat,g=Yr({typed:t,config:i,round:r,matrix:n,equalScalar:o,zeros:s,DenseMatrix:B,concat:c}),E=fr({typed:t}),Q=Nr({typed:t,equalScalar:o}),u=Ur({typed:t,DenseMatrix:B});return t("gcd",{"number, number":function(A,e){if(!V(A)||!V(e))throw new Error("Parameters in function gcd must be integer numbers");for(var t;0!==e;)t=g(A,e),A=e,e=t;return A<0?-A:A},"BigNumber, BigNumber":function(A,e){if(!A.isInt()||!e.isInt())throw new Error("Parameters in function gcd must be integer numbers");for(var t=new a(0);!e.isZero();){var n=g(A,e);A=e,e=n}return A.lt(t)?A.neg():A},"Fraction, Fraction":function(A,e){return A.gcd(e)}},Dr({typed:t,matrix:n,concat:c})({SS:Q,DS:E,Ss:u}),(Ir(e={},xr,t.referToSelf((function(A){return function(e,t,n){for(var i=A(e,t),r=0;r<n.length;r++)i=A(i,n[r]);return i}}))),Ir(e,"Array",t.referToSelf((function(A){return function(e){if(1===e.length&&Array.isArray(e[0])&&Rr(e[0]))return A.apply(void 0,zt(e[0]));if(Rr(e))return A.apply(void 0,zt(e));throw new yr("gcd() supports only 1d matrices!")}}))),Ir(e,"Matrix",t.referToSelf((function(A){return function(e){return A(e.toArray())}}))),e))})),Sr=mA("matAlgo06xS0S0",["typed","equalScalar"],(function(A){var e=A.typed,t=A.equalScalar;return function(A,n,i){var r=A._values,o=A._size,s=A._datatype,a=n._values,B=n._size,c=n._datatype;if(o.length!==B.length)throw new _t(o.length,B.length);if(o[0]!==B[0]||o[1]!==B[1])throw new RangeError("Dimension mismatch. Matrix A ("+o+") must match Matrix B ("+B+")");var g,E=o[0],Q=o[1],u=t,l=0,w=i;"string"==typeof s&&s===c&&(g=s,u=e.find(t,[g,g]),l=e.convert(0,g),w=e.find(i,[g,g]));for(var h=r&&a?[]:void 0,C=[],I=[],M=h?[]:void 0,d=[],m=[],p=0;p<Q;p++){I[p]=C.length;var F=p+1;if(bn(A,p,d,M,m,F,C,w),bn(n,p,d,M,m,F,C,w),M)for(var D=I[p];D<C.length;){var Y=C[D];if(m[Y]===F){var f=M[Y];u(f,l)?C.splice(D,1):(h.push(f),D++)}else C.splice(D,1)}else for(var N=I[p];N<C.length;)m[C[N]]!==F?C.splice(N,1):N++}return I[Q]=C.length,A.createSparseMatrix({values:h,index:C,ptr:I,size:[E,Q],datatype:g})}})),Hr=mA("lcm",["typed","matrix","equalScalar","concat"],(function(A){var e=A.typed,t=A.matrix,n=A.equalScalar,i=A.concat,r=Mr({typed:e,equalScalar:n}),o=Sr({typed:e,equalScalar:n}),s=rr({typed:e,equalScalar:n}),a=Dr({typed:e,matrix:t,concat:i}),B="number | BigNumber | Fraction | Matrix | Array",c={};return c["".concat(B,", ").concat(B,", ...").concat(B)]=e.referToSelf((function(A){return function(e,t,n){for(var i=A(e,t),r=0;r<n.length;r++)i=A(i,n[r]);return i}})),e("lcm",{"number, number":bi,"BigNumber, BigNumber":function(A,e){if(!A.isInt()||!e.isInt())throw new Error("Parameters in function lcm must be integer numbers");if(A.isZero())return A;if(e.isZero())return e;for(var t=A.times(e);!e.isZero();){var n=e;e=A.mod(n),A=n}return t.div(A).abs()},"Fraction, Fraction":function(A,e){return A.lcm(e)}},a({SS:o,DS:r,Ss:s}),c)})),br=mA("log10",["typed","config","Complex"],(function(A){var e=A.typed,t=A.config,n=A.Complex;return e("log10",{number:function(A){return A>=0||t.predictable?vi(A):new n(A,0).log().div(Math.LN10)},Complex:function(A){return new n(A).log().div(Math.LN10)},BigNumber:function(A){return!A.isNegative()||t.predictable?A.log():new n(A.toNumber(),0).log().div(Math.LN10)},"Array | Matrix":e.referToSelf((function(A){return function(e){return Gn(e,A)}}))})})),vr=mA("log2",["typed","config","Complex"],(function(A){var e=A.typed,t=A.config,n=A.Complex;return e("log2",{number:function(A){return A>=0||t.predictable?ki(A):i(new n(A,0))},Complex:i,BigNumber:function(A){return!A.isNegative()||t.predictable?A.log(2):i(new n(A.toNumber(),0))},"Array | Matrix":e.referToSelf((function(A){return function(e){return Gn(e,A)}}))});function i(A){var e=Math.sqrt(A.re*A.re+A.im*A.im);return new n(Math.log2?Math.log2(e):Math.log(e)/Math.LN2,Math.atan2(A.im,A.re)/Math.LN2)}})),kr=mA("multiplyScalar",["typed"],(function(A){return(0,A.typed)("multiplyScalar",{"number, number":yi,"Complex, Complex":function(A,e){return A.mul(e)},"BigNumber, BigNumber":function(A,e){return A.times(e)},"Fraction, Fraction":function(A,e){return A.mul(e)},"number | Fraction | BigNumber | Complex, Unit":function(A,e){return e.multiply(A)},"Unit, number | Fraction | BigNumber | Complex | Unit":function(A,e){return A.multiply(e)}})})),jr="multiply",Jr=mA(jr,["typed","matrix","addScalar","multiplyScalar","equalScalar","dot"],(function(A){var e=A.typed,t=A.matrix,n=A.addScalar,i=A.multiplyScalar,r=A.equalScalar,o=A.dot,s=rr({typed:e,equalScalar:r}),a=sr({typed:e});function B(A,e){switch(A.length){case 1:switch(e.length){case 1:if(A[0]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(A[0]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+A[0]+") must match Matrix rows ("+e[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+e.length+" dimensions)")}break;case 2:switch(e.length){case 1:if(A[1]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+A[1]+") must match Vector length ("+e[0]+")");break;case 2:if(A[1]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+A[1]+") must match Matrix B rows ("+e[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+e.length+" dimensions)")}break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+A.length+" dimensions)")}}var c=e("_multiplyMatrixVector",{"DenseMatrix, any":function(A,t){var r,o=A._data,s=A._size,a=A._datatype,B=t._data,c=t._datatype,g=s[0],E=s[1],Q=n,u=i;a&&c&&a===c&&"string"==typeof a&&(r=a,Q=e.find(n,[r,r]),u=e.find(i,[r,r]));for(var l=[],w=0;w<g;w++){for(var h=o[w],C=u(h[0],B[0]),I=1;I<E;I++)C=Q(C,u(h[I],B[I]));l[w]=C}return A.createDenseMatrix({data:l,size:[g],datatype:r})},"SparseMatrix, any":function(A,t){var o=A._values,s=A._index,a=A._ptr,B=A._datatype;if(!o)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var c,g=t._data,E=t._datatype,Q=A._size[0],u=t._size[0],l=[],w=[],h=[],C=n,I=i,M=r,d=0;B&&E&&B===E&&"string"==typeof B&&(c=B,C=e.find(n,[c,c]),I=e.find(i,[c,c]),M=e.find(r,[c,c]),d=e.convert(0,c));var m=[],p=[];h[0]=0;for(var F=0;F<u;F++){var D=g[F];if(!M(D,d))for(var Y=a[F],f=a[F+1],N=Y;N<f;N++){var U=s[N];p[U]?m[U]=C(m[U],I(D,o[N])):(p[U]=!0,w.push(U),m[U]=I(D,o[N]))}}for(var y=w.length,T=0;T<y;T++){var x=w[T];l[T]=m[x]}return h[1]=w.length,A.createSparseMatrix({values:l,index:w,ptr:h,size:[Q,1],datatype:c})}}),E=e("_multiplyMatrixMatrix",{"DenseMatrix, DenseMatrix":function(A,t){var r,o=A._data,s=A._size,a=A._datatype,B=t._data,c=t._size,g=t._datatype,E=s[0],Q=s[1],u=c[1],l=n,w=i;a&&g&&a===g&&"string"==typeof a&&(r=a,l=e.find(n,[r,r]),w=e.find(i,[r,r]));for(var h=[],C=0;C<E;C++){var I=o[C];h[C]=[];for(var M=0;M<u;M++){for(var d=w(I[0],B[0][M]),m=1;m<Q;m++)d=l(d,w(I[m],B[m][M]));h[C][M]=d}}return A.createDenseMatrix({data:h,size:[E,u],datatype:r})},"DenseMatrix, SparseMatrix":function(A,t){var o=A._data,s=A._size,a=A._datatype,B=t._values,c=t._index,g=t._ptr,E=t._size,Q=t._datatype;if(!B)throw new Error("Cannot multiply Dense Matrix times Pattern only Matrix");var u,l=s[0],w=E[1],h=n,C=i,I=r,M=0;a&&Q&&a===Q&&"string"==typeof a&&(u=a,h=e.find(n,[u,u]),C=e.find(i,[u,u]),I=e.find(r,[u,u]),M=e.convert(0,u));for(var d=[],m=[],p=[],F=t.createSparseMatrix({values:d,index:m,ptr:p,size:[l,w],datatype:u}),D=0;D<w;D++){p[D]=m.length;var Y=g[D],f=g[D+1];if(f>Y)for(var N=0,U=0;U<l;U++){for(var y=U+1,T=void 0,x=Y;x<f;x++){var R=c[x];N!==y?(T=C(o[U][R],B[x]),N=y):T=h(T,C(o[U][R],B[x]))}N!==y||I(T,M)||(m.push(U),d.push(T))}}return p[w]=m.length,F},"SparseMatrix, DenseMatrix":function(A,t){var o=A._values,s=A._index,a=A._ptr,B=A._datatype;if(!o)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var c,g=t._data,E=t._datatype,Q=A._size[0],u=t._size[0],l=t._size[1],w=n,h=i,C=r,I=0;B&&E&&B===E&&"string"==typeof B&&(c=B,w=e.find(n,[c,c]),h=e.find(i,[c,c]),C=e.find(r,[c,c]),I=e.convert(0,c));for(var M=[],d=[],m=[],p=A.createSparseMatrix({values:M,index:d,ptr:m,size:[Q,l],datatype:c}),F=[],D=[],Y=0;Y<l;Y++){m[Y]=d.length;for(var f=Y+1,N=0;N<u;N++){var U=g[N][Y];if(!C(U,I))for(var y=a[N],T=a[N+1],x=y;x<T;x++){var R=s[x];D[R]!==f?(D[R]=f,d.push(R),F[R]=h(U,o[x])):F[R]=w(F[R],h(U,o[x]))}}for(var G=m[Y],S=d.length,H=G;H<S;H++){var b=d[H];M[H]=F[b]}}return m[l]=d.length,p},"SparseMatrix, SparseMatrix":function(A,t){var r,o=A._values,s=A._index,a=A._ptr,B=A._datatype,c=t._values,g=t._index,E=t._ptr,Q=t._datatype,u=A._size[0],l=t._size[1],w=o&&c,h=n,C=i;B&&Q&&B===Q&&"string"==typeof B&&(r=B,h=e.find(n,[r,r]),C=e.find(i,[r,r]));for(var I,M,d,m,p,F,D,Y,f=w?[]:void 0,N=[],U=[],y=A.createSparseMatrix({values:f,index:N,ptr:U,size:[u,l],datatype:r}),T=w?[]:void 0,x=[],R=0;R<l;R++){U[R]=N.length;var G=R+1;for(p=E[R],F=E[R+1],m=p;m<F;m++)if(Y=g[m],w)for(M=a[Y],d=a[Y+1],I=M;I<d;I++)x[D=s[I]]!==G?(x[D]=G,N.push(D),T[D]=C(c[m],o[I])):T[D]=h(T[D],C(c[m],o[I]));else for(M=a[Y],d=a[Y+1],I=M;I<d;I++)x[D=s[I]]!==G&&(x[D]=G,N.push(D));if(w)for(var S=U[R],H=N.length,b=S;b<H;b++){var v=N[b];f[b]=T[v]}}return U[l]=N.length,y}});return e(jr,i,{"Array, Array":e.referTo("Matrix, Matrix",(function(A){return function(e,n){B($t(e),$t(n));var i=A(t(e),t(n));return g(i)?i.valueOf():i}})),"Matrix, Matrix":function(A,t){var r=A.size(),s=t.size();return B(r,s),1===r.length?1===s.length?function(A,e,t){if(0===t)throw new Error("Cannot multiply two empty vectors");return o(A,e)}(A,t,r[0]):function(A,t){if("dense"!==t.storage())throw new Error("Support for SparseMatrix not implemented");return function(A,t){var r,o=A._data,s=A._size,a=A._datatype,B=t._data,c=t._size,g=t._datatype,E=s[0],Q=c[1],u=n,l=i;a&&g&&a===g&&"string"==typeof a&&(r=a,u=e.find(n,[r,r]),l=e.find(i,[r,r]));for(var w=[],h=0;h<Q;h++){for(var C=l(o[0],B[0][h]),I=1;I<E;I++)C=u(C,l(o[I],B[I][h]));w[h]=C}return A.createDenseMatrix({data:w,size:[Q],datatype:r})}(A,t)}(A,t):1===s.length?c(A,t):E(A,t)},"Matrix, Array":e.referTo("Matrix,Matrix",(function(A){return function(e,n){return A(e,t(n))}})),"Array, Matrix":e.referToSelf((function(A){return function(e,n){return A(t(e,n.storage()),n)}})),"SparseMatrix, any":function(A,e){return s(A,e,i,!1)},"DenseMatrix, any":function(A,e){return a(A,e,i,!1)},"any, SparseMatrix":function(A,e){return s(e,A,i,!0)},"any, DenseMatrix":function(A,e){return a(e,A,i,!0)},"Array, any":function(A,e){return a(t(A),e,i,!1).valueOf()},"any, Array":function(A,e){return a(t(e),A,i,!0).valueOf()},"any, any":i,"any, any, ...any":e.referToSelf((function(A){return function(e,t,n){for(var i=A(e,t),r=0;r<n.length;r++)i=A(i,n[r]);return i}}))})})),zr="nthRoot",Lr=mA(zr,["typed","matrix","equalScalar","BigNumber","concat"],(function(A){var e=A.typed,t=A.matrix,n=A.equalScalar,i=A.BigNumber,r=A.concat,o=fr({typed:e}),s=Mr({typed:e,equalScalar:n}),a=Sr({typed:e,equalScalar:n}),B=rr({typed:e,equalScalar:n}),c=Dr({typed:e,matrix:t,concat:r});function g(){throw new Error("Complex number not supported in function nthRoot. Use nthRoots instead.")}return e(zr,{number:ji,"number, number":ji,BigNumber:function(A){return E(A,new i(2))},"BigNumber, BigNumber":E,Complex:g,"Complex, number":g,Array:e.referTo("DenseMatrix,number",(function(A){return function(e){return A(t(e),2).valueOf()}})),DenseMatrix:e.referTo("DenseMatrix,number",(function(A){return function(e){return A(e,2)}})),SparseMatrix:e.referTo("SparseMatrix,number",(function(A){return function(e){return A(e,2)}})),"SparseMatrix, SparseMatrix":e.referToSelf((function(A){return function(e,t){if(1===t.density())return a(e,t,A);throw new Error("Root must be non-zero")}})),"DenseMatrix, SparseMatrix":e.referToSelf((function(A){return function(e,t){if(1===t.density())return o(e,t,A,!1);throw new Error("Root must be non-zero")}})),"Array, SparseMatrix":e.referTo("DenseMatrix,SparseMatrix",(function(A){return function(e,n){return A(t(e),n)}})),"number | BigNumber, SparseMatrix":e.referToSelf((function(A){return function(e,t){if(1===t.density())return B(t,e,A,!0);throw new Error("Root must be non-zero")}}))},c({scalar:"number | BigNumber",SD:s,Ss:B,sS:!1}));function E(A,e){var t=i.precision,n=i.clone({precision:t+2}),r=new i(0),o=new n(1),s=e.isNegative();if(s&&(e=e.neg()),e.isZero())throw new Error("Root must be non-zero");if(A.isNegative()&&!e.abs().mod(2).equals(1))throw new Error("Root must be odd when a is negative.");if(A.isZero())return s?new n(1/0):0;if(!A.isFinite())return s?r:A;var a=A.abs().pow(o.div(e));return a=A.isNeg()?a.neg():a,new i((s?o.div(a):a).toPrecision(t))}})),Pr=mA("sign",["typed","BigNumber","Fraction","complex"],(function(A){var e=A.typed,t=A.BigNumber,n=A.complex,i=A.Fraction;return e("sign",{number:Ji,Complex:function(A){return 0===A.im?n(Ji(A.re)):A.sign()},BigNumber:function(A){return new t(A.cmp(0))},Fraction:function(A){return new i(A.s,1)},"Array | Matrix":e.referToSelf((function(A){return function(e){return Gn(e,A,!0)}})),Unit:e.referToSelf((function(A){return function(t){if(!t._isDerived()&&0!==t.units[0].unit.offset)throw new TypeError("sign is ambiguous for units with offset");return e.find(A,t.valueType())(t.value)}}))})})),Or=mA("sqrt",["config","typed","Complex"],(function(A){var e=A.config,t=A.typed,n=A.Complex;return t("sqrt",{number:i,Complex:function(A){return A.sqrt()},BigNumber:function(A){return!A.isNegative()||e.predictable?A.sqrt():i(A.toNumber())},Unit:function(A){return A.pow(.5)}});function i(A){return isNaN(A)?NaN:A>=0||e.predictable?Math.sqrt(A):new n(A,0).sqrt()}})),Vr=mA("square",["typed"],(function(A){return(0,A.typed)("square",{number:zi,Complex:function(A){return A.mul(A)},BigNumber:function(A){return A.times(A)},Fraction:function(A){return A.mul(A)},Unit:function(A){return A.pow(2)}})})),Wr="subtract",Kr=mA(Wr,["typed","matrix","equalScalar","subtractScalar","unaryMinus","DenseMatrix","concat"],(function(A){var e=A.typed,t=A.matrix,n=A.equalScalar,i=A.subtractScalar,r=(A.unaryMinus,A.DenseMatrix),o=A.concat,s=fr({typed:e}),a=dr({typed:e}),B=mr({typed:e,equalScalar:n}),c=Ur({typed:e,DenseMatrix:r}),g=or({typed:e,DenseMatrix:r}),E=Dr({typed:e,matrix:t,concat:o});return e(Wr,{"any, any":i},E({elop:i,SS:B,DS:s,SD:a,Ss:g,sS:c}))})),Xr=mA("xgcd",["typed","config","matrix","BigNumber"],(function(A){var e=A.typed,t=A.config,n=A.matrix,i=A.BigNumber;return e("xgcd",{"number, number":function(A,e){var i=Li(A,e);return"Array"===t.matrix?i:n(i)},"BigNumber, BigNumber":function(A,e){var r,o,s,a,B=new i(0),c=new i(1),g=B,E=c,Q=c,u=B;if(!A.isInt()||!e.isInt())throw new Error("Parameters in function xgcd must be integer numbers");for(;!e.isZero();)o=A.div(e).floor(),s=A.mod(e),r=g,g=E.minus(o.times(g)),E=r,r=Q,Q=u.minus(o.times(Q)),u=r,A=e,e=s;return a=A.lt(B)?[A.neg(),E.neg(),u.neg()]:[A,A.isZero()?0:E,u],"Array"===t.matrix?a:n(a)}})})),Zr=mA("invmod",["typed","config","BigNumber","xgcd","equal","smaller","mod","add","isInteger"],(function(A){var e=A.typed,t=(A.config,A.BigNumber),n=A.xgcd,i=A.equal,r=A.smaller,o=A.mod,s=A.add,a=A.isInteger;return e("invmod",{"number, number":B,"BigNumber, BigNumber":B});function B(A,e){if(!a(A)||!a(e))throw new Error("Parameters in function invmod must be integer numbers");if(A=o(A,e),i(e,0))throw new Error("Divisor must be non zero");var B=n(A,e),c=ir(B=B.valueOf(),2),g=c[0],E=c[1];return i(g,t(1))?(E=o(E,e),r(E,t(0))&&(E=s(E,e)),E):NaN}})),_r=mA("matAlgo09xS0Sf",["typed","equalScalar"],(function(A){var e=A.typed,t=A.equalScalar;return function(A,n,i){var r=A._values,o=A._index,s=A._ptr,a=A._size,B=A._datatype,c=n._values,g=n._index,E=n._ptr,Q=n._size,u=n._datatype;if(a.length!==Q.length)throw new _t(a.length,Q.length);if(a[0]!==Q[0]||a[1]!==Q[1])throw new RangeError("Dimension mismatch. Matrix A ("+a+") must match Matrix B ("+Q+")");var l,w=a[0],h=a[1],C=t,I=0,M=i;"string"==typeof B&&B===u&&(l=B,C=e.find(t,[l,l]),I=e.convert(0,l),M=e.find(i,[l,l]));var d,m,p,F,D,Y=r&&c?[]:void 0,f=[],N=[],U=Y?[]:void 0,y=[];for(m=0;m<h;m++){N[m]=f.length;var T=m+1;if(U)for(F=E[m],D=E[m+1],p=F;p<D;p++)y[d=g[p]]=T,U[d]=c[p];for(F=s[m],D=s[m+1],p=F;p<D;p++)if(d=o[p],U){var x=y[d]===T?U[d]:I,R=M(r[p],x);C(R,I)||(f.push(d),Y.push(R))}else f.push(d)}return N[h]=f.length,A.createSparseMatrix({values:Y,index:f,ptr:N,size:[w,h],datatype:l})}})),qr="dotMultiply",$r=mA(qr,["typed","matrix","equalScalar","multiplyScalar","concat"],(function(A){var e=A.typed,t=A.matrix,n=A.equalScalar,i=A.multiplyScalar,r=A.concat,o=Mr({typed:e,equalScalar:n}),s=_r({typed:e,equalScalar:n}),a=rr({typed:e,equalScalar:n}),B=Dr({typed:e,matrix:t,concat:r});return e(qr,B({elop:i,SS:s,DS:o,Ss:a}))}));function Ao(A,e){if(A.isFinite()&&!A.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function bitAnd");var t=A.constructor;if(A.isNaN()||e.isNaN())return new t(NaN);if(A.isZero()||e.eq(-1)||A.eq(e))return A;if(e.isZero()||A.eq(-1))return e;if(!A.isFinite()||!e.isFinite()){if(!A.isFinite()&&!e.isFinite())return A.isNegative()===e.isNegative()?A:new t(0);if(!A.isFinite())return e.isNegative()?A:A.isNegative()?new t(0):e;if(!e.isFinite())return A.isNegative()?e:e.isNegative()?new t(0):A}return no(A,e,(function(A,e){return A&e}))}function eo(A){if(A.isFinite()&&!A.isInteger())throw new Error("Integer expected in function bitNot");var e=A.constructor,t=e.precision;e.config({precision:1e9});var n=A.plus(new e(1));return n.s=-n.s||null,e.config({precision:t}),n}function to(A,e){if(A.isFinite()&&!A.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function bitOr");var t=A.constructor;if(A.isNaN()||e.isNaN())return new t(NaN);var n=new t(-1);return A.isZero()||e.eq(n)||A.eq(e)?e:e.isZero()||A.eq(n)?A:A.isFinite()&&e.isFinite()?no(A,e,(function(A,e){return A|e})):!A.isFinite()&&!A.isNegative()&&e.isNegative()||A.isNegative()&&!e.isNegative()&&!e.isFinite()?n:A.isNegative()&&e.isNegative()?A.isFinite()?A:e:A.isFinite()?e:A}function no(A,e,t){var n,i,r,o,s,a=A.constructor,B=+(A.s<0),c=+(e.s<0);if(B){n=io(eo(A));for(var g=0;g<n.length;++g)n[g]^=1}else n=io(A);if(c){i=io(eo(e));for(var E=0;E<i.length;++E)i[E]^=1}else i=io(e);n.length<=i.length?(r=n,o=i,s=B):(r=i,o=n,s=c);var Q=r.length,u=o.length,l=1^t(B,c),w=new a(1^l),h=new a(1),C=new a(2),I=a.precision;for(a.config({precision:1e9});Q>0;)t(r[--Q],o[--u])===l&&(w=w.plus(h)),h=h.times(C);for(;u>0;)t(s,o[--u])===l&&(w=w.plus(h)),h=h.times(C);return a.config({precision:I}),0===l&&(w.s=-w.s),w}function io(A){for(var e=A.d,t=e[0]+"",n=1;n<e.length;++n){for(var i=e[n]+"",r=7-i.length;r--;)i="0"+i;t+=i}for(var o=t.length;"0"===t.charAt(o);)o--;var s=A.e,a=t.slice(0,o+1||1),B=a.length;if(s>0)if(++s>B)for(s-=B;s--;)a+="0";else s<B&&(a=a.slice(0,s)+"."+a.slice(s));for(var c=[0],g=0;g<a.length;){for(var E=c.length;E--;)c[E]*=10;c[0]+=parseInt(a.charAt(g++));for(var Q=0;Q<c.length;++Q)c[Q]>1&&(null!==c[Q+1]&&void 0!==c[Q+1]||(c[Q+1]=0),c[Q+1]+=c[Q]>>1,c[Q]&=1)}return c.reverse()}function ro(A,e){if(A.isFinite()&&!A.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function bitXor");var t=A.constructor;if(A.isNaN()||e.isNaN())return new t(NaN);if(A.isZero())return e;if(e.isZero())return A;if(A.eq(e))return new t(0);var n=new t(-1);return A.eq(n)?eo(e):e.eq(n)?eo(A):A.isFinite()&&e.isFinite()?no(A,e,(function(A,e){return A^e})):A.isFinite()||e.isFinite()?new t(A.isNegative()===e.isNegative()?1/0:-1/0):n}function oo(A,e){if(A.isFinite()&&!A.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function leftShift");var t=A.constructor;return A.isNaN()||e.isNaN()||e.isNegative()&&!e.isZero()?new t(NaN):A.isZero()||e.isZero()?A:A.isFinite()||e.isFinite()?e.lt(55)?A.times(Math.pow(2,e.toNumber())+""):A.times(new t(2).pow(e)):new t(NaN)}function so(A,e){if(A.isFinite()&&!A.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function rightArithShift");var t=A.constructor;return A.isNaN()||e.isNaN()||e.isNegative()&&!e.isZero()?new t(NaN):A.isZero()||e.isZero()?A:e.isFinite()?e.lt(55)?A.div(Math.pow(2,e.toNumber())+"").floor():A.div(new t(2).pow(e)).floor():A.isNegative()?new t(-1):A.isFinite()?new t(0):new t(NaN)}n(3374);var ao="number, number";function Bo(A,e){if(!V(A)||!V(e))throw new Error("Integers expected in function bitAnd");return A&e}function co(A){if(!V(A))throw new Error("Integer expected in function bitNot");return~A}function go(A,e){if(!V(A)||!V(e))throw new Error("Integers expected in function bitOr");return A|e}function Eo(A,e){if(!V(A)||!V(e))throw new Error("Integers expected in function bitXor");return A^e}function Qo(A,e){if(!V(A)||!V(e))throw new Error("Integers expected in function leftShift");return A<<e}function uo(A,e){if(!V(A)||!V(e))throw new Error("Integers expected in function rightArithShift");return A>>e}function lo(A,e){if(!V(A)||!V(e))throw new Error("Integers expected in function rightLogShift");return A>>>e}Bo.signature=ao,co.signature="number",go.signature=ao,Eo.signature=ao,Qo.signature=ao,uo.signature=ao,lo.signature=ao;var wo=mA("bitAnd",["typed","matrix","equalScalar","concat"],(function(A){var e=A.typed,t=A.matrix,n=A.equalScalar,i=A.concat,r=Mr({typed:e,equalScalar:n}),o=Sr({typed:e,equalScalar:n}),s=rr({typed:e,equalScalar:n});return e("bitAnd",{"number, number":Bo,"BigNumber, BigNumber":Ao},Dr({typed:e,matrix:t,concat:i})({SS:o,DS:r,Ss:s}))})),ho=mA("bitNot",["typed"],(function(A){var e=A.typed;return e("bitNot",{number:co,BigNumber:eo,"Array | Matrix":e.referToSelf((function(A){return function(e){return Gn(e,A)}}))})})),Co=mA("bitOr",["typed","matrix","equalScalar","DenseMatrix","concat"],(function(A){var e=A.typed,t=A.matrix,n=A.equalScalar,i=A.DenseMatrix,r=A.concat,o=fr({typed:e}),s=Nr({typed:e,equalScalar:n}),a=Ur({typed:e,DenseMatrix:i});return e("bitOr",{"number, number":go,"BigNumber, BigNumber":to},Dr({typed:e,matrix:t,concat:r})({SS:s,DS:o,Ss:a}))})),Io=mA("matAlgo07xSSf",["typed","DenseMatrix"],(function(A){var e=A.typed,t=A.DenseMatrix;return function(A,i,r){var o=A._size,s=A._datatype,a=i._size,B=i._datatype;if(o.length!==a.length)throw new _t(o.length,a.length);if(o[0]!==a[0]||o[1]!==a[1])throw new RangeError("Dimension mismatch. Matrix A ("+o+") must match Matrix B ("+a+")");var c,g,E,Q=o[0],u=o[1],l=0,w=r;"string"==typeof s&&s===B&&(c=s,l=e.convert(0,c),w=e.find(r,[c,c]));var h=[];for(g=0;g<Q;g++)h[g]=[];var C=[],I=[],M=[],d=[];for(E=0;E<u;E++){var m=E+1;for(n(A,E,M,C,m),n(i,E,d,I,m),g=0;g<Q;g++){var p=M[g]===m?C[g]:l,F=d[g]===m?I[g]:l;h[g][E]=w(p,F)}}return new t({data:h,size:[Q,u],datatype:c})};function n(A,e,t,n,i){for(var r=A._values,o=A._index,s=A._ptr,a=s[e],B=s[e+1];a<B;a++){var c=o[a];t[c]=i,n[c]=r[a]}}})),Mo=mA("bitXor",["typed","matrix","DenseMatrix","concat"],(function(A){var e=A.typed,t=A.matrix,n=A.DenseMatrix,i=A.concat,r=dr({typed:e}),o=Io({typed:e,DenseMatrix:n}),s=or({typed:e,DenseMatrix:n});return e("bitXor",{"number, number":Eo,"BigNumber, BigNumber":ro},Dr({typed:e,matrix:t,concat:i})({SS:o,DS:r,Ss:s}))})),mo=mA("arg",["typed"],(function(A){var e=A.typed;return e("arg",{number:function(A){return Math.atan2(0,A)},BigNumber:function(A){return A.constructor.atan2(0,A)},Complex:function(A){return A.arg()},"Array | Matrix":e.referToSelf((function(A){return function(e){return Gn(e,A)}}))})})),po=mA("conj",["typed"],(function(A){var e=A.typed;return e("conj",{"number | BigNumber | Fraction":function(A){return A},Complex:function(A){return A.conjugate()},"Array | Matrix":e.referToSelf((function(A){return function(e){return Gn(e,A)}}))})})),Fo=mA("im",["typed"],(function(A){var e=A.typed;return e("im",{number:function(){return 0},"BigNumber | Fraction":function(A){return A.mul(0)},Complex:function(A){return A.im},"Array | Matrix":e.referToSelf((function(A){return function(e){return Gn(e,A)}}))})})),Do=mA("re",["typed"],(function(A){var e=A.typed;return e("re",{"number | BigNumber | Fraction":function(A){return A},Complex:function(A){return A.re},"Array | Matrix":e.referToSelf((function(A){return function(e){return Gn(e,A)}}))})})),Yo="number, number";function fo(A){return!A}function No(A,e){return!(!A&&!e)}function Uo(A,e){return!!A!=!!e}function yo(A,e){return!(!A||!e)}fo.signature="number",No.signature=Yo,Uo.signature=Yo,yo.signature=Yo;var To=mA("not",["typed"],(function(A){var e=A.typed;return e("not",{"null | undefined":function(){return!0},number:fo,Complex:function(A){return 0===A.re&&0===A.im},BigNumber:function(A){return A.isZero()||A.isNaN()},Unit:e.referToSelf((function(A){return function(t){return e.find(A,t.valueType())(t.value)}})),"Array | Matrix":e.referToSelf((function(A){return function(e){return Gn(e,A)}}))})})),xo=mA("or",["typed","matrix","equalScalar","DenseMatrix","concat"],(function(A){var e=A.typed,t=A.matrix,n=A.equalScalar,i=A.DenseMatrix,r=A.concat,o=dr({typed:e}),s=mr({typed:e,equalScalar:n}),a=or({typed:e,DenseMatrix:i}),B=Dr({typed:e,matrix:t,concat:r});return e("or",{"number, number":No,"Complex, Complex":function(A,e){return 0!==A.re||0!==A.im||0!==e.re||0!==e.im},"BigNumber, BigNumber":function(A,e){return!A.isZero()&&!A.isNaN()||!e.isZero()&&!e.isNaN()},"Unit, Unit":e.referToSelf((function(A){return function(e,t){return A(e.value||0,t.value||0)}}))},B({SS:s,DS:o,Ss:a}))})),Ro=mA("xor",["typed","matrix","DenseMatrix","concat"],(function(A){var e=A.typed,t=A.matrix,n=A.DenseMatrix,i=A.concat,r=dr({typed:e}),o=Io({typed:e,DenseMatrix:n}),s=or({typed:e,DenseMatrix:n}),a=Dr({typed:e,matrix:t,concat:i});return e("xor",{"number, number":Uo,"Complex, Complex":function(A,e){return(0!==A.re||0!==A.im)!=(0!==e.re||0!==e.im)},"BigNumber, BigNumber":function(A,e){return(!A.isZero()&&!A.isNaN())!=(!e.isZero()&&!e.isNaN())},"Unit, Unit":e.referToSelf((function(A){return function(e,t){return A(e.value||0,t.value||0)}}))},a({SS:o,DS:r,Ss:s}))})),Go=mA("concat",["typed","matrix","isInteger"],(function(A){var e=A.typed,n=A.matrix,i=A.isInteger;return e("concat",{"...Array | Matrix | number | BigNumber":function(A){var e,o,s=A.length,a=-1,B=!1,c=[];for(e=0;e<s;e++){var E=A[e];if(g(E)&&(B=!0),t(E)||r(E)){if(e!==s-1)throw new Error("Dimension must be specified as last argument");if(o=a,a=E.valueOf(),!i(a))throw new TypeError("Integer number expected for dimension");if(a<0||e>0&&a>o)throw new qt(a,o+1)}else{var Q=uA(E).valueOf(),u=$t(Q);if(c[e]=Q,o=a,a=u.length-1,e>0&&a!==o)throw new _t(o+1,a+1)}}if(0===c.length)throw new SyntaxError("At least one matrix expected");for(var l=c.shift();c.length;)l=mn(l,c.shift(),a);return B?n(l):l},"...string":function(A){return A.join("")}})})),So=mA("column",["typed","Index","matrix","range"],(function(A){var e=A.typed,t=A.Index,n=A.matrix,i=A.range;return e("column",{"Matrix, number":r,"Array, number":function(A,e){return r(n(uA(A)),e).valueOf()}});function r(A,e){if(2!==A.size().length)throw new Error("Only two dimensional matrix is supported");tn(e,A.size()[1]);var r=i(0,A.size()[0]),o=new t(r,e),s=A.subset(o);return g(s)?s:n([[s]])}})),Ho=mA("count",["typed","size","prod"],(function(A){var e=A.typed,t=A.size,n=A.prod;return e("count",{string:function(A){return A.length},"Matrix | Array":function(A){return n(t(A))}})})),bo=mA("cross",["typed","matrix","subtract","multiply"],(function(A){var e=A.typed,t=A.matrix,n=A.subtract,i=A.multiply;return e("cross",{"Matrix, Matrix":function(A,e){return t(r(A.toArray(),e.toArray()))},"Matrix, Array":function(A,e){return t(r(A.toArray(),e))},"Array, Matrix":function(A,e){return t(r(A,e.toArray()))},"Array, Array":r});function r(A,e){var t=Math.max($t(A).length,$t(e).length);A=Bn(A),e=Bn(e);var r=$t(A),o=$t(e);if(1!==r.length||1!==o.length||3!==r[0]||3!==o[0])throw new RangeError("Vectors with length 3 expected (Size A = ["+r.join(", ")+"], B = ["+o.join(", ")+"])");var s=[n(i(A[1],e[2]),i(A[2],e[1])),n(i(A[2],e[0]),i(A[0],e[2])),n(i(A[0],e[1]),i(A[1],e[0]))];return t>1?[s]:s}})),vo=mA("diag",["typed","matrix","DenseMatrix","SparseMatrix"],(function(A){var e=A.typed,t=A.matrix,n=A.DenseMatrix,i=A.SparseMatrix;return e("diag",{Array:function(A){return r(A,0,$t(A),null)},"Array, number":function(A,e){return r(A,e,$t(A),null)},"Array, BigNumber":function(A,e){return r(A,e.toNumber(),$t(A),null)},"Array, string":function(A,e){return r(A,0,$t(A),e)},"Array, number, string":function(A,e,t){return r(A,e,$t(A),t)},"Array, BigNumber, string":function(A,e,t){return r(A,e.toNumber(),$t(A),t)},Matrix:function(A){return r(A,0,A.size(),A.storage())},"Matrix, number":function(A,e){return r(A,e,A.size(),A.storage())},"Matrix, BigNumber":function(A,e){return r(A,e.toNumber(),A.size(),A.storage())},"Matrix, string":function(A,e){return r(A,0,A.size(),e)},"Matrix, number, string":function(A,e,t){return r(A,e,A.size(),t)},"Matrix, BigNumber, string":function(A,e,t){return r(A,e.toNumber(),A.size(),t)}});function r(A,e,r,o){if(!V(e))throw new TypeError("Second parameter in function diag must be an integer");var s=e>0?e:0,a=e<0?-e:0;switch(r.length){case 1:return function(A,e,t,r,o,s){var a=[r+o,r+s];if(t&&"sparse"!==t&&"dense"!==t)throw new TypeError("Unknown matrix type ".concat(t,'"'));var B="sparse"===t?i.diagonal(a,A,e):n.diagonal(a,A,e);return null!==t?B:B.valueOf()}(A,e,o,r[0],a,s);case 2:return function(A,e,n,i,r,o){if(g(A)){var s=A.diagonal(e);return null!==n?n!==s.storage()?t(s,n):s:s.valueOf()}for(var a=Math.min(i[0]-r,i[1]-o),B=[],c=0;c<a;c++)B[c]=A[c+r][c+o];return null!==n?t(B):B}(A,e,o,r,a,s)}throw new RangeError("Matrix for function diag must be 2 dimensional")}}));function ko(A,e,t,n,i){if(O.isTypedFunction(A)){var r=[e,t,n],o=O.resolve(A,r);if(o)return g(o.implementation,r);var s=[e,t],a=O.resolve(A,s);if(a)return g(a.implementation,s);var B=[e],c=O.resolve(A,B);return c?g(c.implementation,B):g(A,r)}return A(e,t,n);function g(r,o){try{return r.apply(r,o)}catch(r){var s;if(r instanceof TypeError&&"wrongType"===(null===(s=r.data)||void 0===s?void 0:s.category)){var a=[];throw a.push("value: ".concat(P(e))),o.length>=2&&a.push("index: ".concat(P(t))),o.length>=3&&a.push("array: ".concat(P(n))),new TypeError("Function ".concat(i," cannot apply callback arguments ")+"".concat(A.name,"(").concat(a.join(", "),") at index ").concat(JSON.stringify(t)))}throw new TypeError("Function ".concat(i," cannot apply callback arguments ")+"to function ".concat(A.name,": ").concat(r.message))}}}var jo=mA("filter",["typed"],(function(A){return(0,A.typed)("filter",{"Array, function":Jo,"Matrix, function":function(A,e){return A.create(Jo(A.toArray(),e))},"Array, RegExp":ln,"Matrix, RegExp":function(A,e){return A.create(ln(A.toArray(),e))}})}));function Jo(A,e){return un(A,(function(A,t,n){return ko(e,A,[t],n,"filter")}))}var zo="flatten",Lo=mA(zo,["typed","matrix"],(function(A){var e=A.typed,t=A.matrix;return e(zo,{Array:function(A){return gn(A)},Matrix:function(A){var e=gn(A.toArray());return t(e)}})})),Po="forEach",Oo=mA(Po,["typed"],(function(A){return(0,A.typed)(Po,{"Array, function":Vo,"Matrix, function":function(A,e){A.forEach(e)}})}));function Vo(A,e){!function t(n,i){if(!Array.isArray(n))return ko(e,n,i,A,"forEach");Qn(n,(function(A,e){t(A,i.concat(e))}))}(A,[])}var Wo="getMatrixDataType",Ko=mA(Wo,["typed"],(function(A){return(0,A.typed)(Wo,{Array:function(A){return In(A,P)},Matrix:function(A){return A.getDataType()}})})),Xo="identity",Zo=mA(Xo,["typed","config","matrix","BigNumber","DenseMatrix","SparseMatrix"],(function(A){var e=A.typed,t=A.config,n=A.matrix,i=A.BigNumber,o=A.DenseMatrix,s=A.SparseMatrix;return e(Xo,{"":function(){return"Matrix"===t.matrix?n([]):[]},string:function(A){return n(A)},"number | BigNumber":function(A){return B(A,A,"Matrix"===t.matrix?"dense":void 0)},"number | BigNumber, string":function(A,e){return B(A,A,e)},"number | BigNumber, number | BigNumber":function(A,e){return B(A,e,"Matrix"===t.matrix?"dense":void 0)},"number | BigNumber, number | BigNumber, string":function(A,e,t){return B(A,e,t)},Array:function(A){return a(A)},"Array, string":function(A,e){return a(A,e)},Matrix:function(A){return a(A.valueOf(),A.storage())},"Matrix, string":function(A,e){return a(A.valueOf(),e)}});function a(A,e){switch(A.length){case 0:return e?n(e):[];case 1:return B(A[0],A[0],e);case 2:return B(A[0],A[1],e);default:throw new Error("Vector containing two values expected")}}function B(A,e,t){var n=r(A)||r(e)?i:null;if(r(A)&&(A=A.toNumber()),r(e)&&(e=e.toNumber()),!V(A)||A<1)throw new Error("Parameters in function identity must be positive integers");if(!V(e)||e<1)throw new Error("Parameters in function identity must be positive integers");var a=n?new i(1):1,B=n?new n(0):0,c=[A,e];if(t){if("sparse"===t)return s.diagonal(c,a,0,B);if("dense"===t)return o.diagonal(c,a,0,B);throw new TypeError('Unknown matrix type "'.concat(t,'"'))}for(var g=rn([],c,B),E=A<e?A:e,Q=0;Q<E;Q++)g[Q][Q]=a;return g}})),_o=mA("kron",["typed","matrix","multiplyScalar"],(function(A){var e=A.typed,t=A.matrix,n=A.multiplyScalar;return e("kron",{"Matrix, Matrix":function(A,e){return t(i(A.toArray(),e.toArray()))},"Matrix, Array":function(A,e){return t(i(A.toArray(),e))},"Array, Matrix":function(A,e){return t(i(A,e.toArray()))},"Array, Array":i});function i(A,e){if(1===$t(A).length&&(A=[A]),1===$t(e).length&&(e=[e]),$t(A).length>2||$t(e).length>2)throw new RangeError("Vectors with dimensions greater then 2 are not supported expected (Size x = "+JSON.stringify(A.length)+", y = "+JSON.stringify(e.length)+")");var t=[],i=[];return A.map((function(A){return e.map((function(e){return i=[],t.push(i),A.map((function(A){return e.map((function(e){return i.push(n(A,e))}))}))}))}))&&t}})),qo=mA("map",["typed"],(function(A){return(0,A.typed)("map",{"Array, function":$o,"Matrix, function":function(A,e){return A.map(e)}})}));function $o(A,e){return function t(n,i){return Array.isArray(n)?n.map((function(A,e){return t(A,i.concat(e))})):ko(e,n,i,A,"map")}(A,[])}var As=mA("diff",["typed","matrix","subtract","number"],(function(A){var e=A.typed,t=A.matrix,n=A.subtract,i=A.number;return e("diff",{"Array | Matrix":function(A){return g(A)?t(o(A.toArray())):o(A)},"Array | Matrix, number":function(A,e){if(!V(e))throw new RangeError("Dimension must be a whole number");return g(A)?t(r(A.toArray(),e)):r(A,e)},"Array, BigNumber":e.referTo("Array,number",(function(A){return function(e,t){return A(e,i(t))}})),"Matrix, BigNumber":e.referTo("Matrix,number",(function(A){return function(e,t){return A(e,i(t))}}))});function r(A,e){if(g(A)&&(A=A.toArray()),!Array.isArray(A))throw RangeError("Array/Matrix does not have that many dimensions");if(e>0){var t=[];return A.forEach((function(A){t.push(r(A,e-1))})),t}if(0===e)return o(A);throw RangeError("Cannot have negative dimension")}function o(A){for(var e=[],t=A.length,n=1;n<t;n++)e.push(s(A[n-1],A[n]));return e}function s(A,e){g(A)&&(A=A.toArray()),g(e)&&(e=e.toArray());var t=Array.isArray(A),i=Array.isArray(e);if(t&&i)return function(A,e){if(A.length!==e.length)throw RangeError("Not all sub-arrays have the same length");for(var t=[],n=A.length,i=0;i<n;i++)t.push(s(A[i],e[i]));return t}(A,e);if(!t&&!i)return n(e,A);throw TypeError("Cannot calculate difference between 1 array and 1 non-array")}})),es=mA("ones",["typed","config","matrix","BigNumber"],(function(A){var e=A.typed,t=A.config,n=A.matrix,i=A.BigNumber;return e("ones",{"":function(){return"Array"===t.matrix?o([]):o([],"default")},"...number | BigNumber | string":function(A){if("string"==typeof A[A.length-1]){var e=A.pop();return o(A,e)}return"Array"===t.matrix?o(A):o(A,"default")},Array:o,Matrix:function(A){var e=A.storage();return o(A.valueOf(),e)},"Array | Matrix, string":function(A,e){return o(A.valueOf(),e)}});function o(A,e){var t=function(A){var e=!1;return A.forEach((function(A,t,n){r(A)&&(e=!0,n[t]=A.toNumber())})),e}(A)?new i(1):1;if(function(A){A.forEach((function(A){if("number"!=typeof A||!V(A)||A<0)throw new Error("Parameters in function ones must be positive integers")}))}(A),e){var o=n(e);return A.length>0?o.resize(A,t):o}var s=[];return A.length>0?rn(s,A,t):s}}));function ts(){throw new Error('No "bignumber" implementation available')}function ns(){throw new Error('No "fraction" implementation available')}function is(){throw new Error('No "matrix" implementation available')}var rs=mA("range",["typed","config","?matrix","?bignumber","smaller","smallerEq","larger","largerEq","add","isPositive"],(function(A){var e=A.typed,t=A.config,n=A.matrix,i=A.bignumber,r=A.smaller,o=A.smallerEq,s=A.larger,a=A.largerEq,B=A.add,c=A.isPositive;return e("range",{string:E,"string, boolean":E,"number, number":function(A,e){return g(Q(A,e,1,!1))},"number, number, number":function(A,e,t){return g(Q(A,e,t,!1))},"number, number, boolean":function(A,e,t){return g(Q(A,e,1,t))},"number, number, number, boolean":function(A,e,t,n){return g(Q(A,e,t,n))},"BigNumber, BigNumber":function(A,e){return g(Q(A,e,new(0,A.constructor)(1),!1))},"BigNumber, BigNumber, BigNumber":function(A,e,t){return g(Q(A,e,t,!1))},"BigNumber, BigNumber, boolean":function(A,e,t){return g(Q(A,e,new(0,A.constructor)(1),t))},"BigNumber, BigNumber, BigNumber, boolean":function(A,e,t,n){return g(Q(A,e,t,n))},"Unit, Unit, Unit":function(A,e,t){return g(Q(A,e,t,!1))},"Unit, Unit, Unit, boolean":function(A,e,t,n){return g(Q(A,e,t,n))}});function g(A){return"Matrix"===t.matrix?n?n(A):is():A}function E(A,e){var n=function(A){var e=A.split(":").map((function(A){return Number(A)}));if(e.some((function(A){return isNaN(A)})))return null;switch(e.length){case 2:return{start:e[0],end:e[1],step:1};case 3:return{start:e[0],end:e[2],step:e[1]};default:return null}}(A);if(!n)throw new SyntaxError('String "'+A+'" is no valid range');return"BigNumber"===t.number?(void 0===i&&ts(),g(Q(i(n.start),i(n.end),i(n.step)))):g(Q(n.start,n.end,n.step,e))}function Q(A,e,t,n){for(var i=[],g=c(t)?n?o:r:n?a:s,E=A;g(E,e);)i.push(E),E=B(E,t);return i}})),os="reshape",ss=mA(os,["typed","isInteger","matrix"],(function(A){var e=A.typed,t=A.isInteger;return e(os,{"Matrix, Array":function(A,e){return A.reshape(e,!0)},"Array, Array":function(A,e){return e.forEach((function(A){if(!t(A))throw new TypeError("Invalid size for dimension: "+A)})),on(A,e)}})})),as=mA("resize",["config","matrix"],(function(A){var e=A.config,t=A.matrix;return function(A,n,i){if(2!==arguments.length&&3!==arguments.length)throw new yr("resize",arguments.length,2,3);if(g(n)&&(n=n.valueOf()),r(n[0])&&(n=n.map((function(A){return r(A)?A.toNumber():A}))),g(A))return A.resize(n,i,!0);if("string"==typeof A)return function(A,e,t){if(void 0!==t){if("string"!=typeof t||1!==t.length)throw new TypeError("Single character expected as defaultValue")}else t=" ";if(1!==e.length)throw new _t(e.length,1);var n=e[0];if("number"!=typeof n||!V(n))throw new TypeError("Invalid size, must contain positive integers (size: "+Vt(e)+")");if(A.length>n)return A.substring(0,n);if(A.length<n){for(var i=A,r=0,o=n-A.length;r<o;r++)i+=t;return i}return A}(A,n,i);var o=!Array.isArray(A)&&"Array"!==e.matrix;if(0===n.length){for(;Array.isArray(A);)A=A[0];return uA(A)}Array.isArray(A)||(A=[A]);var s=rn(A=uA(A),n,i);return o?t(s):s}})),Bs=mA("rotate",["typed","multiply","rotationMatrix"],(function(A){var e=A.typed,t=A.multiply,n=A.rotationMatrix;return e("rotate",{"Array , number | BigNumber | Complex | Unit":function(A,e){return i(A,2),t(n(e),A).toArray()},"Matrix , number | BigNumber | Complex | Unit":function(A,e){return i(A,2),t(n(e),A)},"Array, number | BigNumber | Complex | Unit, Array | Matrix":function(A,e,r){return i(A,3),t(n(e,r),A)},"Matrix, number | BigNumber | Complex | Unit, Array | Matrix":function(A,e,r){return i(A,3),t(n(e,r),A)}});function i(A,e){var t=Array.isArray(A)?$t(A):A.size();if(t.length>2)throw new RangeError("Vector must be of dimensions 1x".concat(e));if(2===t.length&&1!==t[1])throw new RangeError("Vector must be of dimensions 1x".concat(e));if(t[0]!==e)throw new RangeError("Vector must be of dimensions 1x".concat(e))}})),cs="rotationMatrix",gs=mA(cs,["typed","config","multiplyScalar","addScalar","unaryMinus","norm","matrix","BigNumber","DenseMatrix","SparseMatrix","cos","sin"],(function(A){var e=A.typed,t=A.config,n=A.multiplyScalar,i=A.addScalar,o=A.unaryMinus,s=A.norm,a=A.BigNumber,B=A.matrix,c=A.DenseMatrix,g=A.SparseMatrix,E=A.cos,Q=A.sin;return e(cs,{"":function(){return"Matrix"===t.matrix?B([]):[]},string:function(A){return B(A)},"number | BigNumber | Complex | Unit":function(A){return u(A,"Matrix"===t.matrix?"dense":void 0)},"number | BigNumber | Complex | Unit, string":function(A,e){return u(A,e)},"number | BigNumber | Complex | Unit, Array":function(A,e){var t=B(e);return l(t),C(A,t,void 0)},"number | BigNumber | Complex | Unit, Matrix":function(A,e){l(e);var n=e.storage()||("Matrix"===t.matrix?"dense":void 0);return C(A,e,n)},"number | BigNumber | Complex | Unit, Array, string":function(A,e,t){var n=B(e);return l(n),C(A,n,t)},"number | BigNumber | Complex | Unit, Matrix, string":function(A,e,t){return l(e),C(A,e,t)}});function u(A,e){var t=r(A)?new a(-1):-1,i=E(A),o=Q(A);return h([[i,n(t,o)],[o,i]],e)}function l(A){var e=A.size();if(e.length<1||3!==e[0])throw new RangeError("Vector must be of dimensions 1x3")}function w(A){return A.reduce((function(A,e){return n(A,e)}))}function h(A,e){if(e){if("sparse"===e)return new g(A);if("dense"===e)return new c(A);throw new TypeError('Unknown matrix type "'.concat(e,'"'))}return A}function C(A,e,t){var n=s(e);if(0===n)throw new RangeError("Rotation around zero vector");var B=r(A)?a:null,c=B?new B(1):1,g=B?new B(-1):-1,u=B?new B(e.get([0])/n):e.get([0])/n,l=B?new B(e.get([1])/n):e.get([1])/n,C=B?new B(e.get([2])/n):e.get([2])/n,I=E(A),M=i(c,o(I)),d=Q(A);return h([[i(I,w([u,u,M])),i(w([u,l,M]),w([g,C,d])),i(w([u,C,M]),w([l,d]))],[i(w([u,l,M]),w([C,d])),i(I,w([l,l,M])),i(w([l,C,M]),w([g,u,d]))],[i(w([u,C,M]),w([g,l,d])),i(w([l,C,M]),w([u,d])),i(I,w([C,C,M]))]],t)}})),Es=mA("row",["typed","Index","matrix","range"],(function(A){var e=A.typed,t=A.Index,n=A.matrix,i=A.range;return e("row",{"Matrix, number":r,"Array, number":function(A,e){return r(n(uA(A)),e).valueOf()}});function r(A,e){if(2!==A.size().length)throw new Error("Only two dimensional matrix is supported");tn(e,A.size()[0]);var r=i(0,A.size()[1]),o=new t(e,r),s=A.subset(o);return g(s)?s:n([[s]])}})),Qs=mA("size",["typed","config","?matrix"],(function(A){var e=A.typed,t=A.config,n=A.matrix;return e("size",{Matrix:function(A){return A.create(A.size())},Array:$t,string:function(A){return"Array"===t.matrix?[A.length]:n([A.length])},"number | Complex | BigNumber | Unit | boolean | null":function(A){return"Array"===t.matrix?[]:n?n([]):is()}})})),us="squeeze",ls=mA(us,["typed","matrix"],(function(A){var e=A.typed,t=A.matrix;return e(us,{Array:function(A){return Bn(uA(A))},Matrix:function(A){var e=Bn(A.toArray());return Array.isArray(e)?t(e):e},any:function(A){return uA(A)}})})),ws=mA("subset",["typed","matrix","zeros","add"],(function(A){var e=A.typed,t=A.matrix,n=A.zeros,i=A.add;return e("subset",{"Matrix, Index":function(A,e){return nn(e)?t():(en(A,e),A.subset(e))},"Array, Index":e.referTo("Matrix, Index",(function(A){return function(e,n){var i=A(t(e),n);return n.isScalar()?i:i.valueOf()}})),"Object, Index":Is,"string, Index":hs,"Matrix, Index, any, any":function(A,e,t,r){return nn(e)?A:(en(A,e),A.clone().subset(e,function(A,e){if("string"==typeof A)throw new Error("can't boradcast a string");if(e._isScalar)return A;var t=e.size();if(!t.every((function(A){return A>0})))return A;try{return i(A,n(t))}catch(e){return A}}(t,e),r))},"Array, Index, any, any":e.referTo("Matrix, Index, any, any",(function(A){return function(e,n,i,r){var o=A(t(e),n,i,r);return o.isMatrix?o.valueOf():o}})),"Array, Index, any":e.referTo("Matrix, Index, any, any",(function(A){return function(e,n,i){return A(t(e),n,i,void 0).valueOf()}})),"Matrix, Index, any":e.referTo("Matrix, Index, any, any",(function(A){return function(e,t,n){return A(e,t,n,void 0)}})),"string, Index, string":Cs,"string, Index, string, string":Cs,"Object, Index, any":Ms})}));function hs(A,e){if(!w(e))throw new TypeError("Index expected");if(nn(e))return"";if(en(Array.from(A),e),1!==e.size().length)throw new _t(e.size().length,1);var t=A.length;tn(e.min()[0],t),tn(e.max()[0],t);var n=e.dimension(0),i="";return n.forEach((function(e){i+=A.charAt(e)})),i}function Cs(A,e,t,n){if(!e||!0!==e.isIndex)throw new TypeError("Index expected");if(nn(e))return A;if(en(Array.from(A),e),1!==e.size().length)throw new _t(e.size().length,1);if(void 0!==n){if("string"!=typeof n||1!==n.length)throw new TypeError("Single character expected as defaultValue")}else n=" ";var i=e.dimension(0);if(i.size()[0]!==t.length)throw new _t(i.size()[0],t.length);var r=A.length;tn(e.min()[0]),tn(e.max()[0]);for(var o=[],s=0;s<r;s++)o[s]=A.charAt(s);if(i.forEach((function(A,e){o[A]=t.charAt(e[0])})),o.length>r)for(var a=r-1,B=o.length;a<B;a++)o[a]||(o[a]=n);return o.join("")}function Is(A,e){if(!nn(e)){if(1!==e.size().length)throw new _t(e.size(),1);var t=e.dimension(0);if("string"!=typeof t)throw new TypeError("String expected as index to retrieve an object property");return UA(A,t)}}function Ms(A,e,t){if(nn(e))return A;if(1!==e.size().length)throw new _t(e.size(),1);var n=e.dimension(0);if("string"!=typeof n)throw new TypeError("String expected as index to retrieve an object property");var i=uA(A);return yA(i,n,t),i}var ds="transpose",ms=mA(ds,["typed","matrix"],(function(A){var e=A.typed,t=A.matrix;return e(ds,{Array:function(A){return n(t(A)).valueOf()},Matrix:n,any:uA});function n(A){var e,t=A.size();switch(t.length){case 1:e=A.clone();break;case 2:var n=t[0],i=t[1];if(0===i)throw new RangeError("Cannot transpose a 2D matrix with no columns (size: "+Vt(t)+")");switch(A.storage()){case"dense":e=function(A,e,t){for(var n,i=A._data,r=[],o=0;o<t;o++){n=r[o]=[];for(var s=0;s<e;s++)n[s]=uA(i[s][o])}return A.createDenseMatrix({data:r,size:[t,e],datatype:A._datatype})}(A,n,i);break;case"sparse":e=function(A,e,t){for(var n,i,r,o=A._values,s=A._index,a=A._ptr,B=o?[]:void 0,c=[],g=[],E=[],Q=0;Q<e;Q++)E[Q]=0;for(n=0,i=s.length;n<i;n++)E[s[n]]++;for(var u=0,l=0;l<e;l++)g.push(u),u+=E[l],E[l]=g[l];for(g.push(u),r=0;r<t;r++)for(var w=a[r],h=a[r+1],C=w;C<h;C++){var I=E[s[C]]++;c[I]=r,o&&(B[I]=uA(o[C]))}return A.createSparseMatrix({values:B,index:c,ptr:g,size:[t,e],datatype:A._datatype})}(A,n,i)}break;default:throw new RangeError("Matrix must be a vector or two dimensional (size: "+Vt(t)+")")}return e}})),ps="ctranspose",Fs=mA(ps,["typed","transpose","conj"],(function(A){var e=A.typed,t=A.transpose,n=A.conj;return e(ps,{any:function(A){return n(t(A))}})})),Ds=mA("zeros",["typed","config","matrix","BigNumber"],(function(A){var e=A.typed,t=A.config,n=A.matrix,i=A.BigNumber;return e("zeros",{"":function(){return"Array"===t.matrix?o([]):o([],"default")},"...number | BigNumber | string":function(A){if("string"==typeof A[A.length-1]){var e=A.pop();return o(A,e)}return"Array"===t.matrix?o(A):o(A,"default")},Array:o,Matrix:function(A){var e=A.storage();return o(A.valueOf(),e)},"Array | Matrix, string":function(A,e){return o(A.valueOf(),e)}});function o(A,e){var t=function(A){var e=!1;return A.forEach((function(A,t,n){r(A)&&(e=!0,n[t]=A.toNumber())})),e}(A)?new i(0):0;if(function(A){A.forEach((function(A){if("number"!=typeof A||!V(A)||A<0)throw new Error("Parameters in function zeros must be positive integers")}))}(A),e){var o=n(e);return A.length>0?o.resize(A,t):o}var s=[];return A.length>0?rn(s,A,t):s}})),Ys=mA("fft",["typed","matrix","addScalar","multiplyScalar","divideScalar","exp","tau","i","dotDivide","conj","pow","ceil","log2"],(function(A){var e=A.typed,t=(A.matrix,A.addScalar),n=A.multiplyScalar,i=A.divideScalar,r=A.exp,o=A.tau,s=A.i,a=A.dotDivide,B=A.conj,c=A.pow,g=A.ceil,E=A.log2;return e("fft",{Array:Q,Matrix:function(A){return A.create(Q(A.toArray()))}});function Q(A){var e=$t(A);return 1===e.length?u(A,e[0]):function A(e,t){var n=$t(e);if(0!==t)return new Array(n[0]).fill(0).map((function(n,i){return A(e[i],t-1)}));if(1===n.length)return u(e);function i(A){var e=$t(A);return new Array(e[1]).fill(0).map((function(t,n){return new Array(e[0]).fill(0).map((function(e,t){return A[t][n]}))}))}return i(A(i(e),1))}(A.map((function(A){return Q(A,e.slice(1))})),0)}function u(A){var e=A.length;if(1===e)return[A[0]];if(e%2==0){for(var l=[].concat(zt(u(A.filter((function(A,e){return e%2==0})))),zt(u(A.filter((function(A,e){return e%2==1}))))),w=0;w<e/2;w++){var h=l[w],C=n(l[w+e/2],r(n(n(o,s),i(-w,e))));l[w]=t(h,C),l[w+e/2]=t(h,n(-1,C))}return l}return function(A){for(var e=A.length,t=r(i(n(-1,n(s,o)),e)),l=[],w=1-e;w<e;w++)l.push(c(t,i(c(w,2),2)));for(var h=c(2,g(E(e+e-1))),C=[].concat(zt(new Array(e).fill(0).map((function(t,i){return n(A[i],l[e-1+i])}))),zt(new Array(h-e).fill(0))),I=[].concat(zt(new Array(e+e-1).fill(0).map((function(A,e){return i(1,l[e])}))),zt(new Array(h-(e+e-1)).fill(0))),M=u(C),d=u(I),m=new Array(h).fill(0).map((function(A,e){return n(M[e],d[e])})),p=a(B(Q(B(m))),h),F=[],D=e-1;D<e+e-1;D++)F.push(n(p[D],l[D]));return F}(A)}})),fs=mA("ifft",["typed","fft","dotDivide","conj"],(function(A){var e=A.typed,t=A.fft,n=A.dotDivide,i=A.conj;return e("ifft",{"Array | Matrix":function(A){var e=g(A)?A.size():$t(A);return n(i(t(i(A))),e.reduce((function(A,e){return A*e}),1))}})}));function Ns(A,e){var t=Object.keys(A);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(A);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(A,e).enumerable}))),t.push.apply(t,n)}return t}n(1919),n(9474),n(5082);var Us=mA("solveODE",["typed","add","subtract","multiply","divide","max","map","abs","isPositive","isNegative","larger","smaller","matrix","bignumber","unaryMinus"],(function(A){var e=A.typed,n=A.add,i=A.subtract,o=A.multiply,s=A.divide,B=A.max,c=A.map,g=A.abs,E=A.isPositive,Q=A.isNegative,u=A.larger,l=A.smaller,w=A.matrix,h=A.bignumber,C=A.unaryMinus;function I(A){return function(e,t,w,I){if(2!==t.length||!t.every(p)&&!t.every(a))throw new Error('"tspan" must be an Array of two numeric values or two units [tStart, tEnd]');var M=t[0],d=t[1],m=u(d,M),F=I.firstStep;if(void 0!==F&&!E(F))throw new Error('"firstStep" must be positive');var D=I.maxStep;if(void 0!==D&&!E(D))throw new Error('"maxStep" must be positive');var Y=I.minStep;if(Y&&Q(Y))throw new Error('"minStep" must be positive or zero');var f=[M,d,F,Y,D].filter((function(A){return void 0!==A}));if(!f.every(p)&&!f.every(a))throw new Error('Inconsistent type of "t" dependant variables');for(var N=I.tol?I.tol:1e-4,U=I.minDelta?I.minDelta:.2,y=I.maxDelta?I.maxDelta:5,T=I.maxIter?I.maxIter:1e4,x=[M,d].concat(zt(w),[D,Y]).some(r),R=ir(x?[h(A.a),h(A.c),h(A.b),h(A.bp)]:[A.a,A.c,A.b,A.bp],4),G=R[0],S=R[1],H=R[2],b=R[3],v=F?m?F:C(F):s(i(d,M),1),k=[M],j=[w],J=i(H,b),z=0,L=0,P=function(A){return A?l:u}(m),O=function(A){var e=A?u:l;return function(A,t,r){var o=n(A,r);return e(o,t)?i(t,A):r}}(m);P(k[z],d);){var V=[];v=O(k[z],d,v),V.push(e(k[z],j[z]));for(var W=1;W<S.length;++W)V.push(e(n(k[z],o(S[W],v)),n(j[z],o(v,G[W],V))));var K=B(g(c(o(J,V),(function(A){return a(A)?A.value:A}))));K<N&&N/K>1/4&&(k.push(n(k[z],v)),j.push(n(j[z],o(v,H,V))),z++);var X=.84*Math.pow(N/K,.2);if(l(X,U)?X=U:u(X,y)&&(X=y),X=x?h(X):X,v=o(v,X),D&&u(g(v),D)?v=m?D:C(D):Y&&l(g(v),Y)&&(v=m?Y:C(Y)),++L>T)throw new Error("Maximum number of iterations reached, try changing options")}return{t:k,y:j}}}function M(A,e,t,n){return I({a:[[],[.5],[0,3/4],[2/9,1/3,4/9]],c:[null,.5,3/4,1],b:[2/9,1/3,4/9,0],bp:[7/24,1/4,1/3,1/8]})(A,e,t,n)}function d(A,e,t,n){return I({a:[[],[.2],[3/40,9/40],[44/45,-56/15,32/9],[19372/6561,-25360/2187,64448/6561,-212/729],[9017/3168,-355/33,46732/5247,49/176,-5103/18656],[35/384,0,500/1113,125/192,-2187/6784,11/84]],c:[null,.2,.3,.8,8/9,1,1],b:[35/384,0,500/1113,125/192,-2187/6784,11/84,0],bp:[5179/57600,0,7571/16695,393/640,-92097/339200,187/2100,1/40]})(A,e,t,n)}function m(A,e,t,n){var i=n.method?n.method:"RK45",r={RK23:M,RK45:d};if(i.toUpperCase()in r){var o=function(A){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?Ns(Object(t),!0).forEach((function(e){Ir(A,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(t)):Ns(Object(t)).forEach((function(e){Object.defineProperty(A,e,Object.getOwnPropertyDescriptor(t,e))}))}return A}({},n);return delete o.method,r[i.toUpperCase()](A,e,t,o)}var s=Object.keys(r).map((function(A){return'"'.concat(A,'"')})),a="".concat(s.slice(0,-1).join(", ")," and ").concat(s.slice(-1));throw new Error('Unavailable method "'.concat(i,'". Available methods are ').concat(a))}function p(A){return r(A)||t(A)}function F(A,e,t,n){var i=m(A,e.toArray(),t.toArray(),n);return{t:w(i.t),y:w(i.y)}}return e("solveODE",{"function, Array, Array, Object":m,"function, Matrix, Matrix, Object":F,"function, Array, Array":function(A,e,t){return m(A,e,t,{})},"function, Matrix, Matrix":function(A,e,t){return F(A,e,t,{})},"function, Array, number | BigNumber | Unit":function(A,e,t){var n=m(A,e,[t],{});return{t:n.t,y:n.y.map((function(A){return A[0]}))}},"function, Matrix, number | BigNumber | Unit":function(A,e,t){var n=m(A,e.toArray(),[t],{});return{t:w(n.t),y:w(n.y.map((function(A){return A[0]})))}},"function, Array, number | BigNumber | Unit, Object":function(A,e,t,n){var i=m(A,e,[t],n);return{t:i.t,y:i.y.map((function(A){return A[0]}))}},"function, Matrix, number | BigNumber | Unit, Object":function(A,e,t,n){var i=m(A,e.toArray(),[t],n);return{t:w(i.t),y:w(i.y.map((function(A){return A[0]})))}}})})),ys=mA("erf",["typed"],(function(A){var e=A.typed;return e("name",{number:function(A){var e=Math.abs(A);return e>=Ss?W(A):e<=Ts?W(A)*function(A){var e,t=A*A,n=Rs[0][4]*t,i=t;for(e=0;e<3;e+=1)n=(n+Rs[0][e])*t,i=(i+Gs[0][e])*t;return A*(n+Rs[0][3])/(i+Gs[0][3])}(e):e<=4?W(A)*(1-function(A){var e,t=Rs[1][8]*A,n=A;for(e=0;e<7;e+=1)t=(t+Rs[1][e])*A,n=(n+Gs[1][e])*A;var i=(t+Rs[1][7])/(n+Gs[1][7]),r=parseInt(16*A)/16,o=(A-r)*(A+r);return Math.exp(-r*r)*Math.exp(-o)*i}(e)):W(A)*(1-function(A){var e,t=1/(A*A),n=Rs[2][5]*t,i=t;for(e=0;e<4;e+=1)n=(n+Rs[2][e])*t,i=(i+Gs[2][e])*t;var r=t*(n+Rs[2][4])/(i+Gs[2][4]);r=(xs-r)/A;var o=(A-(t=parseInt(16*A)/16))*(A+t);return Math.exp(-t*t)*Math.exp(-o)*r}(e))},"Array | Matrix":e.referToSelf((function(A){return function(e){return Gn(e,A)}}))})})),Ts=.46875,xs=.5641895835477563,Rs=[[3.1611237438705655,113.86415415105016,377.485237685302,3209.3775891384694,.18577770618460315],[.5641884969886701,8.883149794388377,66.11919063714163,298.6351381974001,881.952221241769,1712.0476126340707,2051.0783778260716,1230.3393547979972,2.1531153547440383e-8],[.30532663496123236,.36034489994980445,.12578172611122926,.016083785148742275,.0006587491615298378,.016315387137302097]],Gs=[[23.601290952344122,244.02463793444417,1282.6165260773723,2844.236833439171],[15.744926110709835,117.6939508913125,537.1811018620099,1621.3895745666903,3290.7992357334597,4362.619090143247,3439.3676741437216,1230.3393548037495],[2.568520192289822,1.8729528499234604,.5279051029514285,.06051834131244132,.0023352049762686918]],Ss=Math.pow(2,53),Hs=mA("zeta",["typed","config","multiply","pow","divide","factorial","equal","smallerEq","isNegative","gamma","sin","subtract","add","?Complex","?BigNumber","pi"],(function(A){var e=A.typed,t=A.config,n=A.multiply,i=A.pow,r=A.divide,o=A.factorial,s=A.equal,a=A.smallerEq,B=A.isNegative,c=A.gamma,g=A.sin,E=A.subtract,Q=A.add,u=A.Complex,l=A.BigNumber,w=A.pi;return e("zeta",{number:function(A){return h(A,(function(A){return A}),(function(){return 20}))},BigNumber:function(A){return h(A,(function(A){return new l(A)}),(function(){return Math.abs(Math.log10(t.epsilon))}))},Complex:function(A){return 0===A.re&&0===A.im?new u(-.5):1===A.re?new u(NaN,NaN):A.re===1/0&&0===A.im?new u(1):A.im===1/0||A.re===-1/0?new u(NaN,NaN):C(A,(function(A){return A}),(function(A){return Math.round(19.5+.9*Math.abs(A.im))}),(function(A){return A.re}))}});function h(A,e,t){return s(A,0)?e(-.5):s(A,1)?e(NaN):isFinite(A)?C(A,e,t,(function(A){return A})):B(A)?e(NaN):e(1)}function C(A,e,t,o){var s=t(A);if(o(A)>-(s-1)/2)return function(A,e,t){for(var o=r(1,n(I(t(0),e),E(1,i(2,E(1,A))))),s=t(0),B=t(1);a(B,e);B=Q(B,1))s=Q(s,r(n(Math.pow(-1,B-1),I(B,e)),i(B,A)));return n(o,s)}(A,e(s),e);var B=n(i(2,A),i(e(w),E(A,1)));return B=n(B,g(n(r(e(w),2),A))),B=n(B,c(E(1,A))),n(B,C(E(1,A),e,t,o))}function I(A,e){for(var t=A,s=A;a(s,e);s=Q(s,1)){var B=r(n(o(Q(e,E(s,1))),i(4,s)),n(o(E(e,s)),o(n(2,s))));t=Q(t,B)}return n(e,t)}})),bs=mA("mode",["typed","isNaN","isNumeric"],(function(A){var e=A.typed,t=A.isNaN,n=A.isNumeric;return e("mode",{"Array | Matrix":i,"...":function(A){return i(A)}});function i(A){if(0===(A=gn(A.valueOf())).length)throw new Error("Cannot calculate mode of an empty array");for(var e={},i=[],r=0,o=0;o<A.length;o++){var s=A[o];if(n(s)&&t(s))throw new Error("Cannot calculate mode of an array containing NaN values");s in e||(e[s]=0),e[s]++,e[s]===r?i.push(s):e[s]>r&&(r=e[s],i=[s])}return i}}));function vs(A,e,t){var n;return-1!==String(A).indexOf("Unexpected type")?(n=arguments.length>2?" (type: "+P(t)+", value: "+JSON.stringify(t)+")":" (type: "+A.data.actual+")",new TypeError("Cannot calculate "+e+", unexpected type of argument"+n)):-1!==String(A).indexOf("complex numbers")?(n=arguments.length>2?" (type: "+P(t)+", value: "+JSON.stringify(t)+")":"",new TypeError("Cannot calculate "+e+", no ordering relation is defined for complex numbers"+n)):A}var ks=mA("prod",["typed","config","multiplyScalar","numeric"],(function(A){var e=A.typed,t=A.config,n=A.multiplyScalar,i=A.numeric;return e("prod",{"Array | Matrix":r,"Array | Matrix, number | BigNumber":function(A,e){throw new Error("prod(A, dim) is not yet supported")},"...":function(A){return r(A)}});function r(A){var e;if(Rn(A,(function(A){try{e=void 0===e?A:n(e,A)}catch(e){throw vs(e,"prod",A)}})),"string"==typeof e&&(e=i(e,t.number)),void 0===e)throw new Error("Cannot calculate prod of an empty array");return e}})),js=mA("format",["typed"],(function(A){return(0,A.typed)("format",{any:Vt,"any, Object | function | number":Vt})})),Js=mA("bin",["typed","format"],(function(A){var e=A.typed,t=A.format;return e("bin",{"number | BigNumber":function(A){return t(A,{notation:"bin"})},"number | BigNumber, number":function(A,e){return t(A,{notation:"bin",wordSize:e})}})})),zs=mA("oct",["typed","format"],(function(A){var e=A.typed,t=A.format;return e("oct",{"number | BigNumber":function(A){return t(A,{notation:"oct"})},"number | BigNumber, number":function(A,e){return t(A,{notation:"oct",wordSize:e})}})})),Ls=mA("hex",["typed","format"],(function(A){var e=A.typed,t=A.format;return e("hex",{"number | BigNumber":function(A){return t(A,{notation:"hex"})},"number | BigNumber, number":function(A,e){return t(A,{notation:"hex",wordSize:e})}})})),Ps=/\$([\w.]+)/g,Os=mA("print",["typed"],(function(A){return(0,A.typed)("print",{"string, Object | Array":Vs,"string, Object | Array, number | Object":Vs})}));function Vs(A,e,t){return A.replace(Ps,(function(A,n){var i=n.split("."),r=e[i.shift()];for(void 0!==r&&r.isMatrix&&(r=r.toArray());i.length&&void 0!==r;){var o=i.shift();r=o?r[o]:r+"."}return void 0!==r?B(r)?r:Vt(r,t):A}))}var Ws=mA("to",["typed","matrix","concat"],(function(A){var e=A.typed,t=A.matrix,n=A.concat;return e("to",{"Unit, Unit | string":function(A,e){return A.to(e)}},Dr({typed:e,matrix:t,concat:n})({Ds:!0}))})),Ks="isPrime",Xs=mA(Ks,["typed"],(function(A){var e=A.typed;return e(Ks,{number:function(A){if(0*A!=0)return!1;if(A<=3)return A>1;if(A%2==0||A%3==0)return!1;for(var e=5;e*e<=A;e+=6)if(A%e==0||A%(e+2)==0)return!1;return!0},BigNumber:function(A){if(0*A.toNumber()!=0)return!1;if(A.lte(3))return A.gt(1);if(A.mod(2).eq(0)||A.mod(3).eq(0))return!1;if(A.lt(Math.pow(2,32))){for(var e=A.toNumber(),t=5;t*t<=e;t+=6)if(e%t==0||e%(t+2)==0)return!1;return!0}function n(A,e,t){for(var n=1;!e.eq(0);)e.mod(2).eq(0)?(e=e.div(2),A=A.mul(A).mod(t)):(e=e.sub(1),n=A.mul(n).mod(t));return n}for(var i=A.constructor.clone({precision:2*A.toFixed(0).length}),r=0,o=(A=new i(A)).sub(1);o.mod(2).eq(0);)o=o.div(2),r+=1;var s=null;if(A.lt("3317044064679887385961981"))s=[2,3,5,7,11,13,17,19,23,29,31,37,41].filter((function(e){return e<A}));else{var a=Math.min(A.toNumber()-2,Math.floor(2*Math.pow(A.toFixed(0).length*Math.log(10),2)));s=[];for(var B=2;B<=a;B+=1)s.push(a)}for(var c=0;c<s.length;c+=1){var g=s[c],E=n(A.sub(A).add(g),o,A);if(!E.eq(1))for(var Q=0,u=E;!u.eq(A.sub(1));Q+=1,u=u.mul(u).mod(A))if(Q===r-1)return!1}return!0},"Array | Matrix":e.referToSelf((function(A){return function(e){return Gn(e,A)}}))})})),Zs=mA("numeric",["number","?bignumber","?fraction"],(function(A){var e=A.number,t=A.bignumber,n=A.fraction,i={string:!0,number:!0,BigNumber:!0,Fraction:!0},r={number:function(A){return e(A)},BigNumber:t?function(A){return t(A)}:ts,Fraction:n?function(A){return n(A)}:ns};return function(A){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"number";if(void 0!==(arguments.length>2?arguments[2]:void 0))throw new SyntaxError("numeric() takes one or two arguments");var t=P(A);if(!(t in i))throw new TypeError("Cannot convert "+A+' of type "'+t+'"; valid input types are '+Object.keys(i).join(", "));if(!(e in r))throw new TypeError("Cannot convert "+A+' to type "'+e+'"; valid output types are '+Object.keys(r).join(", "));return e===t?A:r[e](A)}})),_s="divideScalar",qs=mA(_s,["typed","numeric"],(function(A){var e=A.typed;return A.numeric,e(_s,{"number, number":function(A,e){return A/e},"Complex, Complex":function(A,e){return A.div(e)},"BigNumber, BigNumber":function(A,e){return A.div(e)},"Fraction, Fraction":function(A,e){return A.div(e)},"Unit, number | Complex | Fraction | BigNumber | Unit":function(A,e){return A.divide(e)},"number | Fraction | Complex | BigNumber, Unit":function(A,e){return e.divideInto(A)}})})),$s=mA("pow",["typed","config","identity","multiply","matrix","inv","fraction","number","Complex"],(function(A){var e=A.typed,t=A.config,n=A.identity,i=A.multiply,r=A.matrix,o=A.inv,s=A.number,a=A.fraction,B=A.Complex;return e("pow",{"number, number":c,"Complex, Complex":function(A,e){return A.pow(e)},"BigNumber, BigNumber":function(A,e){return e.isInteger()||A>=0||t.predictable?A.pow(e):new B(A.toNumber(),0).pow(e.toNumber(),0)},"Fraction, Fraction":function(A,e){var n=A.pow(e);if(null!=n)return n;if(t.predictable)throw new Error("Result of pow is non-rational and cannot be expressed as a fraction");return c(A.valueOf(),e.valueOf())},"Array, number":g,"Array, BigNumber":function(A,e){return g(A,e.toNumber())},"Matrix, number":E,"Matrix, BigNumber":function(A,e){return E(A,e.toNumber())},"Unit, number | BigNumber":function(A,e){return A.pow(e)}});function c(A,e){if(t.predictable&&!V(e)&&A<0)try{var n=a(e),i=s(n);if((e===i||Math.abs((e-i)/e)<1e-14)&&n.d%2==1)return(n.n%2==0?1:-1)*Math.pow(-A,e)}catch(A){}return t.predictable&&(A<-1&&e===1/0||A>-1&&A<0&&e===-1/0)?NaN:V(e)||A>=0||t.predictable?Pi(A,e):A*A<1&&e===1/0||A*A>1&&e===-1/0?0:new B(A,0).pow(e,0)}function g(A,e){if(!V(e))throw new TypeError("For A^b, b must be an integer (value is "+e+")");var t=$t(A);if(2!==t.length)throw new Error("For A^b, A must be 2 dimensional (A has "+t.length+" dimensions)");if(t[0]!==t[1])throw new Error("For A^b, A must be square (size is "+t[0]+"x"+t[1]+")");if(e<0)try{return g(o(A),-e)}catch(A){if("Cannot calculate inverse, determinant is zero"===A.message)throw new TypeError("For A^b, when A is not invertible, b must be a positive integer (value is "+e+")");throw A}for(var r=n(t[0]).valueOf(),s=A;e>=1;)1==(1&e)&&(r=i(s,r)),e>>=1,s=i(s,s);return r}function E(A,e){return r(g(A.valueOf(),e))}})),Aa="Number of decimals in function round must be an integer",ea=mA("round",["typed","matrix","equalScalar","zeros","BigNumber","DenseMatrix"],(function(A){var e=A.typed,t=A.matrix,n=A.equalScalar,i=A.zeros,r=A.BigNumber,o=A.DenseMatrix,s=rr({typed:e,equalScalar:n}),a=or({typed:e,DenseMatrix:o}),B=sr({typed:e});return e("round",{number:Oi,"number, number":Oi,"number, BigNumber":function(A,e){if(!e.isInteger())throw new TypeError(Aa);return new r(A).toDecimalPlaces(e.toNumber())},Complex:function(A){return A.round()},"Complex, number":function(A,e){if(e%1)throw new TypeError(Aa);return A.round(e)},"Complex, BigNumber":function(A,e){if(!e.isInteger())throw new TypeError(Aa);var t=e.toNumber();return A.round(t)},BigNumber:function(A){return A.toDecimalPlaces(0)},"BigNumber, BigNumber":function(A,e){if(!e.isInteger())throw new TypeError(Aa);return A.toDecimalPlaces(e.toNumber())},Fraction:function(A){return A.round()},"Fraction, number":function(A,e){if(e%1)throw new TypeError(Aa);return A.round(e)},"Fraction, BigNumber":function(A,e){if(!e.isInteger())throw new TypeError(Aa);return A.round(e.toNumber())},"Array | Matrix":e.referToSelf((function(A){return function(e){return Gn(e,A,!0)}})),"SparseMatrix, number | BigNumber":e.referToSelf((function(A){return function(e,t){return s(e,t,A,!1)}})),"DenseMatrix, number | BigNumber":e.referToSelf((function(A){return function(e,t){return B(e,t,A,!1)}})),"Array, number | BigNumber":e.referToSelf((function(A){return function(e,n){return B(t(e),n,A,!1).valueOf()}})),"number | Complex | BigNumber | Fraction, SparseMatrix":e.referToSelf((function(A){return function(e,t){return n(e,0)?i(t.size(),t.storage()):a(t,e,A,!0)}})),"number | Complex | BigNumber | Fraction, DenseMatrix":e.referToSelf((function(A){return function(e,t){return n(e,0)?i(t.size(),t.storage()):B(t,e,A,!0)}})),"number | Complex | BigNumber | Fraction, Array":e.referToSelf((function(A){return function(e,n){return B(t(n),e,A,!0).valueOf()}}))})})),ta=mA("log",["config","typed","divideScalar","Complex"],(function(A){var e=A.typed,t=A.config,n=A.divideScalar,i=A.Complex;return e("log",{number:function(A){return A>=0||t.predictable?function(A,e){return Math.log(A)}(A):new i(A,0).log()},Complex:function(A){return A.log()},BigNumber:function(A){return!A.isNegative()||t.predictable?A.ln():new i(A.toNumber(),0).log()},"any, any":e.referToSelf((function(A){return function(e,t){return n(A(e),A(t))}}))})})),na=mA("log1p",["typed","config","divideScalar","log","Complex"],(function(A){var e=A.typed,t=A.config,n=A.divideScalar,i=A.log,r=A.Complex;return e("log1p",{number:function(A){return A>=-1||t.predictable?Z(A):o(new r(A,0))},Complex:o,BigNumber:function(A){var e=A.plus(1);return!e.isNegative()||t.predictable?e.ln():o(new r(A.toNumber(),0))},"Array | Matrix":e.referToSelf((function(A){return function(e){return Gn(e,A)}})),"any, any":e.referToSelf((function(A){return function(e,t){return n(A(e),i(t))}}))});function o(A){var e=A.re+1;return new r(Math.log(Math.sqrt(e*e+A.im*A.im)),Math.atan2(A.im,e))}})),ia="nthRoots",ra=mA(ia,["config","typed","divideScalar","Complex"],(function(A){var e=A.typed,t=(A.config,A.divideScalar,A.Complex),n=[function(A){return new t(A,0)},function(A){return new t(0,A)},function(A){return new t(-A,0)},function(A){return new t(0,-A)}];function i(A,e){if(e<0)throw new Error("Root must be greater than zero");if(0===e)throw new Error("Root must be non-zero");if(e%1!=0)throw new Error("Root must be an integer");if(0===A||0===A.abs())return[new t(0,0)];var i,r="number"==typeof A;(r||0===A.re||0===A.im)&&(i=r?2*+(A<0):0===A.im?2*+(A.re<0):2*+(A.im<0)+1);for(var o=A.arg(),s=A.abs(),a=[],B=Math.pow(s,1/e),c=0;c<e;c++){var g=(i+4*c)/e;g!==Math.round(g)?a.push(new t({r:B,phi:(o+2*Math.PI*c)/e})):a.push(n[g%4](B))}return a}return e(ia,{Complex:function(A){return i(A,2)},"Complex, number":i})})),oa=mA("dotPow",["typed","equalScalar","matrix","pow","DenseMatrix","concat"],(function(A){var e=A.typed,t=A.equalScalar,n=A.matrix,i=A.pow,r=A.DenseMatrix,o=A.concat,s=dr({typed:e}),a=Io({typed:e,DenseMatrix:r}),B=rr({typed:e,equalScalar:t}),c=or({typed:e,DenseMatrix:r}),g=Dr({typed:e,matrix:n,concat:o}),E={};for(var Q in i.signatures)Object.prototype.hasOwnProperty.call(i.signatures,Q)&&(Q.includes("Matrix")||Q.includes("Array")||(E[Q]=i.signatures[Q]));var u=e(E);return e("dotPow",g({elop:u,SS:a,DS:s,Ss:B,sS:c}))})),sa="dotDivide",aa=mA(sa,["typed","matrix","equalScalar","divideScalar","DenseMatrix","concat"],(function(A){var e=A.typed,t=A.matrix,n=A.equalScalar,i=A.divideScalar,r=A.DenseMatrix,o=A.concat,s=Mr({typed:e,equalScalar:n}),a=dr({typed:e}),B=Io({typed:e,DenseMatrix:r}),c=rr({typed:e,equalScalar:n}),g=or({typed:e,DenseMatrix:r}),E=Dr({typed:e,matrix:t,concat:o});return e(sa,E({elop:i,SS:B,DS:a,SD:s,Ss:c,sS:g}))}));function Ba(A){var e=A.DenseMatrix;return function(A,t,n){var i=A.size();if(2!==i.length)throw new RangeError("Matrix must be two dimensional (size: "+Vt(i)+")");var r=i[0];if(r!==i[1])throw new RangeError("Matrix must be square (size: "+Vt(i)+")");var o=[];if(g(t)){var s=t.size(),a=t._data;if(1===s.length){if(s[0]!==r)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var B=0;B<r;B++)o[B]=[a[B]];return new e({data:o,size:[r,1],datatype:t._datatype})}if(2===s.length){if(s[0]!==r||1!==s[1])throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");if(Q(t)){if(n){o=[];for(var E=0;E<r;E++)o[E]=[a[E][0]];return new e({data:o,size:[r,1],datatype:t._datatype})}return t}if(u(t)){for(var l=0;l<r;l++)o[l]=[0];for(var w=t._values,h=t._index,C=t._ptr,I=C[1],M=C[0];M<I;M++)o[h[M]][0]=w[M];return new e({data:o,size:[r,1],datatype:t._datatype})}}throw new RangeError("Dimension mismatch. The right side has to be either 1- or 2-dimensional vector.")}if(c(t)){var d=$t(t);if(1===d.length){if(d[0]!==r)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var m=0;m<r;m++)o[m]=[t[m]];return new e({data:o,size:[r,1]})}if(2===d.length){if(d[0]!==r||1!==d[1])throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var p=0;p<r;p++)o[p]=[t[p][0]];return new e({data:o,size:[r,1]})}throw new RangeError("Dimension mismatch. The right side has to be either 1- or 2-dimensional vector.")}}}var ca=mA("lsolve",["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],(function(A){var e=A.typed,t=A.matrix,n=A.divideScalar,i=A.multiplyScalar,r=A.subtractScalar,o=A.equalScalar,s=A.DenseMatrix,a=Ba({DenseMatrix:s});return e("lsolve",{"SparseMatrix, Array | Matrix":function(A,e){return function(A,e){for(var t=(e=a(A,e,!0))._data,B=A._size[0],c=A._size[1],g=A._values,E=A._index,Q=A._ptr,u=[],l=0;l<c;l++){var w=t[l][0]||0;if(o(w,0))u[l]=[0];else{for(var h=0,C=[],I=[],M=Q[l],d=Q[l+1],m=M;m<d;m++){var p=E[m];p===l?h=g[m]:p>l&&(C.push(g[m]),I.push(p))}if(o(h,0))throw new Error("Linear system cannot be solved since matrix is singular");for(var F=n(w,h),D=0,Y=I.length;D<Y;D++){var f=I[D];t[f]=[r(t[f][0]||0,i(F,C[D]))]}u[l]=[F]}}return new s({data:u,size:[B,1]})}(A,e)},"DenseMatrix, Array | Matrix":function(A,e){return B(A,e)},"Array, Array | Matrix":function(A,e){return B(t(A),e).valueOf()}});function B(A,e){for(var t=(e=a(A,e,!0))._data,B=A._size[0],c=A._size[1],g=[],E=A._data,Q=0;Q<c;Q++){var u=t[Q][0]||0,l=void 0;if(o(u,0))l=0;else{var w=E[Q][Q];if(o(w,0))throw new Error("Linear system cannot be solved since matrix is singular");l=n(u,w);for(var h=Q+1;h<B;h++)t[h]=[r(t[h][0]||0,i(l,E[h][Q]))]}g[Q]=[l]}return new s({data:g,size:[B,1]})}})),ga=mA("usolve",["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],(function(A){var e=A.typed,t=A.matrix,n=A.divideScalar,i=A.multiplyScalar,r=A.subtractScalar,o=A.equalScalar,s=A.DenseMatrix,a=Ba({DenseMatrix:s});return e("usolve",{"SparseMatrix, Array | Matrix":function(A,e){return function(A,e){for(var t=(e=a(A,e,!0))._data,B=A._size[0],c=A._size[1],g=A._values,E=A._index,Q=A._ptr,u=[],l=c-1;l>=0;l--){var w=t[l][0]||0;if(o(w,0))u[l]=[0];else{for(var h=0,C=[],I=[],M=Q[l],d=Q[l+1]-1;d>=M;d--){var m=E[d];m===l?h=g[d]:m<l&&(C.push(g[d]),I.push(m))}if(o(h,0))throw new Error("Linear system cannot be solved since matrix is singular");for(var p=n(w,h),F=0,D=I.length;F<D;F++){var Y=I[F];t[Y]=[r(t[Y][0],i(p,C[F]))]}u[l]=[p]}}return new s({data:u,size:[B,1]})}(A,e)},"DenseMatrix, Array | Matrix":function(A,e){return B(A,e)},"Array, Array | Matrix":function(A,e){return B(t(A),e).valueOf()}});function B(A,e){for(var t=(e=a(A,e,!0))._data,B=A._size[0],c=A._size[1],g=[],E=A._data,Q=c-1;Q>=0;Q--){var u=t[Q][0]||0,l=void 0;if(o(u,0))l=0;else{var w=E[Q][Q];if(o(w,0))throw new Error("Linear system cannot be solved since matrix is singular");l=n(u,w);for(var h=Q-1;h>=0;h--)t[h]=[r(t[h][0]||0,i(l,E[h][Q]))]}g[Q]=[l]}return new s({data:g,size:[B,1]})}})),Ea="lsolveAll",Qa=mA(Ea,["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],(function(A){var e=A.typed,t=A.matrix,n=A.divideScalar,i=A.multiplyScalar,r=A.subtractScalar,o=A.equalScalar,s=A.DenseMatrix,a=Ba({DenseMatrix:s});return e(Ea,{"SparseMatrix, Array | Matrix":function(A,e){return function(A,e){for(var t=[a(A,e,!0)._data.map((function(A){return A[0]}))],B=A._size[0],c=A._size[1],g=A._values,E=A._index,Q=A._ptr,u=0;u<c;u++)for(var l=t.length,w=0;w<l;w++){for(var h=t[w],C=[],I=[],M=Q[u],d=Q[u+1],m=0,p=M;p<d;p++){var F=E[p];F===u?m=g[p]:F>u&&(C.push(g[p]),I.push(F))}if(o(m,0))if(o(h[u],0)){if(0===w){var D=zt(h);D[u]=1;for(var Y=0,f=I.length;Y<f;Y++){var N=I[Y];D[N]=r(D[N],C[Y])}t.push(D)}}else{if(0===w)return[];t.splice(w,1),w-=1,l-=1}else{h[u]=n(h[u],m);for(var U=0,y=I.length;U<y;U++){var T=I[U];h[T]=r(h[T],i(h[u],C[U]))}}}return t.map((function(A){return new s({data:A.map((function(A){return[A]})),size:[B,1]})}))}(A,e)},"DenseMatrix, Array | Matrix":function(A,e){return B(A,e)},"Array, Array | Matrix":function(A,e){return B(t(A),e).map((function(A){return A.valueOf()}))}});function B(A,e){for(var t=[a(A,e,!0)._data.map((function(A){return A[0]}))],B=A._data,c=A._size[0],g=A._size[1],E=0;E<g;E++)for(var Q=t.length,u=0;u<Q;u++){var l=t[u];if(o(B[E][E],0))if(o(l[E],0)){if(0===u){var w=zt(l);w[E]=1;for(var h=E+1;h<g;h++)w[h]=r(w[h],B[h][E]);t.push(w)}}else{if(0===u)return[];t.splice(u,1),u-=1,Q-=1}else{l[E]=n(l[E],B[E][E]);for(var C=E+1;C<g;C++)l[C]=r(l[C],i(l[E],B[C][E]))}}return t.map((function(A){return new s({data:A.map((function(A){return[A]})),size:[c,1]})}))}})),ua="usolveAll",la=mA(ua,["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],(function(A){var e=A.typed,t=A.matrix,n=A.divideScalar,i=A.multiplyScalar,r=A.subtractScalar,o=A.equalScalar,s=A.DenseMatrix,a=Ba({DenseMatrix:s});return e(ua,{"SparseMatrix, Array | Matrix":function(A,e){return function(A,e){for(var t=[a(A,e,!0)._data.map((function(A){return A[0]}))],B=A._size[0],c=A._size[1],g=A._values,E=A._index,Q=A._ptr,u=c-1;u>=0;u--)for(var l=t.length,w=0;w<l;w++){for(var h=t[w],C=[],I=[],M=Q[u],d=0,m=Q[u+1]-1;m>=M;m--){var p=E[m];p===u?d=g[m]:p<u&&(C.push(g[m]),I.push(p))}if(o(d,0))if(o(h[u],0)){if(0===w){var F=zt(h);F[u]=1;for(var D=0,Y=I.length;D<Y;D++){var f=I[D];F[f]=r(F[f],C[D])}t.push(F)}}else{if(0===w)return[];t.splice(w,1),w-=1,l-=1}else{h[u]=n(h[u],d);for(var N=0,U=I.length;N<U;N++){var y=I[N];h[y]=r(h[y],i(h[u],C[N]))}}}return t.map((function(A){return new s({data:A.map((function(A){return[A]})),size:[B,1]})}))}(A,e)},"DenseMatrix, Array | Matrix":function(A,e){return B(A,e)},"Array, Array | Matrix":function(A,e){return B(t(A),e).map((function(A){return A.valueOf()}))}});function B(A,e){for(var t=[a(A,e,!0)._data.map((function(A){return A[0]}))],B=A._data,c=A._size[0],g=A._size[1]-1;g>=0;g--)for(var E=t.length,Q=0;Q<E;Q++){var u=t[Q];if(o(B[g][g],0))if(o(u[g],0)){if(0===Q){var l=zt(u);l[g]=1;for(var w=g-1;w>=0;w--)l[w]=r(l[w],B[w][g]);t.push(l)}}else{if(0===Q)return[];t.splice(Q,1),Q-=1,E-=1}else{u[g]=n(u[g],B[g][g]);for(var h=g-1;h>=0;h--)u[h]=r(u[h],i(u[g],B[h][g]))}}return t.map((function(A){return new s({data:A.map((function(A){return[A]})),size:[c,1]})}))}})),wa=mA("matAlgo08xS0Sid",["typed","equalScalar"],(function(A){var e=A.typed,t=A.equalScalar;return function(A,n,i){var r=A._values,o=A._index,s=A._ptr,a=A._size,B=A._datatype,c=n._values,g=n._index,E=n._ptr,Q=n._size,u=n._datatype;if(a.length!==Q.length)throw new _t(a.length,Q.length);if(a[0]!==Q[0]||a[1]!==Q[1])throw new RangeError("Dimension mismatch. Matrix A ("+a+") must match Matrix B ("+Q+")");if(!r||!c)throw new Error("Cannot perform operation on Pattern Sparse Matrices");var l,w=a[0],h=a[1],C=t,I=0,M=i;"string"==typeof B&&B===u&&(l=B,C=e.find(t,[l,l]),I=e.convert(0,l),M=e.find(i,[l,l]));for(var d,m,p,F,D=[],Y=[],f=[],N=[],U=[],y=0;y<h;y++){f[y]=Y.length;var T=y+1;for(m=s[y],p=s[y+1],d=m;d<p;d++)U[F=o[d]]=T,N[F]=r[d],Y.push(F);for(m=E[y],p=E[y+1],d=m;d<p;d++)U[F=g[d]]===T&&(N[F]=M(N[F],c[d]));for(d=f[y];d<Y.length;){var x=N[F=Y[d]];C(x,I)?Y.splice(d,1):(D.push(x),d++)}}return f[h]=Y.length,A.createSparseMatrix({values:D,index:Y,ptr:f,size:[w,h],datatype:l})}})),ha=mA("useMatrixForArrayScalar",["typed","matrix"],(function(A){var e=A.typed,t=A.matrix;return{"Array, number":e.referTo("DenseMatrix, number",(function(A){return function(e,n){return A(t(e),n).valueOf()}})),"Array, BigNumber":e.referTo("DenseMatrix, BigNumber",(function(A){return function(e,n){return A(t(e),n).valueOf()}})),"number, Array":e.referTo("number, DenseMatrix",(function(A){return function(e,n){return A(e,t(n)).valueOf()}})),"BigNumber, Array":e.referTo("BigNumber, DenseMatrix",(function(A){return function(e,n){return A(e,t(n)).valueOf()}}))}})),Ca="leftShift",Ia=mA(Ca,["typed","matrix","equalScalar","zeros","DenseMatrix","concat"],(function(A){var e=A.typed,t=A.matrix,n=A.equalScalar,i=A.zeros,r=A.DenseMatrix,o=A.concat,s=fr({typed:e}),a=Mr({typed:e,equalScalar:n}),B=wa({typed:e,equalScalar:n}),c=Ur({typed:e,DenseMatrix:r}),g=rr({typed:e,equalScalar:n}),E=sr({typed:e}),Q=Dr({typed:e,matrix:t,concat:o}),u=ha({typed:e,matrix:t});return e(Ca,{"number, number":Qo,"BigNumber, BigNumber":oo,"SparseMatrix, number | BigNumber":e.referToSelf((function(A){return function(e,t){return n(t,0)?e.clone():g(e,t,A,!1)}})),"DenseMatrix, number | BigNumber":e.referToSelf((function(A){return function(e,t){return n(t,0)?e.clone():E(e,t,A,!1)}})),"number | BigNumber, SparseMatrix":e.referToSelf((function(A){return function(e,t){return n(e,0)?i(t.size(),t.storage()):c(t,e,A,!0)}})),"number | BigNumber, DenseMatrix":e.referToSelf((function(A){return function(e,t){return n(e,0)?i(t.size(),t.storage()):E(t,e,A,!0)}}))},u,Q({SS:B,DS:s,SD:a}))})),Ma="rightArithShift",da=mA(Ma,["typed","matrix","equalScalar","zeros","DenseMatrix","concat"],(function(A){var e=A.typed,t=A.matrix,n=A.equalScalar,i=A.zeros,r=A.DenseMatrix,o=A.concat,s=fr({typed:e}),a=Mr({typed:e,equalScalar:n}),B=wa({typed:e,equalScalar:n}),c=Ur({typed:e,DenseMatrix:r}),g=rr({typed:e,equalScalar:n}),E=sr({typed:e}),Q=Dr({typed:e,matrix:t,concat:o}),u=ha({typed:e,matrix:t});return e(Ma,{"number, number":uo,"BigNumber, BigNumber":so,"SparseMatrix, number | BigNumber":e.referToSelf((function(A){return function(e,t){return n(t,0)?e.clone():g(e,t,A,!1)}})),"DenseMatrix, number | BigNumber":e.referToSelf((function(A){return function(e,t){return n(t,0)?e.clone():E(e,t,A,!1)}})),"number | BigNumber, SparseMatrix":e.referToSelf((function(A){return function(e,t){return n(e,0)?i(t.size(),t.storage()):c(t,e,A,!0)}})),"number | BigNumber, DenseMatrix":e.referToSelf((function(A){return function(e,t){return n(e,0)?i(t.size(),t.storage()):E(t,e,A,!0)}}))},u,Q({SS:B,DS:s,SD:a}))})),ma="rightLogShift",pa=mA(ma,["typed","matrix","equalScalar","zeros","DenseMatrix","concat"],(function(A){var e=A.typed,t=A.matrix,n=A.equalScalar,i=A.zeros,r=A.DenseMatrix,o=A.concat,s=fr({typed:e}),a=Mr({typed:e,equalScalar:n}),B=wa({typed:e,equalScalar:n}),c=Ur({typed:e,DenseMatrix:r}),g=rr({typed:e,equalScalar:n}),E=sr({typed:e}),Q=Dr({typed:e,matrix:t,concat:o}),u=ha({typed:e,matrix:t});return e(ma,{"number, number":lo,"SparseMatrix, number | BigNumber":e.referToSelf((function(A){return function(e,t){return n(t,0)?e.clone():g(e,t,A,!1)}})),"DenseMatrix, number | BigNumber":e.referToSelf((function(A){return function(e,t){return n(t,0)?e.clone():E(e,t,A,!1)}})),"number | BigNumber, SparseMatrix":e.referToSelf((function(A){return function(e,t){return n(e,0)?i(t.size(),t.storage()):c(t,e,A,!0)}})),"number | BigNumber, DenseMatrix":e.referToSelf((function(A){return function(e,t){return n(e,0)?i(t.size(),t.storage()):E(t,e,A,!0)}}))},u,Q({SS:B,DS:s,SD:a}))})),Fa=mA("and",["typed","matrix","equalScalar","zeros","not","concat"],(function(A){var e=A.typed,t=A.matrix,n=A.equalScalar,i=A.zeros,r=A.not,o=A.concat,s=Mr({typed:e,equalScalar:n}),a=Sr({typed:e,equalScalar:n}),B=rr({typed:e,equalScalar:n}),c=sr({typed:e}),g=Dr({typed:e,matrix:t,concat:o});return e("and",{"number, number":yo,"Complex, Complex":function(A,e){return!(0===A.re&&0===A.im||0===e.re&&0===e.im)},"BigNumber, BigNumber":function(A,e){return!(A.isZero()||e.isZero()||A.isNaN()||e.isNaN())},"Unit, Unit":e.referToSelf((function(A){return function(e,t){return A(e.value||0,t.value||0)}})),"SparseMatrix, any":e.referToSelf((function(A){return function(e,t){return r(t)?i(e.size(),e.storage()):B(e,t,A,!1)}})),"DenseMatrix, any":e.referToSelf((function(A){return function(e,t){return r(t)?i(e.size(),e.storage()):c(e,t,A,!1)}})),"any, SparseMatrix":e.referToSelf((function(A){return function(e,t){return r(e)?i(e.size(),e.storage()):B(t,e,A,!0)}})),"any, DenseMatrix":e.referToSelf((function(A){return function(e,t){return r(e)?i(e.size(),e.storage()):c(t,e,A,!0)}})),"Array, any":e.referToSelf((function(A){return function(e,n){return A(t(e),n).valueOf()}})),"any, Array":e.referToSelf((function(A){return function(e,n){return A(e,t(n)).valueOf()}}))},g({SS:a,DS:s}))})),Da="compare",Ya=mA(Da,["typed","config","matrix","equalScalar","BigNumber","Fraction","DenseMatrix","concat"],(function(A){var e=A.typed,t=A.config,n=A.equalScalar,i=A.matrix,r=A.BigNumber,o=A.Fraction,s=A.DenseMatrix,a=A.concat,B=dr({typed:e}),c=mr({typed:e,equalScalar:n}),g=or({typed:e,DenseMatrix:s}),E=Dr({typed:e,matrix:i,concat:a}),Q=ni({typed:e});return e(Da,fa({typed:e,config:t}),{"boolean, boolean":function(A,e){return A===e?0:A>e?1:-1},"BigNumber, BigNumber":function(A,e){return ti(A,e,t.epsilon)?new r(0):new r(A.cmp(e))},"Fraction, Fraction":function(A,e){return new o(A.compare(e))},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},Q,E({SS:c,DS:B,Ss:g}))})),fa=mA(Da,["typed","config"],(function(A){var e=A.typed,t=A.config;return e(Da,{"number, number":function(A,e){return sA(A,e,t.epsilon)?0:A>e?1:-1}})})),Na=n(3228),Ua="compareNatural",ya=mA(Ua,["typed","compare"],(function(A){var e=A.typed,t=A.compare,n=t.signatures["boolean,boolean"];return e(Ua,{"any, any":function A(e,r){var o,s=P(e),a=P(r);if(!("number"!==s&&"BigNumber"!==s&&"Fraction"!==s||"number"!==a&&"BigNumber"!==a&&"Fraction"!==a))return"0"!==(o=t(e,r)).toString()?o>0?1:-1:Na(s,a);var B=["Array","DenseMatrix","SparseMatrix"];if(B.includes(s)||B.includes(a))return 0!==(o=function A(e,t,n){return u(t)&&u(n)?i(e,t.toJSON().values,n.toJSON().values):u(t)?A(e,t.toArray(),n):u(n)?A(e,t,n.toArray()):Q(t)?A(e,t.toJSON().data,n):Q(n)?A(e,t,n.toJSON().data):Array.isArray(t)?Array.isArray(n)?i(e,t,n):A(e,t,[n]):A(e,[t],n)}(A,e,r))?o:Na(s,a);if(s!==a)return Na(s,a);if("Complex"===s)return function(A,e){return A.re>e.re?1:A.re<e.re?-1:A.im>e.im?1:A.im<e.im?-1:0}(e,r);if("Unit"===s)return e.equalBase(r)?A(e.value,r.value):i(A,e.formatUnits(),r.formatUnits());if("boolean"===s)return n(e,r);if("string"===s)return Na(e,r);if("Object"===s)return function(A,e,t){var n=Object.keys(e),r=Object.keys(t);n.sort(Na),r.sort(Na);var o=i(A,n,r);if(0!==o)return o;for(var s=0;s<n.length;s++){var a=A(e[n[s]],t[r[s]]);if(0!==a)return a}return 0}(A,e,r);if("null"===s)return 0;if("undefined"===s)return 0;throw new TypeError('Unsupported type of value "'+s+'"')}});function i(A,e,t){for(var n=0,i=Math.min(e.length,t.length);n<i;n++){var r=A(e[n],t[n]);if(0!==r)return r}return e.length>t.length?1:e.length<t.length?-1:0}})),Ta="compareText";Zt.signature="any, any";var xa=mA(Ta,["typed","matrix","concat"],(function(A){var e=A.typed,t=A.matrix,n=A.concat,i=Dr({typed:e,matrix:t,concat:n});return e(Ta,Zt,i({elop:Zt,Ds:!0}))})),Ra="equal",Ga=mA(Ra,["typed","matrix","equalScalar","DenseMatrix","concat"],(function(A){var e=A.typed,t=A.matrix,n=A.equalScalar,i=A.DenseMatrix,r=A.concat,o=dr({typed:e}),s=Io({typed:e,DenseMatrix:i}),a=or({typed:e,DenseMatrix:i}),B=Dr({typed:e,matrix:t,concat:r});return e(Ra,Sa({typed:e,equalScalar:n}),B({elop:n,SS:s,DS:o,Ss:a}))})),Sa=mA(Ra,["typed","equalScalar"],(function(A){var e=A.typed,t=A.equalScalar;return e(Ra,{"any, any":function(A,e){return null===A?null===e:null===e?null===A:void 0===A?void 0===e:void 0===e?void 0===A:t(A,e)}})})),Ha="equalText",ba=mA(Ha,["typed","compareText","isZero"],(function(A){var e=A.typed,t=A.compareText,n=A.isZero;return e(Ha,{"any, any":function(A,e){return n(t(A,e))}})})),va="smaller",ka=mA(va,["typed","config","matrix","DenseMatrix","concat"],(function(A){var e=A.typed,t=A.config,n=A.matrix,i=A.DenseMatrix,r=A.concat,o=dr({typed:e}),s=Io({typed:e,DenseMatrix:i}),a=or({typed:e,DenseMatrix:i}),B=Dr({typed:e,matrix:n,concat:r}),c=ni({typed:e});return e(va,ja({typed:e,config:t}),{"boolean, boolean":function(A,e){return A<e},"BigNumber, BigNumber":function(A,e){return A.lt(e)&&!ti(A,e,t.epsilon)},"Fraction, Fraction":function(A,e){return-1===A.compare(e)},"Complex, Complex":function(A,e){throw new TypeError("No ordering relation is defined for complex numbers")}},c,B({SS:s,DS:o,Ss:a}))})),ja=mA(va,["typed","config"],(function(A){var e=A.typed,t=A.config;return e(va,{"number, number":function(A,e){return A<e&&!sA(A,e,t.epsilon)}})})),Ja="smallerEq",za=mA(Ja,["typed","config","matrix","DenseMatrix","concat"],(function(A){var e=A.typed,t=A.config,n=A.matrix,i=A.DenseMatrix,r=A.concat,o=dr({typed:e}),s=Io({typed:e,DenseMatrix:i}),a=or({typed:e,DenseMatrix:i}),B=Dr({typed:e,matrix:n,concat:r}),c=ni({typed:e});return e(Ja,La({typed:e,config:t}),{"boolean, boolean":function(A,e){return A<=e},"BigNumber, BigNumber":function(A,e){return A.lte(e)||ti(A,e,t.epsilon)},"Fraction, Fraction":function(A,e){return 1!==A.compare(e)},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},c,B({SS:s,DS:o,Ss:a}))})),La=mA(Ja,["typed","config"],(function(A){var e=A.typed,t=A.config;return e(Ja,{"number, number":function(A,e){return A<=e||sA(A,e,t.epsilon)}})})),Pa="larger",Oa=mA(Pa,["typed","config","matrix","DenseMatrix","concat"],(function(A){var e=A.typed,t=A.config,n=A.matrix,i=A.DenseMatrix,r=A.concat,o=dr({typed:e}),s=Io({typed:e,DenseMatrix:i}),a=or({typed:e,DenseMatrix:i}),B=Dr({typed:e,matrix:n,concat:r}),c=ni({typed:e});return e(Pa,Va({typed:e,config:t}),{"boolean, boolean":function(A,e){return A>e},"BigNumber, BigNumber":function(A,e){return A.gt(e)&&!ti(A,e,t.epsilon)},"Fraction, Fraction":function(A,e){return 1===A.compare(e)},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},c,B({SS:s,DS:o,Ss:a}))})),Va=mA(Pa,["typed","config"],(function(A){var e=A.typed,t=A.config;return e(Pa,{"number, number":function(A,e){return A>e&&!sA(A,e,t.epsilon)}})})),Wa="largerEq",Ka=mA(Wa,["typed","config","matrix","DenseMatrix","concat"],(function(A){var e=A.typed,t=A.config,n=A.matrix,i=A.DenseMatrix,r=A.concat,o=dr({typed:e}),s=Io({typed:e,DenseMatrix:i}),a=or({typed:e,DenseMatrix:i}),B=Dr({typed:e,matrix:n,concat:r}),c=ni({typed:e});return e(Wa,Xa({typed:e,config:t}),{"boolean, boolean":function(A,e){return A>=e},"BigNumber, BigNumber":function(A,e){return A.gte(e)||ti(A,e,t.epsilon)},"Fraction, Fraction":function(A,e){return-1!==A.compare(e)},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},c,B({SS:s,DS:o,Ss:a}))})),Xa=mA(Wa,["typed","config"],(function(A){var e=A.typed,t=A.config;return e(Wa,{"number, number":function(A,e){return A>=e||sA(A,e,t.epsilon)}})})),Za="deepEqual",_a=mA(Za,["typed","equal"],(function(A){var e=A.typed,t=A.equal;return e(Za,{"any, any":function(A,e){return function A(e,n){if(Array.isArray(e)){if(Array.isArray(n)){var i=e.length;if(i!==n.length)return!1;for(var r=0;r<i;r++)if(!A(e[r],n[r]))return!1;return!0}return!1}return!Array.isArray(n)&&t(e,n)}(A.valueOf(),e.valueOf())}})})),qa="unequal",$a=mA(qa,["typed","config","equalScalar","matrix","DenseMatrix","concat"],(function(A){var e=A.typed,t=(A.config,A.equalScalar),n=A.matrix,i=A.DenseMatrix,r=A.concat,o=dr({typed:e}),s=Io({typed:e,DenseMatrix:i}),a=or({typed:e,DenseMatrix:i}),B=Dr({typed:e,matrix:n,concat:r});return e(qa,AB({typed:e,equalScalar:t}),B({elop:function(A,e){return!t(A,e)},SS:s,DS:o,Ss:a}))})),AB=mA(qa,["typed","equalScalar"],(function(A){var e=A.typed,t=A.equalScalar;return e(qa,{"any, any":function(A,e){return null===A?null!==e:null===e?null!==A:void 0===A?void 0!==e:void 0===e?void 0!==A:!t(A,e)}})})),eB="partitionSelect",tB=mA(eB,["typed","isNumeric","isNaN","compare"],(function(A){var e=A.typed,t=A.isNumeric,n=A.isNaN,i=A.compare,r=i,o=function(A,e){return-i(A,e)};return e(eB,{"Array | Matrix, number":function(A,e){return s(A,e,r)},"Array | Matrix, number, string":function(A,e,t){if("asc"===t)return s(A,e,r);if("desc"===t)return s(A,e,o);throw new Error('Compare string must be "asc" or "desc"')},"Array | Matrix, number, function":s});function s(A,e,t){if(!V(e)||e<0)throw new Error("k must be a non-negative integer");if(g(A)){if(A.size().length>1)throw new Error("Only one dimensional matrices supported");return a(A.valueOf(),e,t)}if(Array.isArray(A))return a(A,e,t)}function a(A,e,i){if(e>=A.length)throw new Error("k out of bounds");for(var r=0;r<A.length;r++)if(t(A[r])&&n(A[r]))return A[r];for(var o=0,s=A.length-1;o<s;){for(var a=o,B=s,c=A[Math.floor(Math.random()*(s-o+1))+o];a<B;)if(i(A[a],c)>=0){var g=A[B];A[B]=A[a],A[a]=g,--B}else++a;i(A[a],c)>0&&--a,e<=a?s=a:o=a+1}return A[e]}})),nB=mA("sort",["typed","matrix","compare","compareNatural"],(function(A){var e=A.typed,t=A.matrix,n=A.compare,i=A.compareNatural,r=n,o=function(A,e){return-n(A,e)};return e("sort",{Array:function(A){return a(A),A.sort(r)},Matrix:function(A){return B(A),t(A.toArray().sort(r),A.storage())},"Array, function":function(A,e){return a(A),A.sort(e)},"Matrix, function":function(A,e){return B(A),t(A.toArray().sort(e),A.storage())},"Array, string":function(A,e){return a(A),A.sort(s(e))},"Matrix, string":function(A,e){return B(A),t(A.toArray().sort(s(e)),A.storage())}});function s(A){if("asc"===A)return r;if("desc"===A)return o;if("natural"===A)return i;throw new Error('String "asc", "desc", or "natural" expected')}function a(A){if(1!==$t(A).length)throw new Error("One dimensional array expected")}function B(A){if(1!==A.size().length)throw new Error("One dimensional matrix expected")}})),iB=mA("max",["typed","config","numeric","larger"],(function(A){var e=A.typed,t=A.config,n=A.numeric,i=A.larger;return e("max",{"Array | Matrix":o,"Array | Matrix, number | BigNumber":function(A,e){return Sn(A,e.valueOf(),r)},"...":function(A){if(xn(A))throw new TypeError("Scalar values expected in function max");return o(A)}});function r(A,e){try{return i(A,e)?A:e}catch(A){throw vs(A,"max",e)}}function o(A){var e;if(Rn(A,(function(A){try{isNaN(A)&&"number"==typeof A?e=NaN:(void 0===e||i(A,e))&&(e=A)}catch(e){throw vs(e,"max",A)}})),void 0===e)throw new Error("Cannot calculate max of an empty array");return"string"==typeof e&&(e=n(e,t.number)),e}})),rB=mA("min",["typed","config","numeric","smaller"],(function(A){var e=A.typed,t=A.config,n=A.numeric,i=A.smaller;return e("min",{"Array | Matrix":o,"Array | Matrix, number | BigNumber":function(A,e){return Sn(A,e.valueOf(),r)},"...":function(A){if(xn(A))throw new TypeError("Scalar values expected in function min");return o(A)}});function r(A,e){try{return i(A,e)?A:e}catch(A){throw vs(A,"min",e)}}function o(A){var e;if(Rn(A,(function(A){try{isNaN(A)&&"number"==typeof A?e=NaN:(void 0===e||i(A,e))&&(e=A)}catch(e){throw vs(e,"min",A)}})),void 0===e)throw new Error("Cannot calculate min of an empty array");return"string"==typeof e&&(e=n(e,t.number)),e}})),oB=mA("ImmutableDenseMatrix",["smaller","DenseMatrix"],(function(A){var e=A.smaller,t=A.DenseMatrix;function n(A,e){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(e&&!B(e))throw new Error("Invalid datatype: "+e);if(g(A)||c(A)){var i=new t(A,e);this._data=i._data,this._size=i._size,this._datatype=i._datatype,this._min=null,this._max=null}else if(A&&c(A.data)&&c(A.size))this._data=A.data,this._size=A.size,this._datatype=A.datatype,this._min=void 0!==A.min?A.min:null,this._max=void 0!==A.max?A.max:null;else{if(A)throw new TypeError("Unsupported type of data ("+P(A)+")");this._data=[],this._size=[0],this._datatype=e,this._min=null,this._max=null}}return n.prototype=new t,n.prototype.type="ImmutableDenseMatrix",n.prototype.isImmutableDenseMatrix=!0,n.prototype.subset=function(A){switch(arguments.length){case 1:var e=t.prototype.subset.call(this,A);return g(e)?new n({data:e._data,size:e._size,datatype:e._datatype}):e;case 2:case 3:throw new Error("Cannot invoke set subset on an Immutable Matrix instance");default:throw new SyntaxError("Wrong number of arguments")}},n.prototype.set=function(){throw new Error("Cannot invoke set on an Immutable Matrix instance")},n.prototype.resize=function(){throw new Error("Cannot invoke resize on an Immutable Matrix instance")},n.prototype.reshape=function(){throw new Error("Cannot invoke reshape on an Immutable Matrix instance")},n.prototype.clone=function(){return new n({data:uA(this._data),size:uA(this._size),datatype:this._datatype})},n.prototype.toJSON=function(){return{mathjs:"ImmutableDenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},n.fromJSON=function(A){return new n(A)},n.prototype.swapRows=function(){throw new Error("Cannot invoke swapRows on an Immutable Matrix instance")},n.prototype.min=function(){if(null===this._min){var A=null;this.forEach((function(t){(null===A||e(t,A))&&(A=t)})),this._min=null!==A?A:void 0}return this._min},n.prototype.max=function(){if(null===this._max){var A=null;this.forEach((function(t){(null===A||e(A,t))&&(A=t)})),this._max=null!==A?A:void 0}return this._max},n}),{isClass:!0}),sB=mA("Index",["ImmutableDenseMatrix","getMatrixDataType"],(function(A){var e=A.ImmutableDenseMatrix,t=A.getMatrixDataType;function n(A){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");this._dimensions=[],this._sourceSize=[],this._isScalar=!0;for(var e=0,r=arguments.length;e<r;e++){var o=arguments[e],s=c(o),a=g(o),B=null;if(l(o))this._dimensions.push(o),this._isScalar=!1;else if(s||a){var E=void 0;"boolean"===t(o)?(s&&(E=i(aB(o).valueOf())),a&&(E=i(aB(o._data).valueOf())),B=o.valueOf().length):E=i(o.valueOf()),this._dimensions.push(E);var Q=E.size();1===Q.length&&1===Q[0]&&null===B||(this._isScalar=!1)}else if("number"==typeof o)this._dimensions.push(i([o]));else{if("string"!=typeof o)throw new TypeError("Dimension must be an Array, Matrix, number, string, or Range");this._dimensions.push(o)}this._sourceSize.push(B)}}function i(A){for(var t=0,n=A.length;t<n;t++)if("number"!=typeof A[t]||!V(A[t]))throw new TypeError("Index parameters must be positive integer numbers");return new e(A)}return n.prototype.type="Index",n.prototype.isIndex=!0,n.prototype.clone=function(){var A=new n;return A._dimensions=uA(this._dimensions),A._isScalar=this._isScalar,A._sourceSize=this._sourceSize,A},n.create=function(A){var e=new n;return n.apply(e,A),e},n.prototype.size=function(){for(var A=[],e=0,t=this._dimensions.length;e<t;e++){var n=this._dimensions[e];A[e]="string"==typeof n?1:n.size()[0]}return A},n.prototype.max=function(){for(var A=[],e=0,t=this._dimensions.length;e<t;e++){var n=this._dimensions[e];A[e]="string"==typeof n?n:n.max()}return A},n.prototype.min=function(){for(var A=[],e=0,t=this._dimensions.length;e<t;e++){var n=this._dimensions[e];A[e]="string"==typeof n?n:n.min()}return A},n.prototype.forEach=function(A){for(var e=0,t=this._dimensions.length;e<t;e++)A(this._dimensions[e],e,this)},n.prototype.dimension=function(A){return this._dimensions[A]||null},n.prototype.isObjectProperty=function(){return 1===this._dimensions.length&&"string"==typeof this._dimensions[0]},n.prototype.getObjectProperty=function(){return this.isObjectProperty()?this._dimensions[0]:null},n.prototype.isScalar=function(){return this._isScalar},n.prototype.toArray=function(){for(var A=[],e=0,t=this._dimensions.length;e<t;e++){var n=this._dimensions[e];A.push("string"==typeof n?n:n.toArray())}return A},n.prototype.valueOf=n.prototype.toArray,n.prototype.toString=function(){for(var A=[],e=0,t=this._dimensions.length;e<t;e++){var n=this._dimensions[e];"string"==typeof n?A.push(JSON.stringify(n)):A.push(n.toString())}return"["+A.join(", ")+"]"},n.prototype.toJSON=function(){return{mathjs:"Index",dimensions:this._dimensions}},n.fromJSON=function(A){return n.create(A.dimensions)},n}),{isClass:!0});function aB(A){var e=[];return A.forEach((function(A,t){A&&e.push(t)})),e}var BB=mA("FibonacciHeap",["smaller","larger"],(function(A){var e=A.smaller,t=A.larger,n=1/Math.log((1+Math.sqrt(5))/2);function i(){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");this._minimum=null,this._size=0}function r(A,e,t){e.left.right=e.right,e.right.left=e.left,t.degree--,t.child===e&&(t.child=e.right),0===t.degree&&(t.child=null),e.left=A,e.right=A.right,A.right=e,e.right.left=e,e.parent=null,e.mark=!1}i.prototype.type="FibonacciHeap",i.prototype.isFibonacciHeap=!0,i.prototype.insert=function(A,t){var n={key:A,value:t,degree:0};if(this._minimum){var i=this._minimum;n.left=i,n.right=i.right,i.right=n,n.right.left=n,e(A,i.key)&&(this._minimum=n)}else n.left=n,n.right=n,this._minimum=n;return this._size++,n},i.prototype.size=function(){return this._size},i.prototype.clear=function(){this._minimum=null,this._size=0},i.prototype.isEmpty=function(){return 0===this._size},i.prototype.extractMinimum=function(){var A=this._minimum;if(null===A)return A;for(var i=this._minimum,r=A.degree,s=A.child;r>0;){var a=s.right;s.left.right=s.right,s.right.left=s.left,s.left=i,s.right=i.right,i.right=s,s.right.left=s,s.parent=null,s=a,r--}return A.left.right=A.right,A.right.left=A.left,i=A===A.right?null:function(A,i){var r,s=Math.floor(Math.log(i)*n)+1,a=new Array(s),B=0,c=A;if(c)for(B++,c=c.right;c!==A;)B++,c=c.right;for(;B>0;){for(var g=c.degree,E=c.right;r=a[g];){if(t(c.key,r.key)){var Q=r;r=c,c=Q}o(r,c),a[g]=null,g++}a[g]=c,c=E,B--}A=null;for(var u=0;u<s;u++)(r=a[u])&&(A?(r.left.right=r.right,r.right.left=r.left,r.left=A,r.right=A.right,A.right=r,r.right.left=r,e(r.key,A.key)&&(A=r)):A=r);return A}(i=A.right,this._size),this._size--,this._minimum=i,A},i.prototype.remove=function(A){this._minimum=function(A,t,n){t.key=-1;var i=t.parent;return i&&e(t.key,i.key)&&(r(A,t,i),function A(e,t){var n=t.parent;n&&(t.mark?(r(e,t,n),A(n)):t.mark=!0)}(A,i)),e(t.key,A.key)&&(A=t),A}(this._minimum,A),this.extractMinimum()};var o=function(A,e){A.left.right=A.right,A.right.left=A.left,A.parent=e,e.child?(A.left=e.child,A.right=e.child.right,e.child.right=A,A.right.left=A):(e.child=A,A.right=A,A.left=A),e.degree++,A.mark=!1};return i}),{isClass:!0}),cB=mA("Spa",["addScalar","equalScalar","FibonacciHeap"],(function(A){var e=A.addScalar,t=A.equalScalar,n=A.FibonacciHeap;function i(){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");this._values=[],this._heap=new n}return i.prototype.type="Spa",i.prototype.isSpa=!0,i.prototype.set=function(A,e){if(this._values[A])this._values[A].value=e;else{var t=this._heap.insert(A,e);this._values[A]=t}},i.prototype.get=function(A){var e=this._values[A];return e?e.value:0},i.prototype.accumulate=function(A,t){var n=this._values[A];n?n.value=e(n.value,t):(n=this._heap.insert(A,t),this._values[A]=n)},i.prototype.forEach=function(A,e,n){var i=this._heap,r=this._values,o=[],s=i.extractMinimum();for(s&&o.push(s);s&&s.key<=e;)s.key>=A&&(t(s.value,0)||n(s.key,s.value,this)),(s=i.extractMinimum())&&o.push(s);for(var a=0;a<o.length;a++){var B=o[a];r[(s=i.insert(B.key,B.value)).key]=s}},i.prototype.swap=function(A,e){var t=this._values[A],n=this._values[e];if(!t&&n)t=this._heap.insert(A,n.value),this._heap.remove(n),this._values[A]=t,this._values[e]=void 0;else if(t&&!n)n=this._heap.insert(e,t.value),this._heap.remove(t),this._values[e]=n,this._values[A]=void 0;else if(t&&n){var i=t.value;t.value=n.value,n.value=i}},i}),{isClass:!0}),gB=(n(372),Yn((function(A){return new A(1).exp()}),{hasher:lB})),EB=Yn((function(A){return new A(1).plus(new A(5).sqrt()).div(2)}),{hasher:lB}),QB=Yn((function(A){return A.acos(-1)}),{hasher:lB}),uB=Yn((function(A){return QB(A).times(2)}),{hasher:lB});function lB(A){return A[0].precision}function wB(A,e){var t=Object.keys(A);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(A);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(A,e).enumerable}))),t.push.apply(t,n)}return t}function hB(A){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?wB(Object(t),!0).forEach((function(e){Ir(A,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(t)):wB(Object(t)).forEach((function(e){Object.defineProperty(A,e,Object.getOwnPropertyDescriptor(t,e))}))}return A}var CB=mA("Unit",["?on","config","addScalar","subtractScalar","multiplyScalar","divideScalar","pow","abs","fix","round","equal","isNumeric","format","number","Complex","BigNumber","Fraction"],(function(A){var t,n,i,r=A.on,s=A.config,B=A.addScalar,c=A.subtractScalar,g=A.multiplyScalar,E=A.divideScalar,Q=A.pow,u=A.abs,l=A.fix,w=A.round,h=A.equal,C=A.isNumeric,I=A.format,M=A.number,d=A.Complex,m=A.BigNumber,p=A.Fraction,F=M;function D(A,e){if(!(this instanceof D))throw new Error("Constructor must be called with the new operator");if(null!=A&&!C(A)&&!o(A))throw new TypeError("First parameter in Unit constructor must be number, BigNumber, Fraction, Complex, or undefined");if(this.fixPrefix=!1,this.skipAutomaticSimplification=!0,void 0===e)this.units=[],this.dimensions=H.map((function(A){return 0}));else if("string"==typeof e){var t=D.parse(e);this.units=t.units,this.dimensions=t.dimensions}else{if(!a(e)||null!==e.value)throw new TypeError("Second parameter in Unit constructor must be a string or valueless Unit");this.fixPrefix=e.fixPrefix,this.skipAutomaticSimplification=e.skipAutomaticSimplification,this.dimensions=e.dimensions.slice(0),this.units=e.units.map((function(A){return kt({},A)}))}this.value=this._normalize(A)}function Y(){for(;" "===i||"\t"===i;)N()}function f(A){return A>="0"&&A<="9"}function N(){n++,i=t.charAt(n)}function U(A){n=A,i=t.charAt(n)}function y(){var A="",e=n;if("+"===i?N():"-"===i&&(A+=i,N()),!function(A){return A>="0"&&A<="9"||"."===A}(i))return U(e),null;if("."===i){if(A+=i,N(),!f(i))return U(e),null}else{for(;f(i);)A+=i,N();"."===i&&(A+=i,N())}for(;f(i);)A+=i,N();if("E"===i||"e"===i){var t="",r=n;if(t+=i,N(),"+"!==i&&"-"!==i||(t+=i,N()),!f(i))return U(r),A;for(A+=t;f(i);)A+=i,N()}return A}function T(){for(var A="";f(i)||D.isValidAlpha(i);)A+=i,N();var e=A.charAt(0);return D.isValidAlpha(e)?A:null}function x(A){return i===A?(N(),A):null}Object.defineProperty(D,"name",{value:"Unit"}),D.prototype.constructor=D,D.prototype.type="Unit",D.prototype.isUnit=!0,D.parse=function(A,e){if(e=e||{},n=-1,i="","string"!=typeof(t=A))throw new TypeError("Invalid argument in Unit.parse, string expected");var r=new D;r.units=[];var o=1,a=!1;N(),Y();var B=y(),c=null;if(B){if("BigNumber"===s.number)c=new m(B);else if("Fraction"===s.number)try{c=new p(B)}catch(A){c=parseFloat(B)}else c=parseFloat(B);Y(),x("*")?(o=1,a=!0):x("/")&&(o=-1,a=!0)}for(var g=[],E=1;;){for(Y();"("===i;)g.push(o),E*=o,o=1,N(),Y();var Q;if(!i)break;var u=i;if(null===(Q=T()))throw new SyntaxError('Unexpected "'+u+'" in "'+t+'" at index '+n.toString());var l=R(Q);if(null===l)throw new SyntaxError('Unit "'+Q+'" not found.');var w=o*E;if(Y(),x("^")){Y();var h=y();if(null===h)throw new SyntaxError('In "'+A+'", "^" must be followed by a floating-point number');w*=h}r.units.push({unit:l.unit,prefix:l.prefix,power:w});for(var C=0;C<H.length;C++)r.dimensions[C]+=(l.unit.dimensions[C]||0)*w;for(Y();")"===i;){if(0===g.length)throw new SyntaxError('Unmatched ")" in "'+t+'" at index '+n.toString());E/=g.pop(),N(),Y()}if(a=!1,x("*")?(o=1,a=!0):x("/")?(o=-1,a=!0):o=1,l.unit.base){var I=l.unit.base.key;L.auto[I]={unit:l.unit,prefix:l.prefix}}}if(Y(),i)throw new SyntaxError('Could not parse: "'+A+'"');if(a)throw new SyntaxError('Trailing characters: "'+A+'"');if(0!==g.length)throw new SyntaxError('Unmatched "(" in "'+t+'"');if(0===r.units.length&&!e.allowNoUnits)throw new SyntaxError('"'+A+'" contains no units');return r.value=void 0!==c?r._normalize(c):null,r},D.prototype.clone=function(){var A=new D;A.fixPrefix=this.fixPrefix,A.skipAutomaticSimplification=this.skipAutomaticSimplification,A.value=uA(this.value),A.dimensions=this.dimensions.slice(0),A.units=[];for(var e=0;e<this.units.length;e++)for(var t in A.units[e]={},this.units[e])MA(this.units[e],t)&&(A.units[e][t]=this.units[e][t]);return A},D.prototype.valueType=function(){return P(this.value)},D.prototype._isDerived=function(){return 0!==this.units.length&&(this.units.length>1||Math.abs(this.units[0].power-1)>1e-15)},D.prototype._normalize=function(A){if(null==A||0===this.units.length)return A;for(var e=A,t=D._getNumberConverter(P(A)),n=0;n<this.units.length;n++){var i=t(this.units[n].unit.value),r=t(this.units[n].prefix.value),o=t(this.units[n].power);e=g(e,Q(g(i,r),o))}return e},D.prototype._denormalize=function(A,e){if(null==A||0===this.units.length)return A;for(var t=A,n=D._getNumberConverter(P(A)),i=0;i<this.units.length;i++){var r=n(this.units[i].unit.value),o=n(this.units[i].prefix.value),s=n(this.units[i].power);t=E(t,Q(g(r,o),s))}return t};var R=Yn((function(A){if(MA(j,A)){var e=j[A];return{unit:e,prefix:e.prefixes[""]}}for(var t in j)if(MA(j,t)&&Ot(A,t)){var n=j[t],i=A.length-t.length,r=A.substring(0,i),o=MA(n.prefixes,r)?n.prefixes[r]:void 0;if(void 0!==o)return{unit:n,prefix:o}}return null}),{hasher:function(A){return A[0]},limit:100});function G(A){return A.equalBase(b.NONE)&&null!==A.value&&!s.predictable?A.value:A}D.isValuelessUnit=function(A){return null!==R(A)},D.prototype.hasBase=function(A){if("string"==typeof A&&(A=b[A]),!A)return!1;for(var e=0;e<H.length;e++)if(Math.abs((this.dimensions[e]||0)-(A.dimensions[e]||0))>1e-12)return!1;return!0},D.prototype.equalBase=function(A){for(var e=0;e<H.length;e++)if(Math.abs((this.dimensions[e]||0)-(A.dimensions[e]||0))>1e-12)return!1;return!0},D.prototype.equals=function(A){return this.equalBase(A)&&h(this.value,A.value)},D.prototype.multiply=function(A){for(var e=this.clone(),t=a(A)?A:new D(A),n=0;n<H.length;n++)e.dimensions[n]=(this.dimensions[n]||0)+(t.dimensions[n]||0);for(var i=0;i<t.units.length;i++){var r=hB({},t.units[i]);e.units.push(r)}if(null!==this.value||null!==t.value){var o=null===this.value?this._normalize(1):this.value,s=null===t.value?t._normalize(1):t.value;e.value=g(o,s)}else e.value=null;return a(A)&&(e.skipAutomaticSimplification=!1),G(e)},D.prototype.divideInto=function(A){return new D(A).divide(this)},D.prototype.divide=function(A){for(var e=this.clone(),t=a(A)?A:new D(A),n=0;n<H.length;n++)e.dimensions[n]=(this.dimensions[n]||0)-(t.dimensions[n]||0);for(var i=0;i<t.units.length;i++){var r=hB(hB({},t.units[i]),{},{power:-t.units[i].power});e.units.push(r)}if(null!==this.value||null!==t.value){var o=null===this.value?this._normalize(1):this.value,s=null===t.value?t._normalize(1):t.value;e.value=E(o,s)}else e.value=null;return a(A)&&(e.skipAutomaticSimplification=!1),G(e)},D.prototype.pow=function(A){for(var e=this.clone(),t=0;t<H.length;t++)e.dimensions[t]=(this.dimensions[t]||0)*A;for(var n=0;n<e.units.length;n++)e.units[n].power*=A;return null!==e.value?e.value=Q(e.value,A):e.value=null,e.skipAutomaticSimplification=!1,G(e)},D.prototype.abs=function(){var A=this.clone();if(null!==A.value)if(A._isDerived()||0===A.units[0].unit.offset)A.value=u(A.value);else{var e=A._numberConverter(),t=e(A.units[0].unit.value),n=e(A.units[0].unit.offset),i=g(t,n);A.value=c(u(B(A.value,i)),i)}for(var r in A.units)"VA"!==A.units[r].unit.name&&"VAR"!==A.units[r].unit.name||(A.units[r].unit=j.W);return A},D.prototype.to=function(A){var e,t=null===this.value?this._normalize(1):this.value;if("string"==typeof A)e=D.parse(A);else{if(!a(A))throw new Error("String or Unit expected as parameter");e=A.clone()}if(!this.equalBase(e))throw new Error("Units do not match ('".concat(e.toString(),"' != '").concat(this.toString(),"')"));if(null!==e.value)throw new Error("Cannot convert to a unit with a value");if(null===this.value||this._isDerived()||this.units[0].unit.offset===e.units[0].unit.offset)e.value=uA(t);else{var n=D._getNumberConverter(P(t)),i=this.units[0].unit.value,r=this.units[0].unit.offset,o=g(i,r),s=e.units[0].unit.value,E=e.units[0].unit.offset,Q=g(s,E);e.value=B(t,n(c(o,Q)))}return e.fixPrefix=!0,e.skipAutomaticSimplification=!0,e},D.prototype.toNumber=function(A){return F(this.toNumeric(A))},D.prototype.toNumeric=function(A){var e;return(e=A?this.to(A):this.clone())._isDerived()||0===e.units.length?e._denormalize(e.value):e._denormalize(e.value,e.units[0].prefix.value)},D.prototype.toString=function(){return this.format()},D.prototype.toJSON=function(){return{mathjs:"Unit",value:this._denormalize(this.value),unit:this.formatUnits(),fixPrefix:this.fixPrefix}},D.fromJSON=function(A){var e=new D(A.value,A.unit);return e.fixPrefix=A.fixPrefix||!1,e},D.prototype.valueOf=D.prototype.toString,D.prototype.simplify=function(){var A,e,t=this.clone(),n=[];for(var i in O)if(MA(O,i)&&t.hasBase(b[i])){A=i;break}if("NONE"===A)t.units=[];else if(A&&MA(O,A)&&(e=O[A]),e)t.units=[{unit:e.unit,prefix:e.prefix,power:1}];else{for(var r=!1,o=0;o<H.length;o++){var s=H[o];Math.abs(t.dimensions[o]||0)>1e-12&&(MA(O,s)?n.push({unit:O[s].unit,prefix:O[s].prefix,power:t.dimensions[o]||0}):r=!0)}n.length<t.units.length&&!r&&(t.units=n)}return t},D.prototype.toSI=function(){for(var A=this.clone(),e=[],t=0;t<H.length;t++){var n=H[t];if(Math.abs(A.dimensions[t]||0)>1e-12){if(!MA(L.si,n))throw new Error("Cannot express custom unit "+n+" in SI units");e.push({unit:L.si[n].unit,prefix:L.si[n].prefix,power:A.dimensions[t]||0})}}return A.units=e,A.fixPrefix=!0,A.skipAutomaticSimplification=!0,A},D.prototype.formatUnits=function(){for(var A="",e="",t=0,n=0,i=0;i<this.units.length;i++)this.units[i].power>0?(t++,A+=" "+this.units[i].prefix.name+this.units[i].unit.name,Math.abs(this.units[i].power-1)>1e-15&&(A+="^"+this.units[i].power)):this.units[i].power<0&&n++;if(n>0)for(var r=0;r<this.units.length;r++)this.units[r].power<0&&(t>0?(e+=" "+this.units[r].prefix.name+this.units[r].unit.name,Math.abs(this.units[r].power+1)>1e-15&&(e+="^"+-this.units[r].power)):(e+=" "+this.units[r].prefix.name+this.units[r].unit.name,e+="^"+this.units[r].power));A=A.substr(1),e=e.substr(1),t>1&&n>0&&(A="("+A+")"),n>1&&t>0&&(e="("+e+")");var o=A;return t>0&&n>0&&(o+=" / "),o+e},D.prototype.format=function(A){var e=this.skipAutomaticSimplification||null===this.value?this.clone():this.simplify(),t=!1;for(var n in void 0!==e.value&&null!==e.value&&o(e.value)&&(t=Math.abs(e.value.re)<1e-14),e.units)MA(e.units,n)&&e.units[n].unit&&("VA"===e.units[n].unit.name&&t?e.units[n].unit=j.VAR:"VAR"!==e.units[n].unit.name||t||(e.units[n].unit=j.VA));1!==e.units.length||e.fixPrefix||Math.abs(e.units[0].power-Math.round(e.units[0].power))<1e-14&&(e.units[0].prefix=e._bestPrefix());var i=e._denormalize(e.value),r=null!==e.value?I(i,A||{}):"",s=e.formatUnits();return e.value&&o(e.value)&&(r="("+r+")"),s.length>0&&r.length>0&&(r+=" "),r+s},D.prototype._bestPrefix=function(){if(1!==this.units.length)throw new Error("Can only compute the best prefix for single units with integer powers, like kg, s^2, N^-1, and so forth!");if(Math.abs(this.units[0].power-Math.round(this.units[0].power))>=1e-14)throw new Error("Can only compute the best prefix for single units with integer powers, like kg, s^2, N^-1, and so forth!");var A=null!==this.value?u(this.value):0,e=u(this.units[0].unit.value),t=this.units[0].prefix;if(0===A)return t;var n=this.units[0].power,i=Math.log(A/Math.pow(t.value*e,n))/Math.LN10-1.2;if(i>-2.200001&&i<1.800001)return t;i=Math.abs(i);var r=this.units[0].unit.prefixes;for(var o in r)if(MA(r,o)){var s=r[o];if(s.scientific){var a=Math.abs(Math.log(A/Math.pow(s.value*e,n))/Math.LN10-1.2);(a<i||a===i&&s.name.length<t.name.length)&&(t=s,i=a)}}return t},D.prototype.splitUnit=function(A){for(var e=this.clone(),t=[],n=0;n<A.length&&(e=e.to(A[n]),n!==A.length-1);n++){var i=e.toNumeric(),r=w(i),o=new D(h(r,i)?r:l(e.toNumeric()),A[n].toString());t.push(o),e=c(e,o)}for(var s=0,a=0;a<t.length;a++)s=B(s,t[a].value);return h(s,this.value)&&(e.value=0),t.push(e),t};var S={NONE:{"":{name:"",value:1,scientific:!0}},SHORT:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:10,scientific:!1},h:{name:"h",value:100,scientific:!1},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0},d:{name:"d",value:.1,scientific:!1},c:{name:"c",value:.01,scientific:!1},m:{name:"m",value:.001,scientific:!0},u:{name:"u",value:1e-6,scientific:!0},n:{name:"n",value:1e-9,scientific:!0},p:{name:"p",value:1e-12,scientific:!0},f:{name:"f",value:1e-15,scientific:!0},a:{name:"a",value:1e-18,scientific:!0},z:{name:"z",value:1e-21,scientific:!0},y:{name:"y",value:1e-24,scientific:!0}},LONG:{"":{name:"",value:1,scientific:!0},deca:{name:"deca",value:10,scientific:!1},hecto:{name:"hecto",value:100,scientific:!1},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0},deci:{name:"deci",value:.1,scientific:!1},centi:{name:"centi",value:.01,scientific:!1},milli:{name:"milli",value:.001,scientific:!0},micro:{name:"micro",value:1e-6,scientific:!0},nano:{name:"nano",value:1e-9,scientific:!0},pico:{name:"pico",value:1e-12,scientific:!0},femto:{name:"femto",value:1e-15,scientific:!0},atto:{name:"atto",value:1e-18,scientific:!0},zepto:{name:"zepto",value:1e-21,scientific:!0},yocto:{name:"yocto",value:1e-24,scientific:!0}},SQUARED:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:100,scientific:!1},h:{name:"h",value:1e4,scientific:!1},k:{name:"k",value:1e6,scientific:!0},M:{name:"M",value:1e12,scientific:!0},G:{name:"G",value:1e18,scientific:!0},T:{name:"T",value:1e24,scientific:!0},P:{name:"P",value:1e30,scientific:!0},E:{name:"E",value:1e36,scientific:!0},Z:{name:"Z",value:1e42,scientific:!0},Y:{name:"Y",value:1e48,scientific:!0},d:{name:"d",value:.01,scientific:!1},c:{name:"c",value:1e-4,scientific:!1},m:{name:"m",value:1e-6,scientific:!0},u:{name:"u",value:1e-12,scientific:!0},n:{name:"n",value:1e-18,scientific:!0},p:{name:"p",value:1e-24,scientific:!0},f:{name:"f",value:1e-30,scientific:!0},a:{name:"a",value:1e-36,scientific:!0},z:{name:"z",value:1e-42,scientific:!0},y:{name:"y",value:1e-48,scientific:!0}},CUBIC:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:1e3,scientific:!1},h:{name:"h",value:1e6,scientific:!1},k:{name:"k",value:1e9,scientific:!0},M:{name:"M",value:1e18,scientific:!0},G:{name:"G",value:1e27,scientific:!0},T:{name:"T",value:1e36,scientific:!0},P:{name:"P",value:1e45,scientific:!0},E:{name:"E",value:1e54,scientific:!0},Z:{name:"Z",value:1e63,scientific:!0},Y:{name:"Y",value:1e72,scientific:!0},d:{name:"d",value:.001,scientific:!1},c:{name:"c",value:1e-6,scientific:!1},m:{name:"m",value:1e-9,scientific:!0},u:{name:"u",value:1e-18,scientific:!0},n:{name:"n",value:1e-27,scientific:!0},p:{name:"p",value:1e-36,scientific:!0},f:{name:"f",value:1e-45,scientific:!0},a:{name:"a",value:1e-54,scientific:!0},z:{name:"z",value:1e-63,scientific:!0},y:{name:"y",value:1e-72,scientific:!0}},BINARY_SHORT_SI:{"":{name:"",value:1,scientific:!0},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0}},BINARY_SHORT_IEC:{"":{name:"",value:1,scientific:!0},Ki:{name:"Ki",value:1024,scientific:!0},Mi:{name:"Mi",value:Math.pow(1024,2),scientific:!0},Gi:{name:"Gi",value:Math.pow(1024,3),scientific:!0},Ti:{name:"Ti",value:Math.pow(1024,4),scientific:!0},Pi:{name:"Pi",value:Math.pow(1024,5),scientific:!0},Ei:{name:"Ei",value:Math.pow(1024,6),scientific:!0},Zi:{name:"Zi",value:Math.pow(1024,7),scientific:!0},Yi:{name:"Yi",value:Math.pow(1024,8),scientific:!0}},BINARY_LONG_SI:{"":{name:"",value:1,scientific:!0},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0}},BINARY_LONG_IEC:{"":{name:"",value:1,scientific:!0},kibi:{name:"kibi",value:1024,scientific:!0},mebi:{name:"mebi",value:Math.pow(1024,2),scientific:!0},gibi:{name:"gibi",value:Math.pow(1024,3),scientific:!0},tebi:{name:"tebi",value:Math.pow(1024,4),scientific:!0},pebi:{name:"pebi",value:Math.pow(1024,5),scientific:!0},exi:{name:"exi",value:Math.pow(1024,6),scientific:!0},zebi:{name:"zebi",value:Math.pow(1024,7),scientific:!0},yobi:{name:"yobi",value:Math.pow(1024,8),scientific:!0}},BTU:{"":{name:"",value:1,scientific:!0},MM:{name:"MM",value:1e6,scientific:!0}}};S.SHORTLONG=kt({},S.SHORT,S.LONG),S.BINARY_SHORT=kt({},S.BINARY_SHORT_SI,S.BINARY_SHORT_IEC),S.BINARY_LONG=kt({},S.BINARY_LONG_SI,S.BINARY_LONG_IEC);var H=["MASS","LENGTH","TIME","CURRENT","TEMPERATURE","LUMINOUS_INTENSITY","AMOUNT_OF_SUBSTANCE","ANGLE","BIT"],b={NONE:{dimensions:[0,0,0,0,0,0,0,0,0]},MASS:{dimensions:[1,0,0,0,0,0,0,0,0]},LENGTH:{dimensions:[0,1,0,0,0,0,0,0,0]},TIME:{dimensions:[0,0,1,0,0,0,0,0,0]},CURRENT:{dimensions:[0,0,0,1,0,0,0,0,0]},TEMPERATURE:{dimensions:[0,0,0,0,1,0,0,0,0]},LUMINOUS_INTENSITY:{dimensions:[0,0,0,0,0,1,0,0,0]},AMOUNT_OF_SUBSTANCE:{dimensions:[0,0,0,0,0,0,1,0,0]},FORCE:{dimensions:[1,1,-2,0,0,0,0,0,0]},SURFACE:{dimensions:[0,2,0,0,0,0,0,0,0]},VOLUME:{dimensions:[0,3,0,0,0,0,0,0,0]},ENERGY:{dimensions:[1,2,-2,0,0,0,0,0,0]},POWER:{dimensions:[1,2,-3,0,0,0,0,0,0]},PRESSURE:{dimensions:[1,-1,-2,0,0,0,0,0,0]},ELECTRIC_CHARGE:{dimensions:[0,0,1,1,0,0,0,0,0]},ELECTRIC_CAPACITANCE:{dimensions:[-1,-2,4,2,0,0,0,0,0]},ELECTRIC_POTENTIAL:{dimensions:[1,2,-3,-1,0,0,0,0,0]},ELECTRIC_RESISTANCE:{dimensions:[1,2,-3,-2,0,0,0,0,0]},ELECTRIC_INDUCTANCE:{dimensions:[1,2,-2,-2,0,0,0,0,0]},ELECTRIC_CONDUCTANCE:{dimensions:[-1,-2,3,2,0,0,0,0,0]},MAGNETIC_FLUX:{dimensions:[1,2,-2,-1,0,0,0,0,0]},MAGNETIC_FLUX_DENSITY:{dimensions:[1,0,-2,-1,0,0,0,0,0]},FREQUENCY:{dimensions:[0,0,-1,0,0,0,0,0,0]},ANGLE:{dimensions:[0,0,0,0,0,0,0,1,0]},BIT:{dimensions:[0,0,0,0,0,0,0,0,1]}};for(var v in b)MA(b,v)&&(b[v].key=v);var k={name:"",base:{},value:1,offset:0,dimensions:H.map((function(A){return 0}))},j={meter:{name:"meter",base:b.LENGTH,prefixes:S.LONG,value:1,offset:0},inch:{name:"inch",base:b.LENGTH,prefixes:S.NONE,value:.0254,offset:0},foot:{name:"foot",base:b.LENGTH,prefixes:S.NONE,value:.3048,offset:0},yard:{name:"yard",base:b.LENGTH,prefixes:S.NONE,value:.9144,offset:0},mile:{name:"mile",base:b.LENGTH,prefixes:S.NONE,value:1609.344,offset:0},link:{name:"link",base:b.LENGTH,prefixes:S.NONE,value:.201168,offset:0},rod:{name:"rod",base:b.LENGTH,prefixes:S.NONE,value:5.0292,offset:0},chain:{name:"chain",base:b.LENGTH,prefixes:S.NONE,value:20.1168,offset:0},angstrom:{name:"angstrom",base:b.LENGTH,prefixes:S.NONE,value:1e-10,offset:0},m:{name:"m",base:b.LENGTH,prefixes:S.SHORT,value:1,offset:0},in:{name:"in",base:b.LENGTH,prefixes:S.NONE,value:.0254,offset:0},ft:{name:"ft",base:b.LENGTH,prefixes:S.NONE,value:.3048,offset:0},yd:{name:"yd",base:b.LENGTH,prefixes:S.NONE,value:.9144,offset:0},mi:{name:"mi",base:b.LENGTH,prefixes:S.NONE,value:1609.344,offset:0},li:{name:"li",base:b.LENGTH,prefixes:S.NONE,value:.201168,offset:0},rd:{name:"rd",base:b.LENGTH,prefixes:S.NONE,value:5.02921,offset:0},ch:{name:"ch",base:b.LENGTH,prefixes:S.NONE,value:20.1168,offset:0},mil:{name:"mil",base:b.LENGTH,prefixes:S.NONE,value:254e-7,offset:0},m2:{name:"m2",base:b.SURFACE,prefixes:S.SQUARED,value:1,offset:0},sqin:{name:"sqin",base:b.SURFACE,prefixes:S.NONE,value:64516e-8,offset:0},sqft:{name:"sqft",base:b.SURFACE,prefixes:S.NONE,value:.09290304,offset:0},sqyd:{name:"sqyd",base:b.SURFACE,prefixes:S.NONE,value:.83612736,offset:0},sqmi:{name:"sqmi",base:b.SURFACE,prefixes:S.NONE,value:2589988.110336,offset:0},sqrd:{name:"sqrd",base:b.SURFACE,prefixes:S.NONE,value:25.29295,offset:0},sqch:{name:"sqch",base:b.SURFACE,prefixes:S.NONE,value:404.6873,offset:0},sqmil:{name:"sqmil",base:b.SURFACE,prefixes:S.NONE,value:6.4516e-10,offset:0},acre:{name:"acre",base:b.SURFACE,prefixes:S.NONE,value:4046.86,offset:0},hectare:{name:"hectare",base:b.SURFACE,prefixes:S.NONE,value:1e4,offset:0},m3:{name:"m3",base:b.VOLUME,prefixes:S.CUBIC,value:1,offset:0},L:{name:"L",base:b.VOLUME,prefixes:S.SHORT,value:.001,offset:0},l:{name:"l",base:b.VOLUME,prefixes:S.SHORT,value:.001,offset:0},litre:{name:"litre",base:b.VOLUME,prefixes:S.LONG,value:.001,offset:0},cuin:{name:"cuin",base:b.VOLUME,prefixes:S.NONE,value:16387064e-12,offset:0},cuft:{name:"cuft",base:b.VOLUME,prefixes:S.NONE,value:.028316846592,offset:0},cuyd:{name:"cuyd",base:b.VOLUME,prefixes:S.NONE,value:.764554857984,offset:0},teaspoon:{name:"teaspoon",base:b.VOLUME,prefixes:S.NONE,value:5e-6,offset:0},tablespoon:{name:"tablespoon",base:b.VOLUME,prefixes:S.NONE,value:15e-6,offset:0},drop:{name:"drop",base:b.VOLUME,prefixes:S.NONE,value:5e-8,offset:0},gtt:{name:"gtt",base:b.VOLUME,prefixes:S.NONE,value:5e-8,offset:0},minim:{name:"minim",base:b.VOLUME,prefixes:S.NONE,value:6.161152e-8,offset:0},fluiddram:{name:"fluiddram",base:b.VOLUME,prefixes:S.NONE,value:36966911e-13,offset:0},fluidounce:{name:"fluidounce",base:b.VOLUME,prefixes:S.NONE,value:2957353e-11,offset:0},gill:{name:"gill",base:b.VOLUME,prefixes:S.NONE,value:.0001182941,offset:0},cc:{name:"cc",base:b.VOLUME,prefixes:S.NONE,value:1e-6,offset:0},cup:{name:"cup",base:b.VOLUME,prefixes:S.NONE,value:.0002365882,offset:0},pint:{name:"pint",base:b.VOLUME,prefixes:S.NONE,value:.0004731765,offset:0},quart:{name:"quart",base:b.VOLUME,prefixes:S.NONE,value:.0009463529,offset:0},gallon:{name:"gallon",base:b.VOLUME,prefixes:S.NONE,value:.003785412,offset:0},beerbarrel:{name:"beerbarrel",base:b.VOLUME,prefixes:S.NONE,value:.1173478,offset:0},oilbarrel:{name:"oilbarrel",base:b.VOLUME,prefixes:S.NONE,value:.1589873,offset:0},hogshead:{name:"hogshead",base:b.VOLUME,prefixes:S.NONE,value:.238481,offset:0},fldr:{name:"fldr",base:b.VOLUME,prefixes:S.NONE,value:36966911e-13,offset:0},floz:{name:"floz",base:b.VOLUME,prefixes:S.NONE,value:2957353e-11,offset:0},gi:{name:"gi",base:b.VOLUME,prefixes:S.NONE,value:.0001182941,offset:0},cp:{name:"cp",base:b.VOLUME,prefixes:S.NONE,value:.0002365882,offset:0},pt:{name:"pt",base:b.VOLUME,prefixes:S.NONE,value:.0004731765,offset:0},qt:{name:"qt",base:b.VOLUME,prefixes:S.NONE,value:.0009463529,offset:0},gal:{name:"gal",base:b.VOLUME,prefixes:S.NONE,value:.003785412,offset:0},bbl:{name:"bbl",base:b.VOLUME,prefixes:S.NONE,value:.1173478,offset:0},obl:{name:"obl",base:b.VOLUME,prefixes:S.NONE,value:.1589873,offset:0},g:{name:"g",base:b.MASS,prefixes:S.SHORT,value:.001,offset:0},gram:{name:"gram",base:b.MASS,prefixes:S.LONG,value:.001,offset:0},ton:{name:"ton",base:b.MASS,prefixes:S.SHORT,value:907.18474,offset:0},t:{name:"t",base:b.MASS,prefixes:S.SHORT,value:1e3,offset:0},tonne:{name:"tonne",base:b.MASS,prefixes:S.LONG,value:1e3,offset:0},grain:{name:"grain",base:b.MASS,prefixes:S.NONE,value:6479891e-11,offset:0},dram:{name:"dram",base:b.MASS,prefixes:S.NONE,value:.0017718451953125,offset:0},ounce:{name:"ounce",base:b.MASS,prefixes:S.NONE,value:.028349523125,offset:0},poundmass:{name:"poundmass",base:b.MASS,prefixes:S.NONE,value:.45359237,offset:0},hundredweight:{name:"hundredweight",base:b.MASS,prefixes:S.NONE,value:45.359237,offset:0},stick:{name:"stick",base:b.MASS,prefixes:S.NONE,value:.115,offset:0},stone:{name:"stone",base:b.MASS,prefixes:S.NONE,value:6.35029318,offset:0},gr:{name:"gr",base:b.MASS,prefixes:S.NONE,value:6479891e-11,offset:0},dr:{name:"dr",base:b.MASS,prefixes:S.NONE,value:.0017718451953125,offset:0},oz:{name:"oz",base:b.MASS,prefixes:S.NONE,value:.028349523125,offset:0},lbm:{name:"lbm",base:b.MASS,prefixes:S.NONE,value:.45359237,offset:0},cwt:{name:"cwt",base:b.MASS,prefixes:S.NONE,value:45.359237,offset:0},s:{name:"s",base:b.TIME,prefixes:S.SHORT,value:1,offset:0},min:{name:"min",base:b.TIME,prefixes:S.NONE,value:60,offset:0},h:{name:"h",base:b.TIME,prefixes:S.NONE,value:3600,offset:0},second:{name:"second",base:b.TIME,prefixes:S.LONG,value:1,offset:0},sec:{name:"sec",base:b.TIME,prefixes:S.LONG,value:1,offset:0},minute:{name:"minute",base:b.TIME,prefixes:S.NONE,value:60,offset:0},hour:{name:"hour",base:b.TIME,prefixes:S.NONE,value:3600,offset:0},day:{name:"day",base:b.TIME,prefixes:S.NONE,value:86400,offset:0},week:{name:"week",base:b.TIME,prefixes:S.NONE,value:604800,offset:0},month:{name:"month",base:b.TIME,prefixes:S.NONE,value:2629800,offset:0},year:{name:"year",base:b.TIME,prefixes:S.NONE,value:31557600,offset:0},decade:{name:"decade",base:b.TIME,prefixes:S.NONE,value:315576e3,offset:0},century:{name:"century",base:b.TIME,prefixes:S.NONE,value:315576e4,offset:0},millennium:{name:"millennium",base:b.TIME,prefixes:S.NONE,value:315576e5,offset:0},hertz:{name:"Hertz",base:b.FREQUENCY,prefixes:S.LONG,value:1,offset:0,reciprocal:!0},Hz:{name:"Hz",base:b.FREQUENCY,prefixes:S.SHORT,value:1,offset:0,reciprocal:!0},rad:{name:"rad",base:b.ANGLE,prefixes:S.SHORT,value:1,offset:0},radian:{name:"radian",base:b.ANGLE,prefixes:S.LONG,value:1,offset:0},deg:{name:"deg",base:b.ANGLE,prefixes:S.SHORT,value:null,offset:0},degree:{name:"degree",base:b.ANGLE,prefixes:S.LONG,value:null,offset:0},grad:{name:"grad",base:b.ANGLE,prefixes:S.SHORT,value:null,offset:0},gradian:{name:"gradian",base:b.ANGLE,prefixes:S.LONG,value:null,offset:0},cycle:{name:"cycle",base:b.ANGLE,prefixes:S.NONE,value:null,offset:0},arcsec:{name:"arcsec",base:b.ANGLE,prefixes:S.NONE,value:null,offset:0},arcmin:{name:"arcmin",base:b.ANGLE,prefixes:S.NONE,value:null,offset:0},A:{name:"A",base:b.CURRENT,prefixes:S.SHORT,value:1,offset:0},ampere:{name:"ampere",base:b.CURRENT,prefixes:S.LONG,value:1,offset:0},K:{name:"K",base:b.TEMPERATURE,prefixes:S.SHORT,value:1,offset:0},degC:{name:"degC",base:b.TEMPERATURE,prefixes:S.SHORT,value:1,offset:273.15},degF:{name:"degF",base:b.TEMPERATURE,prefixes:S.SHORT,value:new p(5,9),offset:459.67},degR:{name:"degR",base:b.TEMPERATURE,prefixes:S.SHORT,value:new p(5,9),offset:0},kelvin:{name:"kelvin",base:b.TEMPERATURE,prefixes:S.LONG,value:1,offset:0},celsius:{name:"celsius",base:b.TEMPERATURE,prefixes:S.LONG,value:1,offset:273.15},fahrenheit:{name:"fahrenheit",base:b.TEMPERATURE,prefixes:S.LONG,value:new p(5,9),offset:459.67},rankine:{name:"rankine",base:b.TEMPERATURE,prefixes:S.LONG,value:new p(5,9),offset:0},mol:{name:"mol",base:b.AMOUNT_OF_SUBSTANCE,prefixes:S.SHORT,value:1,offset:0},mole:{name:"mole",base:b.AMOUNT_OF_SUBSTANCE,prefixes:S.LONG,value:1,offset:0},cd:{name:"cd",base:b.LUMINOUS_INTENSITY,prefixes:S.SHORT,value:1,offset:0},candela:{name:"candela",base:b.LUMINOUS_INTENSITY,prefixes:S.LONG,value:1,offset:0},N:{name:"N",base:b.FORCE,prefixes:S.SHORT,value:1,offset:0},newton:{name:"newton",base:b.FORCE,prefixes:S.LONG,value:1,offset:0},dyn:{name:"dyn",base:b.FORCE,prefixes:S.SHORT,value:1e-5,offset:0},dyne:{name:"dyne",base:b.FORCE,prefixes:S.LONG,value:1e-5,offset:0},lbf:{name:"lbf",base:b.FORCE,prefixes:S.NONE,value:4.4482216152605,offset:0},poundforce:{name:"poundforce",base:b.FORCE,prefixes:S.NONE,value:4.4482216152605,offset:0},kip:{name:"kip",base:b.FORCE,prefixes:S.LONG,value:4448.2216,offset:0},kilogramforce:{name:"kilogramforce",base:b.FORCE,prefixes:S.NONE,value:9.80665,offset:0},J:{name:"J",base:b.ENERGY,prefixes:S.SHORT,value:1,offset:0},joule:{name:"joule",base:b.ENERGY,prefixes:S.LONG,value:1,offset:0},erg:{name:"erg",base:b.ENERGY,prefixes:S.SHORTLONG,value:1e-7,offset:0},Wh:{name:"Wh",base:b.ENERGY,prefixes:S.SHORT,value:3600,offset:0},BTU:{name:"BTU",base:b.ENERGY,prefixes:S.BTU,value:1055.05585262,offset:0},eV:{name:"eV",base:b.ENERGY,prefixes:S.SHORT,value:1602176565e-28,offset:0},electronvolt:{name:"electronvolt",base:b.ENERGY,prefixes:S.LONG,value:1602176565e-28,offset:0},W:{name:"W",base:b.POWER,prefixes:S.SHORT,value:1,offset:0},watt:{name:"watt",base:b.POWER,prefixes:S.LONG,value:1,offset:0},hp:{name:"hp",base:b.POWER,prefixes:S.NONE,value:745.6998715386,offset:0},VAR:{name:"VAR",base:b.POWER,prefixes:S.SHORT,value:d.I,offset:0},VA:{name:"VA",base:b.POWER,prefixes:S.SHORT,value:1,offset:0},Pa:{name:"Pa",base:b.PRESSURE,prefixes:S.SHORT,value:1,offset:0},psi:{name:"psi",base:b.PRESSURE,prefixes:S.NONE,value:6894.75729276459,offset:0},atm:{name:"atm",base:b.PRESSURE,prefixes:S.NONE,value:101325,offset:0},bar:{name:"bar",base:b.PRESSURE,prefixes:S.SHORTLONG,value:1e5,offset:0},torr:{name:"torr",base:b.PRESSURE,prefixes:S.NONE,value:133.322,offset:0},mmHg:{name:"mmHg",base:b.PRESSURE,prefixes:S.NONE,value:133.322,offset:0},mmH2O:{name:"mmH2O",base:b.PRESSURE,prefixes:S.NONE,value:9.80665,offset:0},cmH2O:{name:"cmH2O",base:b.PRESSURE,prefixes:S.NONE,value:98.0665,offset:0},coulomb:{name:"coulomb",base:b.ELECTRIC_CHARGE,prefixes:S.LONG,value:1,offset:0},C:{name:"C",base:b.ELECTRIC_CHARGE,prefixes:S.SHORT,value:1,offset:0},farad:{name:"farad",base:b.ELECTRIC_CAPACITANCE,prefixes:S.LONG,value:1,offset:0},F:{name:"F",base:b.ELECTRIC_CAPACITANCE,prefixes:S.SHORT,value:1,offset:0},volt:{name:"volt",base:b.ELECTRIC_POTENTIAL,prefixes:S.LONG,value:1,offset:0},V:{name:"V",base:b.ELECTRIC_POTENTIAL,prefixes:S.SHORT,value:1,offset:0},ohm:{name:"ohm",base:b.ELECTRIC_RESISTANCE,prefixes:S.SHORTLONG,value:1,offset:0},henry:{name:"henry",base:b.ELECTRIC_INDUCTANCE,prefixes:S.LONG,value:1,offset:0},H:{name:"H",base:b.ELECTRIC_INDUCTANCE,prefixes:S.SHORT,value:1,offset:0},siemens:{name:"siemens",base:b.ELECTRIC_CONDUCTANCE,prefixes:S.LONG,value:1,offset:0},S:{name:"S",base:b.ELECTRIC_CONDUCTANCE,prefixes:S.SHORT,value:1,offset:0},weber:{name:"weber",base:b.MAGNETIC_FLUX,prefixes:S.LONG,value:1,offset:0},Wb:{name:"Wb",base:b.MAGNETIC_FLUX,prefixes:S.SHORT,value:1,offset:0},tesla:{name:"tesla",base:b.MAGNETIC_FLUX_DENSITY,prefixes:S.LONG,value:1,offset:0},T:{name:"T",base:b.MAGNETIC_FLUX_DENSITY,prefixes:S.SHORT,value:1,offset:0},b:{name:"b",base:b.BIT,prefixes:S.BINARY_SHORT,value:1,offset:0},bits:{name:"bits",base:b.BIT,prefixes:S.BINARY_LONG,value:1,offset:0},B:{name:"B",base:b.BIT,prefixes:S.BINARY_SHORT,value:8,offset:0},bytes:{name:"bytes",base:b.BIT,prefixes:S.BINARY_LONG,value:8,offset:0}},J={meters:"meter",inches:"inch",feet:"foot",yards:"yard",miles:"mile",links:"link",rods:"rod",chains:"chain",angstroms:"angstrom",lt:"l",litres:"litre",liter:"litre",liters:"litre",teaspoons:"teaspoon",tablespoons:"tablespoon",minims:"minim",fluiddrams:"fluiddram",fluidounces:"fluidounce",gills:"gill",cups:"cup",pints:"pint",quarts:"quart",gallons:"gallon",beerbarrels:"beerbarrel",oilbarrels:"oilbarrel",hogsheads:"hogshead",gtts:"gtt",grams:"gram",tons:"ton",tonnes:"tonne",grains:"grain",drams:"dram",ounces:"ounce",poundmasses:"poundmass",hundredweights:"hundredweight",sticks:"stick",lb:"lbm",lbs:"lbm",kips:"kip",kgf:"kilogramforce",acres:"acre",hectares:"hectare",sqfeet:"sqft",sqyard:"sqyd",sqmile:"sqmi",sqmiles:"sqmi",mmhg:"mmHg",mmh2o:"mmH2O",cmh2o:"cmH2O",seconds:"second",secs:"second",minutes:"minute",mins:"minute",hours:"hour",hr:"hour",hrs:"hour",days:"day",weeks:"week",months:"month",years:"year",decades:"decade",centuries:"century",millennia:"millennium",hertz:"hertz",radians:"radian",degrees:"degree",gradians:"gradian",cycles:"cycle",arcsecond:"arcsec",arcseconds:"arcsec",arcminute:"arcmin",arcminutes:"arcmin",BTUs:"BTU",watts:"watt",joules:"joule",amperes:"ampere",amps:"ampere",amp:"ampere",coulombs:"coulomb",volts:"volt",ohms:"ohm",farads:"farad",webers:"weber",teslas:"tesla",electronvolts:"electronvolt",moles:"mole",bit:"bits",byte:"bytes"};function z(A){if("BigNumber"===A.number){var e=QB(m);j.rad.value=new m(1),j.deg.value=e.div(180),j.grad.value=e.div(200),j.cycle.value=e.times(2),j.arcsec.value=e.div(648e3),j.arcmin.value=e.div(10800)}else j.rad.value=1,j.deg.value=Math.PI/180,j.grad.value=Math.PI/200,j.cycle.value=2*Math.PI,j.arcsec.value=Math.PI/648e3,j.arcmin.value=Math.PI/10800;j.radian.value=j.rad.value,j.degree.value=j.deg.value,j.gradian.value=j.grad.value}z(s),r&&r("config",(function(A,e){A.number!==e.number&&z(A)}));var L={si:{NONE:{unit:k,prefix:S.NONE[""]},LENGTH:{unit:j.m,prefix:S.SHORT[""]},MASS:{unit:j.g,prefix:S.SHORT.k},TIME:{unit:j.s,prefix:S.SHORT[""]},CURRENT:{unit:j.A,prefix:S.SHORT[""]},TEMPERATURE:{unit:j.K,prefix:S.SHORT[""]},LUMINOUS_INTENSITY:{unit:j.cd,prefix:S.SHORT[""]},AMOUNT_OF_SUBSTANCE:{unit:j.mol,prefix:S.SHORT[""]},ANGLE:{unit:j.rad,prefix:S.SHORT[""]},BIT:{unit:j.bits,prefix:S.SHORT[""]},FORCE:{unit:j.N,prefix:S.SHORT[""]},ENERGY:{unit:j.J,prefix:S.SHORT[""]},POWER:{unit:j.W,prefix:S.SHORT[""]},PRESSURE:{unit:j.Pa,prefix:S.SHORT[""]},ELECTRIC_CHARGE:{unit:j.C,prefix:S.SHORT[""]},ELECTRIC_CAPACITANCE:{unit:j.F,prefix:S.SHORT[""]},ELECTRIC_POTENTIAL:{unit:j.V,prefix:S.SHORT[""]},ELECTRIC_RESISTANCE:{unit:j.ohm,prefix:S.SHORT[""]},ELECTRIC_INDUCTANCE:{unit:j.H,prefix:S.SHORT[""]},ELECTRIC_CONDUCTANCE:{unit:j.S,prefix:S.SHORT[""]},MAGNETIC_FLUX:{unit:j.Wb,prefix:S.SHORT[""]},MAGNETIC_FLUX_DENSITY:{unit:j.T,prefix:S.SHORT[""]},FREQUENCY:{unit:j.Hz,prefix:S.SHORT[""]}}};L.cgs=JSON.parse(JSON.stringify(L.si)),L.cgs.LENGTH={unit:j.m,prefix:S.SHORT.c},L.cgs.MASS={unit:j.g,prefix:S.SHORT[""]},L.cgs.FORCE={unit:j.dyn,prefix:S.SHORT[""]},L.cgs.ENERGY={unit:j.erg,prefix:S.NONE[""]},L.us=JSON.parse(JSON.stringify(L.si)),L.us.LENGTH={unit:j.ft,prefix:S.NONE[""]},L.us.MASS={unit:j.lbm,prefix:S.NONE[""]},L.us.TEMPERATURE={unit:j.degF,prefix:S.NONE[""]},L.us.FORCE={unit:j.lbf,prefix:S.NONE[""]},L.us.ENERGY={unit:j.BTU,prefix:S.BTU[""]},L.us.POWER={unit:j.hp,prefix:S.NONE[""]},L.us.PRESSURE={unit:j.psi,prefix:S.NONE[""]},L.auto=JSON.parse(JSON.stringify(L.si));var O=L.auto;for(var V in D.setUnitSystem=function(A){if(!MA(L,A))throw new Error("Unit system "+A+" does not exist. Choices are: "+Object.keys(L).join(", "));O=L[A]},D.getUnitSystem=function(){for(var A in L)if(MA(L,A)&&L[A]===O)return A},D.typeConverters={BigNumber:function(A){return null!=A&&A.isFraction?new m(A.n).div(A.d).times(A.s):new m(A+"")},Fraction:function(A){return new p(A)},Complex:function(A){return A},number:function(A){return null!=A&&A.isFraction?M(A):A}},D.prototype._numberConverter=function(){var A=D.typeConverters[this.valueType()];if(A)return A;throw new TypeError('Unsupported Unit value type "'+this.valueType()+'"')},D._getNumberConverter=function(A){if(!D.typeConverters[A])throw new TypeError('Unsupported type "'+A+'"');return D.typeConverters[A]},j)if(MA(j,V)){var W=j[V];W.dimensions=W.base.dimensions}for(var K in J)if(MA(J,K)){var X=j[J[K]],Z={};for(var _ in X)MA(X,_)&&(Z[_]=X[_]);Z.name=K,j[K]=Z}return D.isValidAlpha=function(A){return/^[a-zA-Z]$/.test(A)},D.createUnit=function(A,t){if("object"!==e(A))throw new TypeError("createUnit expects first parameter to be of type 'Object'");if(t&&t.override)for(var n in A)if(MA(A,n)&&D.deleteUnit(n),A[n].aliases)for(var i=0;i<A[n].aliases.length;i++)D.deleteUnit(A[n].aliases[i]);var r;for(var o in A)MA(A,o)&&(r=D.createUnitSingle(o,A[o]));return r},D.createUnitSingle=function(A,t){if(null==t&&(t={}),"string"!=typeof A)throw new TypeError("createUnitSingle expects first parameter to be of type 'string'");if(MA(j,A))throw new Error('Cannot create unit "'+A+'": a unit with that name already exists');!function(A){for(var e=0;e<A.length;e++){if(i=A.charAt(e),0===e&&!D.isValidAlpha(i))throw new Error('Invalid unit name (must begin with alpha character): "'+A+'"');if(e>0&&!D.isValidAlpha(i)&&!f(i))throw new Error('Invalid unit name (only alphanumeric characters are allowed): "'+A+'"')}}(A);var n,r,o,s=null,a=[],B=0;if(t&&"Unit"===t.type)s=t.clone();else if("string"==typeof t)""!==t&&(n=t);else{if("object"!==e(t))throw new TypeError('Cannot create unit "'+A+'" from "'+t.toString()+'": expecting "string" or "Unit" or "Object"');n=t.definition,r=t.prefixes,B=t.offset,o=t.baseName,t.aliases&&(a=t.aliases.valueOf())}if(a)for(var c=0;c<a.length;c++)if(MA(j,a[c]))throw new Error('Cannot create alias "'+a[c]+'": a unit with that name already exists');if(n&&"string"==typeof n&&!s)try{s=D.parse(n,{allowNoUnits:!0})}catch(e){throw e.message='Could not create unit "'+A+'" from "'+n+'": '+e.message,e}else n&&"Unit"===n.type&&(s=n.clone());a=a||[],B=B||0,r=r&&r.toUpperCase&&S[r.toUpperCase()]||S.NONE;var g={};if(s){g={name:A,value:s.value,dimensions:s.dimensions.slice(0),prefixes:r,offset:B};var E=!1;for(var Q in b)if(MA(b,Q)){for(var u=!0,l=0;l<H.length;l++)if(Math.abs((g.dimensions[l]||0)-(b[Q].dimensions[l]||0))>1e-12){u=!1;break}if(u){E=!0,g.base=b[Q];break}}if(!E){o=o||A+"_STUFF";var w={dimensions:s.dimensions.slice(0)};w.key=o,b[o]=w,O[o]={unit:g,prefix:S.NONE[""]},g.base=b[o]}}else{if(o=o||A+"_STUFF",H.indexOf(o)>=0)throw new Error('Cannot create new base unit "'+A+'": a base unit with that name already exists (and cannot be overridden)');for(var h in H.push(o),b)MA(b,h)&&(b[h].dimensions[H.length-1]=0);for(var C={dimensions:[]},I=0;I<H.length;I++)C.dimensions[I]=0;C.dimensions[H.length-1]=1,C.key=o,b[o]=C,g={name:A,value:1,dimensions:b[o].dimensions.slice(0),prefixes:r,offset:B,base:b[o]},O[o]={unit:g,prefix:S.NONE[""]}}D.UNITS[A]=g;for(var M=0;M<a.length;M++){var d=a[M],m={};for(var p in g)MA(g,p)&&(m[p]=g[p]);m.name=d,D.UNITS[d]=m}return delete R.cache,new D(null,A)},D.deleteUnit=function(A){delete D.UNITS[A]},D.PREFIXES=S,D.BASE_DIMENSIONS=H,D.BASE_UNITS=b,D.UNIT_SYSTEMS=L,D.UNITS=j,D}),{isClass:!0}),IB=mA("unit",["typed","Unit"],(function(A){var e=A.typed,t=A.Unit;return e("unit",{Unit:function(A){return A.clone()},string:function(A){return t.isValuelessUnit(A)?new t(null,A):t.parse(A,{allowNoUnits:!0})},"number | BigNumber | Fraction | Complex, string | Unit":function(A,e){return new t(A,e)},"number | BigNumber | Fraction":function(A){return new t(A)},"Array | Matrix":e.referToSelf((function(A){return function(e){return Gn(e,A)}}))})})),MB=mA("sparse",["typed","SparseMatrix"],(function(A){var e=A.typed,t=A.SparseMatrix;return e("sparse",{"":function(){return new t([])},string:function(A){return new t([],A)},"Array | Matrix":function(A){return new t(A)},"Array | Matrix, string":function(A,e){return new t(A,e)}})})),dB="createUnit",mB=mA(dB,["typed","Unit"],(function(A){var e=A.typed,t=A.Unit;return e(dB,{"Object, Object":function(A,e){return t.createUnit(A,e)},Object:function(A){return t.createUnit(A,{})},"string, Unit | string | Object, Object":function(A,e,n){var i={};return i[A]=e,t.createUnit(i,n)},"string, Unit | string | Object":function(A,e){var n={};return n[A]=e,t.createUnit(n,{})},string:function(A){var e={};return e[A]={},t.createUnit(e,{})}})})),pB=mA("acos",["typed","config","Complex"],(function(A){var e=A.typed,t=A.config,n=A.Complex;return e("acos",{number:function(A){return A>=-1&&A<=1||t.predictable?Math.acos(A):new n(A,0).acos()},Complex:function(A){return A.acos()},BigNumber:function(A){return A.acos()}})})),FB="number";function DB(A){return aA(A)}function YB(A){return Math.atan(1/A)}function fB(A){return isFinite(A)?(Math.log((A+1)/A)+Math.log(A/(A-1)))/2:0}function NB(A){return Math.asin(1/A)}function UB(A){var e=1/A;return Math.log(e+Math.sqrt(e*e+1))}function yB(A){return Math.acos(1/A)}function TB(A){var e=1/A,t=Math.sqrt(e*e-1);return Math.log(t+e)}function xB(A){return BA(A)}function RB(A){return cA(A)}function GB(A){return 1/Math.tan(A)}function SB(A){var e=Math.exp(2*A);return(e+1)/(e-1)}function HB(A){return 1/Math.sin(A)}function bB(A){return 0===A?Number.POSITIVE_INFINITY:Math.abs(2/(Math.exp(A)-Math.exp(-A)))*W(A)}function vB(A){return 1/Math.cos(A)}function kB(A){return 2/(Math.exp(A)+Math.exp(-A))}function jB(A){return EA(A)}DB.signature=FB,YB.signature=FB,fB.signature=FB,NB.signature=FB,UB.signature=FB,yB.signature=FB,TB.signature=FB,xB.signature=FB,RB.signature=FB,GB.signature=FB,SB.signature=FB,HB.signature=FB,bB.signature=FB,vB.signature=FB,kB.signature=FB,jB.signature=FB;var JB=mA("acosh",["typed","config","Complex"],(function(A){var e=A.typed,t=A.config,n=A.Complex;return e("acosh",{number:function(A){return A>=1||t.predictable?DB(A):A<=-1?new n(Math.log(Math.sqrt(A*A-1)-A),Math.PI):new n(A,0).acosh()},Complex:function(A){return A.acosh()},BigNumber:function(A){return A.acosh()}})})),zB=mA("acot",["typed","BigNumber"],(function(A){var e=A.typed,t=A.BigNumber;return e("acot",{number:YB,Complex:function(A){return A.acot()},BigNumber:function(A){return new t(1).div(A).atan()}})})),LB=mA("acoth",["typed","config","Complex","BigNumber"],(function(A){var e=A.typed,t=A.config,n=A.Complex,i=A.BigNumber;return e("acoth",{number:function(A){return A>=1||A<=-1||t.predictable?fB(A):new n(A,0).acoth()},Complex:function(A){return A.acoth()},BigNumber:function(A){return new i(1).div(A).atanh()}})})),PB=mA("acsc",["typed","config","Complex","BigNumber"],(function(A){var e=A.typed,t=A.config,n=A.Complex,i=A.BigNumber;return e("acsc",{number:function(A){return A<=-1||A>=1||t.predictable?NB(A):new n(A,0).acsc()},Complex:function(A){return A.acsc()},BigNumber:function(A){return new i(1).div(A).asin()}})})),OB=mA("acsch",["typed","BigNumber"],(function(A){var e=A.typed,t=A.BigNumber;return e("acsch",{number:UB,Complex:function(A){return A.acsch()},BigNumber:function(A){return new t(1).div(A).asinh()}})})),VB=mA("asec",["typed","config","Complex","BigNumber"],(function(A){var e=A.typed,t=A.config,n=A.Complex,i=A.BigNumber;return e("asec",{number:function(A){return A<=-1||A>=1||t.predictable?yB(A):new n(A,0).asec()},Complex:function(A){return A.asec()},BigNumber:function(A){return new i(1).div(A).acos()}})})),WB=mA("asech",["typed","config","Complex","BigNumber"],(function(A){var e=A.typed,t=A.config,n=A.Complex,i=A.BigNumber;return e("asech",{number:function(A){if(A<=1&&A>=-1||t.predictable){var e=1/A;if(e>0||t.predictable)return TB(A);var i=Math.sqrt(e*e-1);return new n(Math.log(i-e),Math.PI)}return new n(A,0).asech()},Complex:function(A){return A.asech()},BigNumber:function(A){return new i(1).div(A).acosh()}})})),KB=mA("asin",["typed","config","Complex"],(function(A){var e=A.typed,t=A.config,n=A.Complex;return e("asin",{number:function(A){return A>=-1&&A<=1||t.predictable?Math.asin(A):new n(A,0).asin()},Complex:function(A){return A.asin()},BigNumber:function(A){return A.asin()}})})),XB=mA("asinh",["typed"],(function(A){return(0,A.typed)("asinh",{number:xB,Complex:function(A){return A.asinh()},BigNumber:function(A){return A.asinh()}})})),ZB=mA("atan",["typed"],(function(A){return(0,A.typed)("atan",{number:function(A){return Math.atan(A)},Complex:function(A){return A.atan()},BigNumber:function(A){return A.atan()}})})),_B=mA("atan2",["typed","matrix","equalScalar","BigNumber","DenseMatrix","concat"],(function(A){var e=A.typed,t=A.matrix,n=A.equalScalar,i=A.BigNumber,r=A.DenseMatrix,o=A.concat,s=Mr({typed:e,equalScalar:n}),a=dr({typed:e}),B=_r({typed:e,equalScalar:n}),c=rr({typed:e,equalScalar:n}),g=or({typed:e,DenseMatrix:r}),E=Dr({typed:e,matrix:t,concat:o});return e("atan2",{"number, number":Math.atan2,"BigNumber, BigNumber":function(A,e){return i.atan2(A,e)}},E({scalar:"number | BigNumber",SS:B,DS:a,SD:s,Ss:c,sS:g}))})),qB=mA("atanh",["typed","config","Complex"],(function(A){var e=A.typed,t=A.config,n=A.Complex;return e("atanh",{number:function(A){return A<=1&&A>=-1||t.predictable?RB(A):new n(A,0).atanh()},Complex:function(A){return A.atanh()},BigNumber:function(A){return A.atanh()}})})),$B=mA("trigUnit",["typed"],(function(A){var e=A.typed;return{Unit:e.referToSelf((function(A){return function(t){if(!t.hasBase(t.constructor.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cot is no angle");return e.find(A,t.valueType())(t.value)}}))}})),Ac=mA("cos",["typed"],(function(A){var e=A.typed,t=$B({typed:e});return e("cos",{number:Math.cos,"Complex | BigNumber":function(A){return A.cos()}},t)})),ec=mA("cosh",["typed"],(function(A){return(0,A.typed)("cosh",{number:gA,"Complex | BigNumber":function(A){return A.cosh()}})})),tc=mA("cot",["typed","BigNumber"],(function(A){var e=A.typed,t=A.BigNumber;return e("cot",{number:GB,Complex:function(A){return A.cot()},BigNumber:function(A){return new t(1).div(A.tan())}},$B({typed:e}))})),nc=mA("coth",["typed","BigNumber"],(function(A){var e=A.typed,t=A.BigNumber;return e("coth",{number:SB,Complex:function(A){return A.coth()},BigNumber:function(A){return new t(1).div(A.tanh())}})})),ic=mA("csc",["typed","BigNumber"],(function(A){var e=A.typed,t=A.BigNumber;return e("csc",{number:HB,Complex:function(A){return A.csc()},BigNumber:function(A){return new t(1).div(A.sin())}},$B({typed:e}))})),rc=mA("csch",["typed","BigNumber"],(function(A){var e=A.typed,t=A.BigNumber;return e("csch",{number:bB,Complex:function(A){return A.csch()},BigNumber:function(A){return new t(1).div(A.sinh())}})})),oc=mA("sec",["typed","BigNumber"],(function(A){var e=A.typed,t=A.BigNumber;return e("sec",{number:vB,Complex:function(A){return A.sec()},BigNumber:function(A){return new t(1).div(A.cos())}},$B({typed:e}))})),sc=mA("sech",["typed","BigNumber"],(function(A){var e=A.typed,t=A.BigNumber;return e("sech",{number:kB,Complex:function(A){return A.sech()},BigNumber:function(A){return new t(1).div(A.cosh())}})})),ac=mA("sin",["typed"],(function(A){var e=A.typed,t=$B({typed:e});return e("sin",{number:Math.sin,"Complex | BigNumber":function(A){return A.sin()}},t)})),Bc=mA("sinh",["typed"],(function(A){return(0,A.typed)("sinh",{number:jB,"Complex | BigNumber":function(A){return A.sinh()}})})),cc=mA("tan",["typed"],(function(A){var e=A.typed,t=$B({typed:e});return e("tan",{number:Math.tan,"Complex | BigNumber":function(A){return A.tan()}},t)})),gc=mA("tanh",["typed"],(function(A){return(0,A.typed)("tanh",{number:QA,"Complex | BigNumber":function(A){return A.tanh()}})})),Ec="setCartesian",Qc=mA(Ec,["typed","size","subset","compareNatural","Index","DenseMatrix"],(function(A){var e=A.typed,t=A.size,n=A.subset,i=A.compareNatural,r=A.Index,o=A.DenseMatrix;return e(Ec,{"Array | Matrix, Array | Matrix":function(A,e){var s=[];if(0!==n(t(A),new r(0))&&0!==n(t(e),new r(0))){var a=gn(Array.isArray(A)?A:A.toArray()).sort(i),B=gn(Array.isArray(e)?e:e.toArray()).sort(i);s=[];for(var c=0;c<a.length;c++)for(var g=0;g<B.length;g++)s.push([a[c],B[g]])}return Array.isArray(A)&&Array.isArray(e)?s:new o(s)}})})),uc="setDifference",lc=mA(uc,["typed","size","subset","compareNatural","Index","DenseMatrix"],(function(A){var e=A.typed,t=A.size,n=A.subset,i=A.compareNatural,r=A.Index,o=A.DenseMatrix;return e(uc,{"Array | Matrix, Array | Matrix":function(A,e){var s;if(0===n(t(A),new r(0)))s=[];else{if(0===n(t(e),new r(0)))return gn(A.toArray());var a,B=hn(gn(Array.isArray(A)?A:A.toArray()).sort(i)),c=hn(gn(Array.isArray(e)?e:e.toArray()).sort(i));s=[];for(var g=0;g<B.length;g++){a=!1;for(var E=0;E<c.length;E++)if(0===i(B[g].value,c[E].value)&&B[g].identifier===c[E].identifier){a=!0;break}a||s.push(B[g])}}return Array.isArray(A)&&Array.isArray(e)?Cn(s):new o(Cn(s))}})})),wc="setDistinct",hc=mA(wc,["typed","size","subset","compareNatural","Index","DenseMatrix"],(function(A){var e=A.typed,t=A.size,n=A.subset,i=A.compareNatural,r=A.Index,o=A.DenseMatrix;return e(wc,{"Array | Matrix":function(A){var e;if(0===n(t(A),new r(0)))e=[];else{var s=gn(Array.isArray(A)?A:A.toArray()).sort(i);(e=[]).push(s[0]);for(var a=1;a<s.length;a++)0!==i(s[a],s[a-1])&&e.push(s[a])}return Array.isArray(A)?e:new o(e)}})})),Cc="setIntersect",Ic=mA(Cc,["typed","size","subset","compareNatural","Index","DenseMatrix"],(function(A){var e=A.typed,t=A.size,n=A.subset,i=A.compareNatural,r=A.Index,o=A.DenseMatrix;return e(Cc,{"Array | Matrix, Array | Matrix":function(A,e){var s;if(0===n(t(A),new r(0))||0===n(t(e),new r(0)))s=[];else{var a=hn(gn(Array.isArray(A)?A:A.toArray()).sort(i)),B=hn(gn(Array.isArray(e)?e:e.toArray()).sort(i));s=[];for(var c=0;c<a.length;c++)for(var g=0;g<B.length;g++)if(0===i(a[c].value,B[g].value)&&a[c].identifier===B[g].identifier){s.push(a[c]);break}}return Array.isArray(A)&&Array.isArray(e)?Cn(s):new o(Cn(s))}})})),Mc="setIsSubset",dc=mA(Mc,["typed","size","subset","compareNatural","Index"],(function(A){var e=A.typed,t=A.size,n=A.subset,i=A.compareNatural,r=A.Index;return e(Mc,{"Array | Matrix, Array | Matrix":function(A,e){if(0===n(t(A),new r(0)))return!0;if(0===n(t(e),new r(0)))return!1;for(var o,s=hn(gn(Array.isArray(A)?A:A.toArray()).sort(i)),a=hn(gn(Array.isArray(e)?e:e.toArray()).sort(i)),B=0;B<s.length;B++){o=!1;for(var c=0;c<a.length;c++)if(0===i(s[B].value,a[c].value)&&s[B].identifier===a[c].identifier){o=!0;break}if(!1===o)return!1}return!0}})})),mc="setMultiplicity",pc=mA(mc,["typed","size","subset","compareNatural","Index"],(function(A){var e=A.typed,t=A.size,n=A.subset,i=A.compareNatural,r=A.Index;return e(mc,{"number | BigNumber | Fraction | Complex, Array | Matrix":function(A,e){if(0===n(t(e),new r(0)))return 0;for(var o=gn(Array.isArray(e)?e:e.toArray()),s=0,a=0;a<o.length;a++)0===i(o[a],A)&&s++;return s}})})),Fc="setPowerset",Dc=mA(Fc,["typed","size","subset","compareNatural","Index"],(function(A){var e=A.typed,t=A.size,n=A.subset,i=A.compareNatural,r=A.Index;return e(Fc,{"Array | Matrix":function(A){if(0===n(t(A),new r(0)))return[];for(var e=gn(Array.isArray(A)?A:A.toArray()).sort(i),s=[],a=0;a.toString(2).length<=e.length;)s.push(o(e,a.toString(2).split("").reverse())),a++;return function(A){for(var e=[],t=A.length-1;t>0;t--)for(var n=0;n<t;n++)A[n].length>A[n+1].length&&(e=A[n],A[n]=A[n+1],A[n+1]=e);return A}(s)}});function o(A,e){for(var t=[],n=0;n<e.length;n++)"1"===e[n]&&t.push(A[n]);return t}})),Yc="setSize",fc=mA(Yc,["typed","compareNatural"],(function(A){var e=A.typed,t=A.compareNatural;return e(Yc,{"Array | Matrix":function(A){return Array.isArray(A)?gn(A).length:gn(A.toArray()).length},"Array | Matrix, boolean":function(A,e){if(!1===e||0===A.length)return Array.isArray(A)?gn(A).length:gn(A.toArray()).length;for(var n=gn(Array.isArray(A)?A:A.toArray()).sort(t),i=1,r=1;r<n.length;r++)0!==t(n[r],n[r-1])&&i++;return i}})})),Nc="setSymDifference",Uc=mA(Nc,["typed","size","concat","subset","setDifference","Index"],(function(A){var e=A.typed,t=A.size,n=A.concat,i=A.subset,r=A.setDifference,o=A.Index;return e(Nc,{"Array | Matrix, Array | Matrix":function(A,e){if(0===i(t(A),new o(0)))return gn(e);if(0===i(t(e),new o(0)))return gn(A);var s=gn(A),a=gn(e);return n(r(s,a),r(a,s))}})})),yc="setUnion",Tc=mA(yc,["typed","size","concat","subset","setIntersect","setSymDifference","Index"],(function(A){var e=A.typed,t=A.size,n=A.concat,i=A.subset,r=A.setIntersect,o=A.setSymDifference,s=A.Index;return e(yc,{"Array | Matrix, Array | Matrix":function(A,e){if(0===i(t(A),new s(0)))return gn(e);if(0===i(t(e),new s(0)))return gn(A);var a=gn(A),B=gn(e);return n(o(a,B),r(a,B))}})})),xc=mA("add",["typed","matrix","addScalar","equalScalar","DenseMatrix","SparseMatrix","concat"],(function(A){var e=A.typed,t=A.matrix,n=A.addScalar,i=A.equalScalar,r=A.DenseMatrix,o=(A.SparseMatrix,A.concat),s=fr({typed:e}),a=Nr({typed:e,equalScalar:i}),B=Ur({typed:e,DenseMatrix:r}),c=Dr({typed:e,matrix:t,concat:o});return e("add",{"any, any":n,"any, any, ...any":e.referToSelf((function(A){return function(e,t,n){for(var i=A(e,t),r=0;r<n.length;r++)i=A(i,n[r]);return i}}))},c({elop:n,DS:s,SS:a,Ss:B}))})),Rc=mA("hypot",["typed","abs","addScalar","divideScalar","multiplyScalar","sqrt","smaller","isPositive"],(function(A){var e=A.typed,t=A.abs,n=A.addScalar,i=A.divideScalar,r=A.multiplyScalar,s=A.sqrt,a=A.smaller,B=A.isPositive;return e("hypot",{"... number | BigNumber":c,Array:c,Matrix:function(A){return c(gn(A.toArray()))}});function c(A){for(var e=0,c=0,g=0;g<A.length;g++){if(o(A[g]))throw new TypeError("Unexpected type of argument to hypot");var E=t(A[g]);a(c,E)?(e=r(e,r(i(c,E),i(c,E))),e=n(e,1),c=E):e=n(e,B(E)?r(i(E,c),i(E,c)):E)}return r(c,s(e))}})),Gc=mA("norm",["typed","abs","add","pow","conj","sqrt","multiply","equalScalar","larger","smaller","matrix","ctranspose","eigs"],(function(A){var e=A.typed,t=A.abs,n=A.add,i=A.pow,r=A.conj,o=A.sqrt,s=A.multiply,a=A.equalScalar,B=A.larger,c=A.smaller,g=A.matrix,E=A.ctranspose,Q=A.eigs;return e("norm",{number:Math.abs,Complex:function(A){return A.abs()},BigNumber:function(A){return A.abs()},boolean:function(A){return Math.abs(A)},Array:function(A){return u(g(A),2)},Matrix:function(A){return u(A,2)},"Array, number | BigNumber | string":function(A,e){return u(g(A),e)},"Matrix, number | BigNumber | string":function(A,e){return u(A,e)}});function u(A,e){var g=A.size();if(1===g.length)return function(A,e){if(e===Number.POSITIVE_INFINITY||"inf"===e)return function(A){var e=0;return A.forEach((function(A){var n=t(A);B(n,e)&&(e=n)}),!0),e}(A);if(e===Number.NEGATIVE_INFINITY||"-inf"===e)return function(A){var e;return A.forEach((function(A){var n=t(A);e&&!c(n,e)||(e=n)}),!0),e||0}(A);if("fro"===e)return u(A,2);if("number"==typeof e&&!isNaN(e)){if(!a(e,0)){var r=0;return A.forEach((function(A){r=n(i(t(A),e),r)}),!0),i(r,1/e)}return Number.POSITIVE_INFINITY}throw new Error("Unsupported parameter value")}(A,e);if(2===g.length){if(g[0]&&g[1])return function(A,e){if(1===e)return function(A){var e=[],i=0;return A.forEach((function(A,r){var o=r[1],s=n(e[o]||0,t(A));B(s,i)&&(i=s),e[o]=s}),!0),i}(A);if(e===Number.POSITIVE_INFINITY||"inf"===e)return function(A){var e=[],i=0;return A.forEach((function(A,r){var o=r[0],s=n(e[o]||0,t(A));B(s,i)&&(i=s),e[o]=s}),!0),i}(A);if("fro"===e)return function(A){var e=0;return A.forEach((function(A,t){e=n(e,s(A,r(A)))})),t(o(e))}(A);if(2===e)return function(A){var e=A.size();if(e[0]!==e[1])throw new RangeError("Invalid matrix dimensions");var n=E(A),i=s(n,A),r=Q(i).values.toArray(),a=r[r.length-1];return t(o(a))}(A);throw new Error("Unsupported parameter value "+e)}(A,e);throw new RangeError("Invalid matrix dimensions")}}})),Sc=mA("dot",["typed","addScalar","multiplyScalar","conj","size"],(function(A){var e=A.typed,t=A.addScalar,n=A.multiplyScalar,i=A.conj,r=A.size;return e("dot",{"Array | DenseMatrix, Array | DenseMatrix":function(A,r){var a=o(A,r),B=g(A)?A._data:A,c=g(A)?A._datatype:void 0,E=g(r)?r._data:r,Q=g(r)?r._datatype:void 0,u=2===s(A).length,l=2===s(r).length,w=t,h=n;if(c&&Q&&c===Q&&"string"==typeof c){var C=c;w=e.find(t,[C,C]),h=e.find(n,[C,C])}if(!u&&!l){for(var I=h(i(B[0]),E[0]),M=1;M<a;M++)I=w(I,h(i(B[M]),E[M]));return I}if(!u&&l){for(var d=h(i(B[0]),E[0][0]),m=1;m<a;m++)d=w(d,h(i(B[m]),E[m][0]));return d}if(u&&!l){for(var p=h(i(B[0][0]),E[0]),F=1;F<a;F++)p=w(p,h(i(B[F][0]),E[F]));return p}if(u&&l){for(var D=h(i(B[0][0]),E[0][0]),Y=1;Y<a;Y++)D=w(D,h(i(B[Y][0]),E[Y][0]));return D}},"SparseMatrix, SparseMatrix":function(A,e){o(A,e);for(var i=A._index,r=A._values,s=e._index,a=e._values,B=0,c=t,g=n,E=0,Q=0;E<i.length&&Q<s.length;){var u=i[E],l=s[Q];u<l?E++:u>l?Q++:u===l&&(B=c(B,g(r[E],a[Q])),E++,Q++)}return B}});function o(A,e){var t,n,i=s(A),r=s(e);if(1===i.length)t=i[0];else{if(2!==i.length||1!==i[1])throw new RangeError("Expected a column vector, instead got a matrix of size ("+i.join(", ")+")");t=i[0]}if(1===r.length)n=r[0];else{if(2!==r.length||1!==r[1])throw new RangeError("Expected a column vector, instead got a matrix of size ("+r.join(", ")+")");n=r[0]}if(t!==n)throw new RangeError("Vectors must have equal length ("+t+" != "+n+")");if(0===t)throw new RangeError("Cannot calculate the dot product of empty vectors");return t}function s(A){return g(A)?A.size():r(A)}})),Hc=mA("trace",["typed","matrix","add"],(function(A){var e=A.typed,t=A.matrix,n=A.add;return e("trace",{Array:function(A){return i(t(A))},SparseMatrix:function(A){var e=A._values,t=A._index,i=A._ptr,r=A._size,o=r[0],s=r[1];if(o===s){var a=0;if(e.length>0)for(var B=0;B<s;B++)for(var c=i[B],g=i[B+1],E=c;E<g;E++){var Q=t[E];if(Q===B){a=n(a,e[E]);break}if(Q>B)break}return a}throw new RangeError("Matrix must be square (size: "+Vt(r)+")")},DenseMatrix:i,any:uA});function i(A){var e=A._size,t=A._data;switch(e.length){case 1:if(1===e[0])return uA(t[0]);throw new RangeError("Matrix must be square (size: "+Vt(e)+")");case 2:var i=e[0];if(i===e[1]){for(var r=0,o=0;o<i;o++)r=n(r,t[o][o]);return r}throw new RangeError("Matrix must be square (size: "+Vt(e)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+Vt(e)+")")}}})),bc=mA("index",["typed","Index"],(function(A){var e=A.typed,t=A.Index;return e("index",{"...number | string | BigNumber | Range | Array | Matrix":function(A){var e=A.map((function(A){return r(A)?A.toNumber():c(A)||g(A)?A.map((function(A){return r(A)?A.toNumber():A})):A})),n=new t;return t.apply(n,e),n}})})),vc=(n(9649),new Set(["end"])),kc=mA("Node",["mathWithTransform"],(function(A){var t=A.mathWithTransform;return function(){function A(){DA(this,A)}return NA(A,[{key:"type",get:function(){return"Node"}},{key:"isNode",get:function(){return!0}},{key:"evaluate",value:function(A){return this.compile().evaluate(A)}},{key:"compile",value:function(){var A=this._compile(t,{}),e={};return{evaluate:function(t){var n=jA(t);return function(A){for(var e=0,t=zt(vc);e<t.length;e++){var n=t[e];if(A.has(n))throw new Error('Scope contains an illegal symbol, "'+n+'" is a reserved keyword')}}(n),A(n,e,null)}}}},{key:"_compile",value:function(A,e){throw new Error("Method _compile must be implemented by type "+this.type)}},{key:"forEach",value:function(A){throw new Error("Cannot run forEach on a Node interface")}},{key:"map",value:function(A){throw new Error("Cannot run map on a Node interface")}},{key:"_ifNode",value:function(A){if(!H(A))throw new TypeError("Callback function must return a Node");return A}},{key:"traverse",value:function(A){A(this,null,null),function A(e,t){e.forEach((function(e,n,i){t(e,n,i),A(e,t)}))}(this,A)}},{key:"transform",value:function(A){return function e(t,n,i){var r=A(t,n,i);return r!==t?r:t.map(e)}(this,null,null)}},{key:"filter",value:function(A){var e=[];return this.traverse((function(t,n,i){A(t,n,i)&&e.push(t)})),e}},{key:"clone",value:function(){throw new Error("Cannot clone a Node interface")}},{key:"cloneDeep",value:function(){return this.map((function(A){return A.cloneDeep()}))}},{key:"equals",value:function(A){return!!A&&this.type===A.type&&hA(this,A)}},{key:"toString",value:function(A){var e=this._getCustomString(A);return void 0!==e?e:this._toString(A)}},{key:"toJSON",value:function(){throw new Error("Cannot serialize object: toJSON not implemented by "+this.type)}},{key:"toHTML",value:function(A){var e=this._getCustomString(A);return void 0!==e?e:this.toHTML(A)}},{key:"_toString",value:function(){throw new Error("_toString not implemented for "+this.type)}},{key:"toTex",value:function(A){var e=this._getCustomString(A);return void 0!==e?e:this._toTex(A)}},{key:"_toTex",value:function(A){throw new Error("_toTex not implemented for "+this.type)}},{key:"_getCustomString",value:function(A){if(A&&"object"===e(A))switch(e(A.handler)){case"object":case"undefined":return;case"function":return A.handler(this,A);default:throw new TypeError("Object or function expected as callback")}}},{key:"getIdentifier",value:function(){return this.type}},{key:"getContent",value:function(){return this}}]),A}()}),{isClass:!0,isNode:!0});function jc(A,e){return(jc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(A,e){return A.__proto__=e,A})(A,e)}function Jc(A,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");A.prototype=Object.create(e&&e.prototype,{constructor:{value:A,writable:!0,configurable:!0}}),Object.defineProperty(A,"prototype",{writable:!1}),e&&jc(A,e)}function zc(A,t){if(t&&("object"===e(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(A){if(void 0===A)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A}(A)}function Lc(A){return(Lc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(A){return A.__proto__||Object.getPrototypeOf(A)})(A)}function Pc(A){return A&&A.isIndexError?new qt(A.index+1,A.min+1,void 0!==A.max?A.max+1:void 0):A}function Oc(A){var t=A.subset;return function(A,n){try{if(Array.isArray(A))return t(A,n);if(A&&"function"==typeof A.subset)return A.subset(n);if("string"==typeof A)return t(A,n);if("object"===e(A)){if(!n.isObjectProperty())throw new TypeError("Cannot apply a numeric index as object property");return UA(A,n.getObjectProperty())}throw new TypeError("Cannot apply index: unsupported type of object")}catch(A){throw Pc(A)}}}n(6034),n(50);var Vc="AccessorNode",Wc=mA(Vc,["subset","Node"],(function(A){var e=A.subset,t=A.Node,n=Oc({subset:e});function i(A){return!(Y(A)||f(A)||T(A)||G(A)||b(A)||k(A)||z(A))}var r=function(A){Jc(o,A);var e,t,r=(e=o,t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}(),function(){var A,n=Lc(e);if(t){var i=Lc(this).constructor;A=Reflect.construct(n,arguments,i)}else A=n.apply(this,arguments);return zc(this,A)});function o(A,e){var t;if(DA(this,o),t=r.call(this),!H(A))throw new TypeError('Node expected for parameter "object"');if(!S(e))throw new TypeError('IndexNode expected for parameter "index"');return t.object=A,t.index=e,t}return NA(o,[{key:"name",get:function(){return this.index?this.index.isObjectProperty()?this.index.getObjectProperty():"":this.object.name||""}},{key:"type",get:function(){return Vc}},{key:"isAccessorNode",get:function(){return!0}},{key:"_compile",value:function(A,e){var t=this.object._compile(A,e),i=this.index._compile(A,e);if(this.index.isObjectProperty()){var r=this.index.getObjectProperty();return function(A,e,n){return UA(t(A,e,n),r)}}return function(A,e,r){var o=t(A,e,r),s=i(A,e,o);return n(o,s)}}},{key:"forEach",value:function(A){A(this.object,"object",this),A(this.index,"index",this)}},{key:"map",value:function(A){return new o(this._ifNode(A(this.object,"object",this)),this._ifNode(A(this.index,"index",this)))}},{key:"clone",value:function(){return new o(this.object,this.index)}},{key:"_toString",value:function(A){var e=this.object.toString(A);return i(this.object)&&(e="("+e+")"),e+this.index.toString(A)}},{key:"toHTML",value:function(A){var e=this.object.toHTML(A);return i(this.object)&&(e='<span class="math-parenthesis math-round-parenthesis">(</span>'+e+'<span class="math-parenthesis math-round-parenthesis">)</span>'),e+this.index.toHTML(A)}},{key:"_toTex",value:function(A){var e=this.object.toTex(A);return i(this.object)&&(e="\\left(' + object + '\\right)"),e+this.index.toTex(A)}},{key:"toJSON",value:function(){return{mathjs:Vc,object:this.object,index:this.index}}}],[{key:"fromJSON",value:function(A){return new o(A.object,A.index)}}]),o}(t);return Ir(r,"name",Vc),r}),{isClass:!0,isNode:!0}),Kc="ArrayNode",Xc=mA(Kc,["Node"],(function(A){var e=function(A){Jc(i,A);var e,t,n=(e=i,t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}(),function(){var A,n=Lc(e);if(t){var i=Lc(this).constructor;A=Reflect.construct(n,arguments,i)}else A=n.apply(this,arguments);return zc(this,A)});function i(A){var e;if(DA(this,i),(e=n.call(this)).items=A||[],!Array.isArray(e.items)||!e.items.every(H))throw new TypeError("Array containing Nodes expected");return e}return NA(i,[{key:"type",get:function(){return Kc}},{key:"isArrayNode",get:function(){return!0}},{key:"_compile",value:function(A,e){var t=En(this.items,(function(t){return t._compile(A,e)}));if("Array"!==A.config.matrix){var n=A.matrix;return function(A,e,i){return n(En(t,(function(t){return t(A,e,i)})))}}return function(A,e,n){return En(t,(function(t){return t(A,e,n)}))}}},{key:"forEach",value:function(A){for(var e=0;e<this.items.length;e++)A(this.items[e],"items["+e+"]",this)}},{key:"map",value:function(A){for(var e=[],t=0;t<this.items.length;t++)e[t]=this._ifNode(A(this.items[t],"items["+t+"]",this));return new i(e)}},{key:"clone",value:function(){return new i(this.items.slice(0))}},{key:"_toString",value:function(A){return"["+this.items.map((function(e){return e.toString(A)})).join(", ")+"]"}},{key:"toJSON",value:function(){return{mathjs:Kc,items:this.items}}},{key:"toHTML",value:function(A){return'<span class="math-parenthesis math-square-parenthesis">[</span>'+this.items.map((function(e){return e.toHTML(A)})).join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-square-parenthesis">]</span>'}},{key:"_toTex",value:function(A){return function e(t,n){var i=t.some(f)&&!t.every(f),r=n||i,o=r?"&":"\\\\",s=t.map((function(t){return t.items?e(t.items,!n):t.toTex(A)})).join(o);return i||!r||r&&!n?"\\begin{bmatrix}"+s+"\\end{bmatrix}":s}(this.items,!1)}}],[{key:"fromJSON",value:function(A){return new i(A.items)}}]),i}(A.Node);return Ir(e,"name",Kc),e}),{isClass:!0,isNode:!0});function Zc(A,e){(null==e||e>A.length)&&(e=A.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=A[t];return n}var _c=[{AssignmentNode:{},FunctionAssignmentNode:{}},{ConditionalNode:{latexLeftParens:!1,latexRightParens:!1,latexParens:!1}},{"OperatorNode:or":{op:"or",associativity:"left",associativeWith:[]}},{"OperatorNode:xor":{op:"xor",associativity:"left",associativeWith:[]}},{"OperatorNode:and":{op:"and",associativity:"left",associativeWith:[]}},{"OperatorNode:bitOr":{op:"|",associativity:"left",associativeWith:[]}},{"OperatorNode:bitXor":{op:"^|",associativity:"left",associativeWith:[]}},{"OperatorNode:bitAnd":{op:"&",associativity:"left",associativeWith:[]}},{"OperatorNode:equal":{op:"==",associativity:"left",associativeWith:[]},"OperatorNode:unequal":{op:"!=",associativity:"left",associativeWith:[]},"OperatorNode:smaller":{op:"<",associativity:"left",associativeWith:[]},"OperatorNode:larger":{op:">",associativity:"left",associativeWith:[]},"OperatorNode:smallerEq":{op:"<=",associativity:"left",associativeWith:[]},"OperatorNode:largerEq":{op:">=",associativity:"left",associativeWith:[]},RelationalNode:{associativity:"left",associativeWith:[]}},{"OperatorNode:leftShift":{op:"<<",associativity:"left",associativeWith:[]},"OperatorNode:rightArithShift":{op:">>",associativity:"left",associativeWith:[]},"OperatorNode:rightLogShift":{op:">>>",associativity:"left",associativeWith:[]}},{"OperatorNode:to":{op:"to",associativity:"left",associativeWith:[]}},{RangeNode:{}},{"OperatorNode:add":{op:"+",associativity:"left",associativeWith:["OperatorNode:add","OperatorNode:subtract"]},"OperatorNode:subtract":{op:"-",associativity:"left",associativeWith:[]}},{"OperatorNode:multiply":{op:"*",associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","Operator:dotMultiply","Operator:dotDivide"]},"OperatorNode:divide":{op:"/",associativity:"left",associativeWith:[],latexLeftParens:!1,latexRightParens:!1,latexParens:!1},"OperatorNode:dotMultiply":{op:".*",associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","OperatorNode:dotMultiply","OperatorNode:doDivide"]},"OperatorNode:dotDivide":{op:"./",associativity:"left",associativeWith:[]},"OperatorNode:mod":{op:"mod",associativity:"left",associativeWith:[]}},{"OperatorNode:multiply":{associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","Operator:dotMultiply","Operator:dotDivide"]}},{"OperatorNode:unaryPlus":{op:"+",associativity:"right"},"OperatorNode:unaryMinus":{op:"-",associativity:"right"},"OperatorNode:bitNot":{op:"~",associativity:"right"},"OperatorNode:not":{op:"not",associativity:"right"}},{"OperatorNode:pow":{op:"^",associativity:"right",associativeWith:[],latexRightParens:!1},"OperatorNode:dotPow":{op:".^",associativity:"right",associativeWith:[]}},{"OperatorNode:factorial":{op:"!",associativity:"left"}},{"OperatorNode:ctranspose":{op:"'",associativity:"left"}}];function qc(A,e){if(!e||"auto"!==e)return A;for(var t=A;k(t);)t=t.content;return t}function $c(A,e,t,n){var i=A;"keep"!==e&&(i=A.getContent());for(var r=i.getIdentifier(),o=null,s=0;s<_c.length;s++)if(r in _c[s]){o=s;break}if("OperatorNode:multiply"===r&&i.implicit&&"show"!==t){var a=qc(i.args[0],e);T(a)&&n&&"OperatorNode:divide"===n.getIdentifier()&&x(qc(n.args[0],e))||"OperatorNode:divide"===a.getIdentifier()&&x(qc(a.args[0],e))&&T(qc(a.args[1]))||(o+=1)}return o}function Ag(A,e){var t=A;"keep"!==e&&(t=A.getContent());var n=t.getIdentifier(),i=$c(t,e);if(null===i)return null;var r=_c[i][n];if(MA(r,"associativity")){if("left"===r.associativity)return"left";if("right"===r.associativity)return"right";throw Error("'"+n+"' has the invalid associativity '"+r.associativity+"'.")}return null}function eg(A,e,t){var n="keep"!==t?A.getContent():A,i="keep"!==t?A.getContent():e,r=n.getIdentifier(),o=i.getIdentifier(),s=$c(n,t);if(null===s)return null;var a=_c[s][r];if(MA(a,"associativeWith")&&a.associativeWith instanceof Array){for(var B=0;B<a.associativeWith.length;B++)if(a.associativeWith[B]===o)return!0;return!1}return null}var tg="AssignmentNode",ng=mA(tg,["subset","?matrix","Node"],(function(A){var t=A.subset,n=A.matrix,i=A.Node,r=Oc({subset:t}),o=function(A){var t=A.subset,n=A.matrix;return function(A,i,r){try{if(Array.isArray(A))return n(A).subset(i,r).valueOf().forEach((function(e,t){A[t]=e})),A;if(A&&"function"==typeof A.subset)return A.subset(i,r);if("string"==typeof A)return t(A,i,r);if("object"===e(A)){if(!i.isObjectProperty())throw TypeError("Cannot apply a numeric index as object property");return yA(A,i.getObjectProperty(),r),A}throw new TypeError("Cannot apply index: unsupported type of object")}catch(A){throw Pc(A)}}}({subset:t,matrix:n});function s(A,e,t){e||(e="keep");var n=$c(A,e,t),i=$c(A.value,e,t);return"all"===e||null!==i&&i<=n}var a=function(A){Jc(i,A);var e,t,n=(e=i,t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}(),function(){var A,n=Lc(e);if(t){var i=Lc(this).constructor;A=Reflect.construct(n,arguments,i)}else A=n.apply(this,arguments);return zc(this,A)});function i(A,e,t){var r;if(DA(this,i),(r=n.call(this)).object=A,r.index=t?e:null,r.value=t||e,!z(A)&&!Y(A))throw new TypeError('SymbolNode or AccessorNode expected as "object"');if(z(A)&&"end"===A.name)throw new Error('Cannot assign to symbol "end"');if(r.index&&!S(r.index))throw new TypeError('IndexNode expected as "index"');if(!H(r.value))throw new TypeError('Node expected as "value"');return r}return NA(i,[{key:"name",get:function(){return this.index?this.index.isObjectProperty()?this.index.getObjectProperty():"":this.object.name||""}},{key:"type",get:function(){return tg}},{key:"isAssignmentNode",get:function(){return!0}},{key:"_compile",value:function(A,e){var t=this.object._compile(A,e),n=this.index?this.index._compile(A,e):null,i=this.value._compile(A,e),s=this.object.name;if(this.index){if(this.index.isObjectProperty()){var a=this.index.getObjectProperty();return function(A,e,n){var r=t(A,e,n),o=i(A,e,n);return yA(r,a,o),o}}if(z(this.object))return function(A,e,r){var a=t(A,e,r),B=i(A,e,r),c=n(A,e,a);return A.set(s,o(a,c,B)),B};var B=this.object.object._compile(A,e);if(this.object.index.isObjectProperty()){var c=this.object.index.getObjectProperty();return function(A,e,t){var r=B(A,e,t),s=UA(r,c),a=n(A,e,s),g=i(A,e,t);return yA(r,c,o(s,a,g)),g}}var g=this.object.index._compile(A,e);return function(A,e,t){var s=B(A,e,t),a=g(A,e,s),c=r(s,a),E=n(A,e,c),Q=i(A,e,t);return o(s,a,o(c,E,Q)),Q}}if(!z(this.object))throw new TypeError("SymbolNode expected as object");return function(A,e,t){var n=i(A,e,t);return A.set(s,n),n}}},{key:"forEach",value:function(A){A(this.object,"object",this),this.index&&A(this.index,"index",this),A(this.value,"value",this)}},{key:"map",value:function(A){return new i(this._ifNode(A(this.object,"object",this)),this.index?this._ifNode(A(this.index,"index",this)):null,this._ifNode(A(this.value,"value",this)))}},{key:"clone",value:function(){return new i(this.object,this.index,this.value)}},{key:"_toString",value:function(A){var e=this.object.toString(A),t=this.index?this.index.toString(A):"",n=this.value.toString(A);return s(this,A&&A.parenthesis,A&&A.implicit)&&(n="("+n+")"),e+t+" = "+n}},{key:"toJSON",value:function(){return{mathjs:tg,object:this.object,index:this.index,value:this.value}}},{key:"toHTML",value:function(A){var e=this.object.toHTML(A),t=this.index?this.index.toHTML(A):"",n=this.value.toHTML(A);return s(this,A&&A.parenthesis,A&&A.implicit)&&(n='<span class="math-paranthesis math-round-parenthesis">(</span>'+n+'<span class="math-paranthesis math-round-parenthesis">)</span>'),e+t+'<span class="math-operator math-assignment-operator math-variable-assignment-operator math-binary-operator">=</span>'+n}},{key:"_toTex",value:function(A){var e=this.object.toTex(A),t=this.index?this.index.toTex(A):"",n=this.value.toTex(A);return s(this,A&&A.parenthesis,A&&A.implicit)&&(n="\\left(".concat(n,"\\right)")),e+t+":="+n}}],[{key:"fromJSON",value:function(A){return new i(A.object,A.index,A.value)}}]),i}(i);return Ir(a,"name",tg),a}),{isClass:!0,isNode:!0}),ig="BlockNode",rg=mA(ig,["ResultSet","Node"],(function(A){var e=A.ResultSet,t=function(A){Jc(r,A);var t,n,i=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}(),function(){var A,e=Lc(t);if(n){var i=Lc(this).constructor;A=Reflect.construct(e,arguments,i)}else A=e.apply(this,arguments);return zc(this,A)});function r(A){var e;if(DA(this,r),e=i.call(this),!Array.isArray(A))throw new Error("Array expected");return e.blocks=A.map((function(A){var e=A&&A.node,t=!A||void 0===A.visible||A.visible;if(!H(e))throw new TypeError('Property "node" must be a Node');if("boolean"!=typeof t)throw new TypeError('Property "visible" must be a boolean');return{node:e,visible:t}})),e}return NA(r,[{key:"type",get:function(){return ig}},{key:"isBlockNode",get:function(){return!0}},{key:"_compile",value:function(A,t){var n=En(this.blocks,(function(e){return{evaluate:e.node._compile(A,t),visible:e.visible}}));return function(A,t,i){var r=[];return Qn(n,(function(e){var n=e.evaluate(A,t,i);e.visible&&r.push(n)})),new e(r)}}},{key:"forEach",value:function(A){for(var e=0;e<this.blocks.length;e++)A(this.blocks[e].node,"blocks["+e+"].node",this)}},{key:"map",value:function(A){for(var e=[],t=0;t<this.blocks.length;t++){var n=this.blocks[t],i=this._ifNode(A(n.node,"blocks["+t+"].node",this));e[t]={node:i,visible:n.visible}}return new r(e)}},{key:"clone",value:function(){return new r(this.blocks.map((function(A){return{node:A.node,visible:A.visible}})))}},{key:"_toString",value:function(A){return this.blocks.map((function(e){return e.node.toString(A)+(e.visible?"":";")})).join("\n")}},{key:"toJSON",value:function(){return{mathjs:ig,blocks:this.blocks}}},{key:"toHTML",value:function(A){return this.blocks.map((function(e){return e.node.toHTML(A)+(e.visible?"":'<span class="math-separator">;</span>')})).join('<span class="math-separator"><br /></span>')}},{key:"_toTex",value:function(A){return this.blocks.map((function(e){return e.node.toTex(A)+(e.visible?"":";")})).join("\\;\\;\n")}}],[{key:"fromJSON",value:function(A){return new r(A.blocks)}}]),r}(A.Node);return Ir(t,"name",ig),t}),{isClass:!0,isNode:!0}),og="ConditionalNode",sg=mA(og,["Node"],(function(A){var e=function(A){Jc(i,A);var e,t,n=(e=i,t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}(),function(){var A,n=Lc(e);if(t){var i=Lc(this).constructor;A=Reflect.construct(n,arguments,i)}else A=n.apply(this,arguments);return zc(this,A)});function i(A,e,t){var r;if(DA(this,i),r=n.call(this),!H(A))throw new TypeError("Parameter condition must be a Node");if(!H(e))throw new TypeError("Parameter trueExpr must be a Node");if(!H(t))throw new TypeError("Parameter falseExpr must be a Node");return r.condition=A,r.trueExpr=e,r.falseExpr=t,r}return NA(i,[{key:"type",get:function(){return og}},{key:"isConditionalNode",get:function(){return!0}},{key:"_compile",value:function(A,e){var t=this.condition._compile(A,e),n=this.trueExpr._compile(A,e),i=this.falseExpr._compile(A,e);return function(A,e,s){return function(A){if("number"==typeof A||"boolean"==typeof A||"string"==typeof A)return!!A;if(A){if(r(A))return!A.isZero();if(o(A))return!(!A.re&&!A.im);if(a(A))return!!A.value}if(null==A)return!1;throw new TypeError('Unsupported type of condition "'+P(A)+'"')}(t(A,e,s))?n(A,e,s):i(A,e,s)}}},{key:"forEach",value:function(A){A(this.condition,"condition",this),A(this.trueExpr,"trueExpr",this),A(this.falseExpr,"falseExpr",this)}},{key:"map",value:function(A){return new i(this._ifNode(A(this.condition,"condition",this)),this._ifNode(A(this.trueExpr,"trueExpr",this)),this._ifNode(A(this.falseExpr,"falseExpr",this)))}},{key:"clone",value:function(){return new i(this.condition,this.trueExpr,this.falseExpr)}},{key:"_toString",value:function(A){var e=A&&A.parenthesis?A.parenthesis:"keep",t=$c(this,e,A&&A.implicit),n=this.condition.toString(A),i=$c(this.condition,e,A&&A.implicit);("all"===e||"OperatorNode"===this.condition.type||null!==i&&i<=t)&&(n="("+n+")");var r=this.trueExpr.toString(A),o=$c(this.trueExpr,e,A&&A.implicit);("all"===e||"OperatorNode"===this.trueExpr.type||null!==o&&o<=t)&&(r="("+r+")");var s=this.falseExpr.toString(A),a=$c(this.falseExpr,e,A&&A.implicit);return("all"===e||"OperatorNode"===this.falseExpr.type||null!==a&&a<=t)&&(s="("+s+")"),n+" ? "+r+" : "+s}},{key:"toJSON",value:function(){return{mathjs:og,condition:this.condition,trueExpr:this.trueExpr,falseExpr:this.falseExpr}}},{key:"toHTML",value:function(A){var e=A&&A.parenthesis?A.parenthesis:"keep",t=$c(this,e,A&&A.implicit),n=this.condition.toHTML(A),i=$c(this.condition,e,A&&A.implicit);("all"===e||"OperatorNode"===this.condition.type||null!==i&&i<=t)&&(n='<span class="math-parenthesis math-round-parenthesis">(</span>'+n+'<span class="math-parenthesis math-round-parenthesis">)</span>');var r=this.trueExpr.toHTML(A),o=$c(this.trueExpr,e,A&&A.implicit);("all"===e||"OperatorNode"===this.trueExpr.type||null!==o&&o<=t)&&(r='<span class="math-parenthesis math-round-parenthesis">(</span>'+r+'<span class="math-parenthesis math-round-parenthesis">)</span>');var s=this.falseExpr.toHTML(A),a=$c(this.falseExpr,e,A&&A.implicit);return("all"===e||"OperatorNode"===this.falseExpr.type||null!==a&&a<=t)&&(s='<span class="math-parenthesis math-round-parenthesis">(</span>'+s+'<span class="math-parenthesis math-round-parenthesis">)</span>'),n+'<span class="math-operator math-conditional-operator">?</span>'+r+'<span class="math-operator math-conditional-operator">:</span>'+s}},{key:"_toTex",value:function(A){return"\\begin{cases} {"+this.trueExpr.toTex(A)+"}, &\\quad{\\text{if }\\;"+this.condition.toTex(A)+"}\\\\{"+this.falseExpr.toTex(A)+"}, &\\quad{\\text{otherwise}}\\end{cases}"}}],[{key:"fromJSON",value:function(A){return new i(A.condition,A.trueExpr,A.falseExpr)}}]),i}(A.Node);return Ir(e,"name",og),e}),{isClass:!0,isNode:!0}),ag=n(7928),Bg={Alpha:"A",alpha:"\\alpha",Beta:"B",beta:"\\beta",Gamma:"\\Gamma",gamma:"\\gamma",Delta:"\\Delta",delta:"\\delta",Epsilon:"E",epsilon:"\\epsilon",varepsilon:"\\varepsilon",Zeta:"Z",zeta:"\\zeta",Eta:"H",eta:"\\eta",Theta:"\\Theta",theta:"\\theta",vartheta:"\\vartheta",Iota:"I",iota:"\\iota",Kappa:"K",kappa:"\\kappa",varkappa:"\\varkappa",Lambda:"\\Lambda",lambda:"\\lambda",Mu:"M",mu:"\\mu",Nu:"N",nu:"\\nu",Xi:"\\Xi",xi:"\\xi",Omicron:"O",omicron:"o",Pi:"\\Pi",pi:"\\pi",varpi:"\\varpi",Rho:"P",rho:"\\rho",varrho:"\\varrho",Sigma:"\\Sigma",sigma:"\\sigma",varsigma:"\\varsigma",Tau:"T",tau:"\\tau",Upsilon:"\\Upsilon",upsilon:"\\upsilon",Phi:"\\Phi",phi:"\\phi",varphi:"\\varphi",Chi:"X",chi:"\\chi",Psi:"\\Psi",psi:"\\psi",Omega:"\\Omega",omega:"\\omega",true:"\\mathrm{True}",false:"\\mathrm{False}",i:"i",inf:"\\infty",Inf:"\\infty",infinity:"\\infty",Infinity:"\\infty",oo:"\\infty",lim:"\\lim",undefined:"\\mathbf{?}"},cg={transpose:"^\\top",ctranspose:"^H",factorial:"!",pow:"^",dotPow:".^\\wedge",unaryPlus:"+",unaryMinus:"-",bitNot:"\\~",not:"\\neg",multiply:"\\cdot",divide:"\\frac",dotMultiply:".\\cdot",dotDivide:".:",mod:"\\mod",add:"+",subtract:"-",to:"\\rightarrow",leftShift:"<<",rightArithShift:">>",rightLogShift:">>>",equal:"=",unequal:"\\neq",smaller:"<",larger:">",smallerEq:"\\leq",largerEq:"\\geq",bitAnd:"\\&",bitXor:"\\underline{|}",bitOr:"|",and:"\\wedge",xor:"\\veebar",or:"\\vee"},gg={abs:{1:"\\left|${args[0]}\\right|"},add:{2:"\\left(${args[0]}".concat(cg.add,"${args[1]}\\right)")},cbrt:{1:"\\sqrt[3]{${args[0]}}"},ceil:{1:"\\left\\lceil${args[0]}\\right\\rceil"},cube:{1:"\\left(${args[0]}\\right)^3"},divide:{2:"\\frac{${args[0]}}{${args[1]}}"},dotDivide:{2:"\\left(${args[0]}".concat(cg.dotDivide,"${args[1]}\\right)")},dotMultiply:{2:"\\left(${args[0]}".concat(cg.dotMultiply,"${args[1]}\\right)")},dotPow:{2:"\\left(${args[0]}".concat(cg.dotPow,"${args[1]}\\right)")},exp:{1:"\\exp\\left(${args[0]}\\right)"},expm1:"\\left(e".concat(cg.pow,"{${args[0]}}-1\\right)"),fix:{1:"\\mathrm{${name}}\\left(${args[0]}\\right)"},floor:{1:"\\left\\lfloor${args[0]}\\right\\rfloor"},gcd:"\\gcd\\left(${args}\\right)",hypot:"\\hypot\\left(${args}\\right)",log:{1:"\\ln\\left(${args[0]}\\right)",2:"\\log_{${args[1]}}\\left(${args[0]}\\right)"},log10:{1:"\\log_{10}\\left(${args[0]}\\right)"},log1p:{1:"\\ln\\left(${args[0]}+1\\right)",2:"\\log_{${args[1]}}\\left(${args[0]}+1\\right)"},log2:"\\log_{2}\\left(${args[0]}\\right)",mod:{2:"\\left(${args[0]}".concat(cg.mod,"${args[1]}\\right)")},multiply:{2:"\\left(${args[0]}".concat(cg.multiply,"${args[1]}\\right)")},norm:{1:"\\left\\|${args[0]}\\right\\|",2:void 0},nthRoot:{2:"\\sqrt[${args[1]}]{${args[0]}}"},nthRoots:{2:"\\{y : $y^{args[1]} = {${args[0]}}\\}"},pow:{2:"\\left(${args[0]}\\right)".concat(cg.pow,"{${args[1]}}")},round:{1:"\\left\\lfloor${args[0]}\\right\\rceil",2:void 0},sign:{1:"\\mathrm{${name}}\\left(${args[0]}\\right)"},sqrt:{1:"\\sqrt{${args[0]}}"},square:{1:"\\left(${args[0]}\\right)^2"},subtract:{2:"\\left(${args[0]}".concat(cg.subtract,"${args[1]}\\right)")},unaryMinus:{1:"".concat(cg.unaryMinus,"\\left(${args[0]}\\right)")},unaryPlus:{1:"".concat(cg.unaryPlus,"\\left(${args[0]}\\right)")},bitAnd:{2:"\\left(${args[0]}".concat(cg.bitAnd,"${args[1]}\\right)")},bitNot:{1:cg.bitNot+"\\left(${args[0]}\\right)"},bitOr:{2:"\\left(${args[0]}".concat(cg.bitOr,"${args[1]}\\right)")},bitXor:{2:"\\left(${args[0]}".concat(cg.bitXor,"${args[1]}\\right)")},leftShift:{2:"\\left(${args[0]}".concat(cg.leftShift,"${args[1]}\\right)")},rightArithShift:{2:"\\left(${args[0]}".concat(cg.rightArithShift,"${args[1]}\\right)")},rightLogShift:{2:"\\left(${args[0]}".concat(cg.rightLogShift,"${args[1]}\\right)")},bellNumbers:{1:"\\mathrm{B}_{${args[0]}}"},catalan:{1:"\\mathrm{C}_{${args[0]}}"},stirlingS2:{2:"\\mathrm{S}\\left(${args}\\right)"},arg:{1:"\\arg\\left(${args[0]}\\right)"},conj:{1:"\\left(${args[0]}\\right)^*"},im:{1:"\\Im\\left\\lbrace${args[0]}\\right\\rbrace"},re:{1:"\\Re\\left\\lbrace${args[0]}\\right\\rbrace"},and:{2:"\\left(${args[0]}".concat(cg.and,"${args[1]}\\right)")},not:{1:cg.not+"\\left(${args[0]}\\right)"},or:{2:"\\left(${args[0]}".concat(cg.or,"${args[1]}\\right)")},xor:{2:"\\left(${args[0]}".concat(cg.xor,"${args[1]}\\right)")},cross:{2:"\\left(${args[0]}\\right)\\times\\left(${args[1]}\\right)"},ctranspose:{1:"\\left(${args[0]}\\right)".concat(cg.ctranspose)},det:{1:"\\det\\left(${args[0]}\\right)"},dot:{2:"\\left(${args[0]}\\cdot${args[1]}\\right)"},expm:{1:"\\exp\\left(${args[0]}\\right)"},inv:{1:"\\left(${args[0]}\\right)^{-1}"},pinv:{1:"\\left(${args[0]}\\right)^{+}"},sqrtm:{1:"{${args[0]}}".concat(cg.pow,"{\\frac{1}{2}}")},trace:{1:"\\mathrm{tr}\\left(${args[0]}\\right)"},transpose:{1:"\\left(${args[0]}\\right)".concat(cg.transpose)},combinations:{2:"\\binom{${args[0]}}{${args[1]}}"},combinationsWithRep:{2:"\\left(\\!\\!{\\binom{${args[0]}}{${args[1]}}}\\!\\!\\right)"},factorial:{1:"\\left(${args[0]}\\right)".concat(cg.factorial)},gamma:{1:"\\Gamma\\left(${args[0]}\\right)"},lgamma:{1:"\\ln\\Gamma\\left(${args[0]}\\right)"},equal:{2:"\\left(${args[0]}".concat(cg.equal,"${args[1]}\\right)")},larger:{2:"\\left(${args[0]}".concat(cg.larger,"${args[1]}\\right)")},largerEq:{2:"\\left(${args[0]}".concat(cg.largerEq,"${args[1]}\\right)")},smaller:{2:"\\left(${args[0]}".concat(cg.smaller,"${args[1]}\\right)")},smallerEq:{2:"\\left(${args[0]}".concat(cg.smallerEq,"${args[1]}\\right)")},unequal:{2:"\\left(${args[0]}".concat(cg.unequal,"${args[1]}\\right)")},erf:{1:"erf\\left(${args[0]}\\right)"},max:"\\max\\left(${args}\\right)",min:"\\min\\left(${args}\\right)",variance:"\\mathrm{Var}\\left(${args}\\right)",acos:{1:"\\cos^{-1}\\left(${args[0]}\\right)"},acosh:{1:"\\cosh^{-1}\\left(${args[0]}\\right)"},acot:{1:"\\cot^{-1}\\left(${args[0]}\\right)"},acoth:{1:"\\coth^{-1}\\left(${args[0]}\\right)"},acsc:{1:"\\csc^{-1}\\left(${args[0]}\\right)"},acsch:{1:"\\mathrm{csch}^{-1}\\left(${args[0]}\\right)"},asec:{1:"\\sec^{-1}\\left(${args[0]}\\right)"},asech:{1:"\\mathrm{sech}^{-1}\\left(${args[0]}\\right)"},asin:{1:"\\sin^{-1}\\left(${args[0]}\\right)"},asinh:{1:"\\sinh^{-1}\\left(${args[0]}\\right)"},atan:{1:"\\tan^{-1}\\left(${args[0]}\\right)"},atan2:{2:"\\mathrm{atan2}\\left(${args}\\right)"},atanh:{1:"\\tanh^{-1}\\left(${args[0]}\\right)"},cos:{1:"\\cos\\left(${args[0]}\\right)"},cosh:{1:"\\cosh\\left(${args[0]}\\right)"},cot:{1:"\\cot\\left(${args[0]}\\right)"},coth:{1:"\\coth\\left(${args[0]}\\right)"},csc:{1:"\\csc\\left(${args[0]}\\right)"},csch:{1:"\\mathrm{csch}\\left(${args[0]}\\right)"},sec:{1:"\\sec\\left(${args[0]}\\right)"},sech:{1:"\\mathrm{sech}\\left(${args[0]}\\right)"},sin:{1:"\\sin\\left(${args[0]}\\right)"},sinh:{1:"\\sinh\\left(${args[0]}\\right)"},tan:{1:"\\tan\\left(${args[0]}\\right)"},tanh:{1:"\\tanh\\left(${args[0]}\\right)"},to:{2:"\\left(${args[0]}".concat(cg.to,"${args[1]}\\right)")},numeric:function(A,e){return A.args[0].toTex()},number:{0:"0",1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)${args[1]}\\right)"},string:{0:'\\mathtt{""}',1:"\\mathrm{string}\\left(${args[0]}\\right)"},bignumber:{0:"0",1:"\\left(${args[0]}\\right)"},complex:{0:"0",1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)+".concat(Bg.i,"\\cdot\\left(${args[1]}\\right)\\right)")},matrix:{0:"\\begin{bmatrix}\\end{bmatrix}",1:"\\left(${args[0]}\\right)",2:"\\left(${args[0]}\\right)"},sparse:{0:"\\begin{bsparse}\\end{bsparse}",1:"\\left(${args[0]}\\right)"},unit:{1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)${args[1]}\\right)"}},Eg={deg:"^\\circ"};function Qg(A){return ag(A,{preserveFormatting:!0})}function ug(A,e){return(e=void 0!==e&&e)?MA(Eg,A)?Eg[A]:"\\mathrm{"+Qg(A)+"}":MA(Bg,A)?Bg[A]:Qg(A)}var lg="ConstantNode",wg=mA(lg,["Node"],(function(A){var e=function(A){Jc(i,A);var e,t,n=(e=i,t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}(),function(){var A,n=Lc(e);if(t){var i=Lc(this).constructor;A=Reflect.construct(n,arguments,i)}else A=n.apply(this,arguments);return zc(this,A)});function i(A){var e;return DA(this,i),(e=n.call(this)).value=A,e}return NA(i,[{key:"type",get:function(){return lg}},{key:"isConstantNode",get:function(){return!0}},{key:"_compile",value:function(A,e){var t=this.value;return function(){return t}}},{key:"forEach",value:function(A){}},{key:"map",value:function(A){return this.clone()}},{key:"clone",value:function(){return new i(this.value)}},{key:"_toString",value:function(A){return Vt(this.value,A)}},{key:"toHTML",value:function(A){var e=this._toString(A);switch(P(this.value)){case"number":case"BigNumber":case"Fraction":return'<span class="math-number">'+e+"</span>";case"string":return'<span class="math-string">'+e+"</span>";case"boolean":return'<span class="math-boolean">'+e+"</span>";case"null":return'<span class="math-null-symbol">'+e+"</span>";case"undefined":return'<span class="math-undefined">'+e+"</span>";default:return'<span class="math-symbol">'+e+"</span>"}}},{key:"toJSON",value:function(){return{mathjs:lg,value:this.value}}},{key:"_toTex",value:function(A){var e=this._toString(A);switch(P(this.value)){case"string":return"\\mathtt{"+Qg(e)+"}";case"number":case"BigNumber":if(!isFinite(this.value))return this.value.valueOf()<0?"-\\infty":"\\infty";var t=e.toLowerCase().indexOf("e");return-1!==t?e.substring(0,t)+"\\cdot10^{"+e.substring(t+1)+"}":e;case"Fraction":return this.value.toLatex();default:return e}}}],[{key:"fromJSON",value:function(A){return new i(A.value)}}]),i}(A.Node);return Ir(e,"name",lg),e}),{isClass:!0,isNode:!0});function hg(A,e){(null==e||e>A.length)&&(e=A.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=A[t];return n}var Cg="FunctionAssignmentNode",Ig=mA(Cg,["typed","Node"],(function(A){var e=A.typed;function t(A,e,t){var n=$c(A,e,t),i=$c(A.expr,e,t);return"all"===e||null!==i&&i<=n}var n=function(A){Jc(o,A);var n,i,r=(n=o,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}(),function(){var A,e=Lc(n);if(i){var t=Lc(this).constructor;A=Reflect.construct(e,arguments,t)}else A=e.apply(this,arguments);return zc(this,A)});function o(A,e,t){var n;if(DA(this,o),n=r.call(this),"string"!=typeof A)throw new TypeError('String expected for parameter "name"');if(!Array.isArray(e))throw new TypeError('Array containing strings or objects expected for parameter "params"');if(!H(t))throw new TypeError('Node expected for parameter "expr"');if(vc.has(A))throw new Error('Illegal function name, "'+A+'" is a reserved keyword');var i,s=new Set,a=function(A,e){var t="undefined"!=typeof Symbol&&A[Symbol.iterator]||A["@@iterator"];if(!t){if(Array.isArray(A)||(t=function(A,e){if(A){if("string"==typeof A)return hg(A,e);var t=Object.prototype.toString.call(A).slice(8,-1);return"Object"===t&&A.constructor&&(t=A.constructor.name),"Map"===t||"Set"===t?Array.from(A):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?hg(A,e):void 0}}(A))){t&&(A=t);var n=0,i=function(){};return{s:i,n:function(){return n>=A.length?{done:!0}:{done:!1,value:A[n++]}},e:function(A){throw A},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){t=t.call(A)},n:function(){var A=t.next();return o=A.done,A},e:function(A){s=!0,r=A},f:function(){try{o||null==t.return||t.return()}finally{if(s)throw r}}}}(e);try{for(a.s();!(i=a.n()).done;){var B=i.value,c="string"==typeof B?B:B.name;if(s.has(c))throw new Error('Duplicate parameter name "'.concat(c,'"'));s.add(c)}}catch(A){a.e(A)}finally{a.f()}return n.name=A,n.params=e.map((function(A){return A&&A.name||A})),n.types=e.map((function(A){return A&&A.type||"any"})),n.expr=t,n}return NA(o,[{key:"type",get:function(){return Cg}},{key:"isFunctionAssignmentNode",get:function(){return!0}},{key:"_compile",value:function(A,t){var n=Object.create(t);Qn(this.params,(function(A){n[A]=!0}));var i=this.expr._compile(A,n),r=this.name,o=this.params,s=wn(this.types,","),a=r+"("+wn(this.params,", ")+")";return function(A,t,n){var B={};B[s]=function(){for(var e=Object.create(t),r=0;r<o.length;r++)e[o[r]]=arguments[r];return i(A,e,n)};var c=e(r,B);return c.syntax=a,A.set(r,c),c}}},{key:"forEach",value:function(A){A(this.expr,"expr",this)}},{key:"map",value:function(A){var e=this._ifNode(A(this.expr,"expr",this));return new o(this.name,this.params.slice(0),e)}},{key:"clone",value:function(){return new o(this.name,this.params.slice(0),this.expr)}},{key:"_toString",value:function(A){var e=A&&A.parenthesis?A.parenthesis:"keep",n=this.expr.toString(A);return t(this,e,A&&A.implicit)&&(n="("+n+")"),this.name+"("+this.params.join(", ")+") = "+n}},{key:"toJSON",value:function(){var A=this.types;return{mathjs:Cg,name:this.name,params:this.params.map((function(e,t){return{name:e,type:A[t]}})),expr:this.expr}}},{key:"toHTML",value:function(A){for(var e=A&&A.parenthesis?A.parenthesis:"keep",n=[],i=0;i<this.params.length;i++)n.push('<span class="math-symbol math-parameter">'+Xt(this.params[i])+"</span>");var r=this.expr.toHTML(A);return t(this,e,A&&A.implicit)&&(r='<span class="math-parenthesis math-round-parenthesis">(</span>'+r+'<span class="math-parenthesis math-round-parenthesis">)</span>'),'<span class="math-function">'+Xt(this.name)+'</span><span class="math-parenthesis math-round-parenthesis">(</span>'+n.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-round-parenthesis">)</span><span class="math-operator math-assignment-operator math-variable-assignment-operator math-binary-operator">=</span>'+r}},{key:"_toTex",value:function(A){var e=A&&A.parenthesis?A.parenthesis:"keep",n=this.expr.toTex(A);return t(this,e,A&&A.implicit)&&(n="\\left(".concat(n,"\\right)")),"\\mathrm{"+this.name+"}\\left("+this.params.map(ug).join(",")+"\\right):="+n}}],[{key:"fromJSON",value:function(A){return new o(A.name,A.params,A.expr)}}]),o}(A.Node);return Ir(n,"name",Cg),n}),{isClass:!0,isNode:!0}),Mg="IndexNode",dg=mA(Mg,["Node","size"],(function(A){var e=A.Node,t=A.size,n=function(A){Jc(r,A);var e,n,i=(e=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}(),function(){var A,t=Lc(e);if(n){var i=Lc(this).constructor;A=Reflect.construct(t,arguments,i)}else A=t.apply(this,arguments);return zc(this,A)});function r(A,e){var t;if(DA(this,r),(t=i.call(this)).dimensions=A,t.dotNotation=e||!1,!Array.isArray(A)||!A.every(H))throw new TypeError('Array containing Nodes expected for parameter "dimensions"');if(t.dotNotation&&!t.isObjectProperty())throw new Error("dotNotation only applicable for object properties");return t}return NA(r,[{key:"type",get:function(){return Mg}},{key:"isIndexNode",get:function(){return!0}},{key:"_compile",value:function(A,e){var n=En(this.dimensions,(function(n,i){if(n.filter((function(A){return A.isSymbolNode&&"end"===A.name})).length>0){var r=Object.create(e);r.end=!0;var o=n._compile(A,r);return function(A,e,n){if(!g(n)&&!c(n)&&!B(n))throw new TypeError('Cannot resolve "end": context must be a Matrix, Array, or string but is '+P(n));var r=t(n).valueOf(),s=Object.create(e);return s.end=r[i],o(A,s,n)}}return n._compile(A,e)})),i=UA(A,"index");return function(A,e,t){var r=En(n,(function(n){return n(A,e,t)}));return i.apply(void 0,zt(r))}}},{key:"forEach",value:function(A){for(var e=0;e<this.dimensions.length;e++)A(this.dimensions[e],"dimensions["+e+"]",this)}},{key:"map",value:function(A){for(var e=[],t=0;t<this.dimensions.length;t++)e[t]=this._ifNode(A(this.dimensions[t],"dimensions["+t+"]",this));return new r(e,this.dotNotation)}},{key:"clone",value:function(){return new r(this.dimensions.slice(0),this.dotNotation)}},{key:"isObjectProperty",value:function(){return 1===this.dimensions.length&&T(this.dimensions[0])&&"string"==typeof this.dimensions[0].value}},{key:"getObjectProperty",value:function(){return this.isObjectProperty()?this.dimensions[0].value:null}},{key:"_toString",value:function(A){return this.dotNotation?"."+this.getObjectProperty():"["+this.dimensions.join(", ")+"]"}},{key:"toJSON",value:function(){return{mathjs:Mg,dimensions:this.dimensions,dotNotation:this.dotNotation}}},{key:"toHTML",value:function(A){for(var e=[],t=0;t<this.dimensions.length;t++)e[t]=this.dimensions[t].toHTML();return this.dotNotation?'<span class="math-operator math-accessor-operator">.</span><span class="math-symbol math-property">'+Xt(this.getObjectProperty())+"</span>":'<span class="math-parenthesis math-square-parenthesis">[</span>'+e.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-square-parenthesis">]</span>'}},{key:"_toTex",value:function(A){var e=this.dimensions.map((function(e){return e.toTex(A)}));return this.dotNotation?"."+this.getObjectProperty():"_{"+e.join(",")+"}"}}],[{key:"fromJSON",value:function(A){return new r(A.dimensions,A.dotNotation)}}]),r}(e);return Ir(n,"name",Mg),n}),{isClass:!0,isNode:!0}),mg="ObjectNode",pg=mA(mg,["Node"],(function(A){var t=function(A){Jc(r,A);var t,n,i=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}(),function(){var A,e=Lc(t);if(n){var i=Lc(this).constructor;A=Reflect.construct(e,arguments,i)}else A=e.apply(this,arguments);return zc(this,A)});function r(A){var t;if(DA(this,r),(t=i.call(this)).properties=A||{},A&&("object"!==e(A)||!Object.keys(A).every((function(e){return H(A[e])}))))throw new TypeError("Object containing Nodes expected");return t}return NA(r,[{key:"type",get:function(){return mg}},{key:"isObjectNode",get:function(){return!0}},{key:"_compile",value:function(A,e){var t={};for(var n in this.properties)if(MA(this.properties,n)){var i=Wt(n),r=JSON.parse(i),o=UA(this.properties,n);t[r]=o._compile(A,e)}return function(A,e,n){var i={};for(var r in t)MA(t,r)&&(i[r]=t[r](A,e,n));return i}}},{key:"forEach",value:function(A){for(var e in this.properties)MA(this.properties,e)&&A(this.properties[e],"properties["+Wt(e)+"]",this)}},{key:"map",value:function(A){var e={};for(var t in this.properties)MA(this.properties,t)&&(e[t]=this._ifNode(A(this.properties[t],"properties["+Wt(t)+"]",this)));return new r(e)}},{key:"clone",value:function(){var A={};for(var e in this.properties)MA(this.properties,e)&&(A[e]=this.properties[e]);return new r(A)}},{key:"_toString",value:function(A){var e=[];for(var t in this.properties)MA(this.properties,t)&&e.push(Wt(t)+": "+this.properties[t].toString(A));return"{"+e.join(", ")+"}"}},{key:"toJSON",value:function(){return{mathjs:mg,properties:this.properties}}},{key:"toHTML",value:function(A){var e=[];for(var t in this.properties)MA(this.properties,t)&&e.push('<span class="math-symbol math-property">'+Xt(t)+'</span><span class="math-operator math-assignment-operator math-property-assignment-operator math-binary-operator">:</span>'+this.properties[t].toHTML(A));return'<span class="math-parenthesis math-curly-parenthesis">{</span>'+e.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-curly-parenthesis">}</span>'}},{key:"_toTex",value:function(A){var e=[];for(var t in this.properties)MA(this.properties,t)&&e.push("\\mathbf{"+t+":} & "+this.properties[t].toTex(A)+"\\\\");return"\\left\\{\\begin{array}{ll}"+e.join("\n")+"\\end{array}\\right\\}"}}],[{key:"fromJSON",value:function(A){return new r(A.properties)}}]),r}(A.Node);return Ir(t,"name",mg),t}),{isClass:!0,isNode:!0}),Fg="OperatorNode",Dg=mA(Fg,["Node"],(function(A){function e(A,t){var n=A;if("auto"===t)for(;k(n);)n=n.content;return!!T(n)||!!v(n)&&e(n.args[0],t)}function t(A,t,n,i,r){var o,s=$c(A,t,n),a=Ag(A,t);if("all"===t||i.length>2&&"OperatorNode:add"!==A.getIdentifier()&&"OperatorNode:multiply"!==A.getIdentifier())return i.map((function(A){switch(A.getContent().type){case"ArrayNode":case"ConstantNode":case"SymbolNode":case"ParenthesisNode":return!1;default:return!0}}));switch(i.length){case 0:o=[];break;case 1:var B=$c(i[0],t,n,A);if(r&&null!==B){var c,g;if("keep"===t?(c=i[0].getIdentifier(),g=A.getIdentifier()):(c=i[0].getContent().getIdentifier(),g=A.getContent().getIdentifier()),!1===_c[s][g].latexLeftParens){o=[!1];break}if(!1===_c[B][c].latexParens){o=[!1];break}}if(null===B){o=[!1];break}if(B<=s){o=[!0];break}o=[!1];break;case 2:var E,Q,u=$c(i[0],t,n,A),l=eg(A,i[0],t);E=null!==u&&(u===s&&"right"===a&&!l||u<s);var w,h,C,I=$c(i[1],t,n,A),M=eg(A,i[1],t);Q=null!==I&&(I===s&&"left"===a&&!M||I<s),r&&("keep"===t?(w=A.getIdentifier(),h=A.args[0].getIdentifier(),C=A.args[1].getIdentifier()):(w=A.getContent().getIdentifier(),h=A.args[0].getContent().getIdentifier(),C=A.args[1].getContent().getIdentifier()),null!==u&&(!1===_c[s][w].latexLeftParens&&(E=!1),!1===_c[u][h].latexParens&&(E=!1)),null!==I&&(!1===_c[s][w].latexRightParens&&(Q=!1),!1===_c[I][C].latexParens&&(Q=!1))),o=[E,Q];break;default:"OperatorNode:add"!==A.getIdentifier()&&"OperatorNode:multiply"!==A.getIdentifier()||(o=i.map((function(e){var i=$c(e,t,n,A),r=eg(A,e,t),o=Ag(e,t);return null!==i&&(s===i&&a===o&&!r||i<s)})))}if(i.length>=2&&"OperatorNode:multiply"===A.getIdentifier()&&A.implicit&&"all"!==t&&"hide"===n)for(var d=1;d<o.length;++d)!e(i[d],t)||o[d-1]||"keep"===t&&k(i[d-1])||(o[d]=!0);return o}var n=function(A){Jc(r,A);var e,n,i=(e=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}(),function(){var A,t=Lc(e);if(n){var i=Lc(this).constructor;A=Reflect.construct(t,arguments,i)}else A=t.apply(this,arguments);return zc(this,A)});function r(A,e,t,n,o){var s;if(DA(this,r),s=i.call(this),"string"!=typeof A)throw new TypeError('string expected for parameter "op"');if("string"!=typeof e)throw new TypeError('string expected for parameter "fn"');if(!Array.isArray(t)||!t.every(H))throw new TypeError('Array containing Nodes expected for parameter "args"');return s.implicit=!0===n,s.isPercentage=!0===o,s.op=A,s.fn=e,s.args=t||[],s}return NA(r,[{key:"type",get:function(){return Fg}},{key:"isOperatorNode",get:function(){return!0}},{key:"_compile",value:function(A,e){if("string"!=typeof this.fn||!xA(A,this.fn))throw A[this.fn]?new Error('No access to function "'+this.fn+'"'):new Error("Function "+this.fn+' missing in provided namespace "math"');var t=UA(A,this.fn),n=En(this.args,(function(t){return t._compile(A,e)}));if(1===n.length){var i=n[0];return function(A,e,n){return t(i(A,e,n))}}if(2===n.length){var r=n[0],o=n[1];return function(A,e,n){return t(r(A,e,n),o(A,e,n))}}return function(A,e,i){return t.apply(null,En(n,(function(t){return t(A,e,i)})))}}},{key:"forEach",value:function(A){for(var e=0;e<this.args.length;e++)A(this.args[e],"args["+e+"]",this)}},{key:"map",value:function(A){for(var e=[],t=0;t<this.args.length;t++)e[t]=this._ifNode(A(this.args[t],"args["+t+"]",this));return new r(this.op,this.fn,e,this.implicit,this.isPercentage)}},{key:"clone",value:function(){return new r(this.op,this.fn,this.args.slice(0),this.implicit,this.isPercentage)}},{key:"isUnary",value:function(){return 1===this.args.length}},{key:"isBinary",value:function(){return 2===this.args.length}},{key:"_toString",value:function(A){var e=A&&A.parenthesis?A.parenthesis:"keep",n=A&&A.implicit?A.implicit:"hide",i=this.args,r=t(this,e,n,i,!1);if(1===i.length){var o=Ag(this,e),s=i[0].toString(A);r[0]&&(s="("+s+")");var a=/[a-zA-Z]+/.test(this.op);return"right"===o?this.op+(a?" ":"")+s:"left"===o?s+(a?" ":"")+this.op:s+this.op}if(2===i.length){var B=i[0].toString(A),c=i[1].toString(A);return r[0]&&(B="("+B+")"),r[1]&&(c="("+c+")"),this.implicit&&"OperatorNode:multiply"===this.getIdentifier()&&"hide"===n?B+" "+c:B+" "+this.op+" "+c}if(i.length>2&&("OperatorNode:add"===this.getIdentifier()||"OperatorNode:multiply"===this.getIdentifier())){var g=i.map((function(e,t){return e=e.toString(A),r[t]&&(e="("+e+")"),e}));return this.implicit&&"OperatorNode:multiply"===this.getIdentifier()&&"hide"===n?g.join(" "):g.join(" "+this.op+" ")}return this.fn+"("+this.args.join(", ")+")"}},{key:"toJSON",value:function(){return{mathjs:Fg,op:this.op,fn:this.fn,args:this.args,implicit:this.implicit,isPercentage:this.isPercentage}}},{key:"toHTML",value:function(A){var e=A&&A.parenthesis?A.parenthesis:"keep",n=A&&A.implicit?A.implicit:"hide",i=this.args,r=t(this,e,n,i,!1);if(1===i.length){var o=Ag(this,e),s=i[0].toHTML(A);return r[0]&&(s='<span class="math-parenthesis math-round-parenthesis">(</span>'+s+'<span class="math-parenthesis math-round-parenthesis">)</span>'),"right"===o?'<span class="math-operator math-unary-operator math-lefthand-unary-operator">'+Xt(this.op)+"</span>"+s:s+'<span class="math-operator math-unary-operator math-righthand-unary-operator">'+Xt(this.op)+"</span>"}if(2===i.length){var a=i[0].toHTML(A),B=i[1].toHTML(A);return r[0]&&(a='<span class="math-parenthesis math-round-parenthesis">(</span>'+a+'<span class="math-parenthesis math-round-parenthesis">)</span>'),r[1]&&(B='<span class="math-parenthesis math-round-parenthesis">(</span>'+B+'<span class="math-parenthesis math-round-parenthesis">)</span>'),this.implicit&&"OperatorNode:multiply"===this.getIdentifier()&&"hide"===n?a+'<span class="math-operator math-binary-operator math-implicit-binary-operator"></span>'+B:a+'<span class="math-operator math-binary-operator math-explicit-binary-operator">'+Xt(this.op)+"</span>"+B}var c=i.map((function(e,t){return e=e.toHTML(A),r[t]&&(e='<span class="math-parenthesis math-round-parenthesis">(</span>'+e+'<span class="math-parenthesis math-round-parenthesis">)</span>'),e}));return i.length>2&&("OperatorNode:add"===this.getIdentifier()||"OperatorNode:multiply"===this.getIdentifier())?this.implicit&&"OperatorNode:multiply"===this.getIdentifier()&&"hide"===n?c.join('<span class="math-operator math-binary-operator math-implicit-binary-operator"></span>'):c.join('<span class="math-operator math-binary-operator math-explicit-binary-operator">'+Xt(this.op)+"</span>"):'<span class="math-function">'+Xt(this.fn)+'</span><span class="math-paranthesis math-round-parenthesis">(</span>'+c.join('<span class="math-separator">,</span>')+'<span class="math-paranthesis math-round-parenthesis">)</span>'}},{key:"_toTex",value:function(A){var e=A&&A.parenthesis?A.parenthesis:"keep",n=A&&A.implicit?A.implicit:"hide",i=this.args,r=t(this,e,n,i,!0),o=cg[this.fn];if(o=void 0===o?this.op:o,1===i.length){var s=Ag(this,e),a=i[0].toTex(A);return r[0]&&(a="\\left(".concat(a,"\\right)")),"right"===s?o+a:a+o}if(2===i.length){var B=i[0],c=B.toTex(A);r[0]&&(c="\\left(".concat(c,"\\right)"));var g,E=i[1].toTex(A);switch(r[1]&&(E="\\left(".concat(E,"\\right)")),g="keep"===e?B.getIdentifier():B.getContent().getIdentifier(),this.getIdentifier()){case"OperatorNode:divide":return o+"{"+c+"}{"+E+"}";case"OperatorNode:pow":switch(c="{"+c+"}",E="{"+E+"}",g){case"ConditionalNode":case"OperatorNode:divide":c="\\left(".concat(c,"\\right)")}break;case"OperatorNode:multiply":if(this.implicit&&"hide"===n)return c+"~"+E}return c+o+E}if(i.length>2&&("OperatorNode:add"===this.getIdentifier()||"OperatorNode:multiply"===this.getIdentifier())){var Q=i.map((function(e,t){return e=e.toTex(A),r[t]&&(e="\\left(".concat(e,"\\right)")),e}));return"OperatorNode:multiply"===this.getIdentifier()&&this.implicit&&"hide"===n?Q.join("~"):Q.join(o)}return"\\mathrm{"+this.fn+"}\\left("+i.map((function(e){return e.toTex(A)})).join(",")+"\\right)"}},{key:"getIdentifier",value:function(){return this.type+":"+this.fn}}],[{key:"fromJSON",value:function(A){return new r(A.op,A.fn,A.args,A.implicit,A.isPercentage)}}]),r}(A.Node);return Ir(n,"name",Fg),n}),{isClass:!0,isNode:!0}),Yg="ParenthesisNode",fg=mA(Yg,["Node"],(function(A){var e=function(A){Jc(i,A);var e,t,n=(e=i,t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}(),function(){var A,n=Lc(e);if(t){var i=Lc(this).constructor;A=Reflect.construct(n,arguments,i)}else A=n.apply(this,arguments);return zc(this,A)});function i(A){var e;if(DA(this,i),e=n.call(this),!H(A))throw new TypeError('Node expected for parameter "content"');return e.content=A,e}return NA(i,[{key:"type",get:function(){return Yg}},{key:"isParenthesisNode",get:function(){return!0}},{key:"_compile",value:function(A,e){return this.content._compile(A,e)}},{key:"getContent",value:function(){return this.content.getContent()}},{key:"forEach",value:function(A){A(this.content,"content",this)}},{key:"map",value:function(A){return new i(A(this.content,"content",this))}},{key:"clone",value:function(){return new i(this.content)}},{key:"_toString",value:function(A){return!A||A&&!A.parenthesis||A&&"keep"===A.parenthesis?"("+this.content.toString(A)+")":this.content.toString(A)}},{key:"toJSON",value:function(){return{mathjs:Yg,content:this.content}}},{key:"toHTML",value:function(A){return!A||A&&!A.parenthesis||A&&"keep"===A.parenthesis?'<span class="math-parenthesis math-round-parenthesis">(</span>'+this.content.toHTML(A)+'<span class="math-parenthesis math-round-parenthesis">)</span>':this.content.toHTML(A)}},{key:"_toTex",value:function(A){return!A||A&&!A.parenthesis||A&&"keep"===A.parenthesis?"\\left(".concat(this.content.toTex(A),"\\right)"):this.content.toTex(A)}}],[{key:"fromJSON",value:function(A){return new i(A.content)}}]),i}(A.Node);return Ir(e,"name",Yg),e}),{isClass:!0,isNode:!0}),Ng="RangeNode",Ug=mA(Ng,["Node"],(function(A){function e(A,e,t){var n=$c(A,e,t),i={},r=$c(A.start,e,t);if(i.start=null!==r&&r<=n||"all"===e,A.step){var o=$c(A.step,e,t);i.step=null!==o&&o<=n||"all"===e}var s=$c(A.end,e,t);return i.end=null!==s&&s<=n||"all"===e,i}var t=function(A){Jc(r,A);var t,n,i=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}(),function(){var A,e=Lc(t);if(n){var i=Lc(this).constructor;A=Reflect.construct(e,arguments,i)}else A=e.apply(this,arguments);return zc(this,A)});function r(A,e,t){var n;if(DA(this,r),n=i.call(this),!H(A))throw new TypeError("Node expected");if(!H(e))throw new TypeError("Node expected");if(t&&!H(t))throw new TypeError("Node expected");if(arguments.length>3)throw new Error("Too many arguments");return n.start=A,n.end=e,n.step=t||null,n}return NA(r,[{key:"type",get:function(){return Ng}},{key:"isRangeNode",get:function(){return!0}},{key:"needsEnd",value:function(){return this.filter((function(A){return z(A)&&"end"===A.name})).length>0}},{key:"_compile",value:function(A,e){var t=A.range,n=this.start._compile(A,e),i=this.end._compile(A,e);if(this.step){var r=this.step._compile(A,e);return function(A,e,o){return t(n(A,e,o),i(A,e,o),r(A,e,o))}}return function(A,e,r){return t(n(A,e,r),i(A,e,r))}}},{key:"forEach",value:function(A){A(this.start,"start",this),A(this.end,"end",this),this.step&&A(this.step,"step",this)}},{key:"map",value:function(A){return new r(this._ifNode(A(this.start,"start",this)),this._ifNode(A(this.end,"end",this)),this.step&&this._ifNode(A(this.step,"step",this)))}},{key:"clone",value:function(){return new r(this.start,this.end,this.step&&this.step)}},{key:"_toString",value:function(A){var t,n=e(this,A&&A.parenthesis?A.parenthesis:"keep",A&&A.implicit),i=this.start.toString(A);if(n.start&&(i="("+i+")"),t=i,this.step){var r=this.step.toString(A);n.step&&(r="("+r+")"),t+=":"+r}var o=this.end.toString(A);return n.end&&(o="("+o+")"),t+":"+o}},{key:"toJSON",value:function(){return{mathjs:Ng,start:this.start,end:this.end,step:this.step}}},{key:"toHTML",value:function(A){var t,n=e(this,A&&A.parenthesis?A.parenthesis:"keep",A&&A.implicit),i=this.start.toHTML(A);if(n.start&&(i='<span class="math-parenthesis math-round-parenthesis">(</span>'+i+'<span class="math-parenthesis math-round-parenthesis">)</span>'),t=i,this.step){var r=this.step.toHTML(A);n.step&&(r='<span class="math-parenthesis math-round-parenthesis">(</span>'+r+'<span class="math-parenthesis math-round-parenthesis">)</span>'),t+='<span class="math-operator math-range-operator">:</span>'+r}var o=this.end.toHTML(A);return n.end&&(o='<span class="math-parenthesis math-round-parenthesis">(</span>'+o+'<span class="math-parenthesis math-round-parenthesis">)</span>'),t+'<span class="math-operator math-range-operator">:</span>'+o}},{key:"_toTex",value:function(A){var t=e(this,A&&A.parenthesis?A.parenthesis:"keep",A&&A.implicit),n=this.start.toTex(A);if(t.start&&(n="\\left(".concat(n,"\\right)")),this.step){var i=this.step.toTex(A);t.step&&(i="\\left(".concat(i,"\\right)")),n+=":"+i}var r=this.end.toTex(A);return t.end&&(r="\\left(".concat(r,"\\right)")),n+":"+r}}],[{key:"fromJSON",value:function(A){return new r(A.start,A.end,A.step)}}]),r}(A.Node);return Ir(t,"name",Ng),t}),{isClass:!0,isNode:!0}),yg="RelationalNode",Tg=mA(yg,["Node"],(function(A){var e=A.Node,t={equal:"==",unequal:"!=",smaller:"<",larger:">",smallerEq:"<=",largerEq:">="},n=function(A){Jc(r,A);var e,n,i=(e=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}(),function(){var A,t=Lc(e);if(n){var i=Lc(this).constructor;A=Reflect.construct(t,arguments,i)}else A=t.apply(this,arguments);return zc(this,A)});function r(A,e){var t;if(DA(this,r),t=i.call(this),!Array.isArray(A))throw new TypeError("Parameter conditionals must be an array");if(!Array.isArray(e))throw new TypeError("Parameter params must be an array");if(A.length!==e.length-1)throw new TypeError("Parameter params must contain exactly one more element than parameter conditionals");return t.conditionals=A,t.params=e,t}return NA(r,[{key:"type",get:function(){return yg}},{key:"isRelationalNode",get:function(){return!0}},{key:"_compile",value:function(A,e){var t=this,n=this.params.map((function(t){return t._compile(A,e)}));return function(e,i,r){for(var o,s=n[0](e,i,r),a=0;a<t.conditionals.length;a++)if(o=s,s=n[a+1](e,i,r),!UA(A,t.conditionals[a])(o,s))return!1;return!0}}},{key:"forEach",value:function(A){var e=this;this.params.forEach((function(t,n){return A(t,"params["+n+"]",e)}),this)}},{key:"map",value:function(A){var e=this;return new r(this.conditionals.slice(),this.params.map((function(t,n){return e._ifNode(A(t,"params["+n+"]",e))}),this))}},{key:"clone",value:function(){return new r(this.conditionals,this.params)}},{key:"_toString",value:function(A){for(var e=A&&A.parenthesis?A.parenthesis:"keep",n=$c(this,e,A&&A.implicit),i=this.params.map((function(t,i){var r=$c(t,e,A&&A.implicit);return"all"===e||null!==r&&r<=n?"("+t.toString(A)+")":t.toString(A)})),r=i[0],o=0;o<this.conditionals.length;o++)r+=" "+t[this.conditionals[o]],r+=" "+i[o+1];return r}},{key:"toJSON",value:function(){return{mathjs:yg,conditionals:this.conditionals,params:this.params}}},{key:"toHTML",value:function(A){for(var e=A&&A.parenthesis?A.parenthesis:"keep",n=$c(this,e,A&&A.implicit),i=this.params.map((function(t,i){var r=$c(t,e,A&&A.implicit);return"all"===e||null!==r&&r<=n?'<span class="math-parenthesis math-round-parenthesis">(</span>'+t.toHTML(A)+'<span class="math-parenthesis math-round-parenthesis">)</span>':t.toHTML(A)})),r=i[0],o=0;o<this.conditionals.length;o++)r+='<span class="math-operator math-binary-operator math-explicit-binary-operator">'+Xt(t[this.conditionals[o]])+"</span>"+i[o+1];return r}},{key:"_toTex",value:function(A){for(var e=A&&A.parenthesis?A.parenthesis:"keep",t=$c(this,e,A&&A.implicit),n=this.params.map((function(n,i){var r=$c(n,e,A&&A.implicit);return"all"===e||null!==r&&r<=t?"\\left("+n.toTex(A)+"\right)":n.toTex(A)})),i=n[0],r=0;r<this.conditionals.length;r++)i+=cg[this.conditionals[r]]+n[r+1];return i}}],[{key:"fromJSON",value:function(A){return new r(A.conditionals,A.params)}}]),r}(e);return Ir(n,"name",yg),n}),{isClass:!0,isNode:!0}),xg=mA("SymbolNode",["math","?Unit","Node"],(function(A){var e=A.math,t=A.Unit;function n(A){return!!t&&t.isValuelessUnit(A)}return function(A){Jc(s,A);var i,r,o=(i=s,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}(),function(){var A,e=Lc(i);if(r){var t=Lc(this).constructor;A=Reflect.construct(e,arguments,t)}else A=e.apply(this,arguments);return zc(this,A)});function s(A){var e;if(DA(this,s),e=o.call(this),"string"!=typeof A)throw new TypeError('String expected for parameter "name"');return e.name=A,e}return NA(s,[{key:"type",get:function(){return"SymbolNode"}},{key:"isSymbolNode",get:function(){return!0}},{key:"_compile",value:function(A,e){var i=this.name;if(!0===e[i])return function(A,e,t){return UA(e,i)};if(i in A)return function(e,t,n){return e.has(i)?e.get(i):UA(A,i)};var r=n(i);return function(A,e,n){return A.has(i)?A.get(i):r?new t(null,i):s.onUndefinedSymbol(i)}}},{key:"forEach",value:function(A){}},{key:"map",value:function(A){return this.clone()}},{key:"clone",value:function(){return new s(this.name)}},{key:"_toString",value:function(A){return this.name}},{key:"toHTML",value:function(A){var e=Xt(this.name);return"true"===e||"false"===e?'<span class="math-symbol math-boolean">'+e+"</span>":"i"===e?'<span class="math-symbol math-imaginary-symbol">'+e+"</span>":"Infinity"===e?'<span class="math-symbol math-infinity-symbol">'+e+"</span>":"NaN"===e?'<span class="math-symbol math-nan-symbol">'+e+"</span>":"null"===e?'<span class="math-symbol math-null-symbol">'+e+"</span>":"undefined"===e?'<span class="math-symbol math-undefined-symbol">'+e+"</span>":'<span class="math-symbol">'+e+"</span>"}},{key:"toJSON",value:function(){return{mathjs:"SymbolNode",name:this.name}}},{key:"_toTex",value:function(A){var t=!1;void 0===e[this.name]&&n(this.name)&&(t=!0);var i=ug(this.name,t);return"\\"===i[0]?i:" "+i}}],[{key:"onUndefinedSymbol",value:function(A){throw new Error("Undefined symbol "+A)}},{key:"fromJSON",value:function(A){return new s(A.name)}}]),s}(A.Node)}),{isClass:!0,isNode:!0});function Rg(){return(Rg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(A,e,t){var n=function(A,e){for(;!Object.prototype.hasOwnProperty.call(A,e)&&null!==(A=Lc(A)););return A}(A,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?A:t):i.value}}).apply(this,arguments)}function Gg(A){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return"function"==typeof A.createSubScope?zA.apply(void 0,[A.createSubScope()].concat(t)):zA.apply(void 0,[kA(),A].concat(t))}var Sg="FunctionNode",Hg=mA(Sg,["math","Node","SymbolNode"],(function(A){var t,n=A.math,i=A.Node,r=A.SymbolNode,o=function(A){return Vt(A,{truncate:78})};function s(A,t,n){for(var i,r="",o=/\$(?:\{([a-z_][a-z_0-9]*)(?:\[([0-9]+)\])?\}|\$)/gi,s=0;null!==(i=o.exec(A));)if(r+=A.substring(s,i.index),s=i.index,"$$"===i[0])r+="$",s++;else{s+=i[0].length;var a=t[i[1]];if(!a)throw new ReferenceError("Template: Property "+i[1]+" does not exist.");if(void 0===i[2])switch(e(a)){case"string":r+=a;break;case"object":if(H(a))r+=a.toTex(n);else{if(!Array.isArray(a))throw new TypeError("Template: "+i[1]+" has to be a Node, String or array of Nodes");r+=a.map((function(A,e){if(H(A))return A.toTex(n);throw new TypeError("Template: "+i[1]+"["+e+"] is not a Node.")})).join(",")}break;default:throw new TypeError("Template: "+i[1]+" has to be a Node, String or array of Nodes")}else{if(!H(a[i[2]]&&a[i[2]]))throw new TypeError("Template: "+i[1]+"["+i[2]+"] is not a Node.");r+=a[i[2]].toTex(n)}}return r+A.slice(s)}var a=function(A){Jc(B,A);var t,i,a=(t=B,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}(),function(){var A,e=Lc(t);if(i){var n=Lc(this).constructor;A=Reflect.construct(e,arguments,n)}else A=e.apply(this,arguments);return zc(this,A)});function B(A,e){var t;if(DA(this,B),t=a.call(this),"string"==typeof A&&(A=new r(A)),!H(A))throw new TypeError('Node expected as parameter "fn"');if(!Array.isArray(e)||!e.every(H))throw new TypeError('Array containing Nodes expected for parameter "args"');return t.fn=A,t.args=e||[],t}return NA(B,[{key:"name",get:function(){return this.fn.name||""}},{key:"type",get:function(){return Sg}},{key:"isFunctionNode",get:function(){return!0}},{key:"_compile",value:function(A,e){var t=this.args.map((function(t){return t._compile(A,e)}));if(!z(this.fn)){if(Y(this.fn)&&S(this.fn.index)&&this.fn.index.isObjectProperty()){var n=this.fn.object._compile(A,e),i=this.fn.index.getObjectProperty(),r=this.args;return function(e,o,s){var a=n(e,o,s),B=function(A,e){if(!xA(A,e))throw new Error('No access to method "'+e+'"');return A[e]}(a,i);if(null!=B&&B.rawArgs)return B(r,A,Gg(e,o),e);var c=t.map((function(A){return A(e,o,s)}));return B.apply(a,c)}}var s=this.fn.toString(),a=this.fn._compile(A,e),c=this.args;return function(e,n,i){var r=a(e,n,i);if("function"!=typeof r)throw new TypeError("Expression '".concat(s,"' did not evaluate to a function; value is:")+"\n  ".concat(o(r)));if(r.rawArgs)return r(c,A,Gg(e,n),e);var B=t.map((function(A){return A(e,n,i)}));return r.apply(r,B)}}var g=this.fn.name;if(e[g]){var E=this.args;return function(e,n,i){var r=UA(n,g);if("function"!=typeof r)throw new TypeError("Argument '".concat(g,"' was not a function; received: ").concat(o(r)));if(r.rawArgs)return r(E,A,Gg(e,n),e);var s=t.map((function(A){return A(e,n,i)}));return r.apply(r,s)}}var Q=g in A?UA(A,g):void 0,u="function"==typeof Q&&!0===Q.rawArgs,l=function(e){var t;if(e.has(g))t=e.get(g);else{if(!(g in A))return B.onUndefinedFunction(g);t=UA(A,g)}if("function"==typeof t)return t;throw new TypeError("'".concat(g,"' is not a function; its value is:\n  ").concat(o(t)))};if(u){var w=this.args;return function(e,t,n){return l(e)(w,A,Gg(e,t),e)}}switch(t.length){case 0:return function(A,e,t){return l(A)()};case 1:return function(A,e,n){return l(A)((0,t[0])(A,e,n))};case 2:return function(A,e,n){var i=l(A),r=t[0],o=t[1];return i(r(A,e,n),o(A,e,n))};default:return function(A,e,n){var i=l(A),r=t.map((function(t){return t(A,e,n)}));return i.apply(void 0,zt(r))}}}},{key:"forEach",value:function(A){A(this.fn,"fn",this);for(var e=0;e<this.args.length;e++)A(this.args[e],"args["+e+"]",this)}},{key:"map",value:function(A){for(var e=this._ifNode(A(this.fn,"fn",this)),t=[],n=0;n<this.args.length;n++)t[n]=this._ifNode(A(this.args[n],"args["+n+"]",this));return new B(e,t)}},{key:"clone",value:function(){return new B(this.fn,this.args.slice(0))}},{key:"toString",value:function(A){var t,n=this.fn.toString(A);return A&&"object"===e(A.handler)&&MA(A.handler,n)&&(t=A.handler[n](this,A)),void 0!==t?t:Rg(Lc(B.prototype),"toString",this).call(this,A)}},{key:"_toString",value:function(A){var e=this.args.map((function(e){return e.toString(A)}));return(R(this.fn)?"("+this.fn.toString(A)+")":this.fn.toString(A))+"("+e.join(", ")+")"}},{key:"toJSON",value:function(){return{mathjs:Sg,fn:this.fn,args:this.args}}},{key:"toHTML",value:function(A){var e=this.args.map((function(e){return e.toHTML(A)}));return'<span class="math-function">'+Xt(this.fn)+'</span><span class="math-paranthesis math-round-parenthesis">(</span>'+e.join('<span class="math-separator">,</span>')+'<span class="math-paranthesis math-round-parenthesis">)</span>'}},{key:"toTex",value:function(A){var t;return A&&"object"===e(A.handler)&&MA(A.handler,this.name)&&(t=A.handler[this.name](this,A)),void 0!==t?t:Rg(Lc(B.prototype),"toTex",this).call(this,A)}},{key:"_toTex",value:function(A){var t,i,r=this.args.map((function(e){return e.toTex(A)}));switch(gg[this.name]&&(t=gg[this.name]),!n[this.name]||"function"!=typeof n[this.name].toTex&&"object"!==e(n[this.name].toTex)&&"string"!=typeof n[this.name].toTex||(t=n[this.name].toTex),e(t)){case"function":i=t(this,A);break;case"string":i=s(t,this,A);break;case"object":switch(e(t[r.length])){case"function":i=t[r.length](this,A);break;case"string":i=s(t[r.length],this,A)}}return void 0!==i?i:s("\\mathrm{${name}}\\left(${args}\\right)",this,A)}},{key:"getIdentifier",value:function(){return this.type+":"+this.name}}]),B}(i);return t=a,Ir(a,"name",Sg),Ir(a,"onUndefinedFunction",(function(A){throw new Error("Undefined function "+A)})),Ir(a,"fromJSON",(function(A){return new t(A.fn,A.args)})),a}),{isClass:!0,isNode:!0}),bg=mA("parse",["typed","numeric","config","AccessorNode","ArrayNode","AssignmentNode","BlockNode","ConditionalNode","ConstantNode","FunctionAssignmentNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","ParenthesisNode","RangeNode","RelationalNode","SymbolNode"],(function(A){var e=A.typed,t=A.numeric,n=A.config,i=A.AccessorNode,r=A.ArrayNode,o=A.AssignmentNode,s=A.BlockNode,a=A.ConditionalNode,B=A.ConstantNode,c=A.FunctionAssignmentNode,g=A.FunctionNode,E=A.IndexNode,Q=A.ObjectNode,u=A.OperatorNode,l=A.ParenthesisNode,w=A.RangeNode,h=A.RelationalNode,C=A.SymbolNode,I=e("parse",{string:function(A){return V(A,{})},"Array | Matrix":function(A){return M(A,{})},"string, Object":function(A,e){return V(A,void 0!==e.nodes?e.nodes:{})},"Array | Matrix, Object":M});function M(A){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=void 0!==e.nodes?e.nodes:{};return Gn(A,(function(A){if("string"!=typeof A)throw new TypeError("String expected");return V(A,t)}))}var d=0,m=1,p=2,F=3,D=4,f={",":!0,"(":!0,")":!0,"[":!0,"]":!0,"{":!0,"}":!0,'"':!0,"'":!0,";":!0,"+":!0,"-":!0,"*":!0,".*":!0,"/":!0,"./":!0,"%":!0,"^":!0,".^":!0,"~":!0,"!":!0,"&":!0,"|":!0,"^|":!0,"=":!0,":":!0,"?":!0,"==":!0,"!=":!0,"<":!0,">":!0,"<=":!0,">=":!0,"<<":!0,">>":!0,">>>":!0},N={mod:!0,to:!0,in:!0,and:!0,xor:!0,or:!0,not:!0},U={true:!0,false:!1,null:null,undefined:void 0},y=["NaN","Infinity"],R={'"':'"',"'":"'","\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};function S(A,e){return A.expression.substr(A.index,e)}function H(A){return S(A,1)}function b(A){A.index++}function k(A){return A.expression.charAt(A.index-1)}function j(A){return A.expression.charAt(A.index+1)}function J(A){for(A.tokenType=d,A.token="",A.comment="";;){if("#"===H(A))for(;"\n"!==H(A)&&""!==H(A);)A.comment+=H(A),b(A);if(!I.isWhitespace(H(A),A.nestingLevel))break;b(A)}if(""!==H(A)){if("\n"===H(A)&&!A.nestingLevel)return A.tokenType=m,A.token=H(A),void b(A);var e=H(A),t=S(A,2),n=S(A,3);if(3===n.length&&f[n])return A.tokenType=m,A.token=n,b(A),b(A),void b(A);if(2===t.length&&f[t])return A.tokenType=m,A.token=t,b(A),void b(A);if(f[e])return A.tokenType=m,A.token=e,void b(A);if(I.isDigitDot(e)){A.tokenType=p;var i=S(A,2);if("0b"===i||"0o"===i||"0x"===i){for(A.token+=H(A),b(A),A.token+=H(A),b(A);I.isHexDigit(H(A));)A.token+=H(A),b(A);if("."===H(A))for(A.token+=".",b(A);I.isHexDigit(H(A));)A.token+=H(A),b(A);else if("i"===H(A))for(A.token+="i",b(A);I.isDigit(H(A));)A.token+=H(A),b(A);return}if("."===H(A)){if(A.token+=H(A),b(A),!I.isDigit(H(A)))return void(A.tokenType=m)}else{for(;I.isDigit(H(A));)A.token+=H(A),b(A);I.isDecimalMark(H(A),j(A))&&(A.token+=H(A),b(A))}for(;I.isDigit(H(A));)A.token+=H(A),b(A);if("E"===H(A)||"e"===H(A))if(I.isDigit(j(A))||"-"===j(A)||"+"===j(A)){if(A.token+=H(A),b(A),"+"!==H(A)&&"-"!==H(A)||(A.token+=H(A),b(A)),!I.isDigit(H(A)))throw QA(A,'Digit expected, got "'+H(A)+'"');for(;I.isDigit(H(A));)A.token+=H(A),b(A);if(I.isDecimalMark(H(A),j(A)))throw QA(A,'Digit expected, got "'+H(A)+'"')}else if("."===j(A))throw b(A),QA(A,'Digit expected, got "'+H(A)+'"')}else{if(!I.isAlpha(H(A),k(A),j(A))){for(A.tokenType=D;""!==H(A);)A.token+=H(A),b(A);throw QA(A,'Syntax error in part "'+A.token+'"')}for(;I.isAlpha(H(A),k(A),j(A))||I.isDigit(H(A));)A.token+=H(A),b(A);MA(N,A.token)?A.tokenType=m:A.tokenType=F}}else A.tokenType=m}function L(A){do{J(A)}while("\n"===A.token)}function P(A){A.nestingLevel++}function O(A){A.nestingLevel--}function V(A,e){var t={extraNodes:{},expression:"",comment:"",index:0,token:"",tokenType:d,nestingLevel:0,conditionalLevel:null};kt(t,{expression:A,extraNodes:e}),J(t);var n=function(A){var e,t,n=[];for(""!==A.token&&"\n"!==A.token&&";"!==A.token&&(e=W(A),A.comment&&(e.comment=A.comment));"\n"===A.token||";"===A.token;)0===n.length&&e&&(t=";"!==A.token,n.push({node:e,visible:t})),J(A),"\n"!==A.token&&";"!==A.token&&""!==A.token&&(e=W(A),A.comment&&(e.comment=A.comment),t=";"!==A.token,n.push({node:e,visible:t}));return n.length>0?new s(n):(e||(e=new B(void 0),A.comment&&(e.comment=A.comment)),e)}(t);if(""!==t.token)throw t.tokenType===m?uA(t,"Unexpected operator "+t.token):QA(t,'Unexpected part "'+t.token+'"');return n}function W(A){var e,t,n,i,r=function(A){for(var e=function(A){for(var e=K(A);"or"===A.token;)L(A),e=new u("or","or",[e,K(A)]);return e}(A);"?"===A.token;){var t=A.conditionalLevel;A.conditionalLevel=A.nestingLevel,L(A);var n=e,i=W(A);if(":"!==A.token)throw QA(A,"False part of conditional expression expected");A.conditionalLevel=null,L(A);var r=W(A);e=new a(n,i,r),A.conditionalLevel=t}return e}(A);if("="===A.token){if(z(r))return e=r.name,L(A),n=W(A),new o(new C(e),n);if(Y(r))return L(A),n=W(A),new o(r.object,r.index,n);if(G(r)&&z(r.fn)&&(i=!0,t=[],e=r.name,r.args.forEach((function(A,e){z(A)?t[e]=A.name:i=!1})),i))return L(A),n=W(A),new c(e,t,n);throw QA(A,"Invalid left hand side of assignment operator =")}return r}function K(A){for(var e=X(A);"xor"===A.token;)L(A),e=new u("xor","xor",[e,X(A)]);return e}function X(A){for(var e=Z(A);"and"===A.token;)L(A),e=new u("and","and",[e,Z(A)]);return e}function Z(A){for(var e=_(A);"|"===A.token;)L(A),e=new u("|","bitOr",[e,_(A)]);return e}function _(A){for(var e=q(A);"^|"===A.token;)L(A),e=new u("^|","bitXor",[e,q(A)]);return e}function q(A){for(var e=$(A);"&"===A.token;)L(A),e=new u("&","bitAnd",[e,$(A)]);return e}function $(A){for(var e=[AA(A)],t=[],n={"==":"equal","!=":"unequal","<":"smaller",">":"larger","<=":"smallerEq",">=":"largerEq"};MA(n,A.token);){var i={name:A.token,fn:n[A.token]};t.push(i),L(A),e.push(AA(A))}return 1===e.length?e[0]:2===e.length?new u(t[0].name,t[0].fn,e):new h(t.map((function(A){return A.fn})),e)}function AA(A){var e,t,n,i;e=eA(A);for(var r={"<<":"leftShift",">>":"rightArithShift",">>>":"rightLogShift"};MA(r,A.token);)n=r[t=A.token],L(A),i=[e,eA(A)],e=new u(t,n,i);return e}function eA(A){var e,t,n,i;e=tA(A);for(var r={to:"to",in:"to"};MA(r,A.token);)n=r[t=A.token],L(A),"in"===t&&""===A.token?e=new u("*","multiply",[e,new C("in")],!0):(i=[e,tA(A)],e=new u(t,n,i));return e}function tA(A){var e,t=[];if(e=":"===A.token?new B(1):nA(A),":"===A.token&&A.conditionalLevel!==A.nestingLevel){for(t.push(e);":"===A.token&&t.length<3;)L(A),")"===A.token||"]"===A.token||","===A.token||""===A.token?t.push(new C("end")):t.push(nA(A));e=3===t.length?new w(t[0],t[2],t[1]):new w(t[0],t[1])}return e}function nA(A){var e,t,n,i;e=iA(A);for(var r={"+":"add","-":"subtract"};MA(r,A.token);){n=r[t=A.token],L(A);var o=iA(A);i=o.isPercentage?[e,new u("*","multiply",[e,o])]:[e,o],e=new u(t,n,i)}return e}function iA(A){var e,t,n,i;t=e=rA(A);for(var r={"*":"multiply",".*":"dotMultiply","/":"divide","./":"dotDivide"};MA(r,A.token);)i=r[n=A.token],L(A),t=rA(A),e=new u(n,i,[e,t]);return e}function rA(A){var e,t;for(t=e=oA(A);A.tokenType===F||"in"===A.token&&T(e)||!(A.tokenType!==p||T(t)||v(t)&&"!"!==t.op)||"("===A.token;)t=oA(A),e=new u("*","multiply",[e,t],!0);return e}function oA(A){for(var e=sA(A),t=e,n=[];"/"===A.token&&x(t);){if(n.push(kt({},A)),L(A),A.tokenType!==p){kt(A,n.pop());break}if(n.push(kt({},A)),L(A),A.tokenType!==F&&"("!==A.token){n.pop(),kt(A,n.pop());break}kt(A,n.pop()),n.pop(),t=sA(A),e=new u("/","divide",[e,t])}return e}function sA(A){var e,t,n,i;e=aA(A);for(var r={"%":"mod",mod:"mod"};MA(r,A.token);)n=r[t=A.token],L(A),"%"===t&&A.tokenType===m&&"("!==A.token?e=new u("/","divide",[e,new B(100)],!1,!0):(i=[e,aA(A)],e=new u(t,n,i));return e}function aA(A){var e,i,o,s={"-":"unaryMinus","+":"unaryPlus","~":"bitNot",not:"not"};return MA(s,A.token)?(o=s[A.token],e=A.token,L(A),i=[aA(A)],new u(e,o,i)):function(A){var e,i,o,s;return e=function(A){var e,i,o;e=function(A){var e=[];if(A.tokenType===F&&MA(A.extraNodes,A.token)){var i=A.extraNodes[A.token];if(J(A),"("===A.token){if(e=[],P(A),J(A),")"!==A.token)for(e.push(W(A));","===A.token;)J(A),e.push(W(A));if(")"!==A.token)throw QA(A,"Parenthesis ) expected");O(A),J(A)}return new i(e)}return function(A){var e;return A.tokenType===F||A.tokenType===m&&A.token in N?(e=A.token,J(A),BA(A,MA(U,e)?new B(U[e]):-1!==y.indexOf(e)?new B(t(e,"number")):new C(e))):function(A){var e;return'"'===A.token||"'"===A.token?(e=cA(A,A.token),BA(A,new B(e))):function(A){var e,i,o,s;if("["===A.token){if(P(A),J(A),"]"!==A.token){var a=gA(A);if(";"===A.token){for(o=1,i=[a];";"===A.token;)J(A),i[o]=gA(A),o++;if("]"!==A.token)throw QA(A,"End of matrix ] expected");O(A),J(A),s=i[0].items.length;for(var c=1;c<o;c++)if(i[c].items.length!==s)throw uA(A,"Column dimensions mismatch ("+i[c].items.length+" !== "+s+")");e=new r(i)}else{if("]"!==A.token)throw QA(A,"End of matrix ] expected");O(A),J(A),e=a}}else O(A),J(A),e=new r([]);return BA(A,e)}return function(A){if("{"===A.token){var e;P(A);var i={};do{if(J(A),"}"!==A.token){if('"'===A.token||"'"===A.token)e=cA(A,A.token);else{if(!(A.tokenType===F||A.tokenType===m&&A.token in N))throw QA(A,"Symbol or string expected as object key");e=A.token,J(A)}if(":"!==A.token)throw QA(A,"Colon : expected after object key");J(A),i[e]=W(A)}}while(","===A.token);if("}"!==A.token)throw QA(A,"Comma , or bracket } expected after object value");return O(A),J(A),BA(A,new Q(i))}return function(A){var e;return A.tokenType===p?(e=A.token,J(A),new B(t(e,n.number))):function(A){var e;if("("===A.token){if(P(A),J(A),e=W(A),")"!==A.token)throw QA(A,"Parenthesis ) expected");return O(A),J(A),BA(A,e=new l(e))}return function(A){throw""===A.token?QA(A,"Unexpected end of expression"):QA(A,"Value expected")}(A)}(A)}(A)}(A)}(A)}(A)}(A)}(A);for(var s={"!":"factorial","'":"ctranspose"};MA(s,A.token);)o=s[i=A.token],J(A),e=BA(A,e=new u(i,o,[e]));return e}(A),("^"===A.token||".^"===A.token)&&(o="^"===(i=A.token)?"pow":"dotPow",L(A),s=[e,aA(A)],e=new u(i,o,s)),e}(A)}function BA(A,e,t){for(var n;!("("!==A.token&&"["!==A.token&&"."!==A.token||t&&-1===t.indexOf(A.token));)if(n=[],"("===A.token){if(!z(e)&&!Y(e))return e;if(P(A),J(A),")"!==A.token)for(n.push(W(A));","===A.token;)J(A),n.push(W(A));if(")"!==A.token)throw QA(A,"Parenthesis ) expected");O(A),J(A),e=new g(e,n)}else if("["===A.token){if(P(A),J(A),"]"!==A.token)for(n.push(W(A));","===A.token;)J(A),n.push(W(A));if("]"!==A.token)throw QA(A,"Parenthesis ] expected");O(A),J(A),e=new i(e,new E(n))}else{if(J(A),!(A.tokenType===F||A.tokenType===m&&A.token in N))throw QA(A,"Property name expected after dot");n.push(new B(A.token)),J(A),e=new i(e,new E(n,!0))}return e}function cA(A,e){for(var t="";""!==H(A)&&H(A)!==e;)if("\\"===H(A)){b(A);var n=H(A),i=R[n];if(void 0!==i)t+=i,A.index+=1;else{if("u"!==n)throw QA(A,"Bad escape character \\".concat(n));var r=A.expression.slice(A.index+1,A.index+5);if(!/^[0-9A-Fa-f]{4}$/.test(r))throw QA(A,"Invalid unicode character \\u".concat(r));t+=String.fromCharCode(parseInt(r,16)),A.index+=5}}else t+=H(A),b(A);if(J(A),A.token!==e)throw QA(A,"End of string ".concat(e," expected"));return J(A),t}function gA(A){for(var e=[W(A)],t=1;","===A.token;)J(A),e[t]=W(A),t++;return new r(e)}function EA(A){return A.index-A.token.length+1}function QA(A,e){var t=EA(A),n=new SyntaxError(e+" (char "+t+")");return n.char=t,n}function uA(A,e){var t=EA(A),n=new SyntaxError(e+" (char "+t+")");return n.char=t,n}return I.isAlpha=function(A,e,t){return I.isValidLatinOrGreek(A)||I.isValidMathSymbol(A,t)||I.isValidMathSymbol(e,A)},I.isValidLatinOrGreek=function(A){return/^[a-zA-Z_$\u00C0-\u02AF\u0370-\u03FF\u2100-\u214F]$/.test(A)},I.isValidMathSymbol=function(A,e){return/^[\uD835]$/.test(A)&&/^[\uDC00-\uDFFF]$/.test(e)&&/^[^\uDC55\uDC9D\uDCA0\uDCA1\uDCA3\uDCA4\uDCA7\uDCA8\uDCAD\uDCBA\uDCBC\uDCC4\uDD06\uDD0B\uDD0C\uDD15\uDD1D\uDD3A\uDD3F\uDD45\uDD47-\uDD49\uDD51\uDEA6\uDEA7\uDFCC\uDFCD]$/.test(e)},I.isWhitespace=function(A,e){return" "===A||"\t"===A||"\n"===A&&e>0},I.isDecimalMark=function(A,e){return"."===A&&"/"!==e&&"*"!==e&&"^"!==e},I.isDigitDot=function(A){return A>="0"&&A<="9"||"."===A},I.isDigit=function(A){return A>="0"&&A<="9"},I.isHexDigit=function(A){return A>="0"&&A<="9"||A>="a"&&A<="f"||A>="A"&&A<="F"},e.addConversion({from:"string",to:"Node",convert:I}),I})),vg="compile",kg=mA(vg,["typed","parse"],(function(A){var e=A.typed,t=A.parse;return e(vg,{string:function(A){return t(A).compile()},"Array | Matrix":function(A){return Gn(A,(function(A){return t(A).compile()}))}})})),jg="evaluate",Jg=mA(jg,["typed","parse"],(function(A){var e=A.typed,t=A.parse;return e(jg,{string:function(A){var e=kA();return t(A).compile().evaluate(e)},"string, Map | Object":function(A,e){return t(A).compile().evaluate(e)},"Array | Matrix":function(A){var e=kA();return Gn(A,(function(A){return t(A).compile().evaluate(e)}))},"Array | Matrix, Map | Object":function(A,e){return Gn(A,(function(A){return t(A).compile().evaluate(e)}))}})})),zg=mA("Parser",["evaluate"],(function(A){var e=A.evaluate;function t(){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");Object.defineProperty(this,"scope",{value:kA(),writable:!1})}return t.prototype.type="Parser",t.prototype.isParser=!0,t.prototype.evaluate=function(A){return e(A,this.scope)},t.prototype.get=function(A){if(this.scope.has(A))return this.scope.get(A)},t.prototype.getAll=function(){return function(A){if(A instanceof vA)return A.wrappedObject;var e,t={},n=HA(A.keys());try{for(n.s();!(e=n.n()).done;){var i=e.value;yA(t,i,A.get(i))}}catch(A){n.e(A)}finally{n.f()}return t}(this.scope)},t.prototype.getAllAsMap=function(){return this.scope},t.prototype.set=function(A,e){return this.scope.set(A,e),e},t.prototype.remove=function(A){this.scope.delete(A)},t.prototype.clear=function(){this.scope.clear()},t}),{isClass:!0}),Lg=mA("parser",["typed","Parser"],(function(A){var e=A.typed,t=A.Parser;return e("parser",{"":function(){return new t}})})),Pg=mA("lup",["typed","matrix","abs","addScalar","divideScalar","multiplyScalar","subtractScalar","larger","equalScalar","unaryMinus","DenseMatrix","SparseMatrix","Spa"],(function(A){var e=A.typed,t=A.matrix,n=A.abs,i=A.addScalar,r=A.divideScalar,o=A.multiplyScalar,s=A.subtractScalar,a=A.larger,B=A.equalScalar,c=A.unaryMinus,g=A.DenseMatrix,E=A.SparseMatrix,Q=A.Spa;return e("lup",{DenseMatrix:function(A){return u(A)},SparseMatrix:function(A){return function(A){var e,t,i,s=A._size[0],g=A._size[1],u=Math.min(s,g),l=A._values,w=A._index,h=A._ptr,C=[],I=[],M=[],d=[s,u],m=[],p=[],F=[],D=[u,g],Y=[],f=[];for(e=0;e<s;e++)Y[e]=e,f[e]=e;var N=function(){var A=new Q;t<s&&(M.push(C.length),C.push(1),I.push(t)),F.push(m.length);var g=h[t],u=h[t+1];for(i=g;i<u;i++)e=w[i],A.set(Y[e],l[i]);t>0&&A.forEach(0,t-1,(function(e,t){E._forEachRow(e,C,I,M,(function(n,i){n>e&&A.accumulate(n,c(o(i,t)))}))}));var N,U,y,T,x=t,R=A.get(t),G=n(R);A.forEach(t+1,s-1,(function(A,e){var t=n(e);a(t,G)&&(x=A,G=t,R=e)})),t!==x&&(E._swapRows(t,x,d[1],C,I,M),E._swapRows(t,x,D[1],m,p,F),A.swap(t,x),U=x,y=f[N=t],T=f[U],Y[y]=U,Y[T]=N,f[N]=T,f[U]=y),A.forEach(0,s-1,(function(A,e){A<=t?(m.push(e),p.push(A)):(e=r(e,R),B(e,0)||(C.push(e),I.push(A)))}))};for(t=0;t<g;t++)N();return F.push(m.length),M.push(C.length),{L:new E({values:C,index:I,ptr:M,size:d}),U:new E({values:m,index:p,ptr:F,size:D}),p:Y,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\nP: "+this.p}}}(A)},Array:function(A){var e=u(t(A));return{L:e.L.valueOf(),U:e.U.valueOf(),p:e.p}}});function u(A){var e,t,c,E=A._size[0],Q=A._size[1],u=Math.min(E,Q),l=uA(A._data),w=[],h=[E,u],C=[],I=[u,Q],M=[];for(e=0;e<E;e++)M[e]=e;for(t=0;t<Q;t++){if(t>0)for(e=0;e<E;e++){var d=Math.min(e,t),m=0;for(c=0;c<d;c++)m=i(m,o(l[e][c],l[c][t]));l[e][t]=s(l[e][t],m)}var p=t,F=0,D=0;for(e=t;e<E;e++){var Y=l[e][t],f=n(Y);a(f,F)&&(p=e,F=f,D=Y)}if(t!==p&&(M[t]=[M[p],M[p]=M[t]][0],g._swapRows(t,p,l)),t<E)for(e=t+1;e<E;e++){var N=l[e][t];B(N,0)||(l[e][t]=r(l[e][t],D))}}for(t=0;t<Q;t++)for(e=0;e<E;e++)0===t&&(e<Q&&(C[e]=[]),w[e]=[]),e<t?(e<Q&&(C[e][t]=l[e][t]),t<E&&(w[e][t]=0)):e!==t?(e<Q&&(C[e][t]=0),t<E&&(w[e][t]=l[e][t])):(e<Q&&(C[e][t]=l[e][t]),t<E&&(w[e][t]=1));var U=new g({data:w,size:h}),y=new g({data:C,size:I}),T=[];for(e=0,u=M.length;e<u;e++)T[M[e]]=e;return{L:U,U:y,p:T,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\nP: "+this.p}}}})),Og=mA("qr",["typed","matrix","zeros","identity","isZero","equal","sign","sqrt","conj","unaryMinus","addScalar","divideScalar","multiplyScalar","subtractScalar","complex"],(function(A){var e=A.typed,t=A.matrix,n=A.zeros,i=A.identity,r=A.isZero,o=A.equal,s=A.sign,a=A.sqrt,B=A.conj,c=A.unaryMinus,g=A.addScalar,E=A.divideScalar,Q=A.multiplyScalar,u=A.subtractScalar,l=A.complex;return kt(e("qr",{DenseMatrix:function(A){return h(A)},SparseMatrix:function(A){return function(A){throw new Error("qr not implemented for sparse matrices yet")}()},Array:function(A){var e=h(t(A));return{Q:e.Q.valueOf(),R:e.R.valueOf()}}}),{_denseQRimpl:w});function w(A){var e,t,l,w=A._size[0],h=A._size[1],C=i([w],"dense"),I=C._data,M=A.clone(),d=M._data,m=n([w],"");for(l=0;l<Math.min(h,w);++l){var p=d[l][l],F=c(o(p,0)?1:s(p)),D=B(F),Y=0;for(e=l;e<w;e++)Y=g(Y,Q(d[e][l],B(d[e][l])));var f=Q(F,a(Y));if(!r(f)){var N=u(p,f);for(m[l]=1,e=l+1;e<w;e++)m[e]=E(d[e][l],N);var U=c(B(E(N,f))),y=void 0;for(t=l;t<h;t++){for(y=0,e=l;e<w;e++)y=g(y,Q(B(m[e]),d[e][t]));for(y=Q(y,U),e=l;e<w;e++)d[e][t]=Q(u(d[e][t],Q(m[e],y)),D)}for(e=0;e<w;e++){for(y=0,t=l;t<w;t++)y=g(y,Q(I[e][t],m[t]));for(y=Q(y,U),t=l;t<w;++t)I[e][t]=E(u(I[e][t],Q(y,B(m[t]))),D)}}}return{Q:C,R:M,toString:function(){return"Q: "+this.Q.toString()+"\nR: "+this.R.toString()}}}function h(A){var e=w(A),t=e.R._data;if(A._data.length>0)for(var n="Complex"===t[0][0].type?l(0):0,i=0;i<t.length;++i)for(var r=0;r<i&&r<(t[0]||[]).length;++r)t[i][r]=n;return e}}));function Vg(A,e,t,n,i,r,o){var s=0;for(t[o]=A;s>=0;){var a=t[o+s],B=t[n+a];-1===B?(s--,r[e++]=a):(t[n+a]=t[i+B],t[o+ ++s]=B)}return e}function Wg(A){return-A-2}var Kg=mA("csAmd",["add","multiply","transpose"],(function(A){var e=A.add,t=A.multiply,n=A.transpose;return function(A,o){if(!o||A<=0||A>3)return null;var s=o._size,a=s[0],B=s[1],c=0,g=Math.max(16,10*Math.sqrt(B)),E=function(A,i,r,o,s){var a=n(i);if(1===A&&o===r)return e(i,a);if(2===A){for(var B=a._index,c=a._ptr,g=0,E=0;E<r;E++){var Q=c[E];if(c[E]=g,!(c[E+1]-Q>s))for(var u=c[E+1];Q<u;Q++)B[g++]=B[Q]}return c[r]=g,i=n(a),t(a,i)}return t(a,i)}(A,o,a,B,g=Math.min(B-2,g));!function(A,e,t){for(var n=A._values,i=A._index,r=A._ptr,o=A._size[1],s=0,a=0;a<o;a++){var B=r[a];for(r[a]=s;B<r[a+1];B++)e(i[B],a,n?n[B]:1,null)&&(i[s]=i[B],n&&(n[s]=n[B]),s++)}r[o]=s,i.splice(s,i.length-s),n&&n.splice(s,n.length-s)}(E,r);for(var Q,u,l,w,h,C,I,M,d,m,p,F,D,Y,f,N,U=E._index,y=E._ptr,T=y[B],x=[],R=[],G=B+1,S=2*(B+1),H=3*(B+1),b=4*(B+1),v=5*(B+1),k=6*(B+1),j=7*(B+1),J=x,z=function(A,e,t,n,r,o,s,a,B,c,g,E){for(var Q=0;Q<A;Q++)t[0+Q]=e[Q+1]-e[Q];t[0+A]=0;for(var u=0;u<=A;u++)t[r+u]=-1,o[u]=-1,t[s+u]=-1,t[a+u]=-1,t[B+u]=1,t[c+u]=1,t[g+u]=0,t[E+u]=t[0+u];var l=i(0,0,t,c,A);return t[g+A]=-2,e[A]=-1,t[c+A]=0,l}(B,y,R,0,H,J,S,j,G,k,b,v),L=function(A,e,t,n,i,r,o,s,a,B,c){for(var g=0,E=0;E<A;E++){var Q=t[n+E];if(0===Q)t[i+E]=-2,g++,e[E]=-1,t[r+E]=0;else if(Q>o)t[s+E]=0,t[i+E]=-1,g++,e[E]=Wg(A),t[s+A]++;else{var u=t[a+Q];-1!==u&&(B[u]=E),t[c+E]=t[a+Q],t[a+Q]=E}}return g}(B,y,R,v,b,k,g,G,H,J,S),P=0;L<B;){for(l=-1;P<B&&-1===(l=R[H+P]);P++);-1!==R[S+l]&&(J[R[S+l]]=-1),R[H+P]=R[S+l];var O=R[b+l],V=R[G+l];L+=V;var W=0;R[G+l]=-V;var K=y[l],X=0===O?K:T,Z=X;for(w=1;w<=O+1;w++){for(w>O?(C=l,I=K,M=R[0+l]-O):(I=y[C=U[K++]],M=R[0+C]),h=1;h<=M;h++)(d=R[G+(Q=U[I++])])<=0||(W+=d,R[G+Q]=-d,U[Z++]=Q,-1!==R[S+Q]&&(J[R[S+Q]]=J[Q]),-1!==J[Q]?R[S+J[Q]]=R[S+Q]:R[H+R[v+Q]]=R[S+Q]);C!==l&&(y[C]=Wg(l),R[k+C]=0)}for(0!==O&&(T=Z),R[v+l]=W,y[l]=X,R[0+l]=Z-X,R[b+l]=-2,z=i(z,c,R,k,B),m=X;m<Z;m++)if(!((p=R[b+(Q=U[m])])<=0)){var _=z-(d=-R[G+Q]);for(K=y[Q],F=y[Q]+p-1;K<=F;K++)R[k+(C=U[K])]>=z?R[k+C]-=d:0!==R[k+C]&&(R[k+C]=R[v+C]+_)}for(m=X;m<Z;m++){for(D=(F=y[Q=U[m]])+R[b+Q]-1,Y=F,f=0,N=0,K=F;K<=D;K++)if(0!==R[k+(C=U[K])]){var q=R[k+C]-z;q>0?(N+=q,U[Y++]=C,f+=C):(y[C]=Wg(l),R[k+C]=0)}R[b+Q]=Y-F+1;var $=Y,AA=F+R[0+Q];for(K=D+1;K<AA;K++){var eA=R[G+(u=U[K])];eA<=0||(N+=eA,U[Y++]=u,f+=u)}0===N?(y[Q]=Wg(l),W-=d=-R[G+Q],V+=d,L+=d,R[G+Q]=0,R[b+Q]=-1):(R[v+Q]=Math.min(R[v+Q],N),U[Y]=U[$],U[$]=U[F],U[F]=l,R[0+Q]=Y-F+1,f=(f<0?-f:f)%B,R[S+Q]=R[j+f],R[j+f]=Q,J[Q]=f)}for(R[v+l]=W,z=i(z+(c=Math.max(c,W)),c,R,k,B),m=X;m<Z;m++)if(!(R[G+(Q=U[m])]>=0))for(Q=R[j+(f=J[Q])],R[j+f]=-1;-1!==Q&&-1!==R[S+Q];Q=R[S+Q],z++){for(M=R[0+Q],p=R[b+Q],K=y[Q]+1;K<=y[Q]+M-1;K++)R[k+U[K]]=z;var tA=Q;for(u=R[S+Q];-1!==u;){var nA=R[0+u]===M&&R[b+u]===p;for(K=y[u]+1;nA&&K<=y[u]+M-1;K++)R[k+U[K]]!==z&&(nA=0);nA?(y[u]=Wg(Q),R[G+Q]+=R[G+u],R[G+u]=0,R[b+u]=-1,u=R[S+u],R[S+tA]=u):(tA=u,u=R[S+u])}}for(K=X,m=X;m<Z;m++)(d=-R[G+(Q=U[m])])<=0||(R[G+Q]=d,N=R[v+Q]+W-d,-1!==R[H+(N=Math.min(N,B-L-d))]&&(J[R[H+N]]=Q),R[S+Q]=R[H+N],J[Q]=-1,R[H+N]=Q,P=Math.min(P,N),R[v+Q]=N,U[K++]=Q);R[G+l]=V,0==(R[0+l]=K-X)&&(y[l]=-1,R[k+l]=0),0!==O&&(T=K)}for(Q=0;Q<B;Q++)y[Q]=Wg(y[Q]);for(u=0;u<=B;u++)R[H+u]=-1;for(u=B;u>=0;u--)R[G+u]>0||(R[S+u]=R[H+y[u]],R[H+y[u]]=u);for(C=B;C>=0;C--)R[G+C]<=0||-1!==y[C]&&(R[S+C]=R[H+y[C]],R[H+y[C]]=C);for(l=0,Q=0;Q<=B;Q++)-1===y[Q]&&(l=Vg(Q,l,R,H,S,x,k));return x.splice(x.length-1,1),x};function i(A,e,t,n,i){if(A<2||A+e<0){for(var r=0;r<i;r++)0!==t[n+r]&&(t[n+r]=1);A=2}return A}function r(A,e){return A!==e}}));function Xg(A,e,t,n,i,r,o){var s,a,B,c=0;if(A<=e||t[n+e]<=t[i+A])return-1;t[i+A]=t[n+e];var g=t[r+A];if(t[r+A]=e,-1===g)c=1,B=A;else{for(c=2,B=g;B!==t[o+B];B=t[o+B]);for(s=g;s!==B;s=a)a=t[o+s],t[o+s]=B}return{jleaf:c,q:B}}var Zg=mA("csCounts",["transpose"],(function(A){var e=A.transpose;return function(A,t,n,i){if(!A||!t||!n)return null;var r,o,s,a,B,c,g,E=A._size,Q=E[0],u=E[1],l=4*u+(i?u+Q+1:0),w=[],h=u,C=2*u,I=3*u,M=4*u,d=5*u+1;for(s=0;s<l;s++)w[s]=-1;var m=[],p=e(A),F=p._index,D=p._ptr;for(s=0;s<u;s++)for(m[o=n[s]]=-1===w[I+o]?1:0;-1!==o&&-1===w[I+o];o=t[o])w[I+o]=s;if(i){for(s=0;s<u;s++)w[n[s]]=s;for(r=0;r<Q;r++){for(s=u,c=D[r],g=D[r+1],B=c;B<g;B++)s=Math.min(s,w[F[B]]);w[d+r]=w[M+s],w[M+s]=r}}for(r=0;r<u;r++)w[0+r]=r;for(s=0;s<u;s++){for(-1!==t[o=n[s]]&&m[t[o]]--,a=i?w[M+s]:o;-1!==a;a=i?w[d+a]:-1)for(B=D[a];B<D[a+1];B++){var Y=Xg(r=F[B],o,w,I,h,C,0);Y.jleaf>=1&&m[o]++,2===Y.jleaf&&m[Y.q]--}-1!==t[o]&&(w[0+o]=t[o])}for(o=0;o<u;o++)-1!==t[o]&&(m[t[o]]+=m[o]);return m}})),_g=mA("csSqr",["add","multiply","transpose"],(function(A){var e=A.add,t=A.multiply,n=A.transpose,i=Kg({add:e,multiply:t,transpose:n}),r=Zg({transpose:n});return function(A,e,t){var n,o=e._ptr,s=e._size[1],a={};if(a.q=i(A,e),A&&!a.q)return null;if(t){var B=A?function(A,e,t,n){A._values;for(var i=A._index,r=A._ptr,o=A._size,s=A._datatype,a=o[0],B=o[1],c=null,g=[],E=[],Q=0,u=0;u<B;u++){E[u]=Q;for(var l=t?t[u]:u,w=r[l],h=r[l+1],C=w;C<h;C++){var I=i[C];g[Q]=I,Q++}}return E[B]=Q,A.createSparseMatrix({values:c,index:g,ptr:E,size:[a,B],datatype:s})}(e,0,a.q):e;a.parent=function(A,e){if(!A)return null;var t,n,i=A._index,r=A._ptr,o=A._size,s=o[0],a=o[1],B=[],c=[],g=a;for(t=0;t<s;t++)c[g+t]=-1;for(var E=0;E<a;E++){B[E]=-1,c[0+E]=-1;for(var Q=r[E],u=r[E+1],l=Q;l<u;l++){var w=i[l];for(t=c[g+w];-1!==t&&t<E;t=n)n=c[0+t],c[0+t]=E,-1===n&&(B[t]=E);c[g+w]=E}}return B}(B);var c=function(A,e){if(!A)return null;var t,n=0,i=[],r=[],o=e,s=2*e;for(t=0;t<e;t++)r[0+t]=-1;for(t=e-1;t>=0;t--)-1!==A[t]&&(r[o+t]=r[0+A[t]],r[0+A[t]]=t);for(t=0;t<e;t++)-1===A[t]&&(n=Vg(t,n,r,0,o,i,s));return i}(a.parent,s);if(a.cp=r(B,a.parent,c,1),B&&a.parent&&a.cp&&function(A,e){var t=A._ptr,n=A._index,i=A._size,r=i[0],o=i[1];e.pinv=[],e.leftmost=[];var s,a,B,c,g,E=e.parent,Q=e.pinv,u=e.leftmost,l=[],w=r,h=r+o,C=r+2*o;for(a=0;a<o;a++)l[w+a]=-1,l[h+a]=-1,l[C+a]=0;for(s=0;s<r;s++)u[s]=-1;for(a=o-1;a>=0;a--)for(c=t[a],g=t[a+1],B=c;B<g;B++)u[n[B]]=a;for(s=r-1;s>=0;s--)Q[s]=-1,-1!==(a=u[s])&&(0==l[C+a]++&&(l[h+a]=s),l[0+s]=l[w+a],l[w+a]=s);for(e.lnz=0,e.m2=r,a=0;a<o;a++)if(s=l[w+a],e.lnz++,s<0&&(s=e.m2++),Q[s]=a,!(--C[a]<=0)){e.lnz+=l[C+a];var I=E[a];-1!==I&&(0===l[C+I]&&(l[h+I]=l[h+a]),l[0+l[h+a]]=l[w+I],l[w+I]=l[0+s],l[C+I]+=l[C+a])}for(s=0;s<r;s++)Q[s]<0&&(Q[s]=a++);return!0}(B,a))for(a.unz=0,n=0;n<s;n++)a.unz+=a.cp[n]}else a.unz=4*o[s]+s,a.lnz=a.unz;return a}}));function qg(A,e){return A[e]<0}function $g(A,e){A[e]=Wg(A[e])}function AE(A){return A<0?Wg(A):A}function eE(A,e,t,n,i){var r,o,s,a=e._index,B=e._ptr,c=e._size[1],g=0;for(n[0]=A;g>=0;){A=n[g];var E=i?i[A]:A;qg(B,A)||($g(B,A),n[c+g]=E<0?0:AE(B[E]));var Q=1;for(o=n[c+g],s=E<0?0:AE(B[E+1]);o<s;o++)if(!qg(B,r=a[o])){n[c+g]=o,n[++g]=r,Q=0;break}Q&&(g--,n[--t]=A)}return t}var tE=mA("csSpsolve",["divideScalar","multiply","subtract"],(function(A){var e=A.divideScalar,t=A.multiply,n=A.subtract;return function(A,i,r,o,s,a,B){var c,g,E,Q,u=A._values,l=A._index,w=A._ptr,h=A._size[1],C=i._values,I=i._index,M=i._ptr,d=function(A,e,t,n,i){var r,o,s,a=A._ptr,B=A._size,c=e._index,g=e._ptr,E=B[1],Q=E;for(o=g[t],s=g[t+1],r=o;r<s;r++){var u=c[r];qg(a,u)||(Q=eE(u,A,Q,n,i))}for(r=Q;r<E;r++)$g(a,n[r]);return Q}(A,i,r,o,a);for(c=d;c<h;c++)s[o[c]]=0;for(g=M[r],E=M[r+1],c=g;c<E;c++)s[I[c]]=C[c];for(var m=d;m<h;m++){var p=o[m],F=a?a[p]:p;if(!(F<0))for(g=w[F],E=w[F+1],s[p]=e(s[p],u[B?g:E-1]),c=B?g+1:g,Q=B?E:E-1;c<Q;c++){var D=l[c];s[D]=n(s[D],t(u[c],s[p]))}}return d}})),nE=mA("csLu",["abs","divideScalar","multiply","subtract","larger","largerEq","SparseMatrix"],(function(A){var e=A.abs,t=A.divideScalar,n=A.multiply,i=A.subtract,r=A.larger,o=A.largerEq,s=A.SparseMatrix,a=tE({divideScalar:t,multiply:n,subtract:i});return function(A,i,B){if(!A)return null;var c,g=A._size[1],E=100,Q=100;i&&(c=i.q,E=i.lnz||E,Q=i.unz||Q);var u,l,w=[],h=[],C=[],I=new s({values:w,index:h,ptr:C,size:[g,g]}),M=[],d=[],m=[],p=new s({values:M,index:d,ptr:m,size:[g,g]}),F=[],D=[],Y=[];for(u=0;u<g;u++)D[u]=0,F[u]=-1,C[u+1]=0;E=0,Q=0;for(var f=0;f<g;f++){C[f]=E,m[f]=Q;var N=c?c[f]:f,U=a(I,A,N,Y,D,F,1),y=-1,T=-1;for(l=U;l<g;l++)if(F[u=Y[l]]<0){var x=e(D[u]);r(x,T)&&(T=x,y=u)}else d[Q]=F[u],M[Q++]=D[u];if(-1===y||T<=0)return null;F[N]<0&&o(e(D[N]),n(T,B))&&(y=N);var R=D[y];for(d[Q]=f,M[Q++]=R,F[y]=f,h[E]=y,w[E++]=1,l=U;l<g;l++)F[u=Y[l]]<0&&(h[E]=u,w[E++]=t(D[u],R)),D[u]=0}for(C[g]=E,m[g]=Q,l=0;l<E;l++)h[l]=F[h[l]];return w.splice(E,w.length-E),h.splice(E,h.length-E),M.splice(Q,M.length-Q),d.splice(Q,d.length-Q),{L:I,U:p,pinv:F}}})),iE=mA("slu",["typed","abs","add","multiply","transpose","divideScalar","subtract","larger","largerEq","SparseMatrix"],(function(A){var e=A.typed,t=A.abs,n=A.add,i=A.multiply,r=A.transpose,o=A.divideScalar,s=A.subtract,a=A.larger,B=A.largerEq,c=A.SparseMatrix,g=_g({add:n,multiply:i,transpose:r}),E=nE({abs:t,divideScalar:o,multiply:i,subtract:s,larger:a,largerEq:B,SparseMatrix:c});return e("slu",{"SparseMatrix, number, number":function(A,e,t){if(!V(e)||e<0||e>3)throw new Error("Symbolic Ordering and Analysis order must be an integer number in the interval [0, 3]");if(t<0||t>1)throw new Error("Partial pivoting threshold must be a number from 0 to 1");var n=g(e,A,!1),i=E(A,n,t);return{L:i.L,U:i.U,p:i.pinv,q:n.q,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\np: "+this.p.toString()+(this.q?"\nq: "+this.q.toString():"")+"\n"}}}})}));function rE(A,e){var t,n=e.length,i=[];if(A)for(t=0;t<n;t++)i[A[t]]=e[t];else for(t=0;t<n;t++)i[t]=e[t];return i}var oE="lusolve",sE=mA(oE,["typed","matrix","lup","slu","usolve","lsolve","DenseMatrix"],(function(A){var e=A.typed,t=A.matrix,n=A.lup,i=A.slu,r=A.usolve,o=A.lsolve,s=Ba({DenseMatrix:A.DenseMatrix});return e(oE,{"Array, Array | Matrix":function(A,e){A=t(A);var i=n(A);return B(i.L,i.U,i.p,null,e).valueOf()},"DenseMatrix, Array | Matrix":function(A,e){var t=n(A);return B(t.L,t.U,t.p,null,e)},"SparseMatrix, Array | Matrix":function(A,e){var t=n(A);return B(t.L,t.U,t.p,null,e)},"SparseMatrix, Array | Matrix, number, number":function(A,e,t,n){var r=i(A,t,n);return B(r.L,r.U,r.p,r.q,e)},"Object, Array | Matrix":function(A,e){return B(A.L,A.U,A.p,A.q,e)}});function a(A){if(g(A))return A;if(c(A))return t(A);throw new TypeError("Invalid Matrix LU decomposition")}function B(A,e,t,n,i){A=a(A),e=a(e),t&&((i=s(A,i,!0))._data=rE(t,i._data));var B=o(A,i),c=r(e,B);return n&&(c._data=rE(n,c._data)),c}})),aE="polynomialRoot",BE=mA(aE,["typed","isZero","equalScalar","add","subtract","multiply","divide","sqrt","unaryMinus","cbrt","typeOf","im","re"],(function(A){var e=A.typed,t=A.isZero,n=A.equalScalar,i=A.add,r=A.subtract,o=A.multiply,s=A.divide,a=A.sqrt,B=A.unaryMinus,c=A.cbrt,g=A.typeOf,E=A.im,Q=A.re;return e(aE,{"number|Complex, ...number|Complex":function(A,e){for(var u=[A].concat(zt(e));u.length>0&&t(u[u.length-1]);)u.pop();if(u.length<2)throw new RangeError("Polynomial [".concat(A,", ").concat(e,"] must have a non-zero non-constant coefficient"));switch(u.length){case 2:return[B(s(u[0],u[1]))];case 3:var l=ir(u,3),w=l[0],h=l[1],C=l[2],I=o(2,C),M=o(h,h),d=o(4,C,w);if(n(M,d))return[s(B(h),I)];var m=a(r(M,d));return[s(r(m,h),I),s(r(B(m),h),I)];case 4:var p=ir(u,4),F=p[0],D=p[1],Y=p[2],f=p[3],N=B(o(3,f)),U=o(Y,Y),y=o(3,f,D),T=i(o(2,Y,Y,Y),o(27,f,f,F)),x=o(9,f,Y,D);if(n(U,y)&&n(T,x))return[s(Y,N)];var R,G=r(U,y),S=r(T,x),H=i(o(18,f,Y,D,F),o(Y,Y,D,D)),b=i(o(4,Y,Y,Y,F),o(4,f,D,D,D),o(27,f,f,F,F));return n(H,b)?[s(r(o(4,f,Y,D),i(o(9,f,f,F),o(Y,Y,Y))),o(f,G)),s(r(o(9,f,F),o(Y,D)),o(2,G))]:(R=n(U,y)?S:s(i(S,a(r(o(S,S),o(4,G,G,G)))),2),c(R,!0).toArray().map((function(A){return s(i(Y,A,s(G,A)),N)})).map((function(A){return"Complex"===g(A)&&n(Q(A),Q(A)+E(A))?Q(A):A})));default:throw new RangeError("only implemented for cubic or lower-order polynomials, not ".concat(u))}}})})),cE=mA("Help",["parse"],(function(A){var e=A.parse;function t(A){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");if(!A)throw new Error('Argument "doc" missing');this.doc=A}return t.prototype.type="Help",t.prototype.isHelp=!0,t.prototype.toString=function(){var A=this.doc||{},t="\n";if(A.name&&(t+="Name: "+A.name+"\n\n"),A.category&&(t+="Category: "+A.category+"\n\n"),A.description&&(t+="Description:\n    "+A.description+"\n\n"),A.syntax&&(t+="Syntax:\n    "+A.syntax.join("\n    ")+"\n\n"),A.examples){t+="Examples:\n";for(var n={},i=0;i<A.examples.length;i++){var r=A.examples[i];t+="    "+r+"\n";var o=void 0;try{o=e(r).compile().evaluate(n)}catch(A){o=A}void 0===o||I(o)||(t+="        "+Vt(o,{precision:14})+"\n")}t+="\n"}return A.mayThrow&&A.mayThrow.length&&(t+="Throws: "+A.mayThrow.join(", ")+"\n\n"),A.seealso&&A.seealso.length&&(t+="See also: "+A.seealso.join(", ")+"\n"),t},t.prototype.toJSON=function(){var A=uA(this.doc);return A.mathjs="Help",A},t.fromJSON=function(A){var e={};return Object.keys(A).filter((function(A){return"mathjs"!==A})).forEach((function(t){e[t]=A[t]})),new t(e)},t.prototype.valueOf=t.prototype.toString,t}),{isClass:!0}),gE=mA("Chain",["?on","math","typed"],(function(A){var e=A.on,t=A.math,n=A.typed;function i(A){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");L(A)?this.value=A.value:this.value=A}function r(A,e){IA(i.prototype,A,(function(){var A=e();if("function"==typeof A)return o(A)}))}function o(A){return function(){if(0===arguments.length)return new i(A(this.value));for(var e=[this.value],t=0;t<arguments.length;t++)e[t+1]=arguments[t];if(n.isTypedFunction(A)){var r=n.resolve(A,e);if(1===r.params.length)throw new Error("chain function "+A.name+" cannot match rest parameter between chain value and additional arguments.");return new i(r.implementation.apply(A,e))}return new i(A.apply(A,e))}}i.prototype.type="Chain",i.prototype.isChain=!0,i.prototype.done=function(){return this.value},i.prototype.valueOf=function(){return this.value},i.prototype.toString=function(){return Vt(this.value)},i.prototype.toJSON=function(){return{mathjs:"Chain",value:this.value}},i.fromJSON=function(A){return new i(A.value)},i.createProxy=function(A,e){if("string"==typeof A)a=A,"function"==typeof(B=e)&&(i.prototype[a]=o(B));else{var t=function(e){MA(A,e)&&void 0===s[e]&&r(e,(function(){return A[e]}))};for(var n in A)t(n)}var a,B};var s={expression:!0,docs:!0,type:!0,classes:!0,json:!0,error:!0,isChain:!0};return i.createProxy(t),e&&e("import",(function(A,e,t){t||r(A,e)})),i}),{isClass:!0}),EE={name:"e",category:"Constants",syntax:["e"],description:"Euler's number, the base of the natural logarithm. Approximately equal to 2.71828",examples:["e","e ^ 2","exp(2)","log(e)"],seealso:["exp"]},QE={name:"pi",category:"Constants",syntax:["pi"],description:"The number pi is a mathematical constant that is the ratio of a circle's circumference to its diameter, and is approximately equal to 3.14159",examples:["pi","sin(pi/2)"],seealso:["tau"]},uE={bignumber:{name:"bignumber",category:"Construction",syntax:["bignumber(x)"],description:"Create a big number from a number or string.",examples:["0.1 + 0.2","bignumber(0.1) + bignumber(0.2)",'bignumber("7.2")','bignumber("7.2e500")',"bignumber([0.1, 0.2, 0.3])"],seealso:["boolean","complex","fraction","index","matrix","string","unit"]},boolean:{name:"boolean",category:"Construction",syntax:["x","boolean(x)"],description:"Convert a string or number into a boolean.",examples:["boolean(0)","boolean(1)","boolean(3)",'boolean("true")','boolean("false")',"boolean([1, 0, 1, 1])"],seealso:["bignumber","complex","index","matrix","number","string","unit"]},complex:{name:"complex",category:"Construction",syntax:["complex()","complex(re, im)","complex(string)"],description:"Create a complex number.",examples:["complex()","complex(2, 3)",'complex("7 - 2i")'],seealso:["bignumber","boolean","index","matrix","number","string","unit"]},createUnit:{name:"createUnit",category:"Construction",syntax:["createUnit(definitions)","createUnit(name, definition)"],description:"Create a user-defined unit and register it with the Unit type.",examples:['createUnit("foo")','createUnit("knot", {definition: "0.514444444 m/s", aliases: ["knots", "kt", "kts"]})','createUnit("mph", "1 mile/hour")'],seealso:["unit","splitUnit"]},fraction:{name:"fraction",category:"Construction",syntax:["fraction(num)","fraction(matrix)","fraction(num,den)","fraction({n: num, d: den})"],description:"Create a fraction from a number or from integer numerator and denominator.",examples:["fraction(0.125)","fraction(1, 3) + fraction(2, 5)","fraction({n: 333, d: 53})","fraction([sqrt(9), sqrt(10), sqrt(11)])"],seealso:["bignumber","boolean","complex","index","matrix","string","unit"]},index:{name:"index",category:"Construction",syntax:["[start]","[start:end]","[start:step:end]","[start1, start 2, ...]","[start1:end1, start2:end2, ...]","[start1:step1:end1, start2:step2:end2, ...]"],description:"Create an index to get or replace a subset of a matrix",examples:["A = [1, 2, 3; 4, 5, 6]","A[1, :]","A[1, 2] = 50","A[1:2, 1:2] = 1","B = [1, 2, 3]","B[B>1 and B<3]"],seealso:["bignumber","boolean","complex","matrix,","number","range","string","unit"]},matrix:{name:"matrix",category:"Construction",syntax:["[]","[a1, b1, ...; a2, b2, ...]","matrix()",'matrix("dense")',"matrix([...])"],description:"Create a matrix.",examples:["[]","[1, 2, 3]","[1, 2, 3; 4, 5, 6]","matrix()","matrix([3, 4])",'matrix([3, 4; 5, 6], "sparse")','matrix([3, 4; 5, 6], "sparse", "number")'],seealso:["bignumber","boolean","complex","index","number","string","unit","sparse"]},number:{name:"number",category:"Construction",syntax:["x","number(x)","number(unit, valuelessUnit)"],description:"Create a number or convert a string or boolean into a number.",examples:["2","2e3","4.05","number(2)",'number("7.2")',"number(true)","number([true, false, true, true])",'number(unit("52cm"), "m")'],seealso:["bignumber","boolean","complex","fraction","index","matrix","string","unit"]},sparse:{name:"sparse",category:"Construction",syntax:["sparse()","sparse([a1, b1, ...; a1, b2, ...])",'sparse([a1, b1, ...; a1, b2, ...], "number")'],description:"Create a sparse matrix.",examples:["sparse()","sparse([3, 4; 5, 6])",'sparse([3, 0; 5, 0], "number")'],seealso:["bignumber","boolean","complex","index","number","string","unit","matrix"]},splitUnit:{name:"splitUnit",category:"Construction",syntax:["splitUnit(unit: Unit, parts: Unit[])"],description:"Split a unit in an array of units whose sum is equal to the original unit.",examples:['splitUnit(1 m, ["feet", "inch"])'],seealso:["unit","createUnit"]},string:{name:"string",category:"Construction",syntax:['"text"',"string(x)"],description:"Create a string or convert a value to a string",examples:['"Hello World!"',"string(4.2)","string(3 + 2i)"],seealso:["bignumber","boolean","complex","index","matrix","number","unit"]},unit:{name:"unit",category:"Construction",syntax:["value unit","unit(value, unit)","unit(string)"],description:"Create a unit.",examples:["5.5 mm","3 inch",'unit(7.1, "kilogram")','unit("23 deg")'],seealso:["bignumber","boolean","complex","index","matrix","number","string"]},e:EE,E:EE,false:{name:"false",category:"Constants",syntax:["false"],description:"Boolean value false",examples:["false"],seealso:["true"]},i:{name:"i",category:"Constants",syntax:["i"],description:"Imaginary unit, defined as i*i=-1. A complex number is described as a + b*i, where a is the real part, and b is the imaginary part.",examples:["i","i * i","sqrt(-1)"],seealso:[]},Infinity:{name:"Infinity",category:"Constants",syntax:["Infinity"],description:"Infinity, a number which is larger than the maximum number that can be handled by a floating point number.",examples:["Infinity","1 / 0"],seealso:[]},LN2:{name:"LN2",category:"Constants",syntax:["LN2"],description:"Returns the natural logarithm of 2, approximately equal to 0.693",examples:["LN2","log(2)"],seealso:[]},LN10:{name:"LN10",category:"Constants",syntax:["LN10"],description:"Returns the natural logarithm of 10, approximately equal to 2.302",examples:["LN10","log(10)"],seealso:[]},LOG2E:{name:"LOG2E",category:"Constants",syntax:["LOG2E"],description:"Returns the base-2 logarithm of E, approximately equal to 1.442",examples:["LOG2E","log(e, 2)"],seealso:[]},LOG10E:{name:"LOG10E",category:"Constants",syntax:["LOG10E"],description:"Returns the base-10 logarithm of E, approximately equal to 0.434",examples:["LOG10E","log(e, 10)"],seealso:[]},NaN:{name:"NaN",category:"Constants",syntax:["NaN"],description:"Not a number",examples:["NaN","0 / 0"],seealso:[]},null:{name:"null",category:"Constants",syntax:["null"],description:"Value null",examples:["null"],seealso:["true","false"]},pi:QE,PI:QE,phi:{name:"phi",category:"Constants",syntax:["phi"],description:"Phi is the golden ratio. Two quantities are in the golden ratio if their ratio is the same as the ratio of their sum to the larger of the two quantities. Phi is defined as `(1 + sqrt(5)) / 2` and is approximately 1.618034...",examples:["phi"],seealso:[]},SQRT1_2:{name:"SQRT1_2",category:"Constants",syntax:["SQRT1_2"],description:"Returns the square root of 1/2, approximately equal to 0.707",examples:["SQRT1_2","sqrt(1/2)"],seealso:[]},SQRT2:{name:"SQRT2",category:"Constants",syntax:["SQRT2"],description:"Returns the square root of 2, approximately equal to 1.414",examples:["SQRT2","sqrt(2)"],seealso:[]},tau:{name:"tau",category:"Constants",syntax:["tau"],description:"Tau is the ratio constant of a circle's circumference to radius, equal to 2 * pi, approximately 6.2832.",examples:["tau","2 * pi"],seealso:["pi"]},true:{name:"true",category:"Constants",syntax:["true"],description:"Boolean value true",examples:["true"],seealso:["false"]},version:{name:"version",category:"Constants",syntax:["version"],description:"A string with the version number of math.js",examples:["version"],seealso:[]},speedOfLight:{description:"Speed of light in vacuum",examples:["speedOfLight"]},gravitationConstant:{description:"Newtonian constant of gravitation",examples:["gravitationConstant"]},planckConstant:{description:"Planck constant",examples:["planckConstant"]},reducedPlanckConstant:{description:"Reduced Planck constant",examples:["reducedPlanckConstant"]},magneticConstant:{description:"Magnetic constant (vacuum permeability)",examples:["magneticConstant"]},electricConstant:{description:"Electric constant (vacuum permeability)",examples:["electricConstant"]},vacuumImpedance:{description:"Characteristic impedance of vacuum",examples:["vacuumImpedance"]},coulomb:{description:"Coulomb's constant",examples:["coulomb"]},elementaryCharge:{description:"Elementary charge",examples:["elementaryCharge"]},bohrMagneton:{description:"Borh magneton",examples:["bohrMagneton"]},conductanceQuantum:{description:"Conductance quantum",examples:["conductanceQuantum"]},inverseConductanceQuantum:{description:"Inverse conductance quantum",examples:["inverseConductanceQuantum"]},magneticFluxQuantum:{description:"Magnetic flux quantum",examples:["magneticFluxQuantum"]},nuclearMagneton:{description:"Nuclear magneton",examples:["nuclearMagneton"]},klitzing:{description:"Von Klitzing constant",examples:["klitzing"]},bohrRadius:{description:"Borh radius",examples:["bohrRadius"]},classicalElectronRadius:{description:"Classical electron radius",examples:["classicalElectronRadius"]},electronMass:{description:"Electron mass",examples:["electronMass"]},fermiCoupling:{description:"Fermi coupling constant",examples:["fermiCoupling"]},fineStructure:{description:"Fine-structure constant",examples:["fineStructure"]},hartreeEnergy:{description:"Hartree energy",examples:["hartreeEnergy"]},protonMass:{description:"Proton mass",examples:["protonMass"]},deuteronMass:{description:"Deuteron Mass",examples:["deuteronMass"]},neutronMass:{description:"Neutron mass",examples:["neutronMass"]},quantumOfCirculation:{description:"Quantum of circulation",examples:["quantumOfCirculation"]},rydberg:{description:"Rydberg constant",examples:["rydberg"]},thomsonCrossSection:{description:"Thomson cross section",examples:["thomsonCrossSection"]},weakMixingAngle:{description:"Weak mixing angle",examples:["weakMixingAngle"]},efimovFactor:{description:"Efimov factor",examples:["efimovFactor"]},atomicMass:{description:"Atomic mass constant",examples:["atomicMass"]},avogadro:{description:"Avogadro's number",examples:["avogadro"]},boltzmann:{description:"Boltzmann constant",examples:["boltzmann"]},faraday:{description:"Faraday constant",examples:["faraday"]},firstRadiation:{description:"First radiation constant",examples:["firstRadiation"]},loschmidt:{description:"Loschmidt constant at T=273.15 K and p=101.325 kPa",examples:["loschmidt"]},gasConstant:{description:"Gas constant",examples:["gasConstant"]},molarPlanckConstant:{description:"Molar Planck constant",examples:["molarPlanckConstant"]},molarVolume:{description:"Molar volume of an ideal gas at T=273.15 K and p=101.325 kPa",examples:["molarVolume"]},sackurTetrode:{description:"Sackur-Tetrode constant at T=1 K and p=101.325 kPa",examples:["sackurTetrode"]},secondRadiation:{description:"Second radiation constant",examples:["secondRadiation"]},stefanBoltzmann:{description:"Stefan-Boltzmann constant",examples:["stefanBoltzmann"]},wienDisplacement:{description:"Wien displacement law constant",examples:["wienDisplacement"]},molarMass:{description:"Molar mass constant",examples:["molarMass"]},molarMassC12:{description:"Molar mass constant of carbon-12",examples:["molarMassC12"]},gravity:{description:"Standard acceleration of gravity (standard acceleration of free-fall on Earth)",examples:["gravity"]},planckLength:{description:"Planck length",examples:["planckLength"]},planckMass:{description:"Planck mass",examples:["planckMass"]},planckTime:{description:"Planck time",examples:["planckTime"]},planckCharge:{description:"Planck charge",examples:["planckCharge"]},planckTemperature:{description:"Planck temperature",examples:["planckTemperature"]},derivative:{name:"derivative",category:"Algebra",syntax:["derivative(expr, variable)","derivative(expr, variable, {simplify: boolean})"],description:"Takes the derivative of an expression expressed in parser Nodes. The derivative will be taken over the supplied variable in the second parameter. If there are multiple variables in the expression, it will return a partial derivative.",examples:['derivative("2x^3", "x")','derivative("2x^3", "x", {simplify: false})','derivative("2x^2 + 3x + 4", "x")','derivative("sin(2x)", "x")','f = parse("x^2 + x")','x = parse("x")',"df = derivative(f, x)","df.evaluate({x: 3})"],seealso:["simplify","parse","evaluate"]},lsolve:{name:"lsolve",category:"Algebra",syntax:["x=lsolve(L, b)"],description:"Finds one solution of the linear system L * x = b where L is an [n x n] lower triangular matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lsolve(a, b)"],seealso:["lsolveAll","lup","lusolve","usolve","matrix","sparse"]},lsolveAll:{name:"lsolveAll",category:"Algebra",syntax:["x=lsolveAll(L, b)"],description:"Finds all solutions of the linear system L * x = b where L is an [n x n] lower triangular matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lsolve(a, b)"],seealso:["lsolve","lup","lusolve","usolve","matrix","sparse"]},lup:{name:"lup",category:"Algebra",syntax:["lup(m)"],description:"Calculate the Matrix LU decomposition with partial pivoting. Matrix A is decomposed in three matrices (L, U, P) where P * A = L * U",examples:["lup([[2, 1], [1, 4]])","lup(matrix([[2, 1], [1, 4]]))","lup(sparse([[2, 1], [1, 4]]))"],seealso:["lusolve","lsolve","usolve","matrix","sparse","slu","qr"]},lusolve:{name:"lusolve",category:"Algebra",syntax:["x=lusolve(A, b)","x=lusolve(lu, b)"],description:"Solves the linear system A * x = b where A is an [n x n] matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lusolve(a, b)"],seealso:["lup","slu","lsolve","usolve","matrix","sparse"]},leafCount:{name:"leafCount",category:"Algebra",syntax:["leafCount(expr)"],description:"Computes the number of leaves in the parse tree of the given expression",examples:['leafCount("e^(i*pi)-1")','leafCount(parse("{a: 22/7, b: 10^(1/2)}"))'],seealso:["simplify"]},polynomialRoot:{name:"polynomialRoot",category:"Algebra",syntax:["x=polynomialRoot(-6, 3)","x=polynomialRoot(4, -4, 1)","x=polynomialRoot(-8, 12, -6, 1)"],description:"Finds the roots of a univariate polynomial given by its coefficients starting from constant, linear, and so on, increasing in degree.",examples:["a = polynomialRoot(-6, 11, -6, 1)"],seealso:["cbrt","sqrt"]},resolve:{name:"resolve",category:"Algebra",syntax:["resolve(node, scope)"],description:"Recursively substitute variables in an expression tree.",examples:['resolve(parse("1 + x"), { x: 7 })','resolve(parse("size(text)"), { text: "Hello World" })','resolve(parse("x + y"), { x: parse("3z") })','resolve(parse("3x"), { x: parse("y+z"), z: parse("w^y") })'],seealso:["simplify","evaluate"],mayThrow:["ReferenceError"]},simplify:{name:"simplify",category:"Algebra",syntax:["simplify(expr)","simplify(expr, rules)"],description:"Simplify an expression tree.",examples:['simplify("3 + 2 / 4")','simplify("2x + x")','f = parse("x * (x + 2 + x)")',"simplified = simplify(f)","simplified.evaluate({x: 2})"],seealso:["simplifyCore","derivative","evaluate","parse","rationalize","resolve"]},simplifyConstant:{name:"simplifyConstant",category:"Algebra",syntax:["simplifyConstant(expr)","simplifyConstant(expr, options)"],description:"Replace constant subexpressions of node with their values.",examples:['simplifyConstant("(3-3)*x")','simplifyConstant(parse("z-cos(tau/8)"))'],seealso:["simplify","simplifyCore","evaluate"]},simplifyCore:{name:"simplifyCore",category:"Algebra",syntax:["simplifyCore(node)"],description:"Perform simple one-pass simplifications on an expression tree.",examples:['simplifyCore(parse("0*x"))','simplifyCore(parse("(x+0)*2"))'],seealso:["simplify","simplifyConstant","evaluate"]},symbolicEqual:{name:"symbolicEqual",category:"Algebra",syntax:["symbolicEqual(expr1, expr2)","symbolicEqual(expr1, expr2, options)"],description:"Returns true if the difference of the expressions simplifies to 0",examples:['symbolicEqual("x*y","y*x")','symbolicEqual("abs(x^2)", "x^2")','symbolicEqual("abs(x)", "x", {context: {abs: {trivial: true}}})'],seealso:["simplify","evaluate"]},rationalize:{name:"rationalize",category:"Algebra",syntax:["rationalize(expr)","rationalize(expr, scope)","rationalize(expr, scope, detailed)"],description:"Transform a rationalizable expression in a rational fraction. If rational fraction is one variable polynomial then converts the numerator and denominator in canonical form, with decreasing exponents, returning the coefficients of numerator.",examples:['rationalize("2x/y - y/(x+1)")','rationalize("2x/y - y/(x+1)", true)'],seealso:["simplify"]},slu:{name:"slu",category:"Algebra",syntax:["slu(A, order, threshold)"],description:"Calculate the Matrix LU decomposition with full pivoting. Matrix A is decomposed in two matrices (L, U) and two permutation vectors (pinv, q) where P * A * Q = L * U",examples:["slu(sparse([4.5, 0, 3.2, 0; 3.1, 2.9, 0, 0.9; 0, 1.7, 3, 0; 3.5, 0.4, 0, 1]), 1, 0.001)"],seealso:["lusolve","lsolve","usolve","matrix","sparse","lup","qr"]},usolve:{name:"usolve",category:"Algebra",syntax:["x=usolve(U, b)"],description:"Finds one solution of the linear system U * x = b where U is an [n x n] upper triangular matrix and b is a [n] column vector.",examples:["x=usolve(sparse([1, 1, 1, 1; 0, 1, 1, 1; 0, 0, 1, 1; 0, 0, 0, 1]), [1; 2; 3; 4])"],seealso:["usolveAll","lup","lusolve","lsolve","matrix","sparse"]},usolveAll:{name:"usolveAll",category:"Algebra",syntax:["x=usolve(U, b)"],description:"Finds all solutions of the linear system U * x = b where U is an [n x n] upper triangular matrix and b is a [n] column vector.",examples:["x=usolve(sparse([1, 1, 1, 1; 0, 1, 1, 1; 0, 0, 1, 1; 0, 0, 0, 1]), [1; 2; 3; 4])"],seealso:["usolve","lup","lusolve","lsolve","matrix","sparse"]},qr:{name:"qr",category:"Algebra",syntax:["qr(A)"],description:"Calculates the Matrix QR decomposition. Matrix `A` is decomposed in two matrices (`Q`, `R`) where `Q` is an orthogonal matrix and `R` is an upper triangular matrix.",examples:["qr([[1, -1,  4], [1,  4, -2], [1,  4,  2], [1,  -1, 0]])"],seealso:["lup","slu","matrix"]},abs:{name:"abs",category:"Arithmetic",syntax:["abs(x)"],description:"Compute the absolute value.",examples:["abs(3.5)","abs(-4.2)"],seealso:["sign"]},add:{name:"add",category:"Operators",syntax:["x + y","add(x, y)"],description:"Add two values.",examples:["a = 2.1 + 3.6","a - 3.6","3 + 2i","3 cm + 2 inch",'"2.3" + "4"'],seealso:["subtract"]},cbrt:{name:"cbrt",category:"Arithmetic",syntax:["cbrt(x)","cbrt(x, allRoots)"],description:"Compute the cubic root value. If x = y * y * y, then y is the cubic root of x. When `x` is a number or complex number, an optional second argument `allRoots` can be provided to return all three cubic roots. If not provided, the principal root is returned",examples:["cbrt(64)","cube(4)","cbrt(-8)","cbrt(2 + 3i)","cbrt(8i)","cbrt(8i, true)","cbrt(27 m^3)"],seealso:["square","sqrt","cube","multiply"]},ceil:{name:"ceil",category:"Arithmetic",syntax:["ceil(x)"],description:"Round a value towards plus infinity. If x is complex, both real and imaginary part are rounded towards plus infinity.",examples:["ceil(3.2)","ceil(3.8)","ceil(-4.2)"],seealso:["floor","fix","round"]},cube:{name:"cube",category:"Arithmetic",syntax:["cube(x)"],description:"Compute the cube of a value. The cube of x is x * x * x.",examples:["cube(2)","2^3","2 * 2 * 2"],seealso:["multiply","square","pow"]},divide:{name:"divide",category:"Operators",syntax:["x / y","divide(x, y)"],description:"Divide two values.",examples:["a = 2 / 3","a * 3","4.5 / 2","3 + 4 / 2","(3 + 4) / 2","18 km / 4.5"],seealso:["multiply"]},dotDivide:{name:"dotDivide",category:"Operators",syntax:["x ./ y","dotDivide(x, y)"],description:"Divide two values element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","b = [2, 1, 1; 3, 2, 5]","a ./ b"],seealso:["multiply","dotMultiply","divide"]},dotMultiply:{name:"dotMultiply",category:"Operators",syntax:["x .* y","dotMultiply(x, y)"],description:"Multiply two values element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","b = [2, 1, 1; 3, 2, 5]","a .* b"],seealso:["multiply","divide","dotDivide"]},dotPow:{name:"dotPow",category:"Operators",syntax:["x .^ y","dotPow(x, y)"],description:"Calculates the power of x to y element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","a .^ 2"],seealso:["pow"]},exp:{name:"exp",category:"Arithmetic",syntax:["exp(x)"],description:"Calculate the exponent of a value.",examples:["exp(1.3)","e ^ 1.3","log(exp(1.3))","x = 2.4","(exp(i*x) == cos(x) + i*sin(x))   # Euler's formula"],seealso:["expm","expm1","pow","log"]},expm:{name:"expm",category:"Arithmetic",syntax:["exp(x)"],description:"Compute the matrix exponential, expm(A) = e^A. The matrix must be square. Not to be confused with exp(a), which performs element-wise exponentiation.",examples:["expm([[0,2],[0,0]])"],seealso:["exp"]},expm1:{name:"expm1",category:"Arithmetic",syntax:["expm1(x)"],description:"Calculate the value of subtracting 1 from the exponential value.",examples:["expm1(2)","pow(e, 2) - 1","log(expm1(2) + 1)"],seealso:["exp","pow","log"]},fix:{name:"fix",category:"Arithmetic",syntax:["fix(x)"],description:"Round a value towards zero. If x is complex, both real and imaginary part are rounded towards zero.",examples:["fix(3.2)","fix(3.8)","fix(-4.2)","fix(-4.8)"],seealso:["ceil","floor","round"]},floor:{name:"floor",category:"Arithmetic",syntax:["floor(x)"],description:"Round a value towards minus infinity.If x is complex, both real and imaginary part are rounded towards minus infinity.",examples:["floor(3.2)","floor(3.8)","floor(-4.2)"],seealso:["ceil","fix","round"]},gcd:{name:"gcd",category:"Arithmetic",syntax:["gcd(a, b)","gcd(a, b, c, ...)"],description:"Compute the greatest common divisor.",examples:["gcd(8, 12)","gcd(-4, 6)","gcd(25, 15, -10)"],seealso:["lcm","xgcd"]},hypot:{name:"hypot",category:"Arithmetic",syntax:["hypot(a, b, c, ...)","hypot([a, b, c, ...])"],description:"Calculate the hypotenusa of a list with values. ",examples:["hypot(3, 4)","sqrt(3^2 + 4^2)","hypot(-2)","hypot([3, 4, 5])"],seealso:["abs","norm"]},lcm:{name:"lcm",category:"Arithmetic",syntax:["lcm(x, y)"],description:"Compute the least common multiple.",examples:["lcm(4, 6)","lcm(6, 21)","lcm(6, 21, 5)"],seealso:["gcd"]},log:{name:"log",category:"Arithmetic",syntax:["log(x)","log(x, base)"],description:"Compute the logarithm of a value. If no base is provided, the natural logarithm of x is calculated. If base if provided, the logarithm is calculated for the specified base. log(x, base) is defined as log(x) / log(base).",examples:["log(3.5)","a = log(2.4)","exp(a)","10 ^ 4","log(10000, 10)","log(10000) / log(10)","b = log(1024, 2)","2 ^ b"],seealso:["exp","log1p","log2","log10"]},log2:{name:"log2",category:"Arithmetic",syntax:["log2(x)"],description:"Calculate the 2-base of a value. This is the same as calculating `log(x, 2)`.",examples:["log2(0.03125)","log2(16)","log2(16) / log2(2)","pow(2, 4)"],seealso:["exp","log1p","log","log10"]},log1p:{name:"log1p",category:"Arithmetic",syntax:["log1p(x)","log1p(x, base)"],description:"Calculate the logarithm of a `value+1`",examples:["log1p(2.5)","exp(log1p(1.4))","pow(10, 4)","log1p(9999, 10)","log1p(9999) / log(10)"],seealso:["exp","log","log2","log10"]},log10:{name:"log10",category:"Arithmetic",syntax:["log10(x)"],description:"Compute the 10-base logarithm of a value.",examples:["log10(0.00001)","log10(10000)","10 ^ 4","log(10000) / log(10)","log(10000, 10)"],seealso:["exp","log"]},mod:{name:"mod",category:"Operators",syntax:["x % y","x mod y","mod(x, y)"],description:"Calculates the modulus, the remainder of an integer division.",examples:["7 % 3","11 % 2","10 mod 4","isOdd(x) = x % 2","isOdd(2)","isOdd(3)"],seealso:["divide"]},multiply:{name:"multiply",category:"Operators",syntax:["x * y","multiply(x, y)"],description:"multiply two values.",examples:["a = 2.1 * 3.4","a / 3.4","2 * 3 + 4","2 * (3 + 4)","3 * 2.1 km"],seealso:["divide"]},norm:{name:"norm",category:"Arithmetic",syntax:["norm(x)","norm(x, p)"],description:"Calculate the norm of a number, vector or matrix.",examples:["abs(-3.5)","norm(-3.5)","norm(3 - 4i)","norm([1, 2, -3], Infinity)","norm([1, 2, -3], -Infinity)","norm([3, 4], 2)","norm([[1, 2], [3, 4]], 1)",'norm([[1, 2], [3, 4]], "inf")','norm([[1, 2], [3, 4]], "fro")']},nthRoot:{name:"nthRoot",category:"Arithmetic",syntax:["nthRoot(a)","nthRoot(a, root)"],description:'Calculate the nth root of a value. The principal nth root of a positive real number A, is the positive real solution of the equation "x^root = A".',examples:["4 ^ 3","nthRoot(64, 3)","nthRoot(9, 2)","sqrt(9)"],seealso:["nthRoots","pow","sqrt"]},nthRoots:{name:"nthRoots",category:"Arithmetic",syntax:["nthRoots(A)","nthRoots(A, root)"],description:'Calculate the nth roots of a value. An nth root of a positive real number A, is a positive real solution of the equation "x^root = A". This function returns an array of complex values.',examples:["nthRoots(1)","nthRoots(1, 3)"],seealso:["sqrt","pow","nthRoot"]},pow:{name:"pow",category:"Operators",syntax:["x ^ y","pow(x, y)"],description:"Calculates the power of x to y, x^y.",examples:["2^3","2*2*2","1 + e ^ (pi * i)","pow([[1, 2], [4, 3]], 2)","pow([[1, 2], [4, 3]], -1)"],seealso:["multiply","nthRoot","nthRoots","sqrt"]},round:{name:"round",category:"Arithmetic",syntax:["round(x)","round(x, n)"],description:"round a value towards the nearest integer.If x is complex, both real and imaginary part are rounded towards the nearest integer. When n is specified, the value is rounded to n decimals.",examples:["round(3.2)","round(3.8)","round(-4.2)","round(-4.8)","round(pi, 3)","round(123.45678, 2)"],seealso:["ceil","floor","fix"]},sign:{name:"sign",category:"Arithmetic",syntax:["sign(x)"],description:"Compute the sign of a value. The sign of a value x is 1 when x>1, -1 when x<0, and 0 when x=0.",examples:["sign(3.5)","sign(-4.2)","sign(0)"],seealso:["abs"]},sqrt:{name:"sqrt",category:"Arithmetic",syntax:["sqrt(x)"],description:"Compute the square root value. If x = y * y, then y is the square root of x.",examples:["sqrt(25)","5 * 5","sqrt(-1)"],seealso:["square","sqrtm","multiply","nthRoot","nthRoots","pow"]},sqrtm:{name:"sqrtm",category:"Arithmetic",syntax:["sqrtm(x)"],description:"Calculate the principal square root of a square matrix. The principal square root matrix `X` of another matrix `A` is such that `X * X = A`.",examples:["sqrtm([[33, 24], [48, 57]])"],seealso:["sqrt","abs","square","multiply"]},square:{name:"square",category:"Arithmetic",syntax:["square(x)"],description:"Compute the square of a value. The square of x is x * x.",examples:["square(3)","sqrt(9)","3^2","3 * 3"],seealso:["multiply","pow","sqrt","cube"]},subtract:{name:"subtract",category:"Operators",syntax:["x - y","subtract(x, y)"],description:"subtract two values.",examples:["a = 5.3 - 2","a + 2","2/3 - 1/6","2 * 3 - 3","2.1 km - 500m"],seealso:["add"]},unaryMinus:{name:"unaryMinus",category:"Operators",syntax:["-x","unaryMinus(x)"],description:"Inverse the sign of a value. Converts booleans and strings to numbers.",examples:["-4.5","-(-5.6)",'-"22"'],seealso:["add","subtract","unaryPlus"]},unaryPlus:{name:"unaryPlus",category:"Operators",syntax:["+x","unaryPlus(x)"],description:"Converts booleans and strings to numbers.",examples:["+true",'+"2"'],seealso:["add","subtract","unaryMinus"]},xgcd:{name:"xgcd",category:"Arithmetic",syntax:["xgcd(a, b)"],description:"Calculate the extended greatest common divisor for two values. The result is an array [d, x, y] with 3 entries, where d is the greatest common divisor, and d = x * a + y * b.",examples:["xgcd(8, 12)","gcd(8, 12)","xgcd(36163, 21199)"],seealso:["gcd","lcm"]},invmod:{name:"invmod",category:"Arithmetic",syntax:["invmod(a, b)"],description:"Calculate the (modular) multiplicative inverse of a modulo b. Solution to the equation ax  1 (mod b)",examples:["invmod(8, 12)","invmod(7, 13)","invmod(15151, 15122)"],seealso:["gcd","xgcd"]},bitAnd:{name:"bitAnd",category:"Bitwise",syntax:["x & y","bitAnd(x, y)"],description:"Bitwise AND operation. Performs the logical AND operation on each pair of the corresponding bits of the two given values by multiplying them. If both bits in the compared position are 1, the bit in the resulting binary representation is 1, otherwise, the result is 0",examples:["5 & 3","bitAnd(53, 131)","[1, 12, 31] & 42"],seealso:["bitNot","bitOr","bitXor","leftShift","rightArithShift","rightLogShift"]},bitNot:{name:"bitNot",category:"Bitwise",syntax:["~x","bitNot(x)"],description:"Bitwise NOT operation. Performs a logical negation on each bit of the given value. Bits that are 0 become 1, and those that are 1 become 0.",examples:["~1","~2","bitNot([2, -3, 4])"],seealso:["bitAnd","bitOr","bitXor","leftShift","rightArithShift","rightLogShift"]},bitOr:{name:"bitOr",category:"Bitwise",syntax:["x | y","bitOr(x, y)"],description:"Bitwise OR operation. Performs the logical inclusive OR operation on each pair of corresponding bits of the two given values. The result in each position is 1 if the first bit is 1 or the second bit is 1 or both bits are 1, otherwise, the result is 0.",examples:["5 | 3","bitOr([1, 2, 3], 4)"],seealso:["bitAnd","bitNot","bitXor","leftShift","rightArithShift","rightLogShift"]},bitXor:{name:"bitXor",category:"Bitwise",syntax:["bitXor(x, y)"],description:"Bitwise XOR operation, exclusive OR. Performs the logical exclusive OR operation on each pair of corresponding bits of the two given values. The result in each position is 1 if only the first bit is 1 or only the second bit is 1, but will be 0 if both are 0 or both are 1.",examples:["bitOr(1, 2)","bitXor([2, 3, 4], 4)"],seealso:["bitAnd","bitNot","bitOr","leftShift","rightArithShift","rightLogShift"]},leftShift:{name:"leftShift",category:"Bitwise",syntax:["x << y","leftShift(x, y)"],description:"Bitwise left logical shift of a value x by y number of bits.",examples:["4 << 1","8 >> 1"],seealso:["bitAnd","bitNot","bitOr","bitXor","rightArithShift","rightLogShift"]},rightArithShift:{name:"rightArithShift",category:"Bitwise",syntax:["x >> y","rightArithShift(x, y)"],description:"Bitwise right arithmetic shift of a value x by y number of bits.",examples:["8 >> 1","4 << 1","-12 >> 2"],seealso:["bitAnd","bitNot","bitOr","bitXor","leftShift","rightLogShift"]},rightLogShift:{name:"rightLogShift",category:"Bitwise",syntax:["x >>> y","rightLogShift(x, y)"],description:"Bitwise right logical shift of a value x by y number of bits.",examples:["8 >>> 1","4 << 1","-12 >>> 2"],seealso:["bitAnd","bitNot","bitOr","bitXor","leftShift","rightArithShift"]},bellNumbers:{name:"bellNumbers",category:"Combinatorics",syntax:["bellNumbers(n)"],description:"The Bell Numbers count the number of partitions of a set. A partition is a pairwise disjoint subset of S whose union is S. `bellNumbers` only takes integer arguments. The following condition must be enforced: n >= 0.",examples:["bellNumbers(3)","bellNumbers(8)"],seealso:["stirlingS2"]},catalan:{name:"catalan",category:"Combinatorics",syntax:["catalan(n)"],description:"The Catalan Numbers enumerate combinatorial structures of many different types. catalan only takes integer arguments. The following condition must be enforced: n >= 0.",examples:["catalan(3)","catalan(8)"],seealso:["bellNumbers"]},composition:{name:"composition",category:"Combinatorics",syntax:["composition(n, k)"],description:"The composition counts of n into k parts. composition only takes integer arguments. The following condition must be enforced: k <= n.",examples:["composition(5, 3)"],seealso:["combinations"]},stirlingS2:{name:"stirlingS2",category:"Combinatorics",syntax:["stirlingS2(n, k)"],description:"he Stirling numbers of the second kind, counts the number of ways to partition a set of n labelled objects into k nonempty unlabelled subsets. `stirlingS2` only takes integer arguments. The following condition must be enforced: k <= n. If n = k or k = 1, then s(n,k) = 1.",examples:["stirlingS2(5, 3)"],seealso:["bellNumbers"]},config:{name:"config",category:"Core",syntax:["config()","config(options)"],description:"Get configuration or change configuration.",examples:["config()","1/3 + 1/4",'config({number: "Fraction"})',"1/3 + 1/4"],seealso:[]},import:{name:"import",category:"Core",syntax:["import(functions)","import(functions, options)"],description:"Import functions or constants from an object.",examples:["import({myFn: f(x)=x^2, myConstant: 32 })","myFn(2)","myConstant"],seealso:[]},typed:{name:"typed",category:"Core",syntax:["typed(signatures)","typed(name, signatures)"],description:"Create a typed function.",examples:['double = typed({ "number": f(x)=x+x, "string": f(x)=concat(x,x) })',"double(2)",'double("hello")'],seealso:[]},arg:{name:"arg",category:"Complex",syntax:["arg(x)"],description:"Compute the argument of a complex value. If x = a+bi, the argument is computed as atan2(b, a).",examples:["arg(2 + 2i)","atan2(3, 2)","arg(2 + 3i)"],seealso:["re","im","conj","abs"]},conj:{name:"conj",category:"Complex",syntax:["conj(x)"],description:"Compute the complex conjugate of a complex value. If x = a+bi, the complex conjugate is a-bi.",examples:["conj(2 + 3i)","conj(2 - 3i)","conj(-5.2i)"],seealso:["re","im","abs","arg"]},re:{name:"re",category:"Complex",syntax:["re(x)"],description:"Get the real part of a complex number.",examples:["re(2 + 3i)","im(2 + 3i)","re(-5.2i)","re(2.4)"],seealso:["im","conj","abs","arg"]},im:{name:"im",category:"Complex",syntax:["im(x)"],description:"Get the imaginary part of a complex number.",examples:["im(2 + 3i)","re(2 + 3i)","im(-5.2i)","im(2.4)"],seealso:["re","conj","abs","arg"]},evaluate:{name:"evaluate",category:"Expression",syntax:["evaluate(expression)","evaluate(expression, scope)","evaluate([expr1, expr2, expr3, ...])","evaluate([expr1, expr2, expr3, ...], scope)"],description:"Evaluate an expression or an array with expressions.",examples:['evaluate("2 + 3")','evaluate("sqrt(16)")','evaluate("2 inch to cm")','evaluate("sin(x * pi)", { "x": 1/2 })','evaluate(["width=2", "height=4","width*height"])'],seealso:[]},help:{name:"help",category:"Expression",syntax:["help(object)","help(string)"],description:"Display documentation on a function or data type.",examples:["help(sqrt)",'help("complex")'],seealso:[]},distance:{name:"distance",category:"Geometry",syntax:["distance([x1, y1], [x2, y2])","distance([[x1, y1], [x2, y2]])"],description:"Calculates the Euclidean distance between two points.",examples:["distance([0,0], [4,4])","distance([[0,0], [4,4]])"],seealso:[]},intersect:{name:"intersect",category:"Geometry",syntax:["intersect(expr1, expr2, expr3, expr4)","intersect(expr1, expr2, expr3)"],description:"Computes the intersection point of lines and/or planes.",examples:["intersect([0, 0], [10, 10], [10, 0], [0, 10])","intersect([1, 0, 1],  [4, -2, 2], [1, 1, 1, 6])"],seealso:[]},and:{name:"and",category:"Logical",syntax:["x and y","and(x, y)"],description:"Logical and. Test whether two values are both defined with a nonzero/nonempty value.",examples:["true and false","true and true","2 and 4"],seealso:["not","or","xor"]},not:{name:"not",category:"Logical",syntax:["not x","not(x)"],description:"Logical not. Flips the boolean value of given argument.",examples:["not true","not false","not 2","not 0"],seealso:["and","or","xor"]},or:{name:"or",category:"Logical",syntax:["x or y","or(x, y)"],description:"Logical or. Test if at least one value is defined with a nonzero/nonempty value.",examples:["true or false","false or false","0 or 4"],seealso:["not","and","xor"]},xor:{name:"xor",category:"Logical",syntax:["x xor y","xor(x, y)"],description:"Logical exclusive or, xor. Test whether one and only one value is defined with a nonzero/nonempty value.",examples:["true xor false","false xor false","true xor true","0 xor 4"],seealso:["not","and","or"]},concat:{name:"concat",category:"Matrix",syntax:["concat(A, B, C, ...)","concat(A, B, C, ..., dim)"],description:"Concatenate matrices. By default, the matrices are concatenated by the last dimension. The dimension on which to concatenate can be provided as last argument.",examples:["A = [1, 2; 5, 6]","B = [3, 4; 7, 8]","concat(A, B)","concat(A, B, 1)","concat(A, B, 2)"],seealso:["det","diag","identity","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},count:{name:"count",category:"Matrix",syntax:["count(x)"],description:"Count the number of elements of a matrix, array or string.",examples:["a = [1, 2; 3, 4; 5, 6]","count(a)","size(a)",'count("hello world")'],seealso:["size"]},cross:{name:"cross",category:"Matrix",syntax:["cross(A, B)"],description:"Calculate the cross product for two vectors in three dimensional space.",examples:["cross([1, 1, 0],  [0, 1, 1])","cross([3, -3, 1], [4, 9, 2])","cross([2, 3, 4],  [5, 6, 7])"],seealso:["multiply","dot"]},column:{name:"column",category:"Matrix",syntax:["column(x, index)"],description:"Return a column from a matrix or array.",examples:["A = [[1, 2], [3, 4]]","column(A, 1)","column(A, 2)"],seealso:["row","matrixFromColumns"]},ctranspose:{name:"ctranspose",category:"Matrix",syntax:["x'","ctranspose(x)"],description:"Complex Conjugate and Transpose a matrix",examples:["a = [1, 2, 3; 4, 5, 6]","a'","ctranspose(a)"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","trace","zeros"]},det:{name:"det",category:"Matrix",syntax:["det(x)"],description:"Calculate the determinant of a matrix",examples:["det([1, 2; 3, 4])","det([-2, 2, 3; -1, 1, 3; 2, 0, -1])"],seealso:["concat","diag","identity","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},diag:{name:"diag",category:"Matrix",syntax:["diag(x)","diag(x, k)"],description:"Create a diagonal matrix or retrieve the diagonal of a matrix. When x is a vector, a matrix with the vector values on the diagonal will be returned. When x is a matrix, a vector with the diagonal values of the matrix is returned. When k is provided, the k-th diagonal will be filled in or retrieved, if k is positive, the values are placed on the super diagonal. When k is negative, the values are placed on the sub diagonal.",examples:["diag(1:3)","diag(1:3, 1)","a = [1, 2, 3; 4, 5, 6; 7, 8, 9]","diag(a)"],seealso:["concat","det","identity","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},diff:{name:"diff",category:"Matrix",syntax:["diff(arr)","diff(arr, dim)"],description:["Create a new matrix or array with the difference of the passed matrix or array.","Dim parameter is optional and used to indicant the dimension of the array/matrix to apply the difference","If no dimension parameter is passed it is assumed as dimension 0","Dimension is zero-based in javascript and one-based in the parser","Arrays must be 'rectangular' meaning arrays like [1, 2]","If something is passed as a matrix it will be returned as a matrix but other than that all matrices are converted to arrays"],examples:["A = [1, 2, 4, 7, 0]","diff(A)","diff(A, 1)","B = [[1, 2], [3, 4]]","diff(B)","diff(B, 1)","diff(B, 2)","diff(B, bignumber(2))","diff([[1, 2], matrix([3, 4])], 2)"],seealso:["subtract","partitionSelect"]},dot:{name:"dot",category:"Matrix",syntax:["dot(A, B)","A * B"],description:"Calculate the dot product of two vectors. The dot product of A = [a1, a2, a3, ..., an] and B = [b1, b2, b3, ..., bn] is defined as dot(A, B) = a1 * b1 + a2 * b2 + a3 * b3 + ... + an * bn",examples:["dot([2, 4, 1], [2, 2, 3])","[2, 4, 1] * [2, 2, 3]"],seealso:["multiply","cross"]},getMatrixDataType:{name:"getMatrixDataType",category:"Matrix",syntax:["getMatrixDataType(x)"],description:'Find the data type of all elements in a matrix or array, for example "number" if all items are a number and "Complex" if all values are complex numbers. If a matrix contains more than one data type, it will return "mixed".',examples:["getMatrixDataType([1, 2, 3])","getMatrixDataType([[5 cm], [2 inch]])",'getMatrixDataType([1, "text"])',"getMatrixDataType([1, bignumber(4)])"],seealso:["matrix","sparse","typeOf"]},identity:{name:"identity",category:"Matrix",syntax:["identity(n)","identity(m, n)","identity([m, n])"],description:"Returns the identity matrix with size m-by-n. The matrix has ones on the diagonal and zeros elsewhere.",examples:["identity(3)","identity(3, 5)","a = [1, 2, 3; 4, 5, 6]","identity(size(a))"],seealso:["concat","det","diag","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},filter:{name:"filter",category:"Matrix",syntax:["filter(x, test)"],description:"Filter items in a matrix.",examples:["isPositive(x) = x > 0","filter([6, -2, -1, 4, 3], isPositive)","filter([6, -2, 0, 1, 0], x != 0)"],seealso:["sort","map","forEach"]},flatten:{name:"flatten",category:"Matrix",syntax:["flatten(x)"],description:"Flatten a multi dimensional matrix into a single dimensional matrix.",examples:["a = [1, 2, 3; 4, 5, 6]","size(a)","b = flatten(a)","size(b)"],seealso:["concat","resize","size","squeeze"]},forEach:{name:"forEach",category:"Matrix",syntax:["forEach(x, callback)"],description:"Iterates over all elements of a matrix/array, and executes the given callback function.",examples:["numberOfPets = {}","addPet(n) = numberOfPets[n] = (numberOfPets[n] ? numberOfPets[n]:0 ) + 1;",'forEach(["Dog","Cat","Cat"], addPet)',"numberOfPets"],seealso:["map","sort","filter"]},inv:{name:"inv",category:"Matrix",syntax:["inv(x)"],description:"Calculate the inverse of a matrix",examples:["inv([1, 2; 3, 4])","inv(4)","1 / 4"],seealso:["concat","det","diag","identity","ones","range","size","squeeze","subset","trace","transpose","zeros"]},pinv:{name:"pinv",category:"Matrix",syntax:["pinv(x)"],description:"Calculate the MoorePenrose inverse of a matrix",examples:["pinv([1, 2; 3, 4])","pinv([[1, 0], [0, 1], [0, 1]])","pinv(4)"],seealso:["inv"]},eigs:{name:"eigs",category:"Matrix",syntax:["eigs(x)"],description:"Calculate the eigenvalues and eigenvectors of a real symmetric matrix",examples:["eigs([[5, 2.3], [2.3, 1]])"],seealso:["inv"]},kron:{name:"kron",category:"Matrix",syntax:["kron(x, y)"],description:"Calculates the kronecker product of 2 matrices or vectors.",examples:["kron([[1, 0], [0, 1]], [[1, 2], [3, 4]])","kron([1,1], [2,3,4])"],seealso:["multiply","dot","cross"]},matrixFromFunction:{name:"matrixFromFunction",category:"Matrix",syntax:["matrixFromFunction(size, fn)","matrixFromFunction(size, fn, format)","matrixFromFunction(size, fn, format, datatype)","matrixFromFunction(size, format, fn)","matrixFromFunction(size, format, datatype, fn)"],description:"Create a matrix by evaluating a generating function at each index.",examples:["f(I) = I[1] - I[2]","matrixFromFunction([3,3], f)","g(I) = I[1] - I[2] == 1 ? 4 : 0",'matrixFromFunction([100, 100], "sparse", g)',"matrixFromFunction([5], random)"],seealso:["matrix","matrixFromRows","matrixFromColumns","zeros"]},matrixFromRows:{name:"matrixFromRows",category:"Matrix",syntax:["matrixFromRows(...arr)","matrixFromRows(row1, row2)","matrixFromRows(row1, row2, row3)"],description:"Create a dense matrix from vectors as individual rows.",examples:["matrixFromRows([1, 2, 3], [[4],[5],[6]])"],seealso:["matrix","matrixFromColumns","matrixFromFunction","zeros"]},matrixFromColumns:{name:"matrixFromColumns",category:"Matrix",syntax:["matrixFromColumns(...arr)","matrixFromColumns(row1, row2)","matrixFromColumns(row1, row2, row3)"],description:"Create a dense matrix from vectors as individual columns.",examples:["matrixFromColumns([1, 2, 3], [[4],[5],[6]])"],seealso:["matrix","matrixFromRows","matrixFromFunction","zeros"]},map:{name:"map",category:"Matrix",syntax:["map(x, callback)"],description:"Create a new matrix or array with the results of the callback function executed on each entry of the matrix/array.",examples:["map([1, 2, 3], square)"],seealso:["filter","forEach"]},ones:{name:"ones",category:"Matrix",syntax:["ones(m)","ones(m, n)","ones(m, n, p, ...)","ones([m])","ones([m, n])","ones([m, n, p, ...])"],description:"Create a matrix containing ones.",examples:["ones(3)","ones(3, 5)","ones([2,3]) * 4.5","a = [1, 2, 3; 4, 5, 6]","ones(size(a))"],seealso:["concat","det","diag","identity","inv","range","size","squeeze","subset","trace","transpose","zeros"]},partitionSelect:{name:"partitionSelect",category:"Matrix",syntax:["partitionSelect(x, k)","partitionSelect(x, k, compare)"],description:"Partition-based selection of an array or 1D matrix. Will find the kth smallest value, and mutates the input array. Uses Quickselect.",examples:["partitionSelect([5, 10, 1], 2)",'partitionSelect(["C", "B", "A", "D"], 1, compareText)',"arr = [5, 2, 1]","partitionSelect(arr, 0) # returns 1, arr is now: [1, 2, 5]","arr","partitionSelect(arr, 1, 'desc') # returns 2, arr is now: [5, 2, 1]","arr"],seealso:["sort"]},range:{name:"range",category:"Type",syntax:["start:end","start:step:end","range(start, end)","range(start, end, step)","range(string)"],description:"Create a range. Lower bound of the range is included, upper bound is excluded.",examples:["1:5","3:-1:-3","range(3, 7)","range(0, 12, 2)",'range("4:10")',"range(1m, 1m, 3m)","a = [1, 2, 3, 4; 5, 6, 7, 8]","a[1:2, 1:2]"],seealso:["concat","det","diag","identity","inv","ones","size","squeeze","subset","trace","transpose","zeros"]},resize:{name:"resize",category:"Matrix",syntax:["resize(x, size)","resize(x, size, defaultValue)"],description:"Resize a matrix.",examples:["resize([1,2,3,4,5], [3])","resize([1,2,3], [5])","resize([1,2,3], [5], -1)","resize(2, [2, 3])",'resize("hello", [8], "!")'],seealso:["size","subset","squeeze","reshape"]},reshape:{name:"reshape",category:"Matrix",syntax:["reshape(x, sizes)"],description:"Reshape a multi dimensional array to fit the specified dimensions.",examples:["reshape([1, 2, 3, 4, 5, 6], [2, 3])","reshape([[1, 2], [3, 4]], [1, 4])","reshape([[1, 2], [3, 4]], [4])","reshape([1, 2, 3, 4], [-1, 2])"],seealso:["size","squeeze","resize"]},rotate:{name:"rotate",category:"Matrix",syntax:["rotate(w, theta)","rotate(w, theta, v)"],description:"Returns a 2-D rotation matrix (2x2) for a given angle (in radians). Returns a 2-D rotation matrix (3x3) of a given angle (in radians) around given axis.",examples:["rotate([1, 0], pi / 2)",'rotate(matrix([1, 0]), unit("35deg"))','rotate([1, 0, 0], unit("90deg"), [0, 0, 1])','rotate(matrix([1, 0, 0]), unit("90deg"), matrix([0, 0, 1]))'],seealso:["matrix","rotationMatrix"]},rotationMatrix:{name:"rotationMatrix",category:"Matrix",syntax:["rotationMatrix(theta)","rotationMatrix(theta, v)","rotationMatrix(theta, v, format)"],description:"Returns a 2-D rotation matrix (2x2) for a given angle (in radians). Returns a 2-D rotation matrix (3x3) of a given angle (in radians) around given axis.",examples:["rotationMatrix(pi / 2)",'rotationMatrix(unit("45deg"), [0, 0, 1])','rotationMatrix(1, matrix([0, 0, 1]), "sparse")'],seealso:["cos","sin"]},row:{name:"row",category:"Matrix",syntax:["row(x, index)"],description:"Return a row from a matrix or array.",examples:["A = [[1, 2], [3, 4]]","row(A, 1)","row(A, 2)"],seealso:["column","matrixFromRows"]},size:{name:"size",category:"Matrix",syntax:["size(x)"],description:"Calculate the size of a matrix.",examples:["size(2.3)",'size("hello world")',"a = [1, 2; 3, 4; 5, 6]","size(a)","size(1:6)"],seealso:["concat","count","det","diag","identity","inv","ones","range","squeeze","subset","trace","transpose","zeros"]},sort:{name:"sort",category:"Matrix",syntax:["sort(x)","sort(x, compare)"],description:'Sort the items in a matrix. Compare can be a string "asc", "desc", "natural", or a custom sort function.',examples:["sort([5, 10, 1])",'sort(["C", "B", "A", "D"], "natural")',"sortByLength(a, b) = size(a)[1] - size(b)[1]",'sort(["Langdon", "Tom", "Sara"], sortByLength)','sort(["10", "1", "2"], "natural")'],seealso:["map","filter","forEach"]},squeeze:{name:"squeeze",category:"Matrix",syntax:["squeeze(x)"],description:"Remove inner and outer singleton dimensions from a matrix.",examples:["a = zeros(3,2,1)","size(squeeze(a))","b = zeros(1,1,3)","size(squeeze(b))"],seealso:["concat","det","diag","identity","inv","ones","range","size","subset","trace","transpose","zeros"]},subset:{name:"subset",category:"Matrix",syntax:["value(index)","value(index) = replacement","subset(value, [index])","subset(value, [index], replacement)"],description:"Get or set a subset of the entries of a matrix or characters of a string. Indexes are one-based. There should be one index specification for each dimension of the target. Each specification can be a single index, a list of indices, or a range in colon notation `l:u`. In a range, both the lower bound l and upper bound u are included; and if a bound is omitted it defaults to the most extreme valid value. The cartesian product of the indices specified in each dimension determines the target of the operation.",examples:["d = [1, 2; 3, 4]","e = []","e[1, 1:2] = [5, 6]","e[2, :] = [7, 8]","f = d * e","f[2, 1]","f[:, 1]","f[[1,2], [1,3]] = [9, 10; 11, 12]","f"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","trace","transpose","zeros"]},trace:{name:"trace",category:"Matrix",syntax:["trace(A)"],description:"Calculate the trace of a matrix: the sum of the elements on the main diagonal of a square matrix.",examples:["A = [1, 2, 3; -1, 2, 3; 2, 0, 3]","trace(A)"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","transpose","zeros"]},transpose:{name:"transpose",category:"Matrix",syntax:["x'","transpose(x)"],description:"Transpose a matrix",examples:["a = [1, 2, 3; 4, 5, 6]","a'","transpose(a)"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","trace","zeros"]},zeros:{name:"zeros",category:"Matrix",syntax:["zeros(m)","zeros(m, n)","zeros(m, n, p, ...)","zeros([m])","zeros([m, n])","zeros([m, n, p, ...])"],description:"Create a matrix containing zeros.",examples:["zeros(3)","zeros(3, 5)","a = [1, 2, 3; 4, 5, 6]","zeros(size(a))"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","trace","transpose"]},fft:{name:"fft",category:"Matrix",syntax:["fft(x)"],description:"Calculate N-dimensional fourier transform",examples:["fft([[1, 0], [1, 0]])"],seealso:["ifft"]},ifft:{name:"ifft",category:"Matrix",syntax:["ifft(x)"],description:"Calculate N-dimensional inverse fourier transform",examples:["ifft([[2, 2], [0, 0]])"],seealso:["fft"]},sylvester:{name:"sylvester",category:"Algebra",syntax:["sylvester(A,B,C)"],description:"Solves the real-valued Sylvester equation AX+XB=C for X",examples:["sylvester([[-1, -2], [1, 1]], [[-2, 1], [-1, 2]], [[-3, 2], [3, 0]])","A = [[-1, -2], [1, 1]]; B = [[2, -1], [1, -2]]; C = [[-3, 2], [3, 0]]","sylvester(A, B, C)"],seealso:["schur","lyap"]},schur:{name:"schur",category:"Algebra",syntax:["schur(A)"],description:"Performs a real Schur decomposition of the real matrix A = UTU'",examples:["schur([[1, 0], [-4, 3]])","A = [[1, 0], [-4, 3]]","schur(A)"],seealso:["lyap","sylvester"]},lyap:{name:"lyap",category:"Algebra",syntax:["lyap(A,Q)"],description:"Solves the Continuous-time Lyapunov equation AP+PA'+Q=0 for P",examples:["lyap([[-2, 0], [1, -4]], [[3, 1], [1, 3]])","A = [[-2, 0], [1, -4]]","Q = [[3, 1], [1, 3]]","lyap(A,Q)"],seealso:["schur","sylvester"]},solveODE:{name:"solveODE",category:"Numeric",syntax:["solveODE(func, tspan, y0)","solveODE(func, tspan, y0, options)"],description:"Numerical Integration of Ordinary Differential Equations.",examples:["f(t,y) = y","tspan = [0, 4]","solveODE(f, tspan, 1)","solveODE(f, tspan, [1, 2])",'solveODE(f, tspan, 1, { method:"RK23", maxStep:0.1 })'],seealso:["derivative","simplifyCore"]},combinations:{name:"combinations",category:"Probability",syntax:["combinations(n, k)"],description:"Compute the number of combinations of n items taken k at a time",examples:["combinations(7, 5)"],seealso:["combinationsWithRep","permutations","factorial"]},combinationsWithRep:{name:"combinationsWithRep",category:"Probability",syntax:["combinationsWithRep(n, k)"],description:"Compute the number of combinations of n items taken k at a time with replacements.",examples:["combinationsWithRep(7, 5)"],seealso:["combinations","permutations","factorial"]},factorial:{name:"factorial",category:"Probability",syntax:["n!","factorial(n)"],description:"Compute the factorial of a value",examples:["5!","5 * 4 * 3 * 2 * 1","3!"],seealso:["combinations","combinationsWithRep","permutations","gamma"]},gamma:{name:"gamma",category:"Probability",syntax:["gamma(n)"],description:"Compute the gamma function. For small values, the Lanczos approximation is used, and for large values the extended Stirling approximation.",examples:["gamma(4)","3!","gamma(1/2)","sqrt(pi)"],seealso:["factorial"]},kldivergence:{name:"kldivergence",category:"Probability",syntax:["kldivergence(x, y)"],description:"Calculate the Kullback-Leibler (KL) divergence  between two distributions.",examples:["kldivergence([0.7,0.5,0.4], [0.2,0.9,0.5])"],seealso:[]},lgamma:{name:"lgamma",category:"Probability",syntax:["lgamma(n)"],description:"Logarithm of the gamma function for real, positive numbers and complex numbers, using Lanczos approximation for numbers and Stirling series for complex numbers.",examples:["lgamma(4)","lgamma(1/2)","lgamma(i)","lgamma(complex(1.1, 2))"],seealso:["gamma"]},multinomial:{name:"multinomial",category:"Probability",syntax:["multinomial(A)"],description:"Multinomial Coefficients compute the number of ways of picking a1, a2, ..., ai unordered outcomes from `n` possibilities. multinomial takes one array of integers as an argument. The following condition must be enforced: every ai > 0.",examples:["multinomial([1, 2, 1])"],seealso:["combinations","factorial"]},permutations:{name:"permutations",category:"Probability",syntax:["permutations(n)","permutations(n, k)"],description:"Compute the number of permutations of n items taken k at a time",examples:["permutations(5)","permutations(5, 3)"],seealso:["combinations","combinationsWithRep","factorial"]},pickRandom:{name:"pickRandom",category:"Probability",syntax:["pickRandom(array)","pickRandom(array, number)","pickRandom(array, weights)","pickRandom(array, number, weights)","pickRandom(array, weights, number)"],description:"Pick a random entry from a given array.",examples:["pickRandom(0:10)","pickRandom([1, 3, 1, 6])","pickRandom([1, 3, 1, 6], 2)","pickRandom([1, 3, 1, 6], [2, 3, 2, 1])","pickRandom([1, 3, 1, 6], 2, [2, 3, 2, 1])","pickRandom([1, 3, 1, 6], [2, 3, 2, 1], 2)"],seealso:["random","randomInt"]},random:{name:"random",category:"Probability",syntax:["random()","random(max)","random(min, max)","random(size)","random(size, max)","random(size, min, max)"],description:"Return a random number.",examples:["random()","random(10, 20)","random([2, 3])"],seealso:["pickRandom","randomInt"]},randomInt:{name:"randomInt",category:"Probability",syntax:["randomInt(max)","randomInt(min, max)","randomInt(size)","randomInt(size, max)","randomInt(size, min, max)"],description:"Return a random integer number",examples:["randomInt(10, 20)","randomInt([2, 3], 10)"],seealso:["pickRandom","random"]},compare:{name:"compare",category:"Relational",syntax:["compare(x, y)"],description:"Compare two values. Returns 1 when x > y, -1 when x < y, and 0 when x == y.",examples:["compare(2, 3)","compare(3, 2)","compare(2, 2)","compare(5cm, 40mm)","compare(2, [1, 2, 3])"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compareNatural","compareText"]},compareNatural:{name:"compareNatural",category:"Relational",syntax:["compareNatural(x, y)"],description:"Compare two values of any type in a deterministic, natural way. Returns 1 when x > y, -1 when x < y, and 0 when x == y.",examples:["compareNatural(2, 3)","compareNatural(3, 2)","compareNatural(2, 2)","compareNatural(5cm, 40mm)",'compareNatural("2", "10")',"compareNatural(2 + 3i, 2 + 4i)","compareNatural([1, 2, 4], [1, 2, 3])","compareNatural([1, 5], [1, 2, 3])","compareNatural([1, 2], [1, 2])","compareNatural({a: 2}, {a: 4})"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compare","compareText"]},compareText:{name:"compareText",category:"Relational",syntax:["compareText(x, y)"],description:"Compare two strings lexically. Comparison is case sensitive. Returns 1 when x > y, -1 when x < y, and 0 when x == y.",examples:['compareText("B", "A")','compareText("A", "B")','compareText("A", "A")','compareText("2", "10")','compare("2", "10")',"compare(2, 10)",'compareNatural("2", "10")','compareText("B", ["A", "B", "C"])'],seealso:["compare","compareNatural"]},deepEqual:{name:"deepEqual",category:"Relational",syntax:["deepEqual(x, y)"],description:"Check equality of two matrices element wise. Returns true if the size of both matrices is equal and when and each of the elements are equal.",examples:["deepEqual([1,3,4], [1,3,4])","deepEqual([1,3,4], [1,3])"],seealso:["equal","unequal","smaller","larger","smallerEq","largerEq","compare"]},equal:{name:"equal",category:"Relational",syntax:["x == y","equal(x, y)"],description:"Check equality of two values. Returns true if the values are equal, and false if not.",examples:["2+2 == 3","2+2 == 4","a = 3.2","b = 6-2.8","a == b","50cm == 0.5m"],seealso:["unequal","smaller","larger","smallerEq","largerEq","compare","deepEqual","equalText"]},equalText:{name:"equalText",category:"Relational",syntax:["equalText(x, y)"],description:"Check equality of two strings. Comparison is case sensitive. Returns true if the values are equal, and false if not.",examples:['equalText("Hello", "Hello")','equalText("a", "A")','equal("2e3", "2000")','equalText("2e3", "2000")','equalText("B", ["A", "B", "C"])'],seealso:["compare","compareNatural","compareText","equal"]},larger:{name:"larger",category:"Relational",syntax:["x > y","larger(x, y)"],description:"Check if value x is larger than y. Returns true if x is larger than y, and false if not.",examples:["2 > 3","5 > 2*2","a = 3.3","b = 6-2.8","(a > b)","(b < a)","5 cm > 2 inch"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compare"]},largerEq:{name:"largerEq",category:"Relational",syntax:["x >= y","largerEq(x, y)"],description:"Check if value x is larger or equal to y. Returns true if x is larger or equal to y, and false if not.",examples:["2 >= 1+1","2 > 1+1","a = 3.2","b = 6-2.8","(a >= b)"],seealso:["equal","unequal","smallerEq","smaller","compare"]},smaller:{name:"smaller",category:"Relational",syntax:["x < y","smaller(x, y)"],description:"Check if value x is smaller than value y. Returns true if x is smaller than y, and false if not.",examples:["2 < 3","5 < 2*2","a = 3.3","b = 6-2.8","(a < b)","5 cm < 2 inch"],seealso:["equal","unequal","larger","smallerEq","largerEq","compare"]},smallerEq:{name:"smallerEq",category:"Relational",syntax:["x <= y","smallerEq(x, y)"],description:"Check if value x is smaller or equal to value y. Returns true if x is smaller than y, and false if not.",examples:["2 <= 1+1","2 < 1+1","a = 3.2","b = 6-2.8","(a <= b)"],seealso:["equal","unequal","larger","smaller","largerEq","compare"]},unequal:{name:"unequal",category:"Relational",syntax:["x != y","unequal(x, y)"],description:"Check unequality of two values. Returns true if the values are unequal, and false if they are equal.",examples:["2+2 != 3","2+2 != 4","a = 3.2","b = 6-2.8","a != b","50cm != 0.5m","5 cm != 2 inch"],seealso:["equal","smaller","larger","smallerEq","largerEq","compare","deepEqual"]},setCartesian:{name:"setCartesian",category:"Set",syntax:["setCartesian(set1, set2)"],description:"Create the cartesian product of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays and the values will be sorted in ascending order before the operation.",examples:["setCartesian([1, 2], [3, 4])"],seealso:["setUnion","setIntersect","setDifference","setPowerset"]},setDifference:{name:"setDifference",category:"Set",syntax:["setDifference(set1, set2)"],description:"Create the difference of two (multi)sets: every element of set1, that is not the element of set2. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setDifference([1, 2, 3, 4], [3, 4, 5, 6])","setDifference([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setUnion","setIntersect","setSymDifference"]},setDistinct:{name:"setDistinct",category:"Set",syntax:["setDistinct(set)"],description:"Collect the distinct elements of a multiset. A multi-dimension array will be converted to a single-dimension array before the operation.",examples:["setDistinct([1, 1, 1, 2, 2, 3])"],seealso:["setMultiplicity"]},setIntersect:{name:"setIntersect",category:"Set",syntax:["setIntersect(set1, set2)"],description:"Create the intersection of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setIntersect([1, 2, 3, 4], [3, 4, 5, 6])","setIntersect([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setUnion","setDifference"]},setIsSubset:{name:"setIsSubset",category:"Set",syntax:["setIsSubset(set1, set2)"],description:"Check whether a (multi)set is a subset of another (multi)set: every element of set1 is the element of set2. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setIsSubset([1, 2], [3, 4, 5, 6])","setIsSubset([3, 4], [3, 4, 5, 6])"],seealso:["setUnion","setIntersect","setDifference"]},setMultiplicity:{name:"setMultiplicity",category:"Set",syntax:["setMultiplicity(element, set)"],description:"Count the multiplicity of an element in a multiset. A multi-dimension array will be converted to a single-dimension array before the operation.",examples:["setMultiplicity(1, [1, 2, 2, 4])","setMultiplicity(2, [1, 2, 2, 4])"],seealso:["setDistinct","setSize"]},setPowerset:{name:"setPowerset",category:"Set",syntax:["setPowerset(set)"],description:"Create the powerset of a (multi)set: the powerset contains very possible subsets of a (multi)set. A multi-dimension array will be converted to a single-dimension array before the operation.",examples:["setPowerset([1, 2, 3])"],seealso:["setCartesian"]},setSize:{name:"setSize",category:"Set",syntax:["setSize(set)","setSize(set, unique)"],description:'Count the number of elements of a (multi)set. When the second parameter "unique" is true, count only the unique values. A multi-dimension array will be converted to a single-dimension array before the operation.',examples:["setSize([1, 2, 2, 4])","setSize([1, 2, 2, 4], true)"],seealso:["setUnion","setIntersect","setDifference"]},setSymDifference:{name:"setSymDifference",category:"Set",syntax:["setSymDifference(set1, set2)"],description:"Create the symmetric difference of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setSymDifference([1, 2, 3, 4], [3, 4, 5, 6])","setSymDifference([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setUnion","setIntersect","setDifference"]},setUnion:{name:"setUnion",category:"Set",syntax:["setUnion(set1, set2)"],description:"Create the union of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setUnion([1, 2, 3, 4], [3, 4, 5, 6])","setUnion([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setIntersect","setDifference"]},zpk2tf:{name:"zpk2tf",category:"Signal",syntax:["zpk2tf(z, p, k)"],description:"Compute the transfer function of a zero-pole-gain model.",examples:["zpk2tf([1, 2], [-1, -2], 1)","zpk2tf([1, 2], [-1, -2])","zpk2tf([1 - 3i, 2 + 2i], [-1, -2])"],seealso:[]},freqz:{name:"freqz",category:"Signal",syntax:["freqz(b, a)","freqz(b, a, w)"],description:"Calculates the frequency response of a filter given its numerator and denominator coefficients.",examples:["freqz([1, 2], [1, 2, 3])","freqz([1, 2], [1, 2, 3], [0, 1])","freqz([1, 2], [1, 2, 3], 512)"],seealso:[]},erf:{name:"erf",category:"Special",syntax:["erf(x)"],description:"Compute the erf function of a value using a rational Chebyshev approximations for different intervals of x",examples:["erf(0.2)","erf(-0.5)","erf(4)"],seealso:[]},zeta:{name:"zeta",category:"Special",syntax:["zeta(s)"],description:"Compute the Riemann Zeta Function using an infinite series and Riemanns Functional Equation for the entire complex plane",examples:["zeta(0.2)","zeta(-0.5)","zeta(4)"],seealso:[]},cumsum:{name:"cumsum",category:"Statistics",syntax:["cumsum(a, b, c, ...)","cumsum(A)"],description:"Compute the cumulative sum of all values.",examples:["cumsum(2, 3, 4, 1)","cumsum([2, 3, 4, 1])","cumsum([1, 2; 3, 4])","cumsum([1, 2; 3, 4], 1)","cumsum([1, 2; 3, 4], 2)"],seealso:["max","mean","median","min","prod","std","sum","variance"]},mad:{name:"mad",category:"Statistics",syntax:["mad(a, b, c, ...)","mad(A)"],description:"Compute the median absolute deviation of a matrix or a list with values. The median absolute deviation is defined as the median of the absolute deviations from the median.",examples:["mad(10, 20, 30)","mad([1, 2, 3])"],seealso:["mean","median","std","abs"]},max:{name:"max",category:"Statistics",syntax:["max(a, b, c, ...)","max(A)","max(A, dimension)"],description:"Compute the maximum value of a list of values.",examples:["max(2, 3, 4, 1)","max([2, 3, 4, 1])","max([2, 5; 4, 3])","max([2, 5; 4, 3], 1)","max([2, 5; 4, 3], 2)","max(2.7, 7.1, -4.5, 2.0, 4.1)","min(2.7, 7.1, -4.5, 2.0, 4.1)"],seealso:["mean","median","min","prod","std","sum","variance"]},mean:{name:"mean",category:"Statistics",syntax:["mean(a, b, c, ...)","mean(A)","mean(A, dimension)"],description:"Compute the arithmetic mean of a list of values.",examples:["mean(2, 3, 4, 1)","mean([2, 3, 4, 1])","mean([2, 5; 4, 3])","mean([2, 5; 4, 3], 1)","mean([2, 5; 4, 3], 2)","mean([1.0, 2.7, 3.2, 4.0])"],seealso:["max","median","min","prod","std","sum","variance"]},median:{name:"median",category:"Statistics",syntax:["median(a, b, c, ...)","median(A)"],description:"Compute the median of all values. The values are sorted and the middle value is returned. In case of an even number of values, the average of the two middle values is returned.",examples:["median(5, 2, 7)","median([3, -1, 5, 7])"],seealso:["max","mean","min","prod","std","sum","variance","quantileSeq"]},min:{name:"min",category:"Statistics",syntax:["min(a, b, c, ...)","min(A)","min(A, dimension)"],description:"Compute the minimum value of a list of values.",examples:["min(2, 3, 4, 1)","min([2, 3, 4, 1])","min([2, 5; 4, 3])","min([2, 5; 4, 3], 1)","min([2, 5; 4, 3], 2)","min(2.7, 7.1, -4.5, 2.0, 4.1)","max(2.7, 7.1, -4.5, 2.0, 4.1)"],seealso:["max","mean","median","prod","std","sum","variance"]},mode:{name:"mode",category:"Statistics",syntax:["mode(a, b, c, ...)","mode(A)","mode(A, a, b, B, c, ...)"],description:"Computes the mode of all values as an array. In case mode being more than one, multiple values are returned in an array.",examples:["mode(2, 1, 4, 3, 1)","mode([1, 2.7, 3.2, 4, 2.7])","mode(1, 4, 6, 1, 6)"],seealso:["max","mean","min","median","prod","std","sum","variance"]},prod:{name:"prod",category:"Statistics",syntax:["prod(a, b, c, ...)","prod(A)"],description:"Compute the product of all values.",examples:["prod(2, 3, 4)","prod([2, 3, 4])","prod([2, 5; 4, 3])"],seealso:["max","mean","min","median","min","std","sum","variance"]},quantileSeq:{name:"quantileSeq",category:"Statistics",syntax:["quantileSeq(A, prob[, sorted])","quantileSeq(A, [prob1, prob2, ...][, sorted])","quantileSeq(A, N[, sorted])"],description:"Compute the prob order quantile of a matrix or a list with values. The sequence is sorted and the middle value is returned. Supported types of sequence values are: Number, BigNumber, Unit Supported types of probablity are: Number, BigNumber. \n\nIn case of a (multi dimensional) array or matrix, the prob order quantile of all elements will be calculated.",examples:["quantileSeq([3, -1, 5, 7], 0.5)","quantileSeq([3, -1, 5, 7], [1/3, 2/3])","quantileSeq([3, -1, 5, 7], 2)","quantileSeq([-1, 3, 5, 7], 0.5, true)"],seealso:["mean","median","min","max","prod","std","sum","variance"]},std:{name:"std",category:"Statistics",syntax:["std(a, b, c, ...)","std(A)","std(A, dimension)","std(A, normalization)","std(A, dimension, normalization)"],description:'Compute the standard deviation of all values, defined as std(A) = sqrt(variance(A)). Optional parameter normalization can be "unbiased" (default), "uncorrected", or "biased".',examples:["std(2, 4, 6)","std([2, 4, 6, 8])",'std([2, 4, 6, 8], "uncorrected")','std([2, 4, 6, 8], "biased")',"std([1, 2, 3; 4, 5, 6])"],seealso:["max","mean","min","median","prod","sum","variance"]},sum:{name:"sum",category:"Statistics",syntax:["sum(a, b, c, ...)","sum(A)","sum(A, dimension)"],description:"Compute the sum of all values.",examples:["sum(2, 3, 4, 1)","sum([2, 3, 4, 1])","sum([2, 5; 4, 3])"],seealso:["max","mean","median","min","prod","std","sum","variance"]},variance:{name:"variance",category:"Statistics",syntax:["variance(a, b, c, ...)","variance(A)","variance(A, dimension)","variance(A, normalization)","variance(A, dimension, normalization)"],description:'Compute the variance of all values. Optional parameter normalization can be "unbiased" (default), "uncorrected", or "biased".',examples:["variance(2, 4, 6)","variance([2, 4, 6, 8])",'variance([2, 4, 6, 8], "uncorrected")','variance([2, 4, 6, 8], "biased")',"variance([1, 2, 3; 4, 5, 6])"],seealso:["max","mean","min","median","min","prod","std","sum"]},corr:{name:"corr",category:"Statistics",syntax:["corr(A,B)"],description:"Compute the correlation coefficient of a two list with values, For matrices, the matrix correlation coefficient is calculated.",examples:["corr([2, 4, 6, 8],[1, 2, 3, 6])","corr(matrix([[1, 2.2, 3, 4.8, 5], [1, 2, 3, 4, 5]]), matrix([[4, 5.3, 6.6, 7, 8], [1, 2, 3, 4, 5]]))"],seealso:["max","mean","min","median","min","prod","std","sum"]},acos:{name:"acos",category:"Trigonometry",syntax:["acos(x)"],description:"Compute the inverse cosine of a value in radians.",examples:["acos(0.5)","acos(cos(2.3))"],seealso:["cos","atan","asin"]},acosh:{name:"acosh",category:"Trigonometry",syntax:["acosh(x)"],description:"Calculate the hyperbolic arccos of a value, defined as `acosh(x) = ln(sqrt(x^2 - 1) + x)`.",examples:["acosh(1.5)"],seealso:["cosh","asinh","atanh"]},acot:{name:"acot",category:"Trigonometry",syntax:["acot(x)"],description:"Calculate the inverse cotangent of a value.",examples:["acot(0.5)","acot(cot(0.5))","acot(2)"],seealso:["cot","atan"]},acoth:{name:"acoth",category:"Trigonometry",syntax:["acoth(x)"],description:"Calculate the hyperbolic arccotangent of a value, defined as `acoth(x) = (ln((x+1)/x) + ln(x/(x-1))) / 2`.",examples:["acoth(2)","acoth(0.5)"],seealso:["acsch","asech"]},acsc:{name:"acsc",category:"Trigonometry",syntax:["acsc(x)"],description:"Calculate the inverse cotangent of a value.",examples:["acsc(2)","acsc(csc(0.5))","acsc(0.5)"],seealso:["csc","asin","asec"]},acsch:{name:"acsch",category:"Trigonometry",syntax:["acsch(x)"],description:"Calculate the hyperbolic arccosecant of a value, defined as `acsch(x) = ln(1/x + sqrt(1/x^2 + 1))`.",examples:["acsch(0.5)"],seealso:["asech","acoth"]},asec:{name:"asec",category:"Trigonometry",syntax:["asec(x)"],description:"Calculate the inverse secant of a value.",examples:["asec(0.5)","asec(sec(0.5))","asec(2)"],seealso:["acos","acot","acsc"]},asech:{name:"asech",category:"Trigonometry",syntax:["asech(x)"],description:"Calculate the inverse secant of a value.",examples:["asech(0.5)"],seealso:["acsch","acoth"]},asin:{name:"asin",category:"Trigonometry",syntax:["asin(x)"],description:"Compute the inverse sine of a value in radians.",examples:["asin(0.5)","asin(sin(0.5))"],seealso:["sin","acos","atan"]},asinh:{name:"asinh",category:"Trigonometry",syntax:["asinh(x)"],description:"Calculate the hyperbolic arcsine of a value, defined as `asinh(x) = ln(x + sqrt(x^2 + 1))`.",examples:["asinh(0.5)"],seealso:["acosh","atanh"]},atan:{name:"atan",category:"Trigonometry",syntax:["atan(x)"],description:"Compute the inverse tangent of a value in radians.",examples:["atan(0.5)","atan(tan(0.5))"],seealso:["tan","acos","asin"]},atanh:{name:"atanh",category:"Trigonometry",syntax:["atanh(x)"],description:"Calculate the hyperbolic arctangent of a value, defined as `atanh(x) = ln((1 + x)/(1 - x)) / 2`.",examples:["atanh(0.5)"],seealso:["acosh","asinh"]},atan2:{name:"atan2",category:"Trigonometry",syntax:["atan2(y, x)"],description:"Computes the principal value of the arc tangent of y/x in radians.",examples:["atan2(2, 2) / pi","angle = 60 deg in rad","x = cos(angle)","y = sin(angle)","atan2(y, x)"],seealso:["sin","cos","tan"]},cos:{name:"cos",category:"Trigonometry",syntax:["cos(x)"],description:"Compute the cosine of x in radians.",examples:["cos(2)","cos(pi / 4) ^ 2","cos(180 deg)","cos(60 deg)","sin(0.2)^2 + cos(0.2)^2"],seealso:["acos","sin","tan"]},cosh:{name:"cosh",category:"Trigonometry",syntax:["cosh(x)"],description:"Compute the hyperbolic cosine of x in radians.",examples:["cosh(0.5)"],seealso:["sinh","tanh","coth"]},cot:{name:"cot",category:"Trigonometry",syntax:["cot(x)"],description:"Compute the cotangent of x in radians. Defined as 1/tan(x)",examples:["cot(2)","1 / tan(2)"],seealso:["sec","csc","tan"]},coth:{name:"coth",category:"Trigonometry",syntax:["coth(x)"],description:"Compute the hyperbolic cotangent of x in radians.",examples:["coth(2)","1 / tanh(2)"],seealso:["sech","csch","tanh"]},csc:{name:"csc",category:"Trigonometry",syntax:["csc(x)"],description:"Compute the cosecant of x in radians. Defined as 1/sin(x)",examples:["csc(2)","1 / sin(2)"],seealso:["sec","cot","sin"]},csch:{name:"csch",category:"Trigonometry",syntax:["csch(x)"],description:"Compute the hyperbolic cosecant of x in radians. Defined as 1/sinh(x)",examples:["csch(2)","1 / sinh(2)"],seealso:["sech","coth","sinh"]},sec:{name:"sec",category:"Trigonometry",syntax:["sec(x)"],description:"Compute the secant of x in radians. Defined as 1/cos(x)",examples:["sec(2)","1 / cos(2)"],seealso:["cot","csc","cos"]},sech:{name:"sech",category:"Trigonometry",syntax:["sech(x)"],description:"Compute the hyperbolic secant of x in radians. Defined as 1/cosh(x)",examples:["sech(2)","1 / cosh(2)"],seealso:["coth","csch","cosh"]},sin:{name:"sin",category:"Trigonometry",syntax:["sin(x)"],description:"Compute the sine of x in radians.",examples:["sin(2)","sin(pi / 4) ^ 2","sin(90 deg)","sin(30 deg)","sin(0.2)^2 + cos(0.2)^2"],seealso:["asin","cos","tan"]},sinh:{name:"sinh",category:"Trigonometry",syntax:["sinh(x)"],description:"Compute the hyperbolic sine of x in radians.",examples:["sinh(0.5)"],seealso:["cosh","tanh"]},tan:{name:"tan",category:"Trigonometry",syntax:["tan(x)"],description:"Compute the tangent of x in radians.",examples:["tan(0.5)","sin(0.5) / cos(0.5)","tan(pi / 4)","tan(45 deg)"],seealso:["atan","sin","cos"]},tanh:{name:"tanh",category:"Trigonometry",syntax:["tanh(x)"],description:"Compute the hyperbolic tangent of x in radians.",examples:["tanh(0.5)","sinh(0.5) / cosh(0.5)"],seealso:["sinh","cosh"]},to:{name:"to",category:"Units",syntax:["x to unit","to(x, unit)"],description:"Change the unit of a value.",examples:["5 inch to cm","3.2kg to g","16 bytes in bits"],seealso:[]},clone:{name:"clone",category:"Utils",syntax:["clone(x)"],description:"Clone a variable. Creates a copy of primitive variables,and a deep copy of matrices",examples:["clone(3.5)","clone(2 - 4i)","clone(45 deg)","clone([1, 2; 3, 4])",'clone("hello world")'],seealso:[]},format:{name:"format",category:"Utils",syntax:["format(value)","format(value, precision)"],description:"Format a value of any type as string.",examples:["format(2.3)","format(3 - 4i)","format([])","format(pi, 3)"],seealso:["print"]},bin:{name:"bin",category:"Utils",syntax:["bin(value)"],description:"Format a number as binary",examples:["bin(2)"],seealso:["oct","hex"]},oct:{name:"oct",category:"Utils",syntax:["oct(value)"],description:"Format a number as octal",examples:["oct(56)"],seealso:["bin","hex"]},hex:{name:"hex",category:"Utils",syntax:["hex(value)"],description:"Format a number as hexadecimal",examples:["hex(240)"],seealso:["bin","oct"]},isNaN:{name:"isNaN",category:"Utils",syntax:["isNaN(x)"],description:"Test whether a value is NaN (not a number)",examples:["isNaN(2)","isNaN(0 / 0)","isNaN(NaN)","isNaN(Infinity)"],seealso:["isNegative","isNumeric","isPositive","isZero"]},isInteger:{name:"isInteger",category:"Utils",syntax:["isInteger(x)"],description:"Test whether a value is an integer number.",examples:["isInteger(2)","isInteger(3.5)","isInteger([3, 0.5, -2])"],seealso:["isNegative","isNumeric","isPositive","isZero"]},isNegative:{name:"isNegative",category:"Utils",syntax:["isNegative(x)"],description:"Test whether a value is negative: smaller than zero.",examples:["isNegative(2)","isNegative(0)","isNegative(-4)","isNegative([3, 0.5, -2])"],seealso:["isInteger","isNumeric","isPositive","isZero"]},isNumeric:{name:"isNumeric",category:"Utils",syntax:["isNumeric(x)"],description:"Test whether a value is a numeric value. Returns true when the input is a number, BigNumber, Fraction, or boolean.",examples:["isNumeric(2)",'isNumeric("2")','hasNumericValue("2")',"isNumeric(0)","isNumeric(bignumber(500))","isNumeric(fraction(0.125))","isNumeric(2 + 3i)",'isNumeric([2.3, "foo", false])'],seealso:["isInteger","isZero","isNegative","isPositive","isNaN","hasNumericValue"]},hasNumericValue:{name:"hasNumericValue",category:"Utils",syntax:["hasNumericValue(x)"],description:"Test whether a value is an numeric value. In case of a string, true is returned if the string contains a numeric value.",examples:["hasNumericValue(2)",'hasNumericValue("2")','isNumeric("2")',"hasNumericValue(0)","hasNumericValue(bignumber(500))","hasNumericValue(fraction(0.125))","hasNumericValue(2 + 3i)",'hasNumericValue([2.3, "foo", false])'],seealso:["isInteger","isZero","isNegative","isPositive","isNaN","isNumeric"]},isPositive:{name:"isPositive",category:"Utils",syntax:["isPositive(x)"],description:"Test whether a value is positive: larger than zero.",examples:["isPositive(2)","isPositive(0)","isPositive(-4)","isPositive([3, 0.5, -2])"],seealso:["isInteger","isNumeric","isNegative","isZero"]},isPrime:{name:"isPrime",category:"Utils",syntax:["isPrime(x)"],description:"Test whether a value is prime: has no divisors other than itself and one.",examples:["isPrime(3)","isPrime(-2)","isPrime([2, 17, 100])"],seealso:["isInteger","isNumeric","isNegative","isZero"]},isZero:{name:"isZero",category:"Utils",syntax:["isZero(x)"],description:"Test whether a value is zero.",examples:["isZero(2)","isZero(0)","isZero(-4)","isZero([3, 0, -2, 0])"],seealso:["isInteger","isNumeric","isNegative","isPositive"]},print:{name:"print",category:"Utils",syntax:["print(template, values)","print(template, values, precision)"],description:"Interpolate values into a string template.",examples:['print("Lucy is $age years old", {age: 5})','print("The value of pi is $pi", {pi: pi}, 3)','print("Hello, $user.name!", {user: {name: "John"}})','print("Values: $1, $2, $3", [6, 9, 4])'],seealso:["format"]},typeOf:{name:"typeOf",category:"Utils",syntax:["typeOf(x)"],description:"Get the type of a variable.",examples:["typeOf(3.5)","typeOf(2 - 4i)","typeOf(45 deg)",'typeOf("hello world")'],seealso:["getMatrixDataType"]},numeric:{name:"numeric",category:"Utils",syntax:["numeric(x)"],description:"Convert a numeric input to a specific numeric type: number, BigNumber, or Fraction.",examples:['numeric("4")','numeric("4", "number")','numeric("4", "BigNumber")','numeric("4", "Fraction")','numeric(4, "Fraction")','numeric(fraction(2, 5), "number")'],seealso:["number","fraction","bignumber","string","format"]}},lE=mA("help",["typed","mathWithTransform","Help"],(function(A){var e=A.typed,t=A.mathWithTransform,n=A.Help;return e("help",{any:function(A){var e,i=A;if("string"!=typeof A)for(e in t)if(MA(t,e)&&A===t[e]){i=e;break}var r=UA(uE,i);if(!r){var o="function"==typeof i?i.name:i;throw new Error('No documentation found on "'+o+'"')}return new n(r)}})})),wE=mA("chain",["typed","Chain"],(function(A){var e=A.typed,t=A.Chain;return e("chain",{"":function(){return new t},any:function(A){return new t(A)}})})),hE=mA("det",["typed","matrix","subtractScalar","multiply","divideScalar","isZero","unaryMinus"],(function(A){var e=A.typed,t=A.matrix,n=A.subtractScalar,i=A.multiply,r=A.divideScalar,o=A.isZero,s=A.unaryMinus;return e("det",{any:function(A){return uA(A)},"Array | Matrix":function(A){var e;switch((e=g(A)?A.size():Array.isArray(A)?(A=t(A)).size():[]).length){case 0:return uA(A);case 1:if(1===e[0])return uA(A.valueOf()[0]);if(0===e[0])return 1;throw new RangeError("Matrix must be square (size: "+Vt(e)+")");case 2:var a=e[0],B=e[1];if(a===B)return function(A,e,t){if(1===e)return uA(A[0][0]);if(2===e)return n(i(A[0][0],A[1][1]),i(A[1][0],A[0][1]));for(var a=!1,B=new Array(e).fill(0).map((function(A,e){return e})),c=0;c<e;c++){var g=B[c];if(o(A[g][c])){var E=void 0;for(E=c+1;E<e;E++)if(!o(A[B[E]][c])){g=B[E],B[E]=B[c],B[c]=g,a=!a;break}if(E===e)return A[g][c]}for(var Q=A[g][c],u=0===c?1:A[B[c-1]][c-1],l=c+1;l<e;l++)for(var w=B[l],h=c+1;h<e;h++)A[w][h]=r(n(i(A[w][h],Q),i(A[w][c],A[g][h])),u)}var C=A[B[e-1]][e-1];return a?s(C):C}(A.clone().valueOf(),a);if(0===B)return 1;throw new RangeError("Matrix must be square (size: "+Vt(e)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+Vt(e)+")")}}})})),CE=mA("inv",["typed","matrix","divideScalar","addScalar","multiply","unaryMinus","det","identity","abs"],(function(A){var e=A.typed,t=A.matrix,n=A.divideScalar,i=A.addScalar,r=A.multiply,o=A.unaryMinus,s=A.det,a=A.identity,B=A.abs;return e("inv",{"Array | Matrix":function(A){var e=g(A)?A.size():$t(A);switch(e.length){case 1:if(1===e[0])return g(A)?t([n(1,A.valueOf()[0])]):[n(1,A[0])];throw new RangeError("Matrix must be square (size: "+Vt(e)+")");case 2:var i=e[0],r=e[1];if(i===r)return g(A)?t(c(A.valueOf(),i,r),A.storage()):c(A,i,r);throw new RangeError("Matrix must be square (size: "+Vt(e)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+Vt(e)+")")}},any:function(A){return n(1,A)}});function c(A,e,t){var c,g,E,Q,u;if(1===e){if(0===(Q=A[0][0]))throw Error("Cannot calculate inverse, determinant is zero");return[[n(1,Q)]]}if(2===e){var l=s(A);if(0===l)throw Error("Cannot calculate inverse, determinant is zero");return[[n(A[1][1],l),n(o(A[0][1]),l)],[n(o(A[1][0]),l),n(A[0][0],l)]]}var w=A.concat();for(c=0;c<e;c++)w[c]=w[c].concat();for(var h=a(e).valueOf(),C=0;C<t;C++){var I=B(w[C][C]),M=C;for(c=C+1;c<e;)B(w[c][C])>I&&(I=B(w[c][C]),M=c),c++;if(0===I)throw Error("Cannot calculate inverse, determinant is zero");(c=M)!==C&&(u=w[C],w[C]=w[c],w[c]=u,u=h[C],h[C]=h[c],h[c]=u);var d=w[C],m=h[C];for(c=0;c<e;c++){var p=w[c],F=h[c];if(c!==C){if(0!==p[C]){for(E=n(o(p[C]),d[C]),g=C;g<t;g++)p[g]=i(p[g],r(E,d[g]));for(g=0;g<t;g++)F[g]=i(F[g],r(E,m[g]))}}else{for(E=d[C],g=C;g<t;g++)p[g]=n(p[g],E);for(g=0;g<t;g++)F[g]=n(F[g],E)}}}return h}})),IE=mA("pinv",["typed","matrix","inv","deepEqual","equal","dotDivide","dot","ctranspose","divideScalar","multiply","add","Complex"],(function(A){var e=A.typed,t=A.matrix,n=A.inv,i=A.deepEqual,r=A.equal,o=A.dotDivide,s=A.dot,a=A.ctranspose,B=A.divideScalar,c=A.multiply,E=A.add,Q=A.Complex;return e("pinv",{"Array | Matrix":function(A){var e=g(A)?A.size():$t(A);switch(e.length){case 1:return w(A)?a(A):1===e[0]?n(A):o(a(A),s(A,A));case 2:if(w(A))return a(A);var i=e[0],r=e[1];if(i===r)try{return n(A)}catch(A){if(!(A instanceof Error&&A.message.match(/Cannot calculate inverse, determinant is zero/)))throw A}return g(A)?t(u(A.valueOf(),i,r),A.storage()):u(A,i,r);default:throw new RangeError("Matrix must be two dimensional (size: "+Vt(e)+")")}},any:function(A){return r(A,0)?uA(A):B(1,A)}});function u(A,e,t){var i=function(A,e,t){var n=function(A,e,t){for(var n=uA(A),i=0,r=0;r<e;r++){if(t<=i)return n;for(var s=r;l(n[s][i]);)if(e===++s&&(s=r,t===++i))return n;var a=[n[r],n[s]];n[s]=a[0],n[r]=a[1];for(var B=n[r][i],g=0;g<t;g++)n[r][g]=o(n[r][g],B);for(var Q=0;Q<e;Q++)if(Q!==r){B=n[Q][i];for(var u=0;u<t;u++)n[Q][u]=E(n[Q][u],c(-1,c(B,n[r][u])))}i++}return n}(A,e,t);return{C:A.map((function(A,t){return A.filter((function(A,t){return t<e&&!l(s(n[t],n[t]))}))})),F:n.filter((function(A,e){return!l(s(n[e],n[e]))}))}}(A,e,t),r=i.C,B=i.F,g=c(n(c(a(r),r)),a(r)),Q=c(a(B),n(c(B,a(B))));return c(Q,g)}function l(A){return r(E(A,Q(1,1)),E(0,Q(1,1)))}function w(A){return i(E(A,Q(1,1)),E(c(A,0),Q(1,1)))}}));function ME(A,e){var t="undefined"!=typeof Symbol&&A[Symbol.iterator]||A["@@iterator"];if(!t){if(Array.isArray(A)||(t=function(A,e){if(A){if("string"==typeof A)return dE(A,e);var t=Object.prototype.toString.call(A).slice(8,-1);return"Object"===t&&A.constructor&&(t=A.constructor.name),"Map"===t||"Set"===t?Array.from(A):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?dE(A,e):void 0}}(A))||e&&A&&"number"==typeof A.length){t&&(A=t);var n=0,i=function(){};return{s:i,n:function(){return n>=A.length?{done:!0}:{done:!1,value:A[n++]}},e:function(A){throw A},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){t=t.call(A)},n:function(){var A=t.next();return o=A.done,A},e:function(A){s=!0,r=A},f:function(){try{o||null==t.return||t.return()}finally{if(s)throw r}}}}function dE(A,e){(null==e||e>A.length)&&(e=A.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=A[t];return n}var mE=mA("eigs",["config","typed","matrix","addScalar","equal","subtract","abs","atan","cos","sin","multiplyScalar","divideScalar","inv","bignumber","multiply","add","larger","column","flatten","number","complex","sqrt","diag","qr","usolve","usolveAll","im","re","smaller","matrixFromColumns","dot"],(function(A){var e=A.config,n=A.typed,i=A.matrix,a=A.addScalar,B=A.subtract,c=A.equal,g=A.abs,E=A.atan,Q=A.cos,u=A.sin,l=A.multiplyScalar,w=A.divideScalar,h=A.inv,C=A.bignumber,I=A.multiply,M=A.add,d=A.larger,m=A.column,p=A.flatten,F=A.number,D=A.complex,Y=A.sqrt,f=A.diag,N=A.qr,U=A.usolve,y=A.usolveAll,T=A.im,x=A.re,R=A.smaller,G=A.matrixFromColumns,S=A.dot,H=function(A){var e=A.config,t=A.addScalar,n=A.subtract,i=A.abs,r=A.atan,o=A.cos,s=A.sin,a=A.multiplyScalar,B=A.inv,c=A.bignumber,g=A.multiply,E=A.add;function Q(A,e,t,n){for(var i=A.length,r=Math.cos(e),o=Math.sin(e),s=M(i,0),a=M(i,0),B=0;B<i;B++)s[B]=r*A[B][t]-o*A[B][n],a[B]=o*A[B][t]+r*A[B][n];for(var c=0;c<i;c++)A[c][t]=s[c],A[c][n]=a[c];return A}function u(A,e,i,r){for(var B=A.length,g=o(e),E=s(e),Q=M(B,c(0)),u=M(B,c(0)),l=0;l<B;l++)Q[l]=n(a(g,A[l][i]),a(E,A[l][r])),u[l]=t(a(E,A[l][i]),a(g,A[l][r]));for(var w=0;w<B;w++)A[w][i]=Q[w],A[w][r]=u[w];return A}function l(A,e,i,r){for(var B=A.length,Q=c(o(e)),u=c(s(e)),l=a(Q,Q),w=a(u,u),h=M(B,c(0)),C=M(B,c(0)),I=g(c(2),Q,u,A[i][r]),d=t(n(a(l,A[i][i]),I),a(w,A[r][r])),m=E(a(w,A[i][i]),I,a(l,A[r][r])),p=0;p<B;p++)h[p]=n(a(Q,A[i][p]),a(u,A[r][p])),C[p]=t(a(u,A[i][p]),a(Q,A[r][p]));A[i][i]=d,A[r][r]=m,A[i][r]=c(0),A[r][i]=c(0);for(var F=0;F<B;F++)F!==i&&F!==r&&(A[i][F]=h[F],A[F][i]=h[F],A[r][F]=C[F],A[F][r]=C[F]);return A}function w(A,e,t,n){for(var i=A.length,r=Math.cos(e),o=Math.sin(e),s=r*r,a=o*o,B=M(i,0),c=M(i,0),g=s*A[t][t]-2*r*o*A[t][n]+a*A[n][n],E=a*A[t][t]+2*r*o*A[t][n]+s*A[n][n],Q=0;Q<i;Q++)B[Q]=r*A[t][Q]-o*A[n][Q],c[Q]=o*A[t][Q]+r*A[n][Q];A[t][t]=g,A[n][n]=E,A[t][n]=0,A[n][t]=0;for(var u=0;u<i;u++)u!==t&&u!==n&&(A[t][u]=B[u],A[u][t]=B[u],A[n][u]=c[u],A[u][n]=c[u]);return A}function h(A){for(var e=A.length,t=0,n=[0,1],i=0;i<e;i++)for(var r=i+1;r<e;r++)Math.abs(t)<Math.abs(A[i][r])&&(t=Math.abs(A[i][r]),n=[i,r]);return[n,t]}function C(A){for(var e=A.length,t=0,n=[0,1],r=0;r<e;r++)for(var o=r+1;o<e;o++)i(t)<i(A[r][o])&&(t=i(A[r][o]),n=[r,o]);return[n,t]}function I(A,e){for(var t=A.length,n=Array(t),r=Array(t),o=0;o<t;o++)r[o]=Array(t);for(var s=0;s<t;s++){for(var a=0,B=A[0],c=0;c<A.length;c++)i(A[c])<i(B)&&(B=A[a=c]);n[s]=A.splice(a,1)[0];for(var g=0;g<t;g++)r[g][s]=e[g][a],e[g].splice(a,1)}return{values:n,vectors:r}}function M(A,e){for(var t=new Array(A),n=0;n<A;n++)t[n]=e;return t}return function(A,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.epsilon,s=arguments.length>3?arguments[3]:void 0;if("number"===s)return function(A,t){for(var n,i=A.length,r=Math.abs(t/i),o=new Array(i),s=0;s<i;s++)o[s]=M(i,0),o[s][s]=1;for(var a,B,c,g,E=h(A);Math.abs(E[1])>=Math.abs(r);){var u=E[0][0],l=E[0][1];A=w(A,(a=A[u][u],B=A[l][l],c=A[u][l],g=B-a,n=Math.abs(g)<=e.epsilon?Math.PI/4:.5*Math.atan(2*c/(B-a))),u,l),o=Q(o,n,u,l),E=h(A)}for(var C=M(i,0),d=0;d<i;d++)C[d]=A[d][d];return I(uA(C),uA(o))}(A,o);if("BigNumber"===s)return function(A,t){for(var o,s=A.length,E=i(t/s),Q=new Array(s),w=0;w<s;w++)Q[w]=M(s,0),Q[w][w]=1;for(var h,d,m,p,F=C(A);i(F[1])>=i(E);){var D=F[0][0],Y=F[0][1];A=l(A,(h=A[D][D],d=A[Y][Y],m=A[D][Y],p=n(d,h),o=i(p)<=e.epsilon?c(-1).acos().div(4):a(.5,r(g(2,m,B(p))))),D,Y),Q=u(Q,o,D,Y),F=C(A)}for(var f=M(s,0),N=0;N<s;N++)f[N]=A[N][N];return I(uA(f),uA(Q))}(A,o);throw TypeError("Unsupported data type: "+s)}}({config:e,addScalar:a,subtract:B,column:m,flatten:p,equal:c,abs:g,atan:E,cos:Q,sin:u,multiplyScalar:l,inv:h,bignumber:C,complex:D,multiply:I,add:M}),b=function(A){var e=A.addScalar,t=A.subtract,n=A.flatten,i=A.multiply,r=A.multiplyScalar,o=A.divideScalar,s=A.sqrt,a=A.abs,B=A.bignumber,c=A.diag,g=A.inv,E=A.qr,Q=A.usolve,u=A.usolveAll,l=A.equal,w=A.complex,h=A.larger,C=A.smaller,I=A.matrixFromColumns,M=A.dot;function d(A,e,n,i,r,o,s,c){var g="BigNumber"===c,E="Complex"===c,Q=g?B(0):E?w(0):0,u=g?B(1):E?w(1):1;if(C(a(n),s))return[[u,Q],[Q,u]];if(h(a(t(r,o)),s))return[[t(r,i),t(o,i)],[n,n]];var l=t(A,r),I=t(e,r),M=t(n,r),d=t(i,r);return C(a(I),s)?[[l,u],[M,Q]]:[[I,Q],[d,u]]}function m(A,e){for(var t=0;t<A.length;t++){var n;(n=A[t]).push.apply(n,zt(Array(e-A[t].length).fill(0)))}for(var i=A.length;i<e;i++)A.push(Array(e).fill(0)),A[i][i]=1;return A}function p(A,e,t){for(var n=0;n<A.length;n++)if(t(A[n],e))return n;return-1}function F(A,e,t,n,i){for(var r,o="BigNumber"===i?B(1e3):1e3,s=0;r=D(e,t,i),r=Q(A,r),!h(f(r),o);)if(++s>=5)return null;for(s=0;;){var a=Q(A,r);if(C(f(Y(r,[a])),n))break;if(++s>=10)return null;r=N(a)}return r}function D(A,e,t){var n="BigNumber"===t,i="Complex"===t,r=Array(A).fill(0).map((function(A){return 2*Math.random()-1}));return n&&(r=r.map((function(A){return B(A)}))),i&&(r=r.map((function(A){return w(A)}))),N(r=Y(r,e),t)}function Y(A,e){var n,r=ME(e);try{for(r.s();!(n=r.n()).done;){var s=n.value;A=t(A,i(o(M(s,A),M(s,s)),s))}}catch(A){r.e(A)}finally{r.f()}return A}function f(A){return a(s(M(A,A)))}function N(A,e){var t="Complex"===e,n="BigNumber"===e?B(1):t?w(1):1;return i(o(n,f(A)),A)}return function(A,Q,M,D,Y){void 0===Y&&(Y=!0);var f=function(A,t,n,i,s){var g,E="BigNumber"===i,Q="Complex"===i,u=E?B(0):0,I=E?B(1):Q?w(1):1,M=E?B(1):1,d=E?B(10):2,m=r(d,d);s&&(g=Array(t).fill(I));for(var p=!1;!p;){p=!0;for(var F=0;F<t;F++){for(var D=u,Y=u,f=0;f<t;f++)if(F!==f){var N=a(A[F][f]);D=e(D,N),Y=e(Y,N)}if(!l(D,0)&&!l(Y,0)){for(var U=M,y=D,T=o(Y,d),x=r(Y,d);C(y,T);)y=r(y,m),U=r(U,d);for(;h(y,x);)y=o(y,m),U=o(U,d);if(C(o(e(y,Y),U),r(e(D,Y),.95))){p=!1;for(var R=o(1,U),G=0;G<t;G++)F!==G&&(A[F][G]=r(A[F][G],U),A[G][F]=r(A[G][F],R));s&&(g[F]=r(g[F],U))}}}}return c(g)}(A,Q,0,D,Y);!function(A,n,i,s,c,g){var E="BigNumber"===s,Q="Complex"===s,u=E?B(0):Q?w(0):0;E&&(i=B(i));for(var l=0;l<n-2;l++){for(var h=0,I=u,M=l+1;M<n;M++){var d=A[M][l];C(a(I),a(d))&&(I=d,h=M)}if(!C(a(I),i)){if(h!==l+1){var m=A[h];A[h]=A[l+1],A[l+1]=m;for(var p=0;p<n;p++){var F=A[p][h];A[p][h]=A[p][l+1],A[p][l+1]=F}if(c){var D=g[h];g[h]=g[l+1],g[l+1]=D}}for(var Y=l+2;Y<n;Y++){var f=o(A[Y][l],I);if(0!==f){for(var N=0;N<n;N++)A[Y][N]=t(A[Y][N],r(f,A[l+1][N]));for(var U=0;U<n;U++)A[U][l+1]=e(A[U][l+1],r(f,A[U][Y]));if(c)for(var y=0;y<n;y++)g[Y][y]=t(g[Y][y],r(f,g[l+1][y]))}}}}}(A,Q,M,D,Y,f);var N,U=function(A,n,o,g,Q){var u="BigNumber"===g,l="Complex"===g,h=u?B(1):l?w(1):1;u&&(o=B(o));for(var I,M,p,F,D,Y,f,N,U=uA(A),y=[],T=n,x=[],R=Q?c(Array(n).fill(h)):void 0,G=Q?c(Array(T).fill(h)):void 0,S=0;S<=100;){S+=1;for(var H=0;H<T;H++)U[H][H]=t(U[H][H],0);var b=E(U),v=b.Q,k=b.R;U=i(k,v);for(var j=0;j<T;j++)U[j][j]=e(U[j][j],0);if(Q&&(G=i(G,v)),1===T||C(a(U[T-1][T-2]),o)){S=0,y.push(U[T-1][T-1]),Q&&(x.unshift([[1]]),m(G,n),R=i(R,G),T>1&&(G=c(Array(T-1).fill(h)))),T-=1,U.pop();for(var J=0;J<T;J++)U[J].pop()}else if(2===T||C(a(U[T-2][T-3]),o)){S=0;var z=(I=U[T-2][T-2],M=U[T-2][T-1],p=U[T-1][T-2],F=U[T-1][T-1],D=e(I,F),Y=t(r(I,F),r(M,p)),f=r(D,.5),N=r(s(t(r(D,D),r(4,Y))),.5),[e(f,N),t(f,N)]);y.push.apply(y,zt(z)),Q&&(x.unshift(d(U[T-2][T-2],U[T-2][T-1],U[T-1][T-2],U[T-1][T-1],z[0],z[1],o,g)),m(G,n),R=i(R,G),T>2&&(G=c(Array(T-2).fill(h)))),T-=2,U.pop(),U.pop();for(var L=0;L<T;L++)U[L].pop(),U[L].pop()}if(0===T)break}if(y.sort((function(A,e){return+t(a(A),a(e))})),S>100){var P=Error("The eigenvalues failed to converge. Only found these eigenvalues: "+y.join(", "));throw P.values=y,P.vectors=[],P}return{values:y,C:Q?i(R,function(A,e){for(var t=[],n=0;n<e;n++)t[n]=Array(e).fill(0);var i,r=0,o=ME(A);try{for(o.s();!(i=o.n()).done;){for(var s=i.value,a=s.length,B=0;B<a;B++)for(var c=0;c<a;c++)t[r+B][r+c]=s[B][c];r+=a}}catch(A){o.e(A)}finally{o.f()}return t}(x,n)):void 0}}(A,Q,M,D,Y),y=U.values,T=U.C;return Y&&(N=function(A,e,r,o,s,a,E){var Q,h=g(r),C=i(h,A,r),I="BigNumber"===E,M="Complex"===E,d=I?B(0):M?w(0):0,m=I?B(1):M?w(1):1,D=[],Y=[],f=ME(s);try{for(f.s();!(Q=f.n()).done;){var N=Q.value,U=p(D,N,l);-1===U?(D.push(N),Y.push(1)):Y[U]+=1}}catch(b){f.e(b)}finally{f.f()}for(var y=[],T=D.length,x=Array(e).fill(d),R=c(Array(e).fill(m)),G=[],S=function(){var A=D[H],s=t(C,i(A,R)),B=u(s,x);for(B.shift();B.length<Y[H];){var c=F(s,e,B,a,E);if(null==c){G.push(A);break}B.push(c)}var Q=i(g(o),r);B=B.map((function(A){return i(Q,A)})),y.push.apply(y,zt(B.map((function(A){return n(A)}))))},H=0;H<T;H++)S();if(0!==G.length){var b=new Error("Failed to find eigenvectors for the following eigenvalues: "+G.join(", "));throw b.values=s,b.vectors=y,b}return y}(A,Q,T,f,y,M,D),N=I.apply(void 0,zt(N))),{values:y,vectors:N}}}({config:e,addScalar:a,subtract:B,multiply:I,multiplyScalar:l,flatten:p,divideScalar:w,sqrt:Y,abs:g,bignumber:C,diag:f,qr:N,inv:h,usolve:U,usolveAll:y,equal:c,complex:D,larger:d,smaller:R,matrixFromColumns:G,dot:S});return n("eigs",{Array:function(A){return v(i(A))},"Array, number|BigNumber":function(A,e){return v(i(A),e)},Matrix:function(A){var e=v(A),t=e.values,n=e.vectors;return{values:i(t),vectors:i(n)}},"Matrix, number|BigNumber":function(A,e){var t=v(A,e),n=t.values,r=t.vectors;return{values:i(n),vectors:i(r)}}});function v(A,t){void 0===t&&(t=e.epsilon);var n=A.size();if(2!==n.length||n[0]!==n[1])throw new RangeError("Matrix must be square (size: "+Vt(n)+")");var i=A.toArray(),r=n[0];if(function(A,e,t){for(var n=0;n<e;n++)for(var i=0;i<e;i++)if(d(C(g(T(A[n][i]))),t))return!1;return!0}(i,r,t)&&(function(A,e){for(var t=0;t<e;t++)for(var n=0;n<e;n++)A[t][n]=x(A[t][n])}(i,r),function(A,e,t){for(var n=0;n<e;n++)for(var i=n;i<e;i++)if(d(C(g(B(A[n][i],A[i][n]))),t))return!1;return!0}(i,r,t))){var o=k(A,i,r);return H(i,r,t,o)}var s=k(A,i,r);return b(i,r,t,s)}function k(A,e,n){var i=A.datatype();if("number"===i||"BigNumber"===i||"Complex"===i)return i;for(var a=!1,B=!1,c=!1,g=0;g<n;g++)for(var E=0;E<n;E++){var Q=e[g][E];if(t(Q)||s(Q))a=!0;else if(r(Q))B=!0;else{if(!o(Q))throw TypeError("Unsupported type in Matrix: "+P(Q));c=!0}}if(B&&c&&console.warn("Complex BigNumbers not supported, this operation will lose precission."),c){for(var u=0;u<n;u++)for(var l=0;l<n;l++)e[u][l]=D(e[u][l]);return"Complex"}if(B){for(var w=0;w<n;w++)for(var h=0;h<n;h++)e[w][h]=C(e[w][h]);return"BigNumber"}if(a){for(var I=0;I<n;I++)for(var M=0;M<n;M++)e[I][M]=F(e[I][M]);return"number"}throw TypeError("Matrix contains unsupported types only.")}})),pE=mA("expm",["typed","abs","add","identity","inv","multiply"],(function(A){var e=A.typed,t=A.abs,n=A.add,i=A.identity,r=A.inv,o=A.multiply;return e("expm",{Matrix:function(A){var e=A.size();if(2!==e.length||e[0]!==e[1])throw new RangeError("Matrix must be square (size: "+Vt(e)+")");for(var a=e[0],B=function(A,e){for(var t=0;t<30;t++)for(var n=0;n<=t;n++){var i=t-n;if(s(A,n,i)<1e-15)return{q:n,j:i}}throw new Error("Could not find acceptable parameters to compute the matrix exponential (try increasing maxSearchSize in expm.js)")}(function(A){for(var e=A.size()[0],n=0,i=0;i<e;i++){for(var r=0,o=0;o<e;o++)r+=t(A.get([i,o]));n=Math.max(r,n)}return n}(A)),c=B.q,g=B.j,E=o(A,Math.pow(2,-g)),Q=i(a),l=i(a),w=1,h=E,C=-1,I=1;I<=c;I++)I>1&&(h=o(h,E),C=-C),Q=n(Q,o(w=w*(c-I+1)/((2*c-I+1)*I),h)),l=n(l,o(w*C,h));for(var M=o(r(l),Q),d=0;d<g;d++)M=o(M,M);return u(A)?A.createSparseMatrix(M):M}});function s(A,e,t){for(var n=1,i=2;i<=e;i++)n*=i;for(var r=n,o=e+1;o<=2*e;o++)r*=o;var s=r*(2*e+1);return 8*Math.pow(A/Math.pow(2,t),2*e)*n*n/(r*s)}})),FE=mA("sqrtm",["typed","abs","add","multiply","map","sqrt","subtract","inv","size","max","identity"],(function(A){var e=A.typed,t=A.abs,n=A.add,i=A.multiply,r=A.map,o=A.sqrt,s=A.subtract,a=A.inv,B=A.size,c=A.max,E=A.identity,Q=1e-6;return e("sqrtm",{"Array | Matrix":function(A){var e=g(A)?A.size():$t(A);switch(e.length){case 1:if(1===e[0])return r(A,o);throw new RangeError("Matrix must be square (size: "+Vt(e)+")");case 2:if(e[0]===e[1])return function(A){var e,r=0,o=A,g=E(B(A));do{var u=o;if(o=i(.5,n(u,a(g))),g=i(.5,n(g,a(u))),(e=c(t(s(o,u))))>Q&&++r>1e3)throw new Error("computing square root of matrix: iterative method could not converge")}while(e>Q);return o}(A);throw new RangeError("Matrix must be square (size: "+Vt(e)+")");default:throw new RangeError("Matrix must be at most two dimensional (size: "+Vt(e)+")")}}})})),DE="sylvester",YE=mA(DE,["typed","schur","matrixFromColumns","matrix","multiply","range","concat","transpose","index","subset","add","subtract","identity","lusolve","abs"],(function(A){var e=A.typed,t=A.schur,n=A.matrixFromColumns,i=A.matrix,r=A.multiply,o=A.range,s=A.concat,a=A.transpose,B=A.index,c=A.subset,g=A.add,E=A.subtract,Q=A.identity,u=A.lusolve,l=A.abs;return e(DE,{"Matrix, Matrix, Matrix":w,"Array, Matrix, Matrix":function(A,e,t){return w(i(A),e,t)},"Array, Array, Matrix":function(A,e,t){return w(i(A),i(e),t)},"Array, Matrix, Array":function(A,e,t){return w(i(A),e,i(t))},"Matrix, Array, Matrix":function(A,e,t){return w(A,i(e),t)},"Matrix, Array, Array":function(A,e,t){return w(A,i(e),i(t))},"Matrix, Matrix, Array":function(A,e,t){return w(A,e,i(t))},"Array, Array, Array":function(A,e,t){return w(i(A),i(e),i(t)).toArray()}});function w(A,e,w){for(var h=e.size()[0],C=A.size()[0],I=t(A),M=I.T,d=I.U,m=t(r(-1,e)),p=m.T,F=m.U,D=r(r(a(d),w),F),Y=o(0,C),f=[],N=function(A,e){return s(A,e,1)},U=function(A,e){return s(A,e,0)},y=0;y<h;y++)if(y<h-1&&l(c(p,B(y+1,y)))>1e-5){for(var T=U(c(D,B(Y,y)),c(D,B(Y,y+1))),x=0;x<y;x++)T=g(T,U(r(f[x],c(p,B(x,y))),r(f[x],c(p,B(x,y+1)))));var R=r(Q(C),r(-1,c(p,B(y,y)))),G=r(Q(C),r(-1,c(p,B(y+1,y)))),S=r(Q(C),r(-1,c(p,B(y,y+1)))),H=r(Q(C),r(-1,c(p,B(y+1,y+1)))),b=U(N(g(M,R),G),N(S,g(M,H))),v=u(b,T);f[y]=v.subset(B(o(0,C),0)),f[y+1]=v.subset(B(o(C,2*C),0)),y++}else{for(var k=c(D,B(Y,y)),j=0;j<y;j++)k=g(k,r(f[j],c(p,B(j,y))));var J=c(p,B(y,y)),z=E(M,r(J,Q(C)));f[y]=u(z,k)}var L=i(n.apply(void 0,f));return r(d,r(L,a(F)))}})),fE=mA("schur",["typed","matrix","identity","multiply","qr","norm","subtract"],(function(A){var e=A.typed,t=A.matrix,n=A.identity,i=A.multiply,r=A.qr,o=A.norm,s=A.subtract;return e("schur",{Array:function(A){var e=a(t(A));return{U:e.U.valueOf(),T:e.T.valueOf()}},Matrix:function(A){return a(A)}});function a(A){var e,t=A.size()[0],a=A,B=n(t),c=0;do{e=a;var g=r(a),E=g.Q,Q=g.R;if(a=i(Q,E),B=i(B,E),c++>100)break}while(o(s(a,e))>1e-4);return{U:B,T:a}}})),NE=mA("lyap",["typed","matrix","sylvester","multiply","transpose"],(function(A){var e=A.typed,t=A.matrix,n=A.sylvester,i=A.multiply,r=A.transpose;return e("lyap",{"Matrix, Matrix":function(A,e){return n(A,r(A),i(-1,e))},"Array, Matrix":function(A,e){return n(t(A),r(t(A)),i(-1,e))},"Matrix, Array":function(A,e){return n(A,r(t(A)),t(i(-1,e)))},"Array, Array":function(A,e){return n(t(A),r(t(A)),t(i(-1,e))).toArray()}})})),UE=mA("divide",["typed","matrix","multiply","equalScalar","divideScalar","inv"],(function(A){var e=A.typed,t=A.matrix,n=A.multiply,i=A.equalScalar,r=A.divideScalar,o=A.inv,s=rr({typed:e,equalScalar:i}),a=sr({typed:e});return e("divide",wA({"Array | Matrix, Array | Matrix":function(A,e){return n(A,o(e))},"DenseMatrix, any":function(A,e){return a(A,e,r,!1)},"SparseMatrix, any":function(A,e){return s(A,e,r,!1)},"Array, any":function(A,e){return a(t(A),e,r,!1).valueOf()},"any, Array | Matrix":function(A,e){return n(A,o(e))}},r.signatures))})),yE="distance",TE=mA(yE,["typed","addScalar","subtractScalar","divideScalar","multiplyScalar","deepEqual","sqrt","abs"],(function(A){var e=A.typed,t=A.addScalar,n=A.subtractScalar,i=A.multiplyScalar,o=A.divideScalar,s=A.deepEqual,a=A.sqrt,B=A.abs;return e(yE,{"Array, Array, Array":function(A,e,t){if(2===A.length&&2===e.length&&2===t.length){if(!g(A))throw new TypeError("Array with 2 numbers or BigNumbers expected for first argument");if(!g(e))throw new TypeError("Array with 2 numbers or BigNumbers expected for second argument");if(!g(t))throw new TypeError("Array with 2 numbers or BigNumbers expected for third argument");if(s(e,t))throw new TypeError("LinePoint1 should not be same with LinePoint2");var r=n(t[1],e[1]),o=n(e[0],t[0]),a=n(i(t[0],e[1]),i(e[0],t[1]));return w(A[0],A[1],r,o,a)}throw new TypeError("Invalid Arguments: Try again")},"Object, Object, Object":function(A,e,t){if(2===Object.keys(A).length&&2===Object.keys(e).length&&2===Object.keys(t).length){if(!g(A))throw new TypeError("Values of pointX and pointY should be numbers or BigNumbers");if(!g(e))throw new TypeError("Values of lineOnePtX and lineOnePtY should be numbers or BigNumbers");if(!g(t))throw new TypeError("Values of lineTwoPtX and lineTwoPtY should be numbers or BigNumbers");if(s(l(e),l(t)))throw new TypeError("LinePoint1 should not be same with LinePoint2");if("pointX"in A&&"pointY"in A&&"lineOnePtX"in e&&"lineOnePtY"in e&&"lineTwoPtX"in t&&"lineTwoPtY"in t){var r=n(t.lineTwoPtY,e.lineOnePtY),o=n(e.lineOnePtX,t.lineTwoPtX),a=n(i(t.lineTwoPtX,e.lineOnePtY),i(e.lineOnePtX,t.lineTwoPtY));return w(A.pointX,A.pointY,r,o,a)}throw new TypeError("Key names do not match")}throw new TypeError("Invalid Arguments: Try again")},"Array, Array":function(A,e){if(2===A.length&&3===e.length){if(!g(A))throw new TypeError("Array with 2 numbers or BigNumbers expected for first argument");if(!E(e))throw new TypeError("Array with 3 numbers or BigNumbers expected for second argument");return w(A[0],A[1],e[0],e[1],e[2])}if(3===A.length&&6===e.length){if(!E(A))throw new TypeError("Array with 3 numbers or BigNumbers expected for first argument");if(!u(e))throw new TypeError("Array with 6 numbers or BigNumbers expected for second argument");return h(A[0],A[1],A[2],e[0],e[1],e[2],e[3],e[4],e[5])}if(A.length===e.length&&A.length>0){if(!Q(A))throw new TypeError("All values of an array should be numbers or BigNumbers");if(!Q(e))throw new TypeError("All values of an array should be numbers or BigNumbers");return C(A,e)}throw new TypeError("Invalid Arguments: Try again")},"Object, Object":function(A,e){if(2===Object.keys(A).length&&3===Object.keys(e).length){if(!g(A))throw new TypeError("Values of pointX and pointY should be numbers or BigNumbers");if(!E(e))throw new TypeError("Values of xCoeffLine, yCoeffLine and constant should be numbers or BigNumbers");if("pointX"in A&&"pointY"in A&&"xCoeffLine"in e&&"yCoeffLine"in e&&"constant"in e)return w(A.pointX,A.pointY,e.xCoeffLine,e.yCoeffLine,e.constant);throw new TypeError("Key names do not match")}if(3===Object.keys(A).length&&6===Object.keys(e).length){if(!E(A))throw new TypeError("Values of pointX, pointY and pointZ should be numbers or BigNumbers");if(!u(e))throw new TypeError("Values of x0, y0, z0, a, b and c should be numbers or BigNumbers");if("pointX"in A&&"pointY"in A&&"x0"in e&&"y0"in e&&"z0"in e&&"a"in e&&"b"in e&&"c"in e)return h(A.pointX,A.pointY,A.pointZ,e.x0,e.y0,e.z0,e.a,e.b,e.c);throw new TypeError("Key names do not match")}if(2===Object.keys(A).length&&2===Object.keys(e).length){if(!g(A))throw new TypeError("Values of pointOneX and pointOneY should be numbers or BigNumbers");if(!g(e))throw new TypeError("Values of pointTwoX and pointTwoY should be numbers or BigNumbers");if("pointOneX"in A&&"pointOneY"in A&&"pointTwoX"in e&&"pointTwoY"in e)return C([A.pointOneX,A.pointOneY],[e.pointTwoX,e.pointTwoY]);throw new TypeError("Key names do not match")}if(3===Object.keys(A).length&&3===Object.keys(e).length){if(!E(A))throw new TypeError("Values of pointOneX, pointOneY and pointOneZ should be numbers or BigNumbers");if(!E(e))throw new TypeError("Values of pointTwoX, pointTwoY and pointTwoZ should be numbers or BigNumbers");if("pointOneX"in A&&"pointOneY"in A&&"pointOneZ"in A&&"pointTwoX"in e&&"pointTwoY"in e&&"pointTwoZ"in e)return C([A.pointOneX,A.pointOneY,A.pointOneZ],[e.pointTwoX,e.pointTwoY,e.pointTwoZ]);throw new TypeError("Key names do not match")}throw new TypeError("Invalid Arguments: Try again")},Array:function(A){if(!function(A){if(2===A[0].length&&c(A[0][0])&&c(A[0][1])){if(A.some((function(A){return 2!==A.length||!c(A[0])||!c(A[1])})))return!1}else{if(!(3===A[0].length&&c(A[0][0])&&c(A[0][1])&&c(A[0][2])))return!1;if(A.some((function(A){return 3!==A.length||!c(A[0])||!c(A[1])||!c(A[2])})))return!1}return!0}(A))throw new TypeError("Incorrect array format entered for pairwise distance calculation");return function(A){for(var e=[],t=[],n=[],i=0;i<A.length-1;i++)for(var r=i+1;r<A.length;r++)2===A[0].length?(t=[A[i][0],A[i][1]],n=[A[r][0],A[r][1]]):3===A[0].length&&(t=[A[i][0],A[i][1],A[i][2]],n=[A[r][0],A[r][1],A[r][2]]),e.push(C(t,n));return e}(A)}});function c(A){return"number"==typeof A||r(A)}function g(A){return A.constructor!==Array&&(A=l(A)),c(A[0])&&c(A[1])}function E(A){return A.constructor!==Array&&(A=l(A)),c(A[0])&&c(A[1])&&c(A[2])}function Q(A){return Array.isArray(A)||(A=l(A)),A.every(c)}function u(A){return A.constructor!==Array&&(A=l(A)),c(A[0])&&c(A[1])&&c(A[2])&&c(A[3])&&c(A[4])&&c(A[5])}function l(A){for(var e=Object.keys(A),t=[],n=0;n<e.length;n++)t.push(A[e[n]]);return t}function w(A,e,n,r,s){var c=B(t(t(i(n,A),i(r,e)),s)),g=a(t(i(n,n),i(r,r)));return o(c,g)}function h(A,e,r,s,B,c,g,E,Q){var u=[n(i(n(B,e),Q),i(n(c,r),E)),n(i(n(c,r),g),i(n(s,A),Q)),n(i(n(s,A),E),i(n(B,e),g))];u=a(t(t(i(u[0],u[0]),i(u[1],u[1])),i(u[2],u[2])));var l=a(t(t(i(g,g),i(E,E)),i(Q,Q)));return o(u,l)}function C(A,e){for(var r=A.length,o=0,s=0,B=0;B<r;B++)s=n(A[B],e[B]),o=t(i(s,s),o);return a(o)}})),xE=mA("intersect",["typed","config","abs","add","addScalar","matrix","multiply","multiplyScalar","divideScalar","subtract","smaller","equalScalar","flatten","isZero","isNumeric"],(function(A){var e=A.typed,t=A.config,n=A.abs,i=A.add,r=A.addScalar,o=A.matrix,s=A.multiply,a=A.multiplyScalar,B=A.divideScalar,c=A.subtract,g=A.smaller,E=A.equalScalar,Q=A.flatten,u=A.isZero,l=A.isNumeric;return e("intersect",{"Array, Array, Array":w,"Array, Array, Array, Array":h,"Matrix, Matrix, Matrix":function(A,e,t){var n=w(A.valueOf(),e.valueOf(),t.valueOf());return null===n?null:o(n)},"Matrix, Matrix, Matrix, Matrix":function(A,e,t,n){var i=h(A.valueOf(),e.valueOf(),t.valueOf(),n.valueOf());return null===i?null:o(i)}});function w(A,e,t){if(A=C(A),e=C(e),t=C(t),!M(A))throw new TypeError("Array with 3 numbers or BigNumbers expected for first argument");if(!M(e))throw new TypeError("Array with 3 numbers or BigNumbers expected for second argument");if(!function(A){return 4===A.length&&l(A[0])&&l(A[1])&&l(A[2])&&l(A[3])}(t))throw new TypeError("Array with 4 numbers expected as third argument");return function(A,e,t,n,i,o,s,g,E,Q){var u=a(A,s),l=a(n,s),w=a(e,g),h=a(i,g),C=a(t,E),I=a(o,E),M=c(c(c(Q,u),w),C),d=c(c(c(r(r(l,h),I),u),w),C),m=B(M,d);return[r(A,a(m,c(n,A))),r(e,a(m,c(i,e))),r(t,a(m,c(o,t)))]}(A[0],A[1],A[2],e[0],e[1],e[2],t[0],t[1],t[2],t[3])}function h(A,e,o,Q){if(A=C(A),e=C(e),o=C(o),Q=C(Q),2===A.length){if(!I(A))throw new TypeError("Array with 2 numbers or BigNumbers expected for first argument");if(!I(e))throw new TypeError("Array with 2 numbers or BigNumbers expected for second argument");if(!I(o))throw new TypeError("Array with 2 numbers or BigNumbers expected for third argument");if(!I(Q))throw new TypeError("Array with 2 numbers or BigNumbers expected for fourth argument");return function(A,e,o,E){var Q=A,l=o,w=c(Q,e),h=c(l,E),C=c(a(w[0],h[1]),a(h[0],w[1]));if(u(C))return null;if(g(n(C),t.epsilon))return null;var I=a(h[0],Q[1]),M=a(h[1],Q[0]),d=a(h[0],l[1]),m=a(h[1],l[0]),p=B(r(c(c(I,M),d),m),C);return i(s(w,p),Q)}(A,e,o,Q)}if(3===A.length){if(!M(A))throw new TypeError("Array with 3 numbers or BigNumbers expected for first argument");if(!M(e))throw new TypeError("Array with 3 numbers or BigNumbers expected for second argument");if(!M(o))throw new TypeError("Array with 3 numbers or BigNumbers expected for third argument");if(!M(Q))throw new TypeError("Array with 3 numbers or BigNumbers expected for fourth argument");return function(A,e,t,n,i,o,s,g,Q,l,w,h){var C=d(A,s,l,s,e,g,w,g,t,Q,h,Q),I=d(l,s,n,A,w,g,i,e,h,Q,o,t),M=d(A,s,n,A,e,g,i,e,t,Q,o,t),m=d(l,s,l,s,w,g,w,g,h,Q,h,Q),p=d(n,A,n,A,i,e,i,e,o,t,o,t),F=c(a(C,I),a(M,m)),D=c(a(p,m),a(I,I));if(u(D))return null;var Y=B(F,D),f=B(r(C,a(Y,I)),m),N=r(A,a(Y,c(n,A))),U=r(e,a(Y,c(i,e))),y=r(t,a(Y,c(o,t))),T=r(s,a(f,c(l,s))),x=r(g,a(f,c(w,g))),R=r(Q,a(f,c(h,Q)));return E(N,T)&&E(U,x)&&E(y,R)?[N,U,y]:null}(A[0],A[1],A[2],e[0],e[1],e[2],o[0],o[1],o[2],Q[0],Q[1],Q[2])}throw new TypeError("Arrays with two or thee dimensional points expected")}function C(A){return 1===A.length?A[0]:A.length>1&&Array.isArray(A[0])&&A.every((function(A){return Array.isArray(A)&&1===A.length}))?Q(A):A}function I(A){return 2===A.length&&l(A[0])&&l(A[1])}function M(A){return 3===A.length&&l(A[0])&&l(A[1])&&l(A[2])}function d(A,e,t,n,i,o,s,B,g,E,Q,u){var l=a(c(A,e),c(t,n)),w=a(c(i,o),c(s,B)),h=a(c(g,E),c(Q,u));return r(r(l,w),h)}})),RE=mA("sum",["typed","config","add","numeric"],(function(A){var e=A.typed,t=A.config,n=A.add,i=A.numeric;return e("sum",{"Array | Matrix":r,"Array | Matrix, number | BigNumber":function(A,e){try{return Sn(A,e,n)}catch(A){throw vs(A,"sum")}},"...":function(A){if(xn(A))throw new TypeError("Scalar values expected in function sum");return r(A)}});function r(A){var e;return Rn(A,(function(A){try{e=void 0===e?A:n(e,A)}catch(e){throw vs(e,"sum",A)}})),void 0===e&&(e=i(0,t.number)),"string"==typeof e&&(e=i(e,t.number)),e}})),GE="cumsum",SE=mA(GE,["typed","add","unaryPlus"],(function(A){var e=A.typed,t=A.add,n=A.unaryPlus;return e(GE,{Array:i,Matrix:function(A){return A.create(i(A.valueOf()))},"Array, number | BigNumber":o,"Matrix, number | BigNumber":function(A,e){return A.create(o(A.valueOf(),e))},"...":function(A){if(xn(A))throw new TypeError("All values expected to be scalar in function cumsum");return i(A)}});function i(A){try{return r(A)}catch(A){throw vs(A,GE)}}function r(A){if(0===A.length)return[];for(var e=[n(A[0])],i=1;i<A.length;++i)e.push(t(e[i-1],A[i]));return e}function o(A,e){var t=$t(A);if(e<0||e>=t.length)throw new qt(e,t.length);try{return function A(e,t){var n,i,o;if(t<=0){var s=e[0][0];if(Array.isArray(s)){for(o=Tn(e),i=[],n=0;n<o.length;n++)i[n]=A(o[n],t-1);return i}return r(e)}for(i=[],n=0;n<e.length;n++)i[n]=A(e[n],t-1);return i}(A,e)}catch(A){throw vs(A,GE)}}})),HE=mA("mean",["typed","add","divide"],(function(A){var e=A.typed,t=A.add,n=A.divide;return e("mean",{"Array | Matrix":i,"Array | Matrix, number | BigNumber":function(A,e){try{var i=Sn(A,e,t),r=Array.isArray(A)?$t(A):A.size();return n(i,r[e])}catch(A){throw vs(A,"mean")}},"...":function(A){if(xn(A))throw new TypeError("Scalar values expected in function mean");return i(A)}});function i(A){var e,i=0;if(Rn(A,(function(A){try{e=void 0===e?A:t(e,A),i++}catch(e){throw vs(e,"mean",A)}})),0===i)throw new Error("Cannot calculate the mean of an empty array");return n(e,i)}})),bE=mA("median",["typed","add","divide","compare","partitionSelect"],(function(A){var e=A.typed,t=A.add,n=A.divide,i=A.compare,r=A.partitionSelect;function o(A){try{var e=(A=gn(A.valueOf())).length;if(0===e)throw new Error("Cannot calculate median of an empty array");if(e%2==0){for(var t=e/2-1,n=r(A,t+1),o=A[t],B=0;B<t;++B)i(A[B],o)>0&&(o=A[B]);return a(o,n)}var c=r(A,(e-1)/2);return s(c)}catch(A){throw vs(A,"median")}}var s=e({"number | BigNumber | Complex | Unit":function(A){return A}}),a=e({"number | BigNumber | Complex | Unit, number | BigNumber | Complex | Unit":function(A,e){return n(t(A,e),2)}});return e("median",{"Array | Matrix":o,"Array | Matrix, number | BigNumber":function(A,e){throw new Error("median(A, dim) is not yet supported")},"...":function(A){if(xn(A))throw new TypeError("Scalar values expected in function median");return o(A)}})})),vE=mA("mad",["typed","abs","map","median","subtract"],(function(A){var e=A.typed,t=A.abs,n=A.map,i=A.median,r=A.subtract;return e("mad",{"Array | Matrix":o,"...":function(A){return o(A)}});function o(A){if(0===(A=gn(A.valueOf())).length)throw new Error("Cannot calculate median absolute deviation (mad) of an empty array");try{var e=i(A);return i(n(A,(function(A){return t(r(A,e))})))}catch(A){throw A instanceof TypeError&&-1!==A.message.indexOf("median")?new TypeError(A.message.replace("median","mad")):vs(A,"mad")}}})),kE="unbiased",jE="variance",JE=mA(jE,["typed","add","subtract","multiply","divide","apply","isNaN"],(function(A){var e=A.typed,t=A.add,n=A.subtract,i=A.multiply,o=A.divide,s=A.apply,a=A.isNaN;return e(jE,{"Array | Matrix":function(A){return B(A,kE)},"Array | Matrix, string":B,"Array | Matrix, number | BigNumber":function(A,e){return c(A,e,kE)},"Array | Matrix, number | BigNumber, string":c,"...":function(A){return B(A,kE)}});function B(A,e){var s,B=0;if(0===A.length)throw new SyntaxError("Function variance requires one or more parameters (0 provided)");if(Rn(A,(function(A){try{s=void 0===s?A:t(s,A),B++}catch(e){throw vs(e,"variance",A)}})),0===B)throw new Error("Cannot calculate variance of an empty array");var c=o(s,B);if(s=void 0,Rn(A,(function(A){var e=n(A,c);s=void 0===s?i(e,e):t(s,i(e,e))})),a(s))return s;switch(e){case"uncorrected":return o(s,B);case"biased":return o(s,B+1);case"unbiased":var g=r(s)?s.mul(0):0;return 1===B?g:o(s,B-1);default:throw new Error('Unknown normalization "'+e+'". Choose "unbiased" (default), "uncorrected", or "biased".')}}function c(A,e,t){try{if(0===A.length)throw new SyntaxError("Function variance requires one or more parameters (0 provided)");return s(A,e,(function(A){return B(A,t)}))}catch(A){throw vs(A,"variance")}}})),zE="quantileSeq",LE=mA(zE,["typed","?bignumber","add","subtract","divide","multiply","partitionSelect","compare","isInteger","smaller","smallerEq","larger"],(function(A){var e=A.typed,n=A.bignumber,i=A.add,r=A.subtract,o=A.divide,s=A.multiply,a=A.partitionSelect,B=A.compare,c=A.isInteger,g=A.smaller,E=A.smallerEq,Q=A.larger,u=_i({typed:e,isInteger:c});return e(zE,{"Array | Matrix, number | BigNumber":function(A,e){return w(A,e,!1)},"Array | Matrix, number | BigNumber, number":function(A,e,t){return l(A,e,!1,t,w)},"Array | Matrix, number | BigNumber, boolean":w,"Array | Matrix, number | BigNumber, boolean, number":function(A,e,t,n){return l(A,e,t,n,w)},"Array | Matrix, Array | Matrix":function(A,e){return h(A,e,!1)},"Array | Matrix, Array | Matrix, number":function(A,e,t){return l(A,e,!1,t,h)},"Array | Matrix, Array | Matrix, boolean":h,"Array | Matrix, Array | Matrix, boolean, number":function(A,e,t,n){return l(A,e,t,n,h)}});function l(A,e,t,n,i){return u(A,n,(function(A){return i(A,e,t)}))}function w(A,e,r){var s,a=A.valueOf();if(g(e,0))throw new Error("N/prob must be non-negative");if(E(e,1))return t(e)?C(a,e,r):n(C(a,e,r));if(Q(e,1)){if(!c(e))throw new Error("N must be a positive integer");if(Q(e,4294967295))throw new Error("N must be less than or equal to 2^32-1, as that is the maximum length of an Array");var B=i(e,1);s=[];for(var u=0;g(u,e);u++){var l=o(u+1,B);s.push(C(a,l,r))}return t(e)?s:n(s)}}function h(A,e,t){for(var n=A.valueOf(),i=e.valueOf(),r=[],o=0;o<i.length;++o)r.push(C(n,i[o],t));return r}function C(A,e,n){var o=gn(A),g=o.length;if(0===g)throw new Error("Cannot calculate quantile of an empty sequence");var E,Q,u=t(e)?e*(g-1):e.times(g-1),l=t(e)?Math.floor(u):u.floor().toNumber(),w=t(e)?u%1:u.minus(l);if(c(u))return n?o[u]:a(o,t(e)?u:u.valueOf());if(n)E=o[l],Q=o[l+1];else{Q=a(o,l+1),E=o[l];for(var h=0;h<l;++h)B(o[h],E)>0&&(E=o[h])}return i(s(E,r(1,w)),s(Q,w))}})),PE=mA("std",["typed","map","sqrt","variance"],(function(A){var e=A.typed,t=A.map,n=A.sqrt,i=A.variance;return e("std",{"Array | Matrix":r,"Array | Matrix, string":r,"Array | Matrix, number | BigNumber":r,"Array | Matrix, number | BigNumber, string":r,"...":function(A){return r(A)}});function r(A,e){if(0===A.length)throw new SyntaxError("Function std requires one or more parameters (0 provided)");try{var r=i.apply(null,arguments);return E(r)?t(r,n):n(r)}catch(A){throw A instanceof TypeError&&-1!==A.message.indexOf(" variance")?new TypeError(A.message.replace(" variance"," std")):A}}})),OE=mA("corr",["typed","matrix","mean","sqrt","sum","add","subtract","multiply","pow","divide"],(function(A){var e=A.typed,t=A.matrix,n=A.sqrt,i=A.sum,r=A.add,o=A.subtract,s=A.multiply,a=A.pow,B=A.divide;return e("corr",{"Array, Array":function(A,e){return c(A,e)},"Matrix, Matrix":function(A,e){var n=c(A.toArray(),e.toArray());return Array.isArray(n)?t(n):n}});function c(A,e){var t=[];if(Array.isArray(A[0])&&Array.isArray(e[0])){if(A.length!==e.length)throw new SyntaxError("Dimension mismatch. Array A and B must have the same length.");for(var n=0;n<A.length;n++){if(A[n].length!==e[n].length)throw new SyntaxError("Dimension mismatch. Array A and B must have the same number of elements.");t.push(g(A[n],e[n]))}return t}if(A.length!==e.length)throw new SyntaxError("Dimension mismatch. Array A and B must have the same number of elements.");return g(A,e)}function g(A,e){var t=A.length,c=i(A),g=i(e),E=A.reduce((function(A,t,n){return r(A,s(t,e[n]))}),0),Q=i(A.map((function(A){return a(A,2)}))),u=i(e.map((function(A){return a(A,2)}))),l=o(s(t,E),s(c,g)),w=n(s(o(s(t,Q),a(c,2)),o(s(t,u),a(g,2))));return B(l,w)}}));function VE(A,e){if(e<A)return 1;if(e===A)return e;var t=e+A>>1;return VE(A,t)*VE(t+1,e)}function WE(A,e){if(!V(A)||A<0)throw new TypeError("Positive integer value expected in function combinations");if(!V(e)||e<0)throw new TypeError("Positive integer value expected in function combinations");if(e>A)throw new TypeError("k must be less than or equal to n");for(var t=A-e,n=1,i=2,r=e<t?e:t,o=e<t?t+1:e+1;o<=A;++o)for(n*=o;i<=r&&n%i==0;)n/=i,++i;return i<=r&&(n/=VE(i,r)),n}WE.signature="number, number";var KE="combinations",XE=mA(KE,["typed"],(function(A){return(0,A.typed)(KE,{"number, number":WE,"BigNumber, BigNumber":function(A,e){var t,n,i=A.constructor,r=A.minus(e),o=new i(1);if(!ZE(A)||!ZE(e))throw new TypeError("Positive integer value expected in function combinations");if(e.gt(A))throw new TypeError("k must be less than n in function combinations");if(t=o,e.lt(r))for(n=o;n.lte(r);n=n.plus(o))t=t.times(e.plus(n)).dividedBy(n);else for(n=o;n.lte(e);n=n.plus(o))t=t.times(r.plus(n)).dividedBy(n);return t}})}));function ZE(A){return A.isInteger()&&A.gte(0)}var _E="combinationsWithRep",qE=mA(_E,["typed"],(function(A){return(0,A.typed)(_E,{"number, number":function(A,e){if(!V(A)||A<0)throw new TypeError("Positive integer value expected in function combinationsWithRep");if(!V(e)||e<0)throw new TypeError("Positive integer value expected in function combinationsWithRep");if(A<1)throw new TypeError("k must be less than or equal to n + k - 1");return e<A-1?VE(A,A+e-1)/VE(1,e):VE(e+1,A+e-1)/VE(1,A-1)},"BigNumber, BigNumber":function(A,e){var t,n,i=new(0,A.constructor)(1),r=A.minus(i);if(!$E(A)||!$E(e))throw new TypeError("Positive integer value expected in function combinationsWithRep");if(A.lt(i))throw new TypeError("k must be less than or equal to n + k - 1 in function combinationsWithRep");if(t=i,e.lt(r))for(n=i;n.lte(r);n=n.plus(i))t=t.times(e.plus(n)).dividedBy(n);else for(n=i;n.lte(e);n=n.plus(i))t=t.times(r.plus(n)).dividedBy(n);return t}})}));function $E(A){return A.isInteger()&&A.gte(0)}function AQ(A){var e;if(V(A))return A<=0?isFinite(A)?1/0:NaN:A>171?1/0:VE(1,A-1);if(A<.5)return Math.PI/(Math.sin(Math.PI*A)*AQ(1-A));if(A>=171.35)return 1/0;if(A>85){var t=A*A,n=t*A,i=n*A,r=i*A;return Math.sqrt(2*Math.PI/A)*Math.pow(A/Math.E,A)*(1+1/(12*A)+1/(288*t)-139/(51840*n)-571/(2488320*i)+163879/(209018880*r)+5246819/(75246796800*r*A))}--A,e=tQ[0];for(var o=1;o<tQ.length;++o)e+=tQ[o]/(A+o);var s=A+eQ+.5;return Math.sqrt(2*Math.PI)*Math.pow(s,A+.5)*Math.exp(-s)*e}AQ.signature="number";var eQ=4.7421875,tQ=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22],nQ=.9189385332046728,iQ=[1.000000000190015,76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];function rQ(A){if(A<0)return NaN;if(0===A)return 1/0;if(!isFinite(A))return A;if(A<.5)return Math.log(Math.PI/Math.sin(Math.PI*A))-rQ(1-A);for(var e=5+(A-=1)+.5,t=iQ[0],n=6;n>=1;n--)t+=iQ[n]/(A+n);return nQ+(A+.5)*Math.log(e)-e+Math.log(t)}rQ.signature="number";var oQ=mA("gamma",["typed","config","multiplyScalar","pow","BigNumber","Complex"],(function(A){var e=A.typed,t=A.config,n=(A.multiplyScalar,A.pow,A.BigNumber),i=A.Complex;return e("gamma",{number:AQ,Complex:function A(e){if(0===e.im)return AQ(e.re);if(e.re<.5){var t=new i(1-e.re,-e.im),n=new i(Math.PI*e.re,Math.PI*e.im);return new i(Math.PI).div(n.sin()).div(A(t))}e=new i(e.re-1,e.im);for(var r=new i(tQ[0],0),o=1;o<tQ.length;++o){var s=new i(tQ[o],0);r=r.add(s.div(e.add(o)))}var a=new i(e.re+eQ+.5,e.im),B=Math.sqrt(2*Math.PI),c=a.pow(e.add(.5)),g=a.neg().exp();return r.mul(B).mul(c).mul(g)},BigNumber:function(A){if(A.isInteger())return A.isNegative()||A.isZero()?new n(1/0):function A(e){if(e<8)return new n([1,1,2,6,24,120,720,5040][e]);var i=t.precision+(0|Math.log(e.toNumber())),r=n.clone({precision:i});if(e%2==1)return e.times(A(new n(e-1)));for(var o=e,s=new r(e),a=e.toNumber();o>2;)a+=o-=2,s=s.times(a);return new n(s.toPrecision(n.precision))}(A.minus(1));if(!A.isFinite())return new n(A.isNegative()?NaN:1/0);throw new Error("Integer BigNumber expected")}})})),sQ=mA("lgamma",["Complex","typed"],(function(A){var e=A.Complex,t=A.typed,n=[-.029550653594771242,.00641025641025641,-.0019175269175269176,.0008417508417508417,-.0005952380952380953,.0007936507936507937,-.002777777777777778,.08333333333333333];return t("lgamma",{number:rQ,Complex:function A(t){if(t.isNaN())return new e(NaN,NaN);if(0===t.im)return new e(rQ(t.re),0);if(t.re>=7||Math.abs(t.im)>=7)return i(t);if(t.re<=.1){var n=(a=6.283185307179586,(!0^((B=t.im)>0||!(B<0)&&1/B==1/0)?-a:a)*Math.floor(.5*t.re+.25)),o=t.mul(Math.PI).sin().log(),s=A(new e(1-t.re,-t.im));return new e(1.1447298858494002,n).sub(o).sub(s)}return t.im>=0?r(t):r(t.conjugate()).conjugate();var a,B},BigNumber:function(){throw new Error("mathjs doesn't yet provide an implementation of the algorithm lgamma for BigNumber")}});function i(A){for(var t=A.sub(.5).mul(A.log()).sub(A).add(nQ),i=new e(1,0).div(A),r=i.div(A),o=n[0],s=n[1],a=2*r.re,B=r.re*r.re+r.im*r.im,c=2;c<8;c++){var g=s;s=-B*o+n[c],o=a*o+g}var E=i.mul(r.mul(o).add(s));return t.add(E)}function r(A){var t=0,n=0,r=A;for(A=A.add(1);A.re<=7;){var o=(r=r.mul(A)).im<0?1:0;0!==o&&0===n&&t++,n=o,A=A.add(1)}return i(A).sub(r.log()).sub(new e(0,2*t*Math.PI*1))}})),aQ="factorial",BQ=mA(aQ,["typed","gamma"],(function(A){var e=A.typed,t=A.gamma;return e(aQ,{number:function(A){if(A<0)throw new Error("Value must be non-negative");return t(A+1)},BigNumber:function(A){if(A.isNegative())throw new Error("Value must be non-negative");return t(A.plus(1))},"Array | Matrix":e.referToSelf((function(A){return function(e){return Gn(e,A)}}))})})),cQ="kldivergence",gQ=mA(cQ,["typed","matrix","divide","sum","multiply","map","dotDivide","log","isNumeric"],(function(A){var e=A.typed,t=A.matrix,n=A.divide,i=A.sum,r=A.multiply,o=A.map,s=A.dotDivide,a=A.log,B=A.isNumeric;return e(cQ,{"Array, Array":function(A,e){return c(t(A),t(e))},"Matrix, Array":function(A,e){return c(A,t(e))},"Array, Matrix":function(A,e){return c(t(A),e)},"Matrix, Matrix":function(A,e){return c(A,e)}});function c(A,e){var t=e.size().length,c=A.size().length;if(t>1)throw new Error("first object must be one dimensional");if(c>1)throw new Error("second object must be one dimensional");if(t!==c)throw new Error("Length of two vectors must be equal");if(0===i(A))throw new Error("Sum of elements in first object must be non zero");if(0===i(e))throw new Error("Sum of elements in second object must be non zero");var g=n(A,i(A)),E=n(e,i(e)),Q=i(r(g,o(s(g,E),(function(A){return a(A)}))));return B(Q)?Q:Number.NaN}})),EQ="multinomial",QQ=mA(EQ,["typed","add","divide","multiply","factorial","isInteger","isPositive"],(function(A){var e=A.typed,t=A.add,n=A.divide,i=A.multiply,r=A.factorial,o=A.isInteger,s=A.isPositive;return e(EQ,{"Array | Matrix":function(A){var e=0,a=1;return Rn(A,(function(A){if(!o(A)||!s(A))throw new TypeError("Positive integer value expected in function multinomial");e=t(e,A),a=i(a,r(A))})),n(r(e),a)}})})),uQ="permutations",lQ=mA(uQ,["typed","factorial"],(function(A){var e=A.typed,t=A.factorial;return e(uQ,{"number | BigNumber":t,"number, number":function(A,e){if(!V(A)||A<0)throw new TypeError("Positive integer value expected in function permutations");if(!V(e)||e<0)throw new TypeError("Positive integer value expected in function permutations");if(e>A)throw new TypeError("second argument k must be less than or equal to first argument n");return VE(A-e+1,A)},"BigNumber, BigNumber":function(A,e){var t,n;if(!wQ(A)||!wQ(e))throw new TypeError("Positive integer value expected in function permutations");if(e.gt(A))throw new TypeError("second argument k must be less than or equal to first argument n");for(t=A.mul(0).add(1),n=A.minus(e).plus(1);n.lte(A);n=n.plus(1))t=t.times(n);return t}})}));function wQ(A){return A.isInteger()&&A.gte(0)}n(2227);var hQ=n(6377),CQ=hQ(Date.now());function IQ(A){var e,t;return e=null===(t=A)?CQ:hQ(String(t)),function(){return e()}}var MQ="pickRandom",dQ=mA(MQ,["typed","config","?on"],(function(A){var e=A.typed,n=A.config,i=A.on,r=IQ(n.randomSeed);return i&&i("config",(function(A,e){A.randomSeed!==e.randomSeed&&(r=IQ(A.randomSeed))})),e(MQ,{"Array | Matrix":function(A){return o(A,{})},"Array | Matrix, Object":function(A,e){return o(A,e)},"Array | Matrix, number":function(A,e){return o(A,{number:e})},"Array | Matrix, Array | Matrix":function(A,e){return o(A,{weights:e})},"Array | Matrix, Array | Matrix, number":function(A,e,t){return o(A,{number:t,weights:e})},"Array | Matrix, number, Array | Matrix":function(A,e,t){return o(A,{number:e,weights:t})}});function o(A,e){var n=e.number,i=e.weights,o=e.elementWise,s=void 0===o||o,a=void 0===n;a&&(n=1);var B=g(A)?A.create:g(i)?i.create:null;A=A.valueOf(),i&&(i=i.valueOf()),!0===s&&(A=gn(A),i=gn(i));var c=0;if(void 0!==i){if(i.length!==A.length)throw new Error("Weights must have the same length as possibles");for(var E=0,Q=i.length;E<Q;E++){if(!t(i[E])||i[E]<0)throw new Error("Weights must be an array of positive numbers");c+=i[E]}}for(var u,l=A.length,w=[];w.length<n;){if(void 0===i)u=A[Math.floor(r()*l)];else for(var h=r()*c,C=0,I=A.length;C<I;C++)if((h-=i[C])<0){u=A[C];break}w.push(u)}return a?w[0]:B?B(w):w}}));function mQ(A,e){var t=[];if((A=A.slice(0)).length>1)for(var n=0,i=A.shift();n<i;n++)t.push(mQ(A,e));else for(var r=0,o=A.shift();r<o;r++)t.push(e());return t}var pQ=mA("random",["typed","config","?on"],(function(A){var e=A.typed,t=A.config,n=A.on,i=IQ(t.randomSeed);return n&&n("config",(function(A,e){A.randomSeed!==e.randomSeed&&(i=IQ(A.randomSeed))})),e("random",{"":function(){return o(0,1)},number:function(A){return o(0,A)},"number, number":function(A,e){return o(A,e)},"Array | Matrix":function(A){return r(A,0,1)},"Array | Matrix, number":function(A,e){return r(A,0,e)},"Array | Matrix, number, number":function(A,e,t){return r(A,e,t)}});function r(A,e,t){var n=mQ(A.valueOf(),(function(){return o(e,t)}));return g(A)?A.create(n):n}function o(A,e){return A+i()*(e-A)}})),FQ="randomInt",DQ=mA(FQ,["typed","config","?on"],(function(A){var e=A.typed,t=A.config,n=A.on,i=IQ(t.randomSeed);return n&&n("config",(function(A,e){A.randomSeed!==e.randomSeed&&(i=IQ(A.randomSeed))})),e(FQ,{"":function(){return o(0,1)},number:function(A){return o(0,A)},"number, number":function(A,e){return o(A,e)},"Array | Matrix":function(A){return r(A,0,1)},"Array | Matrix, number":function(A,e){return r(A,0,e)},"Array | Matrix, number, number":function(A,e,t){return r(A,e,t)}});function r(A,e,t){var n=mQ(A.valueOf(),(function(){return o(e,t)}));return g(A)?A.create(n):n}function o(A,e){return Math.floor(A+i()*(e-A))}})),YQ="stirlingS2",fQ=mA(YQ,["typed","addScalar","subtractScalar","multiplyScalar","divideScalar","pow","factorial","combinations","isNegative","isInteger","number","?bignumber","larger"],(function(A){var e=A.typed,n=A.addScalar,i=(A.subtractScalar,A.multiplyScalar),r=(A.divideScalar,A.pow,A.factorial,A.combinations,A.isNegative),o=A.isInteger,s=A.number,a=A.bignumber,B=A.larger,c=[],g=[];return e(YQ,{"number | BigNumber, number | BigNumber":function(A,e){if(!o(A)||r(A)||!o(e)||r(e))throw new TypeError("Non-negative integer value expected in function stirlingS2");if(B(e,A))throw new TypeError("k must be less than or equal to n in function stirlingS2");var E=!(t(A)&&t(e)),Q=E?g:c,u=E?a:s,l=s(A),w=s(e);if(Q[l]&&Q[l].length>w)return Q[l][w];for(var h=0;h<=l;++h)if(Q[h]||(Q[h]=[u(0===h?1:0)]),0!==h)for(var C=Q[h],I=Q[h-1],M=C.length;M<=h&&M<=w;++M)C[M]=M===h?1:n(i(u(M),I[M]),I[M-1]);return Q[l][w]}})})),NQ="bellNumbers",UQ=mA(NQ,["typed","addScalar","isNegative","isInteger","stirlingS2"],(function(A){var e=A.typed,t=A.addScalar,n=A.isNegative,i=A.isInteger,r=A.stirlingS2;return e(NQ,{"number | BigNumber":function(A){if(!i(A)||n(A))throw new TypeError("Non-negative integer value expected in function bellNumbers");for(var e=0,o=0;o<=A;o++)e=t(e,r(A,o));return e}})})),yQ="catalan",TQ=mA(yQ,["typed","addScalar","divideScalar","multiplyScalar","combinations","isNegative","isInteger"],(function(A){var e=A.typed,t=A.addScalar,n=A.divideScalar,i=A.multiplyScalar,r=A.combinations,o=A.isNegative,s=A.isInteger;return e(yQ,{"number | BigNumber":function(A){if(!s(A)||o(A))throw new TypeError("Non-negative integer value expected in function catalan");return n(r(i(A,2),A),t(A,1))}})})),xQ="composition",RQ=mA(xQ,["typed","addScalar","combinations","isNegative","isPositive","isInteger","larger"],(function(A){var e=A.typed,t=A.addScalar,n=A.combinations,i=A.isPositive,r=(A.isNegative,A.isInteger),o=A.larger;return e(xQ,{"number | BigNumber, number | BigNumber":function(A,e){if(!(r(A)&&i(A)&&r(e)&&i(e)))throw new TypeError("Positive integer value expected in function composition");if(o(e,A))throw new TypeError("k must be less than or equal to n in function composition");return n(t(A,-1),t(e,-1))}})})),GQ="leafCount",SQ=mA(GQ,["parse","typed"],(function(A){return A.parse,(0,A.typed)(GQ,{Node:function(A){return function A(e){var t=0;return e.forEach((function(e){t+=A(e)})),t||1}(A)}})}));function HQ(A){return T(A)||v(A)&&A.isUnary()&&T(A.args[0])}function bQ(A){return!!T(A)||!(!G(A)&&!v(A)||!A.args.every(bQ))||!(!k(A)||!bQ(A.content))}function vQ(A,e){var t=Object.keys(A);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(A);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(A,e).enumerable}))),t.push.apply(t,n)}return t}function kQ(A){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?vQ(Object(t),!0).forEach((function(e){Ir(A,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(t)):vQ(Object(t)).forEach((function(e){Object.defineProperty(A,e,Object.getOwnPropertyDescriptor(t,e))}))}return A}n(9588);var jQ=mA("simplifyUtil",["FunctionNode","OperatorNode","SymbolNode"],(function(A){var e=A.FunctionNode,t=A.OperatorNode,n=A.SymbolNode,i=!0,r=!1,o="defaultF",s={add:{trivial:i,total:i,commutative:i,associative:i},unaryPlus:{trivial:i,total:i,commutative:i,associative:i},subtract:{trivial:r,total:i,commutative:r,associative:r},multiply:{trivial:i,total:i,commutative:i,associative:i},divide:{trivial:r,total:i,commutative:r,associative:r},paren:{trivial:i,total:i,commutative:i,associative:r},defaultF:{trivial:r,total:i,commutative:r,associative:r}};function a(A,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s,n=o;if("string"==typeof A?n=A:v(A)?n=A.fn.toString():G(A)?n=A.name:k(A)&&(n="paren"),MA(t,n)){var i=t[n];if(MA(i,e))return i[e];if(MA(s,n))return s[n][e]}if(MA(t,o)){var r=t[o];return MA(r,e)?r[e]:s[o][e]}if(MA(s,n)){var a=s[n];if(MA(a,e))return a[e]}return s[o][e]}function B(A){return a(A,"associative",arguments.length>1&&void 0!==arguments[1]?arguments[1]:s)}function c(A,e){var t,n=[];return B(A,e)?(t=A.op,function A(e){for(var i=0;i<e.args.length;i++){var r=e.args[i];v(r)&&t===r.op?A(r):n.push(r)}}(A),n):A.args}function g(A){return v(A)?function(e){try{return new t(A.op,A.fn,e,A.implicit)}catch(A){return console.error(A),[]}}:function(t){return new e(new n(A.name),t)}}return{createMakeNodeFunction:g,hasProperty:a,isCommutative:function(A){return a(A,"commutative",arguments.length>1&&void 0!==arguments[1]?arguments[1]:s)},isAssociative:B,mergeContext:function(A,e){var t=kQ({},A);for(var n in e)MA(A,n)?t[n]=kQ(kQ({},e[n]),A[n]):t[n]=e[n];return t},flatten:function A(e,t){if(!e.args||0===e.args.length)return e;e.args=c(e,t);for(var n=0;n<e.args.length;n++)A(e.args[n],t)},allChildren:c,unflattenr:function A(e,t){if(e.args&&0!==e.args.length){for(var n=g(e),i=e.args.length,r=0;r<i;r++)A(e.args[r],t);if(i>2&&B(e,t)){for(var o=e.args.pop();e.args.length>0;)o=n([e.args.pop(),o]);e.args=o.args}}},unflattenl:function A(e,t){if(e.args&&0!==e.args.length){for(var n=g(e),i=e.args.length,r=0;r<i;r++)A(e.args[r],t);if(i>2&&B(e,t)){for(var o=e.args.shift();e.args.length>0;)o=n([o,e.args.shift()]);e.args=o.args}}},defaultContext:s,realContext:{divide:{total:r},log:{total:r}},positiveContext:{subtract:{total:r},abs:{trivial:i},log:{total:i}}}})),JQ=mA("simplify",["config","typed","parse","add","subtract","multiply","divide","pow","isZero","equal","resolve","simplifyConstant","simplifyCore","?fraction","?bignumber","mathWithTransform","matrix","AccessorNode","ArrayNode","ConstantNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","ParenthesisNode","SymbolNode"],(function(A){A.config;var t=A.typed,n=A.parse,i=(A.add,A.subtract,A.multiply,A.divide,A.pow,A.isZero,A.equal),r=A.resolve,o=A.simplifyConstant,s=A.simplifyCore,a=(A.fraction,A.bignumber,A.mathWithTransform,A.matrix,A.AccessorNode),B=A.ArrayNode,c=A.ConstantNode,g=A.FunctionNode,E=A.IndexNode,Q=A.ObjectNode,u=A.OperatorNode,l=A.ParenthesisNode,w=A.SymbolNode,h=jQ({FunctionNode:g,OperatorNode:u,SymbolNode:w}),C=h.hasProperty,I=h.isCommutative,M=h.isAssociative,d=h.mergeContext,m=h.flatten,p=h.unflattenr,F=h.unflattenl,D=h.createMakeNodeFunction,Y=h.defaultContext,f=h.realContext,N=h.positiveContext;t.addConversion({from:"Object",to:"Map",convert:jA});var U=t("simplify",{Node:H,"Node, Map":function(A,e){return H(A,!1,e)},"Node, Map, Object":function(A,e,t){return H(A,!1,e,t)},"Node, Array":H,"Node, Array, Map":H,"Node, Array, Map, Object":H});function y(A){return A.transform((function(A,e,t){return k(A)?y(A.content):A}))}t.removeConversion({from:"Object",to:"Map",convert:jA}),U.defaultContext=Y,U.realContext=f,U.positiveContext=N;var x={true:!0,false:!0,e:!0,i:!0,Infinity:!0,LN2:!0,LN10:!0,LOG2E:!0,LOG10E:!0,NaN:!0,phi:!0,pi:!0,SQRT1_2:!0,SQRT2:!0,tau:!0};function R(A,e){var t={};if(A.s){var i=A.s.split("->");if(2!==i.length)throw SyntaxError("Could not parse rule: "+A.s);t.l=i[0],t.r=i[1]}else t.l=A.l,t.r=A.r;t.l=y(n(t.l)),t.r=y(n(t.r));for(var r=0,o=["imposeContext","repeat","assuming"];r<o.length;r++){var s=o[r];s in A&&(t[s]=A[s])}if(A.evaluate&&(t.evaluate=n(A.evaluate)),M(t.l,e)){var a,B=!I(t.l,e);B&&(a=S());var c=D(t.l),g=S();t.expanded={},t.expanded.l=c([t.l,g]),m(t.expanded.l,e),p(t.expanded.l,e),t.expanded.r=c([t.r,g]),B&&(t.expandedNC1={},t.expandedNC1.l=c([a,t.l]),t.expandedNC1.r=c([a,t.r]),t.expandedNC2={},t.expandedNC2.l=c([a,t.expanded.l]),t.expandedNC2.r=c([a,t.expanded.r]))}return t}U.rules=[s,{l:"log(e)",r:"1"},{s:"n-n1 -> n+-n1",assuming:{subtract:{total:!0}}},{s:"n-n -> 0",assuming:{subtract:{total:!1}}},{s:"-(cl*v) -> v * (-cl)",assuming:{multiply:{commutative:!0},subtract:{total:!0}}},{s:"-(cl*v) -> (-cl) * v",assuming:{multiply:{commutative:!1},subtract:{total:!0}}},{s:"-(v*cl) -> v * (-cl)",assuming:{multiply:{commutative:!1},subtract:{total:!0}}},{l:"-(n1/n2)",r:"-n1/n2"},{l:"-v",r:"v * (-1)"},{l:"(n1 + n2)*(-1)",r:"n1*(-1) + n2*(-1)",repeat:!0},{l:"n/n1^n2",r:"n*n1^-n2"},{l:"n/n1",r:"n*n1^-1"},{s:"(n1*n2)^n3 -> n1^n3 * n2^n3",assuming:{multiply:{commutative:!0}}},{s:"(n1*n2)^(-1) -> n2^(-1) * n1^(-1)",assuming:{multiply:{commutative:!1}}},{s:"(n ^ n1) ^ n2 -> n ^ (n1 * n2)",assuming:{divide:{total:!0}}},{l:" vd   * ( vd   * n1 + n2)",r:"vd^2       * n1 +  vd   * n2"},{s:" vd   * (vd^n4 * n1 + n2)   ->  vd^(1+n4)  * n1 +  vd   * n2",assuming:{divide:{total:!0}}},{s:"vd^n3 * ( vd   * n1 + n2)   ->  vd^(n3+1)  * n1 + vd^n3 * n2",assuming:{divide:{total:!0}}},{s:"vd^n3 * (vd^n4 * n1 + n2)   ->  vd^(n3+n4) * n1 + vd^n3 * n2",assuming:{divide:{total:!0}}},{l:"n*n",r:"n^2"},{s:"n * n^n1 -> n^(n1+1)",assuming:{divide:{total:!0}}},{s:"n^n1 * n^n2 -> n^(n1+n2)",assuming:{divide:{total:!0}}},o,{s:"n+n -> 2*n",assuming:{add:{total:!0}}},{l:"n+-n",r:"0"},{l:"vd*n + vd",r:"vd*(n+1)"},{l:"n3*n1 + n3*n2",r:"n3*(n1+n2)"},{l:"n3^(-n4)*n1 +   n3  * n2",r:"n3^(-n4)*(n1 + n3^(n4+1) *n2)"},{l:"n3^(-n4)*n1 + n3^n5 * n2",r:"n3^(-n4)*(n1 + n3^(n4+n5)*n2)"},{s:"n*vd + vd -> (n+1)*vd",assuming:{multiply:{commutative:!1}}},{s:"vd + n*vd -> (1+n)*vd",assuming:{multiply:{commutative:!1}}},{s:"n1*n3 + n2*n3 -> (n1+n2)*n3",assuming:{multiply:{commutative:!1}}},{s:"n^n1 * n -> n^(n1+1)",assuming:{divide:{total:!0},multiply:{commutative:!1}}},{s:"n1*n3^(-n4) + n2 * n3    -> (n1 + n2*n3^(n4 +  1))*n3^(-n4)",assuming:{multiply:{commutative:!1}}},{s:"n1*n3^(-n4) + n2 * n3^n5 -> (n1 + n2*n3^(n4 + n5))*n3^(-n4)",assuming:{multiply:{commutative:!1}}},{l:"n*cd + cd",r:"(n+1)*cd"},{s:"cd*n + cd -> cd*(n+1)",assuming:{multiply:{commutative:!1}}},{s:"cd + cd*n -> cd*(1+n)",assuming:{multiply:{commutative:!1}}},o,{s:"(-n)*n1 -> -(n*n1)",assuming:{subtract:{total:!0}}},{s:"n1*(-n) -> -(n1*n)",assuming:{subtract:{total:!0},multiply:{commutative:!1}}},{s:"ce+ve -> ve+ce",assuming:{add:{commutative:!0}},imposeContext:{add:{commutative:!1}}},{s:"vd*cd -> cd*vd",assuming:{multiply:{commutative:!0}},imposeContext:{multiply:{commutative:!1}}},{l:"n+-n1",r:"n-n1"},{l:"n+-(n1)",r:"n-(n1)"},{s:"n*(n1^-1) -> n/n1",assuming:{multiply:{commutative:!0}}},{s:"n*n1^-n2 -> n/n1^n2",assuming:{multiply:{commutative:!0}}},{s:"n^-1 -> 1/n",assuming:{multiply:{commutative:!0}}},{l:"n^1",r:"n"},{s:"n*(n1/n2) -> (n*n1)/n2",assuming:{multiply:{associative:!0}}},{s:"n-(n1+n2) -> n-n1-n2",assuming:{addition:{associative:!0,commutative:!0}}},{l:"1*n",r:"n",imposeContext:{multiply:{commutative:!0}}},{s:"n1/(n2/n3) -> (n1*n3)/n2",assuming:{multiply:{associative:!0}}},{l:"n1/(-n2)",r:"-n1/n2"}];var G=0;function S(){return new w("_p"+G++)}function H(A,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:kA(),i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=i.consoleDebug;t=function(A,t){for(var n=[],i=0;i<A.length;i++){var r=A[i],o=void 0,s=e(r);switch(s){case"string":r={s:r};case"object":o=R(r,t);break;case"function":o=r;break;default:throw TypeError("Unsupported type of rule: "+s)}n.push(o)}return n}(t||U.rules,i.context);for(var s=r(A,n),a={},B=(s=y(s)).toString({parenthesis:"all"});!a[B];){a[B]=!0,G=0;var c=B;o&&console.log("Working on: ",B);for(var g=0;g<t.length;g++){var E="";if("function"==typeof t[g]?(s=t[g](s,i),o&&(E=t[g].name)):(m(s,i.context),s=v(s,t[g],i.context),o&&(E="".concat(t[g].l.toString()," -> ").concat(t[g].r.toString()))),o){var Q=s.toString({parenthesis:"all"});Q!==c&&(console.log("Applying",E,"produced",Q),c=Q)}F(s,i.context)}B=s.toString({parenthesis:"all"})}return s}function b(A,e,t){var n=A;if(A)for(var i=0;i<A.length;++i){var r=v(A[i],e,t);r!==A[i]&&(n===A&&(n=A.slice()),n[i]=r)}return n}function v(A,e,t){if(e.assuming)for(var n in e.assuming)for(var i in e.assuming[n])if(C(n,i,t)!==e.assuming[n][i])return A;var r=d(e.imposeContext,t),o=A;if(o instanceof u||o instanceof g){var s=b(o.args,e,t);s!==o.args&&((o=o.clone()).args=s)}else if(o instanceof l){if(o.content){var c=v(o.content,e,t);c!==o.content&&(o=new l(c))}}else if(o instanceof B){var w=b(o.items,e,t);w!==o.items&&(o=new B(w))}else if(o instanceof a){var h=o.object;o.object&&(h=v(o.object,e,t));var I=o.index;o.index&&(I=v(o.index,e,t)),h===o.object&&I===o.index||(o=new a(h,I))}else if(o instanceof E){var M=b(o.dimensions,e,t);M!==o.dimensions&&(o=new E(M))}else if(o instanceof Q){var m=!1,p={};for(var F in o.properties)p[F]=v(o.properties[F],e,t),p[F]!==o.properties[F]&&(m=!0);m&&(o=new Q(p))}var D=e.r,Y=L(e.l,o,r)[0];if(!Y&&e.expanded&&(D=e.expanded.r,Y=L(e.expanded.l,o,r)[0]),!Y&&e.expandedNC1&&(D=e.expandedNC1.r,(Y=L(e.expandedNC1.l,o,r)[0])||(D=e.expandedNC2.r,Y=L(e.expandedNC2.l,o,r)[0])),Y){var f=o.implicit;o=D.clone(),f&&"implicit"in D&&(o.implicit=!0),o=o.transform((function(A){return A.isSymbolNode&&MA(Y.placeholders,A.name)?Y.placeholders[A.name].clone():A}))}return e.repeat&&o!==A&&(o=v(o,e,t)),o}function j(A,e){var t={placeholders:{}};if(!A.placeholders&&!e.placeholders)return t;if(!A.placeholders)return e;if(!e.placeholders)return A;for(var n in A.placeholders)if(MA(A.placeholders,n)&&(t.placeholders[n]=A.placeholders[n],MA(e.placeholders,n)&&!P(A.placeholders[n],e.placeholders[n])))return null;for(var i in e.placeholders)MA(e.placeholders,i)&&(t.placeholders[i]=e.placeholders[i]);return t}function J(A,e){var t,n=[];if(0===A.length||0===e.length)return n;for(var i=0;i<A.length;i++)for(var r=0;r<e.length;r++)(t=j(A[i],e[r]))&&n.push(t);return n}function L(A,e,t,n){var r=[{placeholders:{}}];if(A instanceof u&&e instanceof u||A instanceof g&&e instanceof g){if(A instanceof u){if(A.op!==e.op||A.fn!==e.fn)return[]}else if(A instanceof g&&A.name!==e.name)return[];if(!(1===e.args.length&&1===A.args.length||!M(e,t)&&e.args.length===A.args.length||n)){if(e.args.length>=2&&2===A.args.length){for(var o=function(A,e){var t,n,i=[],r=D(A);if(I(A,e))for(var o=0;o<A.args.length;o++)(n=A.args.slice(0)).splice(o,1),t=1===n.length?n[0]:r(n),i.push(r([A.args[o],t]));else for(var s=1;s<A.args.length;s++){var a=A.args[0];s>1&&(a=r(A.args.slice(0,s))),t=1===(n=A.args.slice(s)).length?n[0]:r(n),i.push(r([a,t]))}return i}(e,t),s=[],a=0;a<o.length;a++){var B=L(A,o[a],t,!0);s=s.concat(B)}return s}if(A.args.length>2)throw Error("Unexpected non-binary associative function: "+A.toString());return[]}for(var E=[],Q=0;Q<A.args.length;Q++){var l=L(A.args[Q],e.args[Q],t);if(0===l.length)break;E.push(l)}if(E.length!==A.args.length){if(!I(e,t)||1===A.args.length)return[];if(A.args.length>2)throw new Error("permuting >2 commutative non-associative rule arguments not yet implemented");var h=L(A.args[0],e.args[1],t);if(0===h.length)return[];var C=L(A.args[1],e.args[0],t);if(0===C.length)return[];E=[h,C]}r=function(A){if(0===A.length)return A;for(var e=A.reduce(J),t=[],n={},i=0;i<e.length;i++){var r=JSON.stringify(e[i]);n[r]||(n[r]=!0,t.push(e[i]))}return t}(E)}else if(A instanceof w){if(0===A.name.length)throw new Error("Symbol in rule has 0 length...!?");if(x[A.name]){if(A.name!==e.name)return[]}else switch(A.name[1]>="a"&&A.name[1]<="z"?A.name.substring(0,2):A.name[0]){case"n":case"_p":r[0].placeholders[A.name]=e;break;case"c":case"cl":if(!T(e))return[];r[0].placeholders[A.name]=e;break;case"v":if(T(e))return[];r[0].placeholders[A.name]=e;break;case"vl":if(!z(e))return[];r[0].placeholders[A.name]=e;break;case"cd":if(!HQ(e))return[];r[0].placeholders[A.name]=e;break;case"vd":if(HQ(e))return[];r[0].placeholders[A.name]=e;break;case"ce":if(!bQ(e))return[];r[0].placeholders[A.name]=e;break;case"ve":if(bQ(e))return[];r[0].placeholders[A.name]=e;break;default:throw new Error("Invalid symbol in rule: "+A.name)}}else{if(!(A instanceof c))return[];if(!i(A.value,e.value))return[]}return r}function P(A,e){if(A instanceof c&&e instanceof c){if(!i(A.value,e.value))return!1}else if(A instanceof w&&e instanceof w){if(A.name!==e.name)return!1}else{if(!(A instanceof u&&e instanceof u||A instanceof g&&e instanceof g))return!1;if(A instanceof u){if(A.op!==e.op||A.fn!==e.fn)return!1}else if(A instanceof g&&A.name!==e.name)return!1;if(A.args.length!==e.args.length)return!1;for(var t=0;t<A.args.length;t++)if(!P(A.args[t],e.args[t]))return!1}return!0}return U}));function zQ(A,e){var t="undefined"!=typeof Symbol&&A[Symbol.iterator]||A["@@iterator"];if(!t){if(Array.isArray(A)||(t=function(A,e){if(A){if("string"==typeof A)return LQ(A,e);var t=Object.prototype.toString.call(A).slice(8,-1);return"Object"===t&&A.constructor&&(t=A.constructor.name),"Map"===t||"Set"===t?Array.from(A):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?LQ(A,e):void 0}}(A))||e&&A&&"number"==typeof A.length){t&&(A=t);var n=0,i=function(){};return{s:i,n:function(){return n>=A.length?{done:!0}:{done:!1,value:A[n++]}},e:function(A){throw A},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){t=t.call(A)},n:function(){var A=t.next();return o=A.done,A},e:function(A){s=!0,r=A},f:function(){try{o||null==t.return||t.return()}finally{if(s)throw r}}}}function LQ(A,e){(null==e||e>A.length)&&(e=A.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=A[t];return n}var PQ=mA("simplifyConstant",["typed","config","mathWithTransform","matrix","?fraction","?bignumber","AccessorNode","ArrayNode","ConstantNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","SymbolNode"],(function(A){var t=A.typed,n=A.config,i=A.mathWithTransform,r=A.matrix,o=A.fraction,a=A.bignumber,B=A.AccessorNode,c=A.ArrayNode,E=A.ConstantNode,Q=A.FunctionNode,u=A.IndexNode,l=A.ObjectNode,w=A.OperatorNode,h=A.SymbolNode,C=jQ({FunctionNode:Q,OperatorNode:w,SymbolNode:h}),I=C.isCommutative,M=C.isAssociative,d=C.allChildren,m=C.createMakeNodeFunction,p=t("simplifyConstant",{Node:function(A){return N(G(A,{}))},"Node, Object":function(A,e){return N(G(A,e))}});function F(A){return s(A)?A.valueOf():A instanceof Array?A.map(F):g(A)?r(F(A.valueOf())):A}function D(A,e,t){try{return i[A].apply(null,e)}catch(n){return e=e.map(F),y(i[A].apply(null,e),t)}}var Y=t({Fraction:function(A){var e,t=A.s*A.n;return e=t<0?new w("-","unaryMinus",[new E(-t)]):new E(t),1===A.d?e:new w("/","divide",[e,new E(A.d)])},number:function(A){return A<0?x(new E(-A)):new E(A)},BigNumber:function(A){return A<0?x(new E(-A)):new E(A)},Complex:function(A){throw new Error("Cannot convert Complex number to Node")},string:function(A){return new E(A)},Matrix:function(A){return new c(A.valueOf().map((function(A){return Y(A)})))}});function N(A){return H(A)?A:Y(A)}function U(A,e){if(e&&!1!==e.exactFractions&&isFinite(A)&&o){var t=o(A),n=e&&"number"==typeof e.fractionsLimit?e.fractionsLimit:1/0;if(t.valueOf()===A&&t.n<n&&t.d<n)return t}return A}var y=t({"string, Object":function(A,e){return"BigNumber"===n.number?(void 0===a&&ts(),a(A)):"Fraction"===n.number?(void 0===o&&ns(),o(A)):U(parseFloat(A),e)},"Fraction, Object":function(A,e){return A},"BigNumber, Object":function(A,e){return A},"number, Object":function(A,e){return U(A,e)},"Complex, Object":function(A,e){return 0!==A.im?A:U(A.re,e)},"Matrix, Object":function(A,e){return r(U(A.valueOf()))},"Array, Object":function(A,e){return A.map(U)}});function x(A){return new w("-","unaryMinus",[A])}function R(A,e,t,n){var i=e.shift(),r=e.reduce((function(e,i){if(!H(i)){var r=e.pop();if(H(r))return[r,i];try{return e.push(D(A,[r,i],n)),e}catch(A){e.push(r)}}e.push(N(e.pop()));var o=1===e.length?e[0]:t(e);return[t([o,N(i)])]}),[i]);return 1===r.length?r[0]:t([r[0],Y(r[1])])}function G(A,t){switch(A.type){case"SymbolNode":return A;case"ConstantNode":switch(e(A.value)){case"number":return y(A.value,t);case"string":return A.value;default:if(!isNaN(A.value))return y(A.value,t)}return A;case"FunctionNode":if(i[A.name]&&i[A.name].rawArgs)return A;if(-1===["add","multiply"].indexOf(A.name)){var n=A.args.map((function(A){return G(A,t)}));if(!n.some(H))try{return D(A.name,n,t)}catch(A){}if("size"===A.name&&1===n.length&&f(n[0])){for(var o=[],s=n[0];f(s);)o.push(s.items.length),s=s.items[0];return r(o)}return new Q(A.name,n.map(N))}case"OperatorNode":var a,w,h=A.fn.toString(),C=m(A);if(v(A)&&A.isUnary())w=H((a=[G(A.args[0],t)])[0])?C(a):D(h,a,t);else if(M(A,t.context))if(a=(a=d(A,t.context)).map((function(A){return G(A,t)})),I(h,t.context)){for(var F=[],Y=[],U=0;U<a.length;U++)H(a[U])?Y.push(a[U]):F.push(a[U]);F.length>1?(w=R(h,F,C,t),Y.unshift(w),w=R(h,Y,C,t)):w=R(h,a,C,t)}else w=R(h,a,C,t);else w=R(h,a=A.args.map((function(A){return G(A,t)})),C,t);return w;case"ParenthesisNode":return G(A.content,t);case"AccessorNode":return function(A,e,t){if(!S(e))return new B(N(A),N(e));if(f(A)||g(A)){for(var n=Array.from(e.dimensions);n.length>0;)if(T(n[0])&&"string"!=typeof n[0].value){var i=y(n.shift().value,t);f(A)?A=A.items[i-1]:(A=A.valueOf()[i-1])instanceof Array&&(A=r(A))}else{if(!(n.length>1&&T(n[1])&&"string"!=typeof n[1].value))break;var o,s=y(n[1].value,t),a=[],Q=f(A)?A.items:A.valueOf(),l=zQ(Q);try{for(l.s();!(o=l.n()).done;){var w=o.value;if(f(w))a.push(w.items[s-1]);else{if(!g(A))break;a.push(w[s-1])}}}catch(A){l.e(A)}finally{l.f()}if(a.length!==Q.length)break;A=f(A)?new c(a):r(a),n.splice(1,1)}return n.length===e.dimensions.length?new B(N(A),e):n.length>0?(e=new u(n),new B(N(A),e)):A}if(b(A)&&1===e.dimensions.length&&T(e.dimensions[0])){var h=e.dimensions[0].value;return h in A.properties?A.properties[h]:new E}return new B(N(A),e)}(G(A.object,t),G(A.index,t),t);case"ArrayNode":var x=A.items.map((function(A){return G(A,t)}));return x.some(H)?new c(x.map(N)):r(x);case"IndexNode":return new u(A.dimensions.map((function(A){return p(A,t)})));case"ObjectNode":var k={};for(var j in A.properties)k[j]=p(A.properties[j],t);return new l(k);default:throw new Error("Unimplemented node type in simplifyConstant: ".concat(A.type))}}return p})),OQ="simplifyCore",VQ=mA(OQ,["typed","parse","equal","isZero","add","subtract","multiply","divide","pow","AccessorNode","ArrayNode","ConstantNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","ParenthesisNode","SymbolNode"],(function(A){var e=A.typed,t=(A.parse,A.equal),n=A.isZero,i=(A.add,A.subtract,A.multiply,A.divide,A.pow,A.AccessorNode),r=A.ArrayNode,o=A.ConstantNode,s=A.FunctionNode,a=A.IndexNode,B=A.ObjectNode,c=A.OperatorNode,g=(A.ParenthesisNode,A.SymbolNode),E=new o(0),Q=new o(1),u=new o(!0),l=new o(!1);function w(A){return v(A)&&["and","not","or"].includes(A.op)}var h=jQ({FunctionNode:s,OperatorNode:c,SymbolNode:g}),C=h.hasProperty,I=h.isCommutative;function M(A){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=e?e.context:void 0;if(C(A,"trivial",o)){if(G(A)&&1===A.args.length)return M(A.args[0],e);var g=!1,h=0;if(A.forEach((function(A){1==++h&&(g=M(A,e))})),1===h)return g}var d=A;if(G(d)){var m=function(A){var e,t="OperatorNode:"+A,n=function(A,e){var t="undefined"!=typeof Symbol&&A[Symbol.iterator]||A["@@iterator"];if(!t){if(Array.isArray(A)||(t=function(A,e){if(A){if("string"==typeof A)return Zc(A,e);var t=Object.prototype.toString.call(A).slice(8,-1);return"Object"===t&&A.constructor&&(t=A.constructor.name),"Map"===t||"Set"===t?Array.from(A):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Zc(A,e):void 0}}(A))){t&&(A=t);var n=0,i=function(){};return{s:i,n:function(){return n>=A.length?{done:!0}:{done:!1,value:A[n++]}},e:function(A){throw A},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){t=t.call(A)},n:function(){var A=t.next();return o=A.done,A},e:function(A){s=!0,r=A},f:function(){try{o||null==t.return||t.return()}finally{if(s)throw r}}}}(_c);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(t in i)return i[t].op}}catch(A){n.e(A)}finally{n.f()}return null}(d.name);if(!m)return new s(M(d.fn),d.args.map((function(A){return M(A,e)})));if(d.args.length>2&&C(d,"associative",o))for(;d.args.length>2;){var p=d.args.pop(),F=d.args.pop();d.args.push(new c(m,d.name,[p,F]))}d=new c(m,d.name,d.args)}if(v(d)&&d.isUnary()){var D=M(d.args[0],e);if("~"===d.op&&v(D)&&D.isUnary()&&"~"===D.op)return D.args[0];if("not"===d.op&&v(D)&&D.isUnary()&&"not"===D.op&&w(D.args[0]))return D.args[0];var N=!0;if("-"===d.op&&v(D)&&(D.isBinary()&&"subtract"===D.fn&&(d=new c("-","subtract",[D.args[1],D.args[0]]),N=!1),D.isUnary()&&"-"===D.op))return D.args[0];if(N)return new c(d.op,d.fn,[D])}if(v(d)&&d.isBinary()){var U=M(d.args[0],e),y=M(d.args[1],e);if("+"===d.op){if(T(U)&&n(U.value))return y;if(T(y)&&n(y.value))return U;v(y)&&y.isUnary()&&"-"===y.op&&(y=y.args[0],d=new c("-","subtract",[U,y]))}if("-"===d.op)return v(y)&&y.isUnary()&&"-"===y.op?M(new c("+","add",[U,y.args[0]]),e):T(U)&&n(U.value)?M(new c("-","unaryMinus",[y])):T(y)&&n(y.value)?U:new c(d.op,d.fn,[U,y]);if("*"===d.op){if(T(U)){if(n(U.value))return E;if(t(U.value,1))return y}if(T(y)){if(n(y.value))return E;if(t(y.value,1))return U;if(I(d,o))return new c(d.op,d.fn,[y,U],d.implicit)}return new c(d.op,d.fn,[U,y],d.implicit)}if("/"===d.op)return T(U)&&n(U.value)?E:T(y)&&t(y.value,1)?U:new c(d.op,d.fn,[U,y]);if("^"===d.op&&T(y)){if(n(y.value))return Q;if(t(y.value,1))return U}if("and"===d.op){if(T(U)){if(!U.value)return l;if(w(y))return y}if(T(y)){if(!y.value)return l;if(w(U))return U}}if("or"===d.op){if(T(U)){if(U.value)return u;if(w(y))return y}if(T(y)){if(y.value)return u;if(w(U))return U}}return new c(d.op,d.fn,[U,y])}if(v(d))return new c(d.op,d.fn,d.args.map((function(A){return M(A,e)})));if(f(d))return new r(d.items.map((function(A){return M(A,e)})));if(Y(d))return new i(M(d.object,e),M(d.index,e));if(S(d))return new a(d.dimensions.map((function(A){return M(A,e)})));if(b(d)){var x={};for(var R in d.properties)x[R]=M(d.properties[R],e);return new B(x)}return d}return e(OQ,{Node:M,"Node,Object":M})})),WQ=mA("resolve",["typed","parse","ConstantNode","FunctionNode","OperatorNode","ParenthesisNode"],(function(A){var e=A.typed,t=A.parse,n=A.ConstantNode,i=A.FunctionNode,r=A.OperatorNode,o=A.ParenthesisNode;function s(A,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;if(!e)return A;if(z(A)){if(a.has(A.name)){var B=Array.from(a).join(", ");throw new ReferenceError("recursive loop of variable definitions among {".concat(B,"}"))}var c=e.get(A.name);if(H(c)){var g=new Set(a);return g.add(A.name),s(c,e,g)}return"number"==typeof c?t(String(c)):void 0!==c?new n(c):A}if(v(A)){var E=A.args.map((function(A){return s(A,e,a)}));return new r(A.op,A.fn,E,A.implicit)}if(k(A))return new o(s(A.content,e,a));if(G(A)){var Q=A.args.map((function(A){return s(A,e,a)}));return new i(A.name,Q)}return A.map((function(A){return s(A,e,a)}))}return e("resolve",{Node:s,"Node, Map | null | undefined":s,"Node, Object":function(A,e){return s(A,jA(e))},"Array | Matrix":e.referToSelf((function(A){return function(e){return e.map((function(e){return A(e)}))}})),"Array | Matrix, null | undefined":e.referToSelf((function(A){return function(e){return e.map((function(e){return A(e)}))}})),"Array, Object":e.referTo("Array,Map",(function(A){return function(e,t){return A(e,jA(t))}})),"Matrix, Object":e.referTo("Matrix,Map",(function(A){return function(e,t){return A(e,jA(t))}})),"Array | Matrix, Map":e.referToSelf((function(A){return function(e,t){return e.map((function(e){return A(e,t)}))}}))})})),KQ="symbolicEqual",XQ=mA(KQ,["parse","simplify","typed","OperatorNode"],(function(A){A.parse;var e=A.simplify,t=A.typed,n=A.OperatorNode;function i(A,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new n("-","subtract",[A,t]),o=e(r,{},i);return T(o)&&!o.value}return t(KQ,{"Node, Node":i,"Node, Node, Object":i})})),ZQ="derivative",_Q=mA(ZQ,["typed","config","parse","simplify","equal","isZero","numeric","ConstantNode","FunctionNode","OperatorNode","ParenthesisNode","SymbolNode"],(function(A){var e=A.typed,t=A.config,n=A.parse,i=A.simplify,r=A.equal,o=A.isZero,s=A.numeric,a=A.ConstantNode,B=A.FunctionNode,c=A.OperatorNode,g=A.ParenthesisNode,E=A.SymbolNode;function Q(A,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{simplify:!0},n={};w(n,A,e.name);var r=h(A,n);return t.simplify?i(r):r}e.addConversion({from:"identifier",to:"SymbolNode",convert:n});var u=e(ZQ,{"Node, SymbolNode":Q,"Node, SymbolNode, Object":Q});e.removeConversion({from:"identifier",to:"SymbolNode",convert:n}),u._simplify=!0,u.toTex=function(A){return l.apply(null,A.args)};var l=e("_derivTex",{"Node, SymbolNode":function(A,e){return T(A)&&"string"===P(A.value)?l(n(A.value).toString(),e.toString(),1):l(A.toTex(),e.toString(),1)},"Node, ConstantNode":function(A,e){if("string"===P(e.value))return l(A,n(e.value));throw new Error("The second parameter to 'derivative' is a non-string constant")},"Node, SymbolNode, ConstantNode":function(A,e,t){return l(A.toString(),e.name,t.value)},"string, string, number":function(A,e,t){return(1===t?"{d\\over d"+e+"}":"{d^{"+t+"}\\over d"+e+"^{"+t+"}}")+"\\left[".concat(A,"\\right]")}}),w=e("constTag",{"Object, ConstantNode, string":function(A,e){return A[e]=!0,!0},"Object, SymbolNode, string":function(A,e,t){return e.name!==t&&(A[e]=!0,!0)},"Object, ParenthesisNode, string":function(A,e,t){return w(A,e.content,t)},"Object, FunctionAssignmentNode, string":function(A,e,t){return-1===e.params.indexOf(t)?(A[e]=!0,!0):w(A,e.expr,t)},"Object, FunctionNode | OperatorNode, string":function(A,e,t){if(e.args.length>0){for(var n=w(A,e.args[0],t),i=1;i<e.args.length;++i)n=w(A,e.args[i],t)&&n;if(n)return A[e]=!0,!0}return!1}}),h=e("_derivative",{"ConstantNode, Object":function(A){return C(0)},"SymbolNode, Object":function(A,e){return void 0!==e[A]?C(0):C(1)},"ParenthesisNode, Object":function(A,e){return new g(h(A.content,e))},"FunctionAssignmentNode, Object":function(A,e){return void 0!==e[A]?C(0):h(A.expr,e)},"FunctionNode, Object":function(A,e){if(1!==A.args.length&&function(A){if("log"!==A.name&&"nthRoot"!==A.name&&"pow"!==A.name||2!==A.args.length){for(var e=0;e<A.args.length;++e)A.args[e]=C(0);throw A.compile().evaluate(),new Error('Function "'+A.name+'" is not supported by derivative, or a wrong number of arguments is passed')}}(A),void 0!==e[A])return C(0);var t,n,i,r,o=A.args[0],s=!1,a=!1;switch(A.name){case"cbrt":s=!0,n=new c("*","multiply",[C(3),new c("^","pow",[o,new c("/","divide",[C(2),C(3)])])]);break;case"sqrt":case"nthRoot":if(1===A.args.length)s=!0,n=new c("*","multiply",[C(2),new B("sqrt",[o])]);else if(2===A.args.length)return e[t=new c("/","divide",[C(1),A.args[1]])]=e[A.args[1]],h(new c("^","pow",[o,t]),e);break;case"log10":t=C(10);case"log":if(t||1!==A.args.length){if(1===A.args.length&&t||2===A.args.length&&void 0!==e[A.args[1]])n=new c("*","multiply",[o.clone(),new B("log",[t||A.args[1]])]),s=!0;else if(2===A.args.length)return h(new c("/","divide",[new B("log",[o]),new B("log",[A.args[1]])]),e)}else n=o.clone(),s=!0;break;case"pow":return e[t]=e[A.args[1]],h(new c("^","pow",[o,A.args[1]]),e);case"exp":n=new B("exp",[o.clone()]);break;case"sin":n=new B("cos",[o.clone()]);break;case"cos":n=new c("-","unaryMinus",[new B("sin",[o.clone()])]);break;case"tan":n=new c("^","pow",[new B("sec",[o.clone()]),C(2)]);break;case"sec":n=new c("*","multiply",[A,new B("tan",[o.clone()])]);break;case"csc":a=!0,n=new c("*","multiply",[A,new B("cot",[o.clone()])]);break;case"cot":a=!0,n=new c("^","pow",[new B("csc",[o.clone()]),C(2)]);break;case"asin":s=!0,n=new B("sqrt",[new c("-","subtract",[C(1),new c("^","pow",[o.clone(),C(2)])])]);break;case"acos":s=!0,a=!0,n=new B("sqrt",[new c("-","subtract",[C(1),new c("^","pow",[o.clone(),C(2)])])]);break;case"atan":s=!0,n=new c("+","add",[new c("^","pow",[o.clone(),C(2)]),C(1)]);break;case"asec":s=!0,n=new c("*","multiply",[new B("abs",[o.clone()]),new B("sqrt",[new c("-","subtract",[new c("^","pow",[o.clone(),C(2)]),C(1)])])]);break;case"acsc":s=!0,a=!0,n=new c("*","multiply",[new B("abs",[o.clone()]),new B("sqrt",[new c("-","subtract",[new c("^","pow",[o.clone(),C(2)]),C(1)])])]);break;case"acot":s=!0,a=!0,n=new c("+","add",[new c("^","pow",[o.clone(),C(2)]),C(1)]);break;case"sinh":n=new B("cosh",[o.clone()]);break;case"cosh":n=new B("sinh",[o.clone()]);break;case"tanh":n=new c("^","pow",[new B("sech",[o.clone()]),C(2)]);break;case"sech":a=!0,n=new c("*","multiply",[A,new B("tanh",[o.clone()])]);break;case"csch":a=!0,n=new c("*","multiply",[A,new B("coth",[o.clone()])]);break;case"coth":a=!0,n=new c("^","pow",[new B("csch",[o.clone()]),C(2)]);break;case"asinh":s=!0,n=new B("sqrt",[new c("+","add",[new c("^","pow",[o.clone(),C(2)]),C(1)])]);break;case"acosh":s=!0,n=new B("sqrt",[new c("-","subtract",[new c("^","pow",[o.clone(),C(2)]),C(1)])]);break;case"atanh":s=!0,n=new c("-","subtract",[C(1),new c("^","pow",[o.clone(),C(2)])]);break;case"asech":s=!0,a=!0,n=new c("*","multiply",[o.clone(),new B("sqrt",[new c("-","subtract",[C(1),new c("^","pow",[o.clone(),C(2)])])])]);break;case"acsch":s=!0,a=!0,n=new c("*","multiply",[new B("abs",[o.clone()]),new B("sqrt",[new c("+","add",[new c("^","pow",[o.clone(),C(2)]),C(1)])])]);break;case"acoth":s=!0,a=!0,n=new c("-","subtract",[C(1),new c("^","pow",[o.clone(),C(2)])]);break;case"abs":n=new c("/","divide",[new B(new E("abs"),[o.clone()]),o.clone()]);break;default:throw new Error('Function "'+A.name+'" is not supported by derivative, or a wrong number of arguments is passed')}s?(i="/",r="divide"):(i="*",r="multiply");var g=h(o,e);return a&&(g=new c("-","unaryMinus",[g])),new c(i,r,[g,n])},"OperatorNode, Object":function(A,e){if(void 0!==e[A])return C(0);if("+"===A.op)return new c(A.op,A.fn,A.args.map((function(A){return h(A,e)})));if("-"===A.op){if(A.isUnary())return new c(A.op,A.fn,[h(A.args[0],e)]);if(A.isBinary())return new c(A.op,A.fn,[h(A.args[0],e),h(A.args[1],e)])}if("*"===A.op){var t=A.args.filter((function(A){return void 0!==e[A]}));if(t.length>0){var n=A.args.filter((function(A){return void 0===e[A]})),i=1===n.length?n[0]:new c("*","multiply",n),s=t.concat(h(i,e));return new c("*","multiply",s)}return new c("+","add",A.args.map((function(t){return new c("*","multiply",A.args.map((function(A){return A===t?h(A,e):A.clone()})))})))}if("/"===A.op&&A.isBinary()){var a=A.args[0],g=A.args[1];return void 0!==e[g]?new c("/","divide",[h(a,e),g]):void 0!==e[a]?new c("*","multiply",[new c("-","unaryMinus",[a]),new c("/","divide",[h(g,e),new c("^","pow",[g.clone(),C(2)])])]):new c("/","divide",[new c("-","subtract",[new c("*","multiply",[h(a,e),g.clone()]),new c("*","multiply",[a.clone(),h(g,e)])]),new c("^","pow",[g.clone(),C(2)])])}if("^"===A.op&&A.isBinary()){var E=A.args[0],Q=A.args[1];if(void 0!==e[E])return T(E)&&(o(E.value)||r(E.value,1))?C(0):new c("*","multiply",[A,new c("*","multiply",[new B("log",[E.clone()]),h(Q.clone(),e)])]);if(void 0!==e[Q]){if(T(Q)){if(o(Q.value))return C(0);if(r(Q.value,1))return h(E,e)}var u=new c("^","pow",[E.clone(),new c("-","subtract",[Q,C(1)])]);return new c("*","multiply",[Q.clone(),new c("*","multiply",[h(E,e),u])])}return new c("*","multiply",[new c("^","pow",[E.clone(),Q.clone()]),new c("+","add",[new c("*","multiply",[h(E,e),new c("/","divide",[Q.clone(),E.clone()])]),new c("*","multiply",[h(Q,e),new B("log",[E.clone()])])])])}throw new Error('Operator "'+A.op+'" is not supported by derivative, or a wrong number of arguments is passed')}});function C(A,e){return new a(s(A,e||t.number))}return u})),qQ="rationalize",$Q=mA(qQ,["config","typed","equal","isZero","add","subtract","multiply","divide","pow","parse","simplifyConstant","simplifyCore","simplify","?bignumber","?fraction","mathWithTransform","matrix","AccessorNode","ArrayNode","ConstantNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","SymbolNode","ParenthesisNode"],(function(A){A.config;var e=A.typed,t=(A.equal,A.isZero,A.add,A.subtract,A.multiply,A.divide,A.pow,A.parse,A.simplifyConstant),n=A.simplifyCore,i=A.simplify,r=(A.fraction,A.bignumber,A.mathWithTransform,A.matrix,A.AccessorNode,A.ArrayNode,A.ConstantNode),o=(A.FunctionNode,A.IndexNode,A.ObjectNode,A.OperatorNode),s=A.SymbolNode;function a(A){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=function(){var A=[n,{l:"n+n",r:"2*n"},{l:"n+-n",r:"0"},t,{l:"n*(n1^-1)",r:"n/n1"},{l:"n*n1^-n2",r:"n/n1^n2"},{l:"n1^-1",r:"1/n1"},{l:"n*(n1/n2)",r:"(n*n1)/n2"},{l:"1*n",r:"n"}],e=[{l:"(-n1)/(-n2)",r:"n1/n2"},{l:"(-n1)*(-n2)",r:"n1*n2"},{l:"n1--n2",r:"n1+n2"},{l:"n1-n2",r:"n1+(-n2)"},{l:"(n1+n2)*n3",r:"(n1*n3 + n2*n3)"},{l:"n1*(n2+n3)",r:"(n1*n2+n1*n3)"},{l:"c1*n + c2*n",r:"(c1+c2)*n"},{l:"c1*n + n",r:"(c1+1)*n"},{l:"c1*n - c2*n",r:"(c1-c2)*n"},{l:"c1*n - n",r:"(c1-1)*n"},{l:"v/c",r:"(1/c)*v"},{l:"v/-c",r:"-(1/c)*v"},{l:"-v*-c",r:"c*v"},{l:"-v*c",r:"-c*v"},{l:"v*-c",r:"-c*v"},{l:"v*c",r:"c*v"},{l:"-(-n1*n2)",r:"(n1*n2)"},{l:"-(n1*n2)",r:"(-n1*n2)"},{l:"-(-n1+n2)",r:"(n1-n2)"},{l:"-(n1+n2)",r:"(-n1-n2)"},{l:"(n1^n2)^n3",r:"(n1^(n2*n3))"},{l:"-(-n1/n2)",r:"(n1/n2)"},{l:"-(n1/n2)",r:"(-n1/n2)"}],i=[{l:"(n1/(n2/n3))",r:"((n1*n3)/n2)"},{l:"(n1/n2/n3)",r:"(n1/(n2*n3))"}],r={};return r.firstRules=A.concat(e,i),r.distrDivRules=[{l:"(n1/n2 + n3/n4)",r:"((n1*n4 + n3*n2)/(n2*n4))"},{l:"(n1/n2 + n3)",r:"((n1 + n3*n2)/n2)"},{l:"(n1 + n2/n3)",r:"((n1*n3 + n2)/n3)"}],r.sucDivRules=i,r.firstRulesAgain=A.concat(e),r.finalRules=[n,{l:"n*-n",r:"-n^2"},{l:"n*n",r:"n^2"},t,{l:"n*-n^n1",r:"-n^(n1+1)"},{l:"n*n^n1",r:"n^(n1+1)"},{l:"n^n1*-n^n2",r:"-n^(n1+n2)"},{l:"n^n1*n^n2",r:"n^(n1+n2)"},{l:"n^n1*-n",r:"-n^(n1+1)"},{l:"n^n1*n",r:"n^(n1+1)"},{l:"n^n1/-n",r:"-n^(n1-1)"},{l:"n^n1/n",r:"n^(n1-1)"},{l:"n/-n^n1",r:"-n^(1-n1)"},{l:"n/n^n1",r:"n^(1-n1)"},{l:"n^n1/-n^n2",r:"n^(n1-n2)"},{l:"n^n1/n^n2",r:"n^(n1-n2)"},{l:"n1+(-n2*n3)",r:"n1-n2*n3"},{l:"v*(-c)",r:"-c*v"},{l:"n1+-n2",r:"n1-n2"},{l:"v*c",r:"c*v"},{l:"(n1^n2)^n3",r:"(n1^(n2*n3))"}],r}(),s=function(A,e,t,n){var r=[],o=i(A,n,e,{exactFractions:!1}),s="+-*"+((t=!!t)?"/":"");!function A(e){var t=e.type;if("FunctionNode"===t)throw new Error("There is an unsolved function call");if("OperatorNode"===t)if("^"===e.op){if("ConstantNode"!==e.args[1].type||!V(parseFloat(e.args[1].value)))throw new Error("There is a non-integer exponent");A(e.args[0])}else{if(-1===s.indexOf(e.op))throw new Error("Operator "+e.op+" invalid in polynomial expression");for(var n=0;n<e.args.length;n++)A(e.args[n])}else if("SymbolNode"===t){var i=e.name;-1===r.indexOf(i)&&r.push(i)}else if("ParenthesisNode"===t)A(e.content);else if("ConstantNode"!==t)throw new Error("type "+t+" is not allowed in polynomial expression")}(o);var a={};return a.expression=o,a.variables=r,a}(A,e,!0,o.firstRules),a=s.variables.length,g={exactFractions:!1},E={exactFractions:!0};if(A=s.expression,a>=1){var Q,u;A=B(A);var l,w=!0,h=!1;for(A=i(A,o.firstRules,{},g);u=w?o.distrDivRules:o.sucDivRules,w=!w,(l=(A=i(A,u,{},E)).toString())!==Q;)h=!0,Q=l;h&&(A=i(A,o.firstRulesAgain,{},g)),A=i(A,o.finalRules,{},g)}var C=[],I={};return"OperatorNode"===A.type&&A.isBinary()&&"/"===A.op?(1===a&&(A.args[0]=c(A.args[0],C),A.args[1]=c(A.args[1])),r&&(I.numerator=A.args[0],I.denominator=A.args[1])):(1===a&&(A=c(A,C)),r&&(I.numerator=A,I.denominator=null)),r?(I.coefficients=C,I.variables=s.variables,I.expression=A,I):A}return A.ParenthesisNode,e(qQ,{Node:a,"Node, boolean":function(A,e){return a(A,{},e)},"Node, Object":a,"Node, Object, boolean":a});function B(A,e,t){var n=A.type,i=arguments.length>1;if("OperatorNode"===n&&A.isBinary()){var s,a=!1;if("^"===A.op&&("ParenthesisNode"!==A.args[0].type&&"OperatorNode"!==A.args[0].type||"ConstantNode"!==A.args[1].type||(a=(s=parseFloat(A.args[1].value))>=2&&V(s))),a){if(s>2){var c=A.args[0],g=new o("^","pow",[A.args[0].cloneDeep(),new r(s-1)]);A=new o("*","multiply",[c,g])}else A=new o("*","multiply",[A.args[0],A.args[0].cloneDeep()]);i&&("content"===t?e.content=A:e.args[t]=A)}}if("ParenthesisNode"===n)B(A.content,A,"content");else if("ConstantNode"!==n&&"SymbolNode"!==n)for(var E=0;E<A.args.length;E++)B(A.args[E],A,E);if(!i)return A}function c(A,e){void 0===e&&(e=[]),e[0]=0;var t=0,n="";!function A(i,r,o){var s=i.type;if("FunctionNode"===s)throw new Error("There is an unsolved function call");if("OperatorNode"===s){if(-1==="+-*^".indexOf(i.op))throw new Error("Operator "+i.op+" invalid");if(null!==r){if(("unaryMinus"===i.fn||"pow"===i.fn)&&"add"!==r.fn&&"subtract"!==r.fn&&"multiply"!==r.fn)throw new Error("Invalid "+i.op+" placing");if(("subtract"===i.fn||"add"===i.fn||"multiply"===i.fn)&&"add"!==r.fn&&"subtract"!==r.fn)throw new Error("Invalid "+i.op+" placing");if(("subtract"===i.fn||"add"===i.fn||"unaryMinus"===i.fn)&&0!==o.noFil)throw new Error("Invalid "+i.op+" placing")}"^"!==i.op&&"*"!==i.op||(o.fire=i.op);for(var a=0;a<i.args.length;a++)"unaryMinus"===i.fn&&(o.oper="-"),"+"!==i.op&&"subtract"!==i.fn||(o.fire="",o.cte=1,o.oper=0===a?"+":i.op),o.noFil=a,A(i.args[a],i,o)}else if("SymbolNode"===s){if(i.name!==n&&""!==n)throw new Error("There is more than one variable");if(n=i.name,null===r)return void(e[1]=1);if("^"===r.op&&0!==o.noFil)throw new Error("In power the variable should be the first parameter");if("*"===r.op&&1!==o.noFil)throw new Error("In multiply the variable should be the second parameter");""!==o.fire&&"*"!==o.fire||(t<1&&(e[1]=0),e[1]+=o.cte*("+"===o.oper?1:-1),t=Math.max(1,t))}else{if("ConstantNode"!==s)throw new Error("Type "+s+" is not allowed");var B=parseFloat(i.value);if(null===r)return void(e[0]=B);if("^"===r.op){if(1!==o.noFil)throw new Error("Constant cannot be powered");if(!V(B)||B<=0)throw new Error("Non-integer exponent is not allowed");for(var c=t+1;c<B;c++)e[c]=0;return B>t&&(e[B]=0),e[B]+=o.cte*("+"===o.oper?1:-1),void(t=Math.max(B,t))}o.cte=B,""===o.fire&&(e[0]+=o.cte*("+"===o.oper?1:-1))}}(A,null,{cte:1,oper:"+",fire:""});for(var i,a=!0,B=t=e.length-1;B>=0;B--)if(0!==e[B]){var c=new r(a?e[B]:Math.abs(e[B])),g=e[B]<0?"-":"+";if(B>0){var E=new s(n);if(B>1){var Q=new r(B);E=new o("^","pow",[E,Q])}c=-1===e[B]&&a?new o("-","unaryMinus",[E]):1===Math.abs(e[B])?E:new o("*","multiply",[c,E])}i=a?c:"+"===g?new o("+","add",[i,c]):new o("-","subtract",[i,c]),a=!1}return a?new r(0):i}})),Au=mA("zpk2tf",["typed","add","multiply","Complex","number"],(function(A){var e=A.typed,t=A.add,n=A.multiply,i=A.Complex,r=A.number;return e("zpk2tf",{"Array,Array,number":function(A,e,t){return o(A,e,t)},"Array,Array":function(A,e){return o(A,e,1)},"Matrix,Matrix,number":function(A,e,t){return o(A.valueOf(),e.valueOf(),t)},"Matrix,Matrix":function(A,e){return o(A.valueOf(),e.valueOf(),1)}});function o(A,e,t){A.some((function(A){return"BigNumber"===A.type}))&&(A=A.map((function(A){return r(A)}))),e.some((function(A){return"BigNumber"===A.type}))&&(e=e.map((function(A){return r(A)})));for(var o=[i(1,0)],a=[i(1,0)],B=0;B<A.length;B++){var c=A[B];"number"==typeof c&&(c=i(c,0)),o=s(o,[i(1,0),i(-c.re,-c.im)])}for(var g=0;g<e.length;g++){var E=e[g];"number"==typeof E&&(E=i(E,0)),a=s(a,[i(1,0),i(-E.re,-E.im)])}for(var Q=0;Q<o.length;Q++)o[Q]=n(o[Q],t);return[o,a]}function s(A,e){for(var r=[],o=0;o<A.length+e.length-1;o++){r[o]=i(0,0);for(var s=0;s<A.length;s++)o-s>=0&&o-s<e.length&&(r[o]=t(r[o],n(A[s],e[o-s])))}return r}})),eu=mA("freqz",["typed","add","multiply","Complex","divide","matrix"],(function(A){var e=A.typed,t=A.add,n=A.multiply,i=A.Complex,r=A.divide,o=A.matrix;return e("freqz",{"Array, Array":function(A,e){return s(A,e,a(512))},"Array, Array, Array":function(A,e,t){return s(A,e,t)},"Array, Array, number":function(A,e,t){if(t<0)throw new Error("w must be a positive number");return s(A,e,a(t))},"Matrix, Matrix":function(A,e){var t=a(512),n=s(A.valueOf(),e.valueOf(),t),i=n.w,r=n.h;return{w:o(i),h:o(r)}},"Matrix, Matrix, Matrix":function(A,e,t){var n=s(A.valueOf(),e.valueOf(),t.valueOf()).h;return{h:o(n),w:o(t)}},"Matrix, Matrix, number":function(A,e,t){if(t<0)throw new Error("w must be a positive number");var n=a(t),i=s(A.valueOf(),e.valueOf(),n).h;return{h:o(i),w:o(n)}}});function s(A,e,o){for(var s=[],a=[],B=0;B<o.length;B++){for(var c=i(0,0),g=i(0,0),E=0;E<A.length;E++)c=t(c,n(A[E],i(Math.cos(-E*o[B]),Math.sin(-E*o[B]))));for(var Q=0;Q<e.length;Q++)g=t(g,n(e[Q],i(Math.cos(-Q*o[B]),Math.sin(-Q*o[B]))));s.push(c),a.push(g)}for(var u=[],l=0;l<s.length;l++)u.push(r(s[l],a[l]));return{h:u,w:o}}function a(A){for(var e=[],t=0;t<A;t++)e.push(t/A*Math.PI);return e}})),tu=mA("reviver",["classes"],(function(A){var e=A.classes;return function(A,t){var n=e[t&&t.mathjs];return n&&"function"==typeof n.fromJSON?n.fromJSON(t):t}})),nu=mA("replacer",[],(function(){return function(A,e){return"number"!=typeof e||isFinite(e)&&!isNaN(e)?e:{mathjs:"number",value:String(e)}}})),iu=Math.PI,ru=2*Math.PI,ou=Math.E,su=mA("true",[],(function(){return!0})),au=mA("false",[],(function(){return!1})),Bu=mA("null",[],(function(){return null})),cu=Yu("Infinity",["config","?BigNumber"],(function(A){var e=A.config,t=A.BigNumber;return"BigNumber"===e.number?new t(1/0):1/0})),gu=Yu("NaN",["config","?BigNumber"],(function(A){var e=A.config,t=A.BigNumber;return"BigNumber"===e.number?new t(NaN):NaN})),Eu=Yu("pi",["config","?BigNumber"],(function(A){var e=A.config,t=A.BigNumber;return"BigNumber"===e.number?QB(t):iu})),Qu=Yu("tau",["config","?BigNumber"],(function(A){var e=A.config,t=A.BigNumber;return"BigNumber"===e.number?uB(t):ru})),uu=Yu("e",["config","?BigNumber"],(function(A){var e=A.config,t=A.BigNumber;return"BigNumber"===e.number?gB(t):ou})),lu=Yu("phi",["config","?BigNumber"],(function(A){var e=A.config,t=A.BigNumber;return"BigNumber"===e.number?EB(t):1.618033988749895})),wu=Yu("LN2",["config","?BigNumber"],(function(A){var e=A.config,t=A.BigNumber;return"BigNumber"===e.number?new t(2).ln():Math.LN2})),hu=Yu("LN10",["config","?BigNumber"],(function(A){var e=A.config,t=A.BigNumber;return"BigNumber"===e.number?new t(10).ln():Math.LN10})),Cu=Yu("LOG2E",["config","?BigNumber"],(function(A){var e=A.config,t=A.BigNumber;return"BigNumber"===e.number?new t(1).div(new t(2).ln()):Math.LOG2E})),Iu=Yu("LOG10E",["config","?BigNumber"],(function(A){var e=A.config,t=A.BigNumber;return"BigNumber"===e.number?new t(1).div(new t(10).ln()):Math.LOG10E})),Mu=Yu("SQRT1_2",["config","?BigNumber"],(function(A){var e=A.config,t=A.BigNumber;return"BigNumber"===e.number?new t("0.5").sqrt():Math.SQRT1_2})),du=Yu("SQRT2",["config","?BigNumber"],(function(A){var e=A.config,t=A.BigNumber;return"BigNumber"===e.number?new t(2).sqrt():Math.SQRT2})),mu=Yu("i",["Complex"],(function(A){return A.Complex.I})),pu=mA("PI",["pi"],(function(A){return A.pi})),Fu=mA("E",["e"],(function(A){return A.e})),Du=mA("version",[],(function(){return"11.12.0"}));function Yu(A,e,t){return mA(A,e,t,{recreateOnConfigChange:!0})}var fu=pl("speedOfLight","299792458","m s^-1"),Nu=pl("gravitationConstant","6.67430e-11","m^3 kg^-1 s^-2"),Uu=pl("planckConstant","6.62607015e-34","J s"),yu=pl("reducedPlanckConstant","1.0545718176461565e-34","J s"),Tu=pl("magneticConstant","1.25663706212e-6","N A^-2"),xu=pl("electricConstant","8.8541878128e-12","F m^-1"),Ru=pl("vacuumImpedance","376.730313667","ohm"),Gu=pl("coulomb","8.987551792261171e9","N m^2 C^-2"),Su=pl("elementaryCharge","1.602176634e-19","C"),Hu=pl("bohrMagneton","9.2740100783e-24","J T^-1"),bu=pl("conductanceQuantum","7.748091729863649e-5","S"),vu=pl("inverseConductanceQuantum","12906.403729652257","ohm"),ku=pl("magneticFluxQuantum","2.0678338484619295e-15","Wb"),ju=pl("nuclearMagneton","5.0507837461e-27","J T^-1"),Ju=pl("klitzing","25812.807459304513","ohm"),zu=pl("bohrRadius","5.29177210903e-11","m"),Lu=pl("classicalElectronRadius","2.8179403262e-15","m"),Pu=pl("electronMass","9.1093837015e-31","kg"),Ou=pl("fermiCoupling","1.1663787e-5","GeV^-2"),Vu=Fl("fineStructure",.0072973525693),Wu=pl("hartreeEnergy","4.3597447222071e-18","J"),Ku=pl("protonMass","1.67262192369e-27","kg"),Xu=pl("deuteronMass","3.3435830926e-27","kg"),Zu=pl("neutronMass","1.6749271613e-27","kg"),_u=pl("quantumOfCirculation","3.6369475516e-4","m^2 s^-1"),qu=pl("rydberg","10973731.568160","m^-1"),$u=pl("thomsonCrossSection","6.6524587321e-29","m^2"),Al=Fl("weakMixingAngle",.2229),el=Fl("efimovFactor",22.7),tl=pl("atomicMass","1.66053906660e-27","kg"),nl=pl("avogadro","6.02214076e23","mol^-1"),il=pl("boltzmann","1.380649e-23","J K^-1"),rl=pl("faraday","96485.33212331001","C mol^-1"),ol=pl("firstRadiation","3.7417718521927573e-16","W m^2"),sl=pl("loschmidt","2.686780111798444e25","m^-3"),al=pl("gasConstant","8.31446261815324","J K^-1 mol^-1"),Bl=pl("molarPlanckConstant","3.990312712893431e-10","J s mol^-1"),cl=pl("molarVolume","0.022413969545014137","m^3 mol^-1"),gl=Fl("sackurTetrode",-1.16487052358),El=pl("secondRadiation","0.014387768775039337","m K"),Ql=pl("stefanBoltzmann","5.67037441918443e-8","W m^-2 K^-4"),ul=pl("wienDisplacement","2.897771955e-3","m K"),ll=pl("molarMass","0.99999999965e-3","kg mol^-1"),wl=pl("molarMassC12","11.9999999958e-3","kg mol^-1"),hl=pl("gravity","9.80665","m s^-2"),Cl=pl("planckLength","1.616255e-35","m"),Il=pl("planckMass","2.176435e-8","kg"),Ml=pl("planckTime","5.391245e-44","s"),dl=pl("planckCharge","1.87554603778e-18","C"),ml=pl("planckTemperature","1.416785e+32","K");function pl(A,e,t){return mA(A,["config","Unit","BigNumber"],(function(A){var n=A.config,i=A.Unit,r=A.BigNumber,o=new i("BigNumber"===n.number?new r(e):parseFloat(e),t);return o.fixPrefix=!0,o}))}function Fl(A,e){return mA(A,["config","BigNumber"],(function(A){var t=A.config,n=A.BigNumber;return"BigNumber"===t.number?new n(e):e}))}var Dl=mA("apply",["typed","isInteger"],(function(A){var e=A.typed,n=A.isInteger,i=_i({typed:e,isInteger:n});return e("apply",{"...any":function(A){var e=A[1];t(e)?A[1]=e-1:r(e)&&(A[1]=e.minus(1));try{return i.apply(null,A)}catch(A){throw Pc(A)}}})}),{isTransformFunction:!0}),Yl=mA("column",["typed","Index","matrix","range"],(function(A){var e=A.typed,n=A.Index,i=A.matrix,r=A.range,o=So({typed:e,Index:n,matrix:i,range:r});return e("column",{"...any":function(A){var e=A.length-1,n=A[e];t(n)&&(A[e]=n-1);try{return o.apply(null,A)}catch(A){throw Pc(A)}}})}),{isTransformFunction:!0});function fl(A,e,t){var n=A.filter((function(A){return z(A)&&!(A.name in e)&&!t.has(A.name)}))[0];if(!n)throw new Error('No undefined variable found in inline expression "'+A+'"');var i=n.name,r=Gg(t),o=A.compile();return function(A){return r.set(i,A),o.evaluate(r)}}var Nl=mA("filter",["typed"],(function(A){var e=A.typed;function t(A,e,t){var i,r;return A[0]&&(i=A[0].compile().evaluate(t)),A[1]&&(r=z(A[1])||R(A[1])?A[1].compile().evaluate(t):fl(A[1],e,t)),n(i,r)}t.rawArgs=!0;var n=e("filter",{"Array, function":Ul,"Matrix, function":function(A,e){return A.create(Ul(A.toArray(),e))},"Array, RegExp":ln,"Matrix, RegExp":function(A,e){return A.create(ln(A.toArray(),e))}});return t}),{isTransformFunction:!0});function Ul(A,e){return un(A,(function(A,t,n){return ko(e,A,[t+1],n,"filter")}))}var yl=mA("forEach",["typed"],(function(A){var e=A.typed;function t(A,e,t){var i,r;return A[0]&&(i=A[0].compile().evaluate(t)),A[1]&&(r=z(A[1])||R(A[1])?A[1].compile().evaluate(t):fl(A[1],e,t)),n(i,r)}t.rawArgs=!0;var n=e("forEach",{"Array | Matrix, function":function(A,e){!function t(n,i){if(!Array.isArray(n))return ko(e,n,i,A,"forEach");Qn(n,(function(A,e){t(A,i.concat(e+1))}))}(A.valueOf(),[])}});return t}),{isTransformFunction:!0}),Tl=mA("index",["Index","getMatrixDataType"],(function(A){var e=A.Index,n=A.getMatrixDataType;return function(){for(var A=[],i=0,o=arguments.length;i<o;i++){var s=arguments[i];if(l(s))s.start--,s.end-=s.step>0?0:2;else if(s&&!0===s.isSet)s=s.map((function(A){return A-1}));else if(c(s)||g(s))"boolean"!==n(s)&&(s=s.map((function(A){return A-1})));else if(t(s))s--;else if(r(s))s=s.toNumber()-1;else if("string"!=typeof s)throw new TypeError("Dimension must be an Array, Matrix, number, string, or Range");A[i]=s}var a=new e;return e.apply(a,A),a}}),{isTransformFunction:!0}),xl=mA("map",["typed"],(function(A){var e=A.typed;function t(A,e,t){var i,r;return A[0]&&(i=A[0].compile().evaluate(t)),A[1]&&(r=z(A[1])||R(A[1])?A[1].compile().evaluate(t):fl(A[1],e,t)),n(i,r)}t.rawArgs=!0;var n=e("map",{"Array, function":function(A,e){return Rl(A,e,A)},"Matrix, function":function(A,e){return A.create(Rl(A.valueOf(),e,A))}});return t}),{isTransformFunction:!0});function Rl(A,e,t){return function A(n,i){return Array.isArray(n)?En(n,(function(e,t){return A(e,i.concat(t+1))})):ko(e,n,i,t,"map")}(A,[])}function Gl(A){if(2===A.length&&E(A[0])){var e=(A=A.slice())[1];t(e)?A[1]=e-1:r(e)&&(A[1]=e.minus(1))}return A}var Sl=mA("max",["typed","config","numeric","larger"],(function(A){var e=A.typed,t=A.config,n=A.numeric,i=A.larger,r=iB({typed:e,config:t,numeric:n,larger:i});return e("max",{"...any":function(A){A=Gl(A);try{return r.apply(null,A)}catch(A){throw Pc(A)}}})}),{isTransformFunction:!0}),Hl=mA("mean",["typed","add","divide"],(function(A){var e=A.typed,t=A.add,n=A.divide,i=HE({typed:e,add:t,divide:n});return e("mean",{"...any":function(A){A=Gl(A);try{return i.apply(null,A)}catch(A){throw Pc(A)}}})}),{isTransformFunction:!0}),bl=mA("min",["typed","config","numeric","smaller"],(function(A){var e=A.typed,t=A.config,n=A.numeric,i=A.smaller,r=rB({typed:e,config:t,numeric:n,smaller:i});return e("min",{"...any":function(A){A=Gl(A);try{return r.apply(null,A)}catch(A){throw Pc(A)}}})}),{isTransformFunction:!0}),vl=mA("range",["typed","config","?matrix","?bignumber","smaller","smallerEq","larger","largerEq","add","isPositive"],(function(A){var e=A.typed,t=A.config,n=A.matrix,i=A.bignumber,r=A.smaller,o=A.smallerEq,s=A.larger,a=A.largerEq,B=A.add,c=A.isPositive,g=rs({typed:e,config:t,matrix:n,bignumber:i,smaller:r,smallerEq:o,larger:s,largerEq:a,add:B,isPositive:c});return e("range",{"...any":function(A){return"boolean"!=typeof A[A.length-1]&&A.push(!0),g.apply(null,A)}})}),{isTransformFunction:!0}),kl=mA("row",["typed","Index","matrix","range"],(function(A){var e=A.typed,n=A.Index,i=A.matrix,r=A.range,o=Es({typed:e,Index:n,matrix:i,range:r});return e("row",{"...any":function(A){var e=A.length-1,n=A[e];t(n)&&(A[e]=n-1);try{return o.apply(null,A)}catch(A){throw Pc(A)}}})}),{isTransformFunction:!0}),jl=mA("subset",["typed","matrix","zeros","add"],(function(A){var e=A.typed,t=A.matrix,n=A.zeros,i=A.add,r=ws({typed:e,matrix:t,zeros:n,add:i});return e("subset",{"...any":function(A){try{return r.apply(null,A)}catch(A){throw Pc(A)}}})}),{isTransformFunction:!0}),Jl=mA("concat",["typed","matrix","isInteger"],(function(A){var e=A.typed,n=A.matrix,i=A.isInteger,o=Go({typed:e,matrix:n,isInteger:i});return e("concat",{"...any":function(A){var e=A.length-1,n=A[e];t(n)?A[e]=n-1:r(n)&&(A[e]=n.minus(1));try{return o.apply(null,A)}catch(A){throw Pc(A)}}})}),{isTransformFunction:!0}),zl=mA("diff",["typed","matrix","subtract","number","bignumber"],(function(A){var e=A.typed,t=A.matrix,n=A.subtract,i=A.number,r=A.bignumber,o=As({typed:e,matrix:t,subtract:n,number:i,bignumber:r});return e("diff",{"...any":function(A){A=Gl(A);try{return o.apply(null,A)}catch(A){throw Pc(A)}}})}),{isTransformFunction:!0}),Ll=mA("std",["typed","map","sqrt","variance"],(function(A){var e=A.typed,t=A.map,n=A.sqrt,i=A.variance,r=PE({typed:e,map:t,sqrt:n,variance:i});return e("std",{"...any":function(A){A=Gl(A);try{return r.apply(null,A)}catch(A){throw Pc(A)}}})}),{isTransformFunction:!0}),Pl=mA("sum",["typed","config","add","numeric"],(function(A){var e=A.typed,t=A.config,n=A.add,i=A.numeric,r=RE({typed:e,config:t,add:n,numeric:i});return e("sum",{"...any":function(A){A=Gl(A);try{return r.apply(null,A)}catch(A){throw Pc(A)}}})}),{isTransformFunction:!0}),Ol=mA("quantileSeq",["typed","bignumber","add","subtract","divide","multiply","partitionSelect","compare","isInteger","smaller","smallerEq","larger"],(function(A){var e=A.typed,t=A.bignumber,n=A.add,i=A.subtract,r=A.divide,o=A.multiply,s=A.partitionSelect,a=A.compare,B=A.isInteger,c=A.smaller,g=A.smallerEq,E=A.larger,Q=LE({typed:e,bignumber:t,add:n,subtract:i,divide:r,multiply:o,partitionSelect:s,compare:a,isInteger:B,smaller:c,smallerEq:g,larger:E});return e("quantileSeq",{"Array | Matrix, number | BigNumber":Q,"Array | Matrix, number | BigNumber, number":function(A,e,t){return Q(A,e,u(t))},"Array | Matrix, number | BigNumber, boolean":Q,"Array | Matrix, number | BigNumber, boolean, number":function(A,e,t,n){return Q(A,e,t,u(n))},"Array | Matrix, Array | Matrix":Q,"Array | Matrix, Array | Matrix, number":function(A,e,t){return Q(A,e,u(t))},"Array | Matrix, Array | Matrix, boolean":Q,"Array | Matrix, Array | Matrix, boolean, number":function(A,e,t,n){return Q(A,e,t,u(n))}});function u(A){return Gl([[],A])[1]}}),{isTransformFunction:!0}),Vl=mA("cumsum",["typed","add","unaryPlus"],(function(A){var e=A.typed,n=A.add,i=A.unaryPlus,o=SE({typed:e,add:n,unaryPlus:i});return e("cumsum",{"...any":function(A){if(2===A.length&&E(A[0])){var e=A[1];t(e)?A[1]=e-1:r(e)&&(A[1]=e.minus(1))}try{return o.apply(null,A)}catch(A){throw Pc(A)}}})}),{isTransformFunction:!0}),Wl="variance",Kl=mA(Wl,["typed","add","subtract","multiply","divide","apply","isNaN"],(function(A){var e=A.typed,t=A.add,n=A.subtract,i=A.multiply,r=A.divide,o=A.apply,s=A.isNaN,a=JE({typed:e,add:t,subtract:n,multiply:i,divide:r,apply:o,isNaN:s});return e(Wl,{"...any":function(A){A=Gl(A);try{return a.apply(null,A)}catch(A){throw Pc(A)}}})}),{isTransformFunction:!0}),Xl=mA("print",["typed","matrix","zeros","add"],(function(A){var e=A.typed,t=A.matrix,n=A.zeros,i=A.add,r=Os({typed:e,matrix:t,zeros:n,add:i});return e("print",{"string, Object | Array":function(A,e){return r(o(A),e)},"string, Object | Array, number | Object":function(A,e,t){return r(o(A),e,t)}});function o(A){return A.replace(Ps,(function(A){return"$"+A.slice(1).split(".").map((function(A){return!isNaN(A)&&A.length>0?parseInt(A)-1:A})).join(".")}))}}),{isTransformFunction:!0}),Zl=(n(1517),n(4279)),_l={epsilon:1e-12,matrix:"Matrix",number:"number",precision:64,predictable:!1,randomSeed:null},ql=["Matrix","Array"],$l=["number","BigNumber","Fraction"];function Aw(A,e){function t(t){if(t){var n=lA(A,uA);ew(t,"matrix",ql),ew(t,"number",$l),function A(e,t){if(Array.isArray(t))throw new TypeError("Arrays are not supported by deepExtend");for(var n in t)if(MA(t,n)&&!(n in Object.prototype)&&!(n in Function.prototype))if(t[n]&&t[n].constructor===Object)void 0===e[n]&&(e[n]={}),e[n]&&e[n].constructor===Object?A(e[n],t[n]):e[n]=t[n];else{if(Array.isArray(t[n]))throw new TypeError("Arrays are not supported by deepExtend");e[n]=t[n]}return e}(A,t);var i=lA(A,uA),r=lA(t,uA);return e("config",i,n,r),i}return lA(A,uA)}return t.MATRIX_OPTIONS=ql,t.NUMBER_OPTIONS=$l,Object.keys(_l).forEach((function(e){Object.defineProperty(t,e,{get:function(){return A[e]},enumerable:!0,configurable:!0})})),t}function ew(A,e,t){var n,i;void 0!==A[e]&&(n=t,i=A[e],-1===n.indexOf(i))&&console.warn('Warning: Unknown value "'+A[e]+'" for configuration option "'+e+'". Available options: '+t.map((function(A){return JSON.stringify(A)})).join(", ")+".")}const tw=function A(n,i){var x=kt({},_l,i);if("function"!=typeof Object.create)throw new Error("ES5 not supported by this JavaScript engine. Please load the es5-shim and es5-sham library for compatibility.");var P,V,W=(P={isNumber:t,isComplex:o,isBigNumber:r,isFraction:s,isUnit:a,isString:B,isArray:c,isMatrix:g,isCollection:E,isDenseMatrix:Q,isSparseMatrix:u,isRange:l,isIndex:w,isBoolean:h,isResultSet:C,isHelp:I,isFunction:M,isDate:d,isRegExp:m,isObject:p,isNull:F,isUndefined:D,isAccessorNode:Y,isArrayNode:f,isAssignmentNode:N,isBlockNode:U,isConditionalNode:y,isConstantNode:T,isFunctionAssignmentNode:R,isFunctionNode:G,isIndexNode:S,isNode:H,isObjectNode:b,isOperatorNode:v,isParenthesisNode:k,isRangeNode:j,isRelationalNode:J,isSymbolNode:z,isChain:L},V=new Zl,P.on=V.on.bind(V),P.off=V.off.bind(V),P.once=V.once.bind(V),P.emit=V.emit.bind(V),P);W.config=Aw(x,W.emit),W.expression={transform:{},mathWithTransform:{config:W.config}};var K={};function X(){for(var A=arguments.length,e=new Array(A),t=0;t<A;t++)e[t]=arguments[t];return W.typed.apply(W.typed,e)}X.isTypedFunction=O.isTypedFunction;var Z=function(A,t,n,i){function B(e,t,r){var o;if(r.wrap&&"function"==typeof t&&(t=function(A){var e=function(){for(var e=[],t=0,i=arguments.length;t<i;t++){var r=arguments[t];e[t]=r&&r.valueOf()}return A.apply(n,e)};return A.transform&&(e.transform=A.transform),e}(t)),"function"==typeof(o=t)&&"string"==typeof o.signature&&(t=A(e,Ir({},t.signature,t))),A.isTypedFunction(n[e])&&A.isTypedFunction(t))return t=r.override?A(e,t.signatures):A(n[e],t),n[e]=t,delete i[e],c(e,t),void n.emit("import",e,(function(){return t}));if(void 0===n[e]||r.override)return n[e]=t,delete i[e],c(e,t),void n.emit("import",e,(function(){return t}));if(!r.silent)throw new Error('Cannot import "'+e+'": already exists')}function c(A,e){e&&"function"==typeof e.transform?(n.expression.transform[A]=e.transform,u(A)&&(n.expression.mathWithTransform[A]=e.transform)):(delete n.expression.transform[A],u(A)&&(n.expression.mathWithTransform[A]=e))}function E(A){delete n.expression.transform[A],u(A)?n.expression.mathWithTransform[A]=n[A]:delete n.expression.mathWithTransform[A]}function Q(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.fn;if(Mn(r,"."))throw new Error("Factory name should not contain a nested path. Name: "+JSON.stringify(r));var o=w(e)?n.expression.transform:n,s=r in n.expression.transform,a=MA(o,r)?o[r]:void 0,B=function(){var i={};e.dependencies.map(FA).forEach((function(A){if(Mn(A,"."))throw new Error("Factory dependency should not contain a nested path. Name: "+JSON.stringify(A));"math"===A?i.math=n:"mathWithTransform"===A?i.mathWithTransform=n.expression.mathWithTransform:"classes"===A?i.classes=n:i[A]=n[A]}));var o=e(i);if(o&&"function"==typeof o.transform)throw new Error('Transforms cannot be attached to factory functions. Please create a separate function for it with exports.path="expression.transform"');if(void 0===a||t.override)return o;if(A.isTypedFunction(a)&&A.isTypedFunction(o))return A(a,o);if(t.silent)return a;throw new Error('Cannot import "'+r+'": already exists')};e.meta&&!1===e.meta.lazy?(o[r]=B(),a&&s?E(r):(w(e)||l(e))&&IA(n.expression.mathWithTransform,r,(function(){return o[r]}))):(IA(o,r,B),a&&s?E(r):(w(e)||l(e))&&IA(n.expression.mathWithTransform,r,(function(){return o[r]}))),i[r]=e,n.emit("import",r,B)}function u(A){return!MA(h,A)}function l(A){return!(-1!==A.fn.indexOf(".")||MA(h,A.fn)||A.meta&&A.meta.isClass)}function w(A){return void 0!==A&&void 0!==A.meta&&!0===A.meta.isTransformFunction||!1}var h={expression:!0,type:!0,docs:!0,error:!0,json:!0,chain:!0};return function(A,t){var n=arguments.length;if(1!==n&&2!==n)throw new yr("import",n,1,2);t||(t={});var i,c={};for(var E in function A(n,i,r){if(Array.isArray(i))i.forEach((function(e){return A(n,e)}));else if("object"===e(i))for(var o in i)MA(i,o)&&A(n,i[o],o);else if(pA(i)||void 0!==r){var s=pA(i)?w(i)?i.fn+".transform":i.fn:r;if(MA(n,s)&&n[s]!==i&&!t.silent)throw new Error('Cannot import "'+s+'" twice');n[s]=i}else if(!t.silent)throw new TypeError("Factory, Object, or Array expected")}(c,A),c)if(MA(c,E)){var u=c[E];if(pA(u))Q(u,t);else if("function"==typeof(i=u)||"number"==typeof i||"string"==typeof i||"boolean"==typeof i||null===i||a(i)||o(i)||r(i)||s(i)||g(i)||Array.isArray(i))B(E,u,t);else if(!t.silent)throw new TypeError("Factory, Object, or Array expected")}}}(X,0,W,K);return W.import=Z,W.on("config",(function(){dA(K).forEach((function(A){A&&A.meta&&A.meta.recreateOnConfigChange&&Z(A,{override:!0})}))})),W.create=A.bind(null,n),W.factory=mA,W.import(dA(function(A){var e={};return CA(A,e),e}(n))),W.ArgumentsError=yr,W.DimensionError=_t,W.IndexError=qt,W}(A)})(),i.default})(),A.exports=t()}).call(this,t(14))},function(A,e,t){const n=t(1),i=t(3),r=t(4),o=t(2),s=t(8),a='\n<block type="sensing_thing_has_number">\n    <value name="TEXT1">\n        <shadow type="text">\n            <field name="TEXT">abc 10 def</field>\n        </shadow>\n    </value>\n</block>\n<block type="sensing_isUpperCase">\n    <value name="text">\n        <shadow type="text">\n            <field name="TEXT">A</field>\n        </shadow>\n    </value>\n</block>\n<block type="sensing_regextest">\n    <value name="text">\n        <shadow type="text">\n            <field name="TEXT">foo bar</field>\n        </shadow>\n    </value>\n    <value name="reg">\n        <shadow type="text">\n            <field name="TEXT">foo</field>\n        </shadow>\n    </value>\n    <value name="regrule">\n        <shadow type="text">\n            <field name="TEXT">g</field>\n        </shadow>\n    </value>\n</block>\n'.concat('<sep gap="36"/>','\n%b16>\n%b17>\n%b20>\n%b22>\n<block type="pmSensingExpansion_amountOfTimeKeyHasBeenHeld">\n    <value name="KEY">\n        <shadow type="sensing_keyoptions" />\n    </value>\n</block>\n%b18>\n%b19>\n%b23>\n%b24>\n').concat('<sep gap="36"/>','\n%b14>\n<block type="sensing_getspritewithattrib">\n    <value name="var">\n        <shadow type="text">\n            <field name="TEXT">my variable</field>\n        </shadow>\n    </value>\n    <value name="val">\n        <shadow type="text">\n            <field name="TEXT">0</field>\n        </shadow>\n    </value>\n</block>\n%b10>\n').concat('<sep gap="36"/>',"\n%b6>\n%b9>\n%b11>\n%b15>\n%b12>\n%b13>\n").concat('<sep gap="36"/>','\n<block type="sensing_getoperatingsystem"/>\n<block type="sensing_getbrowser"/>\n<block type="sensing_geturl"/>\n').concat('<sep gap="36"/>',"\n%b7>\n%b5>\n%b8>\n%b4>\n").concat('<sep gap="36"/>',"\n%b3>\n").concat('<sep gap="36"/>',"\n%b0>\n%b1>\n").concat('<sep gap="36"/>',"\n%b2>\n");A.exports=class{constructor(A){this.runtime=A,this.canVibrate=!0,this.lastUpdate=Date.now(),this.canGetLoudness=!1,this.loudnessArray=[0],this.scrollDistance=0,this.lastValues={}}orderCategoryBlocks(A){let e=a,t=0;for(const n of A)e=e.replace("%b"+t+">",n),t++;return[e]}getInfo(){return{id:"pmSensingExpansion",name:"Sensing Expansion",color1:"#5CB1D6",color2:"#47A8D1",color3:"#2E8EB8",isDynamic:!0,orderBlocks:this.orderCategoryBlocks,blocks:[{opcode:"batteryPercentage",text:"battery percentage",blockType:n.REPORTER,disableMonitor:!0},{opcode:"batteryCharging",text:"is device charging?",blockType:n.BOOLEAN,disableMonitor:!0},{opcode:"vibrateDevice",text:"vibrate",blockType:n.COMMAND},{opcode:"browserLanguage",text:"preferred language",blockType:n.REPORTER,disableMonitor:!0},{opcode:"urlOptions",text:"url [OPTIONS]",blockType:n.REPORTER,disableMonitor:!0,arguments:{OPTIONS:{type:i.STRING,menu:"urlSections"}}},{opcode:"urlOptionsOf",text:"[OPTIONS] of url [URL]",blockType:n.REPORTER,disableMonitor:!0,arguments:{OPTIONS:{type:i.STRING,menu:"urlSections"},URL:{type:i.STRING,defaultValue:"https://home.penguinmod.com:3000/some/random/page?param=10#20"}}},{opcode:"setUsername",text:"set username to [NAME]",blockType:n.COMMAND,arguments:{NAME:{type:i.STRING,defaultValue:"Penguin"}}},{opcode:"setUrlEnd",text:"set url path to [PATH]",blockType:n.COMMAND,arguments:{PATH:{type:i.STRING,defaultValue:"?parameter=10#you-can-change-these-without-refreshing"}}},{opcode:"queryParamOfUrl",text:"query parameter [PARAM] of url [URL]",blockType:n.REPORTER,disableMonitor:!0,arguments:{PARAM:{type:i.STRING,defaultValue:"param"},URL:{type:i.STRING,defaultValue:"https://penguinmod.com/?param=10"}}},{opcode:"packaged",text:"project packaged?",blockType:n.BOOLEAN,disableMonitor:!0},{opcode:"spriteName",text:"sprite name",blockType:n.REPORTER,disableMonitor:!0},{opcode:"framed",text:"project in iframe?",blockType:n.BOOLEAN,disableMonitor:!0},{opcode:"currentMillisecond",text:"current millisecond",blockType:n.REPORTER,disableMonitor:!1},{opcode:"deltaTime",text:"delta time",blockType:n.REPORTER,disableMonitor:!1},{opcode:"pickColor",text:"grab color at x: [X] y: [Y]",blockType:n.REPORTER,arguments:{X:{type:i.NUMBER,defaultValue:0},Y:{type:i.NUMBER,defaultValue:0}}},{opcode:"maxSpriteLayers",text:"max sprite layers",blockType:n.REPORTER},{opcode:"averageLoudness",text:"average loudness",blockType:n.REPORTER},{opcode:"scrollingDistance",text:"scrolling distance",blockType:n.REPORTER},{opcode:"setScrollingDistance",text:"set scrolling distance to [AMOUNT]",blockType:n.COMMAND,arguments:{AMOUNT:{type:i.NUMBER,defaultValue:0}}},{opcode:"changeScrollingDistanceBy",text:"change scrolling distance by [AMOUNT]",blockType:n.COMMAND,arguments:{AMOUNT:{type:i.NUMBER,defaultValue:100}}},{opcode:"currentKeyPressed",text:"current key pressed",blockType:n.REPORTER},{opcode:"amountOfTimeKeyHasBeenHeld",text:"seconds since holding [KEY]",blockType:n.REPORTER,arguments:{KEY:{type:i.STRING,defaultValue:"a"}}},{opcode:"getLastKeyPressed",text:r({id:"tw.blocks.lastKeyPressed",default:"last key pressed",description:"Block that returns the last key that was pressed"}),blockType:n.REPORTER},{opcode:"getButtonIsDown",text:r({id:"tw.blocks.buttonIsDown",default:"[MOUSE_BUTTON] mouse button down?",description:"Block that returns whether a specific mouse button is down"}),blockType:n.BOOLEAN,arguments:{MOUSE_BUTTON:{type:i.NUMBER,menu:"mouseButton",defaultValue:"0"}}},{opcode:"changed",blockType:n.BOOLEAN,text:"[ONE] changed?",arguments:{ONE:{type:null}}}],menus:{mouseButton:{items:[{text:r({id:"tw.blocks.mouseButton.primary",default:"(0) primary",description:"Dropdown item to select primary (usually left) mouse button"}),value:"0"},{text:r({id:"tw.blocks.mouseButton.middle",default:"(1) middle",description:"Dropdown item to select middle mouse button"}),value:"1"},{text:r({id:"tw.blocks.mouseButton.secondary",default:"(2) secondary",description:"Dropdown item to select secondary (usually right) mouse button"}),value:"2"}],acceptReporters:!0},urlSections:{acceptReporters:!0,items:["protocol","host","hostname","port","pathname","search","hash","origin","subdomain","path"].map(A=>({text:A,value:A}))}}}}getLastKeyPressed(A,e){return e.ioQuery("keyboard","getLastKeyPressed")}getButtonIsDown(A,e){const t=o.toNumber(A.MOUSE_BUTTON);return e.ioQuery("mouse","getButtonIsDown",[t])}changed(A,e){const t=e.thread.peekStack();return this.lastValues[t]||(this.lastValues[t]=o.toString(A.ONE)),o.toString(A.ONE)!==this.lastValues[t]&&(this.lastValues[t]=o.toString(A.ONE),!0)}pickColor(A){const e=this.runtime.renderer,t=o.toNumber(A.X),n=o.toNumber(A.Y),i=Math.round((this.runtime.stageWidth/2+t)/this.runtime.stageWidth*e._gl.canvas.clientWidth),r=Math.round((this.runtime.stageHeight/2-n)/this.runtime.stageHeight*e._gl.canvas.clientHeight),a=e.extractColor(i,r,20);return s.rgbToHex(a.color)}urlOptionFromObject(A,e){if(!["protocol","host","hostname","port","pathname","search","hash","origin","subdomain","path"].includes(A))return"";switch(A){case"subdomain":{const A=e.origin;if(A.split(".").length<=2)return"";const t=A.split(".")[0].split("//")[1];return t?t.replace(/\./gim,""):""}case"path":{const A=e.origin;return A.endsWith("/")?e.href.replace(A,""):e.href.replace(A+"/","")}}return o.toString(e[A])}validateUrl(A){let e=!0;try{new URL(A)}catch(A){e=!1}return e}batteryPercentage(){return"getBattery"in navigator?new Promise(A=>{navigator.getBattery().then(e=>{A(100*e.level)}).catch(()=>100)}):100}batteryCharging(){return!("getBattery"in navigator)||new Promise(A=>{navigator.getBattery().then(e=>{A(e.charging)}).catch(()=>!0)})}maxSpriteLayers(){return this.runtime.renderer._drawList.length-1}averageLoudness(){this.canGetLoudness||(console.log("created average loudness loop"),setInterval(()=>{if(!this.canGetLoudness)return;const A=this.runtime.audioEngine.getLoudness();"number"==typeof A&&(this.loudnessArray.length>20&&this.loudnessArray.shift(),A<0?this.loudnessArray.push(0):this.loudnessArray.push(A))},50)),this.canGetLoudness=!0;let A=0,e=this.loudnessArray.length;for(const e of this.loudnessArray)A+=e;return A/e}scrollingDistance(){return this.scrollDistance}setScrollingDistance(A){const e=o.toNumber(A.AMOUNT);this.scrollDistance=e}changeScrollingDistanceBy(A){const e=o.toNumber(A.AMOUNT);this.scrollDistance+=e}currentKeyPressed(A,e){const t=e.ioQuery("keyboard","getAllKeysPressed"),n=t[t.length-1];return n?o.toString(n).toLowerCase():""}amountOfTimeKeyHasBeenHeld(A,e){const t=o.toString(A.KEY),n=e.ioQuery("keyboard","getKeyTimestamp",[t]);if(0===n)return 0;return(Date.now()-n)/1e3}vibrateDevice(){this.canVibrate&&"vibrate"in navigator&&(this.canVibrate=!1,navigator.vibrate(250),setTimeout(()=>{this.canVibrate=!0},1e3))}browserLanguage(){if(!("language"in navigator))return"Unknown";switch(o.toString(navigator.language).split("-")[0].toLowerCase()){case"en":return"English";case"es":return"Spanish";case"fr":return"French";case"it":return"Italian";case"pt":return"Portuguese";case"de":return"German";case"ru":return"Russian";case"ar":return"Arabic";case"zh":return"Chinese (Mandarin)";case"he":return"Hebrew";case"ja":return"Japanese";case"ko":return"Korean";case"sw":return"Swahili";case"sq":return"Albanian";case"hy":return"Armenian";case"eu":return"Basque";case"nl":return"Dutch";case"ka":return"Georgian";case"gd":return"Scottish Gaelic";case"ga":return"Modern Irish";case"fa":return"Persian (Farsi)";case"bo":return"Tibetan";case"cy":return"Welsh";case"el":return"Modern Greek";case"grc":return"Ancient Greek";case"la":return"Latin";case"ang":return"Anglo-Saxon";case"enm":return"Middle English";default:return"Unknown"}}urlOptions(A){if(!("location"in window))return"";const e=o.toString(A.OPTIONS).toLowerCase();return this.urlOptionFromObject(e,location)}urlOptionsOf(A){if(!("location"in window))return"";const e=o.toString(A.OPTIONS).toLowerCase(),t=o.toString(A.URL);return this.validateUrl(t)?this.urlOptionFromObject(e,new URL(t)):""}setUsername(A){const e=o.toString(A.NAME);vm.postIOData("userData",{username:e,loggedIn:!1})}setUrlEnd(A){if(!("history"in window))return;const e=o.toString(A.PATH),t=location.origin.endsWith("/")?location.origin+e:location.origin+"/"+e;history.replaceState("","",t)}queryParamOfUrl(A){if(!("URLSearchParams"in window))return"";const e=o.toString(A.URL);if(!this.validateUrl(e))return"";const t=new URL(e);return new URLSearchParams(t.search).get(o.toString(A.PARAM))}packaged(){return this.runtime.isPackaged}spriteName(A,e){return e.target.getName()}framed(){return!!window.parent&&window.parent!==window}currentMillisecond(){return Date.now()%1e3}deltaTime(){let A=Date.now(),e=A-this.lastUpdate;return this.lastUpdate=A,e}}},function(A,e,t){const n=t(1),i=t(3),r=t(63),o=t(2),s=t(267),a='\n<block type="control_repeatForSeconds">\n    <value name="TIMES">\n        <shadow type="math_number">\n            <field name="NUM">1</field>\n        </shadow>\n    </value>\n</block>\n%block0>\n%block1>\n<block type="control_inline_stack_output">\n    <value name="SUBSTACK">\n        <block type="procedures_return">\n            <value name="return">\n            \t<shadow type="text">\n            \t\t<field name="TEXT">1</field>\n            \t</shadow>\n            </value>\n        </block>\n    </value>\n</block>\n<block type="control_waittick"/>\n%block3>\n'.concat('<sep gap="36"/>',"\n%block2>\n%block4>\n%block5>\n").concat('<sep gap="36"/>','\n<block type="control_get_counter"/>\n<block type="control_incr_counter"/>\n<block type="control_decr_counter"/>\n<block type="control_set_counter">\n    <value name="VALUE">\n        <shadow type="math_whole_number">\n            <field name="NUM">10</field>\n        </shadow>\n    </value>\n</block>\n<block type="control_clear_counter"/>\n');A.exports=class{constructor(A){this.runtime=A,this.runtime.registerCompiledExtensionBlocks("pmControlsExpansion",this.getCompileInfo())}orderCategoryBlocks(A){let e=a,t=0;for(const n of A)e=e.replace("%block".concat(t,">"),n),t++;return[e]}getInfo(){return{id:"pmControlsExpansion",name:"Controls Expansion",color1:"#FFAB19",color2:"#EC9C13",color3:"#CF8B17",isDynamic:!0,orderBlocks:this.orderCategoryBlocks,blocks:[{opcode:"ifElseIf",text:["if [CONDITION1] then","else if [CONDITION2] then"],branchCount:2,blockType:n.CONDITIONAL,arguments:{CONDITION1:{type:i.BOOLEAN},CONDITION2:{type:i.BOOLEAN}}},{opcode:"ifElseIfElse",text:["if [CONDITION1] then","else if [CONDITION2] then","else"],branchCount:3,blockType:n.CONDITIONAL,arguments:{CONDITION1:{type:i.BOOLEAN},CONDITION2:{type:i.BOOLEAN}}},{opcode:"asNewBroadcast",text:["new thread","[ICON]"],branchCount:1,blockType:n.CONDITIONAL,alignments:[null,null,r.RIGHT],arguments:{ICON:{type:i.IMAGE,dataURI:s}}},{opcode:"restartFromTheTop",text:"restart from the top [ICON]",blockType:n.COMMAND,isTerminal:!0,arguments:{ICON:{type:i.IMAGE,dataURI:"".concat("static/blocks-media","/repeat.svg")}}},{opcode:"asNewBroadcastArgs",text:["new thread with data [DATA]","[ICON]"],branchCount:1,blockType:n.CONDITIONAL,alignments:[null,null,r.RIGHT],arguments:{DATA:{type:i.STRING,defaultValue:"abc"},ICON:{type:i.IMAGE,dataURI:s}}},{opcode:"asNewBroadcastArgBlock",text:"thread data",blockType:n.REPORTER,disableMonitor:!0}]}}getCompileInfo(){return{ir:{ifElseIf:(A,e)=>({kind:"stack",condition1:A.descendInputOfBlock(e,"CONDITION1"),condition2:A.descendInputOfBlock(e,"CONDITION2"),whenTrue1:A.descendSubstack(e,"SUBSTACK"),whenTrue2:A.descendSubstack(e,"SUBSTACK2")}),ifElseIfElse:(A,e)=>({kind:"stack",condition1:A.descendInputOfBlock(e,"CONDITION1"),condition2:A.descendInputOfBlock(e,"CONDITION2"),whenTrue1:A.descendSubstack(e,"SUBSTACK"),whenTrue2:A.descendSubstack(e,"SUBSTACK2"),whenTrue3:A.descendSubstack(e,"SUBSTACK3")}),restartFromTheTop:()=>({kind:"stack"})},js:{ifElseIf:(A,e,t)=>{e.source+="if (".concat(e.descendInput(A.condition1).asBoolean(),") {\n"),e.descendStack(A.whenTrue1,new t.Frame(!1)),e.source+="} else if (".concat(e.descendInput(A.condition2).asBoolean(),") {\n"),e.descendStack(A.whenTrue2,new t.Frame(!1)),e.source+="}\n"},ifElseIfElse:(A,e,t)=>{e.source+="if (".concat(e.descendInput(A.condition1).asBoolean(),") {\n"),e.descendStack(A.whenTrue1,new t.Frame(!1)),e.source+="} else if (".concat(e.descendInput(A.condition2).asBoolean(),") {\n"),e.descendStack(A.whenTrue2,new t.Frame(!1)),e.source+="} else {\n",e.descendStack(A.whenTrue3,new t.Frame(!1)),e.source+="}\n"},restartFromTheTop:(A,e)=>{e.source+="runtime._restartThread(thread);",e.source+="return;"}}}}ifElseIf(A,e){const t=o.toBoolean(A.CONDITION1),n=o.toBoolean(A.CONDITION2);t?e.startBranch(1,!1):n&&e.startBranch(2,!1)}ifElseIfElse(A,e){const t=o.toBoolean(A.CONDITION1),n=o.toBoolean(A.CONDITION2);t?e.startBranch(1,!1):n?e.startBranch(2,!1):e.startBranch(3,!1)}restartFromTheTop(){}asNewBroadcast(A,e){e.thread.target.blocks.getBranch(e.thread.peekStack(),0)&&e.sequencer.runtime._pushThread(e.thread.target.blocks.getBranch(e.thread.peekStack(),0),e.target,{})}asNewBroadcastArgs(A,e){const t=o.toString(A.DATA);if(e.thread.target.blocks.getBranch(e.thread.peekStack(),0)){e.sequencer.runtime._pushThread(e.thread.target.blocks.getBranch(e.thread.peekStack(),0),e.target,{}).__controlx_asNewBroadcastArgs_data=t}}asNewBroadcastArgBlock(A,e){return e.thread.__controlx_asNewBroadcastArgs_data}}},function(A,e,t){"use strict";t.r(e),e.default=""},function(A,e,t){},function(A,e){A.exports=class{constructor(A){this.runtime=A}orderCategoryBlocks(){return['\n<block type="control_inline_stack_output">\n    <value name="SUBSTACK">\n        <block type="procedures_return">\n            <value name="return">\n            \t<shadow type="text">\n            \t\t<field name="TEXT">1</field>\n            \t</shadow>\n            </value>\n        </block>\n    </value>\n</block>\n']}getInfo(){return{id:"pmInlineBlocks",name:"Inline Blocks",color1:"#FFAB19",color2:"#EC9C13",color3:"#CF8B17",isDynamic:!0,orderBlocks:this.orderCategoryBlocks,blocks:[]}}}},function(A,e,t){},function(A,e,t){},function(A,e,t){},function(A,e,t){const n=t(4),i=t(1),r=t(3),o=new(t(25)),s=t(2),a=t(8),B={isNoop:!0};let c=0;A.exports=class{constructor(A){this.runtime=A,this.pausedScripts=Object.create(null);const e=[];c=this.runtime.frameLoop.framerate,this.runtime.on("RUNTIME_STEP_START",()=>{const A=performance.now();for(;e.length>0&&e[0]<=A-1e3;)e.shift();e.push(A),c=e.length}),this.runtime.on("PROJECT_STOP_ALL",()=>{this.pausedScripts=Object.create(null)})}_typeIsBitmap(A){return"image/png"===A||"image/bmp"===A||"image/jpg"===A||"image/jpeg"===A||"image/jfif"===A||"image/webp"===A||"image/gif"===A}getInfo(){return{id:"jgRuntime",name:"Runtime",color1:"#777777",color2:"#6a6a6a",blocks:[{opcode:"addSpriteUrl",text:"add sprite from [URL]",blockType:i.COMMAND,arguments:{URL:{type:r.STRING,defaultValue:"https://corsproxy.io/?".concat(encodeURIComponent("https://penguinmod.com/Sprite1.pms"))}},switches:[B,"addCostumeUrl","addCostumeUrlForceMime","addSoundUrl","loadProjectDataUrl"],switchText:"add sprite from url"},{opcode:"addCostumeUrl",text:"add costume [name] from [URL]",blockType:i.COMMAND,arguments:{URL:{type:r.STRING,defaultValue:"https://corsproxy.io/?".concat(encodeURIComponent("https://penguinmod.com/navicon.png"))},name:{type:r.STRING,defaultValue:"penguinmod"}},switches:["addSpriteUrl",B,"addCostumeUrlForceMime",{opcode:"addSoundUrl",remapArguments:{name:"NAME"}},"loadProjectDataUrl"],switchText:"add costume from url"},{opcode:"addCostumeUrlForceMime",text:"add [costtype] costume [name] from [URL]",blockType:i.COMMAND,arguments:{costtype:{type:r.STRING,menu:"costumeMimeType"},URL:{type:r.STRING,defaultValue:"https://corsproxy.io/?".concat(encodeURIComponent("https://penguinmod.com/navicon.png"))},name:{type:r.STRING,defaultValue:"penguinmod"}},switches:["addSpriteUrl","addCostumeUrl",B,{opcode:"addSoundUrl",remapArguments:{name:"NAME"}},"loadProjectDataUrl"],switchText:"add typed costume from url"},{opcode:"addSoundUrl",text:"add sound [NAME] from [URL]",blockType:i.COMMAND,arguments:{URL:{type:r.STRING,defaultValue:"https://extensions.turbowarp.org/meow.mp3"},NAME:{type:r.STRING,defaultValue:"Meow"}},switches:["addSpriteUrl",{opcode:"addCostumeUrl",remapArguments:{NAME:"name"}},{opcode:"addCostumeUrlForceMime",remapArguments:{NAME:"name"}},B,"loadProjectDataUrl"],switchText:"add sound from url"},{opcode:"loadProjectDataUrl",text:"load project from [URL]",blockType:i.COMMAND,arguments:{URL:{type:r.STRING,defaultValue:""}},switches:["addSpriteUrl","addCostumeUrl","addCostumeUrlForceMime","addSoundUrl",B],switchText:"load project from url"},{opcode:"getIndexOfCostume",text:"get costume index of [costume]",blockType:i.REPORTER,arguments:{costume:{type:r.STRING,defaultValue:"costume1"}},switches:[B,{opcode:"getIndexOfSound",remapArguments:{costume:"NAME"}}],switchText:"get costume index"},{opcode:"getIndexOfSound",text:"get sound index of [NAME]",blockType:i.REPORTER,arguments:{NAME:{type:r.STRING,defaultValue:"Pop"}},switches:[{opcode:"getIndexOfCostume",remapArguments:{NAME:"costume"}},B],switchText:"get sound index of"},{opcode:"getProjectDataUrl",text:"get data url of project",blockType:i.REPORTER,disableMonitor:!0},"---",{opcode:"setStageSize",text:n({id:"jgRuntime.blocks.setStageSize",default:"set stage width: [WIDTH] height: [HEIGHT]",description:"Sets the width and height of the stage."}),blockType:i.COMMAND,arguments:{WIDTH:{type:r.NUMBER,defaultValue:480},HEIGHT:{type:r.NUMBER,defaultValue:360}}},{opcode:"getStageWidth",text:n({id:"jgRuntime.blocks.getStageWidth",default:"stage width",description:"Block that returns the width of the stage."}),disableMonitor:!1,blockType:i.REPORTER,switches:[B,"getStageHeight"],switchText:"get stage width"},{opcode:"getStageHeight",text:n({id:"jgRuntime.blocks.getStageHeight",default:"stage height",description:"Block that returns the height of the stage."}),disableMonitor:!1,blockType:i.REPORTER,switches:["getStageWidth",B],switchText:"get stage height"},"---",{opcode:"updateRuntimeConfig",text:n({id:"jgRuntime.blocks.updateRuntimeConfig",default:"set [OPTION] to [ENABLED]",description:"Block that enables or disables configuration on the runtime like high quality pen or turbo mode."}),disableMonitor:!1,blockType:i.COMMAND,arguments:{OPTION:{menu:"runtimeConfig"},ENABLED:{menu:"onoff"}}},{opcode:"changeRenderingCapping",text:n({id:"jgRuntime.blocks.changeRenderingCapping",default:"change render setting [OPTION] to [CAPPED]",description:"Block that updates configuration on the renderer like resolution for certain content."}),disableMonitor:!1,blockType:i.COMMAND,arguments:{OPTION:{menu:"renderConfigCappable"},CAPPED:{menu:"cappableSettings"}}},{opcode:"setRenderingNumber",text:n({id:"jgRuntime.blocks.setRenderingNumber",default:"set render setting [OPTION] to [NUM]",description:"Block that sets configuration on the renderer like resolution for certain content."}),disableMonitor:!1,blockType:i.COMMAND,arguments:{OPTION:{menu:"renderConfigNumber"},NUM:{type:r.NUMBER,defaultValue:0}}},{opcode:"runtimeConfigEnabled",text:n({id:"jgRuntime.blocks.runtimeConfigEnabled",default:"[OPTION] enabled?",description:"Block that returns whether a runtime option like Turbo Mode is enabled on the project or not."}),disableMonitor:!1,blockType:i.BOOLEAN,arguments:{OPTION:{menu:"runtimeConfig"}}},{opcode:"turboModeEnabled",text:n({id:"jgRuntime.blocks.turboModeEnabled",default:"turbo mode enabled?",description:"Block that returns whether Turbo Mode is enabled on the project or not."}),disableMonitor:!1,hideFromPalette:!0,blockType:i.BOOLEAN},"---",{opcode:"setMaxClones",text:n({id:"jgRuntime.blocks.setMaxClones",default:"set max clones to [MAX]",description:"Block that enables or disables configuration on the runtime like high quality pen or turbo mode."}),disableMonitor:!1,blockType:i.COMMAND,arguments:{MAX:{menu:"cloneLimit",defaultValue:300}}},{opcode:"maxAmountOfClones",text:n({id:"jgRuntime.blocks.maxAmountOfClones",default:"max clone count",description:"Block that returns the maximum amount of clones that may exist."}),disableMonitor:!1,blockType:i.REPORTER,switches:[B,"amountOfClones","getIsClone"],switchText:"max clone count"},{opcode:"amountOfClones",text:n({id:"jgRuntime.blocks.amountOfClones",default:"clone count",description:"Block that returns the amount of clones that currently exist."}),disableMonitor:!1,blockType:i.REPORTER,switches:["maxAmountOfClones",B,"getIsClone"],switchText:"clone count"},{opcode:"getIsClone",text:n({id:"jgRuntime.blocks.getIsClone",default:"is clone?",description:"Block that returns whether the sprite is a clone or not."}),disableMonitor:!0,blockType:i.BOOLEAN,switches:["maxAmountOfClones","amountOfClones",B],switchText:"is clone?"},"---",{opcode:"setMaxFrameRate",text:n({id:"jgRuntime.blocks.setMaxFrameRate",default:"set max framerate to: [FRAMERATE]",description:"Sets the max allowed framerate."}),blockType:i.COMMAND,arguments:{FRAMERATE:{type:r.NUMBER,defaultValue:30}}},{opcode:"getMaxFrameRate",text:n({id:"jgRuntime.blocks.getMaxFrameRate",default:"max framerate",description:"Block that returns the amount of FPS allowed."}),disableMonitor:!1,blockType:i.REPORTER,switches:[B,"getFrameRate"],switchText:"max framerate"},{opcode:"getFrameRate",text:n({id:"jgRuntime.blocks.getFrameRate",default:"framerate",description:"Block that returns the amount of FPS."}),disableMonitor:!1,blockType:i.REPORTER,switches:["getMaxFrameRate",B],switchText:"framerate"},"---",{opcode:"setBackgroundColor",text:n({id:"jgRuntime.blocks.setBackgroundColor",default:"set stage background color to [COLOR]",description:"Sets the background color of the stage."}),blockType:i.COMMAND,arguments:{COLOR:{type:r.COLOR}}},{opcode:"getBackgroundColor",text:n({id:"jgRuntime.blocks.getBackgroundColor",default:"stage background color",description:"Block that returns the stage background color in HEX."}),disableMonitor:!1,blockType:i.REPORTER},"---",{opcode:"pauseScript",blockType:i.COMMAND,text:"pause this script using name: [NAME]",arguments:{NAME:{type:r.STRING,defaultValue:"my script"}},switches:["pauseScript","unpauseScript"],switchText:"pause this script"},{opcode:"unpauseScript",blockType:i.COMMAND,text:"unpause script named: [NAME]",arguments:{NAME:{type:r.STRING,defaultValue:"my script"}},switches:["pauseScript",B],switchText:"unpause script named"},{opcode:"isScriptPaused",blockType:i.BOOLEAN,text:"is script named [NAME] paused?",arguments:{NAME:{type:r.STRING,defaultValue:"my script"}}},"---",{opcode:"variables_createVariable",text:"create variable named [NAME] for [SCOPE]",blockType:i.COMMAND,arguments:{NAME:{type:r.STRING,defaultValue:"my variable"},SCOPE:{type:r.STRING,menu:"variableScope"}},switches:[B,"variables_createCloudVariable","variables_createList"],switchText:"create variable"},{opcode:"variables_createCloudVariable",text:"create cloud variable named [NAME]",blockType:i.COMMAND,arguments:{NAME:{type:r.STRING,defaultValue:"cloud variable"}},switches:["variables_createVariable",B,"variables_createList"],switchText:"create cloud variable"},{opcode:"variables_createList",text:"create list named [NAME] for [SCOPE]",blockType:i.COMMAND,arguments:{NAME:{type:r.STRING,defaultValue:"list"},SCOPE:{type:r.STRING,menu:"variableScope"}},switches:["variables_createVariable","variables_createCloudVariable",B],switchText:"create list"},{opcode:"variables_getVariable",text:"get value of variable named [NAME] in [SCOPE]",disableMonitor:!0,blockType:i.REPORTER,arguments:{NAME:{type:r.STRING,defaultValue:"my variable"},SCOPE:{type:r.STRING,menu:"variableTypes"}},switches:[B,{opcode:"variables_getList",remapMenus:{SCOPE:{"all sprites":"for all sprites","this sprite":"in this sprite",cloud:"for all sprites"}}},"variables_existsVariable","variables_existsList"],switchText:"value of variable in scope"},{opcode:"variables_getList",text:"get array of list named [NAME] in [SCOPE]",disableMonitor:!0,blockType:i.REPORTER,arguments:{NAME:{type:r.STRING,defaultValue:"list"},SCOPE:{type:r.STRING,menu:"variableScope"}},switches:["variables_getVariable",B,"variables_existsVariable","variables_existsList"],switchText:"value of list in scope"},{opcode:"variables_existsVariable",text:"variable named [NAME] exists in [SCOPE]?",disableMonitor:!0,blockType:i.BOOLEAN,arguments:{NAME:{type:r.STRING,defaultValue:"my variable"},SCOPE:{type:r.STRING,menu:"variableTypes"}},switches:["variables_getVariable","variables_getList",B,"variables_existsList"],switchText:"variable exists in scope"},{opcode:"variables_existsList",text:"list named [NAME] exists in [SCOPE]?",disableMonitor:!0,blockType:i.BOOLEAN,arguments:{NAME:{type:r.STRING,defaultValue:"list"},SCOPE:{type:r.STRING,menu:"variableScope"}},switches:["variables_getVariable","variables_getList","variables_existsVariable",B],switchText:"list exists in scope"},"---",{opcode:"getDataOption",text:n({id:"jgRuntime.blocks.getDataOption",default:"get binary data of [OPTION] named [NAME]",description:"Block that returns the binary data of a sprite, sound or costume."}),disableMonitor:!1,blockType:i.REPORTER,arguments:{OPTION:{type:r.STRING,menu:"objectType"},NAME:{type:r.STRING,defaultValue:"Sprite1"}},switches:[B,"getDataUriOption"],switchText:"get binary data of option"},{opcode:"getDataUriOption",text:n({id:"jgRuntime.blocks.getDataUriOption",default:"get data uri of [OPTION] named [NAME]",description:"Block that returns the data URI of a sprite, sound or costume."}),disableMonitor:!1,blockType:i.REPORTER,arguments:{OPTION:{type:r.STRING,menu:"objectType"},NAME:{type:r.STRING,defaultValue:"Sprite1"}},switches:["getDataOption",B],switchText:"get data uri of option"},"---",{opcode:"getAllSprites",text:"get all sprites",disableMonitor:!1,blockType:i.REPORTER,switches:[B,"getAllCostumes","getAllSounds","getAllFonts"]},{opcode:"getAllCostumes",text:"get all costumes",disableMonitor:!1,blockType:i.REPORTER,switches:["getAllSprites",B,"getAllSounds","getAllFonts"]},{opcode:"getAllSounds",text:"get all sounds",disableMonitor:!1,blockType:i.REPORTER,switches:["getAllSprites","getAllCostumes",B,"getAllFonts"]},{opcode:"getAllFonts",text:"get all fonts",disableMonitor:!1,blockType:i.REPORTER,switches:["getAllSprites","getAllCostumes","getAllSounds",B]},"---",{opcode:"getAllVariables",text:"get all variables [ALLSCOPE]",disableMonitor:!1,blockType:i.REPORTER,arguments:{ALLSCOPE:{type:r.STRING,menu:"allVariableType"}},switches:[B,{opcode:"getAllLists",remapMenus:{ALLSCOPE:{"for all sprites":"for all sprites","in every sprite":"in every sprite","in this sprite":"in this sprite","in the cloud":"for all sprites"}}}],switchText:"get all variables"},{opcode:"getAllLists",text:"get all lists [ALLSCOPE]",disableMonitor:!1,blockType:i.REPORTER,arguments:{ALLSCOPE:{type:r.STRING,menu:"allVariableScope"}},switches:["getAllVariables",B],switchText:"get all lists"},"---",{blockType:i.LABEL,text:"Potentially Dangerous"},{opcode:"deleteCostume",text:n({id:"jgRuntime.blocks.deleteCostume",default:"delete costume at index [COSTUME]",description:"Deletes a costume at the specified index."}),blockType:i.COMMAND,arguments:{COSTUME:{type:r.NUMBER,defaultValue:1}},switches:[B,{opcode:"deleteSound",remapArguments:{COSTUME:"SOUND"}},{opcode:"deleteSprite",remapArguments:{COSTUME:"NAME"}}],switchText:"delete costume at index"},{opcode:"deleteSound",text:n({id:"jgRuntime.blocks.deleteSound",default:"delete sound at index [SOUND]",description:"Deletes a sound at the specified index."}),blockType:i.COMMAND,arguments:{SOUND:{type:r.NUMBER,defaultValue:1}},switches:[{opcode:"deleteCostume",remapArguments:{SOUND:"COSTUME"}},B,{opcode:"deleteSprite",remapArguments:{SOUND:"NAME"}}],switchText:"delete sound at index"},"---",{opcode:"variables_deleteVariable",text:"delete variable named [NAME] in [SCOPE]",blockType:i.COMMAND,arguments:{NAME:{type:r.STRING,defaultValue:"my variable"},SCOPE:{type:r.STRING,menu:"variableTypes"}},switches:[B,{opcode:"variables_deleteList",remapMenus:{SCOPE:{"all sprites":"all sprites","this sprite":"this sprite",cloud:"all sprites"}}}],switchText:"delete variable"},{opcode:"variables_deleteList",text:"delete list named [NAME] in [SCOPE]",blockType:i.COMMAND,arguments:{NAME:{type:r.STRING,defaultValue:"list"},SCOPE:{type:r.STRING,menu:"variableScope"}},switches:["variables_deleteVariable",B],switchText:"delete list"},"---",{opcode:"deleteSprite",text:n({id:"jgRuntime.blocks.deleteSprite",default:"delete sprite named [NAME]",description:"Deletes a sprite with the specified name."}),blockType:i.COMMAND,arguments:{NAME:{type:r.STRING,defaultValue:"Sprite1"}},switches:[{opcode:"deleteCostume",remapArguments:{NAME:"COSTUME"}},{opcode:"deleteSound",remapArguments:{NAME:"SOUND"}},B],switchText:"delete sprite named"}],menus:{objectType:{acceptReporters:!0,items:["sprite","costume","sound"].map(A=>({text:A,value:A}))},variableScope:{acceptReporters:!0,items:["all sprites","this sprite"].map(A=>({text:A,value:A}))},allVariableScope:{acceptReporters:!0,items:["for all sprites","in every sprite","in this sprite"].map(A=>({text:A,value:A}))},allVariableType:{acceptReporters:!0,items:["for all sprites","in every sprite","in this sprite","in the cloud"].map(A=>({text:A,value:A}))},variableTypes:{acceptReporters:!0,items:["all sprites","this sprite","cloud"].map(A=>({text:A,value:A}))},cloneLimit:{items:["100","128","300","500","1000","1024","5000","10000","16384","Infinity"],isTypeable:!0,isNumeric:!0},runtimeConfig:{acceptReporters:!0,items:["turbo mode","high quality pen","offscreen sprites","remove miscellaneous limits","disable offscreen rendering","disable direction clamping","interpolation","warp timer"]},renderConfigCappable:{acceptReporters:!0,items:["animated text resolution"]},renderConfigNumber:{acceptReporters:!0,items:["animated text resolution"]},onoff:["on","off"],costumeMimeType:["png","bmp","jpg","jpeg","jfif","webp","gif","vector"],cappableSettings:["uncapped","capped","fixed"]}}}_generateScratchId(){const A="!#%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=[];for(let t=0;t<20;t++)e[t]=A.charAt(Math.random()*A.length);return e.join("")}addCostumeUrl(A,e){const t=e.target.id;return new Promise(e=>{fetch(A.URL,{method:"GET"}).then(n=>n.blob().then(n=>{const i=!!A.costtype,r="vector"!==A.costtype;if(!this._typeIsBitmap(n.type)&&"image/svg+xml"!==n.type&&!i)throw e(),new Error('Invalid mime type: "'.concat(n.type,'"'));const o=(i?r:this._typeIsBitmap(n.type))?this.runtime.storage.AssetType.ImageBitmap:this.runtime.storage.AssetType.ImageVector,s=i?r?A.costtype:"svg":"image/svg+xml"===n.type?"svg":n.type.split("/")[1];n.arrayBuffer().then(n=>{const a=i?r?new Uint8Array(n):n:"image/svg+xml"===s?n:new Uint8Array(n),B=this.runtime.storage.createAsset(o,s,a,null,!0),c="".concat(B.assetId,".").concat(B.dataFormat),g={asset:B,md5ext:c,name:A.name},E=vm.addCostume(c,g,t);E.then?E.then(e):e()}).catch(A=>{console.error("Failed to Load Costume: ".concat(A)),e()})}))})}addCostumeUrlForceMime(A,e){this.addCostumeUrl(A,e)}deleteCostume(A,e){const t=Math.round(s.toNumber(A.COSTUME))-1;t<0||e.target.deleteCostume(t)}deleteSound(A,e){const t=Math.round(s.toNumber(A.SOUND))-1;t<0||e.target.deleteSound(t)}getIndexOfCostume(A,e){return e.target.getCostumeIndexByName(A.costume)+1}getIndexOfSound(A,e){let t=0;const n=e.target.getSounds();for(let e=0;e<n.length;e++)n[e].name===A.NAME&&(t=e+1);return t}setStageSize(A){vm&&vm.setStageSize(Math.max(1,s.toNumber(A.WIDTH)),Math.max(1,s.toNumber(A.HEIGHT)))}turboModeEnabled(){return this.runtime.turboMode}amountOfClones(){return this.runtime._cloneCounter}getStageWidth(){return this.runtime.stageWidth}getStageHeight(){return this.runtime.stageHeight}getMaxFrameRate(){return this.runtime.frameLoop.framerate}getIsClone(A,e){return!e.target.isOriginal}changeRenderingCapping(A){const e=s.toString(A.OPTION).toLowerCase(),t=s.toString(A.CAPPED).toLowerCase();switch(e){case"animated text resolution":this.runtime.renderer.customRenderConfig.textCostumeResolution.fixed=!1,this.runtime.renderer.customRenderConfig.textCostumeResolution.capped=!1,"fixed"===t?this.runtime.renderer.customRenderConfig.textCostumeResolution.fixed=!0:"capped"===t&&(this.runtime.renderer.customRenderConfig.textCostumeResolution.capped=!0)}this.runtime.renderer.dirty=!0,this.runtime.requestRedraw()}setRenderingNumber(A){const e=s.toString(A.OPTION).toLowerCase(),t=s.toNumber(A.NUM);switch(e){case"animated text resolution":this.runtime.renderer.customRenderConfig.textCostumeResolution.value=t;break;case"max texture scale for new svg images":this.runtime.renderer.setMaxTextureDimension(t)}this.runtime.renderer.dirty=!0,this.runtime.requestRedraw()}updateRuntimeConfig(A){const e="on"===s.toString(A.ENABLED).toLowerCase();switch(s.toString(A.OPTION).toLowerCase()){case"turbo mode":return vm.setTurboMode(e);case"high quality pen":return this.runtime.renderer.setUseHighQualityRender(e);case"offscreen sprites":return this.runtime.setRuntimeOptions({fencing:!e});case"remove miscellaneous limits":return this.runtime.setRuntimeOptions({miscLimits:!e});case"disable offscreen rendering":return this.runtime.setRuntimeOptions({disableOffscreenRendering:e});case"disable direction clamping":return this.runtime.setRuntimeOptions({disableDirectionClamping:e});case"interpolation":return vm.setInterpolation(e);case"warp timer":return this.runtime.setCompilerOptions({warpTimer:e})}}runtimeConfigEnabled(A){switch(s.toString(A.OPTION).toLowerCase()){case"turbo mode":return this.runtime.turboMode;case"high quality pen":return this.runtime.renderer.useHighQualityRender;case"offscreen sprites":return!this.runtime.runtimeOptions.fencing;case"remove miscellaneous limits":return!this.runtime.runtimeOptions.miscLimits;case"disable offscreen rendering":return this.runtime.runtimeOptions.disableOffscreenRendering;case"disable direction clamping":return this.runtime.runtimeOptions.disableDirectionClamping;case"interpolation":return this.runtime.interpolationEnabled;case"warp timer":return this.runtime.compilerOptions.warpTimer;default:return!1}}setMaxClones(A){const e=Math.round(s.toNumber(A.MAX));this.runtime.vm.setRuntimeOptions({maxClones:e})}maxAmountOfClones(){return this.runtime.runtimeOptions.maxClones}setBackgroundColor(A){let e;"number"==typeof A.COLOR?(e=s.toRgbColorObject(A.COLOR),this.runtime.renderer.setBackgroundColor(e.r/255,e.g/255,e.b/255)):(e=s.toString(A.COLOR),e=e.startsWith("#")?e.slice(1):e,this.runtime.renderer.setBackgroundColor(parseInt(e.slice(0,2),16)/255,parseInt(e.slice(2,4),16)/255,parseInt(e.slice(4,6),16)/255,8===e.length?parseInt(e.slice(6,8),16)/255:1))}getBackgroundColor(){const A=this.runtime.renderer._backgroundColor3b,e={r:Math.round(s.toNumber(A[0])),g:Math.round(s.toNumber(A[1])),b:Math.round(s.toNumber(A[2]))};return a.rgbToHex(e)}pauseScript(A,e){const t=s.toString(A.NAME),n=e.stackFrame.pausedScript;n?n in this.pausedScripts&&e.yield():(this.pausedScripts[t]=!0,e.stackFrame.pausedScript=t,e.yield())}unpauseScript(A){const e=s.toString(A.NAME);e in this.pausedScripts&&delete this.pausedScripts[e]}isScriptPaused(A){return s.toString(A.NAME)in this.pausedScripts}setMaxFrameRate(A){let e=s.toNumber(A.FRAMERATE);this.runtime.frameLoop.setFramerate(e)}deleteSprite(A){const e=this.runtime.getSpriteTargetByName(A.NAME);e&&vm.deleteSpriteInternal(e.id)}getDataOption(A,e){switch(A.OPTION){case"sprite":{const e=this.runtime.targets.filter(A=>A.isOriginal).filter(e=>e.sprite.name===A.NAME)[0];return e?new Promise(A=>{vm.exportSprite(e.id).then(e=>{e.arrayBuffer().then(e=>{const t=o.bufferToArray(e),n=JSON.stringify(t);A(n)}).catch(()=>A("[]"))}).catch(()=>A("[]"))}):"[]"}case"costume":{const t=e.target.getCostumes(),n=e.target.getCostumeIndexByName(A.NAME);if(!t[n])return"[]";const i=t[n].asset.data,r=o.bufferToArray(i.buffer);return JSON.stringify(r)}case"sound":{const t=e.target.getSounds(),n=this.getIndexOfSound(A,e)-1;if(!t[n])return"[]";const i=t[n].asset.data,r=o.bufferToArray(i.buffer);return JSON.stringify(r)}default:return"[]"}}getDataUriOption(A,e){switch(A.OPTION){case"sprite":{const e=this.runtime.targets.filter(A=>A.isOriginal).filter(e=>e.sprite.name===A.NAME)[0];return e?new Promise(A=>{vm.exportSprite(e.id).then(e=>{const t=new FileReader;t.onload=()=>A(t.result),t.onerror=()=>A(""),t.onabort=()=>A(""),t.readAsDataURL(e)}).catch(()=>A(""))}):""}case"costume":{const t=e.target.getCostumes(),n=e.target.getCostumeIndexByName(A.NAME);if(!t[n])return"";return t[n].asset.encodeDataURI()}case"sound":{const t=e.target.getSounds(),n=this.getIndexOfSound(A,e)-1;if(!t[n])return"";return t[n].asset.encodeDataURI()}default:return""}}getAllSprites(){return JSON.stringify(this.runtime.targets.filter(A=>A.isOriginal&&!A.isStage).map(A=>A.sprite.name))}getAllCostumes(A,e){const t=e.target.getCostumes();return JSON.stringify(t.map(A=>A.name))}getAllSounds(A,e){const t=e.target.getSounds();return JSON.stringify(t.map(A=>A.name))}getAllFonts(){const A=this.runtime.fontManager.getFonts();return JSON.stringify(A.map(A=>A.name))}loadProjectDataUrl(A){const e=s.toString(A.URL);("undefined"==typeof ScratchBlocks||confirm("Runtime Extension - Editor: Are you sure you want to load a new project?\nEverything in the current project will be permanently deleted."))&&(console.log("Loading project from custom source..."),fetch(e).then(A=>A.arrayBuffer()).then(A=>vm.loadProject(A)).then(()=>{console.log("Loaded project!"),vm.greenFlag()}).catch(A=>{console.log("Error loading custom project;",A)}))}getProjectDataUrl(){return new Promise(A=>{const e="data:application/octet-stream;base64,";vm.saveProjectSb3().then(t=>{const n=new FileReader;n.onload=()=>{A(n.result)},n.onerror=()=>{A(e)},n.readAsDataURL(t)}).catch(()=>{A(e)})})}getAllVariables(A,e){switch(A.ALLSCOPE){case"for all sprites":{const A=this.runtime.getTargetForStage();if(!A)return"[]";const e=A.variables;return e?JSON.stringify(Object.values(e).filter(A=>"list"!==A.type).map(A=>A.name)):"[]"}case"in every sprite":{const A=this.runtime.targets;if(!A)return"[]";const e=A.filter(A=>A.isOriginal).map(A=>A.variables);return e?JSON.stringify(e.map(A=>Object.values(A)).map(A=>A.filter(A=>"list"!==A.type).map(A=>A.name)).flat(1)):"[]"}case"in this sprite":{const A=e.target;if(!A)return"[]";const t=A.variables;return t?JSON.stringify(Object.values(t).filter(A=>"list"!==A.type).map(A=>A.name)):"[]"}case"in the cloud":{const A=this.runtime.getTargetForStage();if(!A)return"[]";const e=A.variables;return e?JSON.stringify(Object.values(e).filter(A=>"list"!==A.type).filter(A=>!0===A.isCloud).map(A=>A.name)):"[]"}default:return"[]"}}getAllLists(A,e){switch(A.ALLSCOPE){case"for all sprites":{const A=this.runtime.getTargetForStage();if(!A)return"[]";const e=A.variables;return e?JSON.stringify(Object.values(e).filter(A=>"list"===A.type).map(A=>A.name)):"[]"}case"in every sprite":{const A=this.runtime.targets;if(!A)return"[]";const e=A.filter(A=>A.isOriginal).map(A=>A.variables);return e?JSON.stringify(e.map(A=>Object.values(A)).map(A=>A.filter(A=>"list"===A.type).map(A=>A.name)).flat(1)):"[]"}case"in this sprite":{const A=e.target;if(!A)return"[]";const t=A.variables;return t?JSON.stringify(Object.values(t).filter(A=>"list"===A.type).map(A=>A.name)):"[]"}default:return"[]"}}getFrameRate(){return c}addSoundUrl(A,e){const t=e.target.id;return new Promise(e=>{fetch(A.URL).then(A=>A.arrayBuffer()).then(n=>{const i=this.runtime.storage,r=new i.Asset(i.AssetType.Sound,null,i.DataFormat.MP3,new Uint8Array(n),!0);e(vm.addSound({md5:r.assetId+"."+r.dataFormat,asset:r,name:A.NAME},t))}).catch(e)})}addSpriteUrl(A){return new Promise(e=>{fetch(A.URL).then(A=>{A.arrayBuffer().then(A=>{vm.addSprite(A).finally(e)}).catch(e)}).catch(e)})}variables_createVariable(A,e){const t=A.NAME;switch(A.SCOPE){case"all sprites":return this.runtime.createNewGlobalVariable(t);case"this sprite":return e.target.createVariable(this._generateScratchId(),t,"")}}variables_createCloudVariable(A){const e=" ".concat(A.NAME),t=this.runtime.getTargetForStage();if(!t)return;const n=this._generateScratchId();t.createVariable(n,e,"",!0)}variables_createList(A,e){const t=A.NAME;switch(A.SCOPE){case"all sprites":return this.runtime.createNewGlobalVariable(t,null,"list");case"this sprite":return e.target.createVariable(this._generateScratchId(),t,"list")}}variables_getVariable(A,e){const t=A.NAME;let n,i=!1;if("all sprites"===A.SCOPE)n=this.runtime.getTargetForStage();else if("this sprite"===A.SCOPE)n=e.target;else{if("cloud"!==A.SCOPE)return"";n=this.runtime.getTargetForStage(),i=!0}const r=Object.values(n.variables).filter(A=>"list"!==A.type).filter(A=>A.isCloud?String(A.name).replace(" ","")===t:!i&&A.name===t);if(!r)return"";const o=r[0];return o?o.value:""}variables_getList(A,e){const t=A.NAME;let n;if("all sprites"===A.SCOPE)n=this.runtime.getTargetForStage();else{if("this sprite"!==A.SCOPE)return"[]";n=e.target}const i=Object.values(n.variables).filter(A=>"list"===A.type).filter(A=>A.name===t);if(!i)return"[]";const r=i[0];return r?JSON.stringify(r.value):"[]"}variables_deleteVariable(A,e){const t=A.NAME;let n,i=!1;if("all sprites"===A.SCOPE)n=this.runtime.getTargetForStage();else if("this sprite"===A.SCOPE)n=e.target;else{if("cloud"!==A.SCOPE)return;n=this.runtime.getTargetForStage(),i=!0}const r=Object.values(n.variables).filter(A=>"list"!==A.type).filter(A=>A.isCloud?String(A.name).replace(" ","")===t:!i&&A.name===t);if(!r)return;const o=r[0];return o?n.deleteVariable(o.id):void 0}variables_deleteList(A,e){const t=A.NAME;let n;if("all sprites"===A.SCOPE)n=this.runtime.getTargetForStage();else{if("this sprite"!==A.SCOPE)return;n=e.target}const i=Object.values(n.variables).filter(A=>"list"===A.type).filter(A=>A.name===t);if(!i)return;const r=i[0];return r?n.deleteVariable(r.id):void 0}variables_existsVariable(A,e){const t=A.NAME;let n,i=!1;if("all sprites"===A.SCOPE)n=this.runtime.getTargetForStage();else if("this sprite"===A.SCOPE)n=e.target;else{if("cloud"!==A.SCOPE)return!1;n=this.runtime.getTargetForStage(),i=!0}const r=Object.values(n.variables).filter(A=>"list"!==A.type).filter(A=>A.isCloud?String(A.name).replace(" ","")===t:!i&&A.name===t);if(!r)return!1;return!!r[0]}variables_existsList(A,e){const t=A.NAME;let n;if("all sprites"===A.SCOPE)n=this.runtime.getTargetForStage();else{if("this sprite"!==A.SCOPE)return!1;n=e.target}const i=Object.values(n.variables).filter(A=>"list"===A.type).filter(A=>A.name===t);if(!i)return!1;return!!i[0]}}},function(A,e,t){},function(A,e){var t,n,i,r,o,s,a,B,c,g,E,Q,u,l,w,h,C,I,M,d,m,p,F,D,Y,f,N,U,y,T,x,R,G,S,H,b,v,k,j,J,z,L,P,O,V,W,K,X,Z,_,q,$,AA,eA,tA,nA,iA=parseInt(17/3,10),rA=null;function oA(){this.fc=0,this.dl=0}function sA(){this.dyn_tree=null,this.static_tree=null,this.extra_bits=null,this.extra_base=0,this.elems=0,this.max_length=0,this.max_code=0}function aA(A,e,t,n){this.good_length=A,this.max_lazy=e,this.nice_length=t,this.max_chain=n}function BA(){this.next=null,this.len=0,this.ptr=[],this.off=0}var cA=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],gA=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],EA=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],QA=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],uA=[new aA(0,0,0,0),new aA(4,4,8,4),new aA(4,5,16,8),new aA(4,6,32,32),new aA(4,4,16,16),new aA(8,16,32,32),new aA(8,16,128,128),new aA(8,32,128,256),new aA(32,128,258,1024),new aA(32,258,258,4096)];function lA(A){A.next=t,t=A}function wA(A){return E[32768+A]}function hA(A,e){return E[32768+A]=e}function CA(A){rA[s+o++]=A,s+o===8192&&function(){var A,e;if(0!==o){for(null!==t?(r=t,t=t.next):r=new BA,r.next=null,r.len=r.off=0,A=r,null===n?n=i=A:i=i.next=A,A.len=o-s,e=0;e<A.len;e++)A.ptr[e]=rA[s+e];o=s=0}var r}()}function IA(A){A&=65535,s+o<8190?(rA[s+o++]=255&A,rA[s+o++]=A>>>8):(CA(255&A),CA(A>>>8))}function MA(){w=32767&(w<<iA^255&B[m+3-1]),h=wA(w),E[32767&m]=h,hA(w,m)}function dA(A,e){kA(e[A].fc,e[A].dl)}function mA(A){return 255&(A<256?O[A]:O[256+(A>>7)])}function pA(A,e,t){return A[e].fc<A[t].fc||A[e].fc===A[t].fc&&L[e]<=L[t]}function FA(A,e,t){var n;for(n=0;n<t&&nA<tA.length;n++)A[e+n]=255&tA[nA++];return n}function DA(A){var e,t,n,i,r=Y,o=m,s=d,a=m>32506?m-32506:0,c=m+258,g=B[o+s-1],Q=B[o+s];d>=U&&(r>>=2);do{if(B[(e=A)+s]===Q&&B[e+s-1]===g&&B[e]===B[o]&&B[++e]===B[o+1]){for(o+=2,e++;o<c;){for(i=!1,n=0;n<8;n+=1)if(e+=1,B[o+=1]!==B[e]){i=!0;break}if(i)break}if(t=258-(c-o),o=c-258,t>s){if(p=A,s=t,t>=y)break;g=B[o+s-1],Q=B[o+s]}}}while((A=E[32767&A])>a&&0!=--r);return s}function YA(){var A,e,t=65536-D-m;if(-1===t)t--;else if(m>=65274){for(A=0;A<32768;A++)B[A]=B[A+32768];for(p-=32768,m-=32768,l-=32768,A=0;A<32768;A++)hA(A,(e=wA(A))>=32768?e-32768:0);for(A=0;A<32768;A++)e=E[A],E[A]=e>=32768?e-32768:0;t+=32768}F||((A=FA(B,m+D,t))<=0?F=!0:D+=A)}function fA(){F||(Q=0,u=0,function(){var A,e,t,n,i;if(0!==G[0].dl)return;for(H.dyn_tree=T,H.static_tree=R,H.extra_bits=cA,H.extra_base=257,H.elems=286,H.max_length=15,H.max_code=0,b.dyn_tree=x,b.static_tree=G,b.extra_bits=gA,b.extra_base=0,b.elems=30,b.max_length=15,b.max_code=0,v.dyn_tree=S,v.static_tree=null,v.extra_bits=EA,v.extra_base=0,v.elems=19,v.max_length=7,v.max_code=0,t=0,n=0;n<28;n++)for(V[n]=t,A=0;A<1<<cA[n];A++)P[t++]=n;for(P[t-1]=n,i=0,n=0;n<16;n++)for(W[n]=i,A=0;A<1<<gA[n];A++)O[i++]=n;for(i>>=7;n<30;n++)for(W[n]=i<<7,A=0;A<1<<gA[n]-7;A++)O[256+i++]=n;for(e=0;e<=15;e++)k[e]=0;A=0;for(;A<=143;)R[A++].dl=8,k[8]++;for(;A<=255;)R[A++].dl=9,k[9]++;for(;A<=279;)R[A++].dl=7,k[7]++;for(;A<=287;)R[A++].dl=8,k[8]++;for(xA(R,287),A=0;A<30;A++)G[A].dl=5,G[A].fc=jA(A,5);yA()}(),function(){var A;for(A=0;A<32768;A++)E[32768+A]=0;if(f=uA[N].max_lazy,U=uA[N].good_length,y=uA[N].nice_length,Y=uA[N].max_chain,m=0,l=0,(D=FA(B,0,65536))<=0)return F=!0,void(D=0);for(F=!1;D<262&&!F;)YA();for(w=0,A=0;A<2;A++)w=32767&(w<<iA^255&B[A])}(),n=null,o=0,s=0,N<=3?(d=2,M=0):(M=2,I=!1),a=!1)}function NA(A,e,t){var i;return r||(fA(),r=!0,0!==D)?(i=UA(A,e,t))===t?t:a?i:(N<=3?function(){for(;0!==D&&null===n;){var A;if(MA(),0!==h&&m-h<=32506&&(M=DA(h))>D&&(M=D),M>=3)if(A=bA(m-p,M-3),D-=M,M<=f){M--;do{m++,MA()}while(0!=--M);m++}else m+=M,M=0,w=32767&((w=255&B[m])<<iA^255&B[m+1]);else A=bA(0,255&B[m]),D--,m++;for(A&&(HA(0),l=m);D<262&&!F;)YA()}}():function(){for(;0!==D&&null===n;){if(MA(),d=M,C=p,M=2,0!==h&&d<f&&m-h<=32506&&((M=DA(h))>D&&(M=D),3===M&&m-p>4096&&M--),d>=3&&M<=d){var A;A=bA(m-1-C,d-3),D-=d-1,d-=2;do{m++,MA()}while(0!=--d);I=!1,M=2,m++,A&&(HA(0),l=m)}else I?(bA(0,255&B[m-1])&&(HA(0),l=m),m++,D--):(I=!0,m++,D--);for(;D<262&&!F;)YA()}}(),0===D&&(I&&bA(0,255&B[m-1]),HA(1),a=!0),i+UA(A,i+e,t-i)):(a=!0,0)}function UA(A,e,t){var i,r,a;for(i=0;null!==n&&i<t;){for((r=t-i)>n.len&&(r=n.len),a=0;a<r;a++)A[e+i+a]=n.ptr[n.off+a];var B;if(n.off+=r,n.len-=r,i+=r,0===n.len)B=n,n=n.next,lA(B)}if(i===t)return i;if(s<o){for((r=t-i)>o-s&&(r=o-s),a=0;a<r;a++)A[e+i+a]=rA[s+a];i+=r,o===(s+=r)&&(o=s=0)}return i}function yA(){var A;for(A=0;A<286;A++)T[A].fc=0;for(A=0;A<30;A++)x[A].fc=0;for(A=0;A<19;A++)S[A].fc=0;T[256].fc=1,AA=eA=0,X=Z=_=0,q=0,$=1}function TA(A,e){for(var t=j[e],n=e<<1;n<=J&&(n<J&&pA(A,j[n+1],j[n])&&n++,!pA(A,t,j[n]));)j[e]=j[n],e=n,n<<=1;j[e]=t}function xA(A,e){var t,n,i=[],r=0;for(t=1;t<=15;t++)r=r+k[t-1]<<1,i[t]=r;for(n=0;n<=e;n++){var o=A[n].dl;0!==o&&(A[n].fc=jA(i[o]++,o))}}function RA(A){var e,t,n=A.dyn_tree,i=A.static_tree,r=A.elems,o=-1,s=r;for(J=0,z=573,e=0;e<r;e++)0!==n[e].fc?(j[++J]=o=e,L[e]=0):n[e].dl=0;for(;J<2;){var a=j[++J]=o<2?++o:0;n[a].fc=1,L[a]=0,AA--,null!==i&&(eA-=i[a].dl)}for(A.max_code=o,e=J>>1;e>=1;e--)TA(n,e);do{e=j[1],j[1]=j[J--],TA(n,1),t=j[1],j[--z]=e,j[--z]=t,n[s].fc=n[e].fc+n[t].fc,L[e]>L[t]+1?L[s]=L[e]:L[s]=L[t]+1,n[e].dl=n[t].dl=s,j[1]=s++,TA(n,1)}while(J>=2);j[--z]=j[1],function(A){var e,t,n,i,r,o,s=A.dyn_tree,a=A.extra_bits,B=A.extra_base,c=A.max_code,g=A.max_length,E=A.static_tree,Q=0;for(i=0;i<=15;i++)k[i]=0;for(s[j[z]].dl=0,e=z+1;e<573;e++)(i=s[s[t=j[e]].dl].dl+1)>g&&(i=g,Q++),s[t].dl=i,t>c||(k[i]++,r=0,t>=B&&(r=a[t-B]),o=s[t].fc,AA+=o*(i+r),null!==E&&(eA+=o*(E[t].dl+r)));if(0!==Q){do{for(i=g-1;0===k[i];)i--;k[i]--,k[i+1]+=2,k[g]--,Q-=2}while(Q>0);for(i=g;0!==i;i--)for(t=k[i];0!==t;)(n=j[--e])>c||(s[n].dl!==i&&(AA+=(i-s[n].dl)*s[n].fc,s[n].fc=i),t--)}}(A),xA(n,o)}function GA(A,e){var t,n,i=-1,r=A[0].dl,o=0,s=7,a=4;for(0===r&&(s=138,a=3),A[e+1].dl=65535,t=0;t<=e;t++)n=r,r=A[t+1].dl,++o<s&&n===r||(o<a?S[n].fc+=o:0!==n?(n!==i&&S[n].fc++,S[16].fc++):o<=10?S[17].fc++:S[18].fc++,o=0,i=n,0===r?(s=138,a=3):n===r?(s=6,a=3):(s=7,a=4))}function SA(A,e){var t,n,i=-1,r=A[0].dl,o=0,s=7,a=4;for(0===r&&(s=138,a=3),t=0;t<=e;t++)if(n=r,r=A[t+1].dl,!(++o<s&&n===r)){if(o<a)do{dA(n,S)}while(0!=--o);else 0!==n?(n!==i&&(dA(n,S),o--),dA(16,S),kA(o-3,2)):o<=10?(dA(17,S),kA(o-3,3)):(dA(18,S),kA(o-11,7));o=0,i=n,0===r?(s=138,a=3):n===r?(s=6,a=3):(s=7,a=4)}}function HA(A){var e,t,n,i,r;if(i=m-l,K[_]=q,RA(H),RA(b),n=function(){var A;for(GA(T,H.max_code),GA(x,b.max_code),RA(v),A=18;A>=3&&0===S[QA[A]].dl;A--);return AA+=3*(A+1)+5+5+4,A}(),(t=eA+3+7>>3)<=(e=AA+3+7>>3)&&(e=t),i+4<=e&&l>=0)for(kA(0+A,3),JA(),IA(i),IA(~i),r=0;r<i;r++)CA(B[l+r]);else t===e?(kA(2+A,3),vA(R,G)):(kA(4+A,3),function(A,e,t){var n;for(kA(A-257,5),kA(e-1,5),kA(t-4,4),n=0;n<t;n++)kA(S[QA[n]].dl,3);SA(T,A-1),SA(x,e-1)}(H.max_code+1,b.max_code+1,n+1),vA(T,x));yA(),0!==A&&JA()}function bA(A,e){if(g[X++]=e,0===A?T[e].fc++:(A--,T[P[e]+256+1].fc++,x[mA(A)].fc++,c[Z++]=A,q|=$),$<<=1,0==(7&X)&&(K[_++]=q,q=0,$=1),N>2&&0==(4095&X)){var t,n=8*X,i=m-l;for(t=0;t<30;t++)n+=x[t].fc*(5+gA[t]);if(n>>=3,Z<parseInt(X/2,10)&&n<parseInt(i/2,10))return!0}return 8191===X||8192===Z}function vA(A,e){var t,n,i,r,o=0,s=0,a=0,B=0;if(0!==X)do{0==(7&o)&&(B=K[a++]),n=255&g[o++],0==(1&B)?dA(n,A):(dA((i=P[n])+256+1,A),0!==(r=cA[i])&&kA(n-=V[i],r),dA(i=mA(t=c[s++]),e),0!==(r=gA[i])&&kA(t-=W[i],r)),B>>=1}while(o<X);dA(256,A)}function kA(A,e){u>16-e?(IA(Q|=A<<u),Q=A>>16-u,u+=e-16):(Q|=A<<u,u+=e)}function jA(A,e){var t=0;do{t|=1&A,A>>=1,t<<=1}while(--e>0);return t>>1}function JA(){u>8?IA(Q):u>0&&CA(Q),Q=0,u=0}A.exports=function(A,e){var o,s;tA=A,nA=0,void 0===e&&(e=6),function(A){var e;if(A?A<1?A=1:A>9&&(A=9):A=6,N=A,r=!1,F=!1,null===rA){for(t=n=i=null,rA=[],B=[],c=[],g=[],E=[],T=[],e=0;e<573;e++)T[e]=new oA;for(x=[],e=0;e<61;e++)x[e]=new oA;for(R=[],e=0;e<288;e++)R[e]=new oA;for(G=[],e=0;e<30;e++)G[e]=new oA;for(S=[],e=0;e<39;e++)S[e]=new oA;H=new sA,b=new sA,v=new sA,k=[],j=[],L=[],P=[],O=[],V=[],W=[],K=[]}}(e),s=[];do{o=NA(s,s.length,1024)}while(o>0);return tA=null,s},A.exports.DEFAULT_LEVEL=6},function(A,e){var t,n,i,r,o,s,a,B,c,g,E,Q,u,l,w,h,C,I=null,M=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],d=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],m=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],p=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],F=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];function Y(){this.next=null,this.list=null}function f(){this.e=0,this.b=0,this.n=0,this.t=null}function N(A,e,t,n,i,r){var o;this.BMAX=16,this.N_MAX=288,this.status=0,this.root=null,this.m=0;var s,a,B,c,g,E,Q,u,l,w,h,C,I,M,d,m,p=[],F=[],D=new f,N=[],U=[],y=[];for(m=this.root=null,g=0;g<this.BMAX+1;g++)p[g]=0;for(g=0;g<this.BMAX+1;g++)F[g]=0;for(g=0;g<this.BMAX;g++)N[g]=null;for(g=0;g<this.N_MAX;g++)U[g]=0;for(g=0;g<this.BMAX+1;g++)y[g]=0;s=e>256?A[256]:this.BMAX,u=A,l=0,g=e;do{p[u[l]]++,l++}while(--g>0);if(p[0]===e)return this.root=null,this.m=0,void(this.status=0);for(E=1;E<=this.BMAX&&0===p[E];E++);for(Q=E,r<E&&(r=E),g=this.BMAX;0!==g&&0===p[g];g--);for(B=g,r>g&&(r=g),I=1<<E;E<g;E++,I<<=1)if((I-=p[E])<0)return this.status=2,void(this.m=r);if((I-=p[g])<0)return this.status=2,void(this.m=r);for(p[g]+=I,y[1]=E=0,u=p,l=1,C=2;--g>0;)y[C++]=E+=u[l++];u=A,l=0,g=0;do{0!==(E=u[l++])&&(U[y[E]++]=g)}while(++g<e);for(e=y[B],y[0]=g=0,u=U,l=0,c=-1,h=F[0]=0,w=null,M=0;Q<=B;Q++)for(o=p[Q];o-- >0;){for(;Q>h+F[1+c];){if(h+=F[1+c],c++,M=(M=B-h)>r?r:M,(a=1<<(E=Q-h))>o+1)for(a-=o+1,C=Q;++E<M&&!((a<<=1)<=p[++C]);)a-=p[C];for(h+E>s&&h<s&&(E=s-h),M=1<<E,F[1+c]=E,w=[],d=0;d<M;d++)w[d]=new f;(m=m?m.next=new Y:this.root=new Y).next=null,m.list=w,N[c]=w,c>0&&(y[c]=g,D.b=F[c],D.e=16+E,D.t=w,E=(g&(1<<h)-1)>>h-F[c],N[c-1][E].e=D.e,N[c-1][E].b=D.b,N[c-1][E].n=D.n,N[c-1][E].t=D.t)}for(D.b=Q-h,l>=e?D.e=99:u[l]<t?(D.e=u[l]<256?16:15,D.n=u[l++]):(D.e=i[u[l]-t],D.n=n[u[l++]-t]),a=1<<Q-h,E=g>>h;E<M;E+=a)w[E].e=D.e,w[E].b=D.b,w[E].n=D.n,w[E].t=D.t;for(E=1<<Q-1;0!=(g&E);E>>=1)g^=E;for(g^=E;(g&(1<<h)-1)!==y[c];)h-=F[c],c--}this.m=F[1],this.status=0!==I&&1!==B?1:0}function U(A){for(;a<A;)s|=(h.length===C?-1:255&h[C++])<<a,a+=8}function y(A){return s&M[A]}function T(A){s>>=A,a-=A}function x(A,e,i){var r,o,s;if(0===i)return 0;for(s=0;;){for(U(l),r=(o=Q.list[y(l)]).e;r>16;){if(99===r)return-1;T(o.b),U(r-=16),r=(o=o.t[y(r)]).e}if(T(o.b),16!==r){if(15===r)break;for(U(r),g=o.n+y(r),T(r),U(w),r=(o=u.list[y(w)]).e;r>16;){if(99===r)return-1;T(o.b),U(r-=16),r=(o=o.t[y(r)]).e}for(T(o.b),U(r),E=n-o.n-y(r),T(r);g>0&&s<i;)g--,E&=32767,n&=32767,A[e+s++]=t[n++]=t[E++];if(s===i)return i}else if(n&=32767,A[e+s++]=t[n++]=o.n,s===i)return i}return B=-1,s}function R(A,e,i){var r;if(T(r=7&a),U(16),r=y(16),T(16),U(16),r!==(65535&~s))return-1;for(T(16),g=r,r=0;g>0&&r<i;)g--,n&=32767,U(8),A[e+r++]=t[n++]=y(8),T(8);return 0===g&&(B=-1),r}function G(A,e,t){if(!I){var n,s,a=[];for(n=0;n<144;n++)a[n]=8;for(;n<256;n++)a[n]=9;for(;n<280;n++)a[n]=7;for(;n<288;n++)a[n]=8;if(0!==(s=new N(a,288,257,d,m,r=7)).status)return console.error("HufBuild error: "+s.status),-1;for(I=s.root,r=s.m,n=0;n<30;n++)a[n]=5;if((s=new N(a,30,0,p,F,o=5)).status>1)return I=null,console.error("HufBuild error: "+s.status),-1;i=s.root,o=s.m}return Q=I,u=i,l=r,w=o,x(A,e,t)}function S(A,e,t){var n,i,r,o,s,a,B,c,g,E=[];for(n=0;n<316;n++)E[n]=0;if(U(5),B=257+y(5),T(5),U(5),c=1+y(5),T(5),U(4),a=4+y(4),T(4),B>286||c>30)return-1;for(i=0;i<a;i++)U(3),E[D[i]]=y(3),T(3);for(;i<19;i++)E[D[i]]=0;if(0!==(g=new N(E,19,19,null,null,l=7)).status)return-1;for(Q=g.root,l=g.m,o=B+c,n=r=0;n<o;)if(U(l),T(i=(s=Q.list[y(l)]).b),(i=s.n)<16)E[n++]=r=i;else if(16===i){if(U(2),i=3+y(2),T(2),n+i>o)return-1;for(;i-- >0;)E[n++]=r}else if(17===i){if(U(3),i=3+y(3),T(3),n+i>o)return-1;for(;i-- >0;)E[n++]=0;r=0}else{if(U(7),i=11+y(7),T(7),n+i>o)return-1;for(;i-- >0;)E[n++]=0;r=0}if(g=new N(E,B,257,d,m,l=9),0===l&&(g.status=1),0!==g.status&&1!==g.status)return-1;for(Q=g.root,l=g.m,n=0;n<c;n++)E[n]=E[n+B];return g=new N(E,c,0,p,F,w=6),u=g.root,0===(w=g.m)&&B>257||0!==g.status?-1:x(A,e,t)}function H(A,e,i){var r,o;for(r=0;r<i;){if(c&&-1===B)return r;if(g>0){if(0!==B)for(;g>0&&r<i;)g--,E&=32767,n&=32767,A[e+r++]=t[n++]=t[E++];else{for(;g>0&&r<i;)g--,n&=32767,U(8),A[e+r++]=t[n++]=y(8),T(8);0===g&&(B=-1)}if(r===i)return r}if(-1===B){if(c)break;U(1),0!==y(1)&&(c=!0),T(1),U(2),B=y(2),T(2),Q=null,g=0}switch(B){case 0:o=R(A,e+r,i-r);break;case 1:o=Q?x(A,e+r,i-r):G(A,e+r,i-r);break;case 2:o=Q?x(A,e+r,i-r):S(A,e+r,i-r);break;default:o=-1}if(-1===o)return c?0:-1;r+=o}return r}A.exports=function(A){var e,i=[];t||(t=[]),n=0,s=0,a=0,B=-1,c=!1,g=E=0,Q=null,h=A,C=0;do{e=H(i,i.length,1024)}while(e>0);return h=null,i}},function(A,e,t){},function(A,e,t){const n=t(1),i=t(3),r=t(2),o=new(t(279).Helper);A.exports=class{constructor(A){this.runtime=A,this.helper=o,this.helper.runtime=this.runtime,this.runtime.on("PROJECT_STOP_ALL",()=>{for(const A in o.audioGroups){const e=o.GetAudioGroup(A);for(const A in e.sources)e.sources[A].stop()}}),this.runtime.registerExtensionAudioContext("jgExtendedAudio",this.helper.audioContext,this.helper.audioGlobalVolumeNode)}deserialize(A){for(const A in o.audioGroups)o.DeleteAudioGroup(A);o.audioGroups={};for(const e of A)o.AddAudioGroup(e.id,e)}serialize(){return o.GetAllAudioGroups().map(A=>({id:A.id,sources:{},globalVolume:A.globalVolume,globalSpeed:A.globalSpeed,globalPitch:A.globalPitch,globalPan:A.globalPan}))}orderCategoryBlocks(A){const e={create:A[0],delete:A[1]},t=A[2];A.splice(0,3);const n=o.GetAllAudioGroups().map(A=>t.replace("{audioGroupId}",A.id));return n.length?(n.reverse(),n.push(e.delete),n.push(e.create),A=n.reverse().concat(A)):[e.create]}getInfo(){return{id:"jgExtendedAudio",name:"Sound Systems",color1:"#E256A1",color2:"#D33388",isDynamic:!0,orderBlocks:this.orderCategoryBlocks,blocks:[{opcode:"createAudioGroup",text:"New Audio Group",blockType:n.BUTTON},{opcode:"deleteAudioGroup",text:"Remove an Audio Group",blockType:n.BUTTON},{opcode:"audioGroupGet",text:"[AUDIOGROUP]",blockType:n.REPORTER,arguments:{AUDIOGROUP:{menu:"audioGroup",defaultValue:"{audioGroupId}",type:i.STRING}}},{text:"Operations",blockType:n.LABEL},{opcode:"audioGroupSetVolumeSpeedPitchPan",text:"set [AUDIOGROUP] [VSPP] to [VALUE]%",blockType:n.COMMAND,arguments:{AUDIOGROUP:{type:i.STRING,menu:"audioGroup",defaultValue:""},VSPP:{type:i.STRING,menu:"vspp",defaultValue:""},VALUE:{type:i.NUMBER,defaultValue:100}}},{opcode:"audioGroupGetModifications",text:"[AUDIOGROUP] [OPTION]",blockType:n.REPORTER,disableMonitor:!0,arguments:{AUDIOGROUP:{type:i.STRING,menu:"audioGroup",defaultValue:""},OPTION:{type:i.STRING,menu:"audioGroupOptions",defaultValue:""}}},"---",{opcode:"audioSourceCreate",text:"[CREATEOPTION] audio source named [NAME] in [AUDIOGROUP]",blockType:n.COMMAND,arguments:{CREATEOPTION:{type:i.STRING,menu:"createOptions",defaultValue:""},NAME:{type:i.STRING,defaultValue:"AudioSource1"},AUDIOGROUP:{type:i.STRING,menu:"audioGroup",defaultValue:""}}},{opcode:"audioSourceDuplicate",text:"duplicate audio source from [NAME] to [COPY] in [AUDIOGROUP]",blockType:n.COMMAND,arguments:{NAME:{type:i.STRING,defaultValue:"AudioSource1"},COPY:{type:i.STRING,defaultValue:"AudioSource2"},AUDIOGROUP:{type:i.STRING,menu:"audioGroup",defaultValue:""}}},{opcode:"audioSourceReverse",text:"reverse audio source used in [NAME] in [AUDIOGROUP]",blockType:n.COMMAND,arguments:{NAME:{type:i.STRING,defaultValue:"AudioSource1"},COPY:{type:i.STRING,defaultValue:"AudioSource2"},AUDIOGROUP:{type:i.STRING,menu:"audioGroup",defaultValue:""}}},{opcode:"audioSourceDeleteAll",text:"[DELETEOPTION] all audio sources in [AUDIOGROUP]",blockType:n.COMMAND,arguments:{DELETEOPTION:{type:i.STRING,menu:"deleteOptions",defaultValue:""},AUDIOGROUP:{type:i.STRING,menu:"audioGroup",defaultValue:""}}},"---",{opcode:"audioSourceSetScratch",text:"set audio source [NAME] in [AUDIOGROUP] to use [SOUND]",blockType:n.COMMAND,arguments:{NAME:{type:i.STRING,defaultValue:"AudioSource1"},AUDIOGROUP:{type:i.STRING,menu:"audioGroup",defaultValue:""},SOUND:{type:i.STRING,menu:"sounds",defaultValue:""}}},{opcode:"audioSourceSetUrl",text:"set audio source [NAME] in [AUDIOGROUP] to use [URL]",blockType:n.COMMAND,arguments:{NAME:{type:i.STRING,defaultValue:"AudioSource1"},AUDIOGROUP:{type:i.STRING,menu:"audioGroup",defaultValue:""},URL:{type:i.STRING,defaultValue:"https://extensions.turbowarp.org/meow.mp3"}}},{opcode:"audioSourcePlayerOption",text:"[PLAYEROPTION] audio source [NAME] in [AUDIOGROUP]",blockType:n.COMMAND,arguments:{PLAYEROPTION:{type:i.STRING,menu:"playerOptions",defaultValue:""},NAME:{type:i.STRING,defaultValue:"AudioSource1"},AUDIOGROUP:{type:i.STRING,menu:"audioGroup",defaultValue:""}}},"---",{opcode:"audioSourceSetLoop",text:"set audio source [NAME] in [AUDIOGROUP] to [LOOP]",blockType:n.COMMAND,arguments:{NAME:{type:i.STRING,defaultValue:"AudioSource1"},AUDIOGROUP:{type:i.STRING,menu:"audioGroup",defaultValue:""},LOOP:{type:i.STRING,menu:"loop",defaultValue:"loop"}}},{opcode:"audioSourceSetTime2",text:"set audio source [NAME] [TIMEPOS] position in [AUDIOGROUP] to [TIME] seconds",blockType:n.COMMAND,arguments:{NAME:{type:i.STRING,defaultValue:"AudioSource1"},TIMEPOS:{type:i.STRING,menu:"timePosition"},AUDIOGROUP:{type:i.STRING,menu:"audioGroup",defaultValue:""},TIME:{type:i.NUMBER,defaultValue:.3}}},{opcode:"audioSourceSetVolumeSpeedPitchPan",text:"set audio source [NAME] [VSPP] in [AUDIOGROUP] to [VALUE]%",blockType:n.COMMAND,arguments:{NAME:{type:i.STRING,defaultValue:"AudioSource1"},VSPP:{type:i.STRING,menu:"vspp",defaultValue:""},AUDIOGROUP:{type:i.STRING,menu:"audioGroup",defaultValue:""},VALUE:{type:i.NUMBER,defaultValue:100}}},"---",{opcode:"audioSourceGetModificationsBoolean",text:"audio source [NAME] [OPTION] in [AUDIOGROUP]",blockType:n.BOOLEAN,disableMonitor:!0,arguments:{NAME:{type:i.STRING,defaultValue:"AudioSource1"},OPTION:{type:i.STRING,menu:"audioSourceOptionsBooleans",defaultValue:""},AUDIOGROUP:{type:i.STRING,menu:"audioGroup",defaultValue:""}}},{opcode:"audioSourceGetModificationsNormal",text:"audio source [NAME] [OPTION] in [AUDIOGROUP]",blockType:n.REPORTER,disableMonitor:!0,arguments:{NAME:{type:i.STRING,defaultValue:"AudioSource1"},OPTION:{type:i.STRING,menu:"audioSourceOptions",defaultValue:""},AUDIOGROUP:{type:i.STRING,menu:"audioGroup",defaultValue:""}}},{opcode:"audioSourceSetTime",text:"set audio source [NAME] start position in [AUDIOGROUP] to [TIME] seconds",blockType:n.COMMAND,arguments:{NAME:{type:i.STRING,defaultValue:"AudioSource1"},AUDIOGROUP:{type:i.STRING,menu:"audioGroup",defaultValue:""},TIME:{type:i.NUMBER,defaultValue:.3}},hideFromPalette:!0}],menus:{audioGroup:"fetchAudioGroupMenu",sounds:"fetchScratchSoundMenu",vspp:{acceptReporters:!0,items:[{text:"volume",value:"volume"},{text:"speed",value:"speed"},{text:"detune",value:"pitch"},{text:"pan",value:"pan"}]},playerOptions:{acceptReporters:!0,items:[{text:"play",value:"play"},{text:"pause",value:"pause"},{text:"stop",value:"stop"}]},loop:{acceptReporters:!0,items:[{text:"loop",value:"loop"},{text:"not loop",value:"not loop"}]},timePosition:{acceptReporters:!0,items:[{text:"time",value:"time"},{text:"start",value:"start"},{text:"end",value:"end"},{text:"start loop",value:"start loop"},{text:"end loop",value:"end loop"}]},deleteOptions:{acceptReporters:!0,items:[{text:"delete",value:"delete"},{text:"play",value:"play"},{text:"pause",value:"pause"},{text:"stop",value:"stop"}]},createOptions:{acceptReporters:!0,items:[{text:"create",value:"create"},{text:"delete",value:"delete"}]},audioGroupOptions:{acceptReporters:!0,items:[{text:"volume",value:"volume"},{text:"speed",value:"speed"},{text:"detune",value:"pitch"},{text:"pan",value:"pan"}]},audioSourceOptionsBooleans:{acceptReporters:!0,items:[{text:"playing",value:"playing"},{text:"paused",value:"paused"},{text:"looping",value:"looping"}]},audioSourceOptions:{acceptReporters:!0,items:[{text:"volume",value:"volume"},{text:"speed",value:"speed"},{text:"detune",value:"pitch"},{text:"pan",value:"pan"},{text:"time position",value:"time position"},{text:"output volume",value:"output volume"},{text:"start position",value:"start position"},{text:"end position",value:"end position"},{text:"start loop position",value:"start loop position"},{text:"end loop position",value:"end loop position"},{text:"sound length",value:"sound length"},{text:"origin sound",value:"origin sound"}]}}}}createAudioGroup(){const A=prompt("Set a name for this Audio Group:","audio group "+(o.GetAllAudioGroups().length+1));return A?o.GetAudioGroup(A)?alert('"'.concat(A,'" is taken!')):(o.AddAudioGroup(A),vm.emitWorkspaceUpdate(),void this.serialize()):alert("Canceled")}deleteAudioGroup(){const A=prompt("Which audio group would you like to delete?");o.DeleteAudioGroup(A),vm.emitWorkspaceUpdate(),this.serialize()}fetchAudioGroupMenu(){const A=o.GetAllAudioGroups();return A.length<=0?[{text:"",value:""}]:A.map(A=>({text:A.id,value:A.id}))}fetchScratchSoundMenu(){const A=vm.editingTarget.sprite.sounds;return A.length<=0?[{text:"",value:""}]:A.map(A=>({text:A.name,value:A.name}))}audioGroupGet(A){const e=o.GetAudioGroup(A.AUDIOGROUP);return JSON.stringify(Object.getOwnPropertyNames(e.sources))}audioGroupSetVolumeSpeedPitchPan(A){const e=o.GetAudioGroup(A.AUDIOGROUP);switch(A.VSPP){case"volume":e.globalVolume=o.Clamp(r.toNumber(A.VALUE)/100,0,1);break;case"speed":e.globalSpeed=o.Clamp(r.toNumber(A.VALUE)/100,0,1/0);break;case"detune":case"pitch":e.globalPitch=r.toNumber(A.VALUE);break;case"pan":e.globalPan=o.Clamp(r.toNumber(A.VALUE),-100,100)/100}o.UpdateAudioGroupSources(e)}audioSourceCreate(A){const e=o.GetAudioGroup(A.AUDIOGROUP);switch(A.CREATEOPTION){case"create":o.RemoveAudioSource(e,A.NAME),o.AppendAudioSource(e,A.NAME);break;case"delete":o.RemoveAudioSource(e,A.NAME)}}audioSourceDuplicate(A){const e=o.GetAudioGroup(A.AUDIOGROUP),t=r.toString(A.NAME),n=r.toString(A.COPY);if(!e)return;const i=o.GrabAudioSource(e,t);i&&(o.RemoveAudioSource(e,n),e.sources[n]=i.clone())}audioSourceReverse(A){const e=o.GetAudioGroup(A.AUDIOGROUP),t=r.toString(A.NAME);if(!e)return;const n=o.GrabAudioSource(e,t);n&&n.reverse()}audioSourceDeleteAll(A){const e=o.GetAudioGroup(A.AUDIOGROUP);for(const t in e.sources)switch(A.DELETEOPTION){case"delete":o.RemoveAudioSource(e,t);break;case"play":e.sources[t].play();break;case"pause":e.sources[t].pause();break;case"stop":e.sources[t].stop()}}audioSourceSetScratch(A,e){return new Promise((t,n)=>{const i=o.GetAudioGroup(A.AUDIOGROUP);if(!i)return t();const r=o.GrabAudioSource(i,A.NAME);if(!r)return t();const s=o.FindSoundByName(e.target.sprite.sounds,A.SOUND);if(!s)return t();let a=!0;try{e.target.sprite.soundBank.getSoundPlayer(s.soundId).buffer}catch(A){a=!1}if(!a)return t();const B=e.target.sprite.soundBank.getSoundPlayer(s.soundId).buffer;r.duration=B.duration,r.src=B,r.originAudioName="".concat(A.SOUND),t()})}audioSourceSetUrl(A,e){return new Promise((t,n)=>{const i=o.GetAudioGroup(A.AUDIOGROUP);if(!i)return t();const r=o.GrabAudioSource(i,A.NAME);if(!r)return t();fetch(A.URL).then(e=>e.arrayBuffer().then(e=>{o.audioContext.decodeAudioData(e,e=>{r.duration=e.duration,r.src=e,r.originAudioName="".concat(A.URL),t()},t)}).catch(t)).catch(n=>{const i=o.FindSoundByName(e.target.sprite.sounds,A.URL);if(i){let n=!0;try{e.target.sprite.soundBank.getSoundPlayer(i.soundId).buffer}catch(A){n=!1}if(!n)return t();const o=e.target.sprite.soundBank.getSoundPlayer(i.soundId).buffer;return r.duration=o.duration,r.src=o,r.originAudioName="".concat(A.URL),t()}return console.warn(n),t()})})}audioSourcePlayerOption(A){const e=o.GetAudioGroup(A.AUDIOGROUP);if(!e)return;const t=o.GrabAudioSource(e,A.NAME);t&&["play","pause","stop"].includes(A.PLAYEROPTION)&&t[A.PLAYEROPTION]()}audioSourceSetLoop(A){const e=o.GetAudioGroup(A.AUDIOGROUP);if(!e)return;const t=o.GrabAudioSource(e,A.NAME);t&&["loop","not loop"].includes(A.LOOP)&&(t.looping="loop"==A.LOOP)}audioSourceSetTime(A){const e=o.GetAudioGroup(A.AUDIOGROUP);if(!e)return;const t=o.GrabAudioSource(e,A.NAME);t&&(t.startPosition=r.toNumber(A.TIME))}audioSourceSetTime2(A){const e=o.GetAudioGroup(A.AUDIOGROUP);if(!e)return;const t=o.GrabAudioSource(e,A.NAME);if(t)switch(A.TIMEPOS){case"start":t.startPosition=r.toNumber(A.TIME);break;case"end":t.endPosition=r.toNumber(A.TIME);break;case"start loop":t.loopStartPosition=r.toNumber(A.TIME);break;case"end loop":t.loopEndPosition=r.toNumber(A.TIME);break;case"time":t.setTimePosition(r.toNumber(A.TIME))}}audioSourceSetVolumeSpeedPitchPan(A){const e=o.GetAudioGroup(A.AUDIOGROUP);if(!e)return;const t=o.GrabAudioSource(e,A.NAME);if(t){switch(A.VSPP){case"volume":t.volume=o.Clamp(r.toNumber(A.VALUE)/100,0,1);break;case"speed":t.speed=o.Clamp(r.toNumber(A.VALUE)/100,0,1/0);break;case"detune":case"pitch":t.pitch=r.toNumber(A.VALUE);break;case"pan":t.pan=o.Clamp(r.toNumber(A.VALUE),-100,100)/100}o.UpdateAudioGroupSources(e)}}audioGroupGetModifications(A){const e=o.GetAudioGroup(A.AUDIOGROUP);switch(A.OPTION){case"volume":return 100*e.globalVolume;case"speed":return 100*e.globalSpeed;case"detune":case"pitch":return e.globalPitch;case"pan":return 100*e.globalPan;default:return 0}}audioSourceGetModificationsBoolean(A){const e=o.GetAudioGroup(A.AUDIOGROUP);if(!e)return!1;const t=o.GrabAudioSource(e,A.NAME);if(!t)return!1;switch(A.OPTION){case"playing":return!t.paused&&!t.notPlaying;case"paused":return t.paused;case"looping":return t.looping;default:return!1}}audioSourceGetModificationsNormal(A){const e=o.GetAudioGroup(A.AUDIOGROUP);if(!e)return"";const t=o.GrabAudioSource(e,A.NAME);if(!t)return"";switch(A.OPTION){case"volume":return 100*t.volume;case"speed":return 100*t.speed;case"detune":case"pitch":return t.pitch;case"pan":return 100*t.pan;case"start position":return t.startPosition;case"end position":return t.endPosition;case"start loop position":return t.loopStartPosition;case"end loop position":return t.loopEndPosition;case"time position":return t.getTimePosition();case"sound length":return t.duration;case"origin sound":return t.originAudioName;case"output volume":return 100*t.getVolume();case"dominant frequency":return t.getFrequency();default:return""}}}},function(A,e,t){t(2);const n=t(280);function i(A,e,t){return Math.min(Math.max(A,e),t)}class r{constructor(A,e,t,i,r,o){var s,a,B,c,g,E,Q,u,l;null==t&&(t=""),null==i&&(i={}),this.runtime=o,this.src=t,this.duration=t.duration,this.originAudioName="",this.volume=null!==(s=i.volume)&&void 0!==s?s:1,this.speed=null!==(a=i.speed)&&void 0!==a?a:1,this.pitch=null!==(B=i.pitch)&&void 0!==B?B:0,this.pan=null!==(c=i.pan)&&void 0!==c?c:0,this.looping=null!==(g=i.looping)&&void 0!==g&&g,this.startPosition=null!==(E=i.startPosition)&&void 0!==E?E:0,this.endPosition=null!==(Q=i.endPosition)&&void 0!==Q?Q:1/0,this.loopStartPosition=null!==(u=i.loopStartPosition)&&void 0!==u?u:0,this.loopEndPosition=null!==(l=i.loopEndPosition)&&void 0!==l?l:1/0,this.resumeSpot=0,this.paused=!1,this.notPlaying=!0,this.parent=r,this._audioNode=null,this._audioContext=A,this._audioGroup=e,this._audioPanner=this._audioContext.createPanner(),this._audioGainNode=this._audioContext.createGain(),this._audioAnalyzerNode=this._audioContext.createAnalyser(),this._audioPanner.panningModel="equalpower",this._audioGainNode.gain.value=1,this._audioGainNode.connect(this._audioPanner),this._audioPanner.connect(this._audioAnalyzerNode),this._audioAnalyzerNode.connect(r.audioGlobalVolumeNode),this._originalConfig=i,this._playingSrc=null,this._timer=new n(o,A),this._disposed=!1}play(A){if(!this.src)throw"Cannot play an empty audio source";try{this._audioNode&&(this._audioNode.onended=null,this._audioNode.stop())}catch(A){}finally{this._audioNode=null}const e=this._audioContext.createBufferSource();this._audioNode=e,this.update(),e.buffer=this.src,e.connect(this._audioGainNode),this._playingSrc=e.buffer,this.paused?(this.resumeSpot=this.getTimePosition(),this._timer.start()):(this._timer.reset(),this._timer.setTime(1e3*i(null!=A?A:this.startPosition,0,this.duration)),this._timer.start());let t=this.resumeSpot,n=this.endPosition;this.paused?this.paused=!1:t=null!=A?A:this.startPosition,this.looping&&(n=this.loopEndPosition),this.notPlaying=!1;const r=i(n-t,0,this.duration);r<1/this.src.sampleRate?this._onNodeStop(!0):(e.start(0,i(t,0,this.duration),r),e.onended=()=>{this._onNodeStop()})}stop(){this.notPlaying=!0,this.paused=!1,this._timer.stop();try{this._audioNode&&this._audioNode.stop()}catch(A){}finally{this._audioNode=null}}pause(){this._audioNode&&(this.paused=!0,this.notPlaying=!0,this._timer.pause(),this._audioNode.onended=null,this._audioNode.stop(),this._audioNode=null)}update(){if(!this._audioNode)return;const A=this._audioNode,e=this._audioGroup,t=this._audioGainNode,n=this._audioPanner;A.playbackRate.value=this.speed*Math.pow(2,this.pitch/1200),t.gain.value=this.volume,A.playbackRate.value*=e.globalSpeed*Math.pow(2,e.globalPitch/1200),t.gain.value*=e.globalVolume,this._timer.speed=A.playbackRate.value;const r=i(this.pan+e.globalPan,-1,1);n.positionX.value=r,n.positionY.value=0,n.positionZ.value=1-Math.abs(r)}dispose(){this._disposed=!0,this._timer.dispose(),this.stop()}clone(){return new r(this._audioContext,this._audioGroup,this.src,this._originalConfig,this.parent,this.runtime)}reverse(){if(!this.src)throw"Cannot reverse an empty audio source";const A=this.src,e=this._audioContext.createBuffer(A.numberOfChannels,A.length,A.sampleRate);for(let t=0;t<A.numberOfChannels;t++){const n=A.getChannelData(t),i=e.getChannelData(t);for(let e=0;e<A.length;e++)i[e]=n[A.length-1-e]}this.src=e}setTimePosition(A){if(!this._audioNode&&!this.paused)return;A=i(A,0,this._getActiveSource().duration),this.paused?this._timer.setTime(1e3*A):(this._timer.setTime(1e3*A),this.play(A))}getVolume(){const A=this._audioAnalyzerNode,e=A.frequencyBinCount,t=new Uint8Array(e);A.getByteTimeDomainData(t);let n=0;for(let A=0;A<e;A++){const e=t[A]/128-1;n+=e*e}return Math.sqrt(n/e)}getFrequency(){const A=this._audioAnalyzerNode,e=this._getActiveSource(),t=A.frequencyBinCount,n=new Uint8Array(t);A.getByteFrequencyData(n);let i=0;for(let A=1;A<t;A++)n[A]>n[i]&&(i=A);return i*(e.sampleRate/2)/t}getTimePosition(){const A=this._getActiveSource();return i(this._timer.getTime(!0),0,A.duration)}_getActiveSource(){return this._audioNode?this._playingSrc:this.src}_onNodeStop(A){!this.paused&&this._audioNode&&(A||!this.looping||this.notPlaying?(this._audioNode.onended=null,this.notPlaying=!0,this._audioNode=null,this._timer.stop()):this.play(this.loopStartPosition||0))}}A.exports.Helper=class{constructor(A){this.runtime=A,this.audioGroups={},this.audioContext=new AudioContext,this.audioGlobalVolumeNode=this.audioContext.createGain(),this.audioGlobalVolumeNode.gain.value=1,this.audioGlobalVolumeNode.connect(this.audioContext.destination)}AddAudioGroup(A,e,t){return null==e&&(e={}),this.audioGroups[A]={id:A,sources:null==t?{}:t,globalVolume:null==e.globalVolume?1:e.globalVolume,globalSpeed:null==e.globalSpeed?1:e.globalSpeed,globalPitch:null==e.globalPitch?0:e.globalPitch,globalPan:null==e.globalPan?0:e.globalPan},this.audioGroups[A]}DeleteAudioGroup(A){const e=this.audioGroups[A];e&&(this.DisposeAudioGroupSources(e),delete this.audioGroups[A])}GetAudioGroup(A){return this.audioGroups[A]}GetAllAudioGroups(){return Object.values(this.audioGroups)}UpdateAudioGroupSources(A){const e=this.GrabAllGrabAudioSources(A);for(let A=0;A<e.length;A++){e[A].update()}}DisposeAudioGroupSources(A){const e=this.GrabAllGrabAudioSources(A);for(let A=0;A<e.length;A++){e[A].dispose()}}AppendAudioSource(A,e,t,n){const i="string"==typeof A?this.GetAudioGroup(A):A;if(i)return i.sources[e]=new r(this.audioContext,i,t,n,this,this.runtime),i.sources[e]}RemoveAudioSource(A,e){const t="string"==typeof A?this.GetAudioGroup(A):A;if(!t)return;const n=t.sources[e];n&&(n.dispose(),delete t.sources[e])}GrabAudioSource(A,e){const t="string"==typeof A?this.GetAudioGroup(A):A;if(t)return t.sources[e]}GrabAllGrabAudioSources(A){const e="string"==typeof A?this.GetAudioGroup(A):A;return e?Object.values(e.sources):[]}FindSoundBySoundId(A,e){for(let t=0;t<A.length;t++){const n=A[t];if(n.soundId==e)return n}return null}FindSoundByName(A,e){for(let t=0;t<A.length;t++){const n=A[t];if(n.name==e)return n}return null}Clamp(A,e,t){return Math.min(Math.max(A,e),t)}},A.exports.AudioSource=r},function(A,e){A.exports=class{constructor(A,e){this.runtime=A,this.audioContext=e,this._disposed=!1,this.paused=!1,this.stopped=!0,this._value=0,this.speed=1,this._lastUpdateReal=Date.now(),this._lastUpdateProcessed=Date.now(),this._boundFunc=this.update.bind(this),this.runtime.on("RUNTIME_STEP_START",this._boundFunc)}start(){this.paused=!1,this.stopped=!1}pause(){this.paused=!0}stop(){this.paused=!1,this.stopped=!0}reset(){this._value=0,this.paused=!1,this.stopped=!0}update(){this.stopped||this.paused||this._disposed||"running"!==this.audioContext.state?this._lastUpdateReal=Date.now():(this._value+=(Date.now()-this._lastUpdateReal)*this.speed,this._lastUpdateReal=Date.now(),this._lastUpdateProcessed=Date.now())}dispose(){this._disposed||(this._disposed=!0,this.runtime.off("RUNTIME_STEP_START",this._boundFunc))}getTime(A){const e=A?1e3:1;return this._value/e}setTime(A){this._lastUpdateReal=Date.now(),this._lastUpdateProcessed=Date.now(),this._value=A}}},function(A,e,t){},function(A,e){A.exports={authenticate:(A,e)=>{if(!A.keepAllowingAuthBlock){if(A.disableConfirmationShown)return"The user has declined the ability to authenticate.";if(!!0)return A.disableConfirmationShown=!0,"The user has declined the ability to authenticate."}return new Promise(t=>{const n=encodeURIComponent(String(e.NAME).substring(0,256).replace(/[^a-zA-Z0-9 _-]+/gim,"_")),i="".concat(window.location.origin,"/wait.html"),r=window.open("https://auth.itinerary.eu.org/auth/?redirect=".concat(btoa(i),"&name=").concat(n.length>0?n:"PenguinMod"),"Scratch Authentication","scrollbars=yes,resizable=yes,status=no,location=yes,toolbar=no,menubar=no,width=768,height=512,left=200,top=200");r||t("Authentication failed to appear.");let o=!1,s=!1,a=null;a=setInterval(()=>{if(null!=r&&r.closed&&!s){A.keepAllowingAuthBlock=!1,clearInterval(a);try{r.close()}catch(A){}t("")}try{const A=r.location.search;if(!o)return;const e=new URLSearchParams(A).get("privateCode");e||(s=!0,clearInterval(a),r.close(),t("")),clearInterval(a),fetch("https://pm-bapi.vercel.app/api/verifyToken?privateCode=".concat(e)).then(A=>A.json().then(A=>{s=!0,r.close(),1!=A.valid&&t(""),t(String(A.username))}).catch(()=>{s=!0,r.close(),t("")})).catch(()=>{s=!0,r.close(),t("")})}catch(A){o=!0}},10)})}}},function(A,e,t){"use strict";t.r(e),e.default=""},function(A,e,t){},function(A,e){function t(A,e,t){return(e=function(A){var e=function(A,e){if("object"!=typeof A||!A)return A;var t=A[Symbol.toPrimitive];if(void 0!==t){var n=t.call(A,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(A)}(A,"string");return"symbol"==typeof e?e:e+""}(e))in A?Object.defineProperty(A,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):A[e]=t,A}class n{static get skipPermissionRequest(){return!!vm&&(!!vm.runtime&&!0===vm.runtime.isProjectPermissionManagerDisabled)}static GenerateCode(A){return Array.from(new Array(A).keys()).map(()=>Math.round(9*Math.random())).join("")}static EditPromptForAcceptCheck(A){return String(A).replace(/ /gim,"").toLowerCase()}static RequestPermission(A){if(!0===n.skipPermissionRequest)return!0;if(n.disabledPermissions.includes(A))return!1;for(var e=arguments.length,t=new Array(e>1?e-1:0),i=1;i<e;i++)t[i-1]=arguments[i];if("limitedWebsite"==A){if(t.length<1)throw new Error("No URL specified what are you trying to get permission for bro");if(!n.IsUrlSafe(t[0]))return!1}if("limitedWebsite"==A&&1==n.permissions.limitedWebsites[t[0]])return!0;if(n.permissions[A])return!0;let r="Allow this project to ".concat(n.permissionMessages[A],"?");for(let A=0;A<t.length;A++){const e=t[A];r=r.replace("$".concat(A),n.IsDataUrl(e)?"custom website":String(e))}r+="\n\nThis will allow the project to:\n",n.permissionDrawbacks[A].forEach(A=>{r+=" ".concat(A,"\n")});let o="ok";n.requiresCode.includes(A)&&(o=n.GenerateCode(6)),r+='\nType "'.concat(o,'" to allow, or type "stop" to never ask for this permission again.');const s=n.EditPromptForAcceptCheck(prompt(r,""));if("stop"==s)return n.disabledPermissions.push(A),!1;const a=s===String(o);return"limitedWebsite"==A?!!a&&(n.permissions.limitedWebsites[t[0]]=!0,!0):(n.permissions[A]=a,a)}static RequestAllPermissions(){if(!0===n.skipPermissionRequest)return!0;if(n.disabledPermissions.includes("all"))return!1;const A=[];Object.getOwnPropertyNames(n.permissions).forEach(e=>{"boolean"==typeof n.permissions[e]&&A.push(e)});let e="Give all permissions to this project?";e+="\n\nThis will allow the project to:\n",A.forEach(A=>{n.permissionDrawbacks[A].forEach(A=>{e+=" ".concat(A,"\n")})});const t=n.GenerateCode(8);e+='\nType "'.concat(t,'" to allow, or type "stop" to never ask for all permissions again.');const i=n.EditPromptForAcceptCheck(prompt(e,""));if("stop"==i)return n.disabledPermissions.push("all"),!1;return i===String(t)&&(Object.getOwnPropertyNames(n.permissions).forEach(A=>{"boolean"==typeof n.permissions[A]&&(n.permissions[A]=!0)}),!0)}static CanCreateURLObject(A){let e=!0;try{new URL(A)}catch(A){e=!1}return e}static IsDataUrl(A){if(!this.CanCreateURLObject(A))return!1;return"data:"===new URL(A).protocol}static IsUrlSafe(A){if(!this.CanCreateURLObject(A))return!1;if(n.IsDataUrl(A))return!0;const e=new URL(A).origin.toLowerCase();let t=!0;return(e.includes("xxx")||e.includes("adult")||e.includes(atob("c2V4"))||e.includes(atob("cG9ybg=="))||e.includes(atob("Ym9vcnU="))||e.includes(atob("aGVudGFp")))&&(t=!1),t}}t(n,"permissions",{javascript:!0,camera:!0,allWebsites:!0,cameraPictures:!1,scratchSignIn:!0,limitedWebsites:{}}),t(n,"permissionMessages",{javascript:"use custom code in JavaScript",camera:"turn on your camera",allWebsites:"display all websites",cameraPictures:"take screenshots while your camera is on",scratchSignIn:"sign in with Scratch",limitedWebsite:"display $0"}),t(n,"permissionDrawbacks",{javascript:[],camera:[],allWebsites:[],cameraPictures:["take a screenshot while your camera is visible"],scratchSignIn:[],limitedWebsite:[]}),t(n,"requiresCode",[]),t(n,"disabledPermissions",[]),A.exports=n},function(A,e,t){},function(A,e,t){},function(A,e,t){},function(A,e,t){},function(A,e,t){},function(A,e,t){"use strict";t.r(e),e.default=""},function(A,e,t){},function(A,e,t){},function(A,e,t){const n=t(2),i=t(7),r=t(295),o=t(0),s=t(52),{ConvexGeometry:a}=t(501),{OBJLoader:B}=t(305),{GLTFLoader:c}=t(306),{FBXLoader:g}=t(500),E=t(8),Q={OBJ:new B,GLTF:new c,FBX:new g};function u(A){return A*(Math.PI/180)}function l(A){const e=Math.sqrt(A.x*A.x+A.y*A.y+A.z*A.z);return new o.Vector3(A.x/e,A.y/e,A.z/e)}function w(A){const e=function(A){return A*(180/Math.PI)}(A);if(!String(e).includes("."))return e;const t=String(e).split("."),n=t[1].substring(0,3);return"999"===n&&"9"===t[1].charAt(3)?Number(t[0])+1:Number(t[0]+"."+n)}A.exports=class{constructor(A){this.runtime=A,this.three=o,this.BufferGeometryUtils=s,this.ConvexGeometry=a,this.OBJLoader=B,this.GLTFLoader=c,this.FBXLoader=g,this.runtime.prism_screenshot_checkForExternalCanvas=!0,this.runtime.prism_screenshot_externalCanvas=null,this.scene=null,this.camera=null,this.renderer=null,this.existingSceneObjects=[],this.existingSceneLights=[],this.lastStageSizeWhenRendering={width:0,height:0},this.savedMeshes={},this.sceneLayer="front",this.lastStageColor=[255,255,255,0],this.runtime.on("PROJECT_STOP_ALL",()=>{this.dispose(),this.sceneLayer="front",this.updateScratchCanvasRelayering()})}dispose(){this.existingSceneObjects=[],this.existingSceneLights=[],this.scene&&(this.scene.remove(),this.scene=null),this.camera&&(this.camera.remove(),this.camera=null),this.renderer&&(this.renderer.domElement&&this.renderer.domElement.remove(),this.renderer.dispose(),this.renderer=null,this.runtime.prism_screenshot_externalCanvas=null)}stackWarning(A,e){if(!A)return;if(!A.thread)return;if(!A.thread.stackClick)return;const t=A.thread.blockGlowInFrame;this.runtime.visualReport(t,e)}getInfo(){return r}getScratchCanvas(){return this.runtime.renderer.canvas}restyleExternalCanvas(A){A.style.position="absolute",A.style.width="100%",A.style.height="100%",A.style.pointerEvents="none"}appendElementAboveScratchCanvas(A){A.style.zIndex=450,"back"===this.sceneLayer&&(A.style.zIndex=0),this.getScratchCanvas().parentElement.prepend(A)}updateScratchCanvasRelayering(){const A=this.getScratchCanvas();A.style.backgroundColor="transparent",A.style.position="relative",n.toNumber(A.style.zIndex)<1&&(A.style.zIndex=1);let e=this.runtime.renderer._backgroundColor4f[3];"front"===this.sceneLayer&&this.runtime.renderer.setBackgroundColor(this.lastStageColor[0],this.lastStageColor[1],this.lastStageColor[2],1),"back"===this.sceneLayer&&(this.runtime.renderer._backgroundColor4f[0]===this.lastStageColor[0]&&this.runtime.renderer._backgroundColor4f[1]===this.lastStageColor[1]&&this.runtime.renderer._backgroundColor4f[2]===this.lastStageColor[2]||(console.log("updated stage color"),this.lastStageColor=this.runtime.renderer._backgroundColor4f),this.runtime.renderer.setBackgroundColor(0,0,0,0)),e!==this.runtime.renderer._backgroundColor4f[3]&&(this.runtime.renderer.dirty=!0)}needsToResizeCanvas(){return{width:this.runtime.stageWidth,height:this.runtime.stageHeight}!==this.lastStageSizeWhenRendering}mergeVertices(A){const e=A.attributes.position.array,t={},n=[],i=[];let r=0;for(let A=0;A<e.length;A+=3){const o=e[A],s=e[A+1],a=e[A+2],B="".concat(o,",").concat(s,",").concat(a);void 0===t[B]?(t[B]=r,n.push(o,s,a),i.push(r),r++):i.push(t[B])}return A.setAttribute("position",new o.Float32BufferAttribute(n,3)),A.setIndex(new o.Uint32BufferAttribute(i,1)),A}performRaycast(A,e){const t=e.geometry,n=this.mergeVertices(t),i=(new o.BufferGeometry).copy(n);i.computeBoundingBox(),i.boundingBox.applyMatrix4(e.matrixWorld);return A.intersectObject(e,!0).length>0}initialize(){this.dispose(),this.scene=new o.Scene,this.renderer=new o.WebGLRenderer({preserveDrawingBuffer:!0,alpha:!0}),this.renderer.penguinMod={backgroundColor:0,backgroundOpacity:1},this.renderer.setClearColor(0,1);const A=this.renderer.domElement;this.runtime.prism_screenshot_externalCanvas=A,this.restyleExternalCanvas(A),this.appendElementAboveScratchCanvas(A),this.updateScratchCanvasRelayering()}render(){if(this.renderer&&this.scene&&this.camera)return this.needsToResizeCanvas()&&(this.lastStageSizeWhenRendering={width:this.runtime.stageWidth,height:this.runtime.stageHeight},this.renderer.setSize(2*this.lastStageSizeWhenRendering.width,2*this.lastStageSizeWhenRendering.height),this.restyleExternalCanvas(this.renderer.domElement)),this.appendElementAboveScratchCanvas(this.renderer.domElement),this.updateScratchCanvasRelayering(),new Promise(A=>{requestAnimationFrame(()=>{this.renderer&&A(this.renderer.render(this.scene,this.camera))})})}setCameraPerspective2(A){this.camera&&(this.camera.remove(),this.camera=null);const e=n.toNumber(A.FOV),t=n.toNumber(A.AR),i=n.toNumber(A.NEAR),r=n.toNumber(A.FAR);this.camera=new o.PerspectiveCamera(e,t,i,r)}setCameraPerspective1(A){return this.setCameraPerspective2({FOV:A.FOV,AR:A.AR,NEAR:.1,FAR:1e3})}setCameraPerspective0(A){const e=this.runtime.stageWidth/this.runtime.stageHeight;return this.setCameraPerspective2({FOV:A.FOV,AR:e,NEAR:.1,FAR:1e3})}setCameraPosition(A){if(!this.camera)return;const e={x:n.toNumber(A.X),y:n.toNumber(A.Y),z:n.toNumber(A.Z)};this.camera.position.set(e.x,e.y,e.z)}setCameraRotation(A){if(!this.camera)return;const e={x:n.toNumber(A.X),y:n.toNumber(A.Y),z:n.toNumber(A.Z)},t=new o.Euler(0,0,0);this.camera.setRotationFromEuler(t),this.camera.rotateY(u(e.y)),this.camera.rotateX(u(e.x)),this.camera.rotateZ(u(e.z))}getCameraPosition(A){if(!this.camera)return"";const e=A.VECTOR3;return e&&["x","y","z"].includes(e)?n.toNumber(this.camera.position[e]):""}getCameraRotation(A){if(!this.camera)return"";const e=A.VECTOR3;if(!e)return"";if(!["x","y","z"].includes(e))return"";return w(n.toNumber(this.camera.rotation[e]))}setSceneLayer(A){if(!this.renderer)return;let e=this.sceneLayer;this.sceneLayer="front","back"===n.toString(A.SIDE)&&(this.sceneLayer="back"),this.sceneLayer!==e&&(this.lastStageColor=this.runtime.renderer._backgroundColor4f),this.appendElementAboveScratchCanvas(this.renderer.domElement),this.updateScratchCanvasRelayering()}setSceneBackgroundColor(A){if(!this.renderer)return;const e=n.toRgbColorObject(A.COLOR),t=E.rgbToDecimal(e);this.renderer.penguinMod.backgroundColor=t,this.renderer.setClearColor(t,this.renderer.penguinMod.backgroundOpacity)}setSceneBackgroundOpacity(A){if(!this.renderer)return;let e=n.toNumber(A.OPACITY);e>100&&(e=100),e<0&&(e=0);const t=1-e/100;this.renderer.penguinMod.backgroundOpacity=t,this.renderer.setClearColor(this.renderer.penguinMod.backgroundColor,t)}show3d(){this.renderer.domElement.style.display=""}hide3d(){this.renderer.domElement.style.display="none"}is3dVisible(){return""===this.renderer.domElement.style.display||"absolute"===this.renderer.domElement.style.display}getCameraZoom(){return this.camera?100*n.toNumber(this.camera.zoom):""}setCameraZoom(A){this.camera&&(this.camera.zoom=n.toNumber(A.ZOOM)/100,this.camera.updateProjectionMatrix())}getCameraClipPlane(A){if(!this.camera)return"";const e=A.CLIPPLANE;return["near","far"].includes(e)?this.camera[e]:""}getCameraAspectRatio(){return this.camera?n.toNumber(this.camera.aspect):""}getCameraFov(){return this.camera?n.toNumber(this.camera.fov):""}isCameraPerspective(){return!!this.camera&&n.toBoolean(this.camera.isPerspectiveCamera)}isCameraOrthographic(){return!!this.camera&&n.toBoolean(!this.camera.isPerspectiveCamera)}doesObjectExist(A){if(!this.scene)return!1;const e=n.toString(A.NAME);return!!this.scene.getObjectByName(e)}createGameObject(A,e,t){if(!this.scene)return;const i=n.toString(A.NAME);if(this.scene.getObjectByName(i))return this.stackWarning(e,"An object with this name already exists!");const r={x:n.toNumber(A.X),y:n.toNumber(A.Y),z:n.toNumber(A.Z)};let s;switch(t){case"sphere":{const A=new o.SphereGeometry(1),e=new o.MeshStandardMaterial({color:16777215}),t=new o.Mesh(A,e);s=t;break}case"plane":{const A=new o.PlaneGeometry(1,1),e=new o.MeshStandardMaterial({color:16777215}),t=new o.Mesh(A,e);s=t;break}case"mesh":{const t=n.toString(A.URL);let a="obj";switch(n.toString(A.FILETYPE)){case".glb / .gltf":a="glb";break;case".fbx":a="fbx"}return new Promise(A=>{let n=Q.OBJ;switch(a){case"glb":n=Q.GLTF;break;case"fbx":n=Q.FBX}if(t in this.savedMeshes){const e=this.savedMeshes[t];return s=e.clone(),s.name=i,this.existingSceneObjects.push(i),s.isPenguinMod=!0,s.isMeshObj=!0,s.position.set(r.x,r.y,r.z),this.scene.add(s),void A()}n.load(t,e=>{if(n===Q.GLTF&&(e=e.scene),n===Q.OBJ){const A=new o.MeshStandardMaterial({color:16777215});A.wireframe=!1,this.updateMaterialOfObjObject(e,A),this.savedMeshes[t]=e}e.name=i,console.log(e),this.existingSceneObjects.push(i),e.isPenguinMod=!0,e.isMeshObj=!0,e.position.set(r.x,r.y,r.z),this.scene.add(e),A()},()=>{},t=>{console.warn("Failed to load 3D mesh obj;",t),this.stackWarning(e,"Failed to get the 3D mesh!"),A()})})}case"light":{n.toString(A.LIGHTTYPE);let e;e=new o.PointLight(16777215,1,100),s=e,this.existingSceneLights.push(i);break}default:{const A=new o.BoxGeometry(1,1,1),e=new o.MeshStandardMaterial({color:16777215}),t=new o.Mesh(A,e);s=t;break}}s.name=i,this.existingSceneObjects.push(i),s.isPenguinMod=!0,s.position.set(r.x,r.y,r.z),this.scene.add(s)}createCubeObject(A,e){this.createGameObject(A,e,"cube")}createSphereObject(A,e){this.createGameObject(A,e,"sphere")}createPlaneObject(A,e){this.createGameObject(A,e,"plane")}createMeshObject(A,e){this.createGameObject(A,e,"mesh")}createMeshObjectFileTyped(A,e){this.createGameObject(A,e,"mesh")}createLightObject(A,e){this.createGameObject(A,e,"light")}getMaterialOfObjObject(A){let e;return A.traverse(A=>{A instanceof o.Mesh&&(e=A.material)}),e}updateMaterialOfObjObject(A,e){A.traverse(A=>{A instanceof o.Mesh&&(A.material=e)})}setObjectPosition(A){if(!this.scene)return;const e=n.toString(A.NAME),t={x:n.toNumber(A.X),y:n.toNumber(A.Y),z:n.toNumber(A.Z)},i=this.scene.getObjectByName(e);i&&i.position.set(t.x,t.y,t.z)}setObjectRotation(A){if(!this.scene)return;const e=n.toString(A.NAME),t={x:n.toNumber(A.X),y:n.toNumber(A.Y),z:n.toNumber(A.Z)},i=this.scene.getObjectByName(e);if(!i)return;const r=new o.Euler(0,0,0);i.setRotationFromEuler(r),i.rotateY(u(t.y)),i.rotateX(u(t.x)),i.rotateZ(u(t.z))}setObjectSize(A){if(!this.scene)return;const e=n.toString(A.NAME),t={x:n.toNumber(A.X)/100,y:n.toNumber(A.Y)/100,z:n.toNumber(A.Z)/100},i=this.scene.getObjectByName(e);i&&i.scale.set(t.x,t.y,t.z)}moveObjectUnits(A){if(!this.scene)return;const e=n.toString(A.NAME),t=this.scene.getObjectByName(e);if(!t)return;const i=n.toNumber(A.AMOUNT),r=new o.Vector3;t.getWorldDirection(r),t.position.add(r.multiplyScalar(i))}getObjectPosition(A){if(!this.scene)return"";const e=n.toString(A.NAME),t=this.scene.getObjectByName(e);if(!t)return"";const i=A.VECTOR3;return i&&["x","y","z"].includes(i)?n.toNumber(t.position[i]):""}getObjectRotation(A){if(!this.scene)return"";const e=n.toString(A.NAME),t=this.scene.getObjectByName(e);if(!t)return"";const i=A.VECTOR3;if(!i)return"";if(!["x","y","z"].includes(i))return"";return w(n.toNumber(t.rotation[i]))}getObjectSize(A){if(!this.scene)return"";const e=n.toString(A.NAME),t=this.scene.getObjectByName(e);if(!t)return"";const i=A.VECTOR3;return i&&["x","y","z"].includes(i)?100*n.toNumber(t.scale[i]):""}getObjectColor(A){if(!this.scene)return"";const e=n.toString(A.NAME),t=this.scene.getObjectByName(e);return t?"#"+t.material.color.getHexString():""}deleteObject(A){if(!this.scene)return;const e=n.toString(A.NAME),t=this.scene.getObjectByName(e);if(!t)return;const i=t.isLight;t.clear(),this.scene.remove(t);const r=this.existingSceneObjects.indexOf(e);if(this.existingSceneObjects.splice(r,1),i){const A=this.existingSceneLights.indexOf(e);this.existingSceneLights.splice(A,1)}}setObjectColor(A){if(!this.scene)return;const e=n.toString(A.NAME),t=n.toRgbColorObject(A.COLOR),i=E.rgbToDecimal(t),r=this.scene.getObjectByName(e);if(r)if(r.isLight)r.color.set(i);else{if(r.isMeshObj){const A=this.getMaterialOfObjObject(r);if(!A)return;return A.color.set(i),void this.updateMaterialOfObjObject(r,A)}r.material.color.set(i)}}setObjectShading(A){if(!this.scene)return;const e=n.toString(A.NAME),t="on"===n.toString(A.ONOFF),i=this.scene.getObjectByName(e);if(!i)return;if(i.isLight)return;if(i.isMeshObj){const A=this.getMaterialOfObjObject(i);if(!A)return;const e="#"+A.color.getHexString();let n;return n=t?new o.MeshStandardMaterial({color:e}):new o.MeshBasicMaterial({color:e}),n.color.set(e),void this.updateMaterialOfObjObject(i,n)}const r="#"+i.material.color.getHexString();i.material=t?new o.MeshStandardMaterial({color:r}):new o.MeshBasicMaterial({color:r})}setObjectWireframe(A){if(!this.scene)return;const e=n.toString(A.NAME),t="on"===n.toString(A.ONOFF),i=this.scene.getObjectByName(e);if(i&&!i.isLight){if(i.isMeshObj){const A=this.getMaterialOfObjObject(i);if(!A)return;return A.wireframe=t,void this.updateMaterialOfObjObject(i,A)}i.material.wireframe=t}}existingObjectsArray(A){const e=n.toString(A.OBJECTLIST);if(!["objects","physical objects","lights"].includes(e))return"[]";switch(e){case"objects":return JSON.stringify(this.existingSceneObjects);case"lights":return JSON.stringify(this.existingSceneLights);case"physical objects":{const A=this.existingSceneObjects.filter(A=>!this.existingSceneLights.includes(A));return JSON.stringify(A)}default:return"[]"}}objectTouchingObject(A){if(!this.scene)return!1;const e=n.toString(A.NAME1),t=n.toString(A.NAME2),i=this.scene.getObjectByName(e),r=this.scene.getObjectByName(t);if(!i)return!1;if(!r)return!1;if(i.isLight)return!1;if(r.isLight)return!1;const s=(new o.Box3).setFromObject(i),a=(new o.Box3).setFromObject(r);return s.intersectsBox(a)}pointTowardsObject(A){if(!this.scene)return!1;const e=n.toString(A.NAME1),t=n.toString(A.NAME2),i=this.scene.getObjectByName(e),r=this.scene.getObjectByName(t);return!!i&&(!!r&&void i.lookAt(r.position))}pointTowardsXYZ(A){if(!this.scene)return!1;const e=n.toString(A.NAME),t=this.scene.getObjectByName(e);if(!t)return!1;const i={x:n.toNumber(A.X),y:n.toNumber(A.Y),z:n.toNumber(A.Z)};t.lookAt(i.x,i.y,i.z)}MoveCameraBy(A){if(!this.camera)return;const e=n.toNumber(A.AMOUNT),t=new o.Vector3;this.camera.getWorldDirection(t),this.camera.position.add(t.multiplyScalar(e))}changeCameraPosition(A){this.camera&&(this.camera.position.x+=n.toNumber(A.X),this.camera.position.y+=n.toNumber(A.Y),this.camera.position.z+=n.toNumber(A.Z))}changeCameraRotation(A){this.camera&&(this.camera.rotation.x+=n.toNumber(A.X),this.camera.rotation.y+=n.toNumber(A.Y),this.camera.rotation.z+=n.toNumber(A.Z))}raycastResultToReadable(A){return i.simple(A).map(A=>(console.log(A.object.object.name),A.object.object.name))}rayCollision(A){if(!this.scene)return"";const e=new o.Raycaster,t={x:n.toNumber(A.X),y:n.toNumber(A.Y),z:n.toNumber(A.Z)},i=l({x:u(n.toNumber(A.DX)),y:u(n.toNumber(A.DY)),z:u(n.toNumber(A.DZ))});e.set(new o.Vector3(t.x,t.y,t.z),new o.Vector3(i.x,i.y,i.z));const r=e.intersectObjects(this.scene.children,!0);if(0===r.length)return"";return r[0].object.name}rayCollisionCamera(){if(!this.scene)return"";if(!this.camera)return"";const A=new o.Raycaster;A.setFromCamera(new o.Vector2,this.camera);const e=A.intersectObjects(this.scene.children,!0);if(0===e.length)return"";return e[0].object.name}rayCollisionArray(A){if(!this.scene)return"[]";const e=new o.Raycaster,t={x:n.toNumber(A.X),y:n.toNumber(A.Y),z:n.toNumber(A.Z)},i=l({x:u(n.toNumber(A.DX)),y:u(n.toNumber(A.DY)),z:u(n.toNumber(A.DZ))});e.set(new o.Vector3(t.x,t.y,t.z),new o.Vector3(i.x,i.y,i.z));const r=e.intersectObjects(this.scene.children,!0);return 0===r.length?"[]":JSON.stringify(r)}rayCollisionCameraArray(){if(!this.scene)return"[]";if(!this.camera)return"[]";const A=new o.Raycaster;A.setFromCamera(new o.Vector2,this.camera);const e=A.intersectObjects(this.scene.children,!0);return 0===e.length?"[]":JSON.stringify(e)}rayCollisionDistance(A){if(!this.scene)return"";const e=new o.Vector3(n.toNumber(A.X),n.toNumber(A.Y),n.toNumber(A.Z)),t=l(new o.Vector3(u(n.toNumber(A.DX)),u(n.toNumber(A.DY)),u(n.toNumber(A.DZ)))),i=new o.Raycaster(e,t,0,A.DIS).intersectObjects(this.scene.children,!0);if(0===i.length)return"";return i[0].object.name}rayCollisionArrayDistance(A){if(!this.scene)return"[]";const e=new o.Vector3(n.toNumber(A.X),n.toNumber(A.Y),n.toNumber(A.Z)),t=l(new o.Vector3(u(n.toNumber(A.DX)),u(n.toNumber(A.DY)),u(n.toNumber(A.DZ)))),i=new o.Raycaster(e,t,0,A.DIS).intersectObjects(this.scene.children,!0);if(0===i.length)return"[]";const r=this.raycastResultToReadable(i);return JSON.stringify(r)}getObjectParent(A){if(!this.scene)return"";const e=n.toString(A.NAME),t=this.scene.getObjectByName(e);return t&&t.parent?t.parent.name:""}}},function(A,e,t){const n=t(1),i=t(3),r={Cube:t(296),Sphere:t(297),Plane:t(298),Light:t(299),OBJ:t(300),Camera:t(301),Touching:t(302),Wireframe:t(303),Raycast:t(304)};function o(A){return{acceptReporters:!0,items:A.map(A=>({text:A,value:A}))}}function s(A){return{blockType:n.LABEL,text:A}}function a(A,e,t){switch(typeof A){case"number":return{type:i.NUMBER,defaultValue:A};case"boolean":return{type:i.BOOLEAN,defaultValue:A};case"string":switch(A){case"COLOR":return{type:i.COLOR};case"ANGLE":return{type:i.ANGLE};case"MATRIX":return{type:i.MATRIX};case"NOTE":return{type:i.NOTE,defaultValue:60};case"POLYGON":return{type:i.POLYGON,nodes:e};case"IMAGE":return{type:i.IMAGE,dataURI:e,alt:t};default:return{type:i.STRING,defaultValue:A}}}}function B(A,e){return{type:A,menu:e}}function c(A,e,t,i,r){const o={opcode:A,text:e||A,blockType:n.COMMAND};return t&&(o.arguments=t),i&&(o.blockIconURI=i),!0===r&&(o.hideFromPalette=!0),o}function g(A,e,t,i,r){const o={opcode:A,text:e||A,blockType:n.REPORTER};return"boolean"==typeof r&&(o.disableMonitor=r),t&&(o.arguments=t),i&&(o.blockIconURI=i),o}function E(A,e,t,i){const r={opcode:A,text:e||A,blockType:n.BOOLEAN,disableMonitor:!0};return t&&(r.arguments=t),i&&(r.blockIconURI=i),r}A.exports={id:"jg3d",name:"3D",color1:"#B100FE",color2:"#8600C3",color3:"#5B0088",blockIconURI:"",blocks:[s("Initializing your scene"),c("initialize","create 3D scene"),c("dispose","remove 3D scene"),"---",c("setCameraPerspective0","set scene camera to perspective camera with fov: [FOV]",{FOV:a(70)},r.Camera),c("setCameraPerspective1","set scene camera to perspective camera with fov: [FOV] aspect ratio: [AR]",{FOV:a(70),AR:a(480/360)},r.Camera),c("setCameraPerspective2","set scene camera to perspective camera with fov: [FOV] aspect ratio: [AR] and only render objects within [NEAR] and [FAR] units of the camera",{FOV:a(70),AR:a(480/360),NEAR:a(.1),FAR:a(1e3)},r.Camera),"---",c("setCameraOrthographic0","set scene camera to orthographic camera",null,r.Camera),c("setCameraOrthographic1","set scene camera to orthographic camera with left plane: [LEFT] right plane: [RIGHT] top plane: [TOP] bottom plane: [BOTTOM]",{LEFT:a(-240),RIGHT:a(240),TOP:a(180),BOTTOM:a(-180)},r.Camera),c("setCameraOrthographic2","set scene camera to orthographic camera with left plane: [LEFT] right plane: [RIGHT] top plane: [TOP] bottom plane: [BOTTOM] and only render objects within [NEAR] and [FAR] units of the camera",{LEFT:a(-240),RIGHT:a(240),TOP:a(180),BOTTOM:a(-180),NEAR:a(1),FAR:a(1e3)},r.Camera),"---",c("render"),s("Scene customization"),c("setSceneLayer","move 3D scene layer to [SIDE]",{SIDE:B(i.STRING,"frontBack")}),c("setSceneBackgroundColor","set background color to [COLOR]",{COLOR:a("COLOR")}),c("setSceneBackgroundOpacity","set background transparency to [OPACITY]%",{OPACITY:a(100)}),c("show3d","show 3D scene",{}),c("hide3d","hide 3D scene",{}),E("is3dVisible","is 3D scene visible?",{}),s("Camera controls"),c("MoveCameraBy","move camera by [AMOUNT]",{AMOUNT:a(10)},r.Camera),c("setCameraPosition","set camera position to x: [X] y: [Y] z: [Z]",{X:a(0),Y:a(0),Z:a(0)},r.Camera),c("changeCameraPosition","change camera position by x: [X] y: [Y] z: [Z]",{X:a(0),Y:a(0),Z:a(0)},r.Camera),c("setCameraRotation","set camera rotation to x: [X] y: [Y] z: [Z]",{X:a("ANGLE"),Y:a("ANGLE"),Z:a("ANGLE")},r.Camera),c("changeCameraRotation","change camera rotation by x: [X] y: [Y] z: [Z]",{X:a("ANGLE"),Y:a("ANGLE"),Z:a("ANGLE")},r.Camera),c("setCameraZoom","set camera zoom to [ZOOM]%",{ZOOM:a(100)},r.Camera),g("getCameraClipPlane","camera [CLIPPLANE]",{CLIPPLANE:B(i.STRING,"clippingPlanes")},r.Camera),g("getCameraPosition","camera [VECTOR3] position",{VECTOR3:B(i.STRING,"vector3")},r.Camera),g("getCameraRotation","camera [VECTOR3] rotation",{VECTOR3:B(i.STRING,"vector3")},r.Camera),g("getCameraAspectRatio","camera aspect ratio",null,r.Camera),g("getCameraZoom","camera zoom",null,r.Camera),g("getCameraFov","camera fov",null,r.Camera),"---",E("isCameraPerspective","is scene camera a perspective camera?",null,r.Camera),E("isCameraOrthographic","is scene camera an orthographic camera?",null,r.Camera),s("Objects"),E("doesObjectExist","object named [NAME] exists?",{NAME:a("Object1")}),g("existingObjectsArray","existing [OBJECTLIST]",{OBJECTLIST:B(i.STRING,"objectTypeList")}),"---",c("createCubeObject","create cube named [NAME] at x: [X] y: [Y] z: [Z]",{NAME:a("Object1"),X:a(0),Y:a(0),Z:a(0)},r.Cube),c("createSphereObject","create sphere named [NAME] at x: [X] y: [Y] z: [Z]",{NAME:a("Object1"),X:a(0),Y:a(0),Z:a(0)},r.Sphere),c("createPlaneObject","create plane named [NAME] at x: [X] y: [Y] z: [Z]",{NAME:a("Object1"),X:a(0),Y:a(0),Z:a(0)},r.Plane),c("createMeshObject","create mesh named [NAME] with .obj data: [URL] at x: [X] y: [Y] z: [Z]",{NAME:a("Object1"),URL:a("data:text/plain;base64,"),X:a(0),Y:a(0),Z:a(0)},r.OBJ,!0),c("createMeshObjectFileTyped","create mesh named [NAME] with [FILETYPE] data: [URL] at x: [X] y: [Y] z: [Z]",{NAME:a("Object1"),FILETYPE:B(i.STRING,"meshFileTypes"),URL:a("data:text/plain;base64,"),X:a(0),Y:a(0),Z:a(0)},r.OBJ),c("createLightObject","create [LIGHTTYPE] light named [NAME] at x: [X] y: [Y] z: [Z]",{LIGHTTYPE:B(i.STRING,"lightType"),NAME:a("Light1"),X:a(0),Y:a(0),Z:a(0)},r.Light),"---",c("moveObjectUnits","move object named [NAME] by [AMOUNT]",{NAME:a("Object1"),AMOUNT:a(10)}),c("setObjectPosition","move object named [NAME] to x: [X] y: [Y] z: [Z]",{NAME:a("Object1"),X:a(1),Y:a(1),Z:a(1)}),c("setObjectRotation","set rotation of object named [NAME] to x: [X] y: [Y] z: [Z]",{NAME:a("Object1"),X:a("ANGLE"),Y:a("ANGLE"),Z:a("ANGLE")}),c("setObjectSize","set size of object named [NAME] to x: [X]% y: [Y]% z: [Z]%",{NAME:a("Object1"),X:a(100),Y:a(100),Z:a(100)}),c("pointTowardsObject","point object named [NAME1] towards object named [NAME2]",{NAME1:a("Object1"),NAME2:a("Object2")}),c("pointTowardsXYZ","point object named [NAME] towards x: [X] y: [Y] z: [Z]",{NAME:a("Object1"),X:a(31),Y:a(26),Z:a(47)}),g("getObjectPosition","[VECTOR3] position of object named [NAME]",{VECTOR3:B(i.STRING,"vector3"),NAME:a("Object1")}),g("getObjectRotation","[VECTOR3] rotation of object named [NAME]",{VECTOR3:B(i.STRING,"vector3"),NAME:a("Object1")}),g("getObjectSize","[VECTOR3] size of object named [NAME]",{VECTOR3:B(i.STRING,"vector3"),NAME:a("Object1")}),g("getObjectColor","hex color of object named [NAME]",{NAME:a("Object1")}),g("getObjectParent","parent of object named [NAME]",{NAME:a("Object1")}),"---",E("objectTouchingObject","object [NAME1] touching object [NAME2]?",{NAME1:a("Object1"),NAME2:a("Object2")},r.Touching),"---",c("deleteObject","remove object named [NAME]",{NAME:a("Object1")}),c("setObjectColor","recolor object named [NAME] to [COLOR]",{NAME:a("Object1"),COLOR:a("COLOR")}),c("setObjectShading","turn [ONOFF] shading on object named [NAME]",{ONOFF:B(i.STRING,"onoff"),NAME:a("Object1")}),c("setObjectWireframe","turn [ONOFF] wireframe view on object named [NAME]",{ONOFF:B(i.STRING,"onoff"),NAME:a("Object1")},r.Wireframe),"---",g("rayCollision","first object in raycast from x: [X] y: [Y] z: [Z] with direction x: [DX] y: [DY] z: [DZ]",{X:a(0),Y:a(0),Z:a(0),DX:a(0),DY:a(0),DZ:a(0)},r.Raycast,!0),g("rayCollisionArray","raycast result from x: [X] y: [Y] z: [Z] with direction x: [DX] y: [DY] z: [DZ]",{X:a(0),Y:a(0),Z:a(0),DX:a(0),DY:a(0),DZ:a(0)},r.Raycast,!0),g("rayCollisionDistance","first object in raycast from x: [X] y: [Y] z: [Z] with direction x: [DX] y: [DY] z: [DZ] with a max distance of [DIS]",{X:a(0),Y:a(0),Z:a(0),DX:a(0),DY:a(0),DZ:a(0),DIS:a(10)},r.Raycast,!0),g("rayCollisionArrayDistance","raycast result from x: [X] y: [Y] z: [Z] with direction x: [DX] y: [DY] z: [DZ] with a max distance of [DIS]",{X:a(0),Y:a(0),Z:a(0),DX:a(0),DY:a(0),DZ:a(0),DIS:a(10)},r.Raycast,!0),g("rayCollisionCamera","first object from raycast in camera center",{},r.Raycast,!0),g("rayCollisionCameraArray","raycast result starting from the camera center",{},r.Raycast,!0)],menus:{cameraType:o(["perspective","orthographic"]),lightType:o(["point"]),clippingPlanes:o(["near","far"]),frontBack:o(["front","back"]),vector3:o(["x","y","z"]),vector2:o(["x","y"]),onoff:o(["on","off"]),objectTypeList:o(["objects","physical objects","lights"]),meshFileTypes:o([".obj",".glb / .gltf",".fbx"])}}},function(A,e,t){"use strict";t.r(e),e.default=""},function(A,e,t){"use strict";t.r(e),e.default=""},function(A,e,t){"use strict";t.r(e),e.default=""},function(A,e,t){"use strict";t.r(e),e.default=""},function(A,e,t){"use strict";t.r(e),e.default=""},function(A,e,t){"use strict";t.r(e),e.default=""},function(A,e,t){"use strict";t.r(e),e.default=""},function(A,e,t){"use strict";t.r(e),e.default=""},function(A,e,t){"use strict";t.r(e),e.default=""},function(A,e,t){},function(A,e,t){},function(A,e,t){},function(A,e,t){"use strict";t.r(e),e.default=""},function(A,e,t){"use strict";t.r(e),e.default=""},function(A,e,t){},function(A,e,t){},function(A,e){class t{constructor(A){this.runtime=A,this._div=document.createElement("div"),this.Realign(),this.buttons={}}Realign(){this._div.style="position: absolute;left: 0px;width: 100%;height: 100%;top: 0px;z-index: 1000;",this.runtime.renderer&&this.runtime.renderer.canvas.parentElement.prepend(this._div)}AddToCanvas(A){this._div.append(A),this.Realign()}DisposeAll(){const A=Object.values(this.buttons);[].concat(A).forEach(A=>{A.dispose()}),this.Realign()}}var n,i,r;n=t,i="Button",r=class{constructor(A,e){let{id:t,label:n,shown:i}=e;this.id=t,this.label=n,this._element=document.createElement("button"),this._element.style="position:absolute;left:0%;top:0%",!1===i&&(this._element.style.display="none"),this._element.innerText=n||"Button",A.AddToCanvas(this._element),A.buttons[t]&&(A.buttons[t].dispose(),delete A.buttons[t]),A.buttons[t]=this}show(){this._element.style.display=""}hide(){this._element.style.display="none"}dispose(){this._element.remove()}},(i=function(A){var e=function(A,e){if("object"!=typeof A||!A)return A;var t=A[Symbol.toPrimitive];if(void 0!==t){var n=t.call(A,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(A)}(A,"string");return"symbol"==typeof e?e:e+""}(i))in n?Object.defineProperty(n,i,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[i]=r,A.exports=t},function(A,e,t){"use strict";t.r(e),e.default=""},function(A,e,t){"use strict";t.r(e),e.default=""},function(A,e,t){"use strict";t.r(e),e.default=""},function(A,e,t){"use strict";t.r(e),e.default=""},function(A,e,t){"use strict";t.r(e),e.default=""},function(A,e,t){"use strict";t.r(e),e.default=""},function(A,e,t){"use strict";t.r(e),e.default=""},function(A,e,t){"use strict";t.r(e),e.default=""},function(A,e,t){"use strict";t.r(e),e.default=""},function(A,e,t){"use strict";t.r(e),e.default=""},function(module,exports,__webpack_require__){const BlockType=__webpack_require__(1),ArgumentType=__webpack_require__(3),SandboxRunner=__webpack_require__(28),Cast=__webpack_require__(2);class jgJavascript{constructor(A){this.runtime=A,this.runningEditorUnsandboxed=!1}getInfo(){return{id:"jgJavascript",name:"JavaScript",isDynamic:!0,blocks:[{opcode:"unsandbox",text:"Run Unsandboxed",blockType:BlockType.BUTTON,hideFromPalette:this.runningEditorUnsandboxed},{opcode:"sandbox",text:"Run Sandboxed",blockType:BlockType.BUTTON,hideFromPalette:!this.runningEditorUnsandboxed},{opcode:"javascriptHat",text:"when javascript [CODE] == true",blockType:BlockType.HAT,hideFromPalette:!this.runningEditorUnsandboxed,arguments:{CODE:{type:ArgumentType.STRING,defaultValue:"Math.round(Math.random()) === 1"}}},{opcode:"javascriptStack",text:"javascript [CODE]",blockType:BlockType.COMMAND,arguments:{CODE:{type:ArgumentType.STRING,defaultValue:"alert('Hello!')"}}},{opcode:"javascriptString",text:"javascript [CODE]",blockType:BlockType.REPORTER,disableMonitor:!0,arguments:{CODE:{type:ArgumentType.STRING,defaultValue:"Math.random()"}}},{opcode:"javascriptBool",text:"javascript [CODE]",blockType:BlockType.BOOLEAN,disableMonitor:!0,arguments:{CODE:{type:ArgumentType.STRING,defaultValue:"Math.round(Math.random()) === 1"}}},{blockType:BlockType.LABEL,text:"You can run unsandboxed",hideFromPalette:!this.runningEditorUnsandboxed},{blockType:BlockType.LABEL,text:"when packaging the project.",hideFromPalette:!this.runningEditorUnsandboxed},{blockType:BlockType.LABEL,text:"",hideFromPalette:!this.runningEditorUnsandboxed},{blockType:BlockType.LABEL,text:"Player Options >",hideFromPalette:!this.runningEditorUnsandboxed},{blockType:BlockType.LABEL,text:"Remove sandbox on the JavaScript Ext.",hideFromPalette:!this.runningEditorUnsandboxed}]}}async unsandbox(){await this.runtime.vm.securityManager.canUnsandbox("JavaScript")&&(this.runningEditorUnsandboxed=!0,this.runtime.extensionManager.refreshBlocks("jgJavascript"))}sandbox(){this.runningEditorUnsandboxed=!1,this.runtime.extensionManager.refreshBlocks("jgJavascript")}evaluateCode(code,args,util,realBlockInfo){if(!0===this.runtime.extensionRuntimeOptions.javascriptUnsandboxed||this.runningEditorUnsandboxed){let result;try{result=eval(code)}catch(A){result=A}return result}return new Promise(A=>{SandboxRunner.execute(code).then(e=>A(e.value))})}javascriptStack(A,e,t){const n=Cast.toString(A.CODE);return this.evaluateCode(n,A,e,t)}javascriptString(A,e,t){const n=Cast.toString(A.CODE);return this.evaluateCode(n,A,e,t)}javascriptBool(A,e,t){const n=Cast.toString(A.CODE),i=this.evaluateCode(n,A,e,t);return i&&"function"==typeof i.then?(async()=>{const A=await i;return Boolean(A)})():Boolean(i)}javascriptHat(){if(!this.runtime.extensionRuntimeOptions.javascriptUnsandboxed&&!this.runningEditorUnsandboxed)return!1;const A=this.javascriptBool(...arguments);return(!A||"function"!=typeof A.then)&&A}}module.exports=jgJavascript},function(A,e,t){},function(A,e,t){A.exports=t(326)},function(A,e,t){A.exports={Heap:t(44),Node:t(64),Grid:t(328),Util:t(26),DiagonalMovement:t(12),Heuristic:t(37),AStarFinder:t(65),BestFirstFinder:t(329),BreadthFirstFinder:t(330),DijkstraFinder:t(331),BiAStarFinder:t(66),BiBestFirstFinder:t(332),BiBreadthFirstFinder:t(333),BiDijkstraFinder:t(334),IDAStarFinder:t(335),JumpPointFinder:t(336)}},function(A,e,t){(function(A){(function(){var e,t,n,i,r,o,s,a,B,c,g,E,Q,u,l;n=Math.floor,c=Math.min,t=function(A,e){return A<e?-1:A>e?1:0},B=function(A,e,i,r,o){var s;if(null==i&&(i=0),null==o&&(o=t),i<0)throw new Error("lo must be non-negative");for(null==r&&(r=A.length);i<r;)o(e,A[s=n((i+r)/2)])<0?r=s:i=s+1;return[].splice.apply(A,[i,i-i].concat(e)),e},o=function(A,e,n){return null==n&&(n=t),A.push(e),u(A,0,A.length-1,n)},r=function(A,e){var n,i;return null==e&&(e=t),n=A.pop(),A.length?(i=A[0],A[0]=n,l(A,0,e)):i=n,i},a=function(A,e,n){var i;return null==n&&(n=t),i=A[0],A[0]=e,l(A,0,n),i},s=function(A,e,n){var i;return null==n&&(n=t),A.length&&n(A[0],e)<0&&(e=(i=[A[0],e])[0],A[0]=i[1],l(A,0,n)),e},i=function(A,e){var i,r,o,s,a,B;for(null==e&&(e=t),a=[],r=0,o=(s=function(){B=[];for(var e=0,t=n(A.length/2);0<=t?e<t:e>t;0<=t?e++:e--)B.push(e);return B}.apply(this).reverse()).length;r<o;r++)i=s[r],a.push(l(A,i,e));return a},Q=function(A,e,n){var i;if(null==n&&(n=t),-1!==(i=A.indexOf(e)))return u(A,0,i,n),l(A,i,n)},g=function(A,e,n){var r,o,a,B,c;if(null==n&&(n=t),!(o=A.slice(0,e)).length)return o;for(i(o,n),a=0,B=(c=A.slice(e)).length;a<B;a++)r=c[a],s(o,r,n);return o.sort(n).reverse()},E=function(A,e,n){var o,s,a,g,E,Q,u,l,w;if(null==n&&(n=t),10*e<=A.length){if(!(a=A.slice(0,e).sort(n)).length)return a;for(s=a[a.length-1],g=0,Q=(u=A.slice(e)).length;g<Q;g++)n(o=u[g],s)<0&&(B(a,o,0,null,n),a.pop(),s=a[a.length-1]);return a}for(i(A,n),w=[],E=0,l=c(e,A.length);0<=l?E<l:E>l;0<=l?++E:--E)w.push(r(A,n));return w},u=function(A,e,n,i){var r,o,s;for(null==i&&(i=t),r=A[n];n>e&&i(r,o=A[s=n-1>>1])<0;)A[n]=o,n=s;return A[n]=r},l=function(A,e,n){var i,r,o,s,a;for(null==n&&(n=t),r=A.length,a=e,o=A[e],i=2*e+1;i<r;)(s=i+1)<r&&!(n(A[i],A[s])<0)&&(i=s),A[e]=A[i],i=2*(e=i)+1;return A[e]=o,u(A,a,e,n)},e=function(){function A(A){this.cmp=null!=A?A:t,this.nodes=[]}return A.push=o,A.pop=r,A.replace=a,A.pushpop=s,A.heapify=i,A.updateItem=Q,A.nlargest=g,A.nsmallest=E,A.prototype.push=function(A){return o(this.nodes,A,this.cmp)},A.prototype.pop=function(){return r(this.nodes,this.cmp)},A.prototype.peek=function(){return this.nodes[0]},A.prototype.contains=function(A){return-1!==this.nodes.indexOf(A)},A.prototype.replace=function(A){return a(this.nodes,A,this.cmp)},A.prototype.pushpop=function(A){return s(this.nodes,A,this.cmp)},A.prototype.heapify=function(){return i(this.nodes,this.cmp)},A.prototype.updateItem=function(A){return Q(this.nodes,A,this.cmp)},A.prototype.clear=function(){return this.nodes=[]},A.prototype.empty=function(){return 0===this.nodes.length},A.prototype.size=function(){return this.nodes.length},A.prototype.clone=function(){var e;return(e=new A).nodes=this.nodes.slice(0),e},A.prototype.toArray=function(){return this.nodes.slice(0)},A.prototype.insert=A.prototype.push,A.prototype.top=A.prototype.peek,A.prototype.front=A.prototype.peek,A.prototype.has=A.prototype.contains,A.prototype.copy=A.prototype.clone,A}(),(null!==A?A.exports:void 0)?A.exports=e:window.Heap=e}).call(this)}).call(this,t(89)(A))},function(A,e,t){var n=t(64),i=t(12);function r(A,e,t){var n;"object"!=typeof A?n=A:(e=A.length,n=A[0].length,t=A),this.width=n,this.height=e,this.nodes=this._buildNodes(n,e,t)}r.prototype._buildNodes=function(A,e,t){var i,r,o=new Array(e);for(i=0;i<e;++i)for(o[i]=new Array(A),r=0;r<A;++r)o[i][r]=new n(r,i);if(void 0===t)return o;if(t.length!==e||t[0].length!==A)throw new Error("Matrix size does not fit");for(i=0;i<e;++i)for(r=0;r<A;++r)t[i][r]&&(o[i][r].walkable=!1);return o},r.prototype.getNodeAt=function(A,e){return this.nodes[e][A]},r.prototype.isWalkableAt=function(A,e){return this.isInside(A,e)&&this.nodes[e][A].walkable},r.prototype.isInside=function(A,e){return A>=0&&A<this.width&&e>=0&&e<this.height},r.prototype.setWalkableAt=function(A,e,t){this.nodes[e][A].walkable=t},r.prototype.getNeighbors=function(A,e){var t=A.x,n=A.y,r=[],o=!1,s=!1,a=!1,B=!1,c=!1,g=!1,E=!1,Q=!1,u=this.nodes;if(this.isWalkableAt(t,n-1)&&(r.push(u[n-1][t]),o=!0),this.isWalkableAt(t+1,n)&&(r.push(u[n][t+1]),a=!0),this.isWalkableAt(t,n+1)&&(r.push(u[n+1][t]),c=!0),this.isWalkableAt(t-1,n)&&(r.push(u[n][t-1]),E=!0),e===i.Never)return r;if(e===i.OnlyWhenNoObstacles)s=E&&o,B=o&&a,g=a&&c,Q=c&&E;else if(e===i.IfAtMostOneObstacle)s=E||o,B=o||a,g=a||c,Q=c||E;else{if(e!==i.Always)throw new Error("Incorrect value of diagonalMovement");s=!0,B=!0,g=!0,Q=!0}return s&&this.isWalkableAt(t-1,n-1)&&r.push(u[n-1][t-1]),B&&this.isWalkableAt(t+1,n-1)&&r.push(u[n-1][t+1]),g&&this.isWalkableAt(t+1,n+1)&&r.push(u[n+1][t+1]),Q&&this.isWalkableAt(t-1,n+1)&&r.push(u[n+1][t-1]),r},r.prototype.clone=function(){var A,e,t=this.width,i=this.height,o=this.nodes,s=new r(t,i),a=new Array(i);for(A=0;A<i;++A)for(a[A]=new Array(t),e=0;e<t;++e)a[A][e]=new n(e,A,o[A][e].walkable);return s.nodes=a,s},A.exports=r},function(A,e,t){var n=t(65);function i(A){n.call(this,A);var e=this.heuristic;this.heuristic=function(A,t){return 1e6*e(A,t)}}i.prototype=new n,i.prototype.constructor=i,A.exports=i},function(A,e,t){var n=t(26),i=t(12);function r(A){A=A||{},this.allowDiagonal=A.allowDiagonal,this.dontCrossCorners=A.dontCrossCorners,this.diagonalMovement=A.diagonalMovement,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=i.OnlyWhenNoObstacles:this.diagonalMovement=i.IfAtMostOneObstacle:this.diagonalMovement=i.Never)}r.prototype.findPath=function(A,e,t,i,r){var o,s,a,B,c,g=[],E=this.diagonalMovement,Q=r.getNodeAt(A,e),u=r.getNodeAt(t,i);for(g.push(Q),Q.opened=!0;g.length;){if((a=g.shift()).closed=!0,a===u)return n.backtrace(u);for(B=0,c=(o=r.getNeighbors(a,E)).length;B<c;++B)(s=o[B]).closed||s.opened||(g.push(s),s.opened=!0,s.parent=a)}return[]},A.exports=r},function(A,e,t){var n=t(65);function i(A){n.call(this,A),this.heuristic=function(A,e){return 0}}i.prototype=new n,i.prototype.constructor=i,A.exports=i},function(A,e,t){var n=t(66);function i(A){n.call(this,A);var e=this.heuristic;this.heuristic=function(A,t){return 1e6*e(A,t)}}i.prototype=new n,i.prototype.constructor=i,A.exports=i},function(A,e,t){var n=t(26),i=t(12);function r(A){A=A||{},this.allowDiagonal=A.allowDiagonal,this.dontCrossCorners=A.dontCrossCorners,this.diagonalMovement=A.diagonalMovement,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=i.OnlyWhenNoObstacles:this.diagonalMovement=i.IfAtMostOneObstacle:this.diagonalMovement=i.Never)}r.prototype.findPath=function(A,e,t,i,r){var o,s,a,B,c,g=r.getNodeAt(A,e),E=r.getNodeAt(t,i),Q=[],u=[],l=this.diagonalMovement;for(Q.push(g),g.opened=!0,g.by=0,u.push(E),E.opened=!0,E.by=1;Q.length&&u.length;){for((a=Q.shift()).closed=!0,B=0,c=(o=r.getNeighbors(a,l)).length;B<c;++B)if(!(s=o[B]).closed)if(s.opened){if(1===s.by)return n.biBacktrace(a,s)}else Q.push(s),s.parent=a,s.opened=!0,s.by=0;for((a=u.shift()).closed=!0,B=0,c=(o=r.getNeighbors(a,l)).length;B<c;++B)if(!(s=o[B]).closed)if(s.opened){if(0===s.by)return n.biBacktrace(s,a)}else u.push(s),s.parent=a,s.opened=!0,s.by=1}return[]},A.exports=r},function(A,e,t){var n=t(66);function i(A){n.call(this,A),this.heuristic=function(A,e){return 0}}i.prototype=new n,i.prototype.constructor=i,A.exports=i},function(A,e,t){t(26);var n=t(37),i=t(64),r=t(12);function o(A){A=A||{},this.allowDiagonal=A.allowDiagonal,this.dontCrossCorners=A.dontCrossCorners,this.diagonalMovement=A.diagonalMovement,this.heuristic=A.heuristic||n.manhattan,this.weight=A.weight||1,this.trackRecursion=A.trackRecursion||!1,this.timeLimit=A.timeLimit||1/0,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=r.OnlyWhenNoObstacles:this.diagonalMovement=r.IfAtMostOneObstacle:this.diagonalMovement=r.Never),this.diagonalMovement===r.Never?this.heuristic=A.heuristic||n.manhattan:this.heuristic=A.heuristic||n.octile}o.prototype.findPath=function(A,e,t,n,r){var o,s,a,B=(new Date).getTime(),c=function(A,e){return this.heuristic(Math.abs(e.x-A.x),Math.abs(e.y-A.y))}.bind(this),g=function(A,e,t,n,o){if(this.timeLimit>0&&(new Date).getTime()-B>1e3*this.timeLimit)return 1/0;var s,a,E,u,l=e+c(A,Q)*this.weight;if(l>t)return l;if(A==Q)return n[o]=[A.x,A.y],A;var w,h,C=r.getNeighbors(A,this.diagonalMovement);for(E=0,s=1/0;u=C[E];++E){if(this.trackRecursion&&(u.retainCount=u.retainCount+1||1,!0!==u.tested&&(u.tested=!0)),(a=g(u,e+(h=u,(w=A).x===h.x||w.y===h.y?1:Math.SQRT2),t,n,o+1))instanceof i)return n[o]=[A.x,A.y],a;this.trackRecursion&&0==--u.retainCount&&(u.tested=!1),a<s&&(s=a)}return s}.bind(this),E=r.getNodeAt(A,e),Q=r.getNodeAt(t,n),u=c(E,Q);for(o=0;;++o){if((a=g(E,0,u,s=[],0))===1/0)return[];if(a instanceof i)return s;u=a}return[]},A.exports=o},function(A,e,t){var n=t(12),i=t(337),r=t(338),o=t(339),s=t(340);A.exports=function(A){return(A=A||{}).diagonalMovement===n.Never?new i(A):A.diagonalMovement===n.Always?new r(A):A.diagonalMovement===n.OnlyWhenNoObstacles?new o(A):new s(A)}},function(A,e,t){var n=t(45),i=t(12);function r(A){n.call(this,A)}r.prototype=new n,r.prototype.constructor=r,r.prototype._jump=function(A,e,t,n){var i=this.grid,r=A-t,o=e-n;if(!i.isWalkableAt(A,e))return null;if(!0===this.trackJumpRecursion&&(i.getNodeAt(A,e).tested=!0),i.getNodeAt(A,e)===this.endNode)return[A,e];if(0!==r){if(i.isWalkableAt(A,e-1)&&!i.isWalkableAt(A-r,e-1)||i.isWalkableAt(A,e+1)&&!i.isWalkableAt(A-r,e+1))return[A,e]}else{if(0===o)throw new Error("Only horizontal and vertical movements are allowed");if(i.isWalkableAt(A-1,e)&&!i.isWalkableAt(A-1,e-o)||i.isWalkableAt(A+1,e)&&!i.isWalkableAt(A+1,e-o))return[A,e];if(this._jump(A+1,e,A,e)||this._jump(A-1,e,A,e))return[A,e]}return this._jump(A+r,e+o,A,e)},r.prototype._findNeighbors=function(A){var e,t,n,r,o,s,a,B,c=A.parent,g=A.x,E=A.y,Q=this.grid,u=[];if(c)e=c.x,t=c.y,n=(g-e)/Math.max(Math.abs(g-e),1),r=(E-t)/Math.max(Math.abs(E-t),1),0!==n?(Q.isWalkableAt(g,E-1)&&u.push([g,E-1]),Q.isWalkableAt(g,E+1)&&u.push([g,E+1]),Q.isWalkableAt(g+n,E)&&u.push([g+n,E])):0!==r&&(Q.isWalkableAt(g-1,E)&&u.push([g-1,E]),Q.isWalkableAt(g+1,E)&&u.push([g+1,E]),Q.isWalkableAt(g,E+r)&&u.push([g,E+r]));else for(a=0,B=(o=Q.getNeighbors(A,i.Never)).length;a<B;++a)s=o[a],u.push([s.x,s.y]);return u},A.exports=r},function(A,e,t){var n=t(45),i=t(12);function r(A){n.call(this,A)}r.prototype=new n,r.prototype.constructor=r,r.prototype._jump=function(A,e,t,n){var i=this.grid,r=A-t,o=e-n;if(!i.isWalkableAt(A,e))return null;if(!0===this.trackJumpRecursion&&(i.getNodeAt(A,e).tested=!0),i.getNodeAt(A,e)===this.endNode)return[A,e];if(0!==r&&0!==o){if(i.isWalkableAt(A-r,e+o)&&!i.isWalkableAt(A-r,e)||i.isWalkableAt(A+r,e-o)&&!i.isWalkableAt(A,e-o))return[A,e];if(this._jump(A+r,e,A,e)||this._jump(A,e+o,A,e))return[A,e]}else if(0!==r){if(i.isWalkableAt(A+r,e+1)&&!i.isWalkableAt(A,e+1)||i.isWalkableAt(A+r,e-1)&&!i.isWalkableAt(A,e-1))return[A,e]}else if(i.isWalkableAt(A+1,e+o)&&!i.isWalkableAt(A+1,e)||i.isWalkableAt(A-1,e+o)&&!i.isWalkableAt(A-1,e))return[A,e];return this._jump(A+r,e+o,A,e)},r.prototype._findNeighbors=function(A){var e,t,n,r,o,s,a,B,c=A.parent,g=A.x,E=A.y,Q=this.grid,u=[];if(c)e=c.x,t=c.y,n=(g-e)/Math.max(Math.abs(g-e),1),r=(E-t)/Math.max(Math.abs(E-t),1),0!==n&&0!==r?(Q.isWalkableAt(g,E+r)&&u.push([g,E+r]),Q.isWalkableAt(g+n,E)&&u.push([g+n,E]),Q.isWalkableAt(g+n,E+r)&&u.push([g+n,E+r]),Q.isWalkableAt(g-n,E)||u.push([g-n,E+r]),Q.isWalkableAt(g,E-r)||u.push([g+n,E-r])):0===n?(Q.isWalkableAt(g,E+r)&&u.push([g,E+r]),Q.isWalkableAt(g+1,E)||u.push([g+1,E+r]),Q.isWalkableAt(g-1,E)||u.push([g-1,E+r])):(Q.isWalkableAt(g+n,E)&&u.push([g+n,E]),Q.isWalkableAt(g,E+1)||u.push([g+n,E+1]),Q.isWalkableAt(g,E-1)||u.push([g+n,E-1]));else for(a=0,B=(o=Q.getNeighbors(A,i.Always)).length;a<B;++a)s=o[a],u.push([s.x,s.y]);return u},A.exports=r},function(A,e,t){var n=t(45),i=t(12);function r(A){n.call(this,A)}r.prototype=new n,r.prototype.constructor=r,r.prototype._jump=function(A,e,t,n){var i=this.grid,r=A-t,o=e-n;if(!i.isWalkableAt(A,e))return null;if(!0===this.trackJumpRecursion&&(i.getNodeAt(A,e).tested=!0),i.getNodeAt(A,e)===this.endNode)return[A,e];if(0!==r&&0!==o){if(this._jump(A+r,e,A,e)||this._jump(A,e+o,A,e))return[A,e]}else if(0!==r){if(i.isWalkableAt(A,e-1)&&!i.isWalkableAt(A-r,e-1)||i.isWalkableAt(A,e+1)&&!i.isWalkableAt(A-r,e+1))return[A,e]}else if(0!==o&&(i.isWalkableAt(A-1,e)&&!i.isWalkableAt(A-1,e-o)||i.isWalkableAt(A+1,e)&&!i.isWalkableAt(A+1,e-o)))return[A,e];return i.isWalkableAt(A+r,e)&&i.isWalkableAt(A,e+o)?this._jump(A+r,e+o,A,e):null},r.prototype._findNeighbors=function(A){var e,t,n,r,o,s,a,B,c,g=A.parent,E=A.x,Q=A.y,u=this.grid,l=[];if(g){if(e=g.x,t=g.y,n=(E-e)/Math.max(Math.abs(E-e),1),r=(Q-t)/Math.max(Math.abs(Q-t),1),0!==n&&0!==r)u.isWalkableAt(E,Q+r)&&l.push([E,Q+r]),u.isWalkableAt(E+n,Q)&&l.push([E+n,Q]),u.isWalkableAt(E,Q+r)&&u.isWalkableAt(E+n,Q)&&l.push([E+n,Q+r]);else if(0!==n){c=u.isWalkableAt(E+n,Q);var w=u.isWalkableAt(E,Q+1),h=u.isWalkableAt(E,Q-1);c&&(l.push([E+n,Q]),w&&l.push([E+n,Q+1]),h&&l.push([E+n,Q-1])),w&&l.push([E,Q+1]),h&&l.push([E,Q-1])}else if(0!==r){c=u.isWalkableAt(E,Q+r);var C=u.isWalkableAt(E+1,Q),I=u.isWalkableAt(E-1,Q);c&&(l.push([E,Q+r]),C&&l.push([E+1,Q+r]),I&&l.push([E-1,Q+r])),C&&l.push([E+1,Q]),I&&l.push([E-1,Q])}}else for(a=0,B=(o=u.getNeighbors(A,i.OnlyWhenNoObstacles)).length;a<B;++a)s=o[a],l.push([s.x,s.y]);return l},A.exports=r},function(A,e,t){var n=t(45),i=t(12);function r(A){n.call(this,A)}r.prototype=new n,r.prototype.constructor=r,r.prototype._jump=function(A,e,t,n){var i=this.grid,r=A-t,o=e-n;if(!i.isWalkableAt(A,e))return null;if(!0===this.trackJumpRecursion&&(i.getNodeAt(A,e).tested=!0),i.getNodeAt(A,e)===this.endNode)return[A,e];if(0!==r&&0!==o){if(i.isWalkableAt(A-r,e+o)&&!i.isWalkableAt(A-r,e)||i.isWalkableAt(A+r,e-o)&&!i.isWalkableAt(A,e-o))return[A,e];if(this._jump(A+r,e,A,e)||this._jump(A,e+o,A,e))return[A,e]}else if(0!==r){if(i.isWalkableAt(A+r,e+1)&&!i.isWalkableAt(A,e+1)||i.isWalkableAt(A+r,e-1)&&!i.isWalkableAt(A,e-1))return[A,e]}else if(i.isWalkableAt(A+1,e+o)&&!i.isWalkableAt(A+1,e)||i.isWalkableAt(A-1,e+o)&&!i.isWalkableAt(A-1,e))return[A,e];return i.isWalkableAt(A+r,e)||i.isWalkableAt(A,e+o)?this._jump(A+r,e+o,A,e):null},r.prototype._findNeighbors=function(A){var e,t,n,r,o,s,a,B,c=A.parent,g=A.x,E=A.y,Q=this.grid,u=[];if(c)e=c.x,t=c.y,n=(g-e)/Math.max(Math.abs(g-e),1),r=(E-t)/Math.max(Math.abs(E-t),1),0!==n&&0!==r?(Q.isWalkableAt(g,E+r)&&u.push([g,E+r]),Q.isWalkableAt(g+n,E)&&u.push([g+n,E]),(Q.isWalkableAt(g,E+r)||Q.isWalkableAt(g+n,E))&&u.push([g+n,E+r]),!Q.isWalkableAt(g-n,E)&&Q.isWalkableAt(g,E+r)&&u.push([g-n,E+r]),!Q.isWalkableAt(g,E-r)&&Q.isWalkableAt(g+n,E)&&u.push([g+n,E-r])):0===n?Q.isWalkableAt(g,E+r)&&(u.push([g,E+r]),Q.isWalkableAt(g+1,E)||u.push([g+1,E+r]),Q.isWalkableAt(g-1,E)||u.push([g-1,E+r])):Q.isWalkableAt(g+n,E)&&(u.push([g+n,E]),Q.isWalkableAt(g,E+1)||u.push([g+n,E+1]),Q.isWalkableAt(g,E-1)||u.push([g+n,E-1]));else for(a=0,B=(o=Q.getNeighbors(A,i.IfAtMostOneObstacle)).length;a<B;++a)s=o[a],u.push([s.x,s.y]);return u},A.exports=r},function(A,e,t){const n=t(7);A.exports=class{constructor(){for(var A=arguments.length,e=new Array(A),t=0;t<A;t++)e[t]=arguments[t];if(Array.isArray(e)&&Array.isArray(e[0]))this._nodes=e;else{this._nodes=[];for(let A of e)Array.isArray(A)||(A=[]),"number"!=typeof A[0]&&(A[0]=0),"number"!=typeof A[1]&&(A[1]=0),this._nodes.push([Cast.toNumber(A[0]),Cast.toNumber(A[1])])}}push(A){this._nodes.push(A)}getRaw(){return n.simple(this._nodes)}getAsObject(){const A=this.getRaw(),e={};let t=0;for(const n of A){e[Cast.toString(t+1)]={x:n[0],y:n[1]},t++}return e}getObjects(){const A=this.getRaw(),e=[];for(const t of A)e.push({x:t[0],y:t[1]});return e}getCommaSeperated(){return this.getRaw().flat(1/0).join(",")}}},function(A,e,t){const n=t(2),i=t(7);class r{static _createArrayOfLength(A,e){if((A=n.toNumber(A))<=0)return[];if(!isFinite(A))return[];const t=Array.from(Array(A).keys()).map(()=>e);return i.simple(t)}static _validateUnsignedInteger(A){return(A=n.toNumber(A))<0&&(A=0),isFinite(A)||(A=0),Math.round(A)}static _splitNumber(A){const e=Math.round(n.toNumber(A));return 0===e?[0,0]:isFinite(e)?[Math.ceil(e/2),Math.floor(e/2)]:[0,0]}static marginGrid(A,e){e=r._validateUnsignedInteger(e);const t=i.simple(A),n=r._validateUnsignedInteger(t[0]?t[0].length:0),o=r._createArrayOfLength(n,0);for(let A=0;A<e;A++){const A=i.simple(o),e=i.simple(o);t.unshift(A),t.push(e)}for(const A of t)for(let t=0;t<e;t++)A.unshift(0),A.push(0);return t}static padGrid(A,e,t){const o=Math.max(0,n.toNumber(e)-1),s=Math.max(0,n.toNumber(t)-1),a=r._splitNumber(o),B=r._splitNumber(s),c=i.simple(A),g=i.simple(A),E={row:0,tile:0};for(const A of g){for(const e of A)if(c[E.row][E.tile]<=0)E.tile++;else{for(let e=0;e<a[0];e++){const t=E.tile+(e+1);"number"==typeof A[t]&&(A[t]=1)}for(let e=0;e<a[1];e++){const t=E.tile-(e+1);"number"==typeof A[t]&&(A[t]=1)}for(let A=0;A<B[0];A++){const e=E.row-(A+1);if(!c[e])continue;g[e][E.tile]=1}for(let A=0;A<B[1];A++){const e=E.row+(A+1);if(!c[e])continue;g[e][E.tile]=1}for(let A=0;A<2;A++){const e=1===A;for(let A=0;A<B[e?1:0];A++){let t=E.row-(A+1);if(e&&(t=E.row+(A+1)),!c[t])continue;const n=g[t];for(let A=0;A<2;A++){const e=1===A;for(let A=0;A<a[e?1:0];A++){let t=E.tile+(A+1);e&&(t=E.tile-(A+1)),"number"==typeof n[t]&&(n[t]=1)}}}}E.tile++}E.row++,E.tile=0}return g}}A.exports=r},function(A,e,t){const n=t(2),i=t(7),r={grid:[[0,0,0],[0,0,0],[0,0,0]],offset:{left:0,top:0}};class o{constructor(){this.boxes=[]}static new(){for(var A=arguments.length,e=new Array(A),t=0;t<A;t++)e[t]=arguments[t];return new o(...e)}add(A,e,t,i){const r={x1:A=Math.round(n.toNumber(A)),y1:e=Math.round(n.toNumber(e)),x2:t=Math.round(n.toNumber(t)),y2:i=Math.round(n.toNumber(i))};t<A&&(r.x1=t,r.x2=A),i>e&&(r.y1=i,r.y2=e);const o={x:r.x1,y:r.x2,width:r.x2-r.x1,height:r.y1-r.y2};return this.boxes.push(o),o}clear(){this.boxes=[]}toGrid(){if(!this.boxes)return r;if(this.boxes.length<=0)return r;const A=[];let e=-1/0;for(const A of this.boxes)A.y>e&&(e=A.y);let t=1/0,n=0;for(const A of this.boxes)A.y<t&&(t=A.y,n=A.height);const o=[];let s=1/0;for(const A of this.boxes)A.x<s&&(s=A.x);let a=-1/0,B=0;for(const A of this.boxes)A.x>a&&(a=A.x,B=A.width);const c=a-s+B;for(let A=0;A<c;A++)o.push(0);const g=e-t+n;for(let e=0;e<g;e++){const e=i.simple(o);A.push(e)}const E=i.simple({top:e,left:s});for(const e of this.boxes){const t=e.x-E.left;let n=t,i=Math.abs(e.y-E.top);for(let r=0;r<e.height;r++){for(let t=0;t<e.width;t++){A[i][n]=1,n++}i++,n=t}}return{grid:A,offset:E}}}A.exports=o},function(A,e,t){},function(A,e,t){const n=t(1),i=t(3),r=t(2),o=t(9);A.exports=class{constructor(A){this.runtime=A,this.currentServer="https://storage-ext.penguinmod.com/",this.usePenguinMod=!0,this.useGlobal=!0,this.waitingForResponse=!1,this.serverFailedResponse=!1,this.serverError="",this.uniquePrefix="u"+o()}getInfo(){return{id:"jgStorage",name:"Storage",color1:"#76A8FE",color2:"#538EFC",docsURI:"https://docs.penguinmod.com/extensions/storage",blocks:[{blockType:n.LABEL,text:"Local Storage"},{opcode:"getValue",text:"get [KEY]",disableMonitor:!0,blockType:n.REPORTER,arguments:{KEY:{type:i.STRING,defaultValue:"key"}}},{opcode:"setValue",text:"set [KEY] to [VALUE]",blockType:n.COMMAND,arguments:{KEY:{type:i.STRING,defaultValue:"key"},VALUE:{type:i.STRING,defaultValue:"value"}}},{opcode:"deleteValue",text:"delete [KEY]",blockType:n.COMMAND,arguments:{KEY:{type:i.STRING,defaultValue:"key"}}},{opcode:"getKeys",text:"get all stored names",disableMonitor:!0,blockType:n.REPORTER},{blockType:n.LABEL,text:"Local Uploaded Project Storage"},{opcode:"getProjectValue",text:"get uploaded project [KEY]",disableMonitor:!0,blockType:n.REPORTER,arguments:{KEY:{type:i.STRING,defaultValue:"key"}}},{opcode:"setProjectValue",text:"set uploaded project [KEY] to [VALUE]",blockType:n.COMMAND,arguments:{KEY:{type:i.STRING,defaultValue:"key"},VALUE:{type:i.STRING,defaultValue:"value"}}},{opcode:"deleteProjectValue",text:"delete uploaded project [KEY]",blockType:n.COMMAND,arguments:{KEY:{type:i.STRING,defaultValue:"key"}}},{opcode:"getProjectKeys",text:"get all stored names in this uploaded project",disableMonitor:!0,blockType:n.REPORTER},{blockType:n.LABEL,text:"Local Project Storage"},{opcode:"getUniqueValue",text:"get local project [KEY]",disableMonitor:!0,blockType:n.REPORTER,arguments:{KEY:{type:i.STRING,defaultValue:"key"}}},{opcode:"setUniqueValue",text:"set local project [KEY] to [VALUE]",blockType:n.COMMAND,arguments:{KEY:{type:i.STRING,defaultValue:"key"},VALUE:{type:i.STRING,defaultValue:"value"}}},{opcode:"deleteUniqueValue",text:"delete local project [KEY]",blockType:n.COMMAND,arguments:{KEY:{type:i.STRING,defaultValue:"key"}}},{opcode:"getUniqueKeys",text:"get all stored names in this local project",disableMonitor:!0,blockType:n.REPORTER},{blockType:n.LABEL,text:"Server Storage"},{opcode:"isGlobalServer",text:"is using global server?",disableMonitor:!0,blockType:n.BOOLEAN},{opcode:"useCertainServer",text:"set server to [SERVER] server",disableMonitor:!0,blockType:n.COMMAND,arguments:{SERVER:{type:i.STRING,menu:"serverType"}}},{opcode:"waitingForConnection",text:"waiting for server to respond?",disableMonitor:!0,blockType:n.BOOLEAN},{opcode:"connectionFailed",text:"server failed to respond?",disableMonitor:!0,blockType:n.BOOLEAN},{opcode:"serverErrorOutput",text:"server error",disableMonitor:!1,blockType:n.REPORTER},"---",{opcode:"getServerValue",text:"get server [KEY]",disableMonitor:!0,blockType:n.REPORTER,arguments:{KEY:{type:i.STRING,defaultValue:"key"}}},{opcode:"setServerValue",text:"set server [KEY] to [VALUE]",blockType:n.COMMAND,arguments:{KEY:{type:i.STRING,defaultValue:"key"},VALUE:{type:i.STRING,defaultValue:"value"}}},{opcode:"deleteServerValue",text:"delete server [KEY]",blockType:n.COMMAND,arguments:{KEY:{type:i.STRING,defaultValue:"key"}}}],menus:{serverType:{acceptReporters:!0,items:["project","global"].map(A=>({text:A,value:A}))}}}}serialize(){return{uniqueId:this.uniquePrefix}}deserialize(A){this.uniquePrefix=A.uniqueId}getPrefix(A){return"PM_PROJECTSTORAGE_EXT_".concat(null==A?"":"".concat(A,"_"))}getAllKeys(A){return Object.keys(localStorage).filter(e=>e.startsWith(this.getPrefix(A))).map(e=>e.replace(this.getPrefix(A),""))}getProjectId(){const A=String(window.location.hash).replace(/#/gim,"");return r.toNumber(A)}runPenguinWebRequest(A,e,t){return this.waitingForResponse=!0,this.serverFailedResponse=!1,this.serverError="",new Promise(n=>{let i=null;i=null!==e?fetch(A,e):fetch(A),i.then(A=>{A.text().then(e=>{if(!A.ok)return this.waitingForResponse=!1,this.serverFailedResponse=!0,this.serverError=r.toString(e),null!==t?n(t):void n(e);this.waitingForResponse=!1,this.serverFailedResponse=!1,this.serverError="",n(e)}).catch(A=>{if(this.waitingForResponse=!1,this.serverFailedResponse=!0,this.serverError=r.toString(A),null!==t)return n(t);n(A)})}).catch(A=>{if(this.waitingForResponse=!1,this.serverFailedResponse=!0,this.serverError=r.toString(A),null!==t)return n(t);n(A)})})}getCurrentServer(){return"https://storage-ext.penguinmod.com/"}getKeys(){return JSON.stringify(this.getAllKeys())}getValue(A){const e=this.getPrefix()+r.toString(A.KEY),t=localStorage.getItem(e);return null===t?"":r.toString(t)}setValue(A){const e=this.getPrefix()+r.toString(A.KEY),t=r.toString(A.VALUE);return localStorage.setItem(e,t)}deleteValue(A){const e=this.getPrefix()+r.toString(A.KEY);return localStorage.removeItem(e)}getProjectKeys(){return JSON.stringify(this.getAllKeys(this.getProjectId()))}getProjectValue(A){const e=this.getPrefix(this.getProjectId())+r.toString(A.KEY),t=localStorage.getItem(e);return null===t?"":r.toString(t)}setProjectValue(A){const e=this.getPrefix(this.getProjectId())+r.toString(A.KEY),t=r.toString(A.VALUE);return localStorage.setItem(e,t)}deleteProjectValue(A){const e=this.getPrefix(this.getProjectId())+r.toString(A.KEY);return localStorage.removeItem(e)}getUniqueKeys(){return JSON.stringify(this.getAllKeys(this.uniquePrefix))}getUniqueValue(A){const e=this.getPrefix(this.uniquePrefix)+r.toString(A.KEY),t=localStorage.getItem(e);return null===t?"":r.toString(t)}setUniqueValue(A){const e=this.getPrefix(this.uniquePrefix)+r.toString(A.KEY),t=r.toString(A.VALUE);return localStorage.setItem(e,t)}deleteUniqueValue(A){const e=this.getPrefix(this.uniquePrefix)+r.toString(A.KEY);return localStorage.removeItem(e)}isGlobalServer(){return this.useGlobal}useCertainServer(A){const e=r.toString(A.SERVER).toLowerCase();return["project","global"].includes(e)?(this.currentServer="https://storage-ext.penguinmod.com/",this.usePenguinMod=!0,this.useGlobal="global"===e):(this.currentServer=r.toString(A.SERVER),this.currentServer.endsWith("/")||(this.currentServer+="/"),this.usePenguinMod=!1,this.useGlobal=!0),this.runPenguinWebRequest(this.currentServer)}waitingForConnection(){return this.waitingForResponse}connectionFailed(){return this.serverFailedResponse}serverErrorOutput(){return this.serverError}getServerValue(A){const e=r.toString(A.KEY);return this.runPenguinWebRequest("".concat(this.currentServer,"get?key=").concat(e).concat(this.useGlobal?"":"&project=".concat(this.getProjectId())),null,"")}setServerValue(A){const e=r.toString(A.KEY),t=r.toString(A.VALUE);return this.runPenguinWebRequest("".concat(this.currentServer,"set?key=").concat(e).concat(this.useGlobal?"":"&project=".concat(this.getProjectId())),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({value:t})})}deleteServerValue(A){const e=r.toString(A.KEY);return this.runPenguinWebRequest("".concat(this.currentServer,"delete?key=").concat(e).concat(this.useGlobal?"":"&project=".concat(this.getProjectId())),{method:"DELETE"})}}},function(A,e,t){const n=t(1),i=t(3),r=t(2),o=t(347);A.exports=class{constructor(A){this.runtime=A,this.timers={},A.on("RUNTIME_PAUSED",()=>{this._getTimersArray().forEach(A=>A.instance.pause(!0))}),A.on("RUNTIME_UNPAUSED",()=>{this._getTimersArray().forEach(A=>A.instance.start(!0))})}_getTimersArray(){return Object.values(this.timers)}getInfo(){return{id:"jgTimers",name:"Multiple Timers",color1:"#0093FE",color2:"#1177FC",blocks:[{opcode:"createTimer",text:"create timer named [NAME]",blockType:n.COMMAND,arguments:{NAME:{type:i.STRING,defaultValue:"timer"}}},{opcode:"deleteTimer",text:"delete timer named [NAME]",blockType:n.COMMAND,arguments:{NAME:{type:i.STRING,defaultValue:"timer"}}},{opcode:"deleteAllTimer",text:"delete all timers",blockType:n.COMMAND},{text:"Values",blockType:n.LABEL},{opcode:"getTimer",text:"get timer named [NAME]",blockType:n.REPORTER,disableMonitor:!1,arguments:{NAME:{type:i.STRING,defaultValue:"timer"}}},{opcode:"getTimerData",text:"get [DATA] of timer named [NAME]",blockType:n.REPORTER,disableMonitor:!1,arguments:{DATA:{type:i.STRING,menu:"timerData"},NAME:{type:i.STRING,defaultValue:"timer"}}},{opcode:"existsTimer",text:"timer named [NAME] exists?",blockType:n.BOOLEAN,disableMonitor:!1,arguments:{NAME:{type:i.STRING,defaultValue:"timer"}}},{opcode:"getAllTimer",text:"get all timers",blockType:n.REPORTER,disableMonitor:!1},{text:"Operations",blockType:n.LABEL},{opcode:"startTimer",text:"start timer [NAME]",blockType:n.COMMAND,arguments:{NAME:{type:i.STRING,defaultValue:"timer"}}},{opcode:"pauseTimer",text:"pause timer [NAME]",blockType:n.COMMAND,arguments:{NAME:{type:i.STRING,defaultValue:"timer"}}},{opcode:"stopTimer",text:"stop timer [NAME]",blockType:n.COMMAND,arguments:{NAME:{type:i.STRING,defaultValue:"timer"}}},{opcode:"resetTimer",text:"reset timer [NAME]",blockType:n.COMMAND,arguments:{NAME:{type:i.STRING,defaultValue:"timer"}}},{opcode:"addTimer",text:"add [SECONDS] seconds to timer [NAME]",blockType:n.COMMAND,arguments:{SECONDS:{type:i.NUMBER,defaultValue:5},NAME:{type:i.STRING,defaultValue:"timer"}}}],menus:{timerData:{acceptReporters:!0,items:["milliseconds","minutes","hours","days","weeks","years"].map(A=>({text:A,value:A}))}}}}createTimer(A){this.timers[A.NAME]||(this.timers[A.NAME]={name:r.toString(A.NAME),instance:new o})}deleteTimer(A){this.timers[A.NAME]&&delete this.timers[A.NAME]}deleteAllTimer(){this.timers={}}getTimer(A){const e=this.timers[A.NAME];if(!e)return"";const t=e.instance.getTime(!0);return r.toNumber(t)}getTimerData(A){const e=this.timers[A.NAME];if(!e)return"";const t=r.toNumber(e.instance.getTime(!0));switch(A.DATA){case"milliseconds":return 1e3*t;case"minutes":return Math.floor(t/60);case"hours":return Math.floor(t/3600);case"days":return Math.floor(t/86400);case"weeks":return Math.floor(t/604800);case"years":return Math.floor(t/31536e3);default:return t}}existsTimer(A){return!!this.timers[A.NAME]}getAllTimer(){return JSON.stringify(this._getTimersArray().map(A=>A.name))}startTimer(A){const e=this.timers[A.NAME];e&&e.instance.start()}pauseTimer(A){const e=this.timers[A.NAME];e&&e.instance.pause()}stopTimer(A){const e=this.timers[A.NAME];e&&e.instance.stop()}resetTimer(A){const e=this.timers[A.NAME];e&&e.instance.reset()}addTimer(A){const e=this.timers[A.NAME];if(!e)return;const t=r.toNumber(A.SECONDS);e.instance.add(1e3*t)}}},function(A,e){A.exports=class{constructor(A,e){this.startTime=A||Date.now(),e&&(this.pauseTime=e),this.stopped=!0}start(){let A=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=null!==this.pauseTime;!this.stopped&&!e||e&&A&&!this.vmPaused||(this.stopped?this.startTime=Date.now():this.startTime+=Date.now()-this.pauseTime,this.vmPaused=!1,this.pauseTime=null,this.stopped=!1)}pause(){let A=arguments.length>0&&void 0!==arguments[0]&&arguments[0];null!==this.pauseTime||(this.vmPaused=A,this.pauseTime=Date.now())}stop(){this.stopped||(this.stopped=!0,this.pauseTime=Date.now())}reset(){this.stopped=!0,this.pauseTime=Date.now(),this.startTime=Date.now()}add(A){this.startTime-=A}getTime(A){const e=null!==this.pauseTime,t=Number(this.pauseTime)-this.startTime,n=Date.now()-this.startTime;return(e?t:n)/(A?1e3:1)}}},function(A,e,t){},function(A,e,t){"use strict";t.r(e),e.default=""},function(A,e,t){},function(A,e,t){const n=t(9),i=["jgPrism_evaluate","jgPrism_evaluate2","jgPrism_evaluate3","jgFiles_downloadFile","videoSensing_videoToggle","jgPrism_screenshotStage"];A.exports=(A,e)=>{if(((A,e)=>{for(const t of e)for(const e of Object.keys(t.blocks._blocks))if(A.includes(e.opcode))return!0;return!1})(i,e)){const e=n();return prompt("".concat(A,'\nto confirm type "').concat(e,'"'),"to confirm type the text above")===e}const t=prompt(A,"i decline");return"yes"===t||"i accept"===t}},function(A,e){const t=["left-right","don't rotate","all around"];A.exports=class{constructor(A,e,t){this.getThisFuncs(e,t).mySelf=new Function(A)}getThisFuncs(A,e){return{goto:A.setXY,set xPosition(e){A.setXY(e,A.y)},set yPosition(e){A.setXY(A.x,e)},get xPosition(){return A.x},get yPosition(){return A.y},set direction(e){A.setDirection(e)},get direction(){return A.direction},set rotationStyle(e){if(!t.includes(e))throw new Error("invalid style: ".concat(e));A.setRotationStyle(e)}}}}},function(A,e,t){},function(A,e,t){},function(A,e,t){"use strict";t.r(e),e.default=""},function(A,e,t){"use strict";t.r(e),e.default=""},function(A,e,t){"use strict";t.r(e),e.default=""},function(A,e,t){"use strict";t.r(e),e.default=""},function(A,e,t){},function(A,e,t){},function(A,e,t){},function(A,e,t){},function(A,e,t){},function(A,e,t){},function(A,e,t){},function(A,e,t){},function(A,e,t){},function(A,e,t){},function(A,e,t){},function(A,e,t){},function(A,e,t){},function(A,e,t){},function(A,e,t){},function(A,e,t){},function(A,e,t){},function(A,e,t){},function(A,e,t){const n=new(t(46))(!0),i=A=>{if("any"===A)return navigator.getGamepads().filter(A=>A);const e=navigator.getGamepads()[A-1];return e?[e]:[]},r=(A,e)=>{if("any"===e)return A.buttons.some(A=>A.pressed);const t=A.buttons[e-1];return!!t&&t.pressed},o=(A,e)=>{const t=A.buttons[e-1];if(!t)return 0;const n=t.value;return n<.05?0:n},s=(A,e)=>{const t=A.axes[e-1];return"number"!=typeof t||Math.abs(t)<.1?0:t};A.exports=class{getInfo(){return{id:"Gamepad",name:"Gamepad",blocks:[{opcode:"gamepadConnected",blockType:n.BlockType.BOOLEAN,text:"is gamepad [pad] connected?",arguments:{pad:{type:n.ArgumentType.NUMBER,defaultValue:"1",menu:"padMenu"}}},{opcode:"buttonDown",blockType:n.BlockType.BOOLEAN,text:"button [b] on pad [i] pressed?",arguments:{b:{type:n.ArgumentType.NUMBER,defaultValue:"1",menu:"buttonMenu"},i:{type:n.ArgumentType.NUMBER,defaultValue:"1",menu:"padMenu"}}},{opcode:"buttonValue",blockType:n.BlockType.REPORTER,text:"value of button [b] on pad [i]",arguments:{b:{type:n.ArgumentType.NUMBER,defaultValue:"1",menu:"buttonMenu"},i:{type:n.ArgumentType.NUMBER,defaultValue:"1",menu:"padMenu"}}},{opcode:"axisValue",blockType:n.BlockType.REPORTER,text:"value of axis [b] on pad [i]",arguments:{b:{type:n.ArgumentType.NUMBER,defaultValue:"1",menu:"axisMenu"},i:{type:n.ArgumentType.NUMBER,defaultValue:"1",menu:"padMenu"}}},"---",{opcode:"axisDirection",blockType:n.BlockType.REPORTER,text:"direction of axes [axis] on pad [pad]",arguments:{axis:{type:n.ArgumentType.NUMBER,defaultValue:"1",menu:"axesGroupMenu"},pad:{type:n.ArgumentType.NUMBER,defaultValue:"1",menu:"padMenu"}}},{opcode:"axisMagnitude",blockType:n.BlockType.REPORTER,text:"magnitude of axes [axis] on pad [pad]",arguments:{axis:{type:n.ArgumentType.NUMBER,defaultValue:"1",menu:"axesGroupMenu"},pad:{type:n.ArgumentType.NUMBER,defaultValue:"1",menu:"padMenu"}}},"---",{opcode:"rumble",blockType:n.BlockType.COMMAND,text:"rumble strong [s] and weak [w] for [t] sec. on pad [i]",arguments:{s:{type:n.ArgumentType.NUMBER,defaultValue:"0.25"},w:{type:n.ArgumentType.NUMBER,defaultValue:"0.5"},t:{type:n.ArgumentType.NUMBER,defaultValue:"0.25"},i:{type:n.ArgumentType.NUMBER,defaultValue:"1",menu:"padMenu"}}}],menus:{padMenu:{acceptReporters:!0,items:[{text:"any",value:"any"},{text:"1",value:"1"},{text:"2",value:"2"},{text:"3",value:"3"},{text:"4",value:"4"}]},buttonMenu:{acceptReporters:!0,items:[{text:"any",value:"any"},{text:"A (1)",value:"1"},{text:"B (2)",value:"2"},{text:"X (3)",value:"3"},{text:"Y (4)",value:"4"},{text:"Left bumper (5)",value:"5"},{text:"Right bumper (6)",value:"6"},{text:"Left trigger (7)",value:"7"},{text:"Right trigger (8)",value:"8"},{text:"Select/View (9)",value:"9"},{text:"Start/Menu (10)",value:"10"},{text:"Left stick (11)",value:"11"},{text:"Right stick (12)",value:"12"},{text:"D-pad up (13)",value:"13"},{text:"D-pad down (14)",value:"14"},{text:"D-pad left (15)",value:"15"},{text:"D-pad right (16)",value:"16"}]},axisMenu:{acceptReporters:!0,items:[{text:"Left stick horizontal (1)",value:"1"},{text:"Left stick vertical (2)",value:"2"},{text:"Right stick horizontal (3)",value:"3"},{text:"Right stick vertical (4)",value:"4"}]},axesGroupMenu:{acceptReporters:!0,items:[{text:"Left stick (1 & 2)",value:"1"},{text:"Right stick (3 & 4)",value:"3"}]}}}}gamepadConnected(A){let{pad:e}=A;return i(e).length>0}buttonDown(A){let{b:e,i:t}=A;for(const A of i(t))if(r(A,e))return!0;return!1}buttonValue(A){let{b:e,i:t}=A,n=0;for(const A of i(t)){const t=o(A,e);t>n&&(n=t)}return n}axisValue(A){let{b:e,i:t}=A,n=0;for(const A of i(t)){const t=s(A,e);Math.abs(t)>Math.abs(n)&&(n=t)}return n}axisDirection(A){let{axis:e,pad:t}=A,n=0,r=90;for(const A of i(t)){const t=s(A,e),i=s(A,+e+1),o=Math.sqrt(t**2+i**2);o>n&&(n=o,r=180*Math.atan2(i,t)/Math.PI+90,r<0&&(r+=360))}return r}axisMagnitude(A){let{axis:e,pad:t}=A,n=0;for(const A of i(t)){const t=s(A,e),i=s(A,+e+1),r=Math.sqrt(t**2+i**2);r>n&&(n=r)}return n}rumble(A){let{s:e,w:t,t:n,i:r}=A;const o=i(r);for(const A of o)A.vibrationActuator&&A.vibrationActuator.playEffect("dual-rumble",{startDelay:0,duration:1e3*n,weakMagnitude:t,strongMagnitude:e})}}},function(A,e,t){const n=t(3),i=t(1),r=t(2);let o,s=0,a=0,B=0,c=0,g=0,E=0,Q=100,u=0,l=0,w=0,h=100,C=100,I=0,M=100,d=0,m="default",p=["",100],F=[0,"none","#ff0000","transparent"];const D=()=>{const A="rotate(".concat(a,"deg) scale(").concat(Q,"%) skew(").concat(E,"deg, ").concat(g,"deg) translate(").concat(c,"%, ").concat(0-B,"%)");o.style.transform!==A&&(o.style.transform=A);const e="blur(".concat(w,"px) contrast(").concat(h/100,") saturate(").concat(C,"%) hue-rotate(").concat(I,"deg) brightness(").concat(M,"%) invert(").concat(d,"%) sepia(").concat(l,"%) opacity(").concat(100-u,"%)");o.style.filter!==e&&(o.style.filter=e);const t=0===s?"":"".concat(s,"%");o.style.borderRadius!==t&&(o.style.borderRadius=t);const n="pixelated"===m?"pixelated":"";o.style.imageRendering!==n&&(o.style.imageRendering=n),o.style.border=r.toString("".concat(F[0],"px ").concat(F[1]," ").concat(F[2])),o.style.backgroundColor=r.toString(F[3]),p[0].length>3&&(o.style.backgroundImage=p[0],o.style.backgroundSize="".concat(r.toNumber(p[1]),"%"))};A.exports=class{constructor(A){this.runtime=A,this.canvas=A.renderer.canvas,o=this.canvas,new MutationObserver(D).observe(this.canvas,{attributeFilter:["style"],attributes:!0}),this.runtime.on("RUNTIME_DISPOSED",this.cleareffects)}getInfo(){return{id:"theshovelcanvaseffects",name:"Canvas Effects",blocks:[{opcode:"seteffect",blockType:i.COMMAND,text:"set canvas [EFFECT] to [NUMBER]",arguments:{EFFECT:{type:n.STRING,menu:"EFFECTMENU"},NUMBER:{type:n.NUMBER}}},{opcode:"changeEffect",blockType:i.COMMAND,text:"change canvas [EFFECT] by [NUMBER]",arguments:{EFFECT:{type:n.STRING,menu:"EFFECTMENU"},NUMBER:{type:n.NUMBER,defaultValue:5}}},{opcode:"geteffect",blockType:i.REPORTER,text:"get canvas [EFFECT]",arguments:{EFFECT:{type:n.STRING,menu:"EFFECTGETMENU"}}},{opcode:"setBorder",blockType:i.COMMAND,text:"add [BORDER] border to canvas with color [COLOR1] and backup [COLOR2] and thickness [THICK]",arguments:{BORDER:{type:n.STRING,menu:"BORDERTYPES"},THICK:{type:n.NUMBER,defaultValue:5},COLOR1:{type:n.COLOR,defaultValue:"#ff0000"},COLOR2:{type:n.COLOR,defaultValue:"#0000ff"}}},{opcode:"setImage",blockType:i.COMMAND,text:"set canvas image to [IMAGE] scaled [AMT]%",hideFromPalette:!0,arguments:{IMAGE:{type:n.STRING,defaultValue:"https://extensions.turbowarp.org/dango.png"},AMT:{type:n.NUMBER,defaultValue:100}}},{opcode:"cleareffects",blockType:i.COMMAND,text:"clear canvas effects"},{opcode:"renderscale",blockType:i.COMMAND,text:"set canvas render size to width:[X] height:[Y]",arguments:{X:{type:n.NUMBER,defaultValue:100},Y:{type:n.NUMBER,defaultValue:100}}},{opcode:"setrendermode",blockType:i.COMMAND,text:"set canvas resize rendering mode [EFFECT]",arguments:{EFFECT:{type:n.STRING,menu:"RENDERMODE"}}}],menus:{EFFECTMENU:{acceptReporters:!0,items:["blur","contrast","saturation","color shift","brightness","invert","sepia","transparency","scale","skew X","skew Y","offset X","offset Y","rotation","border radius"]},RENDERMODE:{acceptReporters:!0,items:["pixelated","default"]},EFFECTGETMENU:{acceptReporters:!0,items:["blur","contrast","saturation","color shift","brightness","invert","resize rendering mode","sepia","transparency","scale","skew X","skew Y","offset X","offset Y","rotation","border radius"]},BORDERTYPES:{acceptReporters:!0,items:["dotted","dashed","solid","double","groove","ridge","inset","outset","none"]}}}}geteffect(A){let{EFFECT:e}=A;return"blur"===e?w:"contrast"===e?h:"saturation"===e?C:"color shift"===e?I:"brightness"===e?M:"invert"===e?d:"resize rendering mode"===e?m:"sepia"===e?l:"transparency"===e?u:"scale"===e?Q:"skew X"===e?E:"skew Y"===e?g:"offset X"===e?c:"offset Y"===e?B:"rotation"===e?a:"border radius"===e?s:""}seteffect(A){let{EFFECT:e,NUMBER:t}=A;t=r.toNumber(t),"blur"===e?w=t:"contrast"===e?h=t:"saturation"===e?C=t:"color shift"===e?I=t:"brightness"===e?M=t:"invert"===e?d=t:"sepia"===e?l=t:"transparency"===e?u=t:"scale"===e?Q=t:"skew X"===e?E=t:"skew Y"===e?g=t:"offset X"===e?c=t:"offset Y"===e?B=t:"rotation"===e?a=t:"border radius"===e&&(s=t),D()}changeEffect(A){const e=A.EFFECT,t=this.geteffect(A),n=r.toNumber(A.NUMBER)+t;"blur"===e?w=n:"contrast"===e?h=n:"saturation"===e?C=n:"color shift"===e?I=n:"brightness"===e?M=n:"invert"===e?d=n:"sepia"===e?l=n:"transparency"===e?u=n:"scale"===e?Q=n:"skew X"===e?E=n:"skew Y"===e?g=n:"offset X"===e?c=n:"offset Y"===e?B=n:"rotation"===e?a=n:"border radius"===e&&(s=n),D()}cleareffects(){s=0,a=0,B=0,c=0,g=0,E=0,Q=100,u=0,l=0,w=0,h=100,C=100,I=0,M=100,d=0,m="default",p=["",100],F=[0,"none","#ff0000","transparent"],D()}setrendermode(A){let{EFFECT:e}=A;m=e,D()}renderscale(A){let{X:e,Y:t}=A;this.runtime.renderer.resize(e,t)}setImage(A){this.runtime.vm.securityManager.canFetch(encodeURI(A.IMAGE)).then(e=>{e?p=["url(".concat(encodeURI(A.IMAGE),")"),A.AMT]:(console.log("Cannot fetch content from the URL."),p=[]),D()})}setBorder(A){F=[A.THICK,A.BORDER,A.COLOR1,A.COLOR2],"none"===A.BORDER&&(F[3]="transparent"),D()}}},function(A,e,t){const n=t(3),i=t(1),{validateArray:r}=t(13),o=new(t(25)),s=t(2),a=t(380);A.exports=class{getInfo(){return{id:"shovellzcompresss",name:"LZ Compress",blocks:[{opcode:"compress",blockType:i.REPORTER,text:"compress [TEXT] to [TYPE]",arguments:{TEXT:{type:n.STRING,defaultValue:"Hello world!"},TYPE:{type:n.STRING,menu:"COMPRESSIONTYPES"}}},{opcode:"decompress",blockType:i.REPORTER,text:"decompress [TEXT] from [TYPE]",arguments:{TEXT:{type:n.STRING,defaultValue:"@"},TYPE:{type:n.STRING,menu:"COMPRESSIONTYPES"}}}],menus:{COMPRESSIONTYPES:{acceptReporters:!0,items:["Raw","Base64","EncodedURIComponent","ArrayBuffer","UTF16"]}}}}compress(A){const e=s.toString(A.TEXT);if("Raw"==A.TYPE)return a.compress(e);if("Base64"==A.TYPE)return a.compressToBase64(e);if("EncodedURIComponent"==A.TYPE)return a.compressToEncodedURIComponent(e);if("ArrayBuffer"==A.TYPE){const A=a.compressToUint8Array(e),t=o.uint8ArrayToBuffer(A),n=o.bufferToArray(t);return JSON.stringify(n)}return"UTF16"==A.TYPE?a.compressToUTF16(e):""}decompress(A){try{const e=s.toString(A.TEXT);if("Raw"==A.TYPE)return a.decompress(e)||"";if("Base64"==A.TYPE)return a.decompressFromBase64(e)||"";if("EncodedURIComponent"==A.TYPE)return a.decompressFromEncodedURIComponent(e)||"";if("ArrayBuffer"==A.TYPE){const A=r(e);if(!A.isValid)return"";const t=o.arrayToBuffer(A.array),n=o.bufferToUint8Array(t);return a.decompressFromUint8Array(n)||""}if("UTF16"==A.TYPE)return a.decompressFromUTF16(e)||""}catch(A){console.error("decompress error",A)}return""}}},function(A,e,t){var n,i=function(){var A=String.fromCharCode,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",n={};function i(A,e){if(!n[A]){n[A]={};for(var t=0;t<A.length;t++)n[A][A.charAt(t)]=t}return n[A][e]}var r={compressToBase64:function(A){if(null==A)return"";var t=r._compress(A,6,(function(A){return e.charAt(A)}));switch(t.length%4){default:case 0:return t;case 1:return t+"===";case 2:return t+"==";case 3:return t+"="}},decompressFromBase64:function(A){return null==A?"":""==A?null:r._decompress(A.length,32,(function(t){return i(e,A.charAt(t))}))},compressToUTF16:function(e){return null==e?"":r._compress(e,15,(function(e){return A(e+32)}))+" "},decompressFromUTF16:function(A){return null==A?"":""==A?null:r._decompress(A.length,16384,(function(e){return A.charCodeAt(e)-32}))},compressToUint8Array:function(A){for(var e=r.compress(A),t=new Uint8Array(2*e.length),n=0,i=e.length;n<i;n++){var o=e.charCodeAt(n);t[2*n]=o>>>8,t[2*n+1]=o%256}return t},decompressFromUint8Array:function(e){if(null==e)return r.decompress(e);for(var t=new Array(e.length/2),n=0,i=t.length;n<i;n++)t[n]=256*e[2*n]+e[2*n+1];var o=[];return t.forEach((function(e){o.push(A(e))})),r.decompress(o.join(""))},compressToEncodedURIComponent:function(A){return null==A?"":r._compress(A,6,(function(A){return t.charAt(A)}))},decompressFromEncodedURIComponent:function(A){return null==A?"":""==A?null:(A=A.replace(/ /g,"+"),r._decompress(A.length,32,(function(e){return i(t,A.charAt(e))})))},compress:function(e){return r._compress(e,16,(function(e){return A(e)}))},_compress:function(A,e,t){if(null==A)return"";var n,i,r,o={},s={},a="",B="",c="",g=2,E=3,Q=2,u=[],l=0,w=0;for(r=0;r<A.length;r+=1)if(a=A.charAt(r),Object.prototype.hasOwnProperty.call(o,a)||(o[a]=E++,s[a]=!0),B=c+a,Object.prototype.hasOwnProperty.call(o,B))c=B;else{if(Object.prototype.hasOwnProperty.call(s,c)){if(c.charCodeAt(0)<256){for(n=0;n<Q;n++)l<<=1,w==e-1?(w=0,u.push(t(l)),l=0):w++;for(i=c.charCodeAt(0),n=0;n<8;n++)l=l<<1|1&i,w==e-1?(w=0,u.push(t(l)),l=0):w++,i>>=1}else{for(i=1,n=0;n<Q;n++)l=l<<1|i,w==e-1?(w=0,u.push(t(l)),l=0):w++,i=0;for(i=c.charCodeAt(0),n=0;n<16;n++)l=l<<1|1&i,w==e-1?(w=0,u.push(t(l)),l=0):w++,i>>=1}0==--g&&(g=Math.pow(2,Q),Q++),delete s[c]}else for(i=o[c],n=0;n<Q;n++)l=l<<1|1&i,w==e-1?(w=0,u.push(t(l)),l=0):w++,i>>=1;0==--g&&(g=Math.pow(2,Q),Q++),o[B]=E++,c=String(a)}if(""!==c){if(Object.prototype.hasOwnProperty.call(s,c)){if(c.charCodeAt(0)<256){for(n=0;n<Q;n++)l<<=1,w==e-1?(w=0,u.push(t(l)),l=0):w++;for(i=c.charCodeAt(0),n=0;n<8;n++)l=l<<1|1&i,w==e-1?(w=0,u.push(t(l)),l=0):w++,i>>=1}else{for(i=1,n=0;n<Q;n++)l=l<<1|i,w==e-1?(w=0,u.push(t(l)),l=0):w++,i=0;for(i=c.charCodeAt(0),n=0;n<16;n++)l=l<<1|1&i,w==e-1?(w=0,u.push(t(l)),l=0):w++,i>>=1}0==--g&&(g=Math.pow(2,Q),Q++),delete s[c]}else for(i=o[c],n=0;n<Q;n++)l=l<<1|1&i,w==e-1?(w=0,u.push(t(l)),l=0):w++,i>>=1;0==--g&&(g=Math.pow(2,Q),Q++)}for(i=2,n=0;n<Q;n++)l=l<<1|1&i,w==e-1?(w=0,u.push(t(l)),l=0):w++,i>>=1;for(;;){if(l<<=1,w==e-1){u.push(t(l));break}w++}return u.join("")},decompress:function(A){return null==A?"":""==A?null:r._decompress(A.length,32768,(function(e){return A.charCodeAt(e)}))},_decompress:function(e,t,n){var i,r,o,s,a,B,c,g=[],E=4,Q=4,u=3,l="",w=[],h={val:n(0),position:t,index:1};for(i=0;i<3;i+=1)g[i]=i;for(o=0,a=Math.pow(2,2),B=1;B!=a;)s=h.val&h.position,h.position>>=1,0==h.position&&(h.position=t,h.val=n(h.index++)),o|=(s>0?1:0)*B,B<<=1;switch(o){case 0:for(o=0,a=Math.pow(2,8),B=1;B!=a;)s=h.val&h.position,h.position>>=1,0==h.position&&(h.position=t,h.val=n(h.index++)),o|=(s>0?1:0)*B,B<<=1;c=A(o);break;case 1:for(o=0,a=Math.pow(2,16),B=1;B!=a;)s=h.val&h.position,h.position>>=1,0==h.position&&(h.position=t,h.val=n(h.index++)),o|=(s>0?1:0)*B,B<<=1;c=A(o);break;case 2:return""}for(g[3]=c,r=c,w.push(c);;){if(h.index>e)return"";for(o=0,a=Math.pow(2,u),B=1;B!=a;)s=h.val&h.position,h.position>>=1,0==h.position&&(h.position=t,h.val=n(h.index++)),o|=(s>0?1:0)*B,B<<=1;switch(c=o){case 0:for(o=0,a=Math.pow(2,8),B=1;B!=a;)s=h.val&h.position,h.position>>=1,0==h.position&&(h.position=t,h.val=n(h.index++)),o|=(s>0?1:0)*B,B<<=1;g[Q++]=A(o),c=Q-1,E--;break;case 1:for(o=0,a=Math.pow(2,16),B=1;B!=a;)s=h.val&h.position,h.position>>=1,0==h.position&&(h.position=t,h.val=n(h.index++)),o|=(s>0?1:0)*B,B<<=1;g[Q++]=A(o),c=Q-1,E--;break;case 2:return w.join("")}if(0==E&&(E=Math.pow(2,u),u++),g[c])l=g[c];else{if(c!==Q)return null;l=r+r.charAt(0)}w.push(l),g[Q++]=r+l.charAt(0),r=l,0==--E&&(E=Math.pow(2,u),u++)}}};return r}();void 0===(n=function(){return i}.call(e,t,e,A))||(A.exports=n)},function(A,e,t){},function(A,e,t){const n=t(3),i=t(1),r=t(2);let o,s,a,B,c,g,E,Q,u,l,w,h,C,I,M,d="",m="",p="",F="",D="",Y="",f="",N="",U="",y=-1,T=-1,x=-1,R=-1,G="",S="",H=-1,b=-1,v="",k=-1,j="",J=-1,z=-1,L="",P="",O="",V="",W="";"undefined"!=typeof scaffolding?(o=".sc-monitor-root",s=".sc-monitor-value",a=".sc-monitor-list-label",B=".sc-monitor-list-footer",c=".sc-monitor-row-value-outer",g=".sc-monitor-rows-inner",E=g,Q=".sc-monitor-row-index",u=".sc-monitor-large-value",l=".sc-question-inner",w=".sc-question-submit-button",h=".sc-question-input",I=".sc-question-input:hover",M=".sc-question-input:focus",C=".sc-question-text"):(o='div[class^="monitor_monitor-container_"]',s='div[class^="monitor_value_"]',a='div[class^="monitor_list-header_"]',B='div[class^="monitor_list-footer_"]',c='div[class^="monitor_list-value_"]',g='div[class^="monitor_list-body_"]',E='div[class^="monitor_list-body_"] > .ReactVirtualized__List',Q='div[class^="monitor_list-index_"]',u='div[class^="monitor_large-value_"]',l='div[class^="question_question-container_"]',w='button[class^="question_question-submit-button_"]',h='[class^="question_question-container_"] input[class^="input_input-form_"]',L='img[class^="question_question-submit-button-icon_"]',I='[class^="question_question-input_"] input:focus, [class^="question_question-input_"] input:hover',M='[class^="question_question-input_"] > input:focus',C='[class^="question_question-container_"] div[class^="question_question-label_"]');const K="",X="",Z="",_=document.createElement("style");_.className="shovelcss-style",document.body.appendChild(_);const q=()=>{let A="";d&&(A+="".concat(o,", ").concat(B,", ").concat(a,", ").concat(Q," { color: ").concat(d,"; }")),p&&(A+="".concat(o,", ").concat(g," { background: ").concat(p,"; }")),m&&(A+="".concat(o," { border-color: ").concat(m,"; }")),x>=0&&(A+="".concat(o," { border-radius: ").concat(x,"px; }")),R>=0&&(A+="".concat(o," { border-width: ").concat(R,"px; }")),F&&(A+="".concat(s,", ").concat(u," { background: ").concat(F," !important; }")),D&&(A+="".concat(s,", ").concat(u," { color: ").concat(D,"; }")),y>=0&&(A+="".concat(s," { border-radius: ").concat(y,"px; }")),f&&(A+="".concat(a," { background: ").concat(f,"; }")),Y&&(A+="".concat(B," { background: ").concat(f,"; }")),U&&(A+="".concat(c," { background: ").concat(U," !important; }")),N&&(A+="".concat(c," { color: ").concat(N,"; }")),T>=0&&(A+="".concat(c," { border-radius: ").concat(T,"px; }")),G&&(A+="".concat(E," { overflow: ").concat(G," !important; }")),S&&(A+="".concat(l," { background: ").concat(S," !important; border: none !important; }")),H>=0&&(A+="".concat(l," { border-radius: ").concat(H,"px !important; }")),b>=0&&(A+="".concat(l," { border-width: ").concat(b,"px !important; }")),v&&(A+="".concat(w," { background-color: ").concat(v,"; }")),k>=0&&(A+="".concat(w," { border-radius: ").concat(k,"px !important; }")),j&&(A+="".concat(h," { background: ").concat(j," !important; }"),A+="".concat(h," { border: none !important; }")),P&&(A+="".concat(h," { color: ").concat(P," !important; }")),J>=0&&(A+="".concat(h," { border-radius: ").concat(J,"px !important; }")),z>=0&&(A+="".concat(h," { border-width: ").concat(z,"px !important; }")),V&&(A+="".concat(w,' { background-image: url("').concat(encodeURI(V),'") !important; background-repeat: no-repeat; background-size: contain; }'),A+="".concat(L," { visibility: hidden; }")),W&&(A+="".concat(I,", ").concat(M," { border-color: ").concat(W," !important; }"),A+="".concat(M," { box-shadow: none !important; }")),O&&(A+="".concat(C," { color: ").concat(O," !important; }")),_.textContent=A},$=()=>{d="",m="",p="",F="",D="",Y="",f="",N="",U="",y=-1,T=-1,x=-1,R=-1,G="",S="",H=-1,b=-1,v="",k=-1,j="",J=-1,z=-1,L="",P="",O="",V="",W="",q()},AA=(A,e,t)=>{const n=(A=>{const e=document.querySelectorAll(o);for(const t of e)if(t.dataset.id===A)return t;return null})(A);n&&(n.style.transform="translate(".concat(e,"px, ").concat(t,"px)"),n.style.left="0px",n.style.top="0px")},eA=(A,e,t,n,i)=>{const r=A.lookupVariableByNameAndType(e,t);r&&AA(r.id,n,i)};A.exports=class{constructor(A){this.runtime=A,this.runtime.on("RUNTIME_DISPOSED",$)}getInfo(){return{id:"shovelcss",name:"Custom Styles",menuIconURI:"",color1:"#0072d6",color2:"#0064bc",color3:"#01539b",blocks:[{blockIconURI:"",opcode:"changecss",blockType:i.COMMAND,text:"set [COLORABLE] to [COLOR]",arguments:{COLORABLE:{type:n.STRING,menu:"COLORABLE_MENU"},COLOR:{type:n.COLOR,defaultValue:"#ff0000"}}},{blockIconURI:"",opcode:"gradientAngle",blockType:i.REPORTER,text:"make a gradient with [COLOR1] and [COLOR2] at angle [ANGLE]",arguments:{COLOR1:{type:n.COLOR,defaultValue:"#ff0000"},COLOR2:{type:n.COLOR,defaultValue:"#6ed02d"},ANGLE:{type:n.ANGLE,defaultValue:"90"}}},{blockIconURI:"",disableMonitor:!0,opcode:"transparentinput",blockType:i.REPORTER,text:"transparent"},{blockIconURI:Z,disableMonitor:!0,opcode:"pictureinput",blockType:i.REPORTER,text:"image [URL]",arguments:{URL:{type:n.STRING,defaultValue:"https://extensions.turbowarp.org/dango.png"}}},"---",{blockIconURI:Z,disableMonitor:!0,opcode:"setAskURI",blockType:i.COMMAND,text:"set ask prompt button image to [URL]",arguments:{URL:{type:n.STRING,defaultValue:"https://extensions.turbowarp.org/dango.png"}}},"---",{blockIconURI:K,opcode:"setbordersize",blockType:i.COMMAND,text:"set border width of [BORDER] to [SIZE]",arguments:{BORDER:{type:n.STRING,menu:"BORDER_WIDTH_MENU"},SIZE:{type:n.NUMBER,defaultValue:"2"}}},{blockIconURI:K,opcode:"setborderradius",blockType:i.COMMAND,text:"set roundness of [CORNER] to [SIZE]",arguments:{SIZE:{type:n.NUMBER,defaultValue:"4"},CORNER:{type:n.STRING,menu:"BORDER_ROUNDNESS_MENU"}}},"---",{blockIconURI:"",opcode:"clearCSS",blockType:i.COMMAND,text:"reset styles"},"---",{blockIconURI:X,opcode:"allowscrollrule",blockType:i.COMMAND,text:"set list scrolling to [SCROLLRULE]",arguments:{SCROLLRULE:{type:n.STRING,menu:"SCROLL_MENU"}}},{blockIconURI:X,opcode:"getValue",blockType:i.REPORTER,text:"get [ITEM]",arguments:{ITEM:{type:n.STRING,menu:"VALUEGET_LIST"}}},"---",{blockIconURI:X,opcode:"setvarpos",blockType:i.COMMAND,text:"set position of variable [NAME] to x: [X] y: [Y]",arguments:{X:{type:n.NUMBER,defaultValue:"0"},Y:{type:n.NUMBER,defaultValue:"0"},NAME:{type:n.STRING,defaultValue:"my variable"}}},{blockIconURI:X,opcode:"setlistpos",blockType:i.COMMAND,text:"set position of list [NAME] to x: [X] y: [Y]",arguments:{X:{type:n.NUMBER,defaultValue:"0"},Y:{type:n.NUMBER,defaultValue:"0"},NAME:{type:n.STRING,defaultValue:"my variable"}}}],menus:{COLORABLE_MENU:{acceptReporters:!0,items:["monitor text","monitor background","monitor border","variable value background","variable value text","list header background","list footer background","list value background","list value text","ask prompt background","ask prompt button background","ask prompt input background","ask prompt question text","ask prompt input text","ask prompt input border"]},BORDER_WIDTH_MENU:{acceptReporters:!0,items:["monitor background","ask prompt background","ask prompt input"]},BORDER_ROUNDNESS_MENU:{acceptReporters:!0,items:["monitor background","variable value","list value","ask prompt background","ask prompt button","ask prompt input"]},SCROLL_MENU:{acceptReporters:!0,items:["enabled","disabled"]},VALUEGET_LIST:{acceptReporters:!0,items:["monitor text","monitor background","monitor border color","variable value background","variable value text","list header background","list footer background","list value background","list value text","ask prompt background","ask prompt button background","ask prompt input background","ask prompt input text","ask prompt input border","monitor background border width","ask prompt background border width","ask prompt input border width","monitor background roundness","variable value roundness","list value roundness","ask prompt background roundness","ask prompt button roundness","ask prompt input roundness","ask prompt button image","list scroll rule"]}}}}changecss(A){return((A,e)=>{if(A=r.toString(A),/^#?[a-z0-9]+$/.test(A))return void e(A);if(/^[a-z-]+-gradient\([a-z0-9,#%. ]+\)$/i.test(A))return void e(A);const t=A.match(/^url\("([A-Za-z0-9\-_.!~*'();/?:@&=+$,#]+)"\)$/);if(t){const n=t[1];return vm.securityManager.canFetch(n).then(t=>{t&&e(A)})}console.error("Invalid color",A)})(A.COLOR,e=>{"monitor text"===A.COLORABLE?d=e:"monitor background"===A.COLORABLE?p=e:"monitor border"===A.COLORABLE?m=e:"variable value background"===A.COLORABLE?F=e:"variable value text"===A.COLORABLE?D=e:"list header background"===A.COLORABLE?f=e:"list footer background"===A.COLORABLE?Y=e:"list value background"===A.COLORABLE?U=e:"list value text"===A.COLORABLE?N=e:"ask prompt background"===A.COLORABLE?S=e:"ask prompt button background"===A.COLORABLE?v=e:"ask prompt input background"===A.COLORABLE?j=e:"ask prompt input text"===A.COLORABLE?P=e:"ask prompt question text"===A.COLORABLE?O=e:"ask prompt input border"===A.COLORABLE&&(W=e),q()})}gradientAngle(A){return"linear-gradient("+A.ANGLE+"deg,"+A.COLOR1+","+A.COLOR2+")"}setbordersize(A){const e=r.toNumber(A.SIZE);"monitor background"===A.BORDER?R=e:"ask prompt background"===A.BORDER?b=e:"ask prompt input"===A.BORDER&&(z=e),q()}setborderradius(A){const e=r.toNumber(A.SIZE);"monitor background"===A.CORNER?x=e:"variable value"===A.CORNER?y=e:"list value"===A.CORNER?T=e:"ask prompt background"===A.CORNER?H=e:"ask prompt button"===A.CORNER?k=e:"ask prompt input"===A.CORNER&&(J=e),q()}allowscrollrule(A){G="enabled"===A.SCROLLRULE?"auto":"hidden",q()}setvarpos(A,e){eA(e.target,A.NAME,"",r.toNumber(A.X)+this.runtime.stageWidth/2,this.runtime.stageHeight/2-r.toNumber(A.Y))}setlistpos(A,e){eA(e.target,A.NAME,"list",r.toNumber(A.X)+this.runtime.stageWidth/2,this.runtime.stageHeight/2-r.toNumber(A.Y))}help(){alert("\nThis is a short introduction to how to use the Monitor Styles extension!\n\n \nThese blocks change the appearance of the variable and list didsplays. You can use the drop-down menu to select what component you want to modify.    modifieas the color of a component. You can use the  block inside the color input, to create gradients or the  block to use a image instead of solid colors.       ! You can also use the   as a color input, to make components invisible. The   modify the borders of components.\n\n \nThese blocks can change the behaviour of certain components. The   block change the behaviour for lists. On 'auto' they will show the scroll bar, and allow you to school, but on 'hidden', they won't let you do that, and the scroll bar will be hidden.\n\n \nThese blocks allow you to move variable and list displays around. You need to use their  . The label name is the text that displays on the monitor. For example, a 'for this sprite only' variable will be like 'Sprite1: my variable'.")}transparentinput(){return"transparent"}pictureinput(A){return'url("'.concat(encodeURI(A.URL),'")')}clearCSS(){$()}getValue(A){return"monitor text"===A.ITEM?d:"monitor background"===A.ITEM?p:"monitor border color"===A.ITEM?m:"variable value background"===A.ITEM?F:"variable value text"===A.ITEM?D:"list header background"===A.ITEM?f:"list footer background"===A.ITEM?Y:"list value background"===A.ITEM?U:"list value text"===A.ITEM?N:"ask prompt background"===A.ITEM?S:"ask prompt button background"===A.ITEM?v:"ask prompt input background"===A.ITEM?j:"ask prompt input text"===A.ITEM?P:"ask prompt question text"===A.ITEM?O:"ask prompt input border"===A.ITEM?W:"monitor background border width"===A.ITEM?R:"ask prompt background border width"===A.ITEM?b:"ask prompt input border width"===A.ITEM?z:"monitor background roundness"===A.ITEM?x:"variable value roundness"===A.ITEM?y:"list value roundness"===A.ITEM?T:"ask prompt background roundness"===A.ITEM?H:"ask prompt button roundness"===A.ITEM?k:"ask prompt input roundness"===A.ITEM?J:"ask prompt button image"===A.ITEM?V:"list scrolling"===A.ITEM?"auto"===G?"enabled":"disabled":""}setAskURI(A){return this.runtime.vm.securityManager.canFetch(A.URL).then(e=>{e&&(V=A.URL,q())})}}},function(A,e,t){},function(A,e,t){},function(A,e,t){const n=t(9);A.exports=class{constructor(){this.canvases={}}attachRuntime(A){this.runtime=A}getCanvas(A){return this.canvases[A]}deleteCanvas(A){const e=this.canvases[A];return delete this.canvases[A],e}newCanvas(A,e,t,i){e=e||this.runtime.stageWidth,t=t||this.runtime.stageHeight;const r=i||n(),o=document.createElement("canvas");o.id=r,o.width=e,o.height=t;const s={name:A,id:r,element:o,skinId:this.runtime.renderer?this.runtime.renderer.createBitmapSkin(o,1):null,width:e,height:t,context:o.getContext("2d")};return this.canvases[r]=s,s}getCanvasByName(A){return Object.values(this.canvases).find(e=>e.name===A)}getAllCanvases(){return Object.values(this.canvases)}}},function(A,e,t){},function(A,e,t){const n=t(24),i=t(9),r=t(16);class o{constructor(A,e,t){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1];this.id=null!=e?e:i(),this.name=t,this.type="canvas",this.customId=o.customId,this.runtime=A,this.renderer=A.renderer,this.canvas=document.createElement("canvas"),this._costumeDrawer=this.renderer.createDrawable(r.SPRITE_LAYER),this._skinId=this.renderer.createBitmapSkin(this.canvas,1),this._monitorUpToDate=!1,this._cachedMonContent=[null,0],this._cameraStuff={x:0,y:0,rotation:0,scaleX:1,scaleY:1},Array.isArray(n)?this.size=n:n&&this.loadImage(n)}serialize(A){const e=null!=A?A:this;return[e.id,e.name,e.canvas.toDataURL()]}getSnapshot(){const A=new Image;return A.src=this.canvas.toDataURL(),A}toReporterContent(){return this.canvas}toMonitorContent(){return this._monitorUpToDate||(this._cachedMonContent=this.getSnapshot(),this._monitorUpToDate=!0),this._cachedMonContent}toListEditor(){return this.toString()}fromListEditor(A){return this.toString()!==A&&this.loadImage(A),this}toString(){return this.canvas.toDataURL()}toXML(A){return'<variable type="canvas" id="'.concat(this.id,'" islocal="').concat(A,'" iscloud="false">').concat(n(this.name),"</variable>")}toToolboxDefault(A){return'<field name="'.concat(A,'" id="').concat(this.id,'" variabletype="canvas">').concat(n(this.name),"</field>")}get size(){return[this.canvas.width,this.canvas.height]}set size(A){this.canvas.width=A[0],this.canvas.height=A[1]}async loadImage(A){A instanceof Image&&!A.complete&&await new Promise(e=>{A.onload=e,A.onerror=e}),"string"==typeof A&&await new Promise(e=>{const t=A;(A=new Image).onload=e,A.onerror=e,A.src=t}),this.canvas.width=A.width,this.canvas.height=A.height;this.canvas.getContext("2d").drawImage(A,0,0),this.updateCanvasContentRenders()}stampDrawable(A,e,t){if(!this.renderer._allDrawables[A])return;const n=this.renderer.extractDrawableScreenSpace(A);if(!n)return;this.canvas.getContext("2d").putImageData(n.imageData,e,t)}stampCostume(A,e,t,n){const i="__current__"!==e?(()=>{const t=A.getCostumeIndexByName(e),n=A.getCostumes()[t];return this.renderer._allSkins[n.skinId]})():this.renderer._allDrawables[A.drawableID].skin,r=this.canvas.getContext("2d");i._svgImage?r.drawImage(i._svgImage,t,n):i._canvas?r.drawImage(i._canvas,t,n):(this.renderer.updateDrawableSkinId(this._costumeDrawer,i.id),this.stampDrawable(this._costumeDrawer))}updateCanvasContentRenders(){this._monitorUpToDate=!1;const A=Math.max(this.canvas.width,1),e=Math.max(this.canvas.height,1),t=this.canvas.getContext("2d"),n=this.renderer._allSkins[this._skinId],i=t.getImageData(0,0,A,e);n._setTexture(i)}applyCanvasToTarget(A){this.renderer.updateDrawableSkinId(A.drawableID,this._skinId),this.runtime.requestRedraw()}}var s,a,B;s=o,B="canvasData",(a=function(A){var e=function(A,e){if("object"!=typeof A||!A)return A;var t=A[Symbol.toPrimitive];if(void 0!==t){var n=t.call(A,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(A)}(A,"string");return"symbol"==typeof e?e:e+""}(a="customId"))in s?Object.defineProperty(s,a,{value:B,enumerable:!0,configurable:!0,writable:!0}):s[a]=B,A.exports=o},function(A,e,t){},function(A,e,t){},function(A,e,t){},function(A,e,t){},function(A,e,t){
/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */
A.exports=function(){"use strict";const{entries:A,setPrototypeOf:e,isFrozen:t,getPrototypeOf:n,getOwnPropertyDescriptor:i}=Object;let{freeze:r,seal:o,create:s}=Object,{apply:a,construct:B}="undefined"!=typeof Reflect&&Reflect;r||(r=function(A){return A}),o||(o=function(A){return A}),a||(a=function(A,e,t){return A.apply(e,t)}),B||(B=function(A,e){return new A(...e)});const c=D(Array.prototype.forEach),g=D(Array.prototype.lastIndexOf),E=D(Array.prototype.pop),Q=D(Array.prototype.push),u=D(Array.prototype.splice),l=D(String.prototype.toLowerCase),w=D(String.prototype.toString),h=D(String.prototype.match),C=D(String.prototype.replace),I=D(String.prototype.indexOf),M=D(String.prototype.trim),d=D(Object.prototype.hasOwnProperty),m=D(RegExp.prototype.test),p=(F=TypeError,function(){for(var A=arguments.length,e=new Array(A),t=0;t<A;t++)e[t]=arguments[t];return B(F,e)});var F;function D(A){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return a(A,e,n)}}function Y(A,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l;e&&e(A,null);let r=n.length;for(;r--;){let e=n[r];if("string"==typeof e){const A=i(e);A!==e&&(t(n)||(n[r]=A),e=A)}A[e]=!0}return A}function f(A){for(let e=0;e<A.length;e++)d(A,e)||(A[e]=null);return A}function N(e){const t=s(null);for(const[n,i]of A(e))d(e,n)&&(Array.isArray(i)?t[n]=f(i):i&&"object"==typeof i&&i.constructor===Object?t[n]=N(i):t[n]=i);return t}function U(A,e){for(;null!==A;){const t=i(A,e);if(t){if(t.get)return D(t.get);if("function"==typeof t.value)return D(t.value)}A=n(A)}return function(){return null}}const y=r(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),T=r(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),x=r(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),R=r(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),G=r(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),S=r(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),H=r(["#text"]),b=r(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),v=r(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),k=r(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),j=r(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),J=o(/\{\{[\w\W]*|[\w\W]*\}\}/gm),z=o(/<%[\w\W]*|[\w\W]*%>/gm),L=o(/\$\{[\w\W]*/gm),P=o(/^data-[\-\w.\u00B7-\uFFFF]+$/),O=o(/^aria-[\-\w]+$/),V=o(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),W=o(/^(?:\w+script|data):/i),K=o(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),X=o(/^html$/i),Z=o(/^[a-z][.\w]*(-[.\w]+)+$/i);var _=Object.freeze({__proto__:null,ARIA_ATTR:O,ATTR_WHITESPACE:K,CUSTOM_ELEMENT:Z,DATA_ATTR:P,DOCTYPE_NAME:X,ERB_EXPR:z,IS_ALLOWED_URI:V,IS_SCRIPT_OR_DATA:W,MUSTACHE_EXPR:J,TMPLIT_EXPR:L});const q=1,$=3,AA=7,eA=8,tA=9,nA=function(){return"undefined"==typeof window?null:window},iA=function(A,e){if("object"!=typeof A||"function"!=typeof A.createPolicy)return null;let t=null;e&&e.hasAttribute("data-tt-policy-suffix")&&(t=e.getAttribute("data-tt-policy-suffix"));const n="dompurify"+(t?"#"+t:"");try{return A.createPolicy(n,{createHTML:A=>A,createScriptURL:A=>A})}catch(A){return console.warn("TrustedTypes policy "+n+" could not be created."),null}};return function e(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nA();const n=A=>e(A);if(n.version="3.2.6",n.removed=[],!t||!t.document||t.document.nodeType!==tA||!t.Element)return n.isSupported=!1,n;let{document:i}=t;const o=i,a=o.currentScript,{DocumentFragment:B,HTMLTemplateElement:F,Node:D,Element:f,NodeFilter:J,NamedNodeMap:z=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:L,DOMParser:P,trustedTypes:O}=t,W=f.prototype,K=U(W,"cloneNode"),Z=U(W,"remove"),rA=U(W,"nextSibling"),oA=U(W,"childNodes"),sA=U(W,"parentNode");if("function"==typeof F){const A=i.createElement("template");A.content&&A.content.ownerDocument&&(i=A.content.ownerDocument)}let aA,BA="";const{implementation:cA,createNodeIterator:gA,createDocumentFragment:EA,getElementsByTagName:QA}=i,{importNode:uA}=o;let lA={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]};n.isSupported="function"==typeof A&&"function"==typeof sA&&cA&&void 0!==cA.createHTMLDocument;const{MUSTACHE_EXPR:wA,ERB_EXPR:hA,TMPLIT_EXPR:CA,DATA_ATTR:IA,ARIA_ATTR:MA,IS_SCRIPT_OR_DATA:dA,ATTR_WHITESPACE:mA,CUSTOM_ELEMENT:pA}=_;let{IS_ALLOWED_URI:FA}=_,DA=null;const YA=Y({},[...y,...T,...x,...G,...H]);let fA=null;const NA=Y({},[...b,...v,...k,...j]);let UA=Object.seal(s(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),yA=null,TA=null,xA=!0,RA=!0,GA=!1,SA=!0,HA=!1,bA=!0,vA=!1,kA=!1,jA=!1,JA=!1,zA=!1,LA=!1,PA=!0,OA=!1;const VA="user-content-";let WA=!0,KA=!1,XA={},ZA=null;const _A=Y({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let qA=null;const $A=Y({},["audio","video","img","source","image","track"]);let Ae=null;const ee=Y({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),te="http://www.w3.org/1998/Math/MathML",ne="http://www.w3.org/2000/svg",ie="http://www.w3.org/1999/xhtml";let re=ie,oe=!1,se=null;const ae=Y({},[te,ne,ie],w);let Be=Y({},["mi","mo","mn","ms","mtext"]),ce=Y({},["annotation-xml"]);const ge=Y({},["title","style","font","a","script"]);let Ee=null;const Qe=["application/xhtml+xml","text/html"],ue="text/html";let le=null,we=null;const he=i.createElement("form"),Ce=function(A){return A instanceof RegExp||A instanceof Function},Ie=function(){let A=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!we||we!==A){if(A&&"object"==typeof A||(A={}),A=N(A),Ee=-1===Qe.indexOf(A.PARSER_MEDIA_TYPE)?ue:A.PARSER_MEDIA_TYPE,le="application/xhtml+xml"===Ee?w:l,DA=d(A,"ALLOWED_TAGS")?Y({},A.ALLOWED_TAGS,le):YA,fA=d(A,"ALLOWED_ATTR")?Y({},A.ALLOWED_ATTR,le):NA,se=d(A,"ALLOWED_NAMESPACES")?Y({},A.ALLOWED_NAMESPACES,w):ae,Ae=d(A,"ADD_URI_SAFE_ATTR")?Y(N(ee),A.ADD_URI_SAFE_ATTR,le):ee,qA=d(A,"ADD_DATA_URI_TAGS")?Y(N($A),A.ADD_DATA_URI_TAGS,le):$A,ZA=d(A,"FORBID_CONTENTS")?Y({},A.FORBID_CONTENTS,le):_A,yA=d(A,"FORBID_TAGS")?Y({},A.FORBID_TAGS,le):N({}),TA=d(A,"FORBID_ATTR")?Y({},A.FORBID_ATTR,le):N({}),XA=!!d(A,"USE_PROFILES")&&A.USE_PROFILES,xA=!1!==A.ALLOW_ARIA_ATTR,RA=!1!==A.ALLOW_DATA_ATTR,GA=A.ALLOW_UNKNOWN_PROTOCOLS||!1,SA=!1!==A.ALLOW_SELF_CLOSE_IN_ATTR,HA=A.SAFE_FOR_TEMPLATES||!1,bA=!1!==A.SAFE_FOR_XML,vA=A.WHOLE_DOCUMENT||!1,JA=A.RETURN_DOM||!1,zA=A.RETURN_DOM_FRAGMENT||!1,LA=A.RETURN_TRUSTED_TYPE||!1,jA=A.FORCE_BODY||!1,PA=!1!==A.SANITIZE_DOM,OA=A.SANITIZE_NAMED_PROPS||!1,WA=!1!==A.KEEP_CONTENT,KA=A.IN_PLACE||!1,FA=A.ALLOWED_URI_REGEXP||V,re=A.NAMESPACE||ie,Be=A.MATHML_TEXT_INTEGRATION_POINTS||Be,ce=A.HTML_INTEGRATION_POINTS||ce,UA=A.CUSTOM_ELEMENT_HANDLING||{},A.CUSTOM_ELEMENT_HANDLING&&Ce(A.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(UA.tagNameCheck=A.CUSTOM_ELEMENT_HANDLING.tagNameCheck),A.CUSTOM_ELEMENT_HANDLING&&Ce(A.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(UA.attributeNameCheck=A.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),A.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof A.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(UA.allowCustomizedBuiltInElements=A.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),HA&&(RA=!1),zA&&(JA=!0),XA&&(DA=Y({},H),fA=[],!0===XA.html&&(Y(DA,y),Y(fA,b)),!0===XA.svg&&(Y(DA,T),Y(fA,v),Y(fA,j)),!0===XA.svgFilters&&(Y(DA,x),Y(fA,v),Y(fA,j)),!0===XA.mathMl&&(Y(DA,G),Y(fA,k),Y(fA,j))),A.ADD_TAGS&&(DA===YA&&(DA=N(DA)),Y(DA,A.ADD_TAGS,le)),A.ADD_ATTR&&(fA===NA&&(fA=N(fA)),Y(fA,A.ADD_ATTR,le)),A.ADD_URI_SAFE_ATTR&&Y(Ae,A.ADD_URI_SAFE_ATTR,le),A.FORBID_CONTENTS&&(ZA===_A&&(ZA=N(ZA)),Y(ZA,A.FORBID_CONTENTS,le)),WA&&(DA["#text"]=!0),vA&&Y(DA,["html","head","body"]),DA.table&&(Y(DA,["tbody"]),delete yA.tbody),A.TRUSTED_TYPES_POLICY){if("function"!=typeof A.TRUSTED_TYPES_POLICY.createHTML)throw p('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof A.TRUSTED_TYPES_POLICY.createScriptURL)throw p('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');aA=A.TRUSTED_TYPES_POLICY,BA=aA.createHTML("")}else void 0===aA&&(aA=iA(O,a)),null!==aA&&"string"==typeof BA&&(BA=aA.createHTML(""));r&&r(A),we=A}},Me=Y({},[...T,...x,...R]),de=Y({},[...G,...S]),me=function(A){let e=sA(A);e&&e.tagName||(e={namespaceURI:re,tagName:"template"});const t=l(A.tagName),n=l(e.tagName);return!!se[A.namespaceURI]&&(A.namespaceURI===ne?e.namespaceURI===ie?"svg"===t:e.namespaceURI===te?"svg"===t&&("annotation-xml"===n||Be[n]):Boolean(Me[t]):A.namespaceURI===te?e.namespaceURI===ie?"math"===t:e.namespaceURI===ne?"math"===t&&ce[n]:Boolean(de[t]):A.namespaceURI===ie?!(e.namespaceURI===ne&&!ce[n])&&!(e.namespaceURI===te&&!Be[n])&&!de[t]&&(ge[t]||!Me[t]):!("application/xhtml+xml"!==Ee||!se[A.namespaceURI]))},pe=function(A){Q(n.removed,{element:A});try{sA(A).removeChild(A)}catch(e){Z(A)}},Fe=function(A,e){try{Q(n.removed,{attribute:e.getAttributeNode(A),from:e})}catch(A){Q(n.removed,{attribute:null,from:e})}if(e.removeAttribute(A),"is"===A)if(JA||zA)try{pe(e)}catch(A){}else try{e.setAttribute(A,"")}catch(A){}},De=function(A){let e=null,t=null;if(jA)A="<remove></remove>"+A;else{const e=h(A,/^[\r\n\t ]+/);t=e&&e[0]}"application/xhtml+xml"===Ee&&re===ie&&(A='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+A+"</body></html>");const n=aA?aA.createHTML(A):A;if(re===ie)try{e=(new P).parseFromString(n,Ee)}catch(A){}if(!e||!e.documentElement){e=cA.createDocument(re,"template",null);try{e.documentElement.innerHTML=oe?BA:n}catch(A){}}const r=e.body||e.documentElement;return A&&t&&r.insertBefore(i.createTextNode(t),r.childNodes[0]||null),re===ie?QA.call(e,vA?"html":"body")[0]:vA?e.documentElement:r},Ye=function(A){return gA.call(A.ownerDocument||A,A,J.SHOW_ELEMENT|J.SHOW_COMMENT|J.SHOW_TEXT|J.SHOW_PROCESSING_INSTRUCTION|J.SHOW_CDATA_SECTION,null)},fe=function(A){return A instanceof L&&("string"!=typeof A.nodeName||"string"!=typeof A.textContent||"function"!=typeof A.removeChild||!(A.attributes instanceof z)||"function"!=typeof A.removeAttribute||"function"!=typeof A.setAttribute||"string"!=typeof A.namespaceURI||"function"!=typeof A.insertBefore||"function"!=typeof A.hasChildNodes)},Ne=function(A){return"function"==typeof D&&A instanceof D};function Ue(A,e,t){c(A,A=>{A.call(n,e,t,we)})}const ye=function(A){let e=null;if(Ue(lA.beforeSanitizeElements,A,null),fe(A))return pe(A),!0;const t=le(A.nodeName);if(Ue(lA.uponSanitizeElement,A,{tagName:t,allowedTags:DA}),bA&&A.hasChildNodes()&&!Ne(A.firstElementChild)&&m(/<[/\w!]/g,A.innerHTML)&&m(/<[/\w!]/g,A.textContent))return pe(A),!0;if(A.nodeType===AA)return pe(A),!0;if(bA&&A.nodeType===eA&&m(/<[/\w]/g,A.data))return pe(A),!0;if(!DA[t]||yA[t]){if(!yA[t]&&xe(t)){if(UA.tagNameCheck instanceof RegExp&&m(UA.tagNameCheck,t))return!1;if(UA.tagNameCheck instanceof Function&&UA.tagNameCheck(t))return!1}if(WA&&!ZA[t]){const e=sA(A)||A.parentNode,t=oA(A)||A.childNodes;if(t&&e)for(let n=t.length-1;n>=0;--n){const i=K(t[n],!0);i.__removalCount=(A.__removalCount||0)+1,e.insertBefore(i,rA(A))}}return pe(A),!0}return A instanceof f&&!me(A)?(pe(A),!0):"noscript"!==t&&"noembed"!==t&&"noframes"!==t||!m(/<\/no(script|embed|frames)/i,A.innerHTML)?(HA&&A.nodeType===$&&(e=A.textContent,c([wA,hA,CA],A=>{e=C(e,A," ")}),A.textContent!==e&&(Q(n.removed,{element:A.cloneNode()}),A.textContent=e)),Ue(lA.afterSanitizeElements,A,null),!1):(pe(A),!0)},Te=function(A,e,t){if(PA&&("id"===e||"name"===e)&&(t in i||t in he))return!1;if(RA&&!TA[e]&&m(IA,e));else if(xA&&m(MA,e));else if(!fA[e]||TA[e]){if(!(xe(A)&&(UA.tagNameCheck instanceof RegExp&&m(UA.tagNameCheck,A)||UA.tagNameCheck instanceof Function&&UA.tagNameCheck(A))&&(UA.attributeNameCheck instanceof RegExp&&m(UA.attributeNameCheck,e)||UA.attributeNameCheck instanceof Function&&UA.attributeNameCheck(e))||"is"===e&&UA.allowCustomizedBuiltInElements&&(UA.tagNameCheck instanceof RegExp&&m(UA.tagNameCheck,t)||UA.tagNameCheck instanceof Function&&UA.tagNameCheck(t))))return!1}else if(Ae[e]);else if(m(FA,C(t,mA,"")));else if("src"!==e&&"xlink:href"!==e&&"href"!==e||"script"===A||0!==I(t,"data:")||!qA[A])if(GA&&!m(dA,C(t,mA,"")));else if(t)return!1;return!0},xe=function(A){return"annotation-xml"!==A&&h(A,pA)},Re=function(A){Ue(lA.beforeSanitizeAttributes,A,null);const{attributes:e}=A;if(!e||fe(A))return;const t={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:fA,forceKeepAttr:void 0};let i=e.length;for(;i--;){const r=e[i],{name:o,namespaceURI:s,value:a}=r,B=le(o),g=a;let Q="value"===o?g:M(g);if(t.attrName=B,t.attrValue=Q,t.keepAttr=!0,t.forceKeepAttr=void 0,Ue(lA.uponSanitizeAttribute,A,t),Q=t.attrValue,!OA||"id"!==B&&"name"!==B||(Fe(o,A),Q=VA+Q),bA&&m(/((--!?|])>)|<\/(style|title)/i,Q)){Fe(o,A);continue}if(t.forceKeepAttr)continue;if(!t.keepAttr){Fe(o,A);continue}if(!SA&&m(/\/>/i,Q)){Fe(o,A);continue}HA&&c([wA,hA,CA],A=>{Q=C(Q,A," ")});const u=le(A.nodeName);if(Te(u,B,Q)){if(aA&&"object"==typeof O&&"function"==typeof O.getAttributeType)if(s);else switch(O.getAttributeType(u,B)){case"TrustedHTML":Q=aA.createHTML(Q);break;case"TrustedScriptURL":Q=aA.createScriptURL(Q)}if(Q!==g)try{s?A.setAttributeNS(s,o,Q):A.setAttribute(o,Q),fe(A)?pe(A):E(n.removed)}catch(e){Fe(o,A)}}else Fe(o,A)}Ue(lA.afterSanitizeAttributes,A,null)},Ge=function A(e){let t=null;const n=Ye(e);for(Ue(lA.beforeSanitizeShadowDOM,e,null);t=n.nextNode();)Ue(lA.uponSanitizeShadowNode,t,null),ye(t),Re(t),t.content instanceof B&&A(t.content);Ue(lA.afterSanitizeShadowDOM,e,null)};return n.sanitize=function(A){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=null,i=null,r=null,s=null;if(oe=!A,oe&&(A="\x3c!--\x3e"),"string"!=typeof A&&!Ne(A)){if("function"!=typeof A.toString)throw p("toString is not a function");if("string"!=typeof(A=A.toString()))throw p("dirty is not a string, aborting")}if(!n.isSupported)return A;if(kA||Ie(e),n.removed=[],"string"==typeof A&&(KA=!1),KA){if(A.nodeName){const e=le(A.nodeName);if(!DA[e]||yA[e])throw p("root node is forbidden and cannot be sanitized in-place")}}else if(A instanceof D)t=De("\x3c!----\x3e"),i=t.ownerDocument.importNode(A,!0),i.nodeType===q&&"BODY"===i.nodeName||"HTML"===i.nodeName?t=i:t.appendChild(i);else{if(!JA&&!HA&&!vA&&-1===A.indexOf("<"))return aA&&LA?aA.createHTML(A):A;if(t=De(A),!t)return JA?null:LA?BA:""}t&&jA&&pe(t.firstChild);const a=Ye(KA?A:t);for(;r=a.nextNode();)ye(r),Re(r),r.content instanceof B&&Ge(r.content);if(KA)return A;if(JA){if(zA)for(s=EA.call(t.ownerDocument);t.firstChild;)s.appendChild(t.firstChild);else s=t;return(fA.shadowroot||fA.shadowrootmode)&&(s=uA.call(o,s,!0)),s}let g=vA?t.outerHTML:t.innerHTML;return vA&&DA["!doctype"]&&t.ownerDocument&&t.ownerDocument.doctype&&t.ownerDocument.doctype.name&&m(X,t.ownerDocument.doctype.name)&&(g="<!DOCTYPE "+t.ownerDocument.doctype.name+">\n"+g),HA&&c([wA,hA,CA],A=>{g=C(g,A," ")}),aA&&LA?aA.createHTML(g):g},n.setConfig=function(){let A=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Ie(A),kA=!0},n.clearConfig=function(){we=null,kA=!1},n.isValidAttribute=function(A,e,t){we||Ie({});const n=le(A),i=le(e);return Te(n,i,t)},n.addHook=function(A,e){"function"==typeof e&&Q(lA[A],e)},n.removeHook=function(A,e){if(void 0!==e){const t=g(lA[A],e);return-1===t?void 0:u(lA[A],t,1)[0]}return E(lA[A])},n.removeHooks=function(A){lA[A]=[]},n.removeAllHooks=function(){lA={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}},n}()}()},function(A,e,t){},function(A,e,t){},function(A,e,t){},function(A,e,t){const n=t(1),i=t(3),r=t(2);let o=Object.create(null);const s=(A,e)=>({blockType:n.LABEL,text:A,hideFromPalette:e});A.exports=class{constructor(A){this.runtime=A}getInfo(){return{id:"lmsTempVars2",name:"Temporary Variables",color1:"#FF791A",color2:"#E15D00",blocks:[s("Thread Variables",!1),{opcode:"setThreadVariable",blockType:n.COMMAND,text:"set thread var [VAR] to [STRING]",arguments:{VAR:{type:i.STRING,defaultValue:"variable"},STRING:{type:i.STRING,defaultValue:"0"}}},{opcode:"changeThreadVariable",blockType:n.COMMAND,text:"change thread var [VAR] by [NUM]",arguments:{VAR:{type:i.STRING,defaultValue:"variable"},NUM:{type:i.NUMBER,defaultValue:"1"}}},"---",{opcode:"getThreadVariable",blockType:n.REPORTER,text:"thread var [VAR]",disableMonitor:!0,allowDropAnywhere:!0,arguments:{VAR:{type:i.STRING,defaultValue:"variable"}}},{opcode:"threadVariableExists",blockType:n.BOOLEAN,text:"thread var [VAR] exists?",arguments:{VAR:{type:i.STRING,defaultValue:"variable"}}},"---",{opcode:"forEachThreadVariable",blockType:n.LOOP,text:"for [VAR] in [NUM]",arguments:{VAR:{type:i.STRING,defaultValue:"thread variable"},NUM:{type:i.NUMBER,defaultValue:"10"}}},{opcode:"listThreadVariables",blockType:n.REPORTER,text:"active thread variables",disableMonitor:!0},"---",s("Runtime Variables",!1),{opcode:"setRuntimeVariable",blockType:n.COMMAND,text:"set runtime var [VAR] to [STRING]",arguments:{VAR:{type:i.STRING,defaultValue:"variable"},STRING:{type:i.STRING,defaultValue:"0"}}},{opcode:"changeRuntimeVariable",blockType:n.COMMAND,text:"change runtime var [VAR] by [NUM]",arguments:{VAR:{type:i.STRING,defaultValue:"variable"},NUM:{type:i.STRING,defaultValue:"1"}}},"---",{opcode:"getRuntimeVariable",blockType:n.REPORTER,text:"runtime var [VAR]",disableMonitor:!0,allowDropAnywhere:!0,arguments:{VAR:{type:i.STRING,defaultValue:"variable"}}},{opcode:"runtimeVariableExists",blockType:n.BOOLEAN,text:"runtime var [VAR] exists?",arguments:{VAR:{type:i.STRING,defaultValue:"variable"}}},"---",{opcode:"deleteRuntimeVariable",blockType:n.COMMAND,text:"delete runtime var [VAR]",arguments:{VAR:{type:i.STRING,defaultValue:"variable"}}},{opcode:"deleteAllRuntimeVariables",blockType:n.COMMAND,text:"delete all runtime variables"},{opcode:"listRuntimeVariables",blockType:n.REPORTER,text:"active runtime variables"}]}}setThreadVariable(A,e){const t=e.thread;t.variables||(t.variables=Object.create(null));t.variables[A.VAR]=A.STRING}changeThreadVariable(A,e){const t=e.thread;t.variables||(t.variables=Object.create(null));const n=t.variables,i=r.toNumber(n[A.VAR]),o=r.toNumber(A.NUM);n[A.VAR]=i+o}getThreadVariable(A,e){const t=e.thread;t.variables||(t.variables=Object.create(null));const n=t.variables[A.VAR];return void 0===n?"":n}threadVariableExists(A,e){const t=e.thread;t.variables||(t.variables=Object.create(null));return!(void 0===t.variables[A.VAR])}forEachThreadVariable(A,e){const t=e.thread;t.variables||(t.variables=Object.create(null));const n=t.variables;if(void 0===e.stackFrame.index&&(e.stackFrame.index=0),e.stackFrame.index<Number(A.NUM))return e.stackFrame.index++,n[A.VAR]=e.stackFrame.index,!0}listThreadVariables(A,e){const t=e.thread;t.variables||(t.variables=Object.create(null));const n=t.variables;return Object.keys(n).join(",")}setRuntimeVariable(A){o[A.VAR]=A.STRING}changeRuntimeVariable(A){const e=r.toNumber(o[A.VAR]),t=r.toNumber(A.NUM);o[A.VAR]=e+t}getRuntimeVariable(A){return A.VAR in o?o[A.VAR]:""}runtimeVariableExists(A){return A.VAR in o}listRuntimeVariables(A,e){return Object.keys(this.runtime.variables).join(",")}deleteRuntimeVariable(A){Reflect.deleteProperty(o,A.VAR)}deleteAllRuntimeVariables(){o=Object.create(null)}}},function(A,e,t){},function(A,e,t){},function(A,e,t){},function(A,e){var t=function(A){null==A&&(A=(new Date).getTime()),this.N=624,this.M=397,this.MATRIX_A=2567483615,this.UPPER_MASK=2147483648,this.LOWER_MASK=2147483647,this.mt=new Array(this.N),this.mti=this.N+1,A.constructor==Array?this.init_by_array(A,A.length):this.init_seed(A)};t.prototype.init_seed=function(A){for(this.mt[0]=A>>>0,this.mti=1;this.mti<this.N;this.mti++){A=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30;this.mt[this.mti]=(1812433253*((4294901760&A)>>>16)<<16)+1812433253*(65535&A)+this.mti,this.mt[this.mti]>>>=0}},t.prototype.init_by_array=function(A,e){var t,n,i;for(this.init_seed(19650218),t=1,n=0,i=this.N>e?this.N:e;i;i--){var r=this.mt[t-1]^this.mt[t-1]>>>30;this.mt[t]=(this.mt[t]^(1664525*((4294901760&r)>>>16)<<16)+1664525*(65535&r))+A[n]+n,this.mt[t]>>>=0,n++,++t>=this.N&&(this.mt[0]=this.mt[this.N-1],t=1),n>=e&&(n=0)}for(i=this.N-1;i;i--){r=this.mt[t-1]^this.mt[t-1]>>>30;this.mt[t]=(this.mt[t]^(1566083941*((4294901760&r)>>>16)<<16)+1566083941*(65535&r))-t,this.mt[t]>>>=0,++t>=this.N&&(this.mt[0]=this.mt[this.N-1],t=1)}this.mt[0]=2147483648},t.prototype.random_int=function(){var A,e=new Array(0,this.MATRIX_A);if(this.mti>=this.N){var t;for(this.mti==this.N+1&&this.init_seed(5489),t=0;t<this.N-this.M;t++)A=this.mt[t]&this.UPPER_MASK|this.mt[t+1]&this.LOWER_MASK,this.mt[t]=this.mt[t+this.M]^A>>>1^e[1&A];for(;t<this.N-1;t++)A=this.mt[t]&this.UPPER_MASK|this.mt[t+1]&this.LOWER_MASK,this.mt[t]=this.mt[t+(this.M-this.N)]^A>>>1^e[1&A];A=this.mt[this.N-1]&this.UPPER_MASK|this.mt[0]&this.LOWER_MASK,this.mt[this.N-1]=this.mt[this.M-1]^A>>>1^e[1&A],this.mti=0}return A=this.mt[this.mti++],A^=A>>>11,A^=A<<7&2636928640,A^=A<<15&4022730752,(A^=A>>>18)>>>0},t.prototype.random_int31=function(){return this.random_int()>>>1},t.prototype.random_incl=function(){return this.random_int()*(1/4294967295)},t.prototype.random=function(){return this.random_int()*(1/4294967296)},t.prototype.random_excl=function(){return(this.random_int()+.5)*(1/4294967296)},t.prototype.random_long=function(){return(67108864*(this.random_int()>>>5)+(this.random_int()>>>6))*(1/9007199254740992)},A.exports=t},function(A,e,t){"use strict";t.r(e),t.d(e,"createNoise2D",(function(){return u})),t.d(e,"createNoise3D",(function(){return l})),t.d(e,"createNoise4D",(function(){return w})),t.d(e,"buildPermutationTable",(function(){return h}));const n=Math.sqrt(3),i=Math.sqrt(5),r=.5*(n-1),o=(3-n)/6,s=1/6,a=(i-1)/4,B=(5-i)/20,c=A=>0|Math.floor(A),g=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]),E=new Float64Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]),Q=new Float64Array([0,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,1,0,1,1,1,0,1,-1,1,0,-1,1,1,0,-1,-1,-1,0,1,1,-1,0,1,-1,-1,0,-1,1,-1,0,-1,-1,1,1,0,1,1,1,0,-1,1,-1,0,1,1,-1,0,-1,-1,1,0,1,-1,1,0,-1,-1,-1,0,1,-1,-1,0,-1,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,0]);function u(){let A=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Math.random;const e=h(A),t=new Float64Array(e).map(A=>g[A%12*2]),n=new Float64Array(e).map(A=>g[A%12*2+1]);return function(A,i){let s=0,a=0,B=0;const g=(A+i)*r,E=c(A+g),Q=c(i+g),u=(E+Q)*o,l=A-(E-u),w=i-(Q-u);let h,C;l>w?(h=1,C=0):(h=0,C=1);const I=l-h+o,M=w-C+o,d=l-1+2*o,m=w-1+2*o,p=255&E,F=255&Q;let D=.5-l*l-w*w;if(D>=0){const A=p+e[F];D*=D,s=D*D*(t[A]*l+n[A]*w)}let Y=.5-I*I-M*M;if(Y>=0){const A=p+h+e[F+C];Y*=Y,a=Y*Y*(t[A]*I+n[A]*M)}let f=.5-d*d-m*m;if(f>=0){const A=p+1+e[F+1];f*=f,B=f*f*(t[A]*d+n[A]*m)}return 70*(s+a+B)}}function l(){let A=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Math.random;const e=h(A),t=new Float64Array(e).map(A=>E[A%12*3]),n=new Float64Array(e).map(A=>E[A%12*3+1]),i=new Float64Array(e).map(A=>E[A%12*3+2]);return function(A,r,o){let a,B,g,E;const Q=(A+r+o)*(1/3),u=c(A+Q),l=c(r+Q),w=c(o+Q),h=(u+l+w)*s,C=A-(u-h),I=r-(l-h),M=o-(w-h);let d,m,p,F,D,Y;C>=I?I>=M?(d=1,m=0,p=0,F=1,D=1,Y=0):C>=M?(d=1,m=0,p=0,F=1,D=0,Y=1):(d=0,m=0,p=1,F=1,D=0,Y=1):I<M?(d=0,m=0,p=1,F=0,D=1,Y=1):C<M?(d=0,m=1,p=0,F=0,D=1,Y=1):(d=0,m=1,p=0,F=1,D=1,Y=0);const f=C-d+s,N=I-m+s,U=M-p+s,y=C-F+2*s,T=I-D+2*s,x=M-Y+2*s,R=C-1+.5,G=I-1+.5,S=M-1+.5,H=255&u,b=255&l,v=255&w;let k=.6-C*C-I*I-M*M;if(k<0)a=0;else{const A=H+e[b+e[v]];k*=k,a=k*k*(t[A]*C+n[A]*I+i[A]*M)}let j=.6-f*f-N*N-U*U;if(j<0)B=0;else{const A=H+d+e[b+m+e[v+p]];j*=j,B=j*j*(t[A]*f+n[A]*N+i[A]*U)}let J=.6-y*y-T*T-x*x;if(J<0)g=0;else{const A=H+F+e[b+D+e[v+Y]];J*=J,g=J*J*(t[A]*y+n[A]*T+i[A]*x)}let z=.6-R*R-G*G-S*S;if(z<0)E=0;else{const A=H+1+e[b+1+e[v+1]];z*=z,E=z*z*(t[A]*R+n[A]*G+i[A]*S)}return 32*(a+B+g+E)}}function w(){let A=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Math.random;const e=h(A),t=new Float64Array(e).map(A=>Q[A%32*4]),n=new Float64Array(e).map(A=>Q[A%32*4+1]),i=new Float64Array(e).map(A=>Q[A%32*4+2]),r=new Float64Array(e).map(A=>Q[A%32*4+3]);return function(A,o,s,g){let E,Q,u,l,w;const h=(A+o+s+g)*a,C=c(A+h),I=c(o+h),M=c(s+h),d=c(g+h),m=(C+I+M+d)*B,p=A-(C-m),F=o-(I-m),D=s-(M-m),Y=g-(d-m);let f=0,N=0,U=0,y=0;p>F?f++:N++,p>D?f++:U++,p>Y?f++:y++,F>D?N++:U++,F>Y?N++:y++,D>Y?U++:y++;const T=f>=3?1:0,x=N>=3?1:0,R=U>=3?1:0,G=y>=3?1:0,S=f>=2?1:0,H=N>=2?1:0,b=U>=2?1:0,v=y>=2?1:0,k=f>=1?1:0,j=N>=1?1:0,J=U>=1?1:0,z=y>=1?1:0,L=p-T+B,P=F-x+B,O=D-R+B,V=Y-G+B,W=p-S+2*B,K=F-H+2*B,X=D-b+2*B,Z=Y-v+2*B,_=p-k+3*B,q=F-j+3*B,$=D-J+3*B,AA=Y-z+3*B,eA=p-1+4*B,tA=F-1+4*B,nA=D-1+4*B,iA=Y-1+4*B,rA=255&C,oA=255&I,sA=255&M,aA=255&d;let BA=.6-p*p-F*F-D*D-Y*Y;if(BA<0)E=0;else{const A=rA+e[oA+e[sA+e[aA]]];BA*=BA,E=BA*BA*(t[A]*p+n[A]*F+i[A]*D+r[A]*Y)}let cA=.6-L*L-P*P-O*O-V*V;if(cA<0)Q=0;else{const A=rA+T+e[oA+x+e[sA+R+e[aA+G]]];cA*=cA,Q=cA*cA*(t[A]*L+n[A]*P+i[A]*O+r[A]*V)}let gA=.6-W*W-K*K-X*X-Z*Z;if(gA<0)u=0;else{const A=rA+S+e[oA+H+e[sA+b+e[aA+v]]];gA*=gA,u=gA*gA*(t[A]*W+n[A]*K+i[A]*X+r[A]*Z)}let EA=.6-_*_-q*q-$*$-AA*AA;if(EA<0)l=0;else{const A=rA+k+e[oA+j+e[sA+J+e[aA+z]]];EA*=EA,l=EA*EA*(t[A]*_+n[A]*q+i[A]*$+r[A]*AA)}let QA=.6-eA*eA-tA*tA-nA*nA-iA*iA;if(QA<0)w=0;else{const A=rA+1+e[oA+1+e[sA+1+e[aA+1]]];QA*=QA,w=QA*QA*(t[A]*eA+n[A]*tA+i[A]*nA+r[A]*iA)}return 27*(E+Q+u+l+w)}}function h(A){const e=new Uint8Array(512);for(let A=0;A<256;A++)e[A]=A;for(let t=0;t<255;t++){const n=t+~~(A()*(256-t)),i=e[t];e[t]=e[n],e[n]=i}for(let A=256;A<512;A++)e[A]=e[A-256];return e}},function(A,e,t){},function(A,e,t){A.exports=function A(e,t,n){function i(o,s){if(!t[o]){if(!e[o]){if(r)return r(o,!0);throw new Error("Cannot find module '"+o+"'")}var a=t[o]={exports:{}};e[o][0].call(a.exports,(function(A){var t=e[o][1][A];return i(t||A)}),a,a.exports,A,e,t,n)}return t[o].exports}for(var r=!1,o=0;o<n.length;o++)i(n[o]);return i}({1:[function(A,e){e.exports={name:"cannon",version:"0.6.2",description:"A lightweight 3D physics engine written in JavaScript.",homepage:"https://github.com/schteppe/cannon.js",author:"Stefan Hedman <schteppe@gmail.com> (http://steffe.se)",keywords:["cannon.js","cannon","physics","engine","3d"],main:"./build/cannon.js",engines:{node:"*"},repository:{type:"git",url:"https://github.com/schteppe/cannon.js.git"},bugs:{url:"https://github.com/schteppe/cannon.js/issues"},licenses:[{type:"MIT"}],devDependencies:{jshint:"latest","uglify-js":"latest",nodeunit:"^0.9.0",grunt:"~0.4.0","grunt-contrib-jshint":"~0.1.1","grunt-contrib-nodeunit":"^0.4.1","grunt-contrib-concat":"~0.1.3","grunt-contrib-uglify":"^0.5.1","grunt-browserify":"^2.1.4","grunt-contrib-yuidoc":"^0.5.2",browserify:"*"},dependencies:{}}},{}],2:[function(A,e){e.exports={version:A("../package.json").version,AABB:A("./collision/AABB"),ArrayCollisionMatrix:A("./collision/ArrayCollisionMatrix"),Body:A("./objects/Body"),Box:A("./shapes/Box"),Broadphase:A("./collision/Broadphase"),Constraint:A("./constraints/Constraint"),ContactEquation:A("./equations/ContactEquation"),Narrowphase:A("./world/Narrowphase"),ConeTwistConstraint:A("./constraints/ConeTwistConstraint"),ContactMaterial:A("./material/ContactMaterial"),ConvexPolyhedron:A("./shapes/ConvexPolyhedron"),Cylinder:A("./shapes/Cylinder"),DistanceConstraint:A("./constraints/DistanceConstraint"),Equation:A("./equations/Equation"),EventTarget:A("./utils/EventTarget"),FrictionEquation:A("./equations/FrictionEquation"),GSSolver:A("./solver/GSSolver"),GridBroadphase:A("./collision/GridBroadphase"),Heightfield:A("./shapes/Heightfield"),HingeConstraint:A("./constraints/HingeConstraint"),LockConstraint:A("./constraints/LockConstraint"),Mat3:A("./math/Mat3"),Material:A("./material/Material"),NaiveBroadphase:A("./collision/NaiveBroadphase"),ObjectCollisionMatrix:A("./collision/ObjectCollisionMatrix"),Pool:A("./utils/Pool"),Particle:A("./shapes/Particle"),Plane:A("./shapes/Plane"),PointToPointConstraint:A("./constraints/PointToPointConstraint"),Quaternion:A("./math/Quaternion"),Ray:A("./collision/Ray"),RaycastVehicle:A("./objects/RaycastVehicle"),RaycastResult:A("./collision/RaycastResult"),RigidVehicle:A("./objects/RigidVehicle"),RotationalEquation:A("./equations/RotationalEquation"),RotationalMotorEquation:A("./equations/RotationalMotorEquation"),SAPBroadphase:A("./collision/SAPBroadphase"),SPHSystem:A("./objects/SPHSystem"),Shape:A("./shapes/Shape"),Solver:A("./solver/Solver"),Sphere:A("./shapes/Sphere"),SplitSolver:A("./solver/SplitSolver"),Spring:A("./objects/Spring"),Trimesh:A("./shapes/Trimesh"),Vec3:A("./math/Vec3"),Vec3Pool:A("./utils/Vec3Pool"),World:A("./world/World")}},{"../package.json":1,"./collision/AABB":3,"./collision/ArrayCollisionMatrix":4,"./collision/Broadphase":5,"./collision/GridBroadphase":6,"./collision/NaiveBroadphase":7,"./collision/ObjectCollisionMatrix":8,"./collision/Ray":9,"./collision/RaycastResult":10,"./collision/SAPBroadphase":11,"./constraints/ConeTwistConstraint":12,"./constraints/Constraint":13,"./constraints/DistanceConstraint":14,"./constraints/HingeConstraint":15,"./constraints/LockConstraint":16,"./constraints/PointToPointConstraint":17,"./equations/ContactEquation":19,"./equations/Equation":20,"./equations/FrictionEquation":21,"./equations/RotationalEquation":22,"./equations/RotationalMotorEquation":23,"./material/ContactMaterial":24,"./material/Material":25,"./math/Mat3":27,"./math/Quaternion":28,"./math/Vec3":30,"./objects/Body":31,"./objects/RaycastVehicle":32,"./objects/RigidVehicle":33,"./objects/SPHSystem":34,"./objects/Spring":35,"./shapes/Box":37,"./shapes/ConvexPolyhedron":38,"./shapes/Cylinder":39,"./shapes/Heightfield":40,"./shapes/Particle":41,"./shapes/Plane":42,"./shapes/Shape":43,"./shapes/Sphere":44,"./shapes/Trimesh":45,"./solver/GSSolver":46,"./solver/Solver":47,"./solver/SplitSolver":48,"./utils/EventTarget":49,"./utils/Pool":51,"./utils/Vec3Pool":54,"./world/Narrowphase":55,"./world/World":56}],3:[function(A,e){function t(A){A=A||{},this.lowerBound=new n,A.lowerBound&&this.lowerBound.copy(A.lowerBound),this.upperBound=new n,A.upperBound&&this.upperBound.copy(A.upperBound)}var n=A("../math/Vec3");A("../utils/Utils"),e.exports=t;var i=new n;t.prototype.setFromPoints=function(A,e,t,n){var r=this.lowerBound,o=this.upperBound,s=t;r.copy(A[0]),s&&s.vmult(r,r),o.copy(r);for(var a=1;a<A.length;a++){var B=A[a];s&&(s.vmult(B,i),B=i),B.x>o.x&&(o.x=B.x),B.x<r.x&&(r.x=B.x),B.y>o.y&&(o.y=B.y),B.y<r.y&&(r.y=B.y),B.z>o.z&&(o.z=B.z),B.z<r.z&&(r.z=B.z)}return e&&(e.vadd(r,r),e.vadd(o,o)),n&&(r.x-=n,r.y-=n,r.z-=n,o.x+=n,o.y+=n,o.z+=n),this},t.prototype.copy=function(A){return this.lowerBound.copy(A.lowerBound),this.upperBound.copy(A.upperBound),this},t.prototype.clone=function(){return(new t).copy(this)},t.prototype.extend=function(A){var e=A.lowerBound.x;this.lowerBound.x>e&&(this.lowerBound.x=e);var t=A.upperBound.x;this.upperBound.x<t&&(this.upperBound.x=t),e=A.lowerBound.y,this.lowerBound.y>e&&(this.lowerBound.y=e),t=A.upperBound.y,this.upperBound.y<t&&(this.upperBound.y=t),e=A.lowerBound.z,this.lowerBound.z>e&&(this.lowerBound.z=e),t=A.upperBound.z,this.upperBound.z<t&&(this.upperBound.z=t)},t.prototype.overlaps=function(A){var e=this.lowerBound,t=this.upperBound,n=A.lowerBound,i=A.upperBound;return(n.x<=t.x&&t.x<=i.x||e.x<=i.x&&i.x<=t.x)&&(n.y<=t.y&&t.y<=i.y||e.y<=i.y&&i.y<=t.y)&&(n.z<=t.z&&t.z<=i.z||e.z<=i.z&&i.z<=t.z)},t.prototype.contains=function(A){var e=this.lowerBound,t=this.upperBound,n=A.lowerBound,i=A.upperBound;return e.x<=n.x&&t.x>=i.x&&e.y<=n.y&&t.y>=i.y&&e.z<=n.z&&t.z>=i.z},t.prototype.getCorners=function(A,e,t,n,i,r,o,s){var a=this.lowerBound,B=this.upperBound;A.copy(a),e.set(B.x,a.y,a.z),t.set(B.x,B.y,a.z),n.set(a.x,B.y,B.z),i.set(B.x,a.y,a.z),r.set(a.x,B.y,a.z),o.set(a.x,a.y,B.z),s.copy(B)};var r=[new n,new n,new n,new n,new n,new n,new n,new n];t.prototype.toLocalFrame=function(A,e){var t=r,n=t[0],i=t[1],o=t[2],s=t[3],a=t[4],B=t[5],c=t[6],g=t[7];this.getCorners(n,i,o,s,a,B,c,g);for(var E=0;8!==E;E++){var Q=t[E];A.pointToLocal(Q,Q)}return e.setFromPoints(t)},t.prototype.toWorldFrame=function(A,e){var t=r,n=t[0],i=t[1],o=t[2],s=t[3],a=t[4],B=t[5],c=t[6],g=t[7];this.getCorners(n,i,o,s,a,B,c,g);for(var E=0;8!==E;E++){var Q=t[E];A.pointToWorld(Q,Q)}return e.setFromPoints(t)}},{"../math/Vec3":30,"../utils/Utils":53}],4:[function(A,e){function t(){this.matrix=[]}e.exports=t,t.prototype.get=function(A,e){if(A=A.index,(e=e.index)>A){var t=e;e=A,A=t}return this.matrix[(A*(A+1)>>1)+e-1]},t.prototype.set=function(A,e,t){if(A=A.index,(e=e.index)>A){var n=e;e=A,A=n}this.matrix[(A*(A+1)>>1)+e-1]=t?1:0},t.prototype.reset=function(){for(var A=0,e=this.matrix.length;A!==e;A++)this.matrix[A]=0},t.prototype.setNumObjects=function(A){this.matrix.length=A*(A-1)>>1}},{}],5:[function(A,e){function t(){this.world=null,this.useBoundingBoxes=!1,this.dirty=!0}var n=A("../objects/Body"),i=A("../math/Vec3"),r=A("../math/Quaternion");A("../shapes/Shape"),A("../shapes/Plane"),e.exports=t,t.prototype.collisionPairs=function(){throw new Error("collisionPairs not implemented for this BroadPhase class!")};var o=n.STATIC|n.KINEMATIC;t.prototype.needBroadphaseCollision=function(A,e){return 0!=(A.collisionFilterGroup&e.collisionFilterMask)&&0!=(e.collisionFilterGroup&A.collisionFilterMask)&&(0==(A.type&o)&&A.sleepState!==n.SLEEPING||0==(e.type&o)&&e.sleepState!==n.SLEEPING)},t.prototype.intersectionTest=function(A,e,t,n){this.useBoundingBoxes?this.doBoundingBoxBroadphase(A,e,t,n):this.doBoundingSphereBroadphase(A,e,t,n)};var s=new i;new i,new r,new i,t.prototype.doBoundingSphereBroadphase=function(A,e,t,n){var i=s;e.position.vsub(A.position,i),Math.pow(A.boundingRadius+e.boundingRadius,2)>i.norm2()&&(t.push(A),n.push(e))},t.prototype.doBoundingBoxBroadphase=function(A,e,t,n){A.aabbNeedsUpdate&&A.computeAABB(),e.aabbNeedsUpdate&&e.computeAABB(),A.aabb.overlaps(e.aabb)&&(t.push(A),n.push(e))};var a={keys:[]},B=[],c=[];t.prototype.makePairsUnique=function(A,e){for(var t=a,n=B,i=c,r=A.length,o=0;o!==r;o++)n[o]=A[o],i[o]=e[o];for(A.length=0,e.length=0,o=0;o!==r;o++){var s=n[o].id,g=i[o].id;t[E=g>s?s+","+g:g+","+s]=o,t.keys.push(E)}for(o=0;o!==t.keys.length;o++){var E=t.keys.pop(),Q=t[E];A.push(n[Q]),e.push(i[Q]),delete t[E]}},t.prototype.setWorld=function(){};var g=new i;t.boundingSphereCheck=function(A,e){var t=g;return A.position.vsub(e.position,t),Math.pow(A.shape.boundingSphereRadius+e.shape.boundingSphereRadius,2)>t.norm2()},t.prototype.aabbQuery=function(){return console.warn(".aabbQuery is not implemented in this Broadphase subclass."),[]}},{"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Plane":42,"../shapes/Shape":43}],6:[function(A,e){function t(A,e,t,r,o){n.apply(this),this.nx=t||10,this.ny=r||10,this.nz=o||10,this.aabbMin=A||new i(100,100,100),this.aabbMax=e||new i(-100,-100,-100);var s=this.nx*this.ny*this.nz;if(0>=s)throw"GridBroadphase: Each dimension's n must be >0";this.bins=[],this.binLengths=[],this.bins.length=s,this.binLengths.length=s;for(var a=0;s>a;a++)this.bins[a]=[],this.binLengths[a]=0}e.exports=t;var n=A("./Broadphase"),i=A("../math/Vec3"),r=A("../shapes/Shape");t.prototype=new n,t.prototype.constructor=t;var o=new i;new i,t.prototype.collisionPairs=function(A,e,t){function n(A,e,t,n,i,r,o){var s=(A-I)*m|0,a=(e-M)*p|0,B=(t-d)*F|0,w=H((n-I)*m),h=H((i-M)*p),C=H((r-d)*F);0>s?s=0:s>=c&&(s=c-1),0>a?a=0:a>=g&&(a=g-1),0>B?B=0:B>=E&&(B=E-1),0>w?w=0:w>=c&&(w=c-1),0>h?h=0:h>=g&&(h=g-1),0>C?C=0:C>=E&&(C=E-1),a*=u,B*=l,w*=Q,h*=u,C*=l;for(var D=s*=Q;w>=D;D+=Q)for(var Y=a;h>=Y;Y+=u)for(var f=B;C>=f;f+=l){var N=D+Y+f;x[N][R[N]++]=o}}for(var i=A.numObjects(),s=A.bodies,a=this.aabbMax,B=this.aabbMin,c=this.nx,g=this.ny,E=this.nz,Q=g*E,u=E,l=1,w=a.x,h=a.y,C=a.z,I=B.x,M=B.y,d=B.z,m=c/(w-I),p=g/(h-M),F=E/(C-d),D=(w-I)/c,Y=(h-M)/g,f=(C-d)/E,N=.5*Math.sqrt(D*D+Y*Y+f*f),U=r.types,y=U.SPHERE,T=U.PLANE,x=(U.BOX,U.COMPOUND,U.CONVEXPOLYHEDRON,this.bins),R=this.binLengths,G=this.bins.length,S=0;S!==G;S++)R[S]=0;var H=Math.ceil;for(B=Math.min,a=Math.max,S=0;S!==i;S++){var b=(tA=s[S]).shape;switch(b.type){case y:var v=tA.position.x,k=tA.position.y,j=tA.position.z,J=b.radius;n(v-J,k-J,j-J,v+J,k+J,j+J,tA);break;case T:b.worldNormalNeedsUpdate&&b.computeWorldNormal(tA.quaternion);var z=b.worldNormal,L=I+.5*D-tA.position.x,P=M+.5*Y-tA.position.y,O=d+.5*f-tA.position.z,V=o;V.set(L,P,O);for(var W=0,K=0;W!==c;W++,K+=Q,V.y=P,V.x+=D)for(var X=0,Z=0;X!==g;X++,Z+=u,V.z=O,V.y+=Y)for(var _=0,q=0;_!==E;_++,q+=l,V.z+=f)if(V.dot(z)<N){var $=K+Z+q;x[$][R[$]++]=tA}break;default:tA.aabbNeedsUpdate&&tA.computeAABB(),n(tA.aabb.lowerBound.x,tA.aabb.lowerBound.y,tA.aabb.lowerBound.z,tA.aabb.upperBound.x,tA.aabb.upperBound.y,tA.aabb.upperBound.z,tA)}}for(S=0;S!==G;S++){var AA=R[S];if(AA>1){var eA=x[S];for(W=0;W!==AA;W++){var tA=eA[W];for(X=0;X!==W;X++){var nA=eA[X];this.needBroadphaseCollision(tA,nA)&&this.intersectionTest(tA,nA,e,t)}}}}this.makePairsUnique(e,t)}},{"../math/Vec3":30,"../shapes/Shape":43,"./Broadphase":5}],7:[function(A,e){function t(){n.apply(this)}e.exports=t;var n=A("./Broadphase"),i=A("./AABB");t.prototype=new n,t.prototype.constructor=t,t.prototype.collisionPairs=function(A,e,t){var n,i,r,o,s=A.bodies,a=s.length;for(n=0;n!==a;n++)for(i=0;i!==n;i++)r=s[n],o=s[i],this.needBroadphaseCollision(r,o)&&this.intersectionTest(r,o,e,t)},new i,t.prototype.aabbQuery=function(A,e,t){t=t||[];for(var n=0;n<A.bodies.length;n++){var i=A.bodies[n];i.aabbNeedsUpdate&&i.computeAABB(),i.aabb.overlaps(e)&&t.push(i)}return t}},{"./AABB":3,"./Broadphase":5}],8:[function(A,e){function t(){this.matrix={}}e.exports=t,t.prototype.get=function(A,e){if(A=A.id,(e=e.id)>A){var t=e;e=A,A=t}return A+"-"+e in this.matrix},t.prototype.set=function(A,e,t){if(A=A.id,(e=e.id)>A){var n=e;e=A,A=n}t?this.matrix[A+"-"+e]=!0:delete this.matrix[A+"-"+e]},t.prototype.reset=function(){this.matrix={}},t.prototype.setNumObjects=function(){}},{}],9:[function(A,e){function t(A,e){this.from=A?A.clone():new i,this.to=e?e.clone():new i,this._direction=new i,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=t.ANY,this.result=new s,this.hasHit=!1,this.callback=function(){}}function n(A,e,t,n){n.vsub(e,R),t.vsub(e,E),A.vsub(e,Q);var i,r,o=R.dot(R),s=R.dot(E),a=R.dot(Q),B=E.dot(E),c=E.dot(Q);return(i=B*a-s*c)>=0&&(r=o*c-s*a)>=0&&o*B-s*s>i+r}e.exports=t;var i=A("../math/Vec3"),r=A("../math/Quaternion"),o=A("../math/Transform"),s=(A("../shapes/ConvexPolyhedron"),A("../shapes/Box"),A("../collision/RaycastResult")),a=A("../shapes/Shape"),B=A("../collision/AABB");t.prototype.constructor=t,t.CLOSEST=1,t.ANY=2,t.ALL=4;var c=new B,g=[];t.prototype.intersectWorld=function(A,e){return this.mode=e.mode||t.ANY,this.result=e.result||new s,this.skipBackfaces=!!e.skipBackfaces,this.collisionFilterMask=void 0!==e.collisionFilterMask?e.collisionFilterMask:-1,this.collisionFilterGroup=void 0!==e.collisionFilterGroup?e.collisionFilterGroup:-1,e.from&&this.from.copy(e.from),e.to&&this.to.copy(e.to),this.callback=e.callback||function(){},this.hasHit=!1,this.result.reset(),this._updateDirection(),this.getAABB(c),g.length=0,A.broadphase.aabbQuery(A,c,g),this.intersectBodies(g),this.hasHit};var E=new i,Q=new i;t.pointInTriangle=n;var u=new i,l=new r;t.prototype.intersectBody=function(A,e){e&&(this.result=e,this._updateDirection());var t=this.checkCollisionResponse;if((!t||A.collisionResponse)&&0!=(this.collisionFilterGroup&A.collisionFilterMask)&&0!=(A.collisionFilterGroup&this.collisionFilterMask))for(var n=u,i=l,r=0,o=A.shapes.length;o>r;r++){var s=A.shapes[r];if((!t||s.collisionResponse)&&(A.quaternion.mult(A.shapeOrientations[r],i),A.quaternion.vmult(A.shapeOffsets[r],n),n.vadd(A.position,n),this.intersectShape(s,i,n,A),this.result._shouldStop))break}},t.prototype.intersectBodies=function(A,e){e&&(this.result=e,this._updateDirection());for(var t=0,n=A.length;!this.result._shouldStop&&n>t;t++)this.intersectBody(A[t])},t.prototype._updateDirection=function(){this.to.vsub(this.from,this._direction),this._direction.normalize()},t.prototype.intersectShape=function(A,e,t,n){if(!(function(A,e,t){t.vsub(A,R);var n=R.dot(e);return e.mult(n,G),G.vadd(A,G),t.distanceTo(G)}(this.from,this._direction,t)>A.boundingSphereRadius)){var i=this[A.type];i&&i.call(this,A,e,t,n)}};var w=(new i,new i,new i),h=new i,C=new i,I=new i;new i,new s,t.prototype.intersectBox=function(A,e,t,n){return this.intersectConvex(A.convexPolyhedronRepresentation,e,t,n)},t.prototype[a.types.BOX]=t.prototype.intersectBox,t.prototype.intersectPlane=function(A,e,t,n){var r=this.from,o=this.to,s=this._direction,a=new i(0,0,1);e.vmult(a,a);var B=new i;r.vsub(t,B);var c=B.dot(a);if(o.vsub(t,B),!(c*B.dot(a)>0||r.distanceTo(o)<c)){var g=a.dot(s);if(!(Math.abs(g)<this.precision)){var E=new i,Q=new i,u=new i;r.vsub(t,E);var l=-a.dot(E)/g;s.scale(l,Q),r.vadd(Q,u),this.reportIntersection(a,u,A,n,-1)}}},t.prototype[a.types.PLANE]=t.prototype.intersectPlane,t.prototype.getAABB=function(A){var e=this.to,t=this.from;A.lowerBound.x=Math.min(e.x,t.x),A.lowerBound.y=Math.min(e.y,t.y),A.lowerBound.z=Math.min(e.z,t.z),A.upperBound.x=Math.max(e.x,t.x),A.upperBound.y=Math.max(e.y,t.y),A.upperBound.z=Math.max(e.z,t.z)};var M={faceList:[0]};t.prototype.intersectHeightfield=function(A,e,n,r){var s=(A.data,A.elementSize,new i),a=new t(this.from,this.to);o.pointToLocalFrame(n,e,a.from,a.from),o.pointToLocalFrame(n,e,a.to,a.to);var B=[],c=null,g=null,E=null,Q=null,u=A.getIndexOfPosition(a.from.x,a.from.y,B,!1);if(u&&(c=B[0],g=B[1],E=B[0],Q=B[1]),(u=A.getIndexOfPosition(a.to.x,a.to.y,B,!1))&&((null===c||B[0]<c)&&(c=B[0]),(null===E||B[0]>E)&&(E=B[0]),(null===g||B[1]<g)&&(g=B[1]),(null===Q||B[1]>Q)&&(Q=B[1])),null!==c){var l=[];A.getRectMinMax(c,g,E,Q,l);for(var w=c;E>=w;w++)for(var h=g;Q>=h;h++){if(this.result._shouldStop)return;if(A.getConvexTrianglePillar(w,h,!1),o.pointToWorldFrame(n,e,A.pillarOffset,s),this.intersectConvex(A.pillarConvex,e,s,r,M),this.result._shouldStop)return;A.getConvexTrianglePillar(w,h,!0),o.pointToWorldFrame(n,e,A.pillarOffset,s),this.intersectConvex(A.pillarConvex,e,s,r,M)}}},t.prototype[a.types.HEIGHTFIELD]=t.prototype.intersectHeightfield;var d=new i,m=new i;t.prototype.intersectSphere=function(A,e,t,n){var i=this.from,r=this.to,o=A.radius,s=Math.pow(r.x-i.x,2)+Math.pow(r.y-i.y,2)+Math.pow(r.z-i.z,2),a=2*((r.x-i.x)*(i.x-t.x)+(r.y-i.y)*(i.y-t.y)+(r.z-i.z)*(i.z-t.z)),B=Math.pow(i.x-t.x,2)+Math.pow(i.y-t.y,2)+Math.pow(i.z-t.z,2)-Math.pow(o,2),c=Math.pow(a,2)-4*s*B,g=d,E=m;if(!(0>c))if(0===c)i.lerp(r,c,g),g.vsub(t,E),E.normalize(),this.reportIntersection(E,g,A,n,-1);else{var Q=(-a-Math.sqrt(c))/(2*s),u=(-a+Math.sqrt(c))/(2*s);if(Q>=0&&1>=Q&&(i.lerp(r,Q,g),g.vsub(t,E),E.normalize(),this.reportIntersection(E,g,A,n,-1)),this.result._shouldStop)return;u>=0&&1>=u&&(i.lerp(r,u,g),g.vsub(t,E),E.normalize(),this.reportIntersection(E,g,A,n,-1))}},t.prototype[a.types.SPHERE]=t.prototype.intersectSphere;var p=new i,F=(new i,new i,new i);t.prototype.intersectConvex=function(A,e,t,i,r){for(var o=p,s=F,a=r&&r.faceList||null,B=A.faces,c=A.vertices,g=A.faceNormals,E=this._direction,Q=this.from,u=this.to,l=Q.distanceTo(u),M=a?a.length:B.length,d=this.result,m=0;!d._shouldStop&&M>m;m++){var D=a?a[m]:m,Y=B[D],f=g[D],N=e,U=t;s.copy(c[Y[0]]),N.vmult(s,s),s.vadd(U,s),s.vsub(Q,s),N.vmult(f,o);var y=E.dot(o);if(!(Math.abs(y)<this.precision)){var T=o.dot(s)/y;if(!(0>T)){E.mult(T,w),w.vadd(Q,w),h.copy(c[Y[0]]),N.vmult(h,h),U.vadd(h,h);for(var x=1;!d._shouldStop&&x<Y.length-1;x++){C.copy(c[Y[x]]),I.copy(c[Y[x+1]]),N.vmult(C,C),N.vmult(I,I),U.vadd(C,C),U.vadd(I,I);var R=w.distanceTo(Q);!n(w,h,C,I)&&!n(w,C,h,I)||R>l||this.reportIntersection(o,w,A,i,D)}}}}},t.prototype[a.types.CONVEXPOLYHEDRON]=t.prototype.intersectConvex;var D=new i,Y=new i,f=new i,N=new i,U=new i,y=new i,T=(new B,[]),x=new o;t.prototype.intersectTrimesh=function(A,e,t,i,r){var s=D,a=T,B=x,c=F,g=Y,E=f,Q=N,u=y,l=U,M=(r&&r.faceList,A.indices),d=(A.vertices,A.faceNormals,this.from),m=this.to,p=this._direction;B.position.copy(t),B.quaternion.copy(e),o.vectorToLocalFrame(t,e,p,g),o.pointToLocalFrame(t,e,d,E),o.pointToLocalFrame(t,e,m,Q);var R=E.distanceSquared(Q);A.tree.rayQuery(this,B,a);for(var G=0,S=a.length;!this.result._shouldStop&&G!==S;G++){var H=a[G];A.getNormal(H,s),A.getVertex(M[3*H],h),h.vsub(E,c);var b=g.dot(s),v=s.dot(c)/b;if(!(0>v)){g.scale(v,w),w.vadd(E,w),A.getVertex(M[3*H+1],C),A.getVertex(M[3*H+2],I);var k=w.distanceSquared(E);!n(w,C,h,I)&&!n(w,h,C,I)||k>R||(o.vectorToWorldFrame(e,s,l),o.pointToWorldFrame(t,e,w,u),this.reportIntersection(l,u,A,i,H))}}a.length=0},t.prototype[a.types.TRIMESH]=t.prototype.intersectTrimesh,t.prototype.reportIntersection=function(A,e,n,i,r){var o=this.from,s=this.to,a=o.distanceTo(e),B=this.result;if(!(this.skipBackfaces&&A.dot(this._direction)>0))switch(B.hitFaceIndex=void 0!==r?r:-1,this.mode){case t.ALL:this.hasHit=!0,B.set(o,s,A,e,n,i,a),B.hasHit=!0,this.callback(B);break;case t.CLOSEST:(a<B.distance||!B.hasHit)&&(this.hasHit=!0,B.hasHit=!0,B.set(o,s,A,e,n,i,a));break;case t.ANY:this.hasHit=!0,B.hasHit=!0,B.set(o,s,A,e,n,i,a),B._shouldStop=!0}};var R=new i,G=new i},{"../collision/AABB":3,"../collision/RaycastResult":10,"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"../shapes/Box":37,"../shapes/ConvexPolyhedron":38,"../shapes/Shape":43}],10:[function(A,e){function t(){this.rayFromWorld=new n,this.rayToWorld=new n,this.hitNormalWorld=new n,this.hitPointWorld=new n,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this._shouldStop=!1}var n=A("../math/Vec3");e.exports=t,t.prototype.reset=function(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this._shouldStop=!1},t.prototype.abort=function(){this._shouldStop=!0},t.prototype.set=function(A,e,t,n,i,r,o){this.rayFromWorld.copy(A),this.rayToWorld.copy(e),this.hitNormalWorld.copy(t),this.hitPointWorld.copy(n),this.shape=i,this.body=r,this.distance=o}},{"../math/Vec3":30}],11:[function(A,e){function t(A){n.apply(this),this.axisList=[],this.world=null,this.axisIndex=0;var e=this.axisList;this._addBodyHandler=function(A){e.push(A.body)},this._removeBodyHandler=function(A){var t=e.indexOf(A.body);-1!==t&&e.splice(t,1)},A&&this.setWorld(A)}var n=(A("../shapes/Shape"),A("../collision/Broadphase"));e.exports=t,t.prototype=new n,t.prototype.setWorld=function(A){this.axisList.length=0;for(var e=0;e<A.bodies.length;e++)this.axisList.push(A.bodies[e]);A.removeEventListener("addBody",this._addBodyHandler),A.removeEventListener("removeBody",this._removeBodyHandler),A.addEventListener("addBody",this._addBodyHandler),A.addEventListener("removeBody",this._removeBodyHandler),this.world=A,this.dirty=!0},t.insertionSortX=function(A){for(var e=1,t=A.length;t>e;e++){for(var n=A[e],i=e-1;i>=0&&!(A[i].aabb.lowerBound.x<=n.aabb.lowerBound.x);i--)A[i+1]=A[i];A[i+1]=n}return A},t.insertionSortY=function(A){for(var e=1,t=A.length;t>e;e++){for(var n=A[e],i=e-1;i>=0&&!(A[i].aabb.lowerBound.y<=n.aabb.lowerBound.y);i--)A[i+1]=A[i];A[i+1]=n}return A},t.insertionSortZ=function(A){for(var e=1,t=A.length;t>e;e++){for(var n=A[e],i=e-1;i>=0&&!(A[i].aabb.lowerBound.z<=n.aabb.lowerBound.z);i--)A[i+1]=A[i];A[i+1]=n}return A},t.prototype.collisionPairs=function(A,e,n){var i,r,o=this.axisList,s=o.length,a=this.axisIndex;for(this.dirty&&(this.sortList(),this.dirty=!1),i=0;i!==s;i++){var B=o[i];for(r=i+1;s>r;r++){var c=o[r];if(this.needBroadphaseCollision(B,c)){if(!t.checkBounds(B,c,a))break;this.intersectionTest(B,c,e,n)}}}},t.prototype.sortList=function(){for(var A=this.axisList,e=this.axisIndex,n=A.length,i=0;i!==n;i++){var r=A[i];r.aabbNeedsUpdate&&r.computeAABB()}0===e?t.insertionSortX(A):1===e?t.insertionSortY(A):2===e&&t.insertionSortZ(A)},t.checkBounds=function(A,e,t){var n,i;return 0===t?(n=A.position.x,i=e.position.x):1===t?(n=A.position.y,i=e.position.y):2===t&&(n=A.position.z,i=e.position.z),n+A.boundingRadius>i-e.boundingRadius},t.prototype.autoDetectAxis=function(){for(var A=0,e=0,t=0,n=0,i=0,r=0,o=this.axisList,s=o.length,a=1/s,B=0;B!==s;B++){var c=o[B],g=c.position.x;A+=g,e+=g*g;var E=c.position.y;t+=E,n+=E*E;var Q=c.position.z;i+=Q,r+=Q*Q}var u=e-A*A*a,l=n-t*t*a,w=r-i*i*a;this.axisIndex=u>l?u>w?0:2:l>w?1:2},t.prototype.aabbQuery=function(A,e,t){t=t||[],this.dirty&&(this.sortList(),this.dirty=!1);var n=this.axisIndex,i="x";1===n&&(i="y"),2===n&&(i="z");for(var r=this.axisList,o=(e.lowerBound[i],e.upperBound[i],0);o<r.length;o++){var s=r[o];s.aabbNeedsUpdate&&s.computeAABB(),s.aabb.overlaps(e)&&t.push(s)}return t}},{"../collision/Broadphase":5,"../shapes/Shape":43}],12:[function(A,e){function t(A,e,t){var s=void 0!==(t=t||{}).maxForce?t.maxForce:1e6,a=t.pivotA?t.pivotA.clone():new o,B=t.pivotB?t.pivotB.clone():new o;this.axisA=t.axisA?t.axisA.clone():new o,this.axisB=t.axisB?t.axisB.clone():new o,n.call(this,A,a,e,B,s),this.collideConnected=!!t.collideConnected,this.angle=void 0!==t.angle?t.angle:0;var c=this.coneEquation=new i(A,e,t),g=this.twistEquation=new r(A,e,t);this.twistAngle=void 0!==t.twistAngle?t.twistAngle:0,c.maxForce=0,c.minForce=-s,g.maxForce=0,g.minForce=-s,this.equations.push(c,g)}e.exports=t;var n=(A("./Constraint"),A("./PointToPointConstraint")),i=A("../equations/ConeEquation"),r=A("../equations/RotationalEquation"),o=(A("../equations/ContactEquation"),A("../math/Vec3"));t.prototype=new n,t.constructor=t,new o,new o,t.prototype.update=function(){var A=this.bodyA,e=this.bodyB,t=this.coneEquation,i=this.twistEquation;n.prototype.update.call(this),A.vectorToWorldFrame(this.axisA,t.axisA),e.vectorToWorldFrame(this.axisB,t.axisB),this.axisA.tangents(i.axisA,i.axisA),A.vectorToWorldFrame(i.axisA,i.axisA),this.axisB.tangents(i.axisB,i.axisB),e.vectorToWorldFrame(i.axisB,i.axisB),t.angle=this.angle,i.maxAngle=this.twistAngle}},{"../equations/ConeEquation":18,"../equations/ContactEquation":19,"../equations/RotationalEquation":22,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],13:[function(A,e){function t(A,e,i){i=n.defaults(i,{collideConnected:!0,wakeUpBodies:!0}),this.equations=[],this.bodyA=A,this.bodyB=e,this.id=t.idCounter++,this.collideConnected=i.collideConnected,i.wakeUpBodies&&(A&&A.wakeUp(),e&&e.wakeUp())}e.exports=t;var n=A("../utils/Utils");t.prototype.update=function(){throw new Error("method update() not implmemented in this Constraint subclass!")},t.prototype.enable=function(){for(var A=this.equations,e=0;e<A.length;e++)A[e].enabled=!0},t.prototype.disable=function(){for(var A=this.equations,e=0;e<A.length;e++)A[e].enabled=!1},t.idCounter=0},{"../utils/Utils":53}],14:[function(A,e){function t(A,e,t,r){n.call(this,A,e),void 0===t&&(t=A.position.distanceTo(e.position)),void 0===r&&(r=1e6),this.distance=t;var o=this.distanceEquation=new i(A,e);this.equations.push(o),o.minForce=-r,o.maxForce=r}e.exports=t;var n=A("./Constraint"),i=A("../equations/ContactEquation");t.prototype=new n,t.prototype.update=function(){var A=this.bodyA,e=this.bodyB,t=this.distanceEquation,n=.5*this.distance,i=t.ni;e.position.vsub(A.position,i),i.normalize(),i.mult(n,t.ri),i.mult(-n,t.rj)}},{"../equations/ContactEquation":19,"./Constraint":13}],15:[function(A,e){function t(A,e,t){var s=void 0!==(t=t||{}).maxForce?t.maxForce:1e6,a=t.pivotA?t.pivotA.clone():new o,B=t.pivotB?t.pivotB.clone():new o;n.call(this,A,a,e,B,s),(this.axisA=t.axisA?t.axisA.clone():new o(1,0,0)).normalize(),(this.axisB=t.axisB?t.axisB.clone():new o(1,0,0)).normalize();var c=this.rotationalEquation1=new i(A,e,t),g=this.rotationalEquation2=new i(A,e,t),E=this.motorEquation=new r(A,e,s);E.enabled=!1,this.equations.push(c,g,E)}e.exports=t;var n=(A("./Constraint"),A("./PointToPointConstraint")),i=A("../equations/RotationalEquation"),r=A("../equations/RotationalMotorEquation"),o=(A("../equations/ContactEquation"),A("../math/Vec3"));t.prototype=new n,t.constructor=t,t.prototype.enableMotor=function(){this.motorEquation.enabled=!0},t.prototype.disableMotor=function(){this.motorEquation.enabled=!1},t.prototype.setMotorSpeed=function(A){this.motorEquation.targetVelocity=A},t.prototype.setMotorMaxForce=function(A){this.motorEquation.maxForce=A,this.motorEquation.minForce=-A};var s=new o,a=new o;t.prototype.update=function(){var A=this.bodyA,e=this.bodyB,t=this.motorEquation,i=this.rotationalEquation1,r=this.rotationalEquation2,o=s,B=a,c=this.axisA,g=this.axisB;n.prototype.update.call(this),A.quaternion.vmult(c,o),e.quaternion.vmult(g,B),o.tangents(i.axisA,r.axisA),i.axisB.copy(B),r.axisB.copy(B),this.motorEquation.enabled&&(A.quaternion.vmult(this.axisA,t.axisA),e.quaternion.vmult(this.axisB,t.axisB))}},{"../equations/ContactEquation":19,"../equations/RotationalEquation":22,"../equations/RotationalMotorEquation":23,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],16:[function(A,e){function t(A,e,t){var o=void 0!==(t=t||{}).maxForce?t.maxForce:1e6,s=new r,a=new r,B=new r;A.position.vadd(e.position,B),B.scale(.5,B),e.pointToLocalFrame(B,a),A.pointToLocalFrame(B,s),n.call(this,A,s,e,a,o);var c=this.rotationalEquation1=new i(A,e,t),g=this.rotationalEquation2=new i(A,e,t),E=this.rotationalEquation3=new i(A,e,t);this.equations.push(c,g,E)}e.exports=t;var n=(A("./Constraint"),A("./PointToPointConstraint")),i=A("../equations/RotationalEquation"),r=(A("../equations/RotationalMotorEquation"),A("../equations/ContactEquation"),A("../math/Vec3"));t.prototype=new n,t.constructor=t,new r,new r,t.prototype.update=function(){var A=this.bodyA,e=this.bodyB,t=(this.motorEquation,this.rotationalEquation1),i=this.rotationalEquation2,o=this.rotationalEquation3;n.prototype.update.call(this),A.vectorToWorldFrame(r.UNIT_X,t.axisA),e.vectorToWorldFrame(r.UNIT_Y,t.axisB),A.vectorToWorldFrame(r.UNIT_Y,i.axisA),e.vectorToWorldFrame(r.UNIT_Z,i.axisB),A.vectorToWorldFrame(r.UNIT_Z,o.axisA),e.vectorToWorldFrame(r.UNIT_X,o.axisB)}},{"../equations/ContactEquation":19,"../equations/RotationalEquation":22,"../equations/RotationalMotorEquation":23,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],17:[function(A,e){function t(A,e,t,o,s){n.call(this,A,t),s=void 0!==s?s:1e6,this.pivotA=e?e.clone():new r,this.pivotB=o?o.clone():new r;var a=this.equationX=new i(A,t),B=this.equationY=new i(A,t),c=this.equationZ=new i(A,t);this.equations.push(a,B,c),a.minForce=B.minForce=c.minForce=-s,a.maxForce=B.maxForce=c.maxForce=s,a.ni.set(1,0,0),B.ni.set(0,1,0),c.ni.set(0,0,1)}e.exports=t;var n=A("./Constraint"),i=A("../equations/ContactEquation"),r=A("../math/Vec3");t.prototype=new n,t.prototype.update=function(){var A=this.bodyA,e=this.bodyB,t=this.equationX,n=this.equationY,i=this.equationZ;A.quaternion.vmult(this.pivotA,t.ri),e.quaternion.vmult(this.pivotB,t.rj),n.ri.copy(t.ri),n.rj.copy(t.rj),i.ri.copy(t.ri),i.rj.copy(t.rj)}},{"../equations/ContactEquation":19,"../math/Vec3":30,"./Constraint":13}],18:[function(A,e){function t(A,e,t){var r=void 0!==(t=t||{}).maxForce?t.maxForce:1e6;i.call(this,A,e,-r,r),this.axisA=t.axisA?t.axisA.clone():new n(1,0,0),this.axisB=t.axisB?t.axisB.clone():new n(0,1,0),this.angle=void 0!==t.angle?t.angle:0}e.exports=t;var n=A("../math/Vec3"),i=(A("../math/Mat3"),A("./Equation"));t.prototype=new i,t.prototype.constructor=t;var r=new n,o=new n;t.prototype.computeB=function(A){var e=this.a,t=this.b,n=this.axisA,i=this.axisB,s=r,a=o,B=this.jacobianElementA,c=this.jacobianElementB;return n.cross(i,s),i.cross(n,a),B.rotational.copy(a),c.rotational.copy(s),-(Math.cos(this.angle)-n.dot(i))*e-this.computeGW()*t-A*this.computeGiMf()}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],19:[function(A,e){function t(A,e,t){t=void 0!==t?t:1e6,n.call(this,A,e,0,t),this.restitution=0,this.ri=new i,this.rj=new i,this.ni=new i}e.exports=t;var n=A("./Equation"),i=A("../math/Vec3");A("../math/Mat3"),t.prototype=new n,t.prototype.constructor=t;var r=new i,o=new i,s=new i;t.prototype.computeB=function(A){var e=this.a,t=this.b,n=this.bi,i=this.bj,a=this.ri,B=this.rj,c=r,g=o,E=n.velocity,Q=n.angularVelocity,u=(n.force,n.torque,i.velocity),l=i.angularVelocity,w=(i.force,i.torque,s),h=this.jacobianElementA,C=this.jacobianElementB,I=this.ni;a.cross(I,c),B.cross(I,g),I.negate(h.spatial),c.negate(h.rotational),C.spatial.copy(I),C.rotational.copy(g),w.copy(i.position),w.vadd(B,w),w.vsub(n.position,w),w.vsub(a,w);var M=I.dot(w),d=this.restitution+1;return-M*e-(d*u.dot(I)-d*E.dot(I)+l.dot(g)-Q.dot(c))*t-A*this.computeGiMf()};var a=new i,B=new i,c=new i,g=new i,E=new i;t.prototype.getImpactVelocityAlongNormal=function(){var A=a,e=B,t=c,n=g,i=E;return this.bi.position.vadd(this.ri,t),this.bj.position.vadd(this.rj,n),this.bi.getVelocityAtWorldPoint(t,A),this.bj.getVelocityAtWorldPoint(n,e),A.vsub(e,i),this.ni.dot(i)}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],20:[function(A,e){function t(A,e,i,r){this.id=t.id++,this.minForce=void 0===i?-1e6:i,this.maxForce=void 0===r?1e6:r,this.bi=A,this.bj=e,this.a=0,this.b=0,this.eps=0,this.jacobianElementA=new n,this.jacobianElementB=new n,this.enabled=!0,this.setSpookParams(1e7,4,1/60)}e.exports=t;var n=A("../math/JacobianElement"),i=A("../math/Vec3");t.prototype.constructor=t,t.id=0,t.prototype.setSpookParams=function(A,e,t){var n=e,i=A,r=t;this.a=4/(r*(1+4*n)),this.b=4*n/(1+4*n),this.eps=4/(r*r*i*(1+4*n))},t.prototype.computeB=function(A,e,t){var n=this.computeGW();return-this.computeGq()*A-n*e-this.computeGiMf()*t},t.prototype.computeGq=function(){var A=this.jacobianElementA,e=this.jacobianElementB,t=this.bi,n=this.bj,i=t.position,r=n.position;return A.spatial.dot(i)+e.spatial.dot(r)};var r=new i;t.prototype.computeGW=function(){var A=this.jacobianElementA,e=this.jacobianElementB,t=this.bi,n=this.bj,i=t.velocity,o=n.velocity,s=t.angularVelocity||r,a=n.angularVelocity||r;return A.multiplyVectors(i,s)+e.multiplyVectors(o,a)},t.prototype.computeGWlambda=function(){var A=this.jacobianElementA,e=this.jacobianElementB,t=this.bi,n=this.bj,i=t.vlambda,o=n.vlambda,s=t.wlambda||r,a=n.wlambda||r;return A.multiplyVectors(i,s)+e.multiplyVectors(o,a)};var o=new i,s=new i,a=new i,B=new i;t.prototype.computeGiMf=function(){var A=this.jacobianElementA,e=this.jacobianElementB,t=this.bi,n=this.bj,i=t.force,r=t.torque,c=n.force,g=n.torque,E=t.invMassSolve,Q=n.invMassSolve;return t.invInertiaWorldSolve?t.invInertiaWorldSolve.vmult(r,a):a.set(0,0,0),n.invInertiaWorldSolve?n.invInertiaWorldSolve.vmult(g,B):B.set(0,0,0),i.mult(E,o),c.mult(Q,s),A.multiplyVectors(o,a)+e.multiplyVectors(s,B)};var c=new i;t.prototype.computeGiMGt=function(){var A=this.jacobianElementA,e=this.jacobianElementB,t=this.bi,n=this.bj,i=t.invMassSolve,r=n.invMassSolve,o=t.invInertiaWorldSolve,s=n.invInertiaWorldSolve,a=i+r;return o&&(o.vmult(A.rotational,c),a+=c.dot(A.rotational)),s&&(s.vmult(e.rotational,c),a+=c.dot(e.rotational)),a};var g=new i;new i,new i,new i,new i,new i,t.prototype.addToWlambda=function(A){var e=this.jacobianElementA,t=this.jacobianElementB,n=this.bi,i=this.bj,r=g;e.spatial.mult(n.invMassSolve*A,r),n.vlambda.vadd(r,n.vlambda),t.spatial.mult(i.invMassSolve*A,r),i.vlambda.vadd(r,i.vlambda),n.invInertiaWorldSolve&&(n.invInertiaWorldSolve.vmult(e.rotational,r),r.mult(A,r),n.wlambda.vadd(r,n.wlambda)),i.invInertiaWorldSolve&&(i.invInertiaWorldSolve.vmult(t.rotational,r),r.mult(A,r),i.wlambda.vadd(r,i.wlambda))},t.prototype.computeC=function(){return this.computeGiMGt()+this.eps}},{"../math/JacobianElement":26,"../math/Vec3":30}],21:[function(A,e){function t(A,e,t){n.call(this,A,e,-t,t),this.ri=new i,this.rj=new i,this.t=new i}e.exports=t;var n=A("./Equation"),i=A("../math/Vec3");A("../math/Mat3"),t.prototype=new n,t.prototype.constructor=t;var r=new i,o=new i;t.prototype.computeB=function(A){var e=(this.a,this.b),t=(this.bi,this.bj,this.ri),n=this.rj,i=r,s=o,a=this.t;t.cross(a,i),n.cross(a,s);var B=this.jacobianElementA,c=this.jacobianElementB;return a.negate(B.spatial),i.negate(B.rotational),c.spatial.copy(a),c.rotational.copy(s),-this.computeGW()*e-A*this.computeGiMf()}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],22:[function(A,e){function t(A,e,t){var r=void 0!==(t=t||{}).maxForce?t.maxForce:1e6;i.call(this,A,e,-r,r),this.axisA=t.axisA?t.axisA.clone():new n(1,0,0),this.axisB=t.axisB?t.axisB.clone():new n(0,1,0),this.maxAngle=Math.PI/2}e.exports=t;var n=A("../math/Vec3"),i=(A("../math/Mat3"),A("./Equation"));t.prototype=new i,t.prototype.constructor=t;var r=new n,o=new n;t.prototype.computeB=function(A){var e=this.a,t=this.b,n=this.axisA,i=this.axisB,s=r,a=o,B=this.jacobianElementA,c=this.jacobianElementB;return n.cross(i,s),i.cross(n,a),B.rotational.copy(a),c.rotational.copy(s),-(Math.cos(this.maxAngle)-n.dot(i))*e-this.computeGW()*t-A*this.computeGiMf()}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],23:[function(A,e){function t(A,e,t){t=void 0!==t?t:1e6,i.call(this,A,e,-t,t),this.axisA=new n,this.axisB=new n,this.targetVelocity=0}e.exports=t;var n=A("../math/Vec3"),i=(A("../math/Mat3"),A("./Equation"));t.prototype=new i,t.prototype.constructor=t,t.prototype.computeB=function(A){var e=(this.a,this.b),t=(this.bi,this.bj,this.axisA),n=this.axisB,i=this.jacobianElementA,r=this.jacobianElementB;return i.rotational.copy(t),n.negate(r.rotational),-(this.computeGW()-this.targetVelocity)*e-A*this.computeGiMf()}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],24:[function(A,e){function t(A,e,i){i=n.defaults(i,{friction:.3,restitution:.3,contactEquationStiffness:1e7,contactEquationRelaxation:3,frictionEquationStiffness:1e7,frictionEquationRelaxation:3}),this.id=t.idCounter++,this.materials=[A,e],this.friction=i.friction,this.restitution=i.restitution,this.contactEquationStiffness=i.contactEquationStiffness,this.contactEquationRelaxation=i.contactEquationRelaxation,this.frictionEquationStiffness=i.frictionEquationStiffness,this.frictionEquationRelaxation=i.frictionEquationRelaxation}var n=A("../utils/Utils");e.exports=t,t.idCounter=0},{"../utils/Utils":53}],25:[function(A,e){function t(A){var e="";"string"==typeof(A=A||{})?(e=A,A={}):"object"==typeof A&&(e=""),this.name=e,this.id=t.idCounter++,this.friction=void 0!==A.friction?A.friction:-1,this.restitution=void 0!==A.restitution?A.restitution:-1}e.exports=t,t.idCounter=0},{}],26:[function(A,e){function t(){this.spatial=new n,this.rotational=new n}e.exports=t;var n=A("./Vec3");t.prototype.multiplyElement=function(A){return A.spatial.dot(this.spatial)+A.rotational.dot(this.rotational)},t.prototype.multiplyVectors=function(A,e){return A.dot(this.spatial)+e.dot(this.rotational)}},{"./Vec3":30}],27:[function(A,e){function t(A){this.elements=A||[0,0,0,0,0,0,0,0,0]}e.exports=t;var n=A("./Vec3");t.prototype.identity=function(){var A=this.elements;A[0]=1,A[1]=0,A[2]=0,A[3]=0,A[4]=1,A[5]=0,A[6]=0,A[7]=0,A[8]=1},t.prototype.setZero=function(){var A=this.elements;A[0]=0,A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=0,A[6]=0,A[7]=0,A[8]=0},t.prototype.setTrace=function(A){var e=this.elements;e[0]=A.x,e[4]=A.y,e[8]=A.z},t.prototype.getTrace=function(A){A=A||new n;var e=this.elements;A.x=e[0],A.y=e[4],A.z=e[8]},t.prototype.vmult=function(A,e){e=e||new n;var t=this.elements,i=A.x,r=A.y,o=A.z;return e.x=t[0]*i+t[1]*r+t[2]*o,e.y=t[3]*i+t[4]*r+t[5]*o,e.z=t[6]*i+t[7]*r+t[8]*o,e},t.prototype.smult=function(A){for(var e=0;e<this.elements.length;e++)this.elements[e]*=A},t.prototype.mmult=function(A,e){for(var n=e||new t,i=0;3>i;i++)for(var r=0;3>r;r++){for(var o=0,s=0;3>s;s++)o+=A.elements[i+3*s]*this.elements[s+3*r];n.elements[i+3*r]=o}return n},t.prototype.scale=function(A,e){e=e||new t;for(var n=this.elements,i=e.elements,r=0;3!==r;r++)i[3*r+0]=A.x*n[3*r+0],i[3*r+1]=A.y*n[3*r+1],i[3*r+2]=A.z*n[3*r+2];return e},t.prototype.solve=function(A,e){e=e||new n;for(var t=[],i=0;12>i;i++)t.push(0);var r;for(i=0;3>i;i++)for(r=0;3>r;r++)t[i+4*r]=this.elements[i+3*r];t[3]=A.x,t[7]=A.y,t[11]=A.z;var o,s,a=3,B=a;do{if(0===t[(i=B-a)+4*i])for(r=i+1;B>r;r++)if(0!==t[i+4*r]){o=4;do{t[(s=4-o)+4*i]+=t[s+4*r]}while(--o);break}if(0!==t[i+4*i])for(r=i+1;B>r;r++){var c=t[i+4*r]/t[i+4*i];o=4;do{t[(s=4-o)+4*r]=i>=s?0:t[s+4*r]-t[s+4*i]*c}while(--o)}}while(--a);if(e.z=t[11]/t[10],e.y=(t[7]-t[6]*e.z)/t[5],e.x=(t[3]-t[2]*e.z-t[1]*e.y)/t[0],isNaN(e.x)||isNaN(e.y)||isNaN(e.z)||1/0===e.x||1/0===e.y||1/0===e.z)throw"Could not solve equation! Got x=["+e.toString()+"], b=["+A.toString()+"], A=["+this.toString()+"]";return e},t.prototype.e=function(A,e,t){return void 0===t?this.elements[e+3*A]:void(this.elements[e+3*A]=t)},t.prototype.copy=function(A){for(var e=0;e<A.elements.length;e++)this.elements[e]=A.elements[e];return this},t.prototype.toString=function(){for(var A="",e=0;9>e;e++)A+=this.elements[e]+",";return A},t.prototype.reverse=function(A){A=A||new t;for(var e=[],n=0;18>n;n++)e.push(0);var i;for(n=0;3>n;n++)for(i=0;3>i;i++)e[n+6*i]=this.elements[n+3*i];e[3]=1,e[9]=0,e[15]=0,e[4]=0,e[10]=1,e[16]=0,e[5]=0,e[11]=0,e[17]=1;var r,o,s=3,a=s;do{if(0===e[(n=a-s)+6*n])for(i=n+1;a>i;i++)if(0!==e[n+6*i]){r=6;do{e[(o=6-r)+6*n]+=e[o+6*i]}while(--r);break}if(0!==e[n+6*n])for(i=n+1;a>i;i++){var B=e[n+6*i]/e[n+6*n];r=6;do{e[(o=6-r)+6*i]=n>=o?0:e[o+6*i]-e[o+6*n]*B}while(--r)}}while(--s);n=2;do{i=n-1;do{B=e[n+6*i]/e[n+6*n],r=6;do{e[(o=6-r)+6*i]=e[o+6*i]-e[o+6*n]*B}while(--r)}while(i--)}while(--n);n=2;do{B=1/e[n+6*n],r=6;do{e[(o=6-r)+6*n]=e[o+6*n]*B}while(--r)}while(n--);n=2;do{i=2;do{if(o=e[3+i+6*n],isNaN(o)||1/0===o)throw"Could not reverse! A=["+this.toString()+"]";A.e(n,i,o)}while(i--)}while(n--);return A},t.prototype.setRotationFromQuaternion=function(A){var e=A.x,t=A.y,n=A.z,i=A.w,r=e+e,o=t+t,s=n+n,a=e*r,B=e*o,c=e*s,g=t*o,E=t*s,Q=n*s,u=i*r,l=i*o,w=i*s,h=this.elements;return h[0]=1-(g+Q),h[1]=B-w,h[2]=c+l,h[3]=B+w,h[4]=1-(a+Q),h[5]=E-u,h[6]=c-l,h[7]=E+u,h[8]=1-(a+g),this},t.prototype.transpose=function(A){for(var e=(A=A||new t).elements,n=this.elements,i=0;3!==i;i++)for(var r=0;3!==r;r++)e[3*i+r]=n[3*r+i];return A}},{"./Vec3":30}],28:[function(A,e){function t(A,e,t,n){this.x=void 0!==A?A:0,this.y=void 0!==e?e:0,this.z=void 0!==t?t:0,this.w=void 0!==n?n:1}e.exports=t;var n=A("./Vec3");t.prototype.set=function(A,e,t,n){this.x=A,this.y=e,this.z=t,this.w=n},t.prototype.toString=function(){return this.x+","+this.y+","+this.z+","+this.w},t.prototype.toArray=function(){return[this.x,this.y,this.z,this.w]},t.prototype.setFromAxisAngle=function(A,e){var t=Math.sin(.5*e);this.x=A.x*t,this.y=A.y*t,this.z=A.z*t,this.w=Math.cos(.5*e)},t.prototype.toAxisAngle=function(A){A=A||new n,this.normalize();var e=2*Math.acos(this.w),t=Math.sqrt(1-this.w*this.w);return.001>t?(A.x=this.x,A.y=this.y,A.z=this.z):(A.x=this.x/t,A.y=this.y/t,A.z=this.z/t),[A,e]};var i=new n,r=new n;t.prototype.setFromVectors=function(A,e){if(A.isAntiparallelTo(e)){var t=i,n=r;A.tangents(t,n),this.setFromAxisAngle(t,Math.PI)}else{var o=A.cross(e);this.x=o.x,this.y=o.y,this.z=o.z,this.w=Math.sqrt(Math.pow(A.norm(),2)*Math.pow(e.norm(),2))+A.dot(e),this.normalize()}};var o=new n,s=new n,a=new n;t.prototype.mult=function(A,e){e=e||new t;var n=this.w,i=o,r=s,B=a;return i.set(this.x,this.y,this.z),r.set(A.x,A.y,A.z),e.w=n*A.w-i.dot(r),i.cross(r,B),e.x=n*r.x+A.w*i.x+B.x,e.y=n*r.y+A.w*i.y+B.y,e.z=n*r.z+A.w*i.z+B.z,e},t.prototype.inverse=function(A){var e=this.x,n=this.y,i=this.z,r=this.w;A=A||new t,this.conjugate(A);var o=1/(e*e+n*n+i*i+r*r);return A.x*=o,A.y*=o,A.z*=o,A.w*=o,A},t.prototype.conjugate=function(A){return(A=A||new t).x=-this.x,A.y=-this.y,A.z=-this.z,A.w=this.w,A},t.prototype.normalize=function(){var A=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);0===A?(this.x=0,this.y=0,this.z=0,this.w=0):(A=1/A,this.x*=A,this.y*=A,this.z*=A,this.w*=A)},t.prototype.normalizeFast=function(){var A=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;0===A?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=A,this.y*=A,this.z*=A,this.w*=A)},t.prototype.vmult=function(A,e){e=e||new n;var t=A.x,i=A.y,r=A.z,o=this.x,s=this.y,a=this.z,B=this.w,c=B*t+s*r-a*i,g=B*i+a*t-o*r,E=B*r+o*i-s*t,Q=-o*t-s*i-a*r;return e.x=c*B+Q*-o+g*-a-E*-s,e.y=g*B+Q*-s+E*-o-c*-a,e.z=E*B+Q*-a+c*-s-g*-o,e},t.prototype.copy=function(A){return this.x=A.x,this.y=A.y,this.z=A.z,this.w=A.w,this},t.prototype.toEuler=function(A,e){e=e||"YZX";var t,n,i,r=this.x,o=this.y,s=this.z,a=this.w;switch(e){case"YZX":var B=r*o+s*a;if(B>.499&&(t=2*Math.atan2(r,a),n=Math.PI/2,i=0),-.499>B&&(t=-2*Math.atan2(r,a),n=-Math.PI/2,i=0),isNaN(t)){var c=r*r,g=o*o,E=s*s;t=Math.atan2(2*o*a-2*r*s,1-2*g-2*E),n=Math.asin(2*B),i=Math.atan2(2*r*a-2*o*s,1-2*c-2*E)}break;default:throw new Error("Euler order "+e+" not supported yet.")}A.y=t,A.z=n,A.x=i},t.prototype.setFromEuler=function(A,e,t,n){n=n||"XYZ";var i=Math.cos(A/2),r=Math.cos(e/2),o=Math.cos(t/2),s=Math.sin(A/2),a=Math.sin(e/2),B=Math.sin(t/2);return"XYZ"===n?(this.x=s*r*o+i*a*B,this.y=i*a*o-s*r*B,this.z=i*r*B+s*a*o,this.w=i*r*o-s*a*B):"YXZ"===n?(this.x=s*r*o+i*a*B,this.y=i*a*o-s*r*B,this.z=i*r*B-s*a*o,this.w=i*r*o+s*a*B):"ZXY"===n?(this.x=s*r*o-i*a*B,this.y=i*a*o+s*r*B,this.z=i*r*B+s*a*o,this.w=i*r*o-s*a*B):"ZYX"===n?(this.x=s*r*o-i*a*B,this.y=i*a*o+s*r*B,this.z=i*r*B-s*a*o,this.w=i*r*o+s*a*B):"YZX"===n?(this.x=s*r*o+i*a*B,this.y=i*a*o+s*r*B,this.z=i*r*B-s*a*o,this.w=i*r*o-s*a*B):"XZY"===n&&(this.x=s*r*o-i*a*B,this.y=i*a*o-s*r*B,this.z=i*r*B+s*a*o,this.w=i*r*o+s*a*B),this},t.prototype.clone=function(){return new t(this.x,this.y,this.z,this.w)}},{"./Vec3":30}],29:[function(A,e){function t(A){A=A||{},this.position=new n,A.position&&this.position.copy(A.position),this.quaternion=new i,A.quaternion&&this.quaternion.copy(A.quaternion)}var n=A("./Vec3"),i=A("./Quaternion");e.exports=t;var r=new i;t.pointToLocalFrame=function(A,e,t,i){return i=i||new n,t.vsub(A,i),e.conjugate(r),r.vmult(i,i),i},t.prototype.pointToLocal=function(A,e){return t.pointToLocalFrame(this.position,this.quaternion,A,e)},t.pointToWorldFrame=function(A,e,t,i){return i=i||new n,e.vmult(t,i),i.vadd(A,i),i},t.prototype.pointToWorld=function(A,e){return t.pointToWorldFrame(this.position,this.quaternion,A,e)},t.prototype.vectorToWorldFrame=function(A,e){return e=e||new n,this.quaternion.vmult(A,e),e},t.vectorToWorldFrame=function(A,e,t){return A.vmult(e,t),t},t.vectorToLocalFrame=function(A,e,t,i){return i=i||new n,e.w*=-1,e.vmult(t,i),e.w*=-1,i}},{"./Quaternion":28,"./Vec3":30}],30:[function(A,e){function t(A,e,t){this.x=A||0,this.y=e||0,this.z=t||0}e.exports=t;var n=A("./Mat3");t.ZERO=new t(0,0,0),t.UNIT_X=new t(1,0,0),t.UNIT_Y=new t(0,1,0),t.UNIT_Z=new t(0,0,1),t.prototype.cross=function(A,e){var n=A.x,i=A.y,r=A.z,o=this.x,s=this.y,a=this.z;return(e=e||new t).x=s*r-a*i,e.y=a*n-o*r,e.z=o*i-s*n,e},t.prototype.set=function(A,e,t){return this.x=A,this.y=e,this.z=t,this},t.prototype.setZero=function(){this.x=this.y=this.z=0},t.prototype.vadd=function(A,e){return e?(e.x=A.x+this.x,e.y=A.y+this.y,void(e.z=A.z+this.z)):new t(this.x+A.x,this.y+A.y,this.z+A.z)},t.prototype.vsub=function(A,e){return e?(e.x=this.x-A.x,e.y=this.y-A.y,void(e.z=this.z-A.z)):new t(this.x-A.x,this.y-A.y,this.z-A.z)},t.prototype.crossmat=function(){return new n([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])},t.prototype.normalize=function(){var A=this.x,e=this.y,t=this.z,n=Math.sqrt(A*A+e*e+t*t);if(n>0){var i=1/n;this.x*=i,this.y*=i,this.z*=i}else this.x=0,this.y=0,this.z=0;return n},t.prototype.unit=function(A){A=A||new t;var e=this.x,n=this.y,i=this.z,r=Math.sqrt(e*e+n*n+i*i);return r>0?(r=1/r,A.x=e*r,A.y=n*r,A.z=i*r):(A.x=1,A.y=0,A.z=0),A},t.prototype.norm=function(){var A=this.x,e=this.y,t=this.z;return Math.sqrt(A*A+e*e+t*t)},t.prototype.length=t.prototype.norm,t.prototype.norm2=function(){return this.dot(this)},t.prototype.lengthSquared=t.prototype.norm2,t.prototype.distanceTo=function(A){var e=this.x,t=this.y,n=this.z,i=A.x,r=A.y,o=A.z;return Math.sqrt((i-e)*(i-e)+(r-t)*(r-t)+(o-n)*(o-n))},t.prototype.distanceSquared=function(A){var e=this.x,t=this.y,n=this.z,i=A.x,r=A.y,o=A.z;return(i-e)*(i-e)+(r-t)*(r-t)+(o-n)*(o-n)},t.prototype.mult=function(A,e){e=e||new t;var n=this.x,i=this.y,r=this.z;return e.x=A*n,e.y=A*i,e.z=A*r,e},t.prototype.scale=t.prototype.mult,t.prototype.dot=function(A){return this.x*A.x+this.y*A.y+this.z*A.z},t.prototype.isZero=function(){return 0===this.x&&0===this.y&&0===this.z},t.prototype.negate=function(A){return(A=A||new t).x=-this.x,A.y=-this.y,A.z=-this.z,A};var i=new t,r=new t;t.prototype.tangents=function(A,e){var t=this.norm();if(t>0){var n=i,o=1/t;n.set(this.x*o,this.y*o,this.z*o);var s=r;Math.abs(n.x)<.9?(s.set(1,0,0),n.cross(s,A)):(s.set(0,1,0),n.cross(s,A)),n.cross(A,e)}else A.set(1,0,0),e.set(0,1,0)},t.prototype.toString=function(){return this.x+","+this.y+","+this.z},t.prototype.toArray=function(){return[this.x,this.y,this.z]},t.prototype.copy=function(A){return this.x=A.x,this.y=A.y,this.z=A.z,this},t.prototype.lerp=function(A,e,t){var n=this.x,i=this.y,r=this.z;t.x=n+(A.x-n)*e,t.y=i+(A.y-i)*e,t.z=r+(A.z-r)*e},t.prototype.almostEquals=function(A,e){return void 0===e&&(e=1e-6),!(Math.abs(this.x-A.x)>e||Math.abs(this.y-A.y)>e||Math.abs(this.z-A.z)>e)},t.prototype.almostZero=function(A){return void 0===A&&(A=1e-6),!(Math.abs(this.x)>A||Math.abs(this.y)>A||Math.abs(this.z)>A)};var o=new t;t.prototype.isAntiparallelTo=function(A,e){return this.negate(o),o.almostEquals(A,e)},t.prototype.clone=function(){return new t(this.x,this.y,this.z)}},{"./Mat3":27}],31:[function(A,e){function t(A){A=A||{},n.apply(this),this.id=t.idCounter++,this.world=null,this.preStep=null,this.postStep=null,this.vlambda=new i,this.collisionFilterGroup="number"==typeof A.collisionFilterGroup?A.collisionFilterGroup:1,this.collisionFilterMask="number"==typeof A.collisionFilterMask?A.collisionFilterMask:1,this.collisionResponse=!0,this.position=new i,A.position&&this.position.copy(A.position),this.previousPosition=new i,this.initPosition=new i,this.velocity=new i,A.velocity&&this.velocity.copy(A.velocity),this.initVelocity=new i,this.force=new i;var e="number"==typeof A.mass?A.mass:0;this.mass=e,this.invMass=e>0?1/e:0,this.material=A.material||null,this.linearDamping="number"==typeof A.linearDamping?A.linearDamping:.01,this.type=0>=e?t.STATIC:t.DYNAMIC,typeof A.type==typeof t.STATIC&&(this.type=A.type),this.allowSleep=void 0===A.allowSleep||A.allowSleep,this.sleepState=0,this.sleepSpeedLimit=void 0!==A.sleepSpeedLimit?A.sleepSpeedLimit:.1,this.sleepTimeLimit=void 0!==A.sleepTimeLimit?A.sleepTimeLimit:1,this.timeLastSleepy=0,this._wakeUpAfterNarrowphase=!1,this.torque=new i,this.quaternion=new o,A.quaternion&&this.quaternion.copy(A.quaternion),this.initQuaternion=new o,this.angularVelocity=new i,A.angularVelocity&&this.angularVelocity.copy(A.angularVelocity),this.initAngularVelocity=new i,this.interpolatedPosition=new i,this.interpolatedQuaternion=new o,this.shapes=[],this.shapeOffsets=[],this.shapeOrientations=[],this.inertia=new i,this.invInertia=new i,this.invInertiaWorld=new r,this.invMassSolve=0,this.invInertiaSolve=new i,this.invInertiaWorldSolve=new r,this.fixedRotation=void 0!==A.fixedRotation&&A.fixedRotation,this.angularDamping=void 0!==A.angularDamping?A.angularDamping:.01,this.aabb=new s,this.aabbNeedsUpdate=!0,this.wlambda=new i,A.shape&&this.addShape(A.shape),this.updateMassProperties()}e.exports=t;var n=A("../utils/EventTarget"),i=(A("../shapes/Shape"),A("../math/Vec3")),r=A("../math/Mat3"),o=A("../math/Quaternion"),s=(A("../material/Material"),A("../collision/AABB")),a=A("../shapes/Box");t.prototype=new n,t.prototype.constructor=t,t.DYNAMIC=1,t.STATIC=2,t.KINEMATIC=4,t.AWAKE=0,t.SLEEPY=1,t.SLEEPING=2,t.idCounter=0,t.prototype.wakeUp=function(){var A=this.sleepState;this.sleepState=0,A===t.SLEEPING&&this.dispatchEvent({type:"wakeup"})},t.prototype.sleep=function(){this.sleepState=t.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0)},t.sleepyEvent={type:"sleepy"},t.sleepEvent={type:"sleep"},t.prototype.sleepTick=function(A){if(this.allowSleep){var e=this.sleepState,n=this.velocity.norm2()+this.angularVelocity.norm2(),i=Math.pow(this.sleepSpeedLimit,2);e===t.AWAKE&&i>n?(this.sleepState=t.SLEEPY,this.timeLastSleepy=A,this.dispatchEvent(t.sleepyEvent)):e===t.SLEEPY&&n>i?this.wakeUp():e===t.SLEEPY&&A-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(t.sleepEvent))}},t.prototype.updateSolveMassProperties=function(){this.sleepState===t.SLEEPING||this.type===t.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))},t.prototype.pointToLocalFrame=function(A,e){return e=e||new i,A.vsub(this.position,e),this.quaternion.conjugate().vmult(e,e),e},t.prototype.vectorToLocalFrame=function(A,e){return e=e||new i,this.quaternion.conjugate().vmult(A,e),e},t.prototype.pointToWorldFrame=function(A,e){return e=e||new i,this.quaternion.vmult(A,e),e.vadd(this.position,e),e},t.prototype.vectorToWorldFrame=function(A,e){return e=e||new i,this.quaternion.vmult(A,e),e};var B=new i,c=new o;t.prototype.addShape=function(A,e,t){var n=new i,r=new o;return e&&n.copy(e),t&&r.copy(t),this.shapes.push(A),this.shapeOffsets.push(n),this.shapeOrientations.push(r),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,this},t.prototype.updateBoundingRadius=function(){for(var A=this.shapes,e=this.shapeOffsets,t=A.length,n=0,i=0;i!==t;i++){var r=A[i];r.updateBoundingSphereRadius();var o=e[i].norm(),s=r.boundingSphereRadius;o+s>n&&(n=o+s)}this.boundingRadius=n};var g=new s;t.prototype.computeAABB=function(){for(var A=this.shapes,e=this.shapeOffsets,t=this.shapeOrientations,n=A.length,i=B,r=c,o=this.quaternion,s=this.aabb,a=g,E=0;E!==n;E++){var Q=A[E];t[E].mult(o,r),r.vmult(e[E],i),i.vadd(this.position,i),Q.calculateWorldAABB(i,r,a.lowerBound,a.upperBound),0===E?s.copy(a):s.extend(a)}this.aabbNeedsUpdate=!1};var E=new r,Q=new r;new r,t.prototype.updateInertiaWorld=function(A){var e=this.invInertia;if(e.x!==e.y||e.y!==e.z||A){var t=E,n=Q;t.setRotationFromQuaternion(this.quaternion),t.transpose(n),t.scale(e,t),t.mmult(n,this.invInertiaWorld)}};var u=new i,l=new i;t.prototype.applyForce=function(A,e){if(this.type===t.DYNAMIC){var n=u;e.vsub(this.position,n);var i=l;n.cross(A,i),this.force.vadd(A,this.force),this.torque.vadd(i,this.torque)}};var w=new i,h=new i;t.prototype.applyLocalForce=function(A,e){if(this.type===t.DYNAMIC){var n=w,i=h;this.vectorToWorldFrame(A,n),this.pointToWorldFrame(e,i),this.applyForce(n,i)}};var C=new i,I=new i,M=new i;t.prototype.applyImpulse=function(A,e){if(this.type===t.DYNAMIC){var n=C;e.vsub(this.position,n);var i=I;i.copy(A),i.mult(this.invMass,i),this.velocity.vadd(i,this.velocity);var r=M;n.cross(A,r),this.invInertiaWorld.vmult(r,r),this.angularVelocity.vadd(r,this.angularVelocity)}};var d=new i,m=new i;t.prototype.applyLocalImpulse=function(A,e){if(this.type===t.DYNAMIC){var n=d,i=m;this.vectorToWorldFrame(A,n),this.pointToWorldFrame(e,i),this.applyImpulse(n,i)}};var p=new i;t.prototype.updateMassProperties=function(){var A=p;this.invMass=this.mass>0?1/this.mass:0;var e=this.inertia,t=this.fixedRotation;this.computeAABB(),A.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),a.calculateInertia(A,this.mass,e),this.invInertia.set(e.x>0&&!t?1/e.x:0,e.y>0&&!t?1/e.y:0,e.z>0&&!t?1/e.z:0),this.updateInertiaWorld(!0)},t.prototype.getVelocityAtWorldPoint=function(A,e){var t=new i;return A.vsub(this.position,t),this.angularVelocity.cross(t,e),this.velocity.vadd(e,e),e}},{"../collision/AABB":3,"../material/Material":25,"../math/Mat3":27,"../math/Quaternion":28,"../math/Vec3":30,"../shapes/Box":37,"../shapes/Shape":43,"../utils/EventTarget":49}],32:[function(A,e){function t(A){this.chassisBody=A.chassisBody,this.wheelInfos=[],this.sliding=!1,this.world=null,this.indexRightAxis=void 0!==A.indexRightAxis?A.indexRightAxis:1,this.indexForwardAxis=void 0!==A.indexForwardAxis?A.indexForwardAxis:0,this.indexUpAxis=void 0!==A.indexUpAxis?A.indexUpAxis:2}function n(A,e,t,n,r){var o=0,s=t,a=I,B=M,c=d;return A.getVelocityAtWorldPoint(s,a),e.getVelocityAtWorldPoint(s,B),a.vsub(B,c),(o=-n.dot(c)*(1/(i(A,t,n)+i(e,t,n))))>r&&(o=r),-r>o&&(o=-r),o}function i(A,e,t){var n=m,i=p,r=F,o=D;return e.vsub(A.position,n),n.cross(t,i),A.invInertiaWorld.vmult(i,o),o.cross(n,r),A.invMass+t.dot(r)}function r(A,e,t,n,i,r){if(i.norm2()>1.1)return 0;var o=Y,s=f,a=N;return A.getVelocityAtWorldPoint(e,o),t.getVelocityAtWorldPoint(n,s),o.vsub(s,a),-.2*i.dot(a)*(1/(A.invMass+t.invMass))}var o=(A("./Body"),A("../math/Vec3")),s=A("../math/Quaternion"),a=(A("../collision/RaycastResult"),A("../collision/Ray")),B=A("../objects/WheelInfo");e.exports=t;var c=(new o,new o,new o,new o),g=new o,E=new o;new a,t.prototype.addWheel=function(A){var e=new B(A=A||{}),t=this.wheelInfos.length;return this.wheelInfos.push(e),t},t.prototype.setSteeringValue=function(A,e){this.wheelInfos[e].steering=A},new o,t.prototype.applyEngineForce=function(A,e){this.wheelInfos[e].engineForce=A},t.prototype.setBrake=function(A,e){this.wheelInfos[e].brake=A},t.prototype.addToWorld=function(A){this.constraints,A.add(this.chassisBody);var e=this;this.preStepCallback=function(){e.updateVehicle(A.dt)},A.addEventListener("preStep",this.preStepCallback),this.world=A},t.prototype.getVehicleAxisWorld=function(A,e){e.set(0===A?1:0,1===A?1:0,2===A?1:0),this.chassisBody.vectorToWorldFrame(e,e)},t.prototype.updateVehicle=function(A){for(var e=this.wheelInfos,t=e.length,n=this.chassisBody,i=0;t>i;i++)this.updateWheelTransform(i);this.currentVehicleSpeedKmHour=3.6*n.velocity.norm();var r=new o;for(this.getVehicleAxisWorld(this.indexForwardAxis,r),r.dot(n.velocity)<0&&(this.currentVehicleSpeedKmHour*=-1),i=0;t>i;i++)this.castRay(e[i]);this.updateSuspension(A);var s=new o,a=new o;for(i=0;t>i;i++){var B=(Q=e[i]).suspensionForce;B>Q.maxSuspensionForce&&(B=Q.maxSuspensionForce),Q.raycastResult.hitNormalWorld.scale(B*A,s),Q.raycastResult.hitPointWorld.vsub(n.position,a),n.applyImpulse(s,Q.raycastResult.hitPointWorld)}this.updateFriction(A);var c=new o,g=new o,E=new o;for(i=0;t>i;i++){var Q=e[i];n.getVelocityAtWorldPoint(Q.chassisConnectionPointWorld,E);var u=1;switch(this.indexUpAxis){case 1:u=-1}if(Q.isInContact){this.getVehicleAxisWorld(this.indexForwardAxis,g);var l=g.dot(Q.raycastResult.hitNormalWorld);Q.raycastResult.hitNormalWorld.scale(l,c),g.vsub(c,g);var w=g.dot(E);Q.deltaRotation=u*w*A/Q.radius}!Q.sliding&&Q.isInContact||0===Q.engineForce||!Q.useCustomSlidingRotationalSpeed||(Q.deltaRotation=(Q.engineForce>0?1:-1)*Q.customSlidingRotationalSpeed*A),Math.abs(Q.brake)>Math.abs(Q.engineForce)&&(Q.deltaRotation=0),Q.rotation+=Q.deltaRotation,Q.deltaRotation*=.99}},t.prototype.updateSuspension=function(){for(var A=this.chassisBody.mass,e=this.wheelInfos,t=e.length,n=0;t>n;n++){var i=e[n];if(i.isInContact){var r,o=i.suspensionRestLength-i.suspensionLength;r=i.suspensionStiffness*o*i.clippedInvContactDotSuspension;var s=i.suspensionRelativeVelocity;r-=(0>s?i.dampingCompression:i.dampingRelaxation)*s,i.suspensionForce=r*A,i.suspensionForce<0&&(i.suspensionForce=0)}else i.suspensionForce=0}},t.prototype.removeFromWorld=function(A){this.constraints,A.remove(this.chassisBody),A.removeEventListener("preStep",this.preStepCallback),this.world=null};var Q=new o,u=new o;t.prototype.castRay=function(A){var e=Q,t=u;this.updateWheelTransformWorld(A);var n=this.chassisBody,i=-1,r=A.suspensionRestLength+A.radius;A.directionWorld.scale(r,e);var s=A.chassisConnectionPointWorld;s.vadd(e,t);var a=A.raycastResult;a.reset();var B=n.collisionResponse;n.collisionResponse=!1,this.world.rayTest(s,t,a),n.collisionResponse=B;var c=a.body;if(A.raycastResult.groundObject=0,c){i=a.distance,A.raycastResult.hitNormalWorld=a.hitNormalWorld,A.isInContact=!0;var g=a.distance;A.suspensionLength=g-A.radius;var E=A.suspensionRestLength-A.maxSuspensionTravel,l=A.suspensionRestLength+A.maxSuspensionTravel;A.suspensionLength<E&&(A.suspensionLength=E),A.suspensionLength>l&&(A.suspensionLength=l,A.raycastResult.reset());var w=A.raycastResult.hitNormalWorld.dot(A.directionWorld),h=new o;n.getVelocityAtWorldPoint(A.raycastResult.hitPointWorld,h);var C=A.raycastResult.hitNormalWorld.dot(h);if(w>=-.1)A.suspensionRelativeVelocity=0,A.clippedInvContactDotSuspension=10;else{var I=-1/w;A.suspensionRelativeVelocity=C*I,A.clippedInvContactDotSuspension=I}}else A.suspensionLength=A.suspensionRestLength+0*A.maxSuspensionTravel,A.suspensionRelativeVelocity=0,A.directionWorld.scale(-1,A.raycastResult.hitNormalWorld),A.clippedInvContactDotSuspension=1;return i},t.prototype.updateWheelTransformWorld=function(A){A.isInContact=!1;var e=this.chassisBody;e.pointToWorldFrame(A.chassisConnectionPointLocal,A.chassisConnectionPointWorld),e.vectorToWorldFrame(A.directionLocal,A.directionWorld),e.vectorToWorldFrame(A.axleLocal,A.axleWorld)},t.prototype.updateWheelTransform=function(A){var e=c,t=g,n=E,i=this.wheelInfos[A];this.updateWheelTransformWorld(i),i.directionLocal.scale(-1,e),t.copy(i.axleLocal),e.cross(t,n),n.normalize(),t.normalize();var r=i.steering,o=new s;o.setFromAxisAngle(e,r);var a=new s;a.setFromAxisAngle(t,i.rotation);var B=i.worldTransform.quaternion;this.chassisBody.quaternion.mult(o,B),B.mult(a,B),B.normalize();var Q=i.worldTransform.position;Q.copy(i.directionWorld),Q.scale(i.suspensionLength,Q),Q.vadd(i.chassisConnectionPointWorld,Q)};var l=[new o(1,0,0),new o(0,1,0),new o(0,0,1)];t.prototype.getWheelTransformWorld=function(A){return this.wheelInfos[A].worldTransform};var w=new o,h=[],C=[];t.prototype.updateFriction=function(A){for(var e=w,t=this.wheelInfos,i=t.length,s=this.chassisBody,a=C,B=h,c=0;i>c;c++)u=(f=t[c]).raycastResult.body,f.sideImpulse=0,f.forwardImpulse=0,a[c]||(a[c]=new o),B[c]||(B[c]=new o);for(c=0;i>c;c++)if(u=(f=t[c]).raycastResult.body){var g=B[c];this.getWheelTransformWorld(c).vectorToWorldFrame(l[this.indexRightAxis],g);var E=f.raycastResult.hitNormalWorld,Q=g.dot(E);E.scale(Q,e),g.vsub(e,g),g.normalize(),E.cross(g,a[c]),a[c].normalize(),f.sideImpulse=r(s,f.raycastResult.hitPointWorld,u,f.raycastResult.hitPointWorld,g),f.sideImpulse*=1}for(this.sliding=!1,c=0;i>c;c++){var u=(f=t[c]).raycastResult.body,I=0;if(f.slipInfo=1,u){var M=f.brake?f.brake:0;I=n(s,u,f.raycastResult.hitPointWorld,a[c],M);var d=M/(I+=f.engineForce*A);f.slipInfo*=d}if(f.forwardImpulse=0,f.skidInfo=1,u){f.skidInfo=1;var m=f.suspensionForce*A*f.frictionSlip,p=m*m;f.forwardImpulse=I;var F=.5*f.forwardImpulse,D=1*f.sideImpulse,Y=F*F+D*D;f.sliding=!1,Y>p&&(this.sliding=!0,f.sliding=!0,d=m/Math.sqrt(Y),f.skidInfo*=d)}}if(this.sliding)for(c=0;i>c;c++)0!==(f=t[c]).sideImpulse&&f.skidInfo<1&&(f.forwardImpulse*=f.skidInfo,f.sideImpulse*=f.skidInfo);for(c=0;i>c;c++){var f=t[c],N=new o;if(N.copy(f.raycastResult.hitPointWorld),0!==f.forwardImpulse){var U=new o;a[c].scale(f.forwardImpulse,U),s.applyImpulse(U,N)}if(0!==f.sideImpulse){u=f.raycastResult.body;var y=new o;y.copy(f.raycastResult.hitPointWorld);var T=new o;B[c].scale(f.sideImpulse,T),s.pointToLocalFrame(N,N),N["xyz"[this.indexUpAxis]]*=f.rollInfluence,s.pointToWorldFrame(N,N),s.applyImpulse(T,N),T.scale(-1,T),u.applyImpulse(T,y)}}};var I=new o,M=new o,d=new o,m=new o,p=new o,F=new o,D=new o,Y=new o,f=new o,N=new o},{"../collision/Ray":9,"../collision/RaycastResult":10,"../math/Quaternion":28,"../math/Vec3":30,"../objects/WheelInfo":36,"./Body":31}],33:[function(A,e){function t(A){if(this.wheelBodies=[],this.coordinateSystem=void 0===A.coordinateSystem?new o(1,2,3):A.coordinateSystem.clone(),this.chassisBody=A.chassisBody,!this.chassisBody){var e=new r(new o(5,2,.5));this.chassisBody=new n(1,e)}this.constraints=[],this.wheelAxes=[],this.wheelForces=[]}var n=A("./Body"),i=A("../shapes/Sphere"),r=A("../shapes/Box"),o=A("../math/Vec3"),s=A("../constraints/HingeConstraint");e.exports=t,t.prototype.addWheel=function(A){var e=(A=A||{}).body;e||(e=new n(1,new i(1.2))),this.wheelBodies.push(e),this.wheelForces.push(0);var t=(new o,void 0!==A.position?A.position.clone():new o),r=new o;this.chassisBody.pointToWorldFrame(t,r),e.position.set(r.x,r.y,r.z);var a=void 0!==A.axis?A.axis.clone():new o(0,1,0);this.wheelAxes.push(a);var B=new s(this.chassisBody,e,{pivotA:t,axisA:a,pivotB:o.ZERO,axisB:a,collideConnected:!1});return this.constraints.push(B),this.wheelBodies.length-1},t.prototype.setSteeringValue=function(A,e){var t=this.wheelAxes[e],n=Math.cos(A),i=Math.sin(A),r=t.x,o=t.y;this.constraints[e].axisA.set(n*r-i*o,i*r+n*o,0)},t.prototype.setMotorSpeed=function(A,e){var t=this.constraints[e];t.enableMotor(),t.motorTargetVelocity=A},t.prototype.disableMotor=function(A){this.constraints[A].disableMotor()};var a=new o;t.prototype.setWheelForce=function(A,e){this.wheelForces[e]=A},t.prototype.applyWheelForce=function(A,e){var t=this.wheelAxes[e],n=this.wheelBodies[e],i=n.torque;t.scale(A,a),n.vectorToWorldFrame(a,a),i.vadd(a,i)},t.prototype.addToWorld=function(A){for(var e=this.constraints,t=this.wheelBodies.concat([this.chassisBody]),n=0;n<t.length;n++)A.add(t[n]);for(n=0;n<e.length;n++)A.addConstraint(e[n]);A.addEventListener("preStep",this._update.bind(this))},t.prototype._update=function(){for(var A=this.wheelForces,e=0;e<A.length;e++)this.applyWheelForce(A[e],e)},t.prototype.removeFromWorld=function(A){for(var e=this.constraints,t=this.wheelBodies.concat([this.chassisBody]),n=0;n<t.length;n++)A.remove(t[n]);for(n=0;n<e.length;n++)A.removeConstraint(e[n])};var B=new o;t.prototype.getWheelSpeed=function(A){var e=this.wheelAxes[A],t=this.wheelBodies[A].angularVelocity;return this.chassisBody.vectorToWorldFrame(e,B),t.dot(B)}},{"../constraints/HingeConstraint":15,"../math/Vec3":30,"../shapes/Box":37,"../shapes/Sphere":44,"./Body":31}],34:[function(A,e){function t(){this.particles=[],this.density=1,this.smoothingRadius=1,this.speedOfSound=1,this.viscosity=.01,this.eps=1e-6,this.pressures=[],this.densities=[],this.neighbors=[]}e.exports=t;var n=(A("../shapes/Shape"),A("../math/Vec3"));A("../math/Quaternion"),A("../shapes/Particle"),A("../objects/Body"),A("../material/Material"),t.prototype.add=function(A){this.particles.push(A),this.neighbors.length<this.particles.length&&this.neighbors.push([])},t.prototype.remove=function(A){var e=this.particles.indexOf(A);-1!==e&&(this.particles.splice(e,1),this.neighbors.length>this.particles.length&&this.neighbors.pop())};var i=new n;t.prototype.getNeighbors=function(A,e){for(var t=this.particles.length,n=A.id,r=this.smoothingRadius*this.smoothingRadius,o=i,s=0;s!==t;s++){var a=this.particles[s];a.position.vsub(A.position,o),n!==a.id&&o.norm2()<r&&e.push(a)}};var r=new n,o=new n,s=new n,a=new n,B=new n,c=new n;t.prototype.update=function(){for(var A=this.particles.length,e=r,t=this.speedOfSound,n=this.eps,i=0;i!==A;i++){var g=this.particles[i];(F=this.neighbors[i]).length=0,this.getNeighbors(g,F),F.push(this.particles[i]);for(var E=F.length,Q=0,u=0;u!==E;u++){g.position.vsub(F[u].position,e);var l=e.norm(),w=this.w(l);Q+=F[u].mass*w}this.densities[i]=Q,this.pressures[i]=t*t*(this.densities[i]-this.density)}var h=o,C=s,I=a,M=B,d=c;for(i=0;i!==A;i++){var m,p,F,D=this.particles[i];for(h.set(0,0,0),C.set(0,0,0),E=(F=this.neighbors[i]).length,u=0;u!==E;u++){var Y=F[u];D.position.vsub(Y.position,M);var f=M.norm();m=-Y.mass*(this.pressures[i]/(this.densities[i]*this.densities[i]+n)+this.pressures[u]/(this.densities[u]*this.densities[u]+n)),this.gradw(M,I),I.mult(m,I),h.vadd(I,h),Y.velocity.vsub(D.velocity,d),d.mult(1/(1e-4+this.densities[i]*this.densities[u])*this.viscosity*Y.mass,d),p=this.nablaw(f),d.mult(p,d),C.vadd(d,C)}C.mult(D.mass,C),h.mult(D.mass,h),D.force.vadd(C,D.force),D.force.vadd(h,D.force)}},t.prototype.w=function(A){var e=this.smoothingRadius;return 315/(64*Math.PI*Math.pow(e,9))*Math.pow(e*e-A*A,3)},t.prototype.gradw=function(A,e){var t=A.norm(),n=this.smoothingRadius;A.mult(945/(32*Math.PI*Math.pow(n,9))*Math.pow(n*n-t*t,2),e)},t.prototype.nablaw=function(A){var e=this.smoothingRadius;return 945/(32*Math.PI*Math.pow(e,9))*(e*e-A*A)*(7*A*A-3*e*e)}},{"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Particle":41,"../shapes/Shape":43}],35:[function(A,e){function t(A,e,t){t=t||{},this.restLength="number"==typeof t.restLength?t.restLength:1,this.stiffness=t.stiffness||100,this.damping=t.damping||1,this.bodyA=A,this.bodyB=e,this.localAnchorA=new n,this.localAnchorB=new n,t.localAnchorA&&this.localAnchorA.copy(t.localAnchorA),t.localAnchorB&&this.localAnchorB.copy(t.localAnchorB),t.worldAnchorA&&this.setWorldAnchorA(t.worldAnchorA),t.worldAnchorB&&this.setWorldAnchorB(t.worldAnchorB)}var n=A("../math/Vec3");e.exports=t,t.prototype.setWorldAnchorA=function(A){this.bodyA.pointToLocalFrame(A,this.localAnchorA)},t.prototype.setWorldAnchorB=function(A){this.bodyB.pointToLocalFrame(A,this.localAnchorB)},t.prototype.getWorldAnchorA=function(A){this.bodyA.pointToWorldFrame(this.localAnchorA,A)},t.prototype.getWorldAnchorB=function(A){this.bodyB.pointToWorldFrame(this.localAnchorB,A)};var i=new n,r=new n,o=new n,s=new n,a=new n,B=new n,c=new n,g=new n,E=new n,Q=new n,u=new n;t.prototype.applyForce=function(){var A=this.stiffness,e=this.damping,t=this.restLength,n=this.bodyA,l=this.bodyB,w=i,h=r,C=o,I=s,M=u,d=a,m=B,p=c,F=g,D=E,Y=Q;this.getWorldAnchorA(d),this.getWorldAnchorB(m),d.vsub(n.position,p),m.vsub(l.position,F),m.vsub(d,w);var f=w.norm();h.copy(w),h.normalize(),l.velocity.vsub(n.velocity,C),l.angularVelocity.cross(F,M),C.vadd(M,C),n.angularVelocity.cross(p,M),C.vsub(M,C),h.mult(-A*(f-t)-e*C.dot(h),I),n.force.vsub(I,n.force),l.force.vadd(I,l.force),p.cross(I,D),F.cross(I,Y),n.torque.vsub(D,n.torque),l.torque.vadd(Y,l.torque)}},{"../math/Vec3":30}],36:[function(A,e){function t(A){A=o.defaults(A,{chassisConnectionPointLocal:new n,chassisConnectionPointWorld:new n,directionLocal:new n,directionWorld:new n,axleLocal:new n,axleWorld:new n,suspensionRestLength:1,suspensionMaxLength:2,radius:1,suspensionStiffness:100,dampingCompression:10,dampingRelaxation:10,frictionSlip:1e4,steering:0,rotation:0,deltaRotation:0,rollInfluence:.01,maxSuspensionForce:Number.MAX_VALUE,isFrontWheel:!0,clippedInvContactDotSuspension:1,suspensionRelativeVelocity:0,suspensionForce:0,skidInfo:0,suspensionLength:0,maxSuspensionTravel:1,useCustomSlidingRotationalSpeed:!1,customSlidingRotationalSpeed:-.1}),this.maxSuspensionTravel=A.maxSuspensionTravel,this.customSlidingRotationalSpeed=A.customSlidingRotationalSpeed,this.useCustomSlidingRotationalSpeed=A.useCustomSlidingRotationalSpeed,this.sliding=!1,this.chassisConnectionPointLocal=A.chassisConnectionPointLocal.clone(),this.chassisConnectionPointWorld=A.chassisConnectionPointWorld.clone(),this.directionLocal=A.directionLocal.clone(),this.directionWorld=A.directionWorld.clone(),this.axleLocal=A.axleLocal.clone(),this.axleWorld=A.axleWorld.clone(),this.suspensionRestLength=A.suspensionRestLength,this.suspensionMaxLength=A.suspensionMaxLength,this.radius=A.radius,this.suspensionStiffness=A.suspensionStiffness,this.dampingCompression=A.dampingCompression,this.dampingRelaxation=A.dampingRelaxation,this.frictionSlip=A.frictionSlip,this.steering=0,this.rotation=0,this.deltaRotation=0,this.rollInfluence=A.rollInfluence,this.maxSuspensionForce=A.maxSuspensionForce,this.engineForce=0,this.brake=0,this.isFrontWheel=A.isFrontWheel,this.clippedInvContactDotSuspension=1,this.suspensionRelativeVelocity=0,this.suspensionForce=0,this.skidInfo=0,this.suspensionLength=0,this.sideImpulse=0,this.forwardImpulse=0,this.raycastResult=new r,this.worldTransform=new i,this.isInContact=!1}var n=A("../math/Vec3"),i=A("../math/Transform"),r=A("../collision/RaycastResult"),o=A("../utils/Utils");e.exports=t;var s=new n,a=new n;s=new n,t.prototype.updateWheel=function(A){var e=this.raycastResult;if(this.isInContact){var t=e.hitNormalWorld.dot(e.directionWorld);e.hitPointWorld.vsub(A.position,a),A.getVelocityAtWorldPoint(a,s);var n=e.hitNormalWorld.dot(s);if(t>=-.1)this.suspensionRelativeVelocity=0,this.clippedInvContactDotSuspension=10;else{var i=-1/t;this.suspensionRelativeVelocity=n*i,this.clippedInvContactDotSuspension=i}}else e.suspensionLength=this.suspensionRestLength,this.suspensionRelativeVelocity=0,e.directionWorld.scale(-1,e.hitNormalWorld),this.clippedInvContactDotSuspension=1}},{"../collision/RaycastResult":10,"../math/Transform":29,"../math/Vec3":30,"../utils/Utils":53}],37:[function(A,e){function t(A){n.call(this),this.type=n.types.BOX,this.halfExtents=A,this.convexPolyhedronRepresentation=null,this.updateConvexPolyhedronRepresentation(),this.updateBoundingSphereRadius()}e.exports=t;var n=A("./Shape"),i=A("../math/Vec3"),r=A("./ConvexPolyhedron");t.prototype=new n,t.prototype.constructor=t,t.prototype.updateConvexPolyhedronRepresentation=function(){var A=this.halfExtents.x,e=this.halfExtents.y,t=this.halfExtents.z,n=i,o=[new n(-A,-e,-t),new n(A,-e,-t),new n(A,e,-t),new n(-A,e,-t),new n(-A,-e,t),new n(A,-e,t),new n(A,e,t),new n(-A,e,t)],s=(new n(0,0,1),new n(0,1,0),new n(1,0,0),new r(o,[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]]));this.convexPolyhedronRepresentation=s,s.material=this.material},t.prototype.calculateLocalInertia=function(A,e){return e=e||new i,t.calculateInertia(this.halfExtents,A,e),e},t.calculateInertia=function(A,e,t){var n=A;t.x=1/12*e*(2*n.y*2*n.y+2*n.z*2*n.z),t.y=1/12*e*(2*n.x*2*n.x+2*n.z*2*n.z),t.z=1/12*e*(2*n.y*2*n.y+2*n.x*2*n.x)},t.prototype.getSideNormals=function(A,e){var t=A,n=this.halfExtents;if(t[0].set(n.x,0,0),t[1].set(0,n.y,0),t[2].set(0,0,n.z),t[3].set(-n.x,0,0),t[4].set(0,-n.y,0),t[5].set(0,0,-n.z),void 0!==e)for(var i=0;i!==t.length;i++)e.vmult(t[i],t[i]);return t},t.prototype.volume=function(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z},t.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=this.halfExtents.norm()};var o=new i;new i,t.prototype.forEachWorldCorner=function(A,e,t){for(var n=this.halfExtents,i=[[n.x,n.y,n.z],[-n.x,n.y,n.z],[-n.x,-n.y,n.z],[-n.x,-n.y,-n.z],[n.x,-n.y,-n.z],[n.x,n.y,-n.z],[-n.x,n.y,-n.z],[n.x,-n.y,n.z]],r=0;r<i.length;r++)o.set(i[r][0],i[r][1],i[r][2]),e.vmult(o,o),A.vadd(o,o),t(o.x,o.y,o.z)};var s=[new i,new i,new i,new i,new i,new i,new i,new i];t.prototype.calculateWorldAABB=function(A,e,t,n){var i=this.halfExtents;s[0].set(i.x,i.y,i.z),s[1].set(-i.x,i.y,i.z),s[2].set(-i.x,-i.y,i.z),s[3].set(-i.x,-i.y,-i.z),s[4].set(i.x,-i.y,-i.z),s[5].set(i.x,i.y,-i.z),s[6].set(-i.x,i.y,-i.z),s[7].set(i.x,-i.y,i.z);var r=s[0];e.vmult(r,r),A.vadd(r,r),n.copy(r),t.copy(r);for(var o=1;8>o;o++){r=s[o],e.vmult(r,r),A.vadd(r,r);var a=r.x,B=r.y,c=r.z;a>n.x&&(n.x=a),B>n.y&&(n.y=B),c>n.z&&(n.z=c),a<t.x&&(t.x=a),B<t.y&&(t.y=B),c<t.z&&(t.z=c)}}},{"../math/Vec3":30,"./ConvexPolyhedron":38,"./Shape":43}],38:[function(A,e){function t(A,e,t){n.call(this),this.type=n.types.CONVEXPOLYHEDRON,this.vertices=A||[],this.worldVertices=[],this.worldVerticesNeedsUpdate=!0,this.faces=e||[],this.faceNormals=[],this.computeNormals(),this.worldFaceNormalsNeedsUpdate=!0,this.worldFaceNormals=[],this.uniqueEdges=[],this.uniqueAxes=t?t.slice():null,this.computeEdges(),this.updateBoundingSphereRadius()}e.exports=t;var n=A("./Shape"),i=A("../math/Vec3"),r=(A("../math/Quaternion"),A("../math/Transform"));t.prototype=new n,t.prototype.constructor=t;var o=new i;t.prototype.computeEdges=function(){var A=this.faces,e=this.vertices,t=(e.length,this.uniqueEdges);t.length=0;for(var n=o,i=0;i!==A.length;i++)for(var r=A[i],s=r.length,a=0;a!==s;a++){var B=(a+1)%s;e[r[a]].vsub(e[r[B]],n),n.normalize();for(var c=!1,g=0;g!==t.length;g++)if(t[g].almostEquals(n)||t[g].almostEquals(n)){c=!0;break}c||t.push(n.clone())}},t.prototype.computeNormals=function(){this.faceNormals.length=this.faces.length;for(var A=0;A<this.faces.length;A++){for(var e=0;e<this.faces[A].length;e++)if(!this.vertices[this.faces[A][e]])throw new Error("Vertex "+this.faces[A][e]+" not found!");var t=this.faceNormals[A]||new i;this.getFaceNormal(A,t),t.negate(t),this.faceNormals[A]=t;var n=this.vertices[this.faces[A][0]];if(t.dot(n)<0)for(console.error(".faceNormals["+A+"] = Vec3("+t.toString()+") looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule."),e=0;e<this.faces[A].length;e++)console.warn(".vertices["+this.faces[A][e]+"] = Vec3("+this.vertices[this.faces[A][e]].toString()+")")}};var s=new i,a=new i;t.computeNormal=function(A,e,t,n){e.vsub(A,a),t.vsub(e,s),s.cross(a,n),n.isZero()||n.normalize()},t.prototype.getFaceNormal=function(A,e){var n=this.faces[A],i=this.vertices[n[0]],r=this.vertices[n[1]],o=this.vertices[n[2]];return t.computeNormal(i,r,o,e)};var B=new i;t.prototype.clipAgainstHull=function(A,e,t,n,r,o,s,a,c){for(var g=B,E=-1,Q=-Number.MAX_VALUE,u=0;u<t.faces.length;u++){g.copy(t.faceNormals[u]),r.vmult(g,g);var l=g.dot(o);l>Q&&(Q=l,E=u)}for(var w=[],h=t.faces[E],C=h.length,I=0;C>I;I++){var M=t.vertices[h[I]],d=new i;d.copy(M),r.vmult(d,d),n.vadd(d,d),w.push(d)}E>=0&&this.clipFaceAgainstHull(o,A,e,w,s,a,c)};var c=new i,g=new i,E=new i,Q=new i,u=new i,l=new i;t.prototype.findSeparatingAxis=function(A,e,t,n,i,r,o,s){var a=c,B=g,w=E,h=Q,C=u,I=l,M=Number.MAX_VALUE,d=this;if(d.uniqueAxes)for(var m=0;m!==d.uniqueAxes.length;m++){if(t.vmult(d.uniqueAxes[m],a),!1===(Y=d.testSepAxis(a,A,e,t,n,i)))return!1;M>Y&&(M=Y,r.copy(a))}else{var p=o?o.length:d.faces.length;for(m=0;p>m;m++){var F=o?o[m]:m;if(a.copy(d.faceNormals[F]),t.vmult(a,a),!1===(Y=d.testSepAxis(a,A,e,t,n,i)))return!1;M>Y&&(M=Y,r.copy(a))}}if(A.uniqueAxes)for(m=0;m!==A.uniqueAxes.length;m++){if(i.vmult(A.uniqueAxes[m],B),!1===(Y=d.testSepAxis(B,A,e,t,n,i)))return!1;M>Y&&(M=Y,r.copy(B))}else{var D=s?s.length:A.faces.length;for(m=0;D>m;m++){var Y;if(F=s?s[m]:m,B.copy(A.faceNormals[F]),i.vmult(B,B),!1===(Y=d.testSepAxis(B,A,e,t,n,i)))return!1;M>Y&&(M=Y,r.copy(B))}}for(var f=0;f!==d.uniqueEdges.length;f++){t.vmult(d.uniqueEdges[f],h);for(var N=0;N!==A.uniqueEdges.length;N++)if(i.vmult(A.uniqueEdges[N],C),h.cross(C,I),!I.almostZero()){I.normalize();var U=d.testSepAxis(I,A,e,t,n,i);if(!1===U)return!1;M>U&&(M=U,r.copy(I))}}return n.vsub(e,w),w.dot(r)>0&&r.negate(r),!0};var w=[],h=[];t.prototype.testSepAxis=function(A,e,n,i,r,o){t.project(this,A,n,i,w),t.project(e,A,r,o,h);var s=w[0],a=w[1],B=h[0],c=h[1];if(c>s||a>B)return!1;var g=s-c,E=B-a;return E>g?g:E};var C=new i,I=new i;t.prototype.calculateLocalInertia=function(A,e){this.computeLocalAABB(C,I);var t=I.x-C.x,n=I.y-C.y,i=I.z-C.z;e.x=1/12*A*(2*n*2*n+2*i*2*i),e.y=1/12*A*(2*t*2*t+2*i*2*i),e.z=1/12*A*(2*n*2*n+2*t*2*t)},t.prototype.getPlaneConstantOfFace=function(A){var e=this.faces[A],t=this.faceNormals[A],n=this.vertices[e[0]];return-t.dot(n)};var M=new i,d=new i,m=new i,p=new i,F=new i,D=new i,Y=new i,f=new i;t.prototype.clipFaceAgainstHull=function(A,e,t,n,i,r,o){for(var s=M,a=d,B=m,c=p,g=F,E=D,Q=Y,u=f,l=this,w=n,h=[],C=-1,I=Number.MAX_VALUE,N=0;N<l.faces.length;N++){s.copy(l.faceNormals[N]),t.vmult(s,s);var U=s.dot(A);I>U&&(I=U,C=N)}if(!(0>C)){var y=l.faces[C];y.connectedFaces=[];for(var T=0;T<l.faces.length;T++)for(var x=0;x<l.faces[T].length;x++)-1!==y.indexOf(l.faces[T][x])&&T!==C&&-1===y.connectedFaces.indexOf(T)&&y.connectedFaces.push(T);for(var R=(w.length,y.length),G=0;R>G;G++){var S=l.vertices[y[G]],H=l.vertices[y[(G+1)%R]];S.vsub(H,a),B.copy(a),t.vmult(B,B),e.vadd(B,B),c.copy(this.faceNormals[C]),t.vmult(c,c),e.vadd(c,c),B.cross(c,g),g.negate(g),E.copy(S),t.vmult(E,E),e.vadd(E,E);var b=(E.dot(g),y.connectedFaces[G]);Q.copy(this.faceNormals[b]);var v=this.getPlaneConstantOfFace(b);u.copy(Q),t.vmult(u,u);var k=v-u.dot(e);for(this.clipFaceAgainstPlane(w,h,u,k);w.length;)w.shift();for(;h.length;)w.push(h.shift())}for(Q.copy(this.faceNormals[C]),v=this.getPlaneConstantOfFace(C),u.copy(Q),t.vmult(u,u),k=v-u.dot(e),T=0;T<w.length;T++){var j=u.dot(w[T])+k;if(i>=j&&(console.log("clamped: depth="+j+" to minDist="+i),j=i),r>=j){var J=w[T];if(0>=j){var z={point:J,normal:u,depth:j};o.push(z)}}}}},t.prototype.clipFaceAgainstPlane=function(A,e,t,n){var r,o,s=A.length;if(2>s)return e;var a=A[A.length-1],B=A[0];r=t.dot(a)+n;for(var c=0;s>c;c++){if(B=A[c],o=t.dot(B)+n,0>r)if(0>o)(g=new i).copy(B),e.push(g);else{var g=new i;a.lerp(B,r/(r-o),g),e.push(g)}else 0>o&&(g=new i,a.lerp(B,r/(r-o),g),e.push(g),e.push(B));a=B,r=o}return e},t.prototype.computeWorldVertices=function(A,e){for(var t=this.vertices.length;this.worldVertices.length<t;)this.worldVertices.push(new i);for(var n=this.vertices,r=this.worldVertices,o=0;o!==t;o++)e.vmult(n[o],r[o]),A.vadd(r[o],r[o]);this.worldVerticesNeedsUpdate=!1},new i,t.prototype.computeLocalAABB=function(A,e){var t=this.vertices.length,n=this.vertices;A.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),e.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(var i=0;t>i;i++){var r=n[i];r.x<A.x?A.x=r.x:r.x>e.x&&(e.x=r.x),r.y<A.y?A.y=r.y:r.y>e.y&&(e.y=r.y),r.z<A.z?A.z=r.z:r.z>e.z&&(e.z=r.z)}},t.prototype.computeWorldFaceNormals=function(A){for(var e=this.faceNormals.length;this.worldFaceNormals.length<e;)this.worldFaceNormals.push(new i);for(var t=this.faceNormals,n=this.worldFaceNormals,r=0;r!==e;r++)A.vmult(t[r],n[r]);this.worldFaceNormalsNeedsUpdate=!1},t.prototype.updateBoundingSphereRadius=function(){for(var A=0,e=this.vertices,t=0,n=e.length;t!==n;t++){var i=e[t].norm2();i>A&&(A=i)}this.boundingSphereRadius=Math.sqrt(A)};var N=new i;t.prototype.calculateWorldAABB=function(A,e,t,n){for(var i,r,o,s,a,B,c=this.vertices.length,g=this.vertices,E=0;c>E;E++){N.copy(g[E]),e.vmult(N,N),A.vadd(N,N);var Q=N;Q.x<i||void 0===i?i=Q.x:(Q.x>s||void 0===s)&&(s=Q.x),Q.y<r||void 0===r?r=Q.y:(Q.y>a||void 0===a)&&(a=Q.y),Q.z<o||void 0===o?o=Q.z:(Q.z>B||void 0===B)&&(B=Q.z)}t.set(i,r,o),n.set(s,a,B)},t.prototype.volume=function(){return 4*Math.PI*this.boundingSphereRadius/3},t.prototype.getAveragePointLocal=function(A){A=A||new i;for(var e=this.vertices.length,t=this.vertices,n=0;e>n;n++)A.vadd(t[n],A);return A.mult(1/e,A),A},t.prototype.transformAllPoints=function(A,e){var t=this.vertices.length,n=this.vertices;if(e){for(var i=0;t>i;i++){var r=n[i];e.vmult(r,r)}for(i=0;i<this.faceNormals.length;i++)r=this.faceNormals[i],e.vmult(r,r)}if(A)for(i=0;t>i;i++)(r=n[i]).vadd(A,r)};var U=new i,y=new i,T=new i;t.prototype.pointIsInside=function(A){var e=this.vertices.length,t=this.vertices,n=this.faces,i=this.faceNormals,r=this.faces.length,o=U;this.getAveragePointLocal(o);for(var s=0;r>s;s++){this.faces[s].length,e=i[s];var a=t[n[s][0]],B=y;A.vsub(a,B);var c=e.dot(B),g=T;o.vsub(a,g);var E=e.dot(g);if(0>c&&E>0||c>0&&0>E)return!1}return-1};var x=(new i,new i),R=new i;t.project=function(A,e,t,n,i){var o=A.vertices.length,s=x,a=0,B=0,c=R,g=A.vertices;c.setZero(),r.vectorToLocalFrame(t,n,e,s),r.pointToLocalFrame(t,n,c,c);var E=c.dot(s);B=a=g[0].dot(s);for(var Q=1;o>Q;Q++){var u=g[Q].dot(s);u>a&&(a=u),B>u&&(B=u)}if((B-=E)>(a-=E)){var l=B;B=a,a=l}i[0]=a,i[1]=B}},{"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"./Shape":43}],39:[function(A,e){function t(A,e,t,o){var s=o,a=[],B=[],c=[],g=[],E=[],Q=Math.cos,u=Math.sin;a.push(new i(e*Q(0),e*u(0),.5*-t)),g.push(0),a.push(new i(A*Q(0),A*u(0),.5*t)),E.push(1);for(var l=0;s>l;l++){var w=2*Math.PI/s*(l+1),h=2*Math.PI/s*(l+.5);s-1>l?(a.push(new i(e*Q(w),e*u(w),.5*-t)),g.push(2*l+2),a.push(new i(A*Q(w),A*u(w),.5*t)),E.push(2*l+3),c.push([2*l+2,2*l+3,2*l+1,2*l])):c.push([0,1,2*l+1,2*l]),(s%2==1||s/2>l)&&B.push(new i(Q(h),u(h),0))}c.push(E),B.push(new i(0,0,1));var C=[];for(l=0;l<g.length;l++)C.push(g[g.length-l-1]);c.push(C),this.type=n.types.CONVEXPOLYHEDRON,r.call(this,a,c,B)}e.exports=t;var n=A("./Shape"),i=A("../math/Vec3"),r=(A("../math/Quaternion"),A("./ConvexPolyhedron"));t.prototype=new r},{"../math/Quaternion":28,"../math/Vec3":30,"./ConvexPolyhedron":38,"./Shape":43}],40:[function(A,e){function t(A,e){e=o.defaults(e,{maxValue:null,minValue:null,elementSize:1}),this.data=A,this.maxValue=e.maxValue,this.minValue=e.minValue,this.elementSize=e.elementSize,null===e.minValue&&this.updateMinValue(),null===e.maxValue&&this.updateMaxValue(),this.cacheEnabled=!0,n.call(this),this.pillarConvex=new i,this.pillarOffset=new r,this.type=n.types.HEIGHTFIELD,this.updateBoundingSphereRadius(),this._cachedPillars={}}var n=A("./Shape"),i=A("./ConvexPolyhedron"),r=A("../math/Vec3"),o=A("../utils/Utils");e.exports=t,t.prototype=new n,t.prototype.update=function(){this._cachedPillars={}},t.prototype.updateMinValue=function(){for(var A=this.data,e=A[0][0],t=0;t!==A.length;t++)for(var n=0;n!==A[t].length;n++){var i=A[t][n];e>i&&(e=i)}this.minValue=e},t.prototype.updateMaxValue=function(){for(var A=this.data,e=A[0][0],t=0;t!==A.length;t++)for(var n=0;n!==A[t].length;n++){var i=A[t][n];i>e&&(e=i)}this.maxValue=e},t.prototype.setHeightValueAtIndex=function(A,e,t){this.data[A][e]=t,this.clearCachedConvexTrianglePillar(A,e,!1),A>0&&(this.clearCachedConvexTrianglePillar(A-1,e,!0),this.clearCachedConvexTrianglePillar(A-1,e,!1)),e>0&&(this.clearCachedConvexTrianglePillar(A,e-1,!0),this.clearCachedConvexTrianglePillar(A,e-1,!1)),e>0&&A>0&&this.clearCachedConvexTrianglePillar(A-1,e-1,!0)},t.prototype.getRectMinMax=function(A,e,t,n,i){i=i||[];for(var r=this.data,o=this.minValue,s=A;t>=s;s++)for(var a=e;n>=a;a++){var B=r[s][a];B>o&&(o=B)}i[0]=this.minValue,i[1]=o},t.prototype.getIndexOfPosition=function(A,e,t,n){var i=this.elementSize,r=this.data,o=Math.floor(A/i),s=Math.floor(e/i);return t[0]=o,t[1]=s,n&&(0>o&&(o=0),0>s&&(s=0),o>=r.length-1&&(o=r.length-1),s>=r[0].length-1&&(s=r[0].length-1)),!(0>o||0>s||o>=r.length-1||s>=r[0].length-1)},t.prototype.getHeightAt=function(A,e,t){var n=[];this.getIndexOfPosition(A,e,n,t);var i=[];return this.getRectMinMax(n[0],n[1]+1,n[0],n[1]+1,i),(i[0]+i[1])/2},t.prototype.getCacheConvexTrianglePillarKey=function(A,e,t){return A+"_"+e+"_"+(t?1:0)},t.prototype.getCachedConvexTrianglePillar=function(A,e,t){return this._cachedPillars[this.getCacheConvexTrianglePillarKey(A,e,t)]},t.prototype.setCachedConvexTrianglePillar=function(A,e,t,n,i){this._cachedPillars[this.getCacheConvexTrianglePillarKey(A,e,t)]={convex:n,offset:i}},t.prototype.clearCachedConvexTrianglePillar=function(A,e,t){delete this._cachedPillars[this.getCacheConvexTrianglePillarKey(A,e,t)]},t.prototype.getConvexTrianglePillar=function(A,e,t){var n=this.pillarConvex,o=this.pillarOffset;if(this.cacheEnabled){if(s=this.getCachedConvexTrianglePillar(A,e,t))return this.pillarConvex=s.convex,void(this.pillarOffset=s.offset);n=new i,o=new r,this.pillarConvex=n,this.pillarOffset=o}var s=this.data,a=this.elementSize,B=n.faces;n.vertices.length=6;for(var c=0;6>c;c++)n.vertices[c]||(n.vertices[c]=new r);for(B.length=5,c=0;5>c;c++)B[c]||(B[c]=[]);var g=n.vertices,E=(Math.min(s[A][e],s[A+1][e],s[A][e+1],s[A+1][e+1])-this.minValue)/2+this.minValue;t?(o.set((A+.75)*a,(e+.75)*a,E),g[0].set(.25*a,.25*a,s[A+1][e+1]-E),g[1].set(-.75*a,.25*a,s[A][e+1]-E),g[2].set(.25*a,-.75*a,s[A+1][e]-E),g[3].set(.25*a,.25*a,-E-1),g[4].set(-.75*a,.25*a,-E-1),g[5].set(.25*a,-.75*a,-E-1),B[0][0]=0,B[0][1]=1,B[0][2]=2,B[1][0]=5,B[1][1]=4,B[1][2]=3,B[2][0]=2,B[2][1]=5,B[2][2]=3,B[2][3]=0,B[3][0]=3,B[3][1]=4,B[3][2]=1,B[3][3]=0,B[4][0]=1,B[4][1]=4,B[4][2]=5,B[4][3]=2):(o.set((A+.25)*a,(e+.25)*a,E),g[0].set(-.25*a,-.25*a,s[A][e]-E),g[1].set(.75*a,-.25*a,s[A+1][e]-E),g[2].set(-.25*a,.75*a,s[A][e+1]-E),g[3].set(-.25*a,-.25*a,-E-1),g[4].set(.75*a,-.25*a,-E-1),g[5].set(-.25*a,.75*a,-E-1),B[0][0]=0,B[0][1]=1,B[0][2]=2,B[1][0]=5,B[1][1]=4,B[1][2]=3,B[2][0]=0,B[2][1]=2,B[2][2]=5,B[2][3]=3,B[3][0]=1,B[3][1]=0,B[3][2]=3,B[3][3]=4,B[4][0]=4,B[4][1]=5,B[4][2]=2,B[4][3]=1),n.computeNormals(),n.computeEdges(),n.updateBoundingSphereRadius(),this.setCachedConvexTrianglePillar(A,e,t,n,o)},t.prototype.calculateLocalInertia=function(A,e){return(e=e||new r).set(0,0,0),e},t.prototype.volume=function(){return Number.MAX_VALUE},t.prototype.calculateWorldAABB=function(A,e,t,n){t.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),n.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)},t.prototype.updateBoundingSphereRadius=function(){var A=this.data,e=this.elementSize;this.boundingSphereRadius=new r(A.length*e,A[0].length*e,Math.max(Math.abs(this.maxValue),Math.abs(this.minValue))).norm()}},{"../math/Vec3":30,"../utils/Utils":53,"./ConvexPolyhedron":38,"./Shape":43}],41:[function(A,e){function t(){n.call(this),this.type=n.types.PARTICLE}e.exports=t;var n=A("./Shape"),i=A("../math/Vec3");t.prototype=new n,t.prototype.constructor=t,t.prototype.calculateLocalInertia=function(A,e){return(e=e||new i).set(0,0,0),e},t.prototype.volume=function(){return 0},t.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=0},t.prototype.calculateWorldAABB=function(A,e,t,n){t.copy(A),n.copy(A)}},{"../math/Vec3":30,"./Shape":43}],42:[function(A,e){function t(){n.call(this),this.type=n.types.PLANE,this.worldNormal=new i,this.worldNormalNeedsUpdate=!0,this.boundingSphereRadius=Number.MAX_VALUE}e.exports=t;var n=A("./Shape"),i=A("../math/Vec3");t.prototype=new n,t.prototype.constructor=t,t.prototype.computeWorldNormal=function(A){var e=this.worldNormal;e.set(0,0,1),A.vmult(e,e),this.worldNormalNeedsUpdate=!1},t.prototype.calculateLocalInertia=function(A,e){return e||new i},t.prototype.volume=function(){return Number.MAX_VALUE};var r=new i;t.prototype.calculateWorldAABB=function(A,e,t,n){r.set(0,0,1),e.vmult(r,r);var i=Number.MAX_VALUE;t.set(-i,-i,-i),n.set(i,i,i),1===r.x&&(n.x=A.x),1===r.y&&(n.y=A.y),1===r.z&&(n.z=A.z),-1===r.x&&(t.x=A.x),-1===r.y&&(t.y=A.y),-1===r.z&&(t.z=A.z)},t.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=Number.MAX_VALUE}},{"../math/Vec3":30,"./Shape":43}],43:[function(A,e){function t(){this.id=t.idCounter++,this.type=0,this.boundingSphereRadius=0,this.collisionResponse=!0,this.material=null}e.exports=t;var t=A("./Shape");A("../math/Vec3"),A("../math/Quaternion"),A("../material/Material"),t.prototype.constructor=t,t.prototype.updateBoundingSphereRadius=function(){throw"computeBoundingSphereRadius() not implemented for shape type "+this.type},t.prototype.volume=function(){throw"volume() not implemented for shape type "+this.type},t.prototype.calculateLocalInertia=function(){throw"calculateLocalInertia() not implemented for shape type "+this.type},t.idCounter=0,t.types={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256}},{"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"./Shape":43}],44:[function(A,e){function t(A){if(n.call(this),this.radius=void 0!==A?Number(A):1,this.type=n.types.SPHERE,this.radius<0)throw new Error("The sphere radius cannot be negative.");this.updateBoundingSphereRadius()}e.exports=t;var n=A("./Shape"),i=A("../math/Vec3");t.prototype=new n,t.prototype.constructor=t,t.prototype.calculateLocalInertia=function(A,e){e=e||new i;var t=2*A*this.radius*this.radius/5;return e.x=t,e.y=t,e.z=t,e},t.prototype.volume=function(){return 4*Math.PI*this.radius/3},t.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=this.radius},t.prototype.calculateWorldAABB=function(A,e,t,n){for(var i=this.radius,r=["x","y","z"],o=0;o<r.length;o++){var s=r[o];t[s]=A[s]-i,n[s]=A[s]+i}}},{"../math/Vec3":30,"./Shape":43}],45:[function(A,e){function t(A,e){n.call(this),this.type=n.types.TRIMESH,this.vertices=new Float32Array(A),this.indices=new Int16Array(e),this.normals=new Float32Array(e.length),this.aabb=new o,this.edges=null,this.scale=new i(1,1,1),this.tree=new s,this.updateEdges(),this.updateNormals(),this.updateAABB(),this.updateBoundingSphereRadius(),this.updateTree()}e.exports=t;var n=A("./Shape"),i=A("../math/Vec3"),r=(A("../math/Quaternion"),A("../math/Transform")),o=A("../collision/AABB"),s=A("../utils/Octree");t.prototype=new n,t.prototype.constructor=t;var a=new i;t.prototype.updateTree=function(){var A=this.tree;A.reset(),A.aabb.copy(this.aabb);var e=this.scale;A.aabb.lowerBound.x*=1/e.x,A.aabb.lowerBound.y*=1/e.y,A.aabb.lowerBound.z*=1/e.z,A.aabb.upperBound.x*=1/e.x,A.aabb.upperBound.y*=1/e.y,A.aabb.upperBound.z*=1/e.z;for(var t=new o,n=new i,r=new i,s=new i,a=[n,r,s],B=0;B<this.indices.length/3;B++){var c=3*B;this._getUnscaledVertex(this.indices[c],n),this._getUnscaledVertex(this.indices[c+1],r),this._getUnscaledVertex(this.indices[c+2],s),t.setFromPoints(a),A.insert(t,B)}A.removeEmptyNodes()};var B=new o;t.prototype.getTrianglesInAABB=function(A,e){B.copy(A);var t=this.scale,n=t.x,i=t.y,r=t.z,o=B.lowerBound,s=B.upperBound;return o.x/=n,o.y/=i,o.z/=r,s.x/=n,s.y/=i,s.z/=r,this.tree.aabbQuery(B,e)},t.prototype.setScale=function(A){var e=this.scale.x===this.scale.y===this.scale.z,t=A.x===A.y===A.z;e&&t||this.updateNormals(),this.scale.copy(A),this.updateAABB(),this.updateBoundingSphereRadius()},t.prototype.updateNormals=function(){for(var A=a,e=this.normals,n=0;n<this.indices.length/3;n++){var i=3*n,r=this.indices[i],o=this.indices[i+1],s=this.indices[i+2];this.getVertex(r,u),this.getVertex(o,l),this.getVertex(s,w),t.computeNormal(l,u,w,A),e[i]=A.x,e[i+1]=A.y,e[i+2]=A.z}},t.prototype.updateEdges=function(){for(var A={},e=function(){var e=r>i?i+"_"+r:r+"_"+i;A[e]=!0},t=0;t<this.indices.length/3;t++){var n=3*t,i=this.indices[n],r=this.indices[n+1];this.indices[n+2],e(),e(),e()}var o=Object.keys(A);for(this.edges=new Int16Array(2*o.length),t=0;t<o.length;t++){var s=o[t].split("_");this.edges[2*t]=parseInt(s[0],10),this.edges[2*t+1]=parseInt(s[1],10)}},t.prototype.getEdgeVertex=function(A,e,t){var n=this.edges[2*A+(e?1:0)];this.getVertex(n,t)};var c=new i,g=new i;t.prototype.getEdgeVector=function(A,e){var t=c,n=g;this.getEdgeVertex(A,0,t),this.getEdgeVertex(A,1,n),n.vsub(t,e)};var E=new i,Q=new i;t.computeNormal=function(A,e,t,n){e.vsub(A,Q),t.vsub(e,E),E.cross(Q,n),n.isZero()||n.normalize()};var u=new i,l=new i,w=new i;t.prototype.getVertex=function(A,e){var t=this.scale;return this._getUnscaledVertex(A,e),e.x*=t.x,e.y*=t.y,e.z*=t.z,e},t.prototype._getUnscaledVertex=function(A,e){var t=3*A,n=this.vertices;return e.set(n[t],n[t+1],n[t+2])},t.prototype.getWorldVertex=function(A,e,t,n){return this.getVertex(A,n),r.pointToWorldFrame(e,t,n,n),n},t.prototype.getTriangleVertices=function(A,e,t,n){var i=3*A;this.getVertex(this.indices[i],e),this.getVertex(this.indices[i+1],t),this.getVertex(this.indices[i+2],n)},t.prototype.getNormal=function(A,e){var t=3*A;return e.set(this.normals[t],this.normals[t+1],this.normals[t+2])};var h=new o;t.prototype.calculateLocalInertia=function(A,e){this.computeLocalAABB(h);var t=h.upperBound.x-h.lowerBound.x,n=h.upperBound.y-h.lowerBound.y,i=h.upperBound.z-h.lowerBound.z;return e.set(1/12*A*(2*n*2*n+2*i*2*i),1/12*A*(2*t*2*t+2*i*2*i),1/12*A*(2*n*2*n+2*t*2*t))};var C=new i;t.prototype.computeLocalAABB=function(A){var e=A.lowerBound,t=A.upperBound,n=this.vertices.length,i=(this.vertices,C);this.getVertex(0,i),e.copy(i),t.copy(i);for(var r=0;r!==n;r++)this.getVertex(r,i),i.x<e.x?e.x=i.x:i.x>t.x&&(t.x=i.x),i.y<e.y?e.y=i.y:i.y>t.y&&(t.y=i.y),i.z<e.z?e.z=i.z:i.z>t.z&&(t.z=i.z)},t.prototype.updateAABB=function(){this.computeLocalAABB(this.aabb)},t.prototype.updateBoundingSphereRadius=function(){for(var A=0,e=this.vertices,t=new i,n=0,r=e.length/3;n!==r;n++){this.getVertex(n,t);var o=t.norm2();o>A&&(A=o)}this.boundingSphereRadius=Math.sqrt(A)};var I=(new i,new r),M=new o;t.prototype.calculateWorldAABB=function(A,e,t,n){var i=I,r=M;i.position=A,i.quaternion=e,this.aabb.toWorldFrame(i,r),t.copy(r.lowerBound),n.copy(r.upperBound)},t.prototype.volume=function(){return 4*Math.PI*this.boundingSphereRadius/3},t.createTorus=function(A,e,n,i,r){A=A||1,e=e||.5,n=n||8,i=i||6,r=r||2*Math.PI;for(var o=[],s=[],a=0;n>=a;a++)for(var B=0;i>=B;B++){var c=B/i*r,g=a/n*Math.PI*2,E=(A+e*Math.cos(g))*Math.cos(c),Q=(A+e*Math.cos(g))*Math.sin(c),u=e*Math.sin(g);o.push(E,Q,u)}for(a=1;n>=a;a++)for(B=1;i>=B;B++){var l=(i+1)*a+B-1,w=(i+1)*(a-1)+B-1,h=(i+1)*(a-1)+B,C=(i+1)*a+B;s.push(l,w,C),s.push(w,h,C)}return new t(o,s)}},{"../collision/AABB":3,"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"../utils/Octree":50,"./Shape":43}],46:[function(A,e){function t(){n.call(this),this.iterations=10,this.tolerance=1e-7}e.exports=t;var n=(A("../math/Vec3"),A("../math/Quaternion"),A("./Solver"));t.prototype=new n;var i=[],r=[],o=[];t.prototype.solve=function(A,e){var t,n,s,a,B,c=0,g=this.iterations,E=this.tolerance*this.tolerance,Q=this.equations,u=Q.length,l=e.bodies,w=l.length,h=A;if(0!==u)for(var C=0;C!==w;C++)l[C].updateSolveMassProperties();var I=r,M=o,d=i;for(I.length=u,M.length=u,d.length=u,C=0;C!==u;C++){var m=Q[C];d[C]=0,M[C]=m.computeB(h),I[C]=1/m.computeC()}if(0!==u){for(C=0;C!==w;C++){var p=(Y=l[C]).vlambda,F=Y.wlambda;p.set(0,0,0),F&&F.set(0,0,0)}for(c=0;c!==g;c++){a=0;for(var D=0;D!==u;D++)m=Q[D],t=M[D],n=I[D],(B=d[D])+(s=n*(t-m.computeGWlambda()-m.eps*B))<m.minForce?s=m.minForce-B:B+s>m.maxForce&&(s=m.maxForce-B),d[D]+=s,a+=s>0?s:-s,m.addToWlambda(s);if(E>a*a)break}for(C=0;C!==w;C++){var Y,f=(Y=l[C]).velocity,N=Y.angularVelocity;f.vadd(Y.vlambda,f),N&&N.vadd(Y.wlambda,N)}}return c}},{"../math/Quaternion":28,"../math/Vec3":30,"./Solver":47}],47:[function(A,e){function t(){this.equations=[]}e.exports=t,t.prototype.solve=function(){return 0},t.prototype.addEquation=function(A){A.enabled&&this.equations.push(A)},t.prototype.removeEquation=function(A){var e=this.equations,t=e.indexOf(A);-1!==t&&e.splice(t,1)},t.prototype.removeAllEquations=function(){this.equations.length=0}},{}],48:[function(A,e){function t(A){for(s.call(this),this.iterations=10,this.tolerance=1e-7,this.subsolver=A,this.nodes=[],this.nodePool=[];this.nodePool.length<128;)this.nodePool.push(this.createNode())}function n(A){for(var e=A.length,t=0;t!==e;t++){var n=A[t];if(!(n.visited||n.body.type&E))return n}return!1}function i(A,e,t,i){for(Q.push(A),A.visited=!0,e(A,t,i);Q.length;)for(var r,o=Q.pop();r=n(o.children);)r.visited=!0,e(r,t,i),Q.push(r)}function r(A,e,t){e.push(A.body);for(var n=A.eqs.length,i=0;i!==n;i++){var r=A.eqs[i];-1===t.indexOf(r)&&t.push(r)}}function o(A,e){return e.id-A.id}e.exports=t;var s=(A("../math/Vec3"),A("../math/Quaternion"),A("./Solver")),a=A("../objects/Body");t.prototype=new s;var B=[],c=[],g={bodies:[]},E=a.STATIC,Q=[];t.prototype.createNode=function(){return{body:null,children:[],eqs:[],visited:!1}},t.prototype.solve=function(A,e){for(var t=B,s=this.nodePool,a=e.bodies,E=this.equations,Q=E.length,u=a.length,l=this.subsolver;s.length<u;)s.push(this.createNode());t.length=u;for(var w=0;u>w;w++)t[w]=s[w];for(w=0;w!==u;w++){var h=t[w];h.body=a[w],h.children.length=0,h.eqs.length=0,h.visited=!1}for(var C=0;C!==Q;C++){var I=E[C],M=(w=a.indexOf(I.bi),a.indexOf(I.bj)),d=t[w],m=t[M];d.children.push(m),d.eqs.push(I),m.children.push(d),m.eqs.push(I)}var p,F=0,D=c;l.tolerance=this.tolerance,l.iterations=this.iterations;for(var Y=g;p=n(t);){D.length=0,Y.bodies.length=0,i(p,r,Y.bodies,D);var f=D.length;for(D=D.sort(o),w=0;w!==f;w++)l.addEquation(D[w]);l.solve(A,Y),l.removeAllEquations(),F++}return F}},{"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"./Solver":47}],49:[function(A,e){var t=function(){};e.exports=t,t.prototype={constructor:t,addEventListener:function(A,e){void 0===this._listeners&&(this._listeners={});var t=this._listeners;return void 0===t[A]&&(t[A]=[]),-1===t[A].indexOf(e)&&t[A].push(e),this},hasEventListener:function(A,e){if(void 0===this._listeners)return!1;var t=this._listeners;return void 0!==t[A]&&-1!==t[A].indexOf(e)},removeEventListener:function(A,e){if(void 0===this._listeners)return this;var t=this._listeners;if(void 0===t[A])return this;var n=t[A].indexOf(e);return-1!==n&&t[A].splice(n,1),this},dispatchEvent:function(A){if(void 0===this._listeners)return this;var e=this._listeners[A.type];if(void 0!==e){A.target=this;for(var t=0,n=e.length;n>t;t++)e[t].call(this,A)}return this}}},{}],50:[function(A,e){function t(A){A=A||{},this.root=A.root||null,this.aabb=A.aabb?A.aabb.clone():new i,this.data=[],this.children=[]}function n(A,e){(e=e||{}).root=null,e.aabb=A,t.call(this,e),this.maxDepth=void 0!==e.maxDepth?e.maxDepth:8}var i=A("../collision/AABB"),r=A("../math/Vec3");e.exports=n,n.prototype=new t,t.prototype.reset=function(){this.children.length=this.data.length=0},t.prototype.insert=function(A,e,t){var n=this.data;if(t=t||0,!this.aabb.contains(A))return!1;var i=this.children;if(t<(this.maxDepth||this.root.maxDepth)){var r=!1;i.length||(this.subdivide(),r=!0);for(var o=0;8!==o;o++)if(i[o].insert(A,e,t+1))return!0;r&&(i.length=0)}return n.push(e),!0};var o=new r;t.prototype.subdivide=function(){var A=this.aabb,e=A.lowerBound,n=A.upperBound,s=this.children;s.push(new t({aabb:new i({lowerBound:new r(0,0,0)})}),new t({aabb:new i({lowerBound:new r(1,0,0)})}),new t({aabb:new i({lowerBound:new r(1,1,0)})}),new t({aabb:new i({lowerBound:new r(1,1,1)})}),new t({aabb:new i({lowerBound:new r(0,1,1)})}),new t({aabb:new i({lowerBound:new r(0,0,1)})}),new t({aabb:new i({lowerBound:new r(1,0,1)})}),new t({aabb:new i({lowerBound:new r(0,1,0)})})),n.vsub(e,o),o.scale(.5,o);for(var a=this.root||this,B=0;8!==B;B++){var c=s[B];c.root=a;var g=c.aabb.lowerBound;g.x*=o.x,g.y*=o.y,g.z*=o.z,g.vadd(e,g),g.vadd(o,c.aabb.upperBound)}},t.prototype.aabbQuery=function(A,e){for(var t=(this.data,this.children,[this]);t.length;){var n=t.pop();n.aabb.overlaps(A)&&Array.prototype.push.apply(e,n.data),Array.prototype.push.apply(t,n.children)}return e};var s=new i;t.prototype.rayQuery=function(A,e,t){return A.getAABB(s),s.toLocalFrame(e,s),this.aabbQuery(s,t),t},t.prototype.removeEmptyNodes=function(){for(var A=[this];A.length;){for(var e=A.pop(),t=e.children.length-1;t>=0;t--)e.children[t].data.length||e.children.splice(t,1);Array.prototype.push.apply(A,e.children)}}},{"../collision/AABB":3,"../math/Vec3":30}],51:[function(A,e){function t(){this.objects=[],this.type=Object}e.exports=t,t.prototype.release=function(){for(var A=arguments.length,e=0;e!==A;e++)this.objects.push(arguments[e])},t.prototype.get=function(){return 0===this.objects.length?this.constructObject():this.objects.pop()},t.prototype.constructObject=function(){throw new Error("constructObject() not implemented in this Pool subclass yet!")}},{}],52:[function(A,e){function t(){this.data={keys:[]}}e.exports=t,t.prototype.get=function(A,e){if(A>e){var t=e;e=A,A=t}return this.data[A+"-"+e]},t.prototype.set=function(A,e,t){if(A>e){var n=e;e=A,A=n}var i=A+"-"+e;this.get(A,e)||this.data.keys.push(i),this.data[i]=t},t.prototype.reset=function(){for(var A=this.data,e=A.keys;e.length>0;)delete A[e.pop()]}},{}],53:[function(A,e){function t(){}e.exports=t,t.defaults=function(A,e){for(var t in A=A||{},e)t in A||(A[t]=e[t]);return A}},{}],54:[function(A,e){function t(){i.call(this),this.type=n}e.exports=t;var n=A("../math/Vec3"),i=A("./Pool");t.prototype=new i,t.prototype.constructObject=function(){return new n}},{"../math/Vec3":30,"./Pool":51}],55:[function(A,e){function t(A){this.contactPointPool=[],this.frictionEquationPool=[],this.result=[],this.frictionResult=[],this.v3pool=new c,this.world=A,this.currentContactMaterial=null,this.enableFrictionReduction=!1}function n(A,e,t){for(var n=null,i=A.length,r=0;r!==i;r++){var o=A[r],s=j;A[(r+1)%i].vsub(o,s);var a=J;s.cross(e,a);var B=z;t.vsub(o,B);var c=a.dot(B);if(!(null===n||c>0&&!0===n||0>=c&&!1===n))return!1;null===n&&(n=c>0)}return!0}e.exports=t;var i=A("../collision/AABB"),r=A("../shapes/Shape"),o=A("../collision/Ray"),s=A("../math/Vec3"),a=A("../math/Transform"),B=(A("../shapes/ConvexPolyhedron"),A("../math/Quaternion")),c=(A("../solver/Solver"),A("../utils/Vec3Pool")),g=A("../equations/ContactEquation"),E=A("../equations/FrictionEquation");t.prototype.createContactEquation=function(A,e,t,n,i,r){var o;this.contactPointPool.length?((o=this.contactPointPool.pop()).bi=A,o.bj=e):o=new g(A,e),o.enabled=A.collisionResponse&&e.collisionResponse&&t.collisionResponse&&n.collisionResponse;var s=this.currentContactMaterial;o.restitution=s.restitution,o.setSpookParams(s.contactEquationStiffness,s.contactEquationRelaxation,this.world.dt);var a=t.material||A.material,B=n.material||e.material;return a&&B&&a.restitution>=0&&B.restitution>=0&&(o.restitution=a.restitution*B.restitution),o.si=i||t,o.sj=r||n,o},t.prototype.createFrictionEquationsFromContact=function(A,e){var t=A.bi,n=A.bj,i=A.si,r=A.sj,o=this.world,s=this.currentContactMaterial,a=s.friction,B=i.material||t.material,c=r.material||n.material;if(B&&c&&B.friction>=0&&c.friction>=0&&(a=B.friction*c.friction),a>0){var g=a*o.gravity.length(),Q=t.invMass+n.invMass;Q>0&&(Q=1/Q);var u=this.frictionEquationPool,l=u.length?u.pop():new E(t,n,g*Q),w=u.length?u.pop():new E(t,n,g*Q);return l.bi=w.bi=t,l.bj=w.bj=n,l.minForce=w.minForce=-g*Q,l.maxForce=w.maxForce=g*Q,l.ri.copy(A.ri),l.rj.copy(A.rj),w.ri.copy(A.ri),w.rj.copy(A.rj),A.ni.tangents(l.t,w.t),l.setSpookParams(s.frictionEquationStiffness,s.frictionEquationRelaxation,o.dt),w.setSpookParams(s.frictionEquationStiffness,s.frictionEquationRelaxation,o.dt),l.enabled=w.enabled=A.enabled,e.push(l,w),!0}return!1};var Q=new s,u=new s,l=new s;t.prototype.createFrictionFromAverage=function(A){var e=this.result[this.result.length-1];if(this.createFrictionEquationsFromContact(e,this.frictionResult)&&1!==A){var t=this.frictionResult[this.frictionResult.length-2],n=this.frictionResult[this.frictionResult.length-1];Q.setZero(),u.setZero(),l.setZero();for(var i=e.bi,r=(e.bj,0);r!==A;r++)(e=this.result[this.result.length-1-r]).bodyA!==i?(Q.vadd(e.ni,Q),u.vadd(e.ri,u),l.vadd(e.rj,l)):(Q.vsub(e.ni,Q),u.vadd(e.rj,u),l.vadd(e.ri,l));var o=1/A;u.scale(o,t.ri),l.scale(o,t.rj),n.ri.copy(t.ri),n.rj.copy(t.rj),Q.normalize(),Q.tangents(t.t,n.t)}};var w=new s,h=new s,C=new B,I=new B;t.prototype.getContacts=function(A,e,t,n,i,r,o){this.contactPointPool=i,this.frictionEquationPool=o,this.result=n,this.frictionResult=r;for(var s=C,a=I,B=w,c=h,g=0,E=A.length;g!==E;g++){var Q=A[g],u=e[g],l=null;Q.material&&u.material&&(l=t.getContactMaterial(Q.material,u.material)||null);for(var M=0;M<Q.shapes.length;M++){Q.quaternion.mult(Q.shapeOrientations[M],s),Q.quaternion.vmult(Q.shapeOffsets[M],B),B.vadd(Q.position,B);for(var d=Q.shapes[M],m=0;m<u.shapes.length;m++){u.quaternion.mult(u.shapeOrientations[m],a),u.quaternion.vmult(u.shapeOffsets[m],c),c.vadd(u.position,c);var p=u.shapes[m];if(!(B.distanceTo(c)>d.boundingSphereRadius+p.boundingSphereRadius)){var F=null;d.material&&p.material&&(F=t.getContactMaterial(d.material,p.material)||null),this.currentContactMaterial=F||l||t.defaultContactMaterial;var D=this[d.type|p.type];D&&(d.type<p.type?D.call(this,d,p,B,c,s,a,Q,u,d,p):D.call(this,p,d,c,B,a,s,u,Q,d,p))}}}}},t.prototype[r.types.BOX|r.types.BOX]=t.prototype.boxBox=function(A,e,t,n,i,r,o,s){A.convexPolyhedronRepresentation.material=A.material,e.convexPolyhedronRepresentation.material=e.material,A.convexPolyhedronRepresentation.collisionResponse=A.collisionResponse,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,this.convexConvex(A.convexPolyhedronRepresentation,e.convexPolyhedronRepresentation,t,n,i,r,o,s,A,e)},t.prototype[r.types.BOX|r.types.CONVEXPOLYHEDRON]=t.prototype.boxConvex=function(A,e,t,n,i,r,o,s){A.convexPolyhedronRepresentation.material=A.material,A.convexPolyhedronRepresentation.collisionResponse=A.collisionResponse,this.convexConvex(A.convexPolyhedronRepresentation,e,t,n,i,r,o,s,A,e)},t.prototype[r.types.BOX|r.types.PARTICLE]=t.prototype.boxParticle=function(A,e,t,n,i,r,o,s){A.convexPolyhedronRepresentation.material=A.material,A.convexPolyhedronRepresentation.collisionResponse=A.collisionResponse,this.convexParticle(A.convexPolyhedronRepresentation,e,t,n,i,r,o,s,A,e)},t.prototype[r.types.SPHERE]=t.prototype.sphereSphere=function(A,e,t,n,i,r,o,s){var a=this.createContactEquation(o,s,A,e);n.vsub(t,a.ni),a.ni.normalize(),a.ri.copy(a.ni),a.rj.copy(a.ni),a.ri.mult(A.radius,a.ri),a.rj.mult(-e.radius,a.rj),a.ri.vadd(t,a.ri),a.ri.vsub(o.position,a.ri),a.rj.vadd(n,a.rj),a.rj.vsub(s.position,a.rj),this.result.push(a),this.createFrictionEquationsFromContact(a,this.frictionResult)};var M=new s,d=new s,m=new s;t.prototype[r.types.PLANE|r.types.TRIMESH]=t.prototype.planeTrimesh=function(A,e,t,n,i,r,o,B){var c=new s,g=M;g.set(0,0,1),i.vmult(g,g);for(var E=0;E<e.vertices.length/3;E++){e.getVertex(E,c);var Q=new s;Q.copy(c),a.pointToWorldFrame(n,r,Q,c);var u=d;if(c.vsub(t,u),0>=g.dot(u)){var l=this.createContactEquation(o,B,A,e);l.ni.copy(g);var w=m;g.scale(u.dot(g),w),c.vsub(w,w),l.ri.copy(w),l.ri.vsub(o.position,l.ri),l.rj.copy(c),l.rj.vsub(B.position,l.rj),this.result.push(l),this.createFrictionEquationsFromContact(l,this.frictionResult)}}};var p=new s,F=new s,D=(new s,new s),Y=new s,f=new s,N=new s,U=new s,y=new s,T=new s,x=new s,R=new s,G=new s,S=new s,H=new i,b=[];t.prototype[r.types.SPHERE|r.types.TRIMESH]=t.prototype.sphereTrimesh=function(A,e,t,n,i,r,s,B){var c=f,g=N,E=U,Q=y,u=T,l=x,w=H,h=Y,C=F,I=b;a.pointToLocalFrame(n,r,t,u);var M=A.radius;w.lowerBound.set(u.x-M,u.y-M,u.z-M),w.upperBound.set(u.x+M,u.y+M,u.z+M),e.getTrianglesInAABB(w,I);for(var d=D,m=A.radius*A.radius,v=0;v<I.length;v++)for(var k=0;3>k;k++)e.getVertex(e.indices[3*I[v]+k],d),d.vsub(u,C),C.norm2()<=m&&(h.copy(d),a.pointToWorldFrame(n,r,h,d),d.vsub(t,C),(z=this.createContactEquation(s,B,A,e)).ni.copy(C),z.ni.normalize(),z.ri.copy(z.ni),z.ri.scale(A.radius,z.ri),z.ri.vadd(t,z.ri),z.ri.vsub(s.position,z.ri),z.rj.copy(d),z.rj.vsub(B.position,z.rj),this.result.push(z),this.createFrictionEquationsFromContact(z,this.frictionResult));for(v=0;v<I.length;v++)for(k=0;3>k;k++){e.getVertex(e.indices[3*I[v]+k],c),e.getVertex(e.indices[3*I[v]+(k+1)%3],g),g.vsub(c,E),u.vsub(g,l);var j=l.dot(E);u.vsub(c,l);var J=l.dot(E);if(J>0&&0>j&&(u.vsub(c,l),Q.copy(E),Q.normalize(),J=l.dot(Q),Q.scale(J,l),l.vadd(c,l),(K=l.distanceTo(u))<A.radius)){var z=this.createContactEquation(s,B,A,e);l.vsub(u,z.ni),z.ni.normalize(),z.ni.scale(A.radius,z.ri),a.pointToWorldFrame(n,r,l,l),l.vsub(B.position,z.rj),a.vectorToWorldFrame(r,z.ni,z.ni),a.vectorToWorldFrame(r,z.ri,z.ri),this.result.push(z),this.createFrictionEquationsFromContact(z,this.frictionResult)}}for(var L=R,P=G,O=S,V=p,W=(v=0,I.length);v!==W;v++){e.getTriangleVertices(I[v],L,P,O),e.getNormal(I[v],V),u.vsub(L,l);var K=l.dot(V);V.scale(K,l),u.vsub(l,l),K=l.distanceTo(u),o.pointInTriangle(l,L,P,O)&&K<A.radius&&(z=this.createContactEquation(s,B,A,e),l.vsub(u,z.ni),z.ni.normalize(),z.ni.scale(A.radius,z.ri),a.pointToWorldFrame(n,r,l,l),l.vsub(B.position,z.rj),a.vectorToWorldFrame(r,z.ni,z.ni),a.vectorToWorldFrame(r,z.ri,z.ri),this.result.push(z),this.createFrictionEquationsFromContact(z,this.frictionResult))}I.length=0};var v=new s,k=new s;t.prototype[r.types.SPHERE|r.types.PLANE]=t.prototype.spherePlane=function(A,e,t,n,i,r,o,s){var a=this.createContactEquation(o,s,A,e);if(a.ni.set(0,0,1),r.vmult(a.ni,a.ni),a.ni.negate(a.ni),a.ni.normalize(),a.ni.mult(A.radius,a.ri),t.vsub(n,v),a.ni.mult(a.ni.dot(v),k),v.vsub(k,a.rj),-v.dot(a.ni)<=A.radius){var B=a.ri,c=a.rj;B.vadd(t,B),B.vsub(o.position,B),c.vadd(n,c),c.vsub(s.position,c),this.result.push(a),this.createFrictionEquationsFromContact(a,this.frictionResult)}};var j=new s,J=new s,z=new s,L=new s,P=new s,O=new s,V=new s,W=[new s,new s,new s,new s,new s,new s],K=new s,X=new s,Z=new s,_=new s;t.prototype[r.types.SPHERE|r.types.BOX]=t.prototype.sphereBox=function(A,e,t,n,i,r,o,s){var a=this.v3pool,B=W;t.vsub(n,L),e.getSideNormals(B,r);for(var c=A.radius,g=!1,E=X,Q=Z,u=_,l=null,w=0,h=0,C=0,I=null,M=0,d=B.length;M!==d&&!1===g;M++){var m=P;m.copy(B[M]);var p=m.norm();m.normalize();var F=L.dot(m);if(p+c>F&&F>0){var D=O,Y=V;D.copy(B[(M+1)%3]),Y.copy(B[(M+2)%3]);var f=D.norm(),N=Y.norm();D.normalize(),Y.normalize();var U=L.dot(D),y=L.dot(Y);if(f>U&&U>-f&&N>y&&y>-N){var T=Math.abs(F-p-c);(null===I||I>T)&&(I=T,h=U,C=y,l=p,E.copy(m),Q.copy(D),u.copy(Y),w++)}}}if(w){g=!0;var x=this.createContactEquation(o,s,A,e);E.mult(-c,x.ri),x.ni.copy(E),x.ni.negate(x.ni),E.mult(l,E),Q.mult(h,Q),E.vadd(Q,E),u.mult(C,u),E.vadd(u,x.rj),x.ri.vadd(t,x.ri),x.ri.vsub(o.position,x.ri),x.rj.vadd(n,x.rj),x.rj.vsub(s.position,x.rj),this.result.push(x),this.createFrictionEquationsFromContact(x,this.frictionResult)}for(var R=a.get(),G=K,S=0;2!==S&&!g;S++)for(var H=0;2!==H&&!g;H++)for(var b=0;2!==b&&!g;b++)R.set(0,0,0),S?R.vadd(B[0],R):R.vsub(B[0],R),H?R.vadd(B[1],R):R.vsub(B[1],R),b?R.vadd(B[2],R):R.vsub(B[2],R),n.vadd(R,G),G.vsub(t,G),G.norm2()<c*c&&(g=!0,(x=this.createContactEquation(o,s,A,e)).ri.copy(G),x.ri.normalize(),x.ni.copy(x.ri),x.ri.mult(c,x.ri),x.rj.copy(R),x.ri.vadd(t,x.ri),x.ri.vsub(o.position,x.ri),x.rj.vadd(n,x.rj),x.rj.vsub(s.position,x.rj),this.result.push(x),this.createFrictionEquationsFromContact(x,this.frictionResult));a.release(R),R=null;var v=a.get(),k=a.get(),j=(x=a.get(),a.get()),J=(T=a.get(),B.length);for(S=0;S!==J&&!g;S++)for(H=0;H!==J&&!g;H++)if(S%3!=H%3){B[H].cross(B[S],v),v.normalize(),B[S].vadd(B[H],k),x.copy(t),x.vsub(k,x),x.vsub(n,x);var z=x.dot(v);for(v.mult(z,j),b=0;b===S%3||b===H%3;)b++;T.copy(t),T.vsub(j,T),T.vsub(k,T),T.vsub(n,T);var q=Math.abs(z),$=T.norm();if(q<B[b].norm()&&c>$){g=!0;var AA=this.createContactEquation(o,s,A,e);k.vadd(j,AA.rj),AA.rj.copy(AA.rj),T.negate(AA.ni),AA.ni.normalize(),AA.ri.copy(AA.rj),AA.ri.vadd(n,AA.ri),AA.ri.vsub(t,AA.ri),AA.ri.normalize(),AA.ri.mult(c,AA.ri),AA.ri.vadd(t,AA.ri),AA.ri.vsub(o.position,AA.ri),AA.rj.vadd(n,AA.rj),AA.rj.vsub(s.position,AA.rj),this.result.push(AA),this.createFrictionEquationsFromContact(AA,this.frictionResult)}}a.release(v,k,x,j,T)};var q=new s,$=new s,AA=new s,eA=new s,tA=new s,nA=new s,iA=new s,rA=new s,oA=new s,sA=new s;t.prototype[r.types.SPHERE|r.types.CONVEXPOLYHEDRON]=t.prototype.sphereConvex=function(A,e,t,i,r,o,s,a){var B=this.v3pool;t.vsub(i,q);for(var c=e.faceNormals,g=e.faces,E=e.vertices,Q=A.radius,u=0;u!==E.length;u++){var l=E[u],w=tA;o.vmult(l,w),i.vadd(w,w);var h=eA;if(w.vsub(t,h),h.norm2()<Q*Q)return C=!0,(x=this.createContactEquation(s,a,A,e)).ri.copy(h),x.ri.normalize(),x.ni.copy(x.ri),x.ri.mult(Q,x.ri),w.vsub(i,x.rj),x.ri.vadd(t,x.ri),x.ri.vsub(s.position,x.ri),x.rj.vadd(i,x.rj),x.rj.vsub(a.position,x.rj),this.result.push(x),void this.createFrictionEquationsFromContact(x,this.frictionResult)}for(var C=!1,I=(u=0,g.length);u!==I&&!1===C;u++){var M=c[u],d=g[u],m=nA;o.vmult(M,m);var p=iA;o.vmult(E[d[0]],p),p.vadd(i,p);var F=rA;m.mult(-Q,F),t.vadd(F,F);var D=oA;F.vsub(p,D);var Y=D.dot(m),f=sA;if(t.vsub(p,f),0>Y&&f.dot(m)>0){for(var N=[],U=0,y=d.length;U!==y;U++){var T=B.get();o.vmult(E[d[U]],T),i.vadd(T,T),N.push(T)}if(n(N,m,t)){C=!0;var x=this.createContactEquation(s,a,A,e);m.mult(-Q,x.ri),m.negate(x.ni);var R=B.get();m.mult(-Y,R);var G=B.get();m.mult(-Q,G),t.vsub(i,x.rj),x.rj.vadd(G,x.rj),x.rj.vadd(R,x.rj),x.rj.vadd(i,x.rj),x.rj.vsub(a.position,x.rj),x.ri.vadd(t,x.ri),x.ri.vsub(s.position,x.ri),B.release(R),B.release(G),this.result.push(x),this.createFrictionEquationsFromContact(x,this.frictionResult),U=0;for(var S=N.length;U!==S;U++)B.release(N[U]);return}for(U=0;U!==d.length;U++){var H=B.get(),b=B.get();o.vmult(E[d[(U+1)%d.length]],H),o.vmult(E[d[(U+2)%d.length]],b),i.vadd(H,H),i.vadd(b,b);var v=$;b.vsub(H,v);var k=AA;v.unit(k);var j=B.get(),J=B.get();t.vsub(H,J);var z=J.dot(k);k.mult(z,j),j.vadd(H,j);var L=B.get();if(j.vsub(t,L),z>0&&z*z<v.norm2()&&L.norm2()<Q*Q){for(x=this.createContactEquation(s,a,A,e),j.vsub(i,x.rj),j.vsub(t,x.ni),x.ni.normalize(),x.ni.mult(Q,x.ri),x.rj.vadd(i,x.rj),x.rj.vsub(a.position,x.rj),x.ri.vadd(t,x.ri),x.ri.vsub(s.position,x.ri),this.result.push(x),this.createFrictionEquationsFromContact(x,this.frictionResult),U=0,S=N.length;U!==S;U++)B.release(N[U]);return B.release(H),B.release(b),B.release(j),B.release(L),void B.release(J)}B.release(H),B.release(b),B.release(j),B.release(L),B.release(J)}for(U=0,S=N.length;U!==S;U++)B.release(N[U])}}},new s,new s,t.prototype[r.types.PLANE|r.types.BOX]=t.prototype.planeBox=function(A,e,t,n,i,r,o,s){e.convexPolyhedronRepresentation.material=e.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,this.planeConvex(A,e.convexPolyhedronRepresentation,t,n,i,r,o,s)};var aA=new s,BA=new s,cA=new s,gA=new s;t.prototype[r.types.PLANE|r.types.CONVEXPOLYHEDRON]=t.prototype.planeConvex=function(A,e,t,n,i,r,o,s){var a=aA,B=BA;B.set(0,0,1),i.vmult(B,B);for(var c=0,g=cA,E=0;E!==e.vertices.length;E++)if(a.copy(e.vertices[E]),r.vmult(a,a),n.vadd(a,a),a.vsub(t,g),0>=B.dot(g)){var Q=this.createContactEquation(o,s,A,e),u=gA;B.mult(B.dot(g),u),a.vsub(u,u),u.vsub(t,Q.ri),Q.ni.copy(B),a.vsub(n,Q.rj),Q.ri.vadd(t,Q.ri),Q.ri.vsub(o.position,Q.ri),Q.rj.vadd(n,Q.rj),Q.rj.vsub(s.position,Q.rj),this.result.push(Q),c++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(Q,this.frictionResult)}this.enableFrictionReduction&&c&&this.createFrictionFromAverage(c)};var EA=new s,QA=new s;t.prototype[r.types.CONVEXPOLYHEDRON]=t.prototype.convexConvex=function(A,e,t,n,i,r,o,s,a,B,c,g){var E=EA;if(!(t.distanceTo(n)>A.boundingSphereRadius+e.boundingSphereRadius)&&A.findSeparatingAxis(e,t,i,n,r,E,c,g)){var Q=[],u=QA;A.clipAgainstHull(t,i,e,n,r,E,-100,100,Q);for(var l=0,w=0;w!==Q.length;w++){var h=this.createContactEquation(o,s,A,e,a,B),C=h.ri,I=h.rj;E.negate(h.ni),Q[w].normal.negate(u),u.mult(Q[w].depth,u),Q[w].point.vadd(u,C),I.copy(Q[w].point),C.vsub(t,C),I.vsub(n,I),C.vadd(t,C),C.vsub(o.position,C),I.vadd(n,I),I.vsub(s.position,I),this.result.push(h),l++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(h,this.frictionResult)}this.enableFrictionReduction&&l&&this.createFrictionFromAverage(l)}};var uA=new s,lA=new s,wA=new s;t.prototype[r.types.PLANE|r.types.PARTICLE]=t.prototype.planeParticle=function(A,e,t,n,i,r,o,s){var a=uA;a.set(0,0,1),o.quaternion.vmult(a,a);var B=lA;if(n.vsub(o.position,B),0>=a.dot(B)){var c=this.createContactEquation(s,o,e,A);c.ni.copy(a),c.ni.negate(c.ni),c.ri.set(0,0,0);var g=wA;a.mult(a.dot(n),g),n.vsub(g,g),c.rj.copy(g),this.result.push(c),this.createFrictionEquationsFromContact(c,this.frictionResult)}};var hA=new s;t.prototype[r.types.PARTICLE|r.types.SPHERE]=t.prototype.sphereParticle=function(A,e,t,n,i,r,o,s){var a=hA;if(a.set(0,0,1),n.vsub(t,a),a.norm2()<=A.radius*A.radius){var B=this.createContactEquation(s,o,e,A);a.normalize(),B.rj.copy(a),B.rj.mult(A.radius,B.rj),B.ni.copy(a),B.ni.negate(B.ni),B.ri.set(0,0,0),this.result.push(B),this.createFrictionEquationsFromContact(B,this.frictionResult)}};var CA=new B,IA=new s,MA=(new s,new s),dA=new s,mA=new s;t.prototype[r.types.PARTICLE|r.types.CONVEXPOLYHEDRON]=t.prototype.convexParticle=function(A,e,t,n,i,r,o,s){var a=-1,B=MA,c=mA,g=null,E=IA;if(E.copy(n),E.vsub(t,E),i.conjugate(CA),CA.vmult(E,E),A.pointIsInside(E)){A.worldVerticesNeedsUpdate&&A.computeWorldVertices(t,i),A.worldFaceNormalsNeedsUpdate&&A.computeWorldFaceNormals(i);for(var Q=0,u=A.faces.length;Q!==u;Q++){var l=[A.worldVertices[A.faces[Q][0]]],w=A.worldFaceNormals[Q];n.vsub(l[0],dA);var h=-w.dot(dA);(null===g||Math.abs(h)<Math.abs(g))&&(g=h,a=Q,B.copy(w))}if(-1!==a){var C=this.createContactEquation(s,o,e,A);B.mult(g,c),c.vadd(n,c),c.vsub(t,c),C.rj.copy(c),B.negate(C.ni),C.ri.set(0,0,0);var I=C.ri,M=C.rj;I.vadd(n,I),I.vsub(s.position,I),M.vadd(t,M),M.vsub(o.position,M),this.result.push(C),this.createFrictionEquationsFromContact(C,this.frictionResult)}else console.warn("Point found inside convex, but did not find penetrating face!")}},t.prototype[r.types.BOX|r.types.HEIGHTFIELD]=t.prototype.boxHeightfield=function(A,e,t,n,i,r,o,s){A.convexPolyhedronRepresentation.material=A.material,A.convexPolyhedronRepresentation.collisionResponse=A.collisionResponse,this.convexHeightfield(A.convexPolyhedronRepresentation,e,t,n,i,r,o,s)};var pA=new s,FA=new s,DA=[0];t.prototype[r.types.CONVEXPOLYHEDRON|r.types.HEIGHTFIELD]=t.prototype.convexHeightfield=function(A,e,t,n,i,r,o,s){var B=e.data,c=e.elementSize,g=A.boundingSphereRadius,E=FA,Q=DA,u=pA;a.pointToLocalFrame(n,r,t,u);var l=Math.floor((u.x-g)/c)-1,w=Math.ceil((u.x+g)/c)+1,h=Math.floor((u.y-g)/c)-1,C=Math.ceil((u.y+g)/c)+1;if(!(0>w||0>C||l>B.length||h>B[0].length)){0>l&&(l=0),0>w&&(w=0),0>h&&(h=0),0>C&&(C=0),l>=B.length&&(l=B.length-1),w>=B.length&&(w=B.length-1),C>=B[0].length&&(C=B[0].length-1),h>=B[0].length&&(h=B[0].length-1);var I=[];e.getRectMinMax(l,h,w,C,I);var M=I[0],d=I[1];if(!(u.z-g>d||u.z+g<M))for(var m=l;w>m;m++)for(var p=h;C>p;p++)e.getConvexTrianglePillar(m,p,!1),a.pointToWorldFrame(n,r,e.pillarOffset,E),t.distanceTo(E)<e.pillarConvex.boundingSphereRadius+A.boundingSphereRadius&&this.convexConvex(A,e.pillarConvex,t,E,i,r,o,s,null,null,Q,null),e.getConvexTrianglePillar(m,p,!0),a.pointToWorldFrame(n,r,e.pillarOffset,E),t.distanceTo(E)<e.pillarConvex.boundingSphereRadius+A.boundingSphereRadius&&this.convexConvex(A,e.pillarConvex,t,E,i,r,o,s,null,null,Q,null)}};var YA=new s,fA=new s;t.prototype[r.types.SPHERE|r.types.HEIGHTFIELD]=t.prototype.sphereHeightfield=function(A,e,t,n,i,r,o,s){var B=e.data,c=A.radius,g=e.elementSize,E=fA,Q=YA;a.pointToLocalFrame(n,r,t,Q);var u=Math.floor((Q.x-c)/g)-1,l=Math.ceil((Q.x+c)/g)+1,w=Math.floor((Q.y-c)/g)-1,h=Math.ceil((Q.y+c)/g)+1;if(!(0>l||0>h||u>B.length||h>B[0].length)){0>u&&(u=0),0>l&&(l=0),0>w&&(w=0),0>h&&(h=0),u>=B.length&&(u=B.length-1),l>=B.length&&(l=B.length-1),h>=B[0].length&&(h=B[0].length-1),w>=B[0].length&&(w=B[0].length-1);var C=[];e.getRectMinMax(u,w,l,h,C);var I=C[0],M=C[1];if(!(Q.z-c>M||Q.z+c<I))for(var d=this.result,m=u;l>m;m++)for(var p=w;h>p;p++){var F=d.length;if(e.getConvexTrianglePillar(m,p,!1),a.pointToWorldFrame(n,r,e.pillarOffset,E),t.distanceTo(E)<e.pillarConvex.boundingSphereRadius+A.boundingSphereRadius&&this.sphereConvex(A,e.pillarConvex,t,E,i,r,o,s),e.getConvexTrianglePillar(m,p,!0),a.pointToWorldFrame(n,r,e.pillarOffset,E),t.distanceTo(E)<e.pillarConvex.boundingSphereRadius+A.boundingSphereRadius&&this.sphereConvex(A,e.pillarConvex,t,E,i,r,o,s),d.length-F>2)return}}}},{"../collision/AABB":3,"../collision/Ray":9,"../equations/ContactEquation":19,"../equations/FrictionEquation":21,"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"../shapes/ConvexPolyhedron":38,"../shapes/Shape":43,"../solver/Solver":47,"../utils/Vec3Pool":54}],56:[function(A,e){function t(){a.apply(this),this.dt=-1,this.allowSleep=!1,this.contacts=[],this.frictionEquations=[],this.quatNormalizeSkip=0,this.quatNormalizeFast=!1,this.time=0,this.stepnumber=0,this.default_dt=1/60,this.nextId=0,this.gravity=new i,this.broadphase=new h,this.bodies=[],this.solver=new o,this.constraints=[],this.narrowphase=new s(this),this.collisionMatrix=new B,this.collisionMatrixPrevious=new B,this.materials=[],this.contactmaterials=[],this.contactMaterialTable=new Q,this.defaultMaterial=new c("default"),this.defaultContactMaterial=new g(this.defaultMaterial,this.defaultMaterial,{friction:.3,restitution:0}),this.doProfiling=!1,this.profile={solve:0,makeContactConstraints:0,broadphase:0,integrate:0,narrowphase:0},this.subsystems=[],this.addBodyEvent={type:"addBody",body:null},this.removeBodyEvent={type:"removeBody",body:null}}e.exports=t;var n=A("../shapes/Shape"),i=A("../math/Vec3"),r=A("../math/Quaternion"),o=A("../solver/GSSolver"),s=(A("../utils/Vec3Pool"),A("../equations/ContactEquation"),A("../equations/FrictionEquation"),A("./Narrowphase")),a=A("../utils/EventTarget"),B=A("../collision/ArrayCollisionMatrix"),c=A("../material/Material"),g=A("../material/ContactMaterial"),E=A("../objects/Body"),Q=A("../utils/TupleDictionary"),u=A("../collision/RaycastResult"),l=A("../collision/AABB"),w=A("../collision/Ray"),h=A("../collision/NaiveBroadphase");t.prototype=new a;var C=(new l,new w);if(t.prototype.getContactMaterial=function(A,e){return this.contactMaterialTable.get(A.id,e.id)},t.prototype.numObjects=function(){return this.bodies.length},t.prototype.collisionMatrixTick=function(){var A=this.collisionMatrixPrevious;this.collisionMatrixPrevious=this.collisionMatrix,this.collisionMatrix=A,this.collisionMatrix.reset()},t.prototype.add=t.prototype.addBody=function(A){-1===this.bodies.indexOf(A)&&(A.index=this.bodies.length,this.bodies.push(A),A.world=this,A.initPosition.copy(A.position),A.initVelocity.copy(A.velocity),A.timeLastSleepy=this.time,A instanceof E&&(A.initAngularVelocity.copy(A.angularVelocity),A.initQuaternion.copy(A.quaternion)),this.collisionMatrix.setNumObjects(this.bodies.length),this.addBodyEvent.body=A,this.dispatchEvent(this.addBodyEvent))},t.prototype.addConstraint=function(A){this.constraints.push(A)},t.prototype.removeConstraint=function(A){var e=this.constraints.indexOf(A);-1!==e&&this.constraints.splice(e,1)},t.prototype.rayTest=function(A,e,t){t instanceof u?this.raycastClosest(A,e,{skipBackfaces:!0},t):this.raycastAll(A,e,{skipBackfaces:!0},t)},t.prototype.raycastAll=function(A,e,t,n){return t.mode=w.ALL,t.from=A,t.to=e,t.callback=n,C.intersectWorld(this,t)},t.prototype.raycastAny=function(A,e,t,n){return t.mode=w.ANY,t.from=A,t.to=e,t.result=n,C.intersectWorld(this,t)},t.prototype.raycastClosest=function(A,e,t,n){return t.mode=w.CLOSEST,t.from=A,t.to=e,t.result=n,C.intersectWorld(this,t)},t.prototype.remove=function(A){A.world=null;var e=this.bodies.length-1,t=this.bodies,n=t.indexOf(A);if(-1!==n){t.splice(n,1);for(var i=0;i!==t.length;i++)t[i].index=i;this.collisionMatrix.setNumObjects(e),this.removeBodyEvent.body=A,this.dispatchEvent(this.removeBodyEvent)}},t.prototype.removeBody=t.prototype.remove,t.prototype.addMaterial=function(A){this.materials.push(A)},t.prototype.addContactMaterial=function(A){this.contactmaterials.push(A),this.contactMaterialTable.set(A.materials[0].id,A.materials[1].id,A)},"undefined"==typeof performance&&(performance={}),!performance.now){var I=Date.now();performance.timing&&performance.timing.navigationStart&&(I=performance.timing.navigationStart),performance.now=function(){return Date.now()-I}}var M=new i;t.prototype.step=function(A,e,t){if(t=t||10,0===(e=e||0))this.internalStep(A),this.time+=A;else{var n=Math.floor((this.time+e)/A)-Math.floor(this.time/A);n=Math.min(n,t);for(var i=performance.now(),r=0;r!==n&&(this.internalStep(A),!(performance.now()-i>1e3*A));r++);this.time+=e;for(var o=this.time%A/A,s=M,a=this.bodies,B=0;B!==a.length;B++){var c=a[B];c.type!==E.STATIC&&c.sleepState!==E.SLEEPING?(c.position.vsub(c.previousPosition,s),s.scale(o,s),c.position.vadd(s,c.interpolatedPosition)):(c.interpolatedPosition.copy(c.position),c.interpolatedQuaternion.copy(c.quaternion))}}};var d={type:"postStep"},m={type:"preStep"},p={type:"collide",body:null,contact:null},F=[],D=[],Y=[],f=[],N=(new i,new i,new i,new i,new i,new i,new i,new i,new i,new r,new r),U=new r,y=new i;t.prototype.internalStep=function(A){this.dt=A;var e,t=this.contacts,i=Y,r=f,o=this.numObjects(),s=this.bodies,a=this.solver,B=this.gravity,c=this.doProfiling,g=this.profile,Q=E.DYNAMIC,u=this.constraints,l=D,w=(B.norm(),B.x),h=B.y,C=B.z,I=0;for(c&&(e=performance.now()),I=0;I!==o;I++)if((j=s[I]).type&Q){var M=j.force,T=j.mass;M.x+=T*w,M.y+=T*h,M.z+=T*C}I=0;for(var x=this.subsystems.length;I!==x;I++)this.subsystems[I].update();c&&(e=performance.now()),i.length=0,r.length=0,this.broadphase.collisionPairs(this,i,r),c&&(g.broadphase=performance.now()-e);var R=u.length;for(I=0;I!==R;I++)if(!(z=u[I]).collideConnected)for(var G=i.length-1;G>=0;G-=1)(z.bodyA===i[G]&&z.bodyB===r[G]||z.bodyB===i[G]&&z.bodyA===r[G])&&(i.splice(G,1),r.splice(G,1));this.collisionMatrixTick(),c&&(e=performance.now());var S=F,H=t.length;for(I=0;I!==H;I++)S.push(t[I]);t.length=0;var b=this.frictionEquations.length;for(I=0;I!==b;I++)l.push(this.frictionEquations[I]);for(this.frictionEquations.length=0,this.narrowphase.getContacts(i,r,this,t,S,this.frictionEquations,l),c&&(g.narrowphase=performance.now()-e),c&&(e=performance.now()),I=0;I<this.frictionEquations.length;I++)a.addEquation(this.frictionEquations[I]);for(var v=t.length,k=0;k!==v;k++){var j=(z=t[k]).bi,J=z.bj;z.si,z.sj,(j.material&&J.material&&this.getContactMaterial(j.material,J.material)||this.defaultContactMaterial).friction,j.material&&J.material&&(j.material.friction>=0&&J.material.friction>=0&&(j.material.friction,J.material.friction),j.material.restitution>=0&&J.material.restitution>=0&&(z.restitution=j.material.restitution*J.material.restitution)),a.addEquation(z),j.allowSleep&&j.type===E.DYNAMIC&&j.sleepState===E.SLEEPING&&J.sleepState===E.AWAKE&&J.type!==E.STATIC&&J.velocity.norm2()+J.angularVelocity.norm2()>=2*Math.pow(J.sleepSpeedLimit,2)&&(j._wakeUpAfterNarrowphase=!0),J.allowSleep&&J.type===E.DYNAMIC&&J.sleepState===E.SLEEPING&&j.sleepState===E.AWAKE&&j.type!==E.STATIC&&j.velocity.norm2()+j.angularVelocity.norm2()>=2*Math.pow(j.sleepSpeedLimit,2)&&(J._wakeUpAfterNarrowphase=!0),this.collisionMatrix.set(j,J,!0),this.collisionMatrixPrevious.get(j,J)||(p.body=J,p.contact=z,j.dispatchEvent(p),p.body=j,J.dispatchEvent(p))}for(c&&(g.makeContactConstraints=performance.now()-e,e=performance.now()),I=0;I!==o;I++)(j=s[I])._wakeUpAfterNarrowphase&&(j.wakeUp(),j._wakeUpAfterNarrowphase=!1);for(R=u.length,I=0;I!==R;I++){var z;(z=u[I]).update(),G=0;for(var L=z.equations.length;G!==L;G++){var P=z.equations[G];a.addEquation(P)}}a.solve(A,this),c&&(g.solve=performance.now()-e),a.removeAllEquations();var O=Math.pow;for(I=0;I!==o;I++)if((j=s[I]).type&Q){var V=O(1-j.linearDamping,A),W=j.velocity;W.mult(V,W);var K=j.angularVelocity;if(K){var X=O(1-j.angularDamping,A);K.mult(X,K)}}for(this.dispatchEvent(m),I=0;I!==o;I++)(j=s[I]).preStep&&j.preStep.call(j);c&&(e=performance.now());var Z=N,_=U,q=this.stepnumber,$=E.DYNAMIC|E.KINEMATIC,AA=q%(this.quatNormalizeSkip+1)==0,eA=this.quatNormalizeFast,tA=.5*A;for(n.types.PLANE,n.types.CONVEXPOLYHEDRON,I=0;I!==o;I++){var nA=s[I],iA=nA.force,rA=nA.torque;if(nA.type&$&&nA.sleepState!==E.SLEEPING){var oA=nA.velocity,sA=nA.angularVelocity,aA=nA.position,BA=nA.quaternion,cA=nA.invMass,gA=nA.invInertiaWorld;oA.x+=iA.x*cA*A,oA.y+=iA.y*cA*A,oA.z+=iA.z*cA*A,nA.angularVelocity&&(gA.vmult(rA,y),y.mult(A,y),y.vadd(sA,sA)),aA.x+=oA.x*A,aA.y+=oA.y*A,aA.z+=oA.z*A,nA.angularVelocity&&(Z.set(sA.x,sA.y,sA.z,0),Z.mult(BA,_),BA.x+=tA*_.x,BA.y+=tA*_.y,BA.z+=tA*_.z,BA.w+=tA*_.w,AA&&(eA?BA.normalizeFast():BA.normalize())),nA.aabb&&(nA.aabbNeedsUpdate=!0),nA.updateInertiaWorld&&nA.updateInertiaWorld()}}for(this.clearForces(),this.broadphase.dirty=!0,c&&(g.integrate=performance.now()-e),this.time+=A,this.stepnumber+=1,this.dispatchEvent(d),I=0;I!==o;I++){var EA=(j=s[I]).postStep;EA&&EA.call(j)}if(this.allowSleep)for(I=0;I!==o;I++)s[I].sleepTick(this.time)},t.prototype.clearForces=function(){for(var A=this.bodies,e=A.length,t=0;t!==e;t++){var n=A[t];n.force,n.torque,n.force.set(0,0,0),n.torque.set(0,0,0)}}},{"../collision/AABB":3,"../collision/ArrayCollisionMatrix":4,"../collision/NaiveBroadphase":7,"../collision/Ray":9,"../collision/RaycastResult":10,"../equations/ContactEquation":19,"../equations/FrictionEquation":21,"../material/ContactMaterial":24,"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Shape":43,"../solver/GSSolver":46,"../utils/EventTarget":49,"../utils/TupleDictionary":52,"../utils/Vec3Pool":54,"./Narrowphase":55}]},{},[2])(2)},function(A,e,t){"use strict";t.r(e),e.default=""},function(A,e,t){(function(e){const n=t(406),i=t(408),r=t(67),o=t(99),s=A=>{try{return new URL(A,location.href)}catch(A){return null}},a=A=>new Promise(t=>{const r=[],a=Object.assign({},e.Scratch||{},n);a.extensions={unsandboxed:!0,isPenguinMod:!0,register:A=>{r.push(A),t(r)}},a.vm=A,a.renderer=A.runtime.renderer,a.canFetch=async e=>{const t=s(e);return!!t&&("blob:"===t.protocol||"data:"===t.protocol||A.securityManager.canFetch(t.href))},a.canOpenWindow=async e=>{const t=s(e);return!!t&&("javascript:"!==t.protocol&&A.securityManager.canOpenWindow(t.href))},a.canRedirect=async e=>{const t=s(e);return!!t&&("javascript:"!==t.protocol&&A.securityManager.canRedirect(t.href))},a.fetch=async(A,e)=>{const t=A instanceof Request?A.url:A;if(!await a.canFetch(t))throw new Error("Permission to fetch ".concat(t," rejected."));return fetch(A,e)},a.openWindow=async(A,e)=>{if(!await a.canOpenWindow(A))throw new Error("Permission to open tab ".concat(A," rejected."));return window.open(A,"_blank",e)},a.redirect=async A=>{if(!await a.canRedirect(A))throw new Error("Permission to redirect to ".concat(A," rejected."));location.href=A},a.canRecordAudio=async()=>A.securityManager.canRecordAudio(),a.canRecordVideo=async()=>A.securityManager.canRecordVideo(),a.canReadClipboard=async()=>A.securityManager.canReadClipboard(),a.canNotify=async()=>A.securityManager.canNotify(),a.canGeolocate=async()=>A.securityManager.canGeolocate(),a.canEmbed=async e=>{const t=s(e);return!!t&&A.securityManager.canEmbed(t.href)},a.canUnsandbox=async()=>A.securityManager.canUnsandbox(),a.canScreenshotCamera=async()=>A.securityManager.canScreenshotCamera(),a.canDownload=async(e,t)=>{const n=s(e);return!!n&&("javascript:"!==n.protocol&&A.securityManager.canDownload(e,t))},a.download=async(A,e)=>{if(!await a.canDownload(A,e))throw new Error("Permission to download ".concat(e," rejected."));const t=document.createElement("a");t.href=A,t.download=e,document.body.appendChild(t),t.click(),t.remove()},a.translate=o(A),e.Scratch=a,e.ScratchExtensions=i(a),A.emit("CREATE_UNSANDBOXED_EXTENSION_API",a)}),B=new r((A,t)=>new Promise((e,n)=>{a(t).then(e);const i=document.createElement("script");i.onerror=()=>{n(new Error("Error in unsandboxed script ".concat(A,". Check the console for more information.")))},i.src=A,document.body.appendChild(i)}).then(A=>(e.Scratch.extensions.register=()=>{throw new Error("Too late to register new extensions.")},A)),1);A.exports={setupUnsandboxedExtensionAPI:a,load:(A,e)=>B.do(A,e)}}).call(this,t(14))},function(A,e,t){const n={ArgumentType:t(3),ArgumentAlignment:t(63),BlockType:t(1),BlockShape:t(11),NotchShape:t(407),TargetType:t(15),Cast:t(2),Clone:t(7),Color:t(8)};A.exports=n},function(A,e){A.exports={SWITCH:"switchCase",HEXAGON:"hexagon",ROUND:"round",SQUARE:"square",LEAF:"leaf",PLUS:"plus",OCTAGONAL:"octagonal",BUMPED:"bumped",INDENTED:"indented",SCRAPPED:"scrapped",ARROW:"arrow",TICKET:"ticket",JIGSAW:"jigsaw",INVERTED:"inverted",PINCER:"pincer"}},function(A,e,t){const n=t(3),i=t(1),{argumentIndexToId:r,generateExtensionId:o}=t(100),s=A=>{if(""===A||" "===A||"w"===A)return{type:i.COMMAND,async:"w"===A};if("r"===A||"R"===A)return{type:i.REPORTER,async:"R"===A};if("b"===A)return{type:i.BOOLEAN,async:!1};if("h"===A)return{type:i.HAT,async:!1};throw new Error("Unknown ScratchX block type: ".concat(A))},a=(A,e)=>{const t={},i="string"==typeof(r=e)||"number"==typeof r||"boolean"==typeof r;var r;if(i&&(t.defaultValue=e),"s"===A)t.type=n.STRING,i||(t.defaultValue="");else if("n"===A)t.type=n.NUMBER,i||(t.defaultValue=0);else{if("m"!==A[0])throw new Error("Unknown ScratchX argument type: ".concat(A));{t.type=n.STRING;const e=A.split(/\.|:/)[1];t.menu=e}}return t},B=(A,e,t)=>n=>{const i=[];for(let A=0;A<e;A++)i.push(n[r(A)]);return t?new Promise(e=>{A(...i,e)}):A(...i)},c=new Map;A.exports=A=>({register:(e,t,n)=>{const i=((A,e,t)=>{const n={id:o(A),name:e.displayName||A,blocks:[],color1:"#4a4a5e",color2:"#31323f",color3:"#191a21"},i={getInfo:()=>n,_getStatus:t._getStatus};e.url&&(n.docsURI=e.url);for(const A of e.blocks){if(1===A.length){n.blocks.push("---");continue}const e=A[0],o=A[1],c=A[2],g=A.slice(3);let E="";const Q=[],u=o.split(/%([\w.:]+)/g);for(let A=0;A<u.length;A++){const e=u[A];if(A%2==1){a(e);const t=Math.floor(A/2).toString(),n=g[t],i=r(t);Q[i]=a(e,n),E+="[".concat(i,"]")}else E+=e}const l=s(e),w={opcode:c,blockType:l.type,text:E,arguments:Q};n.blocks.push(w);const h=t[c],C=Q.length;i[c]=B(h,C,l.async)}const c=e.menus;if(c){const A={};for(const e of Object.keys(c)||{}){const t={items:c[e]};A[e]=t}n.menus=A}return i})(e,t,n);c.set(e,i),A.extensions.register(i)},getStatus:A=>{const e=c.get(A);return e?e._getStatus():{status:0,msg:"does not exist"}}})},function(A,e,t){A.exports=function(){return t(101)('!function(e){var n={};function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)t.d(r,i,function(n){return e[n]}.bind(null,i));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=10)}([function(e,n,t){function r(){}t(25).mixin(r),r.prototype.write=function(e,n,t){this.emit("item",e,n,t)},r.prototype.end=function(){this.emit("end"),this.removeAllListeners()},r.prototype.pipe=function(e){var n=this;function t(){e.write.apply(e,Array.prototype.slice.call(arguments))}function r(){!e._isStdio&&e.end()}return n.emit("unpipe",e),e.emit("pipe",n),n.on("item",t),n.on("end",r),n.when("unpipe",(function(i){var a=i===e||void 0===i;return a&&(n.removeListener("item",t),n.removeListener("end",r),e.emit("unpipe")),a})),e},r.prototype.unpipe=function(e){return this.emit("unpipe",e),this},r.prototype.format=function(e){throw new Error(["Warning: .format() is deprecated in Minilog v2! Use .pipe() instead. For example:","var Minilog = require(\'minilog\');","Minilog","  .pipe(Minilog.backends.console.formatClean)","  .pipe(Minilog.backends.console);"].join("\\n"))},r.mixin=function(e){var n,t=r.prototype;for(n in t)t.hasOwnProperty(n)&&(e.prototype[n]=t[n])},e.exports=r},function(e,n,t){const r=t(23);r.enable(),e.exports=r("vm")},function(e,n){e.exports={ANGLE:"angle",BOOLEAN:"Boolean",COLOR:"color",NUMBER:"number",STRING:"string",MATRIX:"matrix",NOTE:"note",IMAGE:"image",POLYGON:"polygon",CUSTOM:"custom",COSTUME:"costume",SOUND:"sound",VARIABLE:"variable",LIST:"list",BROADCAST:"broadcast",SEPERATOR:"seperator"}},function(e,n){e.exports={BOOLEAN:"Boolean",BUTTON:"button",LABEL:"label",COMMAND:"command",CONDITIONAL:"conditional",EVENT:"event",HAT:"hat",LOOP:"loop",REPORTER:"reporter",XML:"xml"}},function(e,n){class t{static get RGB_BLACK(){return{r:0,g:0,b:0}}static get RGB_WHITE(){return{r:255,g:255,b:255}}static decimalToHex(e){e<0&&(e+=16777216);let n=Math.round(Number(e)).toString(16);return n="#".concat("000000".substr(0,6-n.length)).concat(n),n}static decimalToRgb(e){const n=e>>24&255;return{r:e>>16&255,g:e>>8&255,b:255&e,a:n>0?n:255}}static hexToRgb(e){e.startsWith("#")&&(e=e.substring(1)),8===e.length&&(e=e.slice(0,6));const n=parseInt(e,16);if(isNaN(n))return null;if(6===e.length)return{r:n>>16&255,g:n>>8&255,b:255&n};if(3===e.length){const e=n>>8&15,t=n>>4&15,r=15&n;return{r:e<<4|e,g:t<<4|t,b:r<<4|r}}return null}static rgbToHex(e){return t.decimalToHex(t.rgbToDecimal(e))}static rgbToDecimal(e){return(e.r<<16)+(e.g<<8)+e.b}static hexToDecimal(e){return t.rgbToDecimal(t.hexToRgb(e))}static hsvToRgb(e){let n=e.h%360;n<0&&(n+=360);const t=Math.max(0,Math.min(e.s,1)),r=Math.max(0,Math.min(e.v,1)),i=Math.floor(n/60),a=n/60-i,o=r*(1-t),s=r*(1-t*a),c=r*(1-t*(1-a));let l,u,d;switch(i){default:case 0:l=r,u=c,d=o;break;case 1:l=s,u=r,d=o;break;case 2:l=o,u=r,d=c;break;case 3:l=o,u=s,d=r;break;case 4:l=c,u=o,d=r;break;case 5:l=r,u=o,d=s}return{r:Math.floor(255*l),g:Math.floor(255*u),b:Math.floor(255*d)}}static rgbToHsv(e){const n=e.r/255,t=e.g/255,r=e.b/255,i=Math.min(Math.min(n,t),r),a=Math.max(Math.max(n,t),r);let o=0,s=0;if(i!==a){o=60*((n===i?3:t===i?5:1)-(n===i?t-r:t===i?r-n:n-t)/(a-i))%360,s=(a-i)/a}return{h:o,s:s,v:a}}static mixRgb(e,n,t){if(t<=0)return e;if(t>=1)return n;const r=1-t;return{r:r*e.r+t*n.r,g:r*e.g+t*n.g,b:r*e.b+t*n.b}}}e.exports=t},function(e,n){var t={black:"#000",red:"#c23621",green:"#25bc26",yellow:"#bbbb00",blue:"#492ee1",magenta:"#d338d3",cyan:"#33bbc8",gray:"#808080",purple:"#708"};e.exports=function(e,n){return n?"color: #fff; background: "+t[e]+";":"color: "+t[e]+";"}},function(e,n){e.exports={isWorker:!0,centralDispatchService:self}},function(e,n){var t="long",r="short",i="numeric";e.exports={number:{decimal:{style:"decimal"},integer:{style:"decimal",maximumFractionDigits:0},currency:{style:"currency",currency:"USD"},percent:{style:"percent"},default:{style:"decimal"}},date:{short:{month:i,day:i,year:"2-digit"},medium:{month:r,day:i,year:i},long:{month:t,day:i,year:i},full:{month:t,day:i,year:i,weekday:t},default:{month:r,day:i,year:i}},time:{short:{hour:i,minute:i},medium:{hour:i,minute:i,second:i},long:{hour:i,minute:i,second:i,timeZoneName:r},full:{hour:i,minute:i,second:i,timeZoneName:r},default:{hour:i,minute:i,second:i}},duration:{default:{hours:{minimumIntegerDigits:1,maximumFractionDigits:0},minutes:{minimumIntegerDigits:2,maximumFractionDigits:0},seconds:{minimumIntegerDigits:2,maximumFractionDigits:3}}},parseNumberPattern:function(e){if(e){var n={},t=e.match(/\\b[A-Z]{3}\\b/i),r=e.replace(/[^]/g,"").length;if(!r&&t&&(r=1),r?(n.style="currency",n.currencyDisplay=1===r?"symbol":2===r?"code":"name",n.currency=t?t[0].toUpperCase():"USD"):e.indexOf("%")>=0&&(n.style="percent"),!/[@#0]/.test(e))return n.style?n:void 0;if(n.useGrouping=e.indexOf(",")>=0,/E\\+?[@#0]+/i.test(e)||e.indexOf("@")>=0){var i=e.replace(/E\\+?[@#0]+|[^@#0]/gi,"");n.minimumSignificantDigits=Math.min(Math.max(i.replace(/[^@0]/g,"").length,1),21),n.maximumSignificantDigits=Math.min(Math.max(i.length,1),21)}else{for(var a=e.replace(/[^#0.]/g,"").split("."),o=a[0],s=o.length-1;"0"===o[s];)--s;n.minimumIntegerDigits=Math.min(Math.max(o.length-1-s,1),21);var c=a[1]||"";for(s=0;"0"===c[s];)++s;for(n.minimumFractionDigits=Math.min(Math.max(s,0),20);"#"===c[s];)++s;n.maximumFractionDigits=Math.min(Math.max(s,0),20)}return n}},parseDatePattern:function(e){if(e){for(var n={},a=0;a<e.length;){for(var o=e[a],s=1;e[++a]===o;)++s;switch(o){case"G":n.era=5===s?"narrow":4===s?t:r;break;case"y":case"Y":n.year=2===s?"2-digit":i;break;case"M":case"L":s=Math.min(Math.max(s-1,0),4),n.month=[i,"2-digit",r,t,"narrow"][s];break;case"E":case"e":case"c":n.weekday=5===s?"narrow":4===s?t:r;break;case"d":case"D":n.day=2===s?"2-digit":i;break;case"h":case"K":n.hour12=!0,n.hour=2===s?"2-digit":i;break;case"H":case"k":n.hour12=!1,n.hour=2===s?"2-digit":i;break;case"m":n.minute=2===s?"2-digit":i;break;case"s":case"S":n.second=2===s?"2-digit":i;break;case"z":case"Z":case"v":case"V":n.timeZoneName=1===s?r:t}}return Object.keys(n).length?n:void 0}}}},function(e,n){e.exports=function(e,n){if("string"==typeof e&&n[e])return e;for(var t=[].concat(e||[]),r=0,i=t.length;r<i;++r)for(var a=t[r].split("-");a.length;){var o=a.join("-");if(n[o])return o;a.pop()}}},function(e,n,t){"use strict";var r="one",i="two",a="few",o="many",s="other",c=[function(e){return 1===+e?r:s},function(e){var n=+e;return 0<=n&&n<=1?r:s},function(e){return 0===Math.floor(Math.abs(+e))||1===+e?r:s},function(e){var n=+e;return 0===n?"zero":1===n?r:2===n?i:3<=n%100&&n%100<=10?a:11<=n%100&&n%100<=99?o:s},function(e){var n=Math.floor(Math.abs(+e)),t=(e+".").split(".")[1].length;return 1===n&&0===t?r:s},function(e){var n=+e;return n%10==1&&n%100!=11?r:2<=n%10&&n%10<=4&&(n%100<12||14<n%100)?a:n%10==0||5<=n%10&&n%10<=9||11<=n%100&&n%100<=14?o:s},function(e){var n=+e;return n%10==1&&n%100!=11&&n%100!=71&&n%100!=91?r:n%10==2&&n%100!=12&&n%100!=72&&n%100!=92?i:(3<=n%10&&n%10<=4||n%10==9)&&(n%100<10||19<n%100)&&(n%100<70||79<n%100)&&(n%100<90||99<n%100)?a:0!==n&&n%1e6==0?o:s},function(e){var n=Math.floor(Math.abs(+e)),t=(e+".").split(".")[1].length,i=+(e+".").split(".")[1];return 0===t&&n%10==1&&n%100!=11||i%10==1&&i%100!=11?r:0===t&&2<=n%10&&n%10<=4&&(n%100<12||14<n%100)||2<=i%10&&i%10<=4&&(i%100<12||14<i%100)?a:s},function(e){var n=Math.floor(Math.abs(+e)),t=(e+".").split(".")[1].length;return 1===n&&0===t?r:2<=n&&n<=4&&0===t?a:0!==t?o:s},function(e){var n=+e;return 0===n?"zero":1===n?r:2===n?i:3===n?a:6===n?o:s},function(e){var n=Math.floor(Math.abs(+e)),t=+(""+e).replace(/^[^.]*.?|0+$/g,"");return 1===+e||0!==t&&(0===n||1===n)?r:s},function(e){var n=Math.floor(Math.abs(+e)),t=(e+".").split(".")[1].length,o=+(e+".").split(".")[1];return 0===t&&n%100==1||o%100==1?r:0===t&&n%100==2||o%100==2?i:0===t&&3<=n%100&&n%100<=4||3<=o%100&&o%100<=4?a:s},function(e){var n=Math.floor(Math.abs(+e));return 0===n||1===n?r:s},function(e){var n=Math.floor(Math.abs(+e)),t=(e+".").split(".")[1].length,i=+(e+".").split(".")[1];return 0===t&&(1===n||2===n||3===n)||0===t&&n%10!=4&&n%10!=6&&n%10!=9||0!==t&&i%10!=4&&i%10!=6&&i%10!=9?r:s},function(e){var n=+e;return 1===n?r:2===n?i:3<=n&&n<=6?a:7<=n&&n<=10?o:s},function(e){var n=+e;return 1===n||11===n?r:2===n||12===n?i:3<=n&&n<=10||13<=n&&n<=19?a:s},function(e){var n=Math.floor(Math.abs(+e)),t=(e+".").split(".")[1].length;return 0===t&&n%10==1?r:0===t&&n%10==2?i:0!==t||n%100!=0&&n%100!=20&&n%100!=40&&n%100!=60&&n%100!=80?0!==t?o:s:a},function(e){var n=Math.floor(Math.abs(+e)),t=(e+".").split(".")[1].length,a=+e;return 1===n&&0===t?r:2===n&&0===t?i:0===t&&(a<0||10<a)&&a%10==0?o:s},function(e){var n=Math.floor(Math.abs(+e)),t=+(""+e).replace(/^[^.]*.?|0+$/g,"");return 0===t&&n%10==1&&n%100!=11||0!==t?r:s},function(e){var n=+e;return 1===n?r:2===n?i:s},function(e){var n=+e;return 0===n?"zero":1===n?r:s},function(e){var n=Math.floor(Math.abs(+e)),t=+e;return 0===t?"zero":0!==n&&1!==n||0===t?s:r},function(e){var n=+(e+".").split(".")[1],t=+e;return t%10==1&&(t%100<11||19<t%100)?r:2<=t%10&&t%10<=9&&(t%100<11||19<t%100)?a:0!==n?o:s},function(e){var n=(e+".").split(".")[1].length,t=+(e+".").split(".")[1],i=+e;return i%10==0||11<=i%100&&i%100<=19||2===n&&11<=t%100&&t%100<=19?"zero":i%10==1&&i%100!=11||2===n&&t%10==1&&t%100!=11||2!==n&&t%10==1?r:s},function(e){var n=Math.floor(Math.abs(+e)),t=(e+".").split(".")[1].length,i=+(e+".").split(".")[1];return 0===t&&n%10==1&&n%100!=11||i%10==1&&i%100!=11?r:s},function(e){var n=Math.floor(Math.abs(+e)),t=(e+".").split(".")[1].length,i=+e;return 1===n&&0===t?r:0!==t||0===i||1!==i&&1<=i%100&&i%100<=19?a:s},function(e){var n=+e;return 1===n?r:0===n||2<=n%100&&n%100<=10?a:11<=n%100&&n%100<=19?o:s},function(e){var n=Math.floor(Math.abs(+e)),t=(e+".").split(".")[1].length;return 1===n&&0===t?r:0===t&&2<=n%10&&n%10<=4&&(n%100<12||14<n%100)?a:0===t&&1!==n&&0<=n%10&&n%10<=1||0===t&&5<=n%10&&n%10<=9||0===t&&12<=n%100&&n%100<=14?o:s},function(e){var n=Math.floor(Math.abs(+e));return 0<=n&&n<=1?r:s},function(e){var n=Math.floor(Math.abs(+e)),t=(e+".").split(".")[1].length;return 0===t&&n%10==1&&n%100!=11?r:0===t&&2<=n%10&&n%10<=4&&(n%100<12||14<n%100)?a:0===t&&n%10==0||0===t&&5<=n%10&&n%10<=9||0===t&&11<=n%100&&n%100<=14?o:s},function(e){var n=+e;return 0===Math.floor(Math.abs(+e))||1===n?r:2<=n&&n<=10?a:s},function(e){var n=Math.floor(Math.abs(+e)),t=+(e+".").split(".")[1],i=+e;return 0===i||1===i||0===n&&1===t?r:s},function(e){var n=Math.floor(Math.abs(+e)),t=(e+".").split(".")[1].length;return 0===t&&n%100==1?r:0===t&&n%100==2?i:0===t&&3<=n%100&&n%100<=4||0!==t?a:s},function(e){var n=+e;return 0<=n&&n<=1||11<=n&&n<=99?r:s},function(e){var n=+e;return 1===n||5===n||7===n||8===n||9===n||10===n?r:2===n||3===n?i:4===n?a:6===n?o:s},function(e){var n=Math.floor(Math.abs(+e));return n%10==1||n%10==2||n%10==5||n%10==7||n%10==8||n%100==20||n%100==50||n%100==70||n%100==80?r:n%10==3||n%10==4||n%1e3==100||n%1e3==200||n%1e3==300||n%1e3==400||n%1e3==500||n%1e3==600||n%1e3==700||n%1e3==800||n%1e3==900?a:0===n||n%10==6||n%100==40||n%100==60||n%100==90?o:s},function(e){var n=+e;return n%10!=2&&n%10!=3||n%100==12||n%100==13?s:a},function(e){var n=+e;return 1===n||3===n?r:2===n?i:4===n?a:s},function(e){var n=+e;return 0===n||7===n||8===n||9===n?"zero":1===n?r:2===n?i:3===n||4===n?a:5===n||6===n?o:s},function(e){var n=+e;return n%10==1&&n%100!=11?r:n%10==2&&n%100!=12?i:n%10==3&&n%100!=13?a:s},function(e){var n=+e;return 1===n||11===n?r:2===n||12===n?i:3===n||13===n?a:s},function(e){var n=+e;return 1===n?r:2===n||3===n?i:4===n?a:6===n?o:s},function(e){var n=+e;return 1===n||5===n?r:s},function(e){var n=+e;return 11===n||8===n||80===n||800===n?o:s},function(e){var n=Math.floor(Math.abs(+e));return 1===n?r:0===n||2<=n%100&&n%100<=20||n%100==40||n%100==60||n%100==80?o:s},function(e){var n=+e;return n%10==6||n%10==9||n%10==0&&0!==n?o:s},function(e){var n=Math.floor(Math.abs(+e));return n%10==1&&n%100!=11?r:n%10==2&&n%100!=12?i:n%10!=7&&n%10!=8||n%100==17||n%100==18?s:o},function(e){var n=+e;return 1===n?r:2===n||3===n?i:4===n?a:s},function(e){var n=+e;return 1<=n&&n<=4?r:s},function(e){var n=+e;return 1===n||5===n||7<=n&&n<=9?r:2===n||3===n?i:4===n?a:6===n?o:s},function(e){var n=+e;return 1===n?r:n%10==4&&n%100!=14?o:s},function(e){var n=+e;return n%10!=1&&n%10!=2||n%100==11||n%100==12?s:r},function(e){var n=+e;return n%10==6||n%10==9||10===n?a:s},function(e){var n=+e;return n%10==3&&n%100!=13?a:s}];e.exports={af:{cardinal:c[0]},ak:{cardinal:c[1]},am:{cardinal:c[2]},ar:{cardinal:c[3]},ars:{cardinal:c[3]},as:{cardinal:c[2],ordinal:c[34]},asa:{cardinal:c[0]},ast:{cardinal:c[4]},az:{cardinal:c[0],ordinal:c[35]},be:{cardinal:c[5],ordinal:c[36]},bem:{cardinal:c[0]},bez:{cardinal:c[0]},bg:{cardinal:c[0]},bh:{cardinal:c[1]},bn:{cardinal:c[2],ordinal:c[34]},br:{cardinal:c[6]},brx:{cardinal:c[0]},bs:{cardinal:c[7]},ca:{cardinal:c[4],ordinal:c[37]},ce:{cardinal:c[0]},cgg:{cardinal:c[0]},chr:{cardinal:c[0]},ckb:{cardinal:c[0]},cs:{cardinal:c[8]},cy:{cardinal:c[9],ordinal:c[38]},da:{cardinal:c[10]},de:{cardinal:c[4]},dsb:{cardinal:c[11]},dv:{cardinal:c[0]},ee:{cardinal:c[0]},el:{cardinal:c[0]},en:{cardinal:c[4],ordinal:c[39]},eo:{cardinal:c[0]},es:{cardinal:c[0]},et:{cardinal:c[4]},eu:{cardinal:c[0]},fa:{cardinal:c[2]},ff:{cardinal:c[12]},fi:{cardinal:c[4]},fil:{cardinal:c[13],ordinal:c[0]},fo:{cardinal:c[0]},fr:{cardinal:c[12],ordinal:c[0]},fur:{cardinal:c[0]},fy:{cardinal:c[4]},ga:{cardinal:c[14],ordinal:c[0]},gd:{cardinal:c[15],ordinal:c[40]},gl:{cardinal:c[4]},gsw:{cardinal:c[0]},gu:{cardinal:c[2],ordinal:c[41]},guw:{cardinal:c[1]},gv:{cardinal:c[16]},ha:{cardinal:c[0]},haw:{cardinal:c[0]},he:{cardinal:c[17]},hi:{cardinal:c[2],ordinal:c[41]},hr:{cardinal:c[7]},hsb:{cardinal:c[11]},hu:{cardinal:c[0],ordinal:c[42]},hy:{cardinal:c[12],ordinal:c[0]},ia:{cardinal:c[4]},io:{cardinal:c[4]},is:{cardinal:c[18]},it:{cardinal:c[4],ordinal:c[43]},iu:{cardinal:c[19]},iw:{cardinal:c[17]},jgo:{cardinal:c[0]},ji:{cardinal:c[4]},jmc:{cardinal:c[0]},ka:{cardinal:c[0],ordinal:c[44]},kab:{cardinal:c[12]},kaj:{cardinal:c[0]},kcg:{cardinal:c[0]},kk:{cardinal:c[0],ordinal:c[45]},kkj:{cardinal:c[0]},kl:{cardinal:c[0]},kn:{cardinal:c[2]},ks:{cardinal:c[0]},ksb:{cardinal:c[0]},ksh:{cardinal:c[20]},ku:{cardinal:c[0]},kw:{cardinal:c[19]},ky:{cardinal:c[0]},lag:{cardinal:c[21]},lb:{cardinal:c[0]},lg:{cardinal:c[0]},ln:{cardinal:c[1]},lt:{cardinal:c[22]},lv:{cardinal:c[23]},mas:{cardinal:c[0]},mg:{cardinal:c[1]},mgo:{cardinal:c[0]},mk:{cardinal:c[24],ordinal:c[46]},ml:{cardinal:c[0]},mn:{cardinal:c[0]},mo:{cardinal:c[25],ordinal:c[0]},mr:{cardinal:c[2],ordinal:c[47]},mt:{cardinal:c[26]},nah:{cardinal:c[0]},naq:{cardinal:c[19]},nb:{cardinal:c[0]},nd:{cardinal:c[0]},ne:{cardinal:c[0],ordinal:c[48]},nl:{cardinal:c[4]},nn:{cardinal:c[0]},nnh:{cardinal:c[0]},no:{cardinal:c[0]},nr:{cardinal:c[0]},nso:{cardinal:c[1]},ny:{cardinal:c[0]},nyn:{cardinal:c[0]},om:{cardinal:c[0]},or:{cardinal:c[0],ordinal:c[49]},os:{cardinal:c[0]},pa:{cardinal:c[1]},pap:{cardinal:c[0]},pl:{cardinal:c[27]},prg:{cardinal:c[23]},ps:{cardinal:c[0]},pt:{cardinal:c[28]},"pt-PT":{cardinal:c[4]},rm:{cardinal:c[0]},ro:{cardinal:c[25],ordinal:c[0]},rof:{cardinal:c[0]},ru:{cardinal:c[29]},rwk:{cardinal:c[0]},saq:{cardinal:c[0]},sc:{cardinal:c[4],ordinal:c[43]},scn:{cardinal:c[4],ordinal:c[43]},sd:{cardinal:c[0]},sdh:{cardinal:c[0]},se:{cardinal:c[19]},seh:{cardinal:c[0]},sh:{cardinal:c[7]},shi:{cardinal:c[30]},si:{cardinal:c[31]},sk:{cardinal:c[8]},sl:{cardinal:c[32]},sma:{cardinal:c[19]},smi:{cardinal:c[19]},smj:{cardinal:c[19]},smn:{cardinal:c[19]},sms:{cardinal:c[19]},sn:{cardinal:c[0]},so:{cardinal:c[0]},sq:{cardinal:c[0],ordinal:c[50]},sr:{cardinal:c[7]},ss:{cardinal:c[0]},ssy:{cardinal:c[0]},st:{cardinal:c[0]},sv:{cardinal:c[4],ordinal:c[51]},sw:{cardinal:c[4]},syr:{cardinal:c[0]},ta:{cardinal:c[0]},te:{cardinal:c[0]},teo:{cardinal:c[0]},ti:{cardinal:c[1]},tig:{cardinal:c[0]},tk:{cardinal:c[0],ordinal:c[52]},tl:{cardinal:c[13],ordinal:c[0]},tn:{cardinal:c[0]},tr:{cardinal:c[0]},ts:{cardinal:c[0]},tzm:{cardinal:c[33]},ug:{cardinal:c[0]},uk:{cardinal:c[29],ordinal:c[53]},ur:{cardinal:c[4]},uz:{cardinal:c[0]},ve:{cardinal:c[0]},vo:{cardinal:c[0]},vun:{cardinal:c[0]},wa:{cardinal:c[1]},wae:{cardinal:c[0]},xh:{cardinal:c[0]},xog:{cardinal:c[0]},yi:{cardinal:c[4]},zu:{cardinal:c[2]},lo:{ordinal:c[0]},ms:{ordinal:c[0]},vi:{ordinal:c[0]}}},function(e,n,t){(function(e){const n=t(12),r=t(19),i=t(21),a=t(1),{isWorker:o}=t(6),s=t(33)(null);e.Scratch=e.Scratch||{},Object.assign(e.Scratch,n,{canFetch:()=>Promise.resolve(!0),fetch:function(e){function n(n,t){return e.apply(this,arguments)}return n.toString=function(){return e.toString()},n}((e,n)=>fetch(e,n)),canOpenWindow:()=>Promise.resolve(!1),openWindow:()=>Promise.reject(new Error("Scratch.openWindow not supported in sandboxed extensions")),canRedirect:()=>Promise.resolve(!1),redirect:()=>Promise.reject(new Error("Scratch.redirect not supported in sandboxed extensions")),canRecordAudio:()=>Promise.resolve(!1),canRecordVideo:()=>Promise.resolve(!1),canReadClipboard:()=>Promise.resolve(!1),canNotify:()=>Promise.resolve(!1),canGeolocate:()=>Promise.resolve(!1),canEmbed:()=>Promise.resolve(!1),canUnsandbox:()=>Promise.resolve(!1),canScreenshotCamera:()=>Promise.resolve(!1),canDownload:()=>Promise.resolve(!1),download:()=>Promise.reject(new Error("Scratch.download not supported in sandboxed extensions")),translate:s});const c=new class{constructor(){this.nextExtensionId=0,this.initialRegistrations=[],this.firstRegistrationPromise=new Promise(e=>{this.firstRegistrationCallback=e}),i.waitForConnection.then(()=>{i.call("extensions","allocateWorker").then(async e=>{const[n,t]=e;this.workerId=n;try{await(e=>{if(!o)return new Promise((n,t)=>{const r=document.createElement("script");r.onload=()=>n(),r.onerror=()=>{t(new Error("Error in sandboxed script: ".concat(e,". Check the console for more information.")))},r.src=e,document.body.appendChild(r)});importScripts(e)})(t),await this.firstRegistrationPromise;const e=this.initialRegistrations;this.initialRegistrations=null,Promise.all(e).then(()=>i.call("extensions","onWorkerInit",n))}catch(e){a.error(e),i.call("extensions","onWorkerInit",n,"".concat(e))}})}),this.extensions=[]}register(e){const n=this.nextExtensionId++;this.extensions.push(e);const t="extension.".concat(this.workerId,".").concat(n),r=i.setService(t,e).then(()=>i.call("extensions","registerExtensionService",t));return this.initialRegistrations&&(this.firstRegistrationCallback(),this.initialRegistrations.push(r)),r}};e.Scratch.extensions={register:c.register.bind(c)},e.ScratchExtensions=r(e.Scratch)}).call(this,t(11))},function(e,n){var t;t=function(){return this}();try{t=t||new Function("return this")()}catch(e){"object"==typeof window&&(t=window)}e.exports=t},function(e,n,t){const r={ArgumentType:t(2),ArgumentAlignment:t(13),BlockType:t(3),BlockShape:t(14),NotchShape:t(15),TargetType:t(16),Cast:t(17),Clone:t(18),Color:t(4)};e.exports=r},function(e,n){e.exports={DEFAULT:null,LEFT:"LEFT",CENTER:"CENTRE",RIGHT:"RIGHT"}},function(e,n){e.exports={HEXAGONAL:1,ROUND:2,SQUARE:3,LEAF:4,PLUS:5,OCTAGONAL:6,BUMPED:7,INDENTED:8,SCRAPPED:9,ARROW:10,TICKET:11}},function(e,n){e.exports={SWITCH:"switchCase",HEXAGON:"hexagon",ROUND:"round",SQUARE:"square",LEAF:"leaf",PLUS:"plus",OCTAGONAL:"octagonal",BUMPED:"bumped",INDENTED:"indented",SCRAPPED:"scrapped",ARROW:"arrow",TICKET:"ticket",JIGSAW:"jigsaw",INVERTED:"inverted",PINCER:"pincer"}},function(e,n){e.exports={SPRITE:"sprite",STAGE:"stage"}},function(e,n,t){const r=t(4),i=e=>{if("string"!=typeof e)return!1;for(let n=0;n<e.length;n++){const t=e.charCodeAt(n);if(48===t||9===t)return!1}return!0};class a{static toNumber(e){if("number"==typeof e)return Number.isNaN(e)?0:e;const n=Number(e);return Number.isNaN(n)?0:n}static toBoolean(e){return"boolean"==typeof e?e:"string"==typeof e?""!==e&&"0"!==e&&"false"!==e.toLowerCase():Boolean(e)}static toString(e){return String(e)}static toRgbColorList(e){const n=a.toRgbColorObject(e);return[n.r,n.g,n.b]}static toRgbColorObject(e){let n;return"string"==typeof e&&"#"===e.substring(0,1)?(n=r.hexToRgb(e),n||(n={r:0,g:0,b:0,a:255})):n=r.decimalToRgb(a.toNumber(e)),n}static isWhiteSpace(e){return null===e||"string"==typeof e&&0===e.trim().length}static compare(e,n){let t=Number(e),r=Number(n);if(0===t&&i(e)?t=NaN:0===r&&i(n)&&(r=NaN),isNaN(t)||isNaN(r)){const t=String(e).toLowerCase(),r=String(n).toLowerCase();return t<r?-1:t>r?1:0}return t===1/0&&r===1/0||t===-1/0&&r===-1/0?0:t-r}static isInt(e){return"number"==typeof e?!!isNaN(e)||e===Math.floor(e):"boolean"==typeof e||"string"==typeof e&&e.indexOf(".")<0}static get LIST_INVALID(){return"INVALID"}static get LIST_ALL(){return"ALL"}static toListIndex(e,n,t){if("number"!=typeof e){if("all"===e)return t?a.LIST_ALL:a.LIST_INVALID;if("last"===e)return n>0?n:a.LIST_INVALID;if("random"===e||"any"===e)return n>0?1+Math.floor(Math.random()*n):a.LIST_INVALID}return(e=Math.floor(a.toNumber(e)))<1||e>n?a.LIST_INVALID:e}}e.exports=a},function(e,n){e.exports=class{static simple(e){return JSON.parse(JSON.stringify(e))}}},function(e,n,t){const r=t(2),i=t(3),{argumentIndexToId:a,generateExtensionId:o}=t(20),s=e=>{if(""===e||" "===e||"w"===e)return{type:i.COMMAND,async:"w"===e};if("r"===e||"R"===e)return{type:i.REPORTER,async:"R"===e};if("b"===e)return{type:i.BOOLEAN,async:!1};if("h"===e)return{type:i.HAT,async:!1};throw new Error("Unknown ScratchX block type: ".concat(e))},c=(e,n)=>{const t={},i="string"==typeof(a=n)||"number"==typeof a||"boolean"==typeof a;var a;if(i&&(t.defaultValue=n),"s"===e)t.type=r.STRING,i||(t.defaultValue="");else if("n"===e)t.type=r.NUMBER,i||(t.defaultValue=0);else{if("m"!==e[0])throw new Error("Unknown ScratchX argument type: ".concat(e));{t.type=r.STRING;const n=e.split(/\\.|:/)[1];t.menu=n}}return t},l=(e,n,t)=>r=>{const i=[];for(let e=0;e<n;e++)i.push(r[a(e)]);return t?new Promise(n=>{e(...i,n)}):e(...i)},u=new Map;e.exports=e=>({register:(n,t,r)=>{const i=((e,n,t)=>{const r={id:o(e),name:n.displayName||e,blocks:[],color1:"#4a4a5e",color2:"#31323f",color3:"#191a21"},i={getInfo:()=>r,_getStatus:t._getStatus};n.url&&(r.docsURI=n.url);for(const e of n.blocks){if(1===e.length){r.blocks.push("---");continue}const n=e[0],o=e[1],u=e[2],d=e.slice(3);let f="";const h=[],p=o.split(/%([\\w.:]+)/g);for(let e=0;e<p.length;e++){const n=p[e];if(e%2==1){c(n);const t=Math.floor(e/2).toString(),r=d[t],i=a(t);h[i]=c(n,r),f+="[".concat(i,"]")}else f+=n}const m=s(n),g={opcode:u,blockType:m.type,text:f,arguments:h};r.blocks.push(g);const v=t[u],b=h.length;i[u]=l(v,b,m.async)}const u=n.menus;if(u){const e={};for(const n of Object.keys(u)||{}){const t={items:u[n]};e[n]=t}r.menus=e}return i})(n,t,r);u.set(n,i),e.extensions.register(i)},getStatus:e=>{const n=u.get(e);return n?n._getStatus():{status:0,msg:"does not exist"}}})},function(e,n){e.exports={generateExtensionId:e=>{const n=e.replace(/[^a-z0-9]/gi,"").toLowerCase();return"sbx".concat(n)},argumentIndexToId:e=>e.toString()}},function(e,n,t){const r=t(22),i=t(1),{centralDispatchService:a}=t(6);e.exports=new class extends r{constructor(){super(),this._connectionPromise=new Promise(e=>{this._onConnect=e}),this.services={},this._onMessage=this._onMessage.bind(this,a),"undefined"!=typeof self&&(self.onmessage=this._onMessage)}get waitForConnection(){return this._connectionPromise}setService(e,n){return this.services.hasOwnProperty(e)&&i.warn("Worker dispatch replacing existing service provider for ".concat(e)),this.services[e]=n,this.waitForConnection.then(()=>this._remoteCall(a,"dispatch","setService",e))}_getServiceProvider(e){const n=this.services[e];return{provider:n||a,isRemote:!n}}_onDispatchMessage(e,n){let t;switch(n.method){case"handshake":t=this._onConnect();break;case"terminate":setTimeout(()=>self.close(),0),t=Promise.resolve();break;default:i.error("Worker dispatch received message for unknown method: ".concat(n.method))}return t}}},function(e,n,t){const r=t(1);e.exports=class{constructor(){this.callbacks=[],this.nextResponseId=0}call(e,n){for(var t=arguments.length,r=new Array(t>2?t-2:0),i=2;i<t;i++)r[i-2]=arguments[i];return this.transferCall(e,n,null,...r)}transferCall(e,n,t){try{const{provider:o,isRemote:s}=this._getServiceProvider(e);if(o){for(var r=arguments.length,i=new Array(r>3?r-3:0),a=3;a<r;a++)i[a-3]=arguments[a];if(s)return this._remoteTransferCall(o,e,n,t,...i);const c=o[n].apply(o,i);return Promise.resolve(c)}return Promise.reject(new Error("Service not found: ".concat(e)))}catch(e){return Promise.reject(e)}}_isRemoteService(e){var n,t;return null!==(n=null===(t=this._getServiceProvider(e))||void 0===t?void 0:t.isRemote)&&void 0!==n&&n}_remoteCall(e,n,t){for(var r=arguments.length,i=new Array(r>3?r-3:0),a=3;a<r;a++)i[a-3]=arguments[a];return this._remoteTransferCall(e,n,t,null,...i)}_remoteTransferCall(e,n,t,r){for(var i=arguments.length,a=new Array(i>4?i-4:0),o=4;o<i;o++)a[o-4]=arguments[o];return new Promise((i,o)=>{const s=this._storeCallbacks(i,o);a.length>0&&"function"==typeof a[a.length-1].func&&(a.pop(),a.pop()),r?e.postMessage({service:n,method:t,responseId:s,args:a},r):e.postMessage({service:n,method:t,responseId:s,args:a})})}_storeCallbacks(e,n){const t=this.nextResponseId++;return this.callbacks[t]=[e,n],t}_deliverResponse(e,n){try{const[t,r]=this.callbacks[e];delete this.callbacks[e],n.error?r(n.error):t(n.result)}catch(e){r.error("Dispatch callback failed: ".concat(e))}}_onMessage(e,n){const t=n.data;let i;t.args=t.args||[],t.service?i="dispatch"===t.service?this._onDispatchMessage(e,t):this.call(t.service,t.method,...t.args):void 0===t.responseId?r.error("Dispatch caught malformed message from a worker: ".concat(JSON.stringify(n))):this._deliverResponse(t.responseId,t),i&&(void 0===t.responseId?r.error("Dispatch message missing required response ID: ".concat(JSON.stringify(n))):i.then(n=>e.postMessage({responseId:t.responseId,result:n}),n=>e.postMessage({responseId:t.responseId,error:"".concat(n)})))}_getServiceProvider(e){throw new Error("Could not get provider for ".concat(e,": _getServiceProvider not implemented"))}_onDispatchMessage(e,n){throw new Error("Unimplemented dispatch message handler cannot handle ".concat(n.method," method"))}}},function(e,n,t){var r=t(24),i=r.enable,a=r.disable,o="undefined"!=typeof navigator&&/chrome/i.test(navigator.userAgent),s=t(27);if(r.defaultBackend=o?s.minilog:s,"undefined"!=typeof window){try{r.enable(JSON.parse(window.localStorage.minilogSettings))}catch(e){}if(window.location&&window.location.search){var c=RegExp("[?&]minilog=([^&]*)").exec(window.location.search);c&&r.enable(decodeURIComponent(c[1]))}}r.enable=function(){i.call(r,!0);try{window.localStorage.minilogSettings=JSON.stringify(!0)}catch(e){}return this},r.disable=function(){a.call(r);try{delete window.localStorage.minilogSettings}catch(e){}return this},(e.exports=r).backends={array:t(30),browser:r.defaultBackend,localStorage:t(31),jQuery:t(32)}},function(e,n,t){var r=t(0),i=t(26),a=new r,o=Array.prototype.slice;(n=e.exports=function(e){var t=function(){return a.write(e,void 0,o.call(arguments)),t};return t.debug=function(){return a.write(e,"debug",o.call(arguments)),t},t.info=function(){return a.write(e,"info",o.call(arguments)),t},t.warn=function(){return a.write(e,"warn",o.call(arguments)),t},t.error=function(){return a.write(e,"error",o.call(arguments)),t},t.log=t.debug,t.suggest=n.suggest,t.format=a.format,t}).defaultBackend=n.defaultFormatter=null,n.pipe=function(e){return a.pipe(e)},n.end=n.unpipe=n.disable=function(e){return a.unpipe(e)},n.Transform=r,n.Filter=i,n.suggest=new i,n.enable=function(){return n.defaultFormatter?a.pipe(n.suggest).pipe(n.defaultFormatter).pipe(n.defaultBackend):a.pipe(n.suggest).pipe(n.defaultBackend)}},function(e,n){function t(){this._events={}}t.prototype={on:function(e,n){this._events||(this._events={});var t=this._events;return(t[e]||(t[e]=[])).push(n),this},removeListener:function(e,n){var t,r=this._events[e]||[];for(t=r.length-1;t>=0&&r[t];t--)r[t]!==n&&r[t].cb!==n||r.splice(t,1)},removeAllListeners:function(e){e?this._events[e]&&(this._events[e]=[]):this._events={}},listeners:function(e){return this._events&&this._events[e]||[]},emit:function(e){this._events||(this._events={});var n,t=Array.prototype.slice.call(arguments,1),r=this._events[e]||[];for(n=r.length-1;n>=0&&r[n];n--)r[n].apply(this,t);return this},when:function(e,n){return this.once(e,n,!0)},once:function(e,n,t){if(!n)return this;function r(){t||this.removeListener(e,r),n.apply(this,arguments)&&t&&this.removeListener(e,r)}return r.cb=n,this.on(e,r),this}},t.mixin=function(e){var n,r=t.prototype;for(n in r)r.hasOwnProperty(n)&&(e.prototype[n]=r[n])},e.exports=t},function(e,n,t){var r=t(0),i={debug:1,info:2,warn:3,error:4};function a(){this.enabled=!0,this.defaultResult=!0,this.clear()}function o(e,n){return e.n.test?e.n.test(n):e.n==n}r.mixin(a),a.prototype.allow=function(e,n){return this._white.push({n:e,l:i[n]}),this},a.prototype.deny=function(e,n){return this._black.push({n:e,l:i[n]}),this},a.prototype.clear=function(){return this._white=[],this._black=[],this},a.prototype.test=function(e,n){var t,r=Math.max(this._white.length,this._black.length);for(t=0;t<r;t++){if(this._white[t]&&o(this._white[t],e)&&i[n]>=this._white[t].l)return!0;if(this._black[t]&&o(this._black[t],e)&&i[n]<=this._black[t].l)return!1}return this.defaultResult},a.prototype.write=function(e,n,t){if(!this.enabled||this.test(e,n))return this.emit("item",e,n,t)},e.exports=a},function(e,n,t){var r=t(0),i=/\\n+$/,a=new r;a.write=function(e,n,t){var r=t.length-1;if("undefined"!=typeof console&&console.log){if(console.log.apply)return console.log.apply(console,[e,n].concat(t));if(JSON&&JSON.stringify){t[r]&&"string"==typeof t[r]&&(t[r]=t[r].replace(i,""));try{for(r=0;r<t.length;r++)t[r]=JSON.stringify(t[r])}catch(e){}console.log(t.join(" "))}}},a.formatters=["color","minilog"],a.color=t(28),a.minilog=t(29),e.exports=a},function(e,n,t){var r=t(0),i=t(5),a={debug:["cyan"],info:["purple"],warn:["yellow",!0],error:["red",!0]},o=new r;o.write=function(e,n,t){console.log;console[n]&&console[n].apply&&console[n].apply(console,["%c"+e+" %c"+n,i("gray"),i.apply(i,a[n])].concat(t))},o.pipe=function(){},e.exports=o},function(e,n,t){var r=t(0),i=t(5),a={debug:["gray"],info:["purple"],warn:["yellow",!0],error:["red",!0]},o=new r;o.write=function(e,n,t){var r=console.log;"debug"!=n&&console[n]&&(r=console[n]);var o=0;if("info"!=n){for(;o<t.length&&"string"==typeof t[o];o++);r.apply(console,["%c"+e+" "+t.slice(0,o).join(" "),i.apply(i,a[n])].concat(t.slice(o)))}else r.apply(console,["%c"+e,i.apply(i,a[n])].concat(t))},o.pipe=function(){},e.exports=o},function(e,n,t){var r=t(0),i=[],a=new r;a.write=function(e,n,t){i.push([e,n,t])},a.get=function(){return i},a.empty=function(){i=[]},e.exports=a},function(e,n,t){var r=t(0),i=!1,a=new r;a.write=function(e,n,t){if("undefined"!=typeof window&&"undefined"!=typeof JSON&&JSON.stringify&&JSON.parse)try{i||(i=window.localStorage.minilog?JSON.parse(window.localStorage.minilog):[]),i.push([(new Date).toString(),e,n,t]),window.localStorage.minilog=JSON.stringify(i)}catch(e){}},e.exports=a},function(e,n,t){var r=t(0),i=(new Date).valueOf().toString(36);function a(e){this.url=e.url||"",this.cache=[],this.timer=null,this.interval=e.interval||3e4,this.enabled=!0,this.jQuery=window.jQuery,this.extras={}}r.mixin(a),a.prototype.write=function(e,n,t){this.timer||this.init(),this.cache.push([e,n].concat(t))},a.prototype.init=function(){if(this.enabled&&this.jQuery){var e=this;this.timer=setTimeout((function(){var n,t,r=[],a=e.url;if(0==e.cache.length)return e.init();for(n=0;n<e.cache.length;n++)try{JSON.stringify(e.cache[n]),r.push(e.cache[n])}catch(e){}e.jQuery.isEmptyObject(e.extras)?(t=JSON.stringify({logs:r}),a=e.url+"?client_id="+i):t=JSON.stringify(e.jQuery.extend({logs:r},e.extras)),e.jQuery.ajax(a,{type:"POST",cache:!1,processData:!1,data:t,contentType:"application/json",timeout:1e4}).success((function(n,t,r){n.interval&&(e.interval=Math.max(1e3,n.interval))})).error((function(){e.interval=3e4})).always((function(){e.init()})),e.cache=[]}),this.interval)}},a.prototype.end=function(){},a.jQueryWait=function(e){if("undefined"!=typeof window&&(window.jQuery||window.$))return e(window.jQuery||window.$);"undefined"!=typeof window&&setTimeout((function(){a.jQueryWait(e)}),200)},e.exports=a},function(e,n,t){const r=t(34);e.exports=e=>{const n=r.namespace(),t=(e,t)=>{if(e&&"object"==typeof e);else{if("string"!=typeof e)throw new Error("unsupported data type in translate()");e={default:e}}return n(e,t)},i=e=>"_".concat(e),a=()=>e?e.getLocale():"undefined"!=typeof navigator?navigator.language:"en";let o={};return t.setup=e=>{e&&(o=e),n.setup({locale:a(),missingTranslation:"ignore",generateId:i,translations:o})},Object.defineProperty(t,"language",{configurable:!0,enumerable:!0,get:()=>a()}),t.setup({}),e&&e.on("LOCALE_CHANGED",()=>{t.setup(null)}),t}},function(e,n,t){"use strict";var r=t(35),i=t(36),a=t(9),o=t(8),s=t(7);function c(e,n){return Object.keys(n).forEach((function(t){e[t]=n[t]})),e}e.exports=function e(){var n=c({},s),t="en",l={},u=function(e){return e},d=null,f="warning",h={};function p(e,n,a){var o="string"==typeof e?e:e.default,s=v(o,"object"==typeof e&&e.id||u(o),a||t);return(s.format||(s.format=i(r(s.message),a||t,h)))(n)}p.rich=function(e,n,a){var o="string"==typeof e?e:e.default,s=v(o,"object"==typeof e&&e.id||u(o),a||t);return(s.toParts||(s.toParts=i.toParts(r(s.message,{tagsType:m}),a||t,h)))(n)};var m="<>";function g(e,n){var t=e[2];return function(e,n){var r="object"==typeof t?function(e,n){return Object.keys(e).reduce((function(t,r){return t[r]=e[r](n),t}),{})}(t,n):t;return"function"==typeof e?e(r):e}}function v(e,n,t){var r=o(t,l)||"en",i=l[r]||(l[r]={}),a=i[n];if("string"==typeof a&&(a=i[n]={message:a}),!a){var s=\'Translation for "\'+n+\'" in "\'+r+\'" is missing\';if("warning"===f)"undefined"!=typeof console&&console.warn(s);else if("ignore"!==f)throw new Error(s);var c="function"==typeof d?d(e,n,r)||e:d||e;a=i[n]={message:c}}return a}function b(e,n,r,i,s){"object"==typeof r&&"object"!=typeof i&&(s=i,i=r,r=0);var c=o(s||t,a),l=c&&a[c][e]||y;return i["="+ +n]||i[l(n-r)]||i.other}function y(){return"other"}return h[m]=g,p.setup=function(e){return(e=e||{}).locale&&(t=e.locale),"translations"in e&&(l=e.translations||{}),e.generateId&&(u=e.generateId),"missingReplacement"in e&&(d=e.missingReplacement),e.missingTranslation&&(f=e.missingTranslation),e.formats&&(e.formats.number&&c(n.number,e.formats.number),e.formats.date&&c(n.date,e.formats.date),e.formats.time&&c(n.time,e.formats.time)),e.types&&((h=e.types)[m]=g),{locale:t,translations:l,generateId:u,missingReplacement:d,missingTranslation:f,formats:n,types:h}},p.number=function(e,r,i){var a=r&&n.number[r]||n.parseNumberPattern(r)||n.number.default;return new Intl.NumberFormat(i||t,a).format(e)},p.date=function(e,r,i){var a=r&&n.date[r]||n.parseDatePattern(r)||n.date.default;return new Intl.DateTimeFormat(i||t,a).format(e)},p.time=function(e,r,i){var a=r&&n.time[r]||n.parseDatePattern(r)||n.time.default;return new Intl.DateTimeFormat(i||t,a).format(e)},p.select=function(e,n){return n[e]||n.other},p.custom=function(e,n,t,r){return e[1]in h?h[e[1]](e,n)(t,r):t},p.plural=b.bind(null,"cardinal"),p.selectordinal=b.bind(null,"ordinal"),p.namespace=e,p}()},function(e,n,t){"use strict";var r=["number","date","time","ordinal","duration","spellout"],i=["plural","select","selectordinal"];function a(e,n){var t=e.pattern,r=t.length,i=[],a=e.index,s=o(e,n);for(s&&i.push(s),s&&e.tokens&&e.tokens.push(["text",t.slice(a,e.index)]);e.index<r;){if("}"===t[e.index]){if(!n)throw p(e);break}if(n&&e.tagsType&&"</"===t.slice(e.index,e.index+"</".length))break;i.push(l(e)),a=e.index,(s=o(e,n))&&i.push(s),s&&e.tokens&&e.tokens.push(["text",t.slice(a,e.index)])}return i}function o(e,n){for(var t=e.pattern,r=t.length,i="plural"===n||"selectordinal"===n,a=!!e.tagsType,o="{style}"===n,c="";e.index<r;){var l=t[e.index];if("{"===l||"}"===l||i&&"#"===l||a&&"<"===l||o&&s(l.charCodeAt(0)))break;if("\'"===l)if("\'"===(l=t[++e.index]))c+=l,++e.index;else if("{"===l||"}"===l||i&&"#"===l||a&&"<"===l||o)for(c+=l;++e.index<r;)if("\'"===(l=t[e.index])&&"\'"===t[e.index+1])c+="\'",++e.index;else{if("\'"===l){++e.index;break}c+=l}else c+="\'";else c+=l,++e.index}return c}function s(e){return e>=9&&e<=13||32===e||133===e||160===e||6158===e||e>=8192&&e<=8205||8232===e||8233===e||8239===e||8287===e||8288===e||12288===e||65279===e}function c(e){for(var n=e.pattern,t=n.length,r=e.index;e.index<t&&s(n.charCodeAt(e.index));)++e.index;r<e.index&&e.tokens&&e.tokens.push(["space",e.pattern.slice(r,e.index)])}function l(e){var n=e.pattern;if("#"===n[e.index])return e.tokens&&e.tokens.push(["syntax","#"]),++e.index,["#"];var t=function(e){var n=e.tagsType;if(!n||"<"!==e.pattern[e.index])return;if("</"===e.pattern.slice(e.index,e.index+"</".length))throw p(e,null,"closing tag without matching opening tag");e.tokens&&e.tokens.push(["syntax","<"]);++e.index;var t=u(e,!0);if(!t)throw p(e,"placeholder id");e.tokens&&e.tokens.push(["id",t]);if(c(e),"/>"===e.pattern.slice(e.index,e.index+"/>".length))return e.tokens&&e.tokens.push(["syntax","/>"]),e.index+="/>".length,[t,n];if(">"!==e.pattern[e.index])throw p(e,">");e.tokens&&e.tokens.push(["syntax",">"]);++e.index;var r=a(e,n),i=e.index;if("</"!==e.pattern.slice(e.index,e.index+"</".length))throw p(e,"</"+t+">");e.tokens&&e.tokens.push(["syntax","</"]);e.index+="</".length;var o=u(e,!0);o&&e.tokens&&e.tokens.push(["id",o]);if(t!==o)throw e.index=i,p(e,"</"+t+">","</"+o+">");if(c(e),">"!==e.pattern[e.index])throw p(e,">");e.tokens&&e.tokens.push(["syntax",">"]);return++e.index,[t,n,{children:r}]}(e);if(t)return t;if("{"!==n[e.index])throw p(e,"{");e.tokens&&e.tokens.push(["syntax","{"]),++e.index,c(e);var i=u(e);if(!i)throw p(e,"placeholder id");e.tokens&&e.tokens.push(["id",i]),c(e);var o=n[e.index];if("}"===o)return e.tokens&&e.tokens.push(["syntax","}"]),++e.index,[i];if(","!==o)throw p(e,", or }");e.tokens&&e.tokens.push(["syntax",","]),++e.index,c(e);var s,l=u(e);if(!l)throw p(e,"placeholder type");if(e.tokens&&e.tokens.push(["type",l]),c(e),"}"===(o=n[e.index])){if(e.tokens&&e.tokens.push(["syntax","}"]),"plural"===l||"selectordinal"===l||"select"===l)throw p(e,l+" sub-messages");return++e.index,[i,l]}if(","!==o)throw p(e,", or }");if(e.tokens&&e.tokens.push(["syntax",","]),++e.index,c(e),"plural"===l||"selectordinal"===l){var h=function(e){var n=e.pattern,t=n.length,r=0;if("offset:"===n.slice(e.index,e.index+"offset:".length)){e.tokens&&e.tokens.push(["offset","offset"],["syntax",":"]),e.index+="offset:".length,c(e);for(var i=e.index;e.index<t&&((a=n.charCodeAt(e.index))>=48&&a<=57);)++e.index;if(i===e.index)throw p(e,"offset number");e.tokens&&e.tokens.push(["number",n.slice(i,e.index)]),r=+n.slice(i,e.index)}var a;return r}(e);c(e),s=[i,l,h,f(e,l)]}else if("select"===l)s=[i,l,f(e,l)];else if(r.indexOf(l)>=0)s=[i,l,d(e)];else{var m=e.index,g=d(e);c(e),"{"===n[e.index]&&(e.index=m,g=f(e,l)),s=[i,l,g]}if(c(e),"}"!==n[e.index])throw p(e,"}");return e.tokens&&e.tokens.push(["syntax","}"]),++e.index,s}function u(e,n){for(var t=e.pattern,r=t.length,i="";e.index<r;){var a=t[e.index];if("{"===a||"}"===a||","===a||"#"===a||"\'"===a||s(a.charCodeAt(0))||n&&("<"===a||">"===a||"/"===a))break;i+=a,++e.index}return i}function d(e){var n=e.index,t=o(e,"{style}");if(!t)throw p(e,"placeholder style name");return e.tokens&&e.tokens.push(["style",e.pattern.slice(n,e.index)]),t}function f(e,n){for(var t=e.pattern,r=t.length,a={};e.index<r&&"}"!==t[e.index];){var o=u(e);if(!o)throw p(e,"sub-message selector");e.tokens&&e.tokens.push(["selector",o]),c(e),a[o]=h(e,n),c(e)}if(!a.other&&i.indexOf(n)>=0)throw p(e,null,null,\'"other" sub-message must be specified in \'+n);return a}function h(e,n){if("{"!==e.pattern[e.index])throw p(e,"{ to start sub-message");e.tokens&&e.tokens.push(["syntax","{"]),++e.index;var t=a(e,n);if("}"!==e.pattern[e.index])throw p(e,"} to end sub-message");return e.tokens&&e.tokens.push(["syntax","}"]),++e.index,t}function p(e,n,t,r){var i=e.pattern,a=i.slice(0,e.index).split(/\\r?\\n/),o=e.index,s=a.length,c=a.slice(-1)[0].length;return t=t||(e.index>=i.length?"end of message pattern":u(e)||i[e.index]),r||(r=function(e,n){return e?"Expected "+e+" but found "+n:"Unexpected "+n+" found"}(n,t)),new m(r+=" in "+i.replace(/\\r?\\n/g,"\\n"),n,t,o,s,c)}function m(e,n,t,r,i,a){Error.call(this,e),this.name="SyntaxError",this.message=e,this.expected=n,this.found=t,this.offset=r,this.line=i,this.column=a}n=e.exports=function(e,n){return a({pattern:String(e),index:0,tagsType:n&&n.tagsType||null,tokens:n&&n.tokens||null},"")},m.prototype=Object.create(Error.prototype),n.SyntaxError=m},function(e,n,t){"use strict";var r=t(7),i=t(8),a=t(9);function o(e,n,t,r,i){var a=e.map((function(e){return function(e,n,t,r,i){if("string"==typeof e){var a=e;return function(){return a}}var c,l=e[0],u=e[1];if(n&&"#"===e[0]){l=n[0];var d=n[2],h=(r.number||f.number)([l,"number"],t);return function(e){return h(s(l,e)-d,e)}}"plural"===u||"selectordinal"===u?(c={},Object.keys(e[3]).forEach((function(n){c[n]=o(e[3][n],e,t,r,i)})),e=[e[0],e[1],e[2],c]):e[2]&&"object"==typeof e[2]&&(c={},Object.keys(e[2]).forEach((function(n){c[n]=o(e[2][n],e,t,r,i)})),e=[e[0],e[1],c]);var p=u&&(r[u]||f[u]);if(p){var m=p(e,t);return function(e){return m(s(l,e),e)}}return i?function(e){return String(s(l,e))}:function(e){return s(l,e)}}(e,n,t,r,i)}));return i?1===a.length?a[0]:function(e){for(var n="",t=0;t<a.length;++t)n+=a[t](e);return n}:function(e){return a.reduce((function(n,t){return n.concat(t(e))}),[])}}function s(e,n){if(n&&e in n)return n[e];for(var t=e.split("."),r=n,i=0,a=t.length;r&&i<a;++i)r=r[t[i]];return r}function c(e,n){var t=e[2],i=r.number[t]||r.parseNumberPattern(t)||r.number.default;return new Intl.NumberFormat(n,i).format}function l(e,n){var t=e[1],i=e[2],a=r[t][i]||r.parseDatePattern(i)||r[t].default;return new Intl.DateTimeFormat(n,a).format}function u(e,n){var t,r="selectordinal"===e[1]?"ordinal":"cardinal",o=e[2],s=e[3];if(Intl.PluralRules&&Intl.PluralRules.supportedLocalesOf(n).length>0)t=new Intl.PluralRules(n,{type:r});else{var c=i(n,a),l=c&&a[c][r]||d;t={select:l}}return function(e,n){return(s["="+ +e]||s[t.select(e-o)]||s.other)(n)}}function d(){return"other"}(n=e.exports=function(e,n,t){return o(e,null,n||"en",t||{},!0)}).toParts=function(e,n,t){return o(e,null,n||"en",t||{},!1)};var f={number:c,ordinal:c,spellout:c,duration:function(e,n){var t=e[2],i=r.duration[t]||r.duration.default,a=new Intl.NumberFormat(n,i.seconds).format,o=new Intl.NumberFormat(n,i.minutes).format,s=new Intl.NumberFormat(n,i.hours).format,c=/^fi$|^fi-|^da/.test(String(n))?".":":";return function(e,n){if(e=+e,!isFinite(e))return a(e);var t=~~(e/60/60),r=~~(e/60%60),i=(t?s(Math.abs(t))+c:"")+o(Math.abs(r))+c+a(Math.abs(e%60));return e<0?s(-1).replace(s(1),i):i}},date:l,time:l,plural:u,selectordinal:u,select:function(e,n){var t=e[2];return function(e,n){return(t[e]||t.other)(n)}}};n.types=f}]);',null)}},function(A,e,t){const n=t(27),i=t(22),r=t(19),o=t(47),s=t(9),{Map:a}=t(34),B=t(5),c=t(10),g=t(102),E=t(62);A.exports=class extends n{constructor(A,e){super(),e||(e=new i(A)),this.runtime=A,this.id=s(),this.blocks=e,this.variables={},this.comments={},this._customState={},this._edgeActivatedHatValues={},this.extensionStorage=E()}onGreenFlag(){}getName(){return this.id}updateEdgeActivatedValue(A,e){const t=this._edgeActivatedHatValues[A];return this._edgeActivatedHatValues[A]=e,t}hasEdgeActivatedValue(A){return this._edgeActivatedHatValues.hasOwnProperty(A)}clearEdgeActivatedValues(){this._edgeActivatedHatValues={}}lookupOrCreateVariable(A,e){let t=this.lookupVariableById(A);if(t)return t;if(t=this.lookupVariableByNameAndType(e,r.SCALAR_TYPE),t)return t;const n=new r(A,e,r.SCALAR_TYPE,!1);return this.variables[A]=n,n}lookupBroadcastMsg(A,e){let t;if(A?t=this.lookupVariableById(A):e?t=this.lookupBroadcastByInputValue(e):B.error("Cannot find broadcast message if neither id nor name are provided."),t)return e&&t.name.toLowerCase()!==e.toLowerCase()&&B.error("Found broadcast message with id: ".concat(A,", but")+"its name, ".concat(t.name," did not match expected name ").concat(e,".")),t.type!==r.BROADCAST_MESSAGE_TYPE&&B.error("Found variable with id: ".concat(A,", but its type ").concat(t.type)+"did not match expected type ".concat(r.BROADCAST_MESSAGE_TYPE)),t}lookupBroadcastByInputValue(A){return Object.values(this.variables).find(e=>e.type===r.BROADCAST_MESSAGE_TYPE&&e.name.toLowerCase()===A.toLowerCase())}lookupVariableById(A){if(this.variables.hasOwnProperty(A))return this.variables[A];if(this.runtime&&!this.isStage){const e=this.runtime.getTargetForStage();if(e&&e.variables.hasOwnProperty(A))return e.variables[A]}}lookupVariableByNameAndType(A,e,t){if("string"!=typeof A)return;"string"!=typeof e&&(e=r.SCALAR_TYPE),t=t||!1;const n=Object.values(this.variables).find(t=>t.name===A&&t.type===e);if(n)return n;if(!t&&this.runtime&&!this.isStage){const t=this.runtime.getTargetForStage();if(t){const n=Object.values(t.variables).find(t=>t.name===A&&t.type===e);if(n)return n}}return null}lookupOrCreateList(A,e){let t=this.lookupVariableById(A);if(t)return t;if(t=this.lookupVariableByNameAndType(e,r.LIST_TYPE),t)return t;const n=new r(A,e,r.LIST_TYPE,!1);return this.variables[A]=n,n}createVariable(A,e,t,n){if(!this.variables.hasOwnProperty(A)){const i=this.runtime.newVariableInstance(t,A,e,!1);n&&this.isStage&&this.runtime.canAddCloudVariable()&&(i.isCloud=!0,this.runtime.addCloudVariable(),this.runtime.ioDevices.cloud.requestCreateVariable(i)),this.variables[A]=i}}createComment(A,e,t,n,i,r,s,a){if(!this.comments.hasOwnProperty(A)){const c=new o(A,t,n,i,r,s,a);if(e){c.blockId=e;const t=this.blocks.getBlock(e);t?t.comment=A:B.warn("Could not find block with id ".concat(e," associated with commentId: ").concat(A))}this.comments[A]=c}}renameVariable(A,e){if(this.variables.hasOwnProperty(A)){const t=this.variables[A];if(t.id===A){const n=t.name;if(t.name=e,this.runtime){if(t.isCloud&&this.isStage&&this.runtime.ioDevices.cloud.requestRenameVariable(n,e),t.type===r.SCALAR_TYPE){let A=!1;this.runtime.targets.forEach(t=>{A=t.blocks.updateSensingOfReference(n,e,this.isStage?"_stage_":this.getName())||A}),A&&this.runtime.requestBlocksUpdate()}const i=this.runtime.monitorBlocks;i.changeBlock({id:A,element:"field",name:t.type===r.LIST_TYPE?"LIST":"VARIABLE",value:A},this.runtime);const o=i.getBlock(t.id);o&&this.runtime.requestUpdateMonitor(a({id:A,params:i._getBlockParams(o)}))}}}}deleteVariable(A){if(this.variables.hasOwnProperty(A)){const e=this.variables[A].name,t=this.variables[A].isCloud;delete this.variables[A],this.runtime&&(t&&this.isStage&&(this.runtime.ioDevices.cloud.requestDeleteVariable(e),this.runtime.removeCloudVariable()),this.runtime.monitorBlocks.deleteBlock(A),this.runtime.requestRemoveMonitor(A))}}deleteMonitors(){let A;this.runtime.requestRemoveMonitorByTargetId(this.id),A=this.isStage?Object.keys(this.variables):Object.keys(this.runtime.monitorBlocks._blocks).filter(A=>this.runtime.monitorBlocks._blocks[A].targetId===this.id);for(const e of A)this.runtime.monitorBlocks.deleteBlock(e)}duplicateVariable(A,e){if(this.variables.hasOwnProperty(A)){const t=this.variables[A],n=this.runtime.newVariableInstance(t.type,e?A:null,t.name,t.isCloud);return n.type===r.LIST_TYPE?n.value=t.value.slice(0):n.value=t.value,n}return null}duplicateVariables(A){let e;return A&&(e=A.getAllVariableAndListReferences()),Object.keys(this.variables).reduce((t,n)=>{const i=this.duplicateVariable(n,!A);if(t[i.id]=i,A&&e){const A=e[n];A&&this.mergeVariables(n,i.id,A)}return t},{})}postSpriteInfo(){}getCustomState(A){return this._customState[A]}setCustomState(A,e){this._customState[A]=e}dispose(){this._customState={},this.runtime&&this.runtime.removeExecutable(this)}getAllVariableNamesInScopeByType(A,e){"string"!=typeof A&&(A=r.SCALAR_TYPE),e=e||!1;const t=Object.values(this.variables).filter(e=>e.type===A).map(A=>A.name);if(e||this.isStage||!this.runtime)return t;const n=this.runtime.getTargetForStage().getAllVariableNamesInScopeByType(A);return t.concat(n)}mergeVariables(A,e,t,n){const i=t||this.blocks.getAllVariableAndListReferences()[A];g.updateVariableIdentifiers(i,e,n)}shareLocalVariableToStage(A,e){if(!this.runtime)return;const t=this.variables[A];if(!t)return void B.warn("Cannot share a local variable to the stage if it's not local.");const n=this.runtime.getTargetForStage(),i="StageVarFromLocal_".concat(A);let r=n.lookupVariableById(i);if(!r){const A=t.name,e=t.type,n="Stage: ".concat(A);r=this.runtime.createNewGlobalVariable(n,i,e)}this.mergeVariables(A,r.id,e,r.name)}shareLocalVariableToSprite(A,e,t){if(!this.runtime)return;if(this.isStage)return;const n=this.variables[A];if(!n)return void B.warn("Tried to call 'shareLocalVariableToSprite' with a non-local variable.");const i=n.name,r=n.type,o=e.lookupVariableByNameAndType(i,r);let s;if(o)s=o.id;else{const A=this.runtime.newVariableInstance(r,null,i);s=A.id,e.variables[s]=A}this.mergeVariables(A,s,t)}resolveVariableSharingConflictsWithTarget(A,e){if(this.isStage)return;const t=this.blocks.getAllVariableAndListReferences(A);for(const A in t){if(!this.variables[A])continue;const n=t[A];e.isStage?this.shareLocalVariableToStage(A,n):this.shareLocalVariableToSprite(A,e,n)}}fixUpVariableReferences(){if(!this.runtime)return;if(this.isStage)return;const A=this.runtime.getTargetForStage();if(!A||!A.variables)return;const e=(e,t,n)=>{if(A.lookupVariableByNameAndType(t,n)){const A=c.unusedName("".concat(this.getName(),": ").concat(t),this.getAllVariableNamesInScopeByType(n));return this.renameVariable(e,A),A}return null},t=this.blocks.getAllVariableAndListReferences(),n=[];if(Object.keys(this.variables).length>0)for(const A in this.variables)this.variables.hasOwnProperty(A)&&(t[A]||n.push(A));const i=Object.create(null),r=Object.create(null),o={},s=A=>{const e=o[A];return e||(o[A]=this.runtime.getAllVarNamesOfType(A),o[A])};for(const n in t){const o=t[n][0],a=o.referencingField.value,B=o.type;if(this.lookupVariableById(n)){if(this.variables.hasOwnProperty(n)){const A=e(n,a,B);A&&t[n].map(e=>(e.referencingField.value=A,e))}}else{const e=A.lookupVariableByNameAndType(a,B);if(e)i[n]||(i[n]=e.id);else{const e=s(B),t=c.unusedName(a,e);A.createVariable(n,t,B),r[n]||(r[n]=t)}}}for(const A in n){const t=n[A];e(t,this.variables[t].name,this.variables[t].type)}for(const A in i){const e=i[A],n=t[A];this.mergeVariables(A,e,n)}for(const A in r){const e=r[A];t[A].map(A=>(A.referencingField.value=e,A))}}}},function(A,e,t){const{inlineSvgFonts:n}=t(31);A.exports=A=>{if("ImageVector"===A.assetType.name){const e=A.decodeText();if(e.match('font-family(?!="none")')){const A=n(e);return"data:image/svg+xml;utf8,".concat(encodeURIComponent(A))}}return A.encodeDataURI()}},function(A,e,t){const n=t(103),i=t(106);A.exports=class{constructor(A){this._canvas=A||document.createElement("canvas"),this._context=this._canvas.getContext("2d"),this._measurements={x:0,y:0,width:0,height:0},this._cachedImage=null,this.loaded=!1}get canvas(){return this._canvas}get size(){return[this._measurements.width,this._measurements.height]}get viewOffset(){return[this._measurements.x,this._measurements.y]}loadString(A,e){this._cachedImage=null;const t=n(A,e);this._svgTag=t,this._measurements={width:t.viewBox.baseVal.width,height:t.viewBox.baseVal.height,x:t.viewBox.baseVal.x,y:t.viewBox.baseVal.y}}loadSVG(A,e,t){this.loadString(A,e),this._createSVGImage(t)}_createSVGImage(A){null===this._cachedImage&&(this._cachedImage=new Image);const e=this._cachedImage;e.onload=()=>{this.loaded=!0,A&&A()};const t=this.toString(!0);e.src="data:image/svg+xml;utf8,".concat(encodeURIComponent(t)),this.loaded=!1}toString(A){return i(this._svgTag,A)}draw(A){if(!this.loaded)throw new Error("SVG image has not finished loading");this._drawFromImage(A)}_drawFromImage(A){if(null===this._cachedImage)return;const e=Number.isFinite(A)?A:1,t=this._measurements;this._canvas.width=t.width*e,this._canvas.height=t.height*e,this._canvas.width<=0||this._canvas.height<=0||this._cachedImage.naturalWidth<=0||this._cachedImage.naturalHeight<=0||(this._context.clearRect(0,0,this._canvas.width,this._canvas.height),this._context.setTransform(e,0,0,e,0,0),this._context.drawImage(this._cachedImage,0,0))}}},function(A,e,t){const n=t(414),i=t(70),r=t(415),o=function(A){return Math.round(1e4*A)/1e4},s=function(A){let e=n.identity();const t=A.attributes&&A.attributes.transform&&A.attributes.transform.value;if(!t)return e;const i=t.split(/\)\s*/g);for(const A of i){if(!A)break;const t=A.split(/\(\s*/),i=t[0].trim(),o=t[1].split(/[\s,]+/g);for(let A=0;A<o.length;A++)o[A]=parseFloat(o[A]);switch(i){case"matrix":e=n.compose(e,{a:o[0],b:o[1],c:o[2],d:o[3],e:o[4],f:o[5]});break;case"rotate":e=n.compose(e,n.rotateDEG(o[0],o[1]||0,o[2]||0));break;case"translate":e=n.compose(e,n.translate(o[0],o[1]||0));break;case"scale":e=n.compose(e,n.scale(o[0],o[1]||o[0]));break;case"skewX":e=n.compose(e,n.skewDEG(o[0],0));break;case"skewY":e=n.compose(e,n.skewDEG(0,o[0]));break;default:r.error("Couldn't parse: ".concat(i))}}return e},a=function(A){const e=A.a,t=A.b,n=A.c,i=A.d,r=e*i-t*n;if(0!==e||0!==t){const A=Math.sqrt(e*e+t*t);return{x:A,y:r/A}}if(0!==n||0!==i){const A=Math.sqrt(n*n+i*i);return{x:r/A,y:A}}return{x:0,y:0}},B=function(A,e,t,n){t=-t*Math.PI/180;const i=n.a,r=-n.c,o=-n.b,s=n.d,a=i*s-r*o;if(0===a)return null;const B=Math.sin(t),c=Math.cos(t),g=Math.sin(2*t),E=c*c/A/A+B*B/e/e,Q=g/A/A-g/e/e,u=B*B/A/A+c*c/e/e,l=E*s*s-Q*s*o+u*o*o,w=-2*E*r*s+Q*i*s+Q*r*o-2*u*i*o,h=E*r*r-Q*i*r+u*i*i,C=Math.sqrt(2)*Math.sqrt((l+h-Math.sqrt(l*l+w*w-2*l*h+h*h))/(-w*w+4*l*h)),I=1/Math.sqrt(l+h-1/C/C);let M=(l-1/C/C)/(1/I/I-1/C/C);M<0&&Math.abs(M)<1e-8&&(M=0),M=Math.sqrt(M),Math.abs(1-M)<1e-8&&(M=1);let d=Math.asin(M);M=w/(1/C/C-1/I/I);const m=-d;return Math.abs(Math.sin(2*m)-M)<Math.abs(Math.sin(2*d)-M)&&(d=m),{radiusX:C*a,radiusY:I*a,rotation:180*-d/Math.PI}},c=["circle","ellipse","image","line","path","polygon","polyline","rect","text","use"],g=["a","defs","g","marker","glyph","missing-glyph","pattern","svg","switch","symbol"],E=function(A,e){return Math.sqrt((A*A+e*e)/2)},Q=function(A,e,t,r){const s=function(A,e,n,r,o,s){let a,B=i.get(A,e);if(null===B?s?(a=s,/%\s*$/.test(a)&&(B=s,a=parseFloat(B))):a=r?null:n?"":0:a=n?B:parseFloat(B),/%\s*$/.test(B)){return a/100*(o?1:t[/x|^width/.test(e)?"width":"height"])}return a},B=function(A,e,t,n,i,r,o){return e=s(A,e||"x",!1,n,i,r),t=s(A,t||"y",!1,n,i,o),!n||null!==e&&null!==t?{x:e,y:t}:null};let c=e.getElementsByTagName("defs");0===c.length?(c=i.create("defs"),e.appendChild(c)):c=c[0];const g=e.getElementById(A);if(!g)return;const Q="radialgradient"===g.tagName.toLowerCase(),u=e.getElementById(A).cloneNode(!0);let l=n.toString(r);l=l.substring(8,l.length-1);const w="".concat(A,"-").concat(l);if(u.setAttribute("id",w),e.getElementById(w))return"url(#".concat(w,")");const h="userSpaceOnUse"!==s(u,"gradientUnits",!0);let C,I,M,d;if(Q)C=B(u,"cx","cy",!1,h,"50%","50%"),M=s(u,"r",!1,!1,h,"50%"),d=B(u,"fx","fy",!0,h);else if(C=B(u,"x1","y1",!1,h),I=B(u,"x2","y2",!1,h,"1"),C.x===I.x&&C.y===I.y){const A=u.getElementsByTagName("stop");return A.length&&A[A.length-1].attributes&&A[A.length-1].attributes["stop-color"]?A[A.length-1].attributes["stop-color"].value:null}if(h){const A=n.compose(n.translate(t.x,t.y),n.scale(t.width,t.height));C=n.applyToPoint(A,C),I&&(I=n.applyToPoint(A,I)),M&&(M=E(t.width,t.height)*M),d&&(d=n.applyToPoint(A,d))}if(Q){C=n.applyToPoint(r,C);const A=a(r);M=E(A.x,A.y)*M,d&&(d=n.applyToPoint(r,d))}else{const A=(A,e)=>A.x*e.x+A.y*e.y,e=(A,e)=>({x:A*e.x,y:A*e.y}),t=(A,e)=>({x:A.x+e.x,y:A.y+e.y}),i=(A,e)=>({x:A.x-e.x,y:A.y-e.y});let o=Math.abs(C.x-I.x)<1e-8?t(C,{x:1,y:(C.x-I.x)/(I.y-C.y)}):t(C,{x:(I.y-C.y)/(C.x-I.x),y:1});o=n.applyToPoint(r,o),C=n.applyToPoint(r,C),I=n.applyToPoint(r,I);const s=i(o,C),a=i(I,C),B=Math.abs(s.x)<1e-8?{x:1,y:-s.x/s.y}:{x:-s.y/s.x,y:1},c=e(A(a,B)/A(B,B),B);I={x:C.x+c.x,y:C.y+c.y}}return Q?(u.setAttribute("cx",o(C.x)),u.setAttribute("cy",o(C.y)),u.setAttribute("r",o(M)),d&&(u.setAttribute("fx",o(d.x)),u.setAttribute("fy",o(d.y)))):(u.setAttribute("x1",o(C.x)),u.setAttribute("y1",o(C.y)),u.setAttribute("x2",o(I.x)),u.setAttribute("y2",o(I.y))),u.setAttribute("gradientUnits","userSpaceOnUse"),c.appendChild(u),"url(#".concat(w,")")},u=(A,e)=>{const t=A&&A.match(/\((?:["'#]*)([^"')]+)/),n=t&&t[1];return n&&e?n.replace("".concat(e.location.href.split("#")[0],"#"),""):n},l=Object.create(null);let w=null,h=null,C=null;A.exports=function(A,e,t){const r=n.identity(),I=(r,M,d,m,p)=>{if(function(A){return A.tagName&&g.includes(A.tagName.toLowerCase())}(r)){r.attributes["stroke-width"]&&(d=r.attributes["stroke-width"].value),r.attributes&&(r.attributes.fill&&(m=r.attributes.fill.value),r.attributes.stroke&&(p=r.attributes.stroke.value));for(let A=0;A<r.childNodes.length;A++)I(r.childNodes[A],n.compose(M,s(r)),d,m,p);r.removeAttribute("transform"),r.removeAttribute("stroke-width"),r.removeAttribute("fill"),r.removeAttribute("stroke")}else if(function(A,e){return!!A.attributes&&((e=A.attributes["stroke-width"]?Number(A.attributes["stroke-width"].value):Number(e))&&A.tagName&&"path"===A.tagName.toLowerCase()&&A.attributes.d&&A.attributes.d.value)}(r,d)){if(r.attributes["stroke-width"]&&(d=r.attributes["stroke-width"].value),r.attributes.fill&&(m=r.attributes.fill.value),r.attributes.stroke&&(p=r.attributes.stroke.value),M=n.compose(M,s(r)),n.toString(M)===n.toString(n.identity()))return r.removeAttribute("transform"),r.setAttribute("stroke-width",d),m&&r.setAttribute("fill",m),void(p&&r.setAttribute("stroke",p));const c=u(m,e),g=u(p,e);if(c||g){const n=t||((A,e)=>{const t=A.attributes.d.value;if(Object.prototype.hasOwnProperty.call(l,t))return l[t];if(!w){const A=e.document;w=A.createElement("span"),h=A.createElementNS(i.svg,"svg"),C=A.createElementNS(i.svg,"path"),w.className="scratch-svg-renderer-bbox",w.style.visibility="hidden",w.style.position="absolute",w.style.top="-10000px",w.style.left="-10000px",w.ariaHidden=!0,h.appendChild(C),w.appendChild(h),document.body.appendChild(w)}C.setAttribute("d",t);const n=h.getBBox();return l[t]=n,n})(r,e);if(c){const e=Q(c,A,n,M);e&&(m=e)}if(g){const e=Q(g,A,n,M);e&&(p=e)}}r.setAttribute("d",function(A,e){if(!e||n.toString(e)===n.toString(n.identity()))return A;const t=A&&A.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/gi);let i,r,s,c=!1,g={x:0,y:0},E={x:0,y:0},Q="";const u=function(A,e){let t=+i[A];return c&&(t+=g[e]),t},l=function(A){return{x:u(A,"x"),y:u(A+1,"y")}},w=function(A){const t=n.applyToPoint(e,A);return"".concat(o(t.x)," ").concat(o(t.y)," ")};for(let A=0,n=t&&t.length;A<n;A++){const n=t[A],h=n[0],C=h.toLowerCase();i=n.match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g);const I=i&&i.length;switch(c=h===C,"z"!==r||/[mz]/.test(C)||(Q+="M ".concat(g.x," ").concat(g.y," ")),C){case"m":case"l":{let A="m"===C;for(let e=0;e<I;e+=2)Q+=A?"M ":"L ",g=l(e),Q+=w(g),A&&(E=g,A=!1);s=g;break}case"h":case"v":{const A="h"===C?"x":"y";g={x:g.x,y:g.y};for(let e=0;e<I;e++)g[A]=u(e,A),Q+="L ".concat(w(g));s=g;break}case"c":for(let A=0;A<I;A+=6){const e=l(A);s=l(A+2),g=l(A+4),Q+="C ".concat(w(e)).concat(w(s)).concat(w(g))}break;case"s":for(let A=0;A<I;A+=4){const e=/[cs]/.test(r)?{x:2*g.x-s.x,y:2*g.y-s.y}:g;s=l(A),g=l(A+2),Q+="C ".concat(w(e)).concat(w(s)).concat(w(g)),r=C}break;case"q":for(let A=0;A<I;A+=4)s=l(A),g=l(A+2),Q+="Q ".concat(w(s)).concat(w(g));break;case"t":for(let A=0;A<I;A+=2)s=/[qt]/.test(r)?{x:2*g.x-s.x,y:2*g.y-s.y}:g,g=l(A),Q+="Q ".concat(w(s)).concat(w(g)),r=C;break;case"a":for(let A=0;A<I;A+=7){g=l(A+5);const t=+i[A],n=+i[A+1],r=+i[A+2],s=+i[A+3];let c=+i[A+4];const E=B(t,n,r,e),u=a(e);E?((u.x>0&&u.y<0||u.x<0&&u.y>0)&&(c^=1),Q+="A ".concat(o(Math.abs(E.radiusX))," ")+"".concat(o(Math.abs(E.radiusY))," ")+"".concat(o(E.rotation)," ").concat(s," ")+"".concat(c," ").concat(w(g))):Q+="L ".concat(w(g))}break;case"z":Q+="Z ",g=E}r=C}return Q}(r.attributes.d.value,M)),r.removeAttribute("transform");const I=a(M);r.setAttribute("stroke-width",E(I.x,I.y)*d),m&&r.setAttribute("fill",m),p&&r.setAttribute("stroke",p)}else(function(A){return A.tagName&&c.includes(A.tagName.toLowerCase())})(r)&&(d&&!r.attributes["stroke-width"]&&r.setAttribute("stroke-width",d),m&&!r.attributes.fill&&r.setAttribute("fill",m),p&&!r.attributes.stroke&&r.setAttribute("stroke",p),M=n.compose(M,s(r)),n.toString(M)===n.toString(n.identity())?r.removeAttribute("transform"):r.setAttribute("transform",n.toString(M)))};I(A,r,1)}},function(A,e,t){window,A.exports=function(A){var e={};function t(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return A[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}return t.m=A,t.c=e,t.d=function(A,e,n){t.o(A,e)||Object.defineProperty(A,e,{enumerable:!0,get:n})},t.r=function(A){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(A,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(A,"__esModule",{value:!0})},t.t=function(A,e){if(1&e&&(A=t(A)),8&e)return A;if(4&e&&"object"==typeof A&&A&&A.__esModule)return A;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:A}),2&e&&"string"!=typeof A)for(var i in A)t.d(n,i,function(e){return A[e]}.bind(null,i));return n},t.n=function(A){var e=A&&A.__esModule?function(){return A.default}:function(){return A};return t.d(e,"a",e),e},t.o=function(A,e){return Object.prototype.hasOwnProperty.call(A,e)},t.p="",t(t.s=0)}([function(A,e,t){"use strict";function n(A,e){return Array.isArray(e)?[A.a*e[0]+A.c*e[1]+A.e,A.b*e[0]+A.d*e[1]+A.f]:{x:A.a*e.x+A.c*e.y+A.e,y:A.b*e.x+A.d*e.y+A.f}}function i(A,e){return e.map((function(e){return n(A,e)}))}function r(A){return{a:parseFloat(A.a),b:parseFloat(A.b),c:parseFloat(A.c),d:parseFloat(A.d),e:parseFloat(A.e),f:parseFloat(A.f)}}t.r(e);var o=/^matrix\(\s*([0-9_+-.e]+)\s*,\s*([0-9_+-.e]+)\s*,\s*([0-9_+-.e]+)\s*,\s*([0-9_+-.e]+)\s*,\s*([0-9_+-.e]+)\s*,\s*([0-9_+-.e]+)\s*\)$/i;function s(A){var e=A.match(o);if(null===e||e.length<7)throw new Error("'"+A+"' is not a matrix");return{a:parseFloat(e[1]),b:parseFloat(e[2]),c:parseFloat(e[3]),d:parseFloat(e[4]),e:parseFloat(e[5]),f:parseFloat(e[6])}}function a(){return{a:1,c:0,e:0,b:0,d:1,f:0}}function B(A){var e=A.a,t=A.b,n=A.c,i=A.d,r=A.e,o=A.f,s=e*i-t*n;return{a:i/s,b:t/-s,c:n/-s,d:e/s,e:(i*r-n*o)/-s,f:(t*r-e*o)/s}}var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(A){return typeof A}:function(A){return A&&"function"==typeof Symbol&&A.constructor===Symbol&&A!==Symbol.prototype?"symbol":typeof A},g=function(A){return"number"==typeof A&&!isNaN(A)&&isFinite(A)};function E(A){return function(A){return null!=A&&"object"===(void 0===A?"undefined":c(A))}(A)&&A.hasOwnProperty("a")&&g(A.a)&&A.hasOwnProperty("b")&&g(A.b)&&A.hasOwnProperty("c")&&g(A.c)&&A.hasOwnProperty("d")&&g(A.d)&&A.hasOwnProperty("e")&&g(A.e)&&A.hasOwnProperty("f")&&g(A.f)}function Q(A){return void 0===A}function u(A){return{a:1,c:0,e:A,b:0,d:1,f:arguments.length>1&&void 0!==arguments[1]?arguments[1]:0}}function l(){for(var A=arguments.length,e=Array(A),t=0;t<A;t++)e[t]=arguments[t];var n=function(A,e){return{a:A.a*e.a+A.c*e.b,c:A.a*e.c+A.c*e.d,e:A.a*e.e+A.c*e.f+A.e,b:A.b*e.a+A.d*e.b,d:A.b*e.c+A.d*e.d,f:A.b*e.e+A.d*e.f+A.f}};switch((e=Array.isArray(e[0])?e[0]:e).length){case 0:throw new Error("no matrices provided");case 1:return e[0];case 2:return n(e[0],e[1]);default:var i=function(A){return Array.isArray(A)?A:Array.from(A)}(e),r=i[0],o=i[1],s=i.slice(2),a=n(r,o);return l.apply(void 0,[a].concat(function(A){if(Array.isArray(A)){for(var e=0,t=Array(A.length);e<A.length;e++)t[e]=A[e];return t}return Array.from(A)}(s)))}}function w(){return l.apply(void 0,arguments)}var h=Math.cos,C=Math.sin,I=Math.PI;function M(A,e,t){var n=h(A),i=C(A),r={a:n,c:-i,e:0,b:i,d:n,f:0};return Q(e)||Q(t)?r:l([u(e,t),r,u(-e,-t)])}function d(A){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return M(A*I/180,e,t)}function m(A){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return Q(e)&&(e=A),{a:A,c:0,e:0,b:0,d:e,f:0}}function p(A,e){return{a:1,c:A,e:0,b:e,d:1,f:0}}var F=Math.tan;function D(A,e){return{a:1,c:F(A),e:0,b:F(e),d:1,f:0}}function Y(A,e){return D(A*Math.PI/180,e*Math.PI/180)}function f(A){return U(A)}function N(A){return U(A)}function U(A){return"matrix("+A.a+","+A.b+","+A.c+","+A.d+","+A.e+","+A.f+")"}t.d(e,"applyToPoint",(function(){return n})),t.d(e,"applyToPoints",(function(){return i})),t.d(e,"fromObject",(function(){return r})),t.d(e,"fromString",(function(){return s})),t.d(e,"identity",(function(){return a})),t.d(e,"inverse",(function(){return B})),t.d(e,"isAffineMatrix",(function(){return E})),t.d(e,"rotate",(function(){return M})),t.d(e,"rotateDEG",(function(){return d})),t.d(e,"scale",(function(){return m})),t.d(e,"shear",(function(){return p})),t.d(e,"skew",(function(){return D})),t.d(e,"skewDEG",(function(){return Y})),t.d(e,"toCSS",(function(){return f})),t.d(e,"toSVG",(function(){return N})),t.d(e,"toString",(function(){return U})),t.d(e,"transform",(function(){return l})),t.d(e,"compose",(function(){return w})),t.d(e,"translate",(function(){return u}))}])},function(A,e,t){const n=t(416);n.enable(),A.exports=n("scratch-svg-render")},function(A,e){const t="undefined"==typeof document,n=t?"[0m":"",i=t?"[90m":"",r=t?"[36m":"",o=t?"[33m":"",s=t?"[31m":"",a="".concat(t?"[34m":"","debug").concat(n),B="".concat(r,"info").concat(n),c="".concat(o,"warn").concat(n),g="".concat(s,"error").concat(n),E=function(){let A=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const e=e=>E(A?"".concat(A," ").concat(e):e),t=A?["".concat(i).concat(A).concat(n)]:[];return e.debug=e.log=console.debug.bind(console,...t,a),e.info=console.log.bind(console,...t,B),e.warn=e.warning=console.warn.bind(console,...t,c),e.error=console.error.bind(console,...t,g),e};E.enable=E.disable=()=>{},A.exports=E},function(A,e){let t=null;A.exports=()=>(t||(t=document.createElement("iframe"),t.className="scratch-svg-renderer-sandbox",t.sandbox="allow-same-origin",t.style.position="absolute",t.style.top="-10000px",t.style.left="-10000px",t.style.width="0",t.style.height="0",t.style.opacity="0",t.style.visibility="hidden",t.style.pointerEvents="none",t.tabIndex=-1,t.ariaHidden=!0,document.body.appendChild(t),t.contentDocument.open(),t.contentDocument.write('\n        <!DOCTYPE html>\n        <html>\n            <head>\n                <meta charset="utf-8">\n                <meta http-equiv="Content-Security-Policy" content="default-src \'none\'; style-src \'unsafe-inline\' data:; font-src data:; img-src data:">\n            </head>\n            <body></body>\n        </html>\n        '),t.contentDocument.close()),t.contentDocument.body)},function(A,e,t){let n;A.exports=function(){if(n)return n;n={"Sans Serif":t(419),Serif:t(420),Handwriting:t(421),Marker:t(422),Curly:t(423),Pixel:t(424),Scratch:t(425),Technological:t(426),Bubbly:t(427),"Bits and Bytes":t(428),Playful:t(429),Arcade:t(430),Archivo:t(431),"Archivo Black":t(432)};for(const A in n){const e=n[A];n[A]="@font-face {"+'font-family: "'.concat(A,'";src: url("data:application/x-font-ttf;charset=utf-8;base64,').concat(e,'");}')}if(!document.getElementById("scratch-font-styles")){const A=document.createElement("style");A.id="scratch-font-styles";for(const e in n)A.textContent+=n[e];document.body.insertBefore(A,document.body.firstChild)}return n}},function(A,e){A},function(A,e){},function(A,e){},function(A,e){},function(A,e){},function(A,e){},function(A,e){},function(A,e){},function(A,e){},function(A,e){},function(A,e){},function(A,e){},function(A,e){},function(A,e){},function(A,e,t){const n=t(434);A.exports=class{constructor(A,e){this._makeImage=A||(()=>new Image),this._makeCanvas=e||(()=>document.createElement("canvas")),this.stageWidth=480,this.stageHeight=360}setStageSize(A,e){this.stageWidth=A,this.stageHeight=e}resize(A,e,t){const n=this._makeCanvas();n.width=e,n.height=A.height;let i=n.getContext("2d");i.imageSmoothingEnabled=!1,i.drawImage(A,0,0,n.width,n.height);const r=this._makeCanvas();return r.width=e,r.height=t,i=r.getContext("2d"),i.imageSmoothingEnabled=!1,i.drawImage(n,0,0,r.width,r.height),r}convertResolution1Bitmap(A,e){const t=this._makeImage();t.src=A,t.onload=()=>{e(null,this.resize(t,2*t.width,2*t.height).toDataURL())},t.onerror=()=>{e("Image load failed")}}getResizedWidthHeight(A,e){const t=this.stageWidth,n=this.stageHeight;if(A<=t&&e<=n)return{width:2*A,height:2*e};if(A<=2*t&&e<=2*n)return{width:A,height:e};const i=A/e;return i>=t/n?{width:2*t,height:2*t/i}:{width:2*n*i,height:2*n}}importBitmap(A,e){let t=A;return A instanceof ArrayBuffer&&(t=this.convertBinaryToDataURI(A,e)),new Promise((A,e)=>{const n=this._makeImage();n.src=t,n.onload=()=>{const e=this.getResizedWidthHeight(n.width,n.height),t=this.resize(n,e.width,e.height).toDataURL();A(this.convertDataURIToBinary(t))},n.onerror=()=>{e("Image load failed")}})}convertDataURIToBinary(A){const e=A.indexOf(";base64,")+";base64,".length,t=A.substring(e),n=window.atob(t),i=n.length,r=new Uint8Array(new ArrayBuffer(i));for(let A=0;A<i;A++)r[A]=n.charCodeAt(A);return r}convertBinaryToDataURI(A,e){return"data:".concat(e,";base64,").concat(n.fromByteArray(new Uint8Array(A)))}}},function(A,e,t){"use strict";e.byteLength=function(A){return 3*A.length/4-B(A)},e.toByteArray=function(A){var e,t,n,o,s,a=A.length;o=B(A),s=new r(3*a/4-o),t=o>0?a-4:a;var c=0;for(e=0;e<t;e+=4)n=i[A.charCodeAt(e)]<<18|i[A.charCodeAt(e+1)]<<12|i[A.charCodeAt(e+2)]<<6|i[A.charCodeAt(e+3)],s[c++]=n>>16&255,s[c++]=n>>8&255,s[c++]=255&n;2===o?(n=i[A.charCodeAt(e)]<<2|i[A.charCodeAt(e+1)]>>4,s[c++]=255&n):1===o&&(n=i[A.charCodeAt(e)]<<10|i[A.charCodeAt(e+1)]<<4|i[A.charCodeAt(e+2)]>>2,s[c++]=n>>8&255,s[c++]=255&n);return s},e.fromByteArray=function(A){for(var e,t=A.length,i=t%3,r="",o=[],s=0,a=t-i;s<a;s+=16383)o.push(c(A,s,s+16383>a?a:s+16383));1===i?(e=A[t-1],r+=n[e>>2],r+=n[e<<4&63],r+="=="):2===i&&(e=(A[t-2]<<8)+A[t-1],r+=n[e>>10],r+=n[e>>4&63],r+=n[e<<2&63],r+="=");return o.push(r),o.join("")};for(var n=[],i=[],r="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,a=o.length;s<a;++s)n[s]=o[s],i[o.charCodeAt(s)]=s;function B(A){var e=A.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===A[e-2]?2:"="===A[e-1]?1:0}function c(A,e,t){for(var i,r,o=[],s=e;s<t;s+=3)i=(A[s]<<16)+(A[s+1]<<8)+A[s+2],o.push(n[(r=i)>>18&63]+n[r>>12&63]+n[r>>6&63]+n[63&r]);return o.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(A,e,t){const n=t(105),i=t(69),r={sanitizeByteStream:function(A){const e=new TextDecoder,t=new TextEncoder,n=r.sanitizeSvgText(e.decode(A));return t.encode(n)}},o="<!".concat("-".repeat(2)),s="".concat("-".repeat(2),">"),a=new RegExp("".concat(o,"rotationCenter:(-?[\\d\\.]+):(-?[\\d\\.]+)").concat(s,"$"));r.sanitizeSvgText=function(A){let e=i.sanitize(A,{USE_PROFILES:{svg:!0}});e.indexOf("]&gt;")>=0&&(e=e.substring(5,e.length)),e=n(e);const t=A.match(a);return t&&(e+=t[0]),e},A.exports=r},function(A,e){A.exports=A=>{const e=(new TextDecoder).decode(A),t=(new DOMParser).parseFromString(e,"image/svg+xml"),n=t.documentElement;let i=!1;if(i=(A=>"100%"===A.getAttribute("width")&&"100%"===A.getAttribute("height")&&(A.removeAttribute("width"),A.removeAttribute("height"),!0))(n)||i,i=(A=>{let e=!1;const t=A=>{"rect"===A.tagName&&(A.hasAttribute("rx")&&!A.hasAttribute("ry")?(e=!0,A.setAttribute("ry",A.getAttribute("rx"))):A.hasAttribute("ry")&&!A.hasAttribute("rx")&&(e=!0,A.setAttribute("rx",A.getAttribute("ry"))));const n=A.childNodes;if(n)for(let A=0;A<n.length;A++)t(n[A])};return t(A),e})(n)||i,i){const A=(new XMLSerializer).serializeToString(t);return(new TextEncoder).encode(A)}return A}},function(A,e){const t=function(A,e,t){const n=t?[A.getTargetById(t)]:A.targets,i=[];for(let A=0;A<n.length;A++){const t=n[A].sprite[e];for(let A=0;A<t.length;A++){const e=t[A],n=e.broken?e.broken.asset:e.asset;n&&i.push({fileName:"".concat(n.assetId,".").concat(n.dataFormat),fileContent:n.data})}}return i};A.exports={serializeSounds:function(A,e){return t(A,"sounds",e)},serializeCostumes:function(A,e){return t(A,"costumes",e)}}},function(A,e){
/*! @source http://purl.eligrey.com/github/canvas-toBlob.js/blob/master/canvas-toBlob.js */
!function(A){"use strict";var e,t=A.Uint8Array,n=A.HTMLCanvasElement,i=n&&n.prototype,r=/\s*;\s*base64\s*(?:;|$)/i,o="toDataURL",s=function(A){for(var n,i,r=A.length,o=new t(r/4*3|0),s=0,a=0,B=[0,0],c=0,g=0;r--;)i=A.charCodeAt(s++),255!==(n=e[i-43])&&void 0!==n&&(B[1]=B[0],B[0]=i,g=g<<6|n,4===++c&&(o[a++]=g>>>16,61!==B[1]&&(o[a++]=g>>>8),61!==B[0]&&(o[a++]=g),c=0));return o};t&&(e=new t([62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,0,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51])),!n||i.toBlob&&i.toBlobHD||(i.toBlob||(i.toBlob=function(A,e){if(e||(e="image/png"),this.mozGetAsFile)A(this.mozGetAsFile("canvas",e));else if(this.msToBlob&&/^\s*image\/png\s*(?:$|;)/i.test(e))A(this.msToBlob());else{var n,i=Array.prototype.slice.call(arguments,1),a=this[o].apply(this,i),B=a.indexOf(","),c=a.substring(B+1),g=r.test(a.substring(0,B));Blob.fake?((n=new Blob).encoding=g?"base64":"URI",n.data=c,n.size=c.length):t&&(n=g?new Blob([s(c)],{type:e}):new Blob([decodeURIComponent(c)],{type:e})),A(n)}}),!i.toBlobHD&&i.toDataURLHD?i.toBlobHD=function(){o="toDataURLHD";var A=this.toBlob();return o="toDataURL",A}:i.toBlobHD=i.toBlob)}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content||this)},function(module,exports){var indexOf=function(A,e){if(A.indexOf)return A.indexOf(e);for(var t=0;t<A.length;t++)if(A[t]===e)return t;return-1},Object_keys=function(A){if(Object.keys)return Object.keys(A);var e=[];for(var t in A)e.push(t);return e},forEach=function(A,e){if(A.forEach)return A.forEach(e);for(var t=0;t<A.length;t++)e(A[t],t,A)},defineProp=function(){try{return Object.defineProperty({},"_",{}),function(A,e,t){Object.defineProperty(A,e,{writable:!0,enumerable:!1,configurable:!0,value:t})}}catch(A){return function(A,e,t){A[e]=t}}}(),globals=["Array","Boolean","Date","Error","EvalError","Function","Infinity","JSON","Math","NaN","Number","Object","RangeError","ReferenceError","RegExp","String","SyntaxError","TypeError","URIError","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","eval","isFinite","isNaN","parseFloat","parseInt","undefined","unescape"];function Context(){}Context.prototype={};var Script=exports.Script=function(A){if(!(this instanceof Script))return new Script(A);this.code=A};Script.prototype.runInContext=function(A){if(!(A instanceof Context))throw new TypeError("needs a 'context' argument.");var e=document.createElement("iframe");e.style||(e.style={}),e.style.display="none",document.body.appendChild(e);var t=e.contentWindow,n=t.eval,i=t.execScript;!n&&i&&(i.call(t,"null"),n=t.eval),forEach(Object_keys(A),(function(e){t[e]=A[e]})),forEach(globals,(function(e){A[e]&&(t[e]=A[e])}));var r=Object_keys(t),o=n.call(t,this.code);return forEach(Object_keys(t),(function(e){(e in A||-1===indexOf(r,e))&&(A[e]=t[e])})),forEach(globals,(function(e){e in A||defineProp(A,e,t[e])})),document.body.removeChild(e),o},Script.prototype.runInThisContext=function(){return eval(this.code)},Script.prototype.runInNewContext=function(A){var e=Script.createContext(A),t=this.runInContext(e);return A&&forEach(Object_keys(e),(function(t){A[t]=e[t]})),t},forEach(Object_keys(Script.prototype),(function(A){exports[A]=Script[A]=function(e){var t=Script(e);return t[A].apply(t,[].slice.call(arguments,1))}})),exports.isContext=function(A){return A instanceof Context},exports.createScript=function(A){return exports.Script(A)},exports.createContext=Script.createContext=function(A){var e=new Context;return"object"==typeof A&&forEach(Object_keys(A),(function(t){e[t]=A[t]})),e}},function(A,e){(function(e){A.exports=e}).call(this,{})},function(A,e){const t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!#%()*+,-./:;=?@[]^_`{|}~",n=A=>{let e="";for(;A>=0;)e=t[A%t.length]+e,A=Math.floor(A/t.length)-1;return e};class i{constructor(){this.generatedIds=new Map,this.references=new Map,this.skippedIds=new Set,this.skippedIds.add("of")}skip(A){this.skippedIds.add(A)}addReference(A){const e=this.references.get(A)||0;this.references.set(A,e+1)}generateNewIds(){const A=Array.from(this.references.entries());A.sort((A,e)=>e[1]-A[1]);let e=0;for(const t of A){const A=t[0];let i=n(e);for(;this.skippedIds.has(i);)e++,i=n(e);this.generatedIds.set(A,i),e++}}getNewId(A){return this.generatedIds.has(A)?this.generatedIds.get(A):A}}A.exports=A=>{const e=new i;for(const t of A.targets){for(const A of Object.keys(t.variables))e.skip(A);for(const A of Object.keys(t.lists))e.skip(A);for(const A of Object.keys(t.broadcasts))e.skip(A);for(const A of Object.keys(t.blocks)){const n=t.blocks[A];if(e.addReference(A),!Array.isArray(n)){n.parent&&e.addReference(n.parent),n.next&&e.addReference(n.next),n.comment&&e.addReference(n.comment);for(const A of Object.values(n.inputs))for(let t=1;t<A.length;t++){const n=A[t];"string"==typeof n&&e.addReference(n)}}}for(const A of Object.keys(t.comments)){const n=t.comments[A];e.addReference(A),n.blockId&&e.addReference(n.blockId)}}e.generateNewIds();for(const t of A.targets){const A={},n={};for(const n of Object.keys(t.blocks)){const i=t.blocks[n];if(A[e.getNewId(n)]=i,!Array.isArray(i)){i.parent&&(i.parent=e.getNewId(i.parent)),i.next&&(i.next=e.getNewId(i.next)),i.comment&&(i.comment=e.getNewId(i.comment));for(const A of Object.values(i.inputs))for(let t=1;t<A.length;t++){const n=A[t];"string"==typeof n&&(A[t]=e.getNewId(n))}}}for(const A of Object.keys(t.comments)){const i=t.comments[A];n[e.getNewId(A)]=i,i.blockId&&(i.blockId=e.getNewId(i.blockId))}t.blocks=A,t.comments=n}}},function(A,e){A.exports=class{constructor(A){this.runtime=A,this.extensions={},this.loaded=[]}basicPatch(A,e,t){t.extensionURLs.set(A,e)}runExtensionPatch(A,e,t){const n=this.extensions[A];if("object"==typeof n)return this.loaded.includes(A)||(this.runtime.extensionManager.loadExtensionURL(n.url),this.loaded.push(A)),void this.basicPatch(n.id,n.url,e);n(e,t,this.runtime)}registerExtensions(A){this.extensions=Object.assign(this.extensions,A)}patchExists(A){return!!this.extensions[A]}}},function(A){A.exports=JSON.parse('{"variables":{"_text":["_text",""],"_replacers":["_replacers","[]"],"_replacer":["_replacer",1],"_rep":["_rep",""]},"blocks":{"setReplacerToDefinition":{"opcode":"procedures_definition","next":"setReplacersVarToReplacerJson","parent":null,"inputs":{"custom_block":[1,"setReplacerToDisplay"]},"fields":{},"shadow":false,"topLevel":true,"x":48,"y":64},"setReplacerToDisplay":{"opcode":"procedures_prototype","next":null,"parent":"setReplacerToDefinition","inputs":{"REPLACER":[1,"setReplacerArgumentREPLACER"],"VALUE":[1,"setReplacerArgumentVALUE"]},"fields":{},"shadow":true,"topLevel":false,"mutation":{"tagName":"mutation","children":[],"proccode":"replacer %s to %s","argumentids":"[\\"REPLACER\\",\\"VALUE\\"]","argumentnames":"[\\"REPLACER\\",\\"VALUE\\"]","argumentdefaults":"[\\"\\",\\"\\",\\"\\"]","warp":"true","returns":"false","edited":"true"}},"setReplacerArgumentREPLACER":{"opcode":"argument_reporter_string_number","next":null,"parent":"REPLACER","inputs":{},"fields":{"VALUE":["REPLACER","REPLACER"]},"shadow":true,"topLevel":false},"setReplacerArgumentVALUE":{"opcode":"argument_reporter_string_number","next":null,"parent":"VALUE","inputs":{},"fields":{"VALUE":["VALUE","VALUE"]},"shadow":true,"topLevel":false},"setReplacersVarToReplacerJson":{"opcode":"data_setvariableto","next":null,"parent":"setReplacerToDefinition","inputs":{"VALUE":[3,"setReplacerValueTo",[10,"0"]]},"fields":{"VARIABLE":["replacers","replacers"]},"shadow":false,"topLevel":false},"setReplacerValueTo":{"opcode":"jgJSON_setValueToKeyInJSON","next":null,"parent":"setReplacersVarToReplacerJson","inputs":{"KEY":[3,"leftAndMidleHalf",[10,"key"]],"VALUE":[3,"VALUE",[10,"value"]],"JSON":[3,[12,"replacers","replacers"],[10,"{}"]]},"fields":{},"shadow":false,"topLevel":false},"REPLACER":{"opcode":"argument_reporter_string_number","next":null,"parent":"rightHalf","inputs":{},"fields":{"VALUE":["REPLACER","REPLACER"]},"shadow":false,"topLevel":false},"VALUE":{"opcode":"argument_reporter_string_number","next":null,"parent":"setReplacerValueTo","inputs":{},"fields":{"VALUE":["VALUE","VALUE"]},"shadow":false,"topLevel":false},"replaceWithReplacersDefinition":{"opcode":"procedures_definition_return","next":"defineTempReplacersList","parent":null,"inputs":{"custom_block":[1,"replaceWithReplacersDisplay"]},"fields":{},"shadow":false,"topLevel":true,"x":48,"y":280},"replaceWithReplacersDisplay":{"opcode":"procedures_prototype","next":null,"parent":"replaceWithReplacersDefinition","inputs":{"STRING":[1,"STRING"]},"fields":{},"shadow":true,"topLevel":false,"mutation":{"tagName":"mutation","children":[],"proccode":"replace %s with replacers","argumentids":"[\\"STRING\\"]","argumentnames":"[\\"STRING\\"]","argumentdefaults":"[\\"\\"]","warp":"false","returns":"true","edited":"true"}},"STRING":{"opcode":"argument_reporter_string_number","next":null,"parent":"replaceWithReplacersDisplay","inputs":{},"fields":{"VALUE":["STRING","STRING"]},"shadow":true,"topLevel":false},"runThroughEachReplacer":{"opcode":"control_for_each","next":"returnTheFinnalText","parent":"defineTempText","inputs":{"VALUE":[3,"theNumberOfReplacers",[6,"10"]],"SUBSTACK":[2,"defineTempReplacerName"]},"fields":{"VARIABLE":["_replacer","_replacer"]},"shadow":false,"topLevel":false},"defineTempReplacersList":{"opcode":"data_setvariableto","next":"defineTempText","parent":"replaceWithReplacersDefinition","inputs":{"VALUE":[3,"getAllReplacers",[10,"0"]]},"fields":{"VARIABLE":["_replacers","_replacers"]},"shadow":false,"topLevel":false},"getAllReplacers":{"opcode":"jgJSON_json_keys","next":null,"parent":"defineTempReplacersList","inputs":{"json":[3,[12,"replacers","replacers"],[10,"{}"]]},"fields":{},"shadow":false,"topLevel":false},"rightHalf":{"opcode":"operator_join","next":null,"parent":"leftAndMidleHalf","inputs":{"STRING1":[1,[10,"{"]],"STRING2":[3,"REPLACER",[10,"banana"]]},"fields":{},"shadow":false,"topLevel":false},"leftAndMidleHalf":{"opcode":"operator_join","next":null,"parent":"setReplacerValueTo","inputs":{"STRING1":[3,"rightHalf",[10,"foo"]],"STRING2":[1,[10,"}"]]},"fields":{},"shadow":false,"topLevel":false},"theNumberOfReplacers":{"opcode":"jgJSON_json_array_length","next":null,"parent":"runThroughEachReplacer","inputs":{"array":[3,[12,"_replacers","_replacers"],[10,"[]"]]},"fields":{},"shadow":false,"topLevel":false},"getCurrentReplacer":{"opcode":"jgJSON_json_array_get","next":null,"parent":"defineTempReplacerName","inputs":{"array":[3,[12,"_replacers","_replacers"],[10,"[\\"A\\", \\"B\\", \\"C\\"]"]],"index":[3,"offsetIndexBy",[4,"2"]]},"fields":{},"shadow":false,"topLevel":false},"replaceAllReplacersWithValue":{"opcode":"operator_replaceAll","next":null,"parent":"replaceTextWithThisReplacer","inputs":{"text":[3,[12,"_text","_text"],[10,"foo bar"]],"term":[3,[12,"_rep","_rep"],[10,"foo"]],"res":[3,"getReplacerValueFromReplacerList",[10,"bar"]]},"fields":{},"shadow":false,"topLevel":false},"defineTempReplacerName":{"opcode":"data_setvariableto","next":"replaceTextWithThisReplacer","parent":"runThroughEachReplacer","inputs":{"VALUE":[3,"getCurrentReplacer",[10,"0"]]},"fields":{"VARIABLE":["_rep","_rep"]},"shadow":false,"topLevel":false},"getReplacerValueFromReplacerList":{"opcode":"jgJSON_getValueFromJSON","next":null,"parent":"replaceAllReplacersWithValue","inputs":{"VALUE":[3,[12,"_rep","_rep"],[10,"key"]],"JSON":[3,[12,"replacers","replacers"],[10,"{\\"key\\": \\"value\\"}"]]},"fields":{},"shadow":false,"topLevel":false},"defineTempText":{"opcode":"data_setvariableto","next":"runThroughEachReplacer","parent":"defineTempReplacersList","inputs":{"VALUE":[3,"STRINGargument",[10,"0"]]},"fields":{"VARIABLE":["_text","_text"]},"shadow":false,"topLevel":false},"STRINGargument":{"opcode":"argument_reporter_string_number","next":null,"parent":"defineTempText","inputs":{},"fields":{"VALUE":["STRING","STRING"]},"shadow":false,"topLevel":false},"replaceTextWithThisReplacer":{"opcode":"data_setvariableto","next":null,"parent":"defineTempReplacerName","inputs":{"VALUE":[3,"replaceAllReplacersWithValue",[10,"0"]]},"fields":{"VARIABLE":["_text","_text"]},"shadow":false,"topLevel":false},"returnTheFinnalText":{"opcode":"procedures_return","next":null,"parent":"runThroughEachReplacer","inputs":{"return":[3,[12,"_text","_text"],[10,"1"]]},"fields":{},"shadow":false,"topLevel":false},"offsetIndexBy":{"opcode":"operator_subtract","next":null,"parent":"getCurrentReplacer","inputs":{"NUM1":[3,[12,"_replacer","_replacer"],[4,""]],"NUM2":[1,[4,"1"]]},"fields":{},"shadow":false,"topLevel":false}}}')},function(A,e,t){const n=t(19),i={"forward:":{opcode:"motion_movesteps",argMap:[{type:"input",inputOp:"math_number",inputName:"STEPS"}]},"turnRight:":{opcode:"motion_turnright",argMap:[{type:"input",inputOp:"math_number",inputName:"DEGREES"}]},"turnLeft:":{opcode:"motion_turnleft",argMap:[{type:"input",inputOp:"math_number",inputName:"DEGREES"}]},"heading:":{opcode:"motion_pointindirection",argMap:[{type:"input",inputOp:"math_angle",inputName:"DIRECTION"}]},"pointTowards:":{opcode:"motion_pointtowards",argMap:[{type:"input",inputOp:"motion_pointtowards_menu",inputName:"TOWARDS"}]},"gotoX:y:":{opcode:"motion_gotoxy",argMap:[{type:"input",inputOp:"math_number",inputName:"X"},{type:"input",inputOp:"math_number",inputName:"Y"}]},"gotoSpriteOrMouse:":{opcode:"motion_goto",argMap:[{type:"input",inputOp:"motion_goto_menu",inputName:"TO"}]},"glideSecs:toX:y:elapsed:from:":{opcode:"motion_glidesecstoxy",argMap:[{type:"input",inputOp:"math_number",inputName:"SECS"},{type:"input",inputOp:"math_number",inputName:"X"},{type:"input",inputOp:"math_number",inputName:"Y"}]},"changeXposBy:":{opcode:"motion_changexby",argMap:[{type:"input",inputOp:"math_number",inputName:"DX"}]},"xpos:":{opcode:"motion_setx",argMap:[{type:"input",inputOp:"math_number",inputName:"X"}]},"changeYposBy:":{opcode:"motion_changeyby",argMap:[{type:"input",inputOp:"math_number",inputName:"DY"}]},"ypos:":{opcode:"motion_sety",argMap:[{type:"input",inputOp:"math_number",inputName:"Y"}]},bounceOffEdge:{opcode:"motion_ifonedgebounce",argMap:[]},setRotationStyle:{opcode:"motion_setrotationstyle",argMap:[{type:"field",fieldName:"STYLE"}]},xpos:{opcode:"motion_xposition",argMap:[]},ypos:{opcode:"motion_yposition",argMap:[]},heading:{opcode:"motion_direction",argMap:[]},scrollRight:{opcode:"motion_scroll_right",argMap:[{type:"input",inputOp:"math_number",inputName:"DISTANCE"}]},scrollUp:{opcode:"motion_scroll_up",argMap:[{type:"input",inputOp:"math_number",inputName:"DISTANCE"}]},scrollAlign:{opcode:"motion_align_scene",argMap:[{type:"field",fieldName:"ALIGNMENT"}]},xScroll:{opcode:"motion_xscroll",argMap:[]},yScroll:{opcode:"motion_yscroll",argMap:[]},"say:duration:elapsed:from:":{opcode:"looks_sayforsecs",argMap:[{type:"input",inputOp:"text",inputName:"MESSAGE"},{type:"input",inputOp:"math_number",inputName:"SECS"}]},"say:":{opcode:"looks_say",argMap:[{type:"input",inputOp:"text",inputName:"MESSAGE"}]},"think:duration:elapsed:from:":{opcode:"looks_thinkforsecs",argMap:[{type:"input",inputOp:"text",inputName:"MESSAGE"},{type:"input",inputOp:"math_number",inputName:"SECS"}]},"think:":{opcode:"looks_think",argMap:[{type:"input",inputOp:"text",inputName:"MESSAGE"}]},show:{opcode:"looks_show",argMap:[]},hide:{opcode:"looks_hide",argMap:[]},hideAll:{opcode:"looks_hideallsprites",argMap:[]},"lookLike:":{opcode:"looks_switchcostumeto",argMap:[{type:"input",inputOp:"looks_costume",inputName:"COSTUME"}]},nextCostume:{opcode:"looks_nextcostume",argMap:[]},startScene:{opcode:"looks_switchbackdropto",argMap:[{type:"input",inputOp:"looks_backdrops",inputName:"BACKDROP"}]},"changeGraphicEffect:by:":{opcode:"looks_changeeffectby",argMap:[{type:"field",fieldName:"EFFECT"},{type:"input",inputOp:"math_number",inputName:"CHANGE"}]},"setGraphicEffect:to:":{opcode:"looks_seteffectto",argMap:[{type:"field",fieldName:"EFFECT"},{type:"input",inputOp:"math_number",inputName:"VALUE"}]},filterReset:{opcode:"looks_cleargraphiceffects",argMap:[]},"changeSizeBy:":{opcode:"looks_changesizeby",argMap:[{type:"input",inputOp:"math_number",inputName:"CHANGE"}]},"setSizeTo:":{opcode:"looks_setsizeto",argMap:[{type:"input",inputOp:"math_number",inputName:"SIZE"}]},"changeStretchBy:":{opcode:"looks_changestretchby",argMap:[{type:"input",inputOp:"math_number",inputName:"CHANGE"}]},"setStretchTo:":{opcode:"looks_setstretchto",argMap:[{type:"input",inputOp:"math_number",inputName:"STRETCH"}]},comeToFront:{opcode:"looks_gotofrontback",argMap:[]},"goBackByLayers:":{opcode:"looks_goforwardbackwardlayers",argMap:[{type:"input",inputOp:"math_integer",inputName:"NUM"}]},costumeIndex:{opcode:"looks_costumenumbername",argMap:[]},costumeName:{opcode:"looks_costumenumbername",argMap:[]},sceneName:{opcode:"looks_backdropnumbername",argMap:[]},scale:{opcode:"looks_size",argMap:[]},startSceneAndWait:{opcode:"looks_switchbackdroptoandwait",argMap:[{type:"input",inputOp:"looks_backdrops",inputName:"BACKDROP"}]},nextScene:{opcode:"looks_nextbackdrop",argMap:[]},backgroundIndex:{opcode:"looks_backdropnumbername",argMap:[]},"playSound:":{opcode:"sound_play",argMap:[{type:"input",inputOp:"sound_sounds_menu",inputName:"SOUND_MENU"}]},doPlaySoundAndWait:{opcode:"sound_playuntildone",argMap:[{type:"input",inputOp:"sound_sounds_menu",inputName:"SOUND_MENU"}]},stopAllSounds:{opcode:"sound_stopallsounds",argMap:[]},playDrum:{opcode:"music_playDrumForBeats",argMap:[{type:"input",inputOp:"music_menu_DRUM",inputName:"DRUM"},{type:"input",inputOp:"math_number",inputName:"BEATS"}]},"drum:duration:elapsed:from:":{opcode:"music_midiPlayDrumForBeats",argMap:[{type:"input",inputOp:"math_number",inputName:"DRUM"},{type:"input",inputOp:"math_number",inputName:"BEATS"}]},"rest:elapsed:from:":{opcode:"music_restForBeats",argMap:[{type:"input",inputOp:"math_number",inputName:"BEATS"}]},"noteOn:duration:elapsed:from:":{opcode:"music_playNoteForBeats",argMap:[{type:"input",inputOp:"note",inputName:"NOTE"},{type:"input",inputOp:"math_number",inputName:"BEATS"}]},"instrument:":{opcode:"music_setInstrument",argMap:[{type:"input",inputOp:"music_menu_INSTRUMENT",inputName:"INSTRUMENT"}]},"midiInstrument:":{opcode:"music_midiSetInstrument",argMap:[{type:"input",inputOp:"math_number",inputName:"INSTRUMENT"}]},"changeVolumeBy:":{opcode:"sound_changevolumeby",argMap:[{type:"input",inputOp:"math_number",inputName:"VOLUME"}]},"setVolumeTo:":{opcode:"sound_setvolumeto",argMap:[{type:"input",inputOp:"math_number",inputName:"VOLUME"}]},volume:{opcode:"sound_volume",argMap:[]},"changeTempoBy:":{opcode:"music_changeTempo",argMap:[{type:"input",inputOp:"math_number",inputName:"TEMPO"}]},"setTempoTo:":{opcode:"music_setTempo",argMap:[{type:"input",inputOp:"math_number",inputName:"TEMPO"}]},tempo:{opcode:"music_getTempo",argMap:[]},clearPenTrails:{opcode:"pen_clear",argMap:[]},stampCostume:{opcode:"pen_stamp",argMap:[]},putPenDown:{opcode:"pen_penDown",argMap:[]},putPenUp:{opcode:"pen_penUp",argMap:[]},"penColor:":{opcode:"pen_setPenColorToColor",argMap:[{type:"input",inputOp:"colour_picker",inputName:"COLOR"}]},"changePenHueBy:":{opcode:"pen_changePenHueBy",argMap:[{type:"input",inputOp:"math_number",inputName:"HUE"}]},"setPenHueTo:":{opcode:"pen_setPenHueToNumber",argMap:[{type:"input",inputOp:"math_number",inputName:"HUE"}]},"changePenShadeBy:":{opcode:"pen_changePenShadeBy",argMap:[{type:"input",inputOp:"math_number",inputName:"SHADE"}]},"setPenShadeTo:":{opcode:"pen_setPenShadeToNumber",argMap:[{type:"input",inputOp:"math_number",inputName:"SHADE"}]},"changePenSizeBy:":{opcode:"pen_changePenSizeBy",argMap:[{type:"input",inputOp:"math_number",inputName:"SIZE"}]},"penSize:":{opcode:"pen_setPenSizeTo",argMap:[{type:"input",inputOp:"math_number",inputName:"SIZE"}]},senseVideoMotion:{opcode:"videoSensing_videoOn",argMap:[{type:"input",inputOp:"videoSensing_menu_ATTRIBUTE",inputName:"ATTRIBUTE"},{type:"input",inputOp:"videoSensing_menu_SUBJECT",inputName:"SUBJECT"}]},whenGreenFlag:{opcode:"event_whenflagclicked",argMap:[]},whenKeyPressed:{opcode:"event_whenkeypressed",argMap:[{type:"field",fieldName:"KEY_OPTION"}]},whenClicked:{opcode:"event_whenthisspriteclicked",argMap:[]},whenSceneStarts:{opcode:"event_whenbackdropswitchesto",argMap:[{type:"field",fieldName:"BACKDROP"}]},whenSensorGreaterThan:A=>{let[,e]=A;return"video motion"===e?{opcode:"videoSensing_whenMotionGreaterThan",argMap:[{},{type:"input",inputOp:"math_number",inputName:"REFERENCE"}]}:{opcode:"event_whengreaterthan",argMap:[{type:"field",fieldName:"WHENGREATERTHANMENU"},{type:"input",inputOp:"math_number",inputName:"VALUE"}]}},whenIReceive:{opcode:"event_whenbroadcastreceived",argMap:[{type:"field",fieldName:"BROADCAST_OPTION",variableType:n.BROADCAST_MESSAGE_TYPE}]},"broadcast:":{opcode:"event_broadcast",argMap:[{type:"input",inputOp:"event_broadcast_menu",inputName:"BROADCAST_INPUT",variableType:n.BROADCAST_MESSAGE_TYPE}]},doBroadcastAndWait:{opcode:"event_broadcastandwait",argMap:[{type:"input",inputOp:"event_broadcast_menu",inputName:"BROADCAST_INPUT",variableType:n.BROADCAST_MESSAGE_TYPE}]},"wait:elapsed:from:":{opcode:"control_wait",argMap:[{type:"input",inputOp:"math_positive_number",inputName:"DURATION"}]},doRepeat:{opcode:"control_repeat",argMap:[{type:"input",inputOp:"math_whole_number",inputName:"TIMES"},{type:"input",inputOp:"substack",inputName:"SUBSTACK"}]},doForever:{opcode:"control_forever",argMap:[{type:"input",inputOp:"substack",inputName:"SUBSTACK"}]},doIf:{opcode:"control_if",argMap:[{type:"input",inputOp:"boolean",inputName:"CONDITION"},{type:"input",inputOp:"substack",inputName:"SUBSTACK"}]},doIfElse:{opcode:"control_if_else",argMap:[{type:"input",inputOp:"boolean",inputName:"CONDITION"},{type:"input",inputOp:"substack",inputName:"SUBSTACK"},{type:"input",inputOp:"substack",inputName:"SUBSTACK2"}]},doWaitUntil:{opcode:"control_wait_until",argMap:[{type:"input",inputOp:"boolean",inputName:"CONDITION"}]},doUntil:{opcode:"control_repeat_until",argMap:[{type:"input",inputOp:"boolean",inputName:"CONDITION"},{type:"input",inputOp:"substack",inputName:"SUBSTACK"}]},doWhile:{opcode:"control_while",argMap:[{type:"input",inputOp:"boolean",inputName:"CONDITION"},{type:"input",inputOp:"substack",inputName:"SUBSTACK"}]},doForLoop:{opcode:"control_for_each",argMap:[{type:"field",fieldName:"VARIABLE"},{type:"input",inputOp:"text",inputName:"VALUE"},{type:"input",inputOp:"substack",inputName:"SUBSTACK"}]},stopScripts:{opcode:"control_stop",argMap:[{type:"field",fieldName:"STOP_OPTION"}]},whenCloned:{opcode:"control_start_as_clone",argMap:[]},createCloneOf:{opcode:"control_create_clone_of",argMap:[{type:"input",inputOp:"control_create_clone_of_menu",inputName:"CLONE_OPTION"}]},deleteClone:{opcode:"control_delete_this_clone",argMap:[]},COUNT:{opcode:"control_get_counter",argMap:[]},INCR_COUNT:{opcode:"control_incr_counter",argMap:[]},CLR_COUNT:{opcode:"control_clear_counter",argMap:[]},warpSpeed:{opcode:"control_all_at_once",argMap:[{type:"input",inputOp:"substack",inputName:"SUBSTACK"}]},"touching:":{opcode:"sensing_touchingobject",argMap:[{type:"input",inputOp:"sensing_touchingobjectmenu",inputName:"TOUCHINGOBJECTMENU"}]},"touchingColor:":{opcode:"sensing_touchingcolor",argMap:[{type:"input",inputOp:"colour_picker",inputName:"COLOR"}]},"color:sees:":{opcode:"sensing_coloristouchingcolor",argMap:[{type:"input",inputOp:"colour_picker",inputName:"COLOR"},{type:"input",inputOp:"colour_picker",inputName:"COLOR2"}]},"distanceTo:":{opcode:"sensing_distanceto",argMap:[{type:"input",inputOp:"sensing_distancetomenu",inputName:"DISTANCETOMENU"}]},doAsk:{opcode:"sensing_askandwait",argMap:[{type:"input",inputOp:"text",inputName:"QUESTION"}]},answer:{opcode:"sensing_answer",argMap:[]},"keyPressed:":{opcode:"sensing_keypressed",argMap:[{type:"input",inputOp:"sensing_keyoptions",inputName:"KEY_OPTION"}]},mousePressed:{opcode:"sensing_mousedown",argMap:[]},mouseX:{opcode:"sensing_mousex",argMap:[]},mouseY:{opcode:"sensing_mousey",argMap:[]},soundLevel:{opcode:"sensing_loudness",argMap:[]},isLoud:{opcode:"sensing_loud",argMap:[]},setVideoState:{opcode:"videoSensing_videoToggle",argMap:[{type:"input",inputOp:"videoSensing_menu_VIDEO_STATE",inputName:"VIDEO_STATE"}]},setVideoTransparency:{opcode:"videoSensing_setVideoTransparency",argMap:[{type:"input",inputOp:"math_number",inputName:"TRANSPARENCY"}]},timer:{opcode:"sensing_timer",argMap:[]},timerReset:{opcode:"sensing_resettimer",argMap:[]},"getAttribute:of:":{opcode:"sensing_of",argMap:[{type:"field",fieldName:"PROPERTY"},{type:"input",inputOp:"sensing_of_object_menu",inputName:"OBJECT"}]},timeAndDate:{opcode:"sensing_current",argMap:[{type:"field",fieldName:"CURRENTMENU"}]},timestamp:{opcode:"sensing_dayssince2000",argMap:[]},getUserName:{opcode:"sensing_username",argMap:[]},getUserId:{opcode:"sensing_userid",argMap:[]},"+":{opcode:"operator_add",argMap:[{type:"input",inputOp:"math_number",inputName:"NUM1"},{type:"input",inputOp:"math_number",inputName:"NUM2"}]},"-":{opcode:"operator_subtract",argMap:[{type:"input",inputOp:"math_number",inputName:"NUM1"},{type:"input",inputOp:"math_number",inputName:"NUM2"}]},"*":{opcode:"operator_multiply",argMap:[{type:"input",inputOp:"math_number",inputName:"NUM1"},{type:"input",inputOp:"math_number",inputName:"NUM2"}]},"/":{opcode:"operator_divide",argMap:[{type:"input",inputOp:"math_number",inputName:"NUM1"},{type:"input",inputOp:"math_number",inputName:"NUM2"}]},"randomFrom:to:":{opcode:"operator_random",argMap:[{type:"input",inputOp:"math_number",inputName:"FROM"},{type:"input",inputOp:"math_number",inputName:"TO"}]},"<":{opcode:"operator_lt",argMap:[{type:"input",inputOp:"text",inputName:"OPERAND1"},{type:"input",inputOp:"text",inputName:"OPERAND2"}]},"=":{opcode:"operator_equals",argMap:[{type:"input",inputOp:"text",inputName:"OPERAND1"},{type:"input",inputOp:"text",inputName:"OPERAND2"}]},">":{opcode:"operator_gt",argMap:[{type:"input",inputOp:"text",inputName:"OPERAND1"},{type:"input",inputOp:"text",inputName:"OPERAND2"}]},"&":{opcode:"operator_and",argMap:[{type:"input",inputOp:"boolean",inputName:"OPERAND1"},{type:"input",inputOp:"boolean",inputName:"OPERAND2"}]},"|":{opcode:"operator_or",argMap:[{type:"input",inputOp:"boolean",inputName:"OPERAND1"},{type:"input",inputOp:"boolean",inputName:"OPERAND2"}]},not:{opcode:"operator_not",argMap:[{type:"input",inputOp:"boolean",inputName:"OPERAND"}]},"concatenate:with:":{opcode:"operator_join",argMap:[{type:"input",inputOp:"text",inputName:"STRING1"},{type:"input",inputOp:"text",inputName:"STRING2"}]},"letter:of:":{opcode:"operator_letter_of",argMap:[{type:"input",inputOp:"math_whole_number",inputName:"LETTER"},{type:"input",inputOp:"text",inputName:"STRING"}]},"stringLength:":{opcode:"operator_length",argMap:[{type:"input",inputOp:"text",inputName:"STRING"}]},"%":{opcode:"operator_mod",argMap:[{type:"input",inputOp:"math_number",inputName:"NUM1"},{type:"input",inputOp:"math_number",inputName:"NUM2"}]},rounded:{opcode:"operator_round",argMap:[{type:"input",inputOp:"math_number",inputName:"NUM"}]},"computeFunction:of:":{opcode:"operator_mathop",argMap:[{type:"field",fieldName:"OPERATOR"},{type:"input",inputOp:"math_number",inputName:"NUM"}]},readVariable:{opcode:"data_variable",argMap:[{type:"field",fieldName:"VARIABLE",variableType:n.SCALAR_TYPE}]},"getVar:":{opcode:"data_variable",argMap:[{type:"field",fieldName:"VARIABLE",variableType:n.SCALAR_TYPE}]},"setVar:to:":{opcode:"data_setvariableto",argMap:[{type:"field",fieldName:"VARIABLE",variableType:n.SCALAR_TYPE},{type:"input",inputOp:"text",inputName:"VALUE"}]},"changeVar:by:":{opcode:"data_changevariableby",argMap:[{type:"field",fieldName:"VARIABLE",variableType:n.SCALAR_TYPE},{type:"input",inputOp:"math_number",inputName:"VALUE"}]},"showVariable:":{opcode:"data_showvariable",argMap:[{type:"field",fieldName:"VARIABLE",variableType:n.SCALAR_TYPE}]},"hideVariable:":{opcode:"data_hidevariable",argMap:[{type:"field",fieldName:"VARIABLE",variableType:n.SCALAR_TYPE}]},"contentsOfList:":{opcode:"data_listcontents",argMap:[{type:"field",fieldName:"LIST",variableType:n.LIST_TYPE}]},"append:toList:":{opcode:"data_addtolist",argMap:[{type:"input",inputOp:"text",inputName:"ITEM"},{type:"field",fieldName:"LIST",variableType:n.LIST_TYPE}]},"deleteLine:ofList:":{opcode:"data_deleteoflist",argMap:[{type:"input",inputOp:"math_integer",inputName:"INDEX"},{type:"field",fieldName:"LIST",variableType:n.LIST_TYPE}]},"insert:at:ofList:":{opcode:"data_insertatlist",argMap:[{type:"input",inputOp:"text",inputName:"ITEM"},{type:"input",inputOp:"math_integer",inputName:"INDEX"},{type:"field",fieldName:"LIST",variableType:n.LIST_TYPE}]},"setLine:ofList:to:":{opcode:"data_replaceitemoflist",argMap:[{type:"input",inputOp:"math_integer",inputName:"INDEX"},{type:"field",fieldName:"LIST",variableType:n.LIST_TYPE},{type:"input",inputOp:"text",inputName:"ITEM"}]},"getLine:ofList:":{opcode:"data_itemoflist",argMap:[{type:"input",inputOp:"math_integer",inputName:"INDEX"},{type:"field",fieldName:"LIST",variableType:n.LIST_TYPE}]},"lineCountOfList:":{opcode:"data_lengthoflist",argMap:[{type:"field",fieldName:"LIST",variableType:n.LIST_TYPE}]},"list:contains:":{opcode:"data_listcontainsitem",argMap:[{type:"field",fieldName:"LIST",variableType:n.LIST_TYPE},{type:"input",inputOp:"text",inputName:"ITEM"}]},"showList:":{opcode:"data_showlist",argMap:[{type:"field",fieldName:"LIST",variableType:n.LIST_TYPE}]},"hideList:":{opcode:"data_hidelist",argMap:[{type:"field",fieldName:"LIST",variableType:n.LIST_TYPE}]},procDef:{opcode:"procedures_definition",argMap:[]},getParam:{opcode:"argument_reporter_string_number",argMap:[{type:"field",fieldName:"VALUE"}]},call:{opcode:"procedures_call",argMap:[]}},r=function(A,e,t){i["".concat(A).concat("").concat(e)]=t,i["".concat(A,".").concat(e)]=t},o="LEGO WeDo 2.0";r(o,"motorOnFor",{opcode:"wedo2_motorOnFor",argMap:[{type:"input",inputOp:"wedo2_menu_MOTOR_ID",inputName:"MOTOR_ID"},{type:"input",inputOp:"math_number",inputName:"DURATION"}]}),r(o,"motorOn",{opcode:"wedo2_motorOn",argMap:[{type:"input",inputOp:"wedo2_menu_MOTOR_ID",inputName:"MOTOR_ID"}]}),r(o,"motorOff",{opcode:"wedo2_motorOff",argMap:[{type:"input",inputOp:"wedo2_menu_MOTOR_ID",inputName:"MOTOR_ID"}]}),r(o,"startMotorPower",{opcode:"wedo2_startMotorPower",argMap:[{type:"input",inputOp:"wedo2_menu_MOTOR_ID",inputName:"MOTOR_ID"},{type:"input",inputOp:"math_number",inputName:"POWER"}]}),r(o,"setMotorDirection",{opcode:"wedo2_setMotorDirection",argMap:[{type:"input",inputOp:"wedo2_menu_MOTOR_ID",inputName:"MOTOR_ID"},{type:"input",inputOp:"wedo2_menu_MOTOR_DIRECTION",inputName:"MOTOR_DIRECTION"}]}),r(o,"setLED",{opcode:"wedo2_setLightHue",argMap:[{type:"input",inputOp:"math_number",inputName:"HUE"}]}),r(o,"playNote",{opcode:"wedo2_playNoteFor",argMap:[{type:"input",inputOp:"math_number",inputName:"NOTE"},{type:"input",inputOp:"math_number",inputName:"DURATION"}]}),r(o,"whenDistance",{opcode:"wedo2_whenDistance",argMap:[{type:"input",inputOp:"wedo2_menu_OP",inputName:"OP"},{type:"input",inputOp:"math_number",inputName:"REFERENCE"}]}),r(o,"whenTilted",{opcode:"wedo2_whenTilted",argMap:[{type:"input",inputOp:"wedo2_menu_TILT_DIRECTION_ANY",inputName:"TILT_DIRECTION_ANY"}]}),r(o,"getDistance",{opcode:"wedo2_getDistance",argMap:[]}),r(o,"isTilted",{opcode:"wedo2_isTilted",argMap:[{type:"input",inputOp:"wedo2_menu_TILT_DIRECTION_ANY",inputName:"TILT_DIRECTION_ANY"}]}),r(o,"getTilt",{opcode:"wedo2_getTiltAngle",argMap:[{type:"input",inputOp:"wedo2_menu_TILT_DIRECTION",inputName:"TILT_DIRECTION"}]}),A.exports=i},function(A,e,t){const n=A=>function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Promise((e,n)=>{A(...t,(A,t)=>{A?n("string"==typeof A?new Error(A):A):e(t)})})};var i=n(t(446)),r=n(t(448)),o=n(t(449));A.exports=function(A,e,t){i(A,e).then((function(A){return r(A[0]).then(o.bind(null,e)).then((function(e){return[e,A[1]]}))})).then(t.bind(null,null),t)}},function(A,e,t){(function(e){var n=t(447);A.exports=function(A,t,i){if("string"==typeof A)return i(null,[A,null]);if(!e.isBuffer(A))try{A=new e(A)}catch(A){return i("Input must be a Buffer or a string.")}var r=A.slice(0,3).join(" "),o=!1,s=!1;return 0===r.indexOf("83 99 114")&&(o=!0),0===r.indexOf("80 75")&&(s=!0),s||o?o?i("Parser only supports Scratch 2.X and above"):void n(A,t,i):i(null,[A.toString("utf-8"),null])}}).call(this,t(20).Buffer)},function(A,e,t){var n=t(33);A.exports=function(A,e,t){var i="Failed to unzip and extract project.json, with error: ";return n.loadAsync(A).then((function(A){const n=e?A.file(/^([^/]*\/)?sprite\.json$/)[0]:A.file(/^([^/]*\/)?project\.json$/)[0];return n?n.async("string").then((function(e){return t(null,[e,A])})):t(i+"missing project or sprite json")})).catch((function(A){return t(i+A)}))}},function(A,e,t){const n=t(92);A.exports=function(A,e){var t;try{t=n.parse(A.replace(/(\\+)(b|u0008)/g,(A,e,t)=>e.length%2?A.replace("\\"+t,""):A))}catch(A){return e(A.toString())}return e(null,t)}},function(A,e){A.exports=function(A,e,t){if("objName"in e)return e.projectVersion=2,t(null,e);if(A){if("name"in e)return e.projectVersion=3,t(null,e)}else if("targets"in e)return e.projectVersion=3,t(null,e);t(new Error("Could not parse as a valid SB2 or SB3 project."))}},function(A,e,t){const n=t(27),i=t(451),r=t(17),o=t(31),s=t(29),a=t(457),B=t(458),c=t(112),g=t(462),E=t(50),Q=t(39),u=t(463),l=t(464),w=t(465),h=t(113),C=t(72),I=t(114),M=r.v3.create(),d=new c,m=new c,p=new Uint8ClampedArray(4),F=new Uint8ClampedArray(4),D=[3,3],Y=(A,e,t)=>(248&A[0])==(248&e[t+0])&&(248&A[1])==(248&e[t+1])&&(240&A[2])==(240&e[t+2]);let f;let N;class U extends n{static isSupported(A){try{A=A||document.createElement("canvas");const e={alpha:!0,stencil:!0,antialias:!1,xrCompatible:!0};return!!(A.getContext("webgl2",e)||A.getContext("experimental-webgl",e)||A.getContext("webgl",e))}catch(A){return!1}}static _getContext(A){const e={alpha:!0,stencil:!0,antialias:!1,xrCompatible:!0,powerPreference:U.powerPreference};return r.getContext(A,e)||r.getWebGLContext(A,e)}constructor(A,e,n,i,w){super();const h=this._gl=U._getContext(A);if(!h)throw new Error("Could not get WebGL context: this browser or environment may not support WebGL.");this._useGpuMode=U.UseGpuModes.Automatic,this._allDrawables=[],this._allSkins=[],this._drawList=[],this._groupOrdering=[],this._layerGroups={},this._nextDrawableId=E.ID_NONE+1,this._nextSkinId=E.ID_NONE+1,this._projection=r.m4.identity(),this._shaderManager=new Q(h),this._regionId=null,this._exitRegion=null,this._backgroundDrawRegionId={enter:()=>this._enterDrawBackground(),exit:()=>this._exitDrawBackground()},this._snapshotCallbacks=[],this._backgroundColor4f=[0,0,0,1],this._backgroundColor3b=new Uint8ClampedArray(3),this._penSkinId=null,this.customRenderConfig={textCostumeResolution:{capped:!1,fixed:!1,value:1}},this.useHighQualityRender=!0,this.offscreenTouching=!1,this.dirty=!0,this.overlayContainer=document.createElement("div"),this.overlayContainer.className="scratch-render-overlays",this._overlays=[],N||(N=document.createElement("style"),N.textContent=t(473),N.className="scratch-render-styles",document.head.appendChild(N)),this._createGeometry(),this.on(E.Events.NativeSizeChanged,this.onNativeSizeChanged),this.setBackgroundColor(1,1,1),this.setStageSize(e||-240,n||240,i||-180,w||180),this.resize(this._nativeSize[0],this._nativeSize[1]),h.disable(h.DEPTH_TEST),h.enable(h.BLEND),h.blendFunc(h.ONE,h.ONE_MINUS_SRC_ALPHA),this.xrEnabled=!1,this.xrSplitting=!1,this.xrSplitOffset=0,this.xrLayer=null,this.renderOffscreen=!0,this.allowPrivateSkinAccess=!0,this.maxTextureDimension=2048,this.customFonts={},this._customFontStyles=null,this.exports={twgl:r,SVGRenderer:o,Drawable:B,Skin:s,BitmapSkin:a,TextBubbleSkin:l,PenSkin:g,SVGSkin:u,CanvasMeasurementProvider:C,Rectangle:c}}setRenderOffscreen(A){this.renderOffscreen=A,this.dirty=!0,this.draw()}setUseHighQualityRender(A){this.dirty=!0,this.useHighQualityRender=A,this.emit(E.Events.UseHighQualityRenderChanged,A),this._updateRenderQuality()}_updateRenderQuality(){if(null!==this._penSkinId){const A=this._allSkins[this._penSkinId];A&&(this.useHighQualityRender?A.setRenderQuality(this.canvas.width/this._nativeSize[0]):A.setRenderQuality(1))}for(const A of this._allDrawables)A&&A.setHighQuality(this.useHighQualityRender)}setPrivateSkinAccess(A){this.allowPrivateSkinAccess=A,this.emit(E.Events.AllowPrivateSkinAccessChanged,A)}setMaxTextureDimension(A){const e=this._gl.getParameter(this._gl.MAX_TEXTURE_SIZE);this.maxTextureDimension=Math.min(A,e)}get gl(){return this._gl}get canvas(){return this._gl&&this._gl.canvas}resize(A,e){const{canvas:t}=this._gl,n=window.devicePixelRatio||1,i=A*n,r=e*n;t.width===i&&t.height===r||(t.width=i,t.height=r,this._updateRenderQuality(),this._updateOverlays(),this.dirty=!0,this.draw())}setBackgroundColor(A,e,t,n){this.dirty=!0,this._backgroundColor4f[0]=A,this._backgroundColor4f[1]=e,this._backgroundColor4f[2]=t,this._backgroundColor4f[3]=null!=n?n:1,this._backgroundColor3b[0]=255*A,this._backgroundColor3b[1]=255*e,this._backgroundColor3b[2]=255*t}setDebugCanvas(A){this._debugCanvas=A}setUseGpuMode(A){this._useGpuMode=A}setStageSize(A,e,t,n){this._xLeft=A,this._xRight=e,this._yBottom=t,this._yTop=n,this._projection=r.m4.ortho(A,e,t,n,-1,1),this._setNativeSize(Math.abs(e-A),Math.abs(t-n))}getNativeSize(){return[this._nativeSize[0],this._nativeSize[1]]}_setNativeSize(A,e){this._nativeSize=[A,e],this._updateOverlays(),this.emit(E.Events.NativeSizeChanged,{newSize:this._nativeSize})}addOverlay(A){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"scale";const t=document.createElement("div");t.appendChild(A),this.overlayContainer.appendChild(t);const n={container:t,userElement:A,mode:e};return this._overlays.push(n),this._updateOverlays(),n}removeOverlay(A){const e=this._overlays.findIndex(e=>e.userElement===A);-1!==e&&(this._overlays[e].container.remove(),this._overlays.splice(e,1))}_updateOverlays(){const[A,e]=this._nativeSize,t=this.canvas.width/window.devicePixelRatio,n=this.canvas.height/window.devicePixelRatio;this.overlayContainer.style.width="".concat(t,"px"),this.overlayContainer.style.height="".concat(n,"px");for(const i of this._overlays){const r=i.container;if("scale"===i.mode||"scale-centered"===i.mode){const o=t/A,s=n/e;r.style.width="".concat(A,"px"),r.style.height="".concat(e,"px");const a="scale(".concat(o,", ").concat(s,")");if(r.style.transformOrigin="top left","scale"===i.mode)r.style.transform=a;else{const t="translate(".concat(A/2,"px, ").concat(e/2,"px)");r.style.transform="".concat(a," ").concat(t)}}else r.style.transform="",r.style.width="100%",r.style.height="100%"}}createBitmapSkin(A,e,t){const n=this._nextSkinId++,i=new a(n,this);return i.setBitmap(A,e,t),this._allSkins[n]=i,n}createSVGSkin(A,e){const t=this._nextSkinId++,n=new u(t,this);return n.setSVG(A,e),this._allSkins[t]=n,t}createPenSkin(){const A=this._nextSkinId++,e=new g(A,this);return this._allSkins[A]=e,this._penSkinId=A,this._updateRenderQuality(),A}createTextSkin(A,e,t,n){const i=this._nextSkinId++,r=new l(i,this);return r.setTextBubble(A,e,t,n),this._allSkins[i]=r,i}updateSVGSkin(A,e,t){if(this._allSkins[A]instanceof u)return void this._allSkins[A].setSVG(e,t);const n=new u(A,this);n.setSVG(e,t),this._reskin(A,n)}updateBitmapSkin(A,e,t,n){if(this._allSkins[A]instanceof a)return void this._allSkins[A].setBitmap(e,t,n);const i=new a(A,this);i.setBitmap(e,t,n),this._reskin(A,i)}_reskin(A,e){const t=this._allSkins[A];this._allSkins[A]=e;for(const A of this._allDrawables)A&&A.skin===t&&(A.skin=e);t.dispose()}updateTextSkin(A,e,t,n,i){if(this._allSkins[A]instanceof l)return void this._allSkins[A].setTextBubble(e,t,n,i);const r=new l(A,this);r.setTextBubble(e,t,n,i),this._reskin(A,r)}updateTextCostumeSkin(A){if(A.skinId&&this._allSkins[A.skinId]instanceof w)return this._allSkins[A.skinId].setTextAndStyle(A),A.skinId;const e=this._nextSkinId++,t=new w(e,this);return this._allSkins[e]=t,t.setTextAndStyle(A),e}destroySkin(A){this._allSkins[A].dispose(),delete this._allSkins[A]}createDrawable(A){if(!A||!Object.prototype.hasOwnProperty.call(this._layerGroups,A))return void I.warn("Cannot create a drawable without a known layer group");const e=this._nextDrawableId++,t=new B(e,this);return this._allDrawables[e]=t,this._addToDrawList(e,A),t.setHighQuality(this.useHighQualityRender),t.skin=null,e}createTextWrapper(A){return new(f||(f=t(115)),f)(A)}markSkinAsPrivate(A){const e=this._allSkins[A];e&&(e.private=!0)}setLayerGroupOrdering(A){const e={};for(let A=0;A<this._groupOrdering.length;A++){const t=this._groupOrdering[A],n=this._layerGroups[t],i=n.drawListOffset,r=this._endIndexForKnownLayerGroup(n);e[t]=this._drawList.slice(i,r)}this._drawList=[],this._groupOrdering=A;for(let A=0;A<this._groupOrdering.length;A++){const t=this._groupOrdering[A],n=e[t];n&&(this._drawList=this._drawList.concat(n)),this._layerGroups[t]={groupIndex:A,drawListOffset:this._drawList.length}}}_addToDrawList(A,e){const t=this._layerGroups[e],n=t.groupIndex,i=this._endIndexForKnownLayerGroup(t);this._drawList.splice(i,0,A),this._updateOffsets("add",n)}_updateOffsets(A,e){for(let t=e+1;t<this._groupOrdering.length;t++){const e=this._groupOrdering[t];"add"===A?this._layerGroups[e].drawListOffset++:"delete"===A&&this._layerGroups[e].drawListOffset--}}get _visibleDrawList(){return this._drawList.filter(A=>this._allDrawables[A]._visible)}_endIndexForKnownLayerGroup(A){const e=A.groupIndex;return e===this._groupOrdering.length-1?this._drawList.length:this._layerGroups[this._groupOrdering[e+1]].drawListOffset}destroyDrawable(A,e){if(!e||!Object.prototype.hasOwnProperty.call(this._layerGroups,e))return void I.warn("Cannot destroy drawable without known layer group.");this.dirty=!0;this._allDrawables[A].dispose(),delete this._allDrawables[A];const t=this._layerGroups[e],n=this._endIndexForKnownLayerGroup(t);let i=t.drawListOffset;for(;i<n&&this._drawList[i]!==A;)i++;i<n?(this._drawList.splice(i,1),this._updateOffsets("delete",t.groupIndex)):I.warn("Could not destroy drawable that could not be found in layer group.")}getDrawableOrder(A){return this._drawList.indexOf(A)}setDrawableOrder(A,e,t,n,i){if(!t||!Object.prototype.hasOwnProperty.call(this._layerGroups,t))return void I.warn("Cannot set the order of a drawable without a known layer group.");this.dirty=!0;const r=this._layerGroups[t],o=r.drawListOffset,s=this._endIndexForKnownLayerGroup(r);let a=o;for(;a<s&&this._drawList[a]!==A;)a++;if(a<s){if(0===e)return a;this._drawList.splice(a,1)[0];let t=e;n&&(t+=a);const r=(i||0)+o,B=r>=o&&r<s?r:o;return t=Math.max(t,B),t=Math.min(t,s),this._drawList.splice(t,0,A),t}return null}skinWasAltered(A){for(let e=0;e<this._drawList.length;e++){const t=this._drawList[e],n=this._allDrawables[t];n._skin===A&&n._skinWasAltered()}}draw(){if(!this.dirty)return;if(this.xrEnabled&&!this.xrLayer)return;this.dirty=!1,this._doExitDrawRegion();const A=this._gl,e=this.xrLayer;this.xrEnabled?(A.bindFramebuffer(A.FRAMEBUFFER,e.framebuffer),A.viewport(0,0,e.framebufferWidth,e.framebufferHeight),A.clearColor(0,0,0,0)):(r.bindFramebufferInfo(A,null),A.viewport(0,0,A.canvas.width,A.canvas.height),A.clearColor(...this._backgroundColor4f)),A.clear(A.COLOR_BUFFER_BIT);const t=this._snapshotCallbacks.length>0;if(this.xrSplitting){const n=this.xrEnabled?e.framebufferWidth:A.canvas.width,i=this.xrEnabled?e.framebufferHeight:A.canvas.height,o=this._xRight-this._xLeft,s=r.m4.ortho(this._xLeft+this.xrSplitOffset,this._xRight+o+this.xrSplitOffset,this._yBottom,this._yTop,-1,1),a=r.m4.ortho(this._xLeft-o-this.xrSplitOffset,this._xRight+o-o-this.xrSplitOffset,this._yBottom,this._yTop,-1,1);A.enable(A.SCISSOR_TEST),A.scissor(0,0,n/2,i),this._drawThese(this._drawList,Q.DRAW_MODE.default,s,{framebufferWidth:n,framebufferHeight:i,skipPrivateSkins:t}),A.scissor(n/2,0,n/2,i),this._drawThese(this._drawList,Q.DRAW_MODE.default,a,{framebufferWidth:n,framebufferHeight:i,skipPrivateSkins:t}),A.disable(A.SCISSOR_TEST)}else this._drawThese(this._drawList,Q.DRAW_MODE.default,this._projection,{framebufferWidth:A.canvas.width,framebufferHeight:A.canvas.height,skipPrivateSkins:t});if(t){const e=A.canvas.toDataURL();this._snapshotCallbacks.forEach(A=>A(e)),this._snapshotCallbacks=[],this.dirty=!0}}getBounds(A){const e=this._allDrawables[A];if(e.needsConvexHullPoints()){const t=this._getConvexHullPointsForDrawable(A);e.setConvexHullPoints(t)}const t=e.getFastBounds();if(this._debugCanvas){const A=this._gl;this._debugCanvas.width=A.canvas.width,this._debugCanvas.height=A.canvas.height;const e=this._debugCanvas.getContext("2d",{willReadFrequently:!0});e.drawImage(A.canvas,0,0),e.strokeStyle="#FF0000";const n=window.devicePixelRatio;e.strokeRect(n*(t.left+this._nativeSize[0]/2),n*(-t.top+this._nativeSize[1]/2),n*(t.right-t.left),n*(-t.bottom+t.top))}return t}getBoundsForBubble(A){const e=this._allDrawables[A];if(e.needsConvexHullPoints()){const t=this._getConvexHullPointsForDrawable(A);e.setConvexHullPoints(t)}const t=e.getBoundsForBubble();if(this._debugCanvas){const A=this._gl;this._debugCanvas.width=A.canvas.width,this._debugCanvas.height=A.canvas.height;const e=this._debugCanvas.getContext("2d",{willReadFrequently:!0});e.drawImage(A.canvas,0,0),e.strokeStyle="#FF0000";const n=window.devicePixelRatio;e.strokeRect(n*(t.left+this._nativeSize[0]/2),n*(-t.top+this._nativeSize[1]/2),n*(t.right-t.left),n*(-t.bottom+t.top))}return t}getCurrentSkinSize(A){const e=this._allDrawables[A];return this.getSkinSize(e.skin.id)}getSkinSize(A){return this._allSkins[A].size}getSkinRotationCenter(A){return this._allSkins[A].calculateRotationCenter()}isTouchingColor(A,e,t){const n=this._candidatesTouching(A,this._visibleDrawList);let i;if(Y(e,this._backgroundColor3b,0)){if(i=this._touchingBounds(A),null===i)return!1}else{if(0===n.length)return!1;i=this._candidatesBounds(n)}const r=this._getMaxPixelsForCPU(),o=this._debugCanvas&&this._debugCanvas.getContext("2d",{willReadFrequently:!0});o&&(this._debugCanvas.width=i.width,this._debugCanvas.height=i.height),i.width*i.height*(n.length+1)>=r&&this._isTouchingColorGpuStart(A,n.map(A=>{let{id:e}=A;return e}).reverse(),i,e,t);const s=this._allDrawables[A],a=M,c=p,g=Boolean(t);s.updateCPURenderAttributes();const E=~Q.EFFECT_INFO.ghost.mask;for(let A=i.bottom;A<=i.top;A++){if(i.width*(A-i.bottom)*(n.length+1)>=r)return this._isTouchingColorGpuFin(i,e,A-i.bottom);for(let r=i.left;r<=i.right;r++)if(a[1]=A,a[0]=r,(g?(u=B.sampleColor4b(a,s,c,E),l=t,u[3]>0&&(252&u[0])==(252&l[0])&&(252&u[1])==(252&l[1])&&(252&u[2])==(252&l[2])):s.isTouching(a))&&(U.sampleColor3b(a,n,c),o&&(o.fillStyle="rgb(".concat(c[0],",").concat(c[1],",").concat(c[2],")"),o.fillRect(r-i.left,i.bottom-A,1,1)),Y(c,e,0)))return!0}var u,l;return!1}_getMaxPixelsForCPU(){switch(this._useGpuMode){case U.UseGpuModes.ForceCPU:return 1/0;case U.UseGpuModes.ForceGPU:return 0;case U.UseGpuModes.Automatic:default:return 4e4}}_enterDrawBackground(){const A=this.gl,e=this._shaderManager.getShader(Q.DRAW_MODE.background,0);A.disable(A.BLEND),A.useProgram(e.program),r.setBuffersAndAttributes(A,e,this._bufferInfo)}_exitDrawBackground(){const A=this.gl;A.enable(A.BLEND)}_isTouchingColorGpuStart(A,e,t,n,i){this._doExitDrawRegion();const o=this._gl;r.bindFramebufferInfo(o,this._queryBufferInfo),o.viewport(0,0,t.width,t.height);const s=r.m4.ortho(t.left,t.right,t.top,t.bottom,-1,1);let a;o.clearColor(0,0,0,0),o.clear(o.COLOR_BUFFER_BIT|o.STENCIL_BUFFER_BIT),i&&(a={u_colorMask:[i[0]/255,i[1]/255,i[2]/255],u_colorMaskTolerance:2/255});try{o.enable(o.STENCIL_TEST),o.stencilFunc(o.ALWAYS,1,1),o.stencilOp(o.KEEP,o.KEEP,o.REPLACE),o.colorMask(!1,!1,!1,!1),this._drawThese([A],i?Q.DRAW_MODE.colorMask:Q.DRAW_MODE.silhouette,s,{extraUniforms:a,ignoreVisibility:!0,effectMask:~Q.EFFECT_INFO.ghost.mask}),o.stencilFunc(o.EQUAL,1,1),o.stencilOp(o.KEEP,o.KEEP,o.KEEP),o.colorMask(!0,!0,!0,!0),this.enterDrawRegion(this._backgroundDrawRegionId);const t={u_backgroundColor:this._backgroundColor4f},n=this._shaderManager.getShader(Q.DRAW_MODE.background,0);r.setUniforms(n,t),r.drawBufferInfo(o,this._bufferInfo,o.TRIANGLES),this._drawThese(e,Q.DRAW_MODE.default,s,{idFilterFunc:e=>e!==A})}finally{o.colorMask(!0,!0,!0,!0),o.disable(o.STENCIL_TEST),this._doExitDrawRegion()}}_isTouchingColorGpuFin(A,e,t){const n=this._gl,i=new Uint8Array(Math.floor(A.width*(A.height-t)*4));if(n.readPixels(0,0,A.width,A.height-t,n.RGBA,n.UNSIGNED_BYTE,i),this._debugCanvas){this._debugCanvas.width=A.width,this._debugCanvas.height=A.height;const e=this._debugCanvas.getContext("2d",{willReadFrequently:!0}),n=e.getImageData(0,0,A.width,A.height-t);n.data.set(i),e.putImageData(n,0,0)}for(let A=0;A<i.length;A+=4)if(0!==i[A+3]&&Y(e,i,A))return!0;return!1}isTouchingDrawables(A){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._drawList;const t=this._candidatesTouching(A,e.filter(A=>this._allDrawables[A]._visible));if(0===t.length||!this._allDrawables[A]._visible)return!1;const n=this._candidatesBounds(t),i=this._allDrawables[A],r=M;i.updateCPURenderAttributes();for(let A=n.left;A<=n.right;A++){r[0]=A;for(let A=n.bottom;A<=n.top;A++)if(r[1]=A,i.isTouching(r))for(let A=0;A<t.length;A++)if(t[A].drawable.isTouching(r))return!0}return!1}getTouchingDrawablesPoint(A){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._drawList;const t=this._candidatesTouching(A,e.filter(A=>this._allDrawables[A]._visible));if(0===t.length||!this._allDrawables[A]._visible)return null;const n=this._candidatesBounds(t),i=this._allDrawables[A],r=M;i.updateCPURenderAttributes();for(let A=n.left;A<=n.right;A++){r[0]=A;for(let A=n.bottom;A<=n.top;A++)if(r[1]=A,i.isTouching(r))for(let A=0;A<t.length;A++)if(t[A].drawable.isTouching(r))return r}return null}clientSpaceToScratchBounds(A,e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const i=this._gl,r=this._nativeSize[0]/i.canvas.clientWidth,o=this._nativeSize[1]/i.canvas.clientHeight;t*=r,n*=o,t=Math.max(1,Math.min(Math.round(t),D[0])),n=Math.max(1,Math.min(Math.round(n),D[1]));const s=A*r-(t-1)/2,a=e*o+(n-1)/2,B=t%2?0:-.5,g=n%2?0:-.5,E=new c;return E.initFromBounds(Math.floor(this._xLeft+s+B),Math.floor(this._xLeft+s+B+t-1),Math.ceil(this._yTop-a+g),Math.ceil(this._yTop-a+g+n-1)),E}drawableTouching(A,e,t,n,i){const o=this._allDrawables[A];if(!o)return!1;const s=this.clientSpaceToScratchBounds(e,t,n,i),a=o.getFastBounds();if(a.snapToInt(),!a.intersects(s))return!1;o.updateCPURenderAttributes();const B=r.v3.create();for(B[1]=s.bottom;B[1]<=s.top;B[1]++)for(B[0]=s.left;B[0]<=s.right;B[0]++)if(o.isTouching(B))return!0;return!1}pick(A,e,t,n,i){const o=this.clientSpaceToScratchBounds(A,e,t,n);if(o.left===-1/0||o.bottom===-1/0)return!1;if(0===(i=(i||this._drawList).filter(A=>{const e=this._allDrawables[A];if(e.getVisible()&&0!==e.getUniforms().u_ghost){const A=e.getFastBounds();return!!o.intersects(A)&&(!(e.skin instanceof g)&&(e.updateCPURenderAttributes(),!0))}return!1})).length)return!1;const s=[],a=r.v3.create(0,0,0);for(a[1]=o.bottom;a[1]<=o.top;a[1]++)for(a[0]=o.left;a[0]<=o.right;a[0]++)for(let A=i.length-1;A>=0;A--){const e=i[A];if(this._allDrawables[e].isTouching(a)){s[e]=(s[e]||0)+1;break}}s[E.ID_NONE]=0;let B=E.ID_NONE;for(const A in s)Object.prototype.hasOwnProperty.call(s,A)&&s[A]>s[B]&&(B=A);return Number(B)}extractDrawableScreenSpace(A){const e=this._allDrawables[A];if(!e)throw new Error("Could not extract drawable with ID ".concat(A,"; it does not exist"));this._doExitDrawRegion();const t=.5*this._nativeSize[0],n=.5*this._nativeSize[1],i=e.getFastBounds(),o=this.canvas,s=o.width/this._nativeSize[0],a=new c;a.initFromBounds((i.left+t)*s,(i.right+t)*s,(n-i.top)*s,(n-i.bottom)*s),a.snapToInt(),i.initFromBounds(a.left/s-t,a.right/s-t,n-a.top/s,n-a.bottom/s);const B=this._gl,g=B.getParameter(B.MAX_TEXTURE_SIZE),E=Math.min(2048,a.width,g),u=Math.min(2048,a.height,g),l=r.createFramebufferInfo(B,[{format:B.RGBA}],E,u);try{r.bindFramebufferInfo(B,l),B.viewport(0,0,E,u);const e=r.m4.ortho(i.left,i.right,i.top,i.bottom,-1,1);B.clearColor(0,0,0,0),B.clear(B.COLOR_BUFFER_BIT),this._drawThese([A],Q.DRAW_MODE.straightAlpha,e,{framebufferWidth:o.width,framebufferHeight:o.height});const t=new Uint8Array(Math.floor(E*u*4));B.readPixels(0,0,E,u,B.RGBA,B.UNSIGNED_BYTE,t);const n=new ImageData(new Uint8ClampedArray(t.buffer),E,u),s=o.getBoundingClientRect().width/o.width;return{imageData:n,x:a.left*s,y:a.bottom*s,width:a.width*s,height:a.height*s}}finally{B.deleteFramebuffer(l.framebuffer)}}extractColor(A,e,t){this._doExitDrawRegion();const n=Math.round(this._nativeSize[0]*(A/this._gl.canvas.clientWidth-.5)),i=Math.round(-this._nativeSize[1]*(e/this._gl.canvas.clientHeight-.5)),o=this._gl;r.bindFramebufferInfo(o,this._queryBufferInfo);const s=new c;s.initFromBounds(n-t,n+t,i-t,i+t);const a=n-s.left,B=s.top-i;o.viewport(0,0,s.width,s.height);const g=r.m4.ortho(s.left,s.right,s.top,s.bottom,-1,1);o.clearColor(...this._backgroundColor4f),o.clear(o.COLOR_BUFFER_BIT),this._drawThese(this._drawList,Q.DRAW_MODE.default,g);const E=new Uint8Array(Math.floor(s.width*s.height*4));o.readPixels(0,0,s.width,s.height,o.RGBA,o.UNSIGNED_BYTE,E);const u=Math.floor(4*(B*s.width+a)),l={r:E[u],g:E[u+1],b:E[u+2],a:E[u+3]};if(this._debugCanvas){this._debugCanvas.width=s.width,this._debugCanvas.height=s.height;const A=this._debugCanvas.getContext("2d",{willReadFrequently:!0}),e=A.createImageData(s.width,s.height);e.data.set(E),A.putImageData(e,0,0),A.strokeStyle="black",A.fillStyle="rgba(".concat(l.r,", ").concat(l.g,", ").concat(l.b,", ").concat(l.a,")"),A.rect(a-4,B-4,8,8),A.fill(),A.stroke()}return{data:E,width:s.width,height:s.height,color:l}}_touchingBounds(A){const e=this._allDrawables[A];if(!e.skin||!e.skin.getTexture([100,100]))return null;const t=e.getFastBounds();return this.offscreenTouching||t.clamp(this._xLeft,this._xRight,this._yBottom,this._yTop),t.snapToInt(),0===t.width||0===t.height?null:t}_unsnappedTouchingBounds(A){const e=this._allDrawables[A];if(!e.skin||!e.skin.getTexture([100,100]))return null;const t=e.getFastBounds();return this.offscreenTouching||t.clamp(this._xLeft,this._xRight,this._yBottom,this._yTop),0===t.width||0===t.height?null:t}_candidatesTouching(A,e){const t=this._touchingBounds(A),n=[];if(null===t)return n;for(let i=e.length-1;i>=0;i--){const r=e[i];if(r!==A){const A=this._allDrawables[r];if(A.skin instanceof l)continue;if(A.skin&&A._visible){if(!this.allowPrivateSkinAccess&&A.skin.private)continue;A.updateCPURenderAttributes();const e=A.getFastBounds();e.snapToInt(),t.intersects(e)&&n.push({id:r,drawable:A,intersection:c.intersect(t,e)})}}}return n}_candidatesBounds(A){return A.reduce((A,e)=>{let{intersection:t}=e;return A?c.union(A,t,d):t},null)}updateDrawableSkinId(A,e){const t=this._allDrawables[A];t&&(t.skin=this._allSkins[e])}updateDrawablePosition(A,e){const t=this._allDrawables[A];t&&t.updatePosition(e)}updateDrawableDirection(A,e){const t=this._allDrawables[A];t&&t.updateDirection(e)}updateDrawableScale(A,e){const t=this._allDrawables[A];t&&t.updateScale(e)}updateDrawableDirectionScale(A,e,t,n){const i=this._allDrawables[A];i&&(i.updateDirection(e),i.updateScale(t),n&&i.updateTransform(n))}updateDrawableVisible(A,e){const t=this._allDrawables[A];t&&t.updateVisible(e)}updateDrawableEffect(A,e,t){const n=this._allDrawables[A];n&&n.updateEffect(e,t)}updateDrawableProperties(A,e){const t=this._allDrawables[A];t&&("skinId"in e&&this.updateDrawableSkinId(A,e.skinId),t.updateProperties(e))}getFencedPositionOfDrawable(A,e){let t=e[0],n=e[1];const i=this._allDrawables[A];if(!i)return[t,n];const r=t-i._position[0],o=n-i._position[1],s=i._skin.getFenceBounds(i,m),a=Math.floor(Math.min(s.width,s.height)/2),B=this._xRight-Math.min(15,a);s.right+r<-B?t=Math.ceil(i._position[0]-(B+s.right)):s.left+r>B&&(t=Math.floor(i._position[0]+(B-s.left)));const c=this._yTop-Math.min(15,a);return s.top+o<-c?n=Math.ceil(i._position[1]-(c+s.top)):s.bottom+o>c&&(n=Math.floor(i._position[1]+(c-s.bottom))),[t,n]}penTranslate(A,e,t,n,i){this.dirty=!0;this._allSkins[A].updatePenPointOffset(e,t,n,i)}penClear(A){this.dirty=!0;this._allSkins[A].clear()}penPoint(A,e,t,n){this.dirty=!0;this._allSkins[A].drawPoint(e,t,n)}penLine(A,e,t,n,i,r){this.dirty=!0;this._allSkins[A].drawLine(e,t,n,i,r)}penStamp(A,e){this.dirty=!0;if(!this._allDrawables[e])return;const t=this._unsnappedTouchingBounds(e);if(!t)return;this._doExitDrawRegion();const n=this._allSkins[A],i=this._gl;r.bindFramebufferInfo(i,n._framebuffer);const o=n.renderQuality;t.left*=o,t.right*=o,t.top*=o,t.bottom*=o,t.snapToInt(),i.viewport(.5*this._nativeSize[0]*o+t.left,.5*this._nativeSize[1]*o-t.top,t.width,t.height);const s=r.m4.ortho(t.left/o,t.right/o,t.top/o,t.bottom/o,-1,1);this._drawThese([e],Q.DRAW_MODE.default,s,{ignoreVisibility:!0,framebufferWidth:this._nativeSize[0]*o,framebufferHeight:this._nativeSize[1]*o}),n._silhouetteDirty=!0}_createGeometry(){this._bufferInfo=r.createBufferInfoFromArrays(this._gl,{a_position:{numComponents:2,data:[-.5,-.5,.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5]},a_texCoord:{numComponents:2,data:[1,0,0,0,1,1,1,1,0,0,0,1]}})}onNativeSizeChanged(A){this.dirty=!0;const[e,t]=A.newSize,n=this._gl,i=[{format:n.RGBA},{format:n.DEPTH_STENCIL}];this._pickBufferInfo||(this._pickBufferInfo=r.createFramebufferInfo(n,i,D[0],D[1])),this._queryBufferInfo?r.resizeFramebufferInfo(n,this._queryBufferInfo,i,e,t):this._queryBufferInfo=r.createFramebufferInfo(n,i,e,t)}enterDrawRegion(A){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:A.enter,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:A.exit;this._regionId!==A&&(this._doExitDrawRegion(),this._regionId=A,e(),this._exitRegion=t)}_doExitDrawRegion(){null!==this._exitRegion&&this._exitRegion(),this._exitRegion=null,this._regionId=null}_drawThese(A,e,t){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i=this._gl;let o=null;const s=this._nativeSize[0]/2,a=this._nativeSize[1]/2,B="framebufferWidth"in n&&"framebufferHeight"in n&&n.framebufferWidth!==this._nativeSize[0]&&n.framebufferHeight!==this._nativeSize[1],c=A.length;for(let g=0;g<c;++g){const c=A[g];if(n.filter&&!n.filter(c))continue;const E=this._allDrawables[c];if(!E)continue;const u={};if(!this.renderOffscreen&&E.uniformApplied)if(e===Q.DRAW_MODE.default&&E.skin){let A=!1;if(E.transformBeforeCheckViewport()&&(Object.assign(u,E.getUniforms()),A=!0),!E.inViewport(s,a))continue;A||Object.assign(u,E.getUniforms())}else Object.assign(u,E.getUniforms());if(!E.getVisible()&&!n.ignoreVisibility)continue;const l=B?[E.scale[0]*n.framebufferWidth/this._nativeSize[0],E.scale[1]*n.framebufferHeight/this._nativeSize[1]]:E.scale,w=E.transform||[0,0];if(!E.skin||!E.skin.getTexture(l,w))continue;if(n.skipPrivateSkins&&E.skin.private)continue;let h=E.enabledEffects;h&=Object.prototype.hasOwnProperty.call(n,"effectMask")?n.effectMask:h;const C=this._shaderManager.getShader(e,h);this._regionId!==C&&(this._doExitDrawRegion(),this._regionId=C,o=C,i.useProgram(o.program),r.setBuffersAndAttributes(i,o,this._bufferInfo),Object.assign(u,{u_projectionMatrix:t})),E.uniformApplied=!0,Object.assign(u,E.skin.getUniforms(l),E.getUniforms()),n.extraUniforms&&Object.assign(u,n.extraUniforms),u.u_skin&&r.setTextureParameters(i,u.u_skin,{minMag:E.skin.useNearest(l,E)?i.NEAREST:i.LINEAR}),r.setUniforms(o,u),r.drawBufferInfo(i,this._bufferInfo,i.TRIANGLES)}this._regionId=null}_getConvexHullPointsForDrawable(A){const e=this._allDrawables[A],[t,n]=e.skin.size;if(!e.getVisible()||0===t||0===n)return[];e.updateCPURenderAttributes();const o=function(A,e,t){return(e[0]-A[0])*(t[1]-A[1])-(e[1]-A[1])*(t[0]-A[0])},s=[],a=[];let B=-1,c=-1;const g=r.v3.create(),E=r.v3.create();let Q;for(let A=0;A<n;A++){g[1]=A/n;let i=0;for(;i<t;i++)if(g[0]=i/t,h.transformPoint(e,g,E),e.skin.isTouchingLinear(E)){Q=[i,A];break}if(!(i>=t)){for(;B>0&&!(o(s[B],s[B-1],Q)>0);)--B;for(s[++B]=Q,i=t-1;i>=0;i--)if(g[0]=i/t,h.transformPoint(e,g,E),e.skin.isTouchingLinear(E)){Q=[i,A];break}for(;c>0&&!(o(a[c],a[c-1],Q)<0);)--c;a[++c]=Q}}const u=s;u.length=B+1;for(let A=c;A>=0;--A)u.push(a[A]);return i(u,1/0)}static sampleColor3b(A,e,t){(t=t||new Uint8ClampedArray(3)).fill(0);let n=1;for(let i=0;0!==n&&i<e.length;i++)B.sampleColor4b(A,e[i].drawable,F),t[0]+=F[0]*n,t[1]+=F[1]*n,t[2]+=F[2]*n,n*=1-F[3]/255;return t[0]+=255*n,t[1]+=255*n,t[2]+=255*n,t}requestSnapshot(A){this.dirty=!0,this._snapshotCallbacks.push(A)}getBubbleDefaults(){const A=new l,e=A.getAllProps();return A.dispose(),e}getPenDrawableId(){return this._allDrawables.findIndex(A=>A._skin._id===this._penSkinId)}setCustomFonts(A){this.customFonts=A;const e=Object.values(A).join("\n");e.length?(this._customFontStyles||(this._customFontStyles=document.createElement("style"),this._customFontStyles.className="renderer-custom-fonts",document.head.appendChild(this._customFontStyles)),this._customFontStyles.textContent=e):this._customFontStyles&&(this._customFontStyles.remove(),this._customFontStyles=null)}}U.prototype.canHazPixels=U.prototype.extractDrawableScreenSpace,U.UseGpuModes={Automatic:"Automatic",ForceGPU:"ForceGPU",ForceCPU:"ForceCPU"},U.powerPreference="default",A.exports=U},function(A,e,t){"use strict";var n=t(452),i=t(453),r=t(454),o=t(455);function s(A,e){return Math.pow(e[0]-A[0],2)+Math.pow(e[1]-A[1],2)}function a(A,e,t){var n=[e[0]-A[0],e[1]-A[1]],i=[t[0]-A[0],t[1]-A[1]],r=s(A,e),o=s(A,t);return(n[0]*i[0]+n[1]*i[1])/Math.sqrt(r*o)}function B(A,e){for(var t=0;t<e.length-1;t++){var i=[e[t],e[t+1]];if(!(A[0][0]===i[0][0]&&A[0][1]===i[0][1]||A[0][0]===i[1][0]&&A[0][1]===i[1][1])&&n(A,i))return!0}return!1}function c(A){return[Math.min(A[0][0],A[1][0]),Math.min(A[0][1],A[1][1]),Math.max(A[0][0],A[1][0]),Math.max(A[0][1],A[1][1])]}function g(A,e,t){for(var n,i,r=null,o=E,s=E,c=0;c<e.length;c++)n=a(A[0],A[1],e[c]),i=a(A[1],A[0],e[c]),n>o&&i>s&&!B([A[0],e[c]],t)&&!B([A[1],e[c]],t)&&(o=n,s=i,r=e[c]);return r}var E=Math.cos(90/(180/Math.PI)),Q=.6;A.exports=function(A,e,t){var n,a,B,E,u,l,w,h=e||20;return A.length<4?A.slice():(u=[(E=function(A){for(var e=1/0,t=1/0,n=-1/0,i=-1/0,r=A.length-1;r>=0;r--)A[r][0]<e&&(e=A[r][0]),A[r][1]<t&&(t=A[r][1]),A[r][0]>n&&(n=A[r][0]),A[r][1]>i&&(i=A[r][1]);return[n-e,i-t]}(w=function(A){return A.filter((function(A,e,t){var n=t[e-1];return 0===e||!(n[0]===A[0]&&n[1]===A[1])}))}(function(A){return A.sort((function(A,e){return A[0]==e[0]?A[1]-e[1]:A[0]-e[0]}))}(r.toXy(A,t)))))[0]*Q,E[1]*Q],n=o(w),B=w.filter((function(A){return n.indexOf(A)<0})),l=Math.ceil(1/(w.length/(E[0]*E[1]))),a=function A(e,t,n,i,r){for(var o,a,B,E,Q,u,l,w=!1,h=0;h<e.length-1;h++)if(a=(o=[e[h],e[h+1]])[0].join()+","+o[1].join(),!(s(o[0],o[1])<t||!0===r[a])){B=0,Q=c(o);do{u=(Q=i.extendBbox(Q,B))[2]-Q[0],l=Q[3]-Q[1],E=g(o,i.rangePoints(Q),e),B++}while(null===E&&(n[0]>u||n[1]>l));u>=n[0]&&l>=n[1]&&(r[a]=!0),null!==E&&(e.splice(h+1,0,E),i.removePoint(E),w=!0)}return w?A(e,t,n,i,r):e}(n,Math.pow(h,2),u,i(B,l),{}),r.fromXy(a,t))}},function(A,e){function t(A,e,t,n,i,r){var o=(r-e)*(t-A)-(n-e)*(i-A);return o>0||!(o<0)}A.exports=function(A,e){var n=A[0][0],i=A[0][1],r=A[1][0],o=A[1][1],s=e[0][0],a=e[0][1],B=e[1][0],c=e[1][1];return t(n,i,s,a,B,c)!==t(r,o,s,a,B,c)&&t(n,i,r,o,s,a)!==t(n,i,r,o,B,c)}},function(A,e){function t(A,e){this._cells=[],this._cellSize=e,A.forEach((function(A){var e=this.point2CellXY(A),t=e[0],n=e[1];void 0===this._cells[t]&&(this._cells[t]=[]),void 0===this._cells[t][n]&&(this._cells[t][n]=[]),this._cells[t][n].push(A)}),this)}t.prototype={cellPoints:function(A,e){return void 0!==this._cells[A]&&void 0!==this._cells[A][e]?this._cells[A][e]:[]},rangePoints:function(A){for(var e=this.point2CellXY([A[0],A[1]]),t=this.point2CellXY([A[2],A[3]]),n=[],i=e[0];i<=t[0];i++)for(var r=e[1];r<=t[1];r++)n=n.concat(this.cellPoints(i,r));return n},removePoint:function(A){for(var e,t=this.point2CellXY(A),n=this._cells[t[0]][t[1]],i=0;i<n.length;i++)if(n[i][0]===A[0]&&n[i][1]===A[1]){e=i;break}return n.splice(e,1),n},point2CellXY:function(A){return[parseInt(A[0]/this._cellSize),parseInt(A[1]/this._cellSize)]},extendBbox:function(A,e){return[A[0]-e*this._cellSize,A[1]-e*this._cellSize,A[2]+e*this._cellSize,A[3]+e*this._cellSize]}},A.exports=function(A,e){return new t(A,e)}},function(A,e){A.exports={toXy:function(A,e){return void 0===e?A.slice():A.map((function(A){return new Function("pt","return [pt"+e[0]+",pt"+e[1]+"];")(A)}))},fromXy:function(A,e){return void 0===e?A.slice():A.map((function(A){return new Function("pt","var o = {}; o"+e[0]+"= pt[0]; o"+e[1]+"= pt[1]; return o;")(A)}))}}},function(A,e){function t(A,e,t){return(e[0]-A[0])*(t[1]-A[1])-(e[1]-A[1])*(t[0]-A[0])}A.exports=function(A){var e,n=function(A){for(var e=[],n=0;n<A.length;n++){for(;e.length>=2&&t(e[e.length-2],e[e.length-1],A[n])<=0;)e.pop();e.push(A[n])}return e.pop(),e}(A);return(e=function(A){for(var e=A.reverse(),n=[],i=0;i<e.length;i++){for(;n.length>=2&&t(n[n.length-2],n[n.length-1],e[i])<=0;)n.pop();n.push(e[i])}return n.pop(),n}(A).concat(n)).push(A[0]),e}},function(A,e){let t;const n=(A,e)=>e^(A^e)&A-e>>31,i=(A,e)=>A^(A^e)&A-e>>31,r=(A,e,t)=>{let{_width:n,_height:i,_colorData:r}=A;return e>=n||t>=i||e<0||t<0?0:r[4*(t*n+e)+3]},o=[new Uint8ClampedArray(4),new Uint8ClampedArray(4),new Uint8ClampedArray(4),new Uint8ClampedArray(4)],s=(A,e,t,r)=>{let{_width:o,_height:s,_colorData:a}=A;if(e=i(0,n(e,o-1)),t=i(0,n(t,s-1)),e>=o||t>=s||e<0||t<0)return r.fill(0);const B=4*(t*o+e),c=a[B+3]/255;return r[0]=a[B]*c,r[1]=a[B+1]*c,r[2]=a[B+2]*c,r[3]=a[B+3],r},a=(A,e,t,r)=>{let{_width:o,_height:s,_colorData:a}=A;e=i(0,n(e,o-1));const B=4*((t=i(0,n(t,s-1)))*o+e);return r[0]=a[B],r[1]=a[B+1],r[2]=a[B+2],r[3]=a[B+3],r};class B{constructor(){this._width=0,this._height=0,this._lazyData=null,this._colorData=null,this._getColor=s,this.colorAtNearest=this.colorAtLinear=(A,e)=>e.fill(0)}update(A){let e,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(A instanceof ImageData)e=A,this._width=A.width,this._height=A.height,this._lazyData=null,this._colorData=e.data;else{if(this._width=A.width,this._height=A.height,!this._width||!this._height)return;this._lazyData=A,this._colorData=null}this._getColor=t?a:s,delete this.colorAtNearest,delete this.colorAtLinear}unlazy(){if(!this._lazyData)return;const A=this._lazyData.width,e=this._lazyData.height;if(A&&e){const t=B._updateCanvas();t.width=A,t.height=e;const n=t.getContext("2d",{willReadFrequently:!0});n.clearRect(0,0,A,e),n.drawImage(this._lazyData,0,0,A,e);const i=n.getImageData(0,0,A,e);this._colorData=i.data}this._lazyData=null}colorAtNearest(A,e){return this._getColor(this,Math.floor(A[0]*(this._width-1)),Math.floor(A[1]*(this._height-1)),e)}colorAtLinear(A,e){const t=A[0]*(this._width-1),n=A[1]*(this._height-1),i=t%1,r=n%1,s=1-i,a=1-r,B=Math.floor(t),c=Math.floor(n),g=this._getColor(this,B,c,o[0]),E=this._getColor(this,B+1,c,o[1]),Q=this._getColor(this,B,c+1,o[2]),u=this._getColor(this,B+1,c+1,o[3]);return e[0]=g[0]*s*a+Q[0]*s*r+E[0]*i*a+u[0]*i*r,e[1]=g[1]*s*a+Q[1]*s*r+E[1]*i*a+u[1]*i*r,e[2]=g[2]*s*a+Q[2]*s*r+E[2]*i*a+u[2]*i*r,e[3]=g[3]*s*a+Q[3]*s*r+E[3]*i*a+u[3]*i*r,e}isTouchingNearest(A){if(this._colorData)return r(this,Math.floor(A[0]*(this._width-1)),Math.floor(A[1]*(this._height-1)))>0}isTouchingLinear(A){if(!this._colorData)return;const e=Math.floor(A[0]*(this._width-1)),t=Math.floor(A[1]*(this._height-1));return r(this,e,t)>0||r(this,e+1,t)>0||r(this,e,t+1)>0||r(this,e+1,t+1)>0}static _updateCanvas(){return void 0===t&&(t=document.createElement("canvas")),t}}A.exports=B},function(A,e,t){const n=t(17),i=t(29);class r extends i{constructor(A,e){super(A,e),this._costumeResolution=1,this._textureSize=[0,0]}dispose(){this._texture&&(this._renderer.gl.deleteTexture(this._texture),this._texture=null),super.dispose()}get size(){return[this._textureSize[0]/this._costumeResolution,this._textureSize[1]/this._costumeResolution]}getTexture(A){return this._texture||super.getTexture()}setBitmap(A,e,t){if(!A.width||!A.height)return void super.setEmptyImageData();const i=this._renderer.gl;let o=A;if(A instanceof HTMLCanvasElement&&!1!==A.reusable){o=A.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,A.width,A.height)}if(null===this._texture){const A={auto:!1,wrap:i.CLAMP_TO_EDGE};this._texture=n.createTexture(i,A)}this._setTexture(o),this._costumeResolution=e||2,this._textureSize=r._getBitmapSize(A),void 0===t&&(t=this.calculateRotationCenter()),this._rotationCenter[0]=t[0],this._rotationCenter[1]=t[1],this.emitWasAltered()}static _getBitmapSize(A){return A instanceof HTMLImageElement?[A.naturalWidth||A.width,A.naturalHeight||A.height]:A instanceof HTMLVideoElement?[A.videoWidth||A.width,A.videoHeight||A.height]:[A.width,A.height]}}A.exports=r},function(A,e,t){const n=t(17),i=t(112),r=t(50),o=t(39),s=t(113),a=t(114),B=n.v3.create(),c=(A,e)=>{const t=B,n=e[0],i=e[1],r=A._inverseMatrix,o=n*r[3]+i*r[7]+r[15];return t[0]=.5-(n*r[0]+i*r[4]+r[12])/o,t[1]=(n*r[1]+i*r[5]+r[13])/o+.5,Math.abs(t[0])<1e-6&&(t[0]=0),Math.abs(t[1])<1e-6&&(t[1]=0),0!==A.enabledEffects&&t[0]>=0&&t[0]<1&&t[1]>=0&&t[1]<1&&s.transformPoint(A,t,t),t};class g{constructor(A,e){this._id=A,this._renderer=e,this._uniforms={u_modelMatrix:n.m4.identity(),u_silhouetteColor:g.color4fFromID(this._id)};const t=o.EFFECTS.length;for(let A=0;A<t;++A){const e=o.EFFECTS[A],t=o.EFFECT_INFO[e],n=t.converter;this._uniforms[t.uniformName]=n(0)}this._position=n.v3.create(0,0),this._scale=n.v3.create(100,100),this._transform=[],this._direction=90,this._transformDirty=!0,this._rotationMatrix=n.m4.identity(),this._rotationTransformDirty=!0,this._rotationAdjusted=n.v3.create(),this._rotationCenterDirty=!0,this._skinScale=n.v3.create(0,0,0),this._skinScaleDirty=!0,this._inverseMatrix=n.m4.identity(),this._inverseTransformDirty=!0,this._visible=!0,this.enabledEffects=0,this._convexHullPoints=null,this._convexHullDirty=!0,this._transformedHullPoints=null,this._transformedHullDirty=!0,this._skinWasAltered=this._skinWasAltered.bind(this),this.isTouching=this._isTouchingNever,this._highQuality=!1}setHighQuality(A){this._highQuality=A}dispose(){this.skin=null}setTransformDirty(){this._transformDirty=!0,this._inverseTransformDirty=!0,this._transformedHullDirty=!0}get id(){return this._id}get skin(){return this._skin}set skin(A){this._skin!==A&&(this._skin=A,this._skinWasAltered())}get scale(){return[this._scale[0],this._scale[1]]}get transform(){return this._transform}getUniforms(){return this._transformDirty&&this._calculateTransform(),this._uniforms}getVisible(){return this._visible}updatePosition(A){this._position[0]===A[0]&&this._position[1]===A[1]||(this._highQuality?(this._position[0]=A[0],this._position[1]=A[1]):(this._position[0]=Math.round(A[0]),this._position[1]=Math.round(A[1])),this._renderer.dirty=!0,this.setTransformDirty())}updateDirection(A){this._direction!==A&&(this._direction=A,this._renderer.dirty=!0,this._rotationTransformDirty=!0,this.setTransformDirty())}updateScale(A){this._scale[0]===A[0]&&this._scale[1]===A[1]||(this._scale[0]=A[0],this._scale[1]=A[1],this._renderer.dirty=!0,this._rotationCenterDirty=!0,this._skinScaleDirty=!0,this.setTransformDirty())}updateTransform(A){this._transform=A,this._renderer.dirty=!0,this._rotationCenterDirty=!0,this._skinScaleDirty=!0,this.setTransformDirty()}updateVisible(A){this._visible!==A&&(this._visible=A,this._renderer.dirty=!0,this.setConvexHullDirty())}updateEffect(A,e){this._renderer.dirty=!0;const t=o.EFFECT_INFO[A];e?this.enabledEffects|=t.mask:this.enabledEffects&=~t.mask;const n=t.converter;this._uniforms[t.uniformName]=n(e),t.shapeChanges&&this.setConvexHullDirty()}updateProperties(A){"position"in A&&this.updatePosition(A.position),"direction"in A&&this.updateDirection(A.direction),"scale"in A&&this.updateScale(A.scale),"visible"in A&&this.updateVisible(A.visible);const e=o.EFFECTS.length;for(let t=0;t<e;++t){const e=o.EFFECTS[t];e in A&&this.updateEffect(e,A[e])}}transformBeforeCheckViewport(){return this._rotationCenterDirty||this._skinScaleDirty}inViewport(A,e){const t=~~(this._position[0]+.5-this._rotationAdjusted[0]),n=~~(this._position[1]+.5-this._rotationAdjusted[1]),i=~~(this._skinScale[0]/2+.5),r=~~(this._skinScale[1]/2+.5),o=Math.max(i,r);return!(t+i+o<-A||n-r-o>e)&&!(t-i-o>A||n+r+o<-e)}_calculateTransform(){if(this._rotationTransformDirty){const A=(270-this._direction)*Math.PI/180,e=Math.cos(A),t=Math.sin(A);this._rotationMatrix[0]=e,this._rotationMatrix[1]=t,this._rotationMatrix[4]=-t,this._rotationMatrix[5]=e,this._rotationTransformDirty=!1}if(this._rotationCenterDirty&&null!==this.skin){const A=this.skin.rotationCenter,e=this.skin.size,t=A[0],n=A[1],i=e[0],r=e[1],o=this._scale[0],s=this._scale[1],a=this._rotationAdjusted;a[0]=(t-i/2)*o/100,a[1]=(n-r/2)*s/100*-1,this._rotationCenterDirty=!1}if(this._skinScaleDirty&&null!==this.skin){const A=this.skin.size,e=this._skinScale;e[0]=A[0]*this._scale[0]/100,e[1]=A[1]*this._scale[1]/100,this._skinScaleDirty=!1}const A=this._uniforms.u_modelMatrix,e=this._skinScale[0],t=this._skinScale[1],n=this._rotationMatrix[0],i=this._rotationMatrix[1],r=this._rotationMatrix[4],o=this._rotationMatrix[5],s=this._rotationAdjusted[0],a=this._rotationAdjusted[1],B=this._position[0],c=this._position[1];A[0]=e*n,A[1]=e*i,A[4]=t*r,A[5]=t*o,A[12]=n*s+r*a+B,A[13]=i*s+o*a+c,this._transformDirty=!1}needsConvexHullPoints(){return!this._convexHullPoints||this._convexHullDirty||0===this._convexHullPoints.length}setConvexHullDirty(){this._convexHullDirty=!0}setConvexHullPoints(A){this._convexHullPoints=A,this._convexHullDirty=!1,this._transformedHullPoints=[];for(let e=0;e<A.length;e++)this._transformedHullPoints.push(n.v3.create());this._transformedHullDirty=!0}_isTouchingNever(A){return!1}_isTouchingNearest(A){return this.skin.isTouchingNearest(c(this,A))}_isTouchingLinear(A){return this.skin.isTouchingLinear(c(this,A))}getBounds(A){if(this.needsConvexHullPoints())throw new Error("Needs updated convex hull points before bounds calculation.");this._transformDirty&&this._calculateTransform();const e=this._getTransformedHullPoints();return(A=A||new i).initFromPointsAABB(e),A}getBoundsForBubble(A){if(this.needsConvexHullPoints())throw new Error("Needs updated convex hull points before bubble bounds calculation.");this._transformDirty&&this._calculateTransform();const e=this._getTransformedHullPoints(),t=Math.max.apply(null,e.map(A=>A[1])),n=e.filter(A=>A[1]>t-8);return(A=A||new i).initFromPointsAABB(n),A}getAABB(A){this._transformDirty&&this._calculateTransform();const e=this._uniforms.u_modelMatrix;return(A=A||new i).initFromModelMatrix(e),A}getFastBounds(A){return this.needsConvexHullPoints()?this.getAABB(A):this.getBounds(A)}_getTransformedHullPoints(){if(!this._transformedHullDirty)return this._transformedHullPoints;const A=n.m4.ortho(-1,1,-1,1,-1,1),e=this.skin.size,t=1/e[0]/2,i=1/e[1]/2,r=n.m4.multiply(this._uniforms.u_modelMatrix,A);for(let A=0;A<this._convexHullPoints.length;A++){const o=this._convexHullPoints[A],s=this._transformedHullPoints[A];s[0]=.5+-o[0]/e[0]-t,s[1]=o[1]/e[1]-.5+i,n.m4.transformPoint(r,s,s)}return this._transformedHullDirty=!1,this._transformedHullPoints}updateMatrix(){if(this._transformDirty&&this._calculateTransform(),this._inverseTransformDirty){const A=this._inverseMatrix;n.m4.copy(this._uniforms.u_modelMatrix,A),A[10]=1,n.m4.inverse(A,A),this._inverseTransformDirty=!1}}updateCPURenderAttributes(){this.updateMatrix(),this.skin?(this.skin.updateSilhouette(this._scale),this.skin.useNearest(this._scale,this)?this.isTouching=this._isTouchingNearest:this.isTouching=this._isTouchingLinear):(a.warn("Could not find skin for drawable with id: ".concat(this._id)),this.isTouching=this._isTouchingNever)}_skinWasAltered(){this._renderer.dirty=!0,this._rotationCenterDirty=!0,this._skinScaleDirty=!0,this.setConvexHullDirty(),this.setTransformDirty()}static color4fFromID(A){return[((A-=r.ID_NONE)>>0&255)/255,(A>>8&255)/255,(A>>16&255)/255,1]}static color3bToID(A,e,t){let n;return n=(255&A)<<0,n|=(255&e)<<8,n|=(255&t)<<16,n+r.ID_NONE}static sampleColor4b(A,e,t,n){const i=c(e,A);if(i[0]<0||i[1]<0||i[0]>1||i[1]>1)return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t;const r=e.skin._silhouette.colorAtNearest(i,t);return 0===e.enabledEffects?r:s.transformColor(e,r,n)}}A.exports=g},function(A,e){A.exports="precision mediump float;\n\n#ifdef DRAW_MODE_line\nuniform vec2 u_stageSize;\nattribute vec2 a_lineThicknessAndLength;\nattribute vec4 a_penPoints;\nattribute vec4 a_lineColor;\n\nvarying vec4 v_lineColor;\nvarying float v_lineThickness;\nvarying float v_lineLength;\nvarying vec4 v_penPoints;\n\n// Add this to divisors to prevent division by 0, which results in NaNs propagating through calculations.\n// Smaller values can cause problems on some mobile devices.\nconst float epsilon = 1e-3;\n#endif\n\n#if !(defined(DRAW_MODE_line) || defined(DRAW_MODE_background))\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_modelMatrix;\nattribute vec2 a_texCoord;\n#endif\n\nattribute vec2 a_position;\n\nvarying vec2 v_texCoord;\n\nvoid main() {\n\t#ifdef DRAW_MODE_line\n\t// Calculate a rotated (\"tight\") bounding box around the two pen points.\n\t// Yes, we're doing this 6 times (once per vertex), but on actual GPU hardware,\n\t// it's still faster than doing it in JS combined with the cost of uniformMatrix4fv.\n\n\t// Expand line bounds by sqrt(2) / 2 each side-- this ensures that all antialiased pixels\n\t// fall within the quad, even at a 45-degree diagonal\n\tvec2 position = a_position;\n\tfloat expandedRadius = (a_lineThicknessAndLength.x * 0.5) + 1.4142135623730951;\n\n\t// The X coordinate increases along the length of the line. It's 0 at the center of the origin point\n\t// and is in pixel-space (so at n pixels along the line, its value is n).\n\tv_texCoord.x = mix(0.0, a_lineThicknessAndLength.y + (expandedRadius * 2.0), a_position.x) - expandedRadius;\n\t// The Y coordinate is perpendicular to the line. It's also in pixel-space.\n\tv_texCoord.y = ((a_position.y - 0.5) * expandedRadius) + 0.5;\n\n\tposition.x *= a_lineThicknessAndLength.y + (2.0 * expandedRadius);\n\tposition.y *= 2.0 * expandedRadius;\n\n\t// 1. Center around first pen point\n\tposition -= expandedRadius;\n\n\t// 2. Rotate quad to line angle\n\tvec2 pointDiff = a_penPoints.zw;\n\t// Ensure line has a nonzero length so it's rendered properly\n\t// As long as either component is nonzero, the line length will be nonzero\n\t// If the line is zero-length, give it a bit of horizontal length\n\tpointDiff.x = (abs(pointDiff.x) < epsilon && abs(pointDiff.y) < epsilon) ? epsilon : pointDiff.x;\n\t// The `normalized` vector holds rotational values equivalent to sine/cosine\n\t// We're applying the standard rotation matrix formula to the position to rotate the quad to the line angle\n\t// pointDiff can hold large values so we must divide by u_lineLength instead of calling GLSL's normalize function:\n\t// https://asawicki.info/news_1596_watch_out_for_reduced_precision_normalizelength_in_opengl_es\n\tvec2 normalized = pointDiff / max(a_lineThicknessAndLength.y, epsilon);\n\tposition = mat2(normalized.x, normalized.y, -normalized.y, normalized.x) * position;\n\n\t// 3. Translate quad\n\tposition += a_penPoints.xy;\n\n\t// 4. Apply view transform\n\tposition *= 2.0 / u_stageSize;\n\tgl_Position = vec4(position, 0, 1);\n\n\tv_lineColor = a_lineColor;\n\tv_lineThickness = a_lineThicknessAndLength.x;\n\tv_lineLength = a_lineThicknessAndLength.y;\n\tv_penPoints = a_penPoints;\n\t#elif defined(DRAW_MODE_background)\n\tgl_Position = vec4(a_position * 2.0, 0, 1);\n\t#else\n\tgl_Position = u_projectionMatrix * u_modelMatrix * vec4(a_position, 0, 1);\n\tv_texCoord = a_texCoord;\n\t#endif\n}\n"},function(A,e){A.exports='precision mediump float;\n\n#ifdef DRAW_MODE_silhouette\nuniform vec4 u_silhouetteColor;\n#else // DRAW_MODE_silhouette\n# ifdef ENABLE_color\nuniform float u_color;\n# endif // ENABLE_color\n# ifdef ENABLE_brightness\nuniform float u_brightness;\n# endif // ENABLE_brightness\n#endif // DRAW_MODE_silhouette\n\n#ifdef DRAW_MODE_colorMask\nuniform vec3 u_colorMask;\nuniform float u_colorMaskTolerance;\n#endif // DRAW_MODE_colorMask\n\n#ifdef ENABLE_fisheye\nuniform float u_fisheye;\n#endif // ENABLE_fisheye\n#ifdef ENABLE_whirl\nuniform float u_whirl;\n#endif // ENABLE_whirl\n#ifdef ENABLE_pixelate\nuniform float u_pixelate;\nuniform vec2 u_skinSize;\n#endif // ENABLE_pixelate\n#ifdef ENABLE_mosaic\nuniform float u_mosaic;\n#endif // ENABLE_mosaic\n#ifdef ENABLE_ghost\nuniform float u_ghost;\n#endif // ENABLE_ghost\n#ifdef ENABLE_red\nuniform float u_red;\n#endif // ENABLE_red\n#ifdef ENABLE_green\nuniform float u_green;\n#endif // ENABLE_green\n#ifdef ENABLE_blue\nuniform float u_blue;\n#endif // ENABLE_blue\n#ifdef ENABLE_opaque\nuniform float u_opaque;\n#endif // ENABLE_opaque\n#ifdef ENABLE_saturation\nuniform float u_saturation;\n#endif // ENABLE_saturation\n#ifdef ENABLE_tintColor\nuniform highp float u_tintColor;\n#endif // ENABLE_tintColor\n\n#ifdef DRAW_MODE_line\nvarying vec4 v_lineColor;\nvarying float v_lineThickness;\nvarying float v_lineLength;\n#endif // DRAW_MODE_line\n\n#ifdef DRAW_MODE_background\nuniform vec4 u_backgroundColor;\n#endif // DRAW_MODE_background\n\nuniform sampler2D u_skin;\n\n#ifndef DRAW_MODE_background\nvarying vec2 v_texCoord;\n#endif\n\n// Add this to divisors to prevent division by 0, which results in NaNs propagating through calculations.\n// Smaller values can cause problems on some mobile devices.\nconst float epsilon = 1e-3;\n\n#if !defined(DRAW_MODE_silhouette) && (defined(ENABLE_color) || defined(ENABLE_saturation) || defined(ENABLE_tintColor))\n// Branchless color conversions based on code from:\n// http://www.chilliant.com/rgb2hsv.html by Ian Taylor\n// Based in part on work by Sam Hocevar and Emil Persson\n// See also: https://en.wikipedia.org/wiki/HSL_and_HSV#Formal_derivation\n\n\n// Convert an RGB color to Hue, Saturation, and Value.\n// All components of input and output are expected to be in the [0,1] range.\nvec3 convertRGB2HSV(vec3 rgb)\n{\n\t// Hue calculation has 3 cases, depending on which RGB component is largest, and one of those cases involves a "mod"\n\t// operation. In order to avoid that "mod" we split the M==R case in two: one for G<B and one for B>G. The B>G case\n\t// will be calculated in the negative and fed through abs() in the hue calculation at the end.\n\t// See also: https://en.wikipedia.org/wiki/HSL_and_HSV#Hue_and_chroma\n\tconst vec4 hueOffsets = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n\n\t// temp1.xy = sort B & G (largest first)\n\t// temp1.z = the hue offset we\'ll use if it turns out that R is the largest component (M==R)\n\t// temp1.w = the hue offset we\'ll use if it turns out that R is not the largest component (M==G or M==B)\n\tvec4 temp1 = rgb.b > rgb.g ? vec4(rgb.bg, hueOffsets.wz) : vec4(rgb.gb, hueOffsets.xy);\n\n\t// temp2.x = the largest component of RGB ("M" / "Max")\n\t// temp2.yw = the smaller components of RGB, ordered for the hue calculation (not necessarily sorted by magnitude!)\n\t// temp2.z = the hue offset we\'ll use in the hue calculation\n\tvec4 temp2 = rgb.r > temp1.x ? vec4(rgb.r, temp1.yzx) : vec4(temp1.xyw, rgb.r);\n\n\t// m = the smallest component of RGB ("min")\n\tfloat m = min(temp2.y, temp2.w);\n\n\t// Chroma = M - m\n\tfloat C = temp2.x - m;\n\n\t// Value = M\n\tfloat V = temp2.x;\n\n\treturn vec3(\n\t\tabs(temp2.z + (temp2.w - temp2.y) / (6.0 * C + epsilon)), // Hue\n\t\tC / (temp2.x + epsilon), // Saturation\n\t\tV); // Value\n}\n\nvec3 convertHue2RGB(float hue)\n{\n\tfloat r = abs(hue * 6.0 - 3.0) - 1.0;\n\tfloat g = 2.0 - abs(hue * 6.0 - 2.0);\n\tfloat b = 2.0 - abs(hue * 6.0 - 4.0);\n\treturn clamp(vec3(r, g, b), 0.0, 1.0);\n}\n\nvec3 convertHSV2RGB(vec3 hsv)\n{\n\tvec3 rgb = convertHue2RGB(hsv.x);\n\tfloat c = hsv.z * hsv.y;\n\treturn rgb * c + hsv.z - c;\n}\n\nvec3 decimalToRGB(highp float decimalColor) {\n\thighp float blue = mod(decimalColor, 256.0) / 255.0;\n\thighp float green = mod(floor(decimalColor / 256.0), 256.0) / 255.0;\n\thighp float red = mod(floor(decimalColor / 65536.0), 256.0) / 255.0;\n\n\treturn vec3(red, green, blue);\n}\n#endif // !defined(DRAW_MODE_silhouette) && (defined(ENABLE_color) || defined(ENABLE_saturation) || defined(ENABLE_tintColor))\n\nconst vec2 kCenter = vec2(0.5, 0.5);\n\nvoid main()\n{\n\t#if !(defined(DRAW_MODE_line) || defined(DRAW_MODE_background))\n\tvec2 texcoord0 = v_texCoord;\n\n\t#ifdef ENABLE_mosaic\n\ttexcoord0 = fract(u_mosaic * texcoord0);\n\t#endif // ENABLE_mosaic\n\n\t#ifdef ENABLE_pixelate\n\t{\n\t\t// TODO: clean up "pixel" edges\n\t\tvec2 pixelTexelSize = u_skinSize / u_pixelate;\n\t\ttexcoord0 = (floor(texcoord0 * pixelTexelSize) + kCenter) / pixelTexelSize;\n\t}\n\t#endif // ENABLE_pixelate\n\n\t#ifdef ENABLE_whirl\n\t{\n\t\tconst float kRadius = 0.5;\n\t\tvec2 offset = texcoord0 - kCenter;\n\t\tfloat offsetMagnitude = length(offset);\n\t\tfloat whirlFactor = max(1.0 - (offsetMagnitude / kRadius), 0.0);\n\t\tfloat whirlActual = u_whirl * whirlFactor * whirlFactor;\n\t\tfloat sinWhirl = sin(whirlActual);\n\t\tfloat cosWhirl = cos(whirlActual);\n\t\tmat2 rotationMatrix = mat2(\n\t\t\tcosWhirl, -sinWhirl,\n\t\t\tsinWhirl, cosWhirl\n\t\t);\n\n\t\ttexcoord0 = rotationMatrix * offset + kCenter;\n\t}\n\t#endif // ENABLE_whirl\n\n\t#ifdef ENABLE_fisheye\n\t{\n\t\tvec2 vec = (texcoord0 - kCenter) / kCenter;\n\t\tfloat vecLength = length(vec);\n\t\tfloat r = pow(min(vecLength, 1.0), u_fisheye) * max(1.0, vecLength);\n\t\tvec2 unit = vec / vecLength;\n\n\t\ttexcoord0 = kCenter + r * unit * kCenter;\n\t}\n\t#endif // ENABLE_fisheye\n\n\tgl_FragColor = texture2D(u_skin, texcoord0);\n\n\t#if defined(ENABLE_color) || defined(ENABLE_brightness) || defined(ENABLE_saturation) || defined(ENABLE_tintColor)\n\t// Divide premultiplied alpha values for proper color processing\n\t// Add epsilon to avoid dividing by 0 for fully transparent pixels\n\tgl_FragColor.rgb = clamp(gl_FragColor.rgb / (gl_FragColor.a + epsilon), 0.0, 1.0);\n\n\t#ifdef ENABLE_color\n\t{\n\t\tvec3 hsv = convertRGB2HSV(gl_FragColor.xyz);\n\n\t\t// this code forces grayscale values to be slightly saturated\n\t\t// so that some slight change of hue will be visible\n\t\t\n\t\t// pm: this usually ends up looking ugly in menus and such, so dont do this actually\n\t\t// \t   this might be reverted to do this again though if it is genuinely better\n\n\t\t// const float minLightness = 0.11 / 2.0;\n\t\t// const float minSaturation = 0.09;\n\t\t// if (hsv.z < minLightness) hsv = vec3(0.0, 1.0, minLightness);\n\t\t// else if (hsv.y < minSaturation) hsv = vec3(0.0, minSaturation, hsv.z);\n\n\t\thsv.x = mod(hsv.x + u_color, 1.0);\n\t\tif (hsv.x < 0.0) hsv.x += 1.0;\n\n\t\tgl_FragColor.rgb = convertHSV2RGB(hsv);\n\t}\n\t#endif // ENABLE_color\n\t\n\t#ifdef ENABLE_saturation\n\t{\n\t\tvec3 hsv = convertRGB2HSV(gl_FragColor.xyz);\n\n\t\thsv.y *= u_saturation;\n\n\t\tgl_FragColor.rgb = convertHSV2RGB(hsv);\n\t}\n\t#endif // ENABLE_saturation\n\t\n\t#ifdef ENABLE_tintColor\n\t{\n\t\tvec3 tintRgb = decimalToRGB(u_tintColor);\n\n\t\tgl_FragColor.rgb *= tintRgb;\n\t}\n\t#endif // ENABLE_tintColor\n\n\t#ifdef ENABLE_brightness\n\tgl_FragColor.rgb = clamp(gl_FragColor.rgb + vec3(u_brightness), vec3(0), vec3(1));\n\t#endif // ENABLE_brightness\n\n\t// Re-multiply color values\n\tgl_FragColor.rgb *= gl_FragColor.a + epsilon;\n\n\t#endif // defined(ENABLE_color) || defined(ENABLE_brightness) || defined(ENABLE_saturation) || defined(ENABLE_tintColor)\n\n\t#ifdef ENABLE_ghost\n\tgl_FragColor *= u_ghost;\n\t#endif // ENABLE_ghost\n\t\n\t#ifdef ENABLE_red\n\tgl_FragColor.r *= u_red;\n\t#endif // ENABLE_red\n\t\n\t#ifdef ENABLE_green\n\tgl_FragColor.g *= u_green;\n\t#endif // ENABLE_green\n\t\n\t#ifdef ENABLE_blue\n\tgl_FragColor.b *= u_blue;\n\t#endif // ENABLE_blue\n\t\n\t#ifdef ENABLE_opaque\n\tgl_FragColor.a *= u_opaque;\n\t#endif // ENABLE_opaque\n\n\t#ifdef DRAW_MODE_silhouette\n\t// Discard fully transparent pixels for stencil test\n\tif (gl_FragColor.a == 0.0) {\n\t\tdiscard;\n\t}\n\t// switch to u_silhouetteColor only AFTER the alpha test\n\tgl_FragColor = u_silhouetteColor;\n\t#else // DRAW_MODE_silhouette\n\n\t#ifdef DRAW_MODE_colorMask\n\tvec3 maskDistance = abs(gl_FragColor.rgb - u_colorMask);\n\tvec3 colorMaskTolerance = vec3(u_colorMaskTolerance, u_colorMaskTolerance, u_colorMaskTolerance);\n\tif (any(greaterThan(maskDistance, colorMaskTolerance)))\n\t{\n\t\tdiscard;\n\t}\n\t#endif // DRAW_MODE_colorMask\n\t#endif // DRAW_MODE_silhouette\n\n\t#ifdef DRAW_MODE_straightAlpha\n\t// Un-premultiply alpha.\n\tgl_FragColor.rgb /= gl_FragColor.a + epsilon;\n\t#endif\n\n\t#endif // !(defined(DRAW_MODE_line) || defined(DRAW_MODE_background))\n\n\t#ifdef DRAW_MODE_line\n\t// Maaaaagic antialiased-line-with-round-caps shader.\n\n\t// "along-the-lineness". This increases parallel to the line.\n\t// It goes from negative before the start point, to 0.5 through the start to the end, then ramps up again\n\t// past the end point.\n\tfloat d = ((v_texCoord.x - clamp(v_texCoord.x, 0.0, v_lineLength)) * 0.5) + 0.5;\n\n\t// Distance from (0.5, 0.5) to (d, the perpendicular coordinate). When we\'re in the middle of the line,\n\t// d will be 0.5, so the distance will be 0 at points close to the line and will grow at points further from it.\n\t// For the "caps", d will ramp down/up, giving us rounding.\n\t// See https://www.youtube.com/watch?v=PMltMdi1Wzg for a rough outline of the technique used to round the lines.\n\tfloat line = distance(vec2(0.5), vec2(d, v_texCoord.y)) * 2.0;\n\t// Expand out the line by its thickness.\n\tline -= ((v_lineThickness - 1.0) * 0.5);\n\t// Because "distance to the center of the line" decreases the closer we get to the line, but we want more opacity\n\t// the closer we are to the line, invert it.\n\tgl_FragColor = v_lineColor * clamp(1.0 - line, 0.0, 1.0);\n\t#endif // DRAW_MODE_line\n\n\t#ifdef DRAW_MODE_background\n\tgl_FragColor = u_backgroundColor;\n\t#endif\n}\n'},function(A,e){A.exports={rgbToHsv:(A,e)=>{let[t,n,i]=A,r=0;t/=255,n/=255,i/=255;let o=0;n<i&&(o=n,n=i,i=o,r=-1),t<n&&(o=t,t=n,n=o,r=-2/6-r);const s=t-Math.min(n,i),a=Math.abs(r+(n-i)/(6*s+Number.EPSILON)),B=s/(t+Number.EPSILON),c=t;return e[0]=a,e[1]=B,e[2]=c,e},hsvToRgb:(A,e)=>{let[t,n,i]=A;if(0===n)return e[0]=e[1]=e[2]=255*i+.5,e;t%=1;const r=6*t|0,o=6*t-r,s=i*(1-n),a=i*(1-n*o),B=i*(1-n*(1-o));let c=0,g=0,E=0;switch(r){case 0:c=i,g=B,E=s;break;case 1:c=a,g=i,E=s;break;case 2:c=s,g=i,E=B;break;case 3:c=s,g=a,E=i;break;case 4:c=B,g=s,E=i;break;case 5:c=i,g=s,E=a}return e[0]=255*c+.5,e[1]=255*g+.5,e[2]=255*E+.5,e}}},function(A,e,t){const n=t(17),i=t(50),r=t(29),o=t(39),s={color4f:[0,0,1,1],diameter:1};A.exports=class extends r{constructor(A,e){super(A,e),this._size=null,this._framebuffer=null,this._silhouetteDirty=!1,this._silhouettePixels=null,this._silhouetteImageData=null,this._lineOnBufferDrawRegionId={enter:()=>this._enterDrawLineOnBuffer(),exit:()=>this._exitDrawLineOnBuffer()},this._usePenBufferDrawRegionId={enter:()=>this._enterUsePenBuffer(),exit:()=>this._exitUsePenBuffer()};const t=this._renderer.gl;this.renderQuality=1,this._nativeSize=e.getNativeSize();if(this._lineShader=this._renderer._shaderManager.getShader(o.DRAW_MODE.line,0),this._drawTextureShader=this._renderer._shaderManager.getShader(o.DRAW_MODE.default,0),this._drawTextureRegionId={enter:()=>this._enterDrawTexture(),exit:()=>this._exitDrawTexture()},this.a_position_glbuffer=t.createBuffer(),this.a_position_loc=t.getAttribLocation(this._lineShader.program,"a_position"),this.a_lineColor_loc=t.getAttribLocation(this._lineShader.program,"a_lineColor"),this.a_lineThicknessAndLength_loc=t.getAttribLocation(this._lineShader.program,"a_lineThicknessAndLength"),this.a_penPoints_loc=t.getAttribLocation(this._lineShader.program,"a_penPoints"),this.attribute_glbuffer=t.createBuffer(),this.attribute_index=0,this.attribute_data=new Float32Array(163800),t.bindBuffer(t.ARRAY_BUFFER,this.attribute_glbuffer),t.bufferData(t.ARRAY_BUFFER,4*this.attribute_data.length,t.STREAM_DRAW),t.drawArraysInstanced)this.instancedRendering=!0,this.glDrawArraysInstanced=t.drawArraysInstanced.bind(t),this.glVertexAttribDivisor=t.vertexAttribDivisor.bind(t);else{const A=t.getExtension("ANGLE_instanced_arrays");A?(this.instancedRendering=!0,this.glDrawArraysInstanced=A.drawArraysInstancedANGLE.bind(A),this.glVertexAttribDivisor=A.vertexAttribDivisorANGLE.bind(A)):this.instancedRendering=!1}if(this.instancedRendering)t.bindBuffer(t.ARRAY_BUFFER,this.a_position_glbuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array([1,0,0,0,1,1,0,1]),t.STATIC_DRAW);else{const A=new Float32Array(32760);for(let e=0;e<A.length;e+=12)A[e+0]=1,A[e+1]=0,A[e+2]=0,A[e+3]=0,A[e+4]=1,A[e+5]=1,A[e+6]=1,A[e+7]=1,A[e+8]=0,A[e+9]=0,A[e+10]=0,A[e+11]=1;t.bindBuffer(t.ARRAY_BUFFER,this.a_position_glbuffer),t.bufferData(t.ARRAY_BUFFER,A,t.STATIC_DRAW)}this.onNativeSizeChanged=this.onNativeSizeChanged.bind(this),this._renderer.on(i.Events.NativeSizeChanged,this.onNativeSizeChanged),this._setCanvasSize(e.getNativeSize())}dispose(){this._renderer.removeListener(i.Events.NativeSizeChanged,this.onNativeSizeChanged),this._renderer.gl.deleteTexture(this._texture),this._texture=null,super.dispose()}get size(){return this._nativeSize}useNearest(A){return Math.max(A[0],A[1])>=100}getTexture(A,e){return this._texture}clear(){this._renderer.enterDrawRegion(this._usePenBufferDrawRegionId);const A=this._renderer.gl;A.clearColor(0,0,0,0),A.clear(A.COLOR_BUFFER_BIT),this._silhouetteDirty=!0}drawPoint(A,e,t){this.drawLine(A,e,t,e,t)}drawLine(A,e,t,n,i){const r=A.diameter||s.diameter,o=1===r||3===r?.5:0;this._drawLineOnBuffer(A,e+o,t+o,n+o,i+o),this._silhouetteDirty=!0}_enterDrawLineOnBuffer(){const A=this._renderer.gl;n.bindFramebufferInfo(A,this._framebuffer),A.viewport(0,0,this._size[0],this._size[1]);const e=this._lineShader;A.useProgram(e.program);const t={u_skin:this._texture,u_stageSize:this._size};n.setUniforms(e,t),A.bindBuffer(A.ARRAY_BUFFER,this.a_position_glbuffer),A.enableVertexAttribArray(this.a_position_loc),A.vertexAttribPointer(this.a_position_loc,2,A.FLOAT,!1,8,0),this.attribute_index=0}_exitDrawLineOnBuffer(){this.attribute_index&&this._flushLines();const A=this._renderer.gl;n.bindFramebufferInfo(A,null)}_enterUsePenBuffer(){n.bindFramebufferInfo(this._renderer.gl,this._framebuffer)}_exitUsePenBuffer(){n.bindFramebufferInfo(this._renderer.gl,null)}_enterDrawTexture(){this._enterUsePenBuffer();const A=this._renderer.gl;A.viewport(0,0,this._size[0],this._size[1]),A.useProgram(this._drawTextureShader.program),n.setBuffersAndAttributes(A,this._drawTextureShader,this._renderer._bufferInfo)}_exitDrawTexture(){this._exitUsePenBuffer()}_drawPenTexture(A){this._renderer.enterDrawRegion(this._drawTextureRegionId);const e=this._renderer.gl,t=this._size[0],i=this._size[1],r={u_skin:A,u_projectionMatrix:n.m4.ortho(t/2,t/-2,i/-2,i/2,-1,1,n.m4.identity()),u_modelMatrix:n.m4.scaling(n.v3.create(t,i,0),n.m4.identity())};n.setTextureParameters(e,A,{minMag:e.NEAREST}),n.setUniforms(this._drawTextureShader,r),n.drawBufferInfo(e,this._renderer._bufferInfo,e.TRIANGLES)}_drawLineOnBuffer(A,e,t,n,i){this._renderer.enterDrawRegion(this._lineOnBufferDrawRegionId);const r=this.instancedRendering?1:6;this.attribute_index+10*r>163800&&this._flushLines();const o=A.color4f||s.color4f;e*=this.renderQuality,t*=this.renderQuality;const a=(n*=this.renderQuality)-e,B=(i*=this.renderQuality)-t,c=Math.sqrt(a*a+B*B),g=(A.diameter||s.diameter)*this.renderQuality;for(let A=0;A<r;A++)this.attribute_data[this.attribute_index]=o[0]*o[3],this.attribute_index++,this.attribute_data[this.attribute_index]=o[1]*o[3],this.attribute_index++,this.attribute_data[this.attribute_index]=o[2]*o[3],this.attribute_index++,this.attribute_data[this.attribute_index]=o[3],this.attribute_index++,this.attribute_data[this.attribute_index]=g,this.attribute_index++,this.attribute_data[this.attribute_index]=c,this.attribute_index++,this.attribute_data[this.attribute_index]=e,this.attribute_index++,this.attribute_data[this.attribute_index]=-t,this.attribute_index++,this.attribute_data[this.attribute_index]=a,this.attribute_index++,this.attribute_data[this.attribute_index]=-B,this.attribute_index++}_flushLines(){const A=this._renderer.gl;A.bindBuffer(A.ARRAY_BUFFER,this.attribute_glbuffer),A.bufferSubData(A.ARRAY_BUFFER,0,new Float32Array(this.attribute_data.buffer,0,this.attribute_index)),A.enableVertexAttribArray(this.a_lineColor_loc),A.vertexAttribPointer(this.a_lineColor_loc,4,A.FLOAT,!1,40,0),A.enableVertexAttribArray(this.a_lineThicknessAndLength_loc),A.vertexAttribPointer(this.a_lineThicknessAndLength_loc,2,A.FLOAT,!1,40,16),A.enableVertexAttribArray(this.a_penPoints_loc),A.vertexAttribPointer(this.a_penPoints_loc,4,A.FLOAT,!1,40,24),this.instancedRendering?(this.glVertexAttribDivisor(this.a_lineColor_loc,1),this.glVertexAttribDivisor(this.a_lineThicknessAndLength_loc,1),this.glVertexAttribDivisor(this.a_penPoints_loc,1),this.glDrawArraysInstanced(A.TRIANGLE_STRIP,0,4,this.attribute_index/10),this.glVertexAttribDivisor(this.a_lineColor_loc,0),this.glVertexAttribDivisor(this.a_lineThicknessAndLength_loc,0),this.glVertexAttribDivisor(this.a_penPoints_loc,0)):A.drawArrays(A.TRIANGLES,0,this.attribute_index/10),this.attribute_index=0,this._silhouetteDirty=!0}onNativeSizeChanged(A){this._nativeSize=A.newSize,this._setCanvasSize([A.newSize[0]*this.renderQuality,A.newSize[1]*this.renderQuality]),this.emitWasAltered()}_setCanvasSize(A){const[e,t]=A;if(this._size&&this._size[0]===e&&this._size[1]===t)return;this._size=A,this._rotationCenter[0]=this._nativeSize[0]/2,this._rotationCenter[1]=this._nativeSize[1]/2;const i=this._renderer.gl,r=this._texture;this._texture=n.createTexture(i,{mag:i.NEAREST,min:i.NEAREST,wrap:i.CLAMP_TO_EDGE,width:e,height:t});const o=[{format:i.RGBA,attachment:this._texture}];this._framebuffer,this._framebuffer=n.createFramebufferInfo(i,o,e,t),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT),r&&this._drawPenTexture(r),this._silhouettePixels=new Uint8Array(Math.floor(e*t*4)),this._silhouetteImageData=new ImageData(e,t),this._silhouetteDirty=!0}setRenderQuality(A){this.renderQuality!==A&&(this.renderQuality=A,this._setCanvasSize([Math.round(this._nativeSize[0]*A),Math.round(this._nativeSize[1]*A)]))}updateSilhouette(){if(this._silhouetteDirty){this._renderer.enterDrawRegion(this._usePenBufferDrawRegionId);const A=this._renderer.gl;A.readPixels(0,0,this._size[0],this._size[1],A.RGBA,A.UNSIGNED_BYTE,this._silhouettePixels),this._silhouetteImageData.data.set(this._silhouettePixels),this._silhouette.update(this._silhouetteImageData,!0),this._silhouetteDirty=!1}}updatePenPointOffset(A,e,t,n){for(let i=0;i<24;i+=4)this.a_cameraOffset[i+0]=A,this.a_cameraOffset[i+1]=e,this.a_cameraOffset[i+2]=t,this.a_cameraOffset[i+3]=n;this._silhouetteDirty=!0}}},function(A,e,t){const n=t(17),i=t(29),{loadSvgString:r,serializeSvgToString:o}=t(31),s=t(39);A.exports=class extends i{constructor(A,e){super(A,e),this._svgImage=document.createElement("img"),this._svgImageLoaded=!1,this._size=[0,0],this._transform=[0,0],this._canvas=document.createElement("canvas"),this._context=this._canvas.getContext("2d",{willReadFrequently:!0}),this._scaledMIPs=[],this._largestMIPScale=0,this._maxTextureScale=1}dispose(){this.resetMIPs(),super.dispose()}get size(){return[this._size[0],this._size[1]]}useNearest(A,e){return 0==(e.enabledEffects&(s.EFFECT_INFO.fisheye.mask|s.EFFECT_INFO.whirl.mask|s.EFFECT_INFO.pixelate.mask|s.EFFECT_INFO.mosaic.mask))&&(e._direction%90==0&&(Math.abs(A[0])>99&&Math.abs(A[0])<101&&Math.abs(A[1])>99&&Math.abs(A[1])<101))}createMIP(A,e){const t=this._largestMIPScale<A;t||this._silhouette.unlazy(),e||(e=[0,0]),e[0]||(e=[0,0]),e[1]||(e=[0,0]);const i=100*e[0]/200+1,r=100*e[1]/200+1,[o,s]=this._size;if(this._canvas.width=o*A*i,this._canvas.height=s*A*r,this._canvas.width<=0||this._canvas.height<=0||this._svgImage.naturalWidth<=0||this._svgImage.naturalHeight<=0)return super.getTexture();this._context.clearRect(0,0,this._canvas.width,this._canvas.height),this._context.setTransform(A,e[0],e[1],A,0,0),this._context.drawImage(this._svgImage,0,0);const a=this._canvas,B={auto:!1,wrap:this._renderer.gl.CLAMP_TO_EDGE,src:a,premultiplyAlpha:!0},c=n.createTexture(this._renderer.gl,B);return t&&(this._silhouette.update(a),this._largestMIPScale=A),c}updateSilhouette(){let A=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[100,100];this.getTexture(A),this._silhouette.unlazy()}getTexture(A,e){e||(e=[0,0]),"number"!=typeof e[0]&&(e=[0,0]),"number"!=typeof e[1]&&(e=[0,0]);const t=A?Math.max(Math.abs(A[0]),Math.abs(A[1])):100,n=Math.min(t/100,this._maxTextureScale),i=Math.max(Math.ceil(Math.log2(n))+8,0),r=Math.pow(2,i-8);return this._svgImageLoaded&&(this._scaledMIPs[i]&&this.isTransformEqual(this._transform,e)||(this._scaledMIPs[i]=this.createMIP(r,e||[0,0]),this._transform=e)),this._scaledMIPs[i]||super.getTexture()}isTransformEqual(A,e){if(!A)return!1;if(!e)return!1;let t=0;return A[0]===e[0]&&t++,A[1]===e[1]&&t++,2===t}resetMIPs(){this._scaledMIPs.forEach(A=>this._renderer.gl.deleteTexture(A)),this._scaledMIPs.length=0,this._largestMIPScale=0}setSVG(A,e){const t=r(A),n=o(t,this._renderer.customFonts);this._svgImageLoaded=!1;const{x:i,y:s,width:a,height:B}=t.viewBox.baseVal;this._size[0]=a,this._size[1]=B,this._svgImage.onload=()=>{if(0===a||0===B)return void super.setEmptyImageData();const A=Math.ceil(Math.max(a,B)),t=this._renderer.maxTextureDimension;let n=2;for(;A*n<=t;n*=2)this._maxTextureScale=n;this.resetMIPs(),void 0===e&&(e=this.calculateRotationCenter()),this._rotationCenter[0]=e[0]-i,this._rotationCenter[1]=e[1]-s,this._svgImageLoaded=!0,this.emitWasAltered()},this._svgImage.src="data:image/svg+xml;utf8,".concat(encodeURIComponent(n))}}},function(A,e,t){const n=t(17),i=t(72),r=t(29),o={MAX_LINE_WIDTH:170,MIN_WIDTH:50,STROKE_WIDTH:4,PADDING:10,CORNER_RADIUS:16,TAIL_HEIGHT:12,FONT:"Helvetica",FONT_SIZE:14,FONT_HEIGHT_RATIO:.9,LINE_HEIGHT:16,COLORS:{BUBBLE_FILL:"white",BUBBLE_STROKE:"rgba(0, 0, 0, 0.15)",TEXT_FILL:"#575E75"}};A.exports=class extends r{constructor(A,e){super(A,e),this._canvas=document.createElement("canvas"),this._size=[0,0],this._renderedScale=0,this._lines=[],this._textAreaSize={width:0,height:0},this._bubbleType="",this._pointsLeft=!1,this._textDirty=!0,this._textureDirty=!0,this.measurementProvider=new i(this._canvas.getContext("2d")),this.textWrapper=e.createTextWrapper(this.measurementProvider),this._props=o,this._restyleCanvas()}dispose(){this._texture&&(this._renderer.gl.deleteTexture(this._texture),this._texture=null),this._canvas=null,super.dispose()}get size(){return this._textDirty&&this._reflowLines(),this._size}setTextBubble(A,e,t,n){this._text=e,this._bubbleType=A,this._pointsLeft=t,"object"==typeof n&&(this._props=n),this._restyleCanvas(),this._textDirty=!0,this._textureDirty=!0,this.emitWasAltered()}_restyleCanvas(){this._canvas.getContext("2d").font="".concat(this._props.FONT_SIZE,"px ").concat(this._props.FONT,", sans-serif")}_reflowLines(){this._canvas.getContext("2d");this._lines=this.textWrapper.wrapText(this._props.MAX_LINE_WIDTH,this._text);let A=0;for(const e of this._lines)A=Math.max(A,this.measurementProvider.measureText(e));this._props.LINE_HEIGHT=1.23*this._props.FONT_SIZE;const e=Math.max(A,this._props.MIN_WIDTH)+2*this._props.PADDING,t=this._props.LINE_HEIGHT*this._lines.length+2*this._props.PADDING;this._textAreaSize.width=e,this._textAreaSize.height=t,this._size[0]=e+this._props.STROKE_WIDTH,this._size[1]=t+this._props.STROKE_WIDTH+this._props.TAIL_HEIGHT,this._textDirty=!1}_renderTextBubble(A){const e=this._canvas.getContext("2d");this._textDirty&&this._reflowLines();const t=this._textAreaSize.width,n=this._textAreaSize.height;this._canvas.width=Math.ceil(this._size[0]*A),this._canvas.height=Math.ceil(this._size[1]*A),this._restyleCanvas(),e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,this._canvas.width,this._canvas.height),e.scale(A,A),e.translate(.5*this._props.STROKE_WIDTH,.5*this._props.STROKE_WIDTH),e.save(),this._pointsLeft&&(e.scale(-1,1),e.translate(-t,0)),e.beginPath(),e.moveTo(this._props.CORNER_RADIUS,n),e.arcTo(0,n,0,n-this._props.CORNER_RADIUS,this._props.CORNER_RADIUS),e.arcTo(0,0,t,0,this._props.CORNER_RADIUS),e.arcTo(t,0,t,n,this._props.CORNER_RADIUS),e.arcTo(t,n,t-this._props.CORNER_RADIUS,n,this._props.CORNER_RADIUS),e.save(),e.translate(t-this._props.CORNER_RADIUS,n),"say"===this._bubbleType?(e.bezierCurveTo(0,4,4,8,4,10),e.arcTo(4,12,2,12,2),e.bezierCurveTo(-1,12,-11,8,-16,0),e.closePath()):(e.arc(-16,0,4,0,Math.PI),e.closePath(),e.moveTo(-7,7.25),e.arc(-9.25,7.25,2.25,0,2*Math.PI),e.moveTo(0,9.5),e.arc(-1.5,9.5,1.5,0,2*Math.PI)),e.restore(),e.fillStyle=this._props.COLORS.BUBBLE_FILL,e.strokeStyle=this._props.COLORS.BUBBLE_STROKE,e.lineWidth=this._props.STROKE_WIDTH,e.stroke(),e.fill(),e.restore(),e.fillStyle=this._props.COLORS.TEXT_FILL,e.font="".concat(this._props.FONT_SIZE,"px ").concat(this._props.FONT,", sans-serif");const i=this._lines;for(let A=0;A<i.length;A++){const t=i[A];e.fillText(t,this._props.PADDING,this._props.PADDING+this._props.LINE_HEIGHT*A+this._props.FONT_HEIGHT_RATIO*this._props.FONT_SIZE)}this._renderedScale=A}updateSilhouette(){let A=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[100,100];this.getTexture(A)}getTexture(A){const e=A?Math.max(Math.abs(A[0]),Math.abs(A[1])):100,t=Math.min(10,e/100);if(this._textureDirty||this._renderedScale!==t){this._renderTextBubble(t),this._textureDirty=!1;const A=this._canvas.getContext("2d").getImageData(0,0,this._canvas.width,this._canvas.height),e=this._renderer.gl;if(null===this._texture){const A={auto:!1,wrap:e.CLAMP_TO_EDGE};this._texture=n.createTexture(e,A)}this._setTexture(A)}return this._texture}getAllProps(){return o}}},function(A,e,t){const n=t(17),i=t(115),r=t(72),o=t(29);A.exports=class extends o{constructor(A,e){super(A),this._renderer=e,this._canvas=document.createElement("canvas"),this._texture=null,this._size=[0,0],this._renderedScale=0,this._lines=[],this._textAreaSize={width:0,height:0},this._textDirty=!0,this._textureDirty=!0,this.measurementProvider=new r(this._canvas.getContext("2d",{willReadFrequently:!0})),this.textWrapper=new i(this.measurementProvider),this.style={}}dispose(){this._texture&&(this._renderer.gl.deleteTexture(this._texture),this._texture=null),this._canvas=null,this.textWrapper=null,this.measurementProvider=null}setTextAndStyle(A){this._text=A.text,this.style.FONT=A.font,this.style.COLOR=A.color,this.style.MAX_LINE_WIDTH=A.maxWidth,this.style.FONT_SIZE=A.size,this.style.LINE_HEIGHT=A.size+A.size/7,this.style.ALIGN=A.align,this.style.STROKE_WIDTH=A.strokeWidth,this.style.STROKE_COLOR=A.strokeColor,this.style.VERTICAL_PADDING=A.size/7,this.style.RAINBOW=A.rainbow,this.measurementProvider.setFontAndSize(this.style.FONT,this.style.FONT_SIZE),this._textDirty=!0,this._textureDirty=!0,this.emitWasAltered()}_restyleCanvas(){this._canvas.getContext("2d",{willReadFrequently:!0}).font="".concat(this.style.FONT_SIZE,"px ").concat(this.style.FONT,", sans-serif")}_reflowLines(A){const e=this.style.MAX_LINE_WIDTH;this._lines=this.textWrapper.wrapText(e,this._text,this.style.FONT_SIZE,this.style.FONT),this._size[0]=e,this._size[1]=this.style.LINE_HEIGHT*this._lines.length+2*this.style.VERTICAL_PADDING,this.style.STROKE_WIDTH>0&&(this._size[0]+=2*this.style.STROKE_WIDTH,this._size[1]+=2*this.style.STROKE_WIDTH),this._textDirty=!1}get width(){let A=0;for(const e of this._lines)A=Math.max(A,this.measurementProvider.measureText(e));return A}get height(){return this._size[1]}_renderText(A){const e=this._canvas.getContext("2d",{willReadFrequently:!0});this._textDirty&&this._reflowLines(A),this._canvas.width=Math.ceil(this._size[0]*A),this._canvas.height=Math.ceil(this._size[1]*A),this._restyleCanvas(),e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,this._canvas.width,this._canvas.height),e.scale(A,A),e.stroke(),e.fill(),e.fillStyle=this.style.COLOR,e.font="".concat(this.style.FONT_SIZE,"px ").concat(this.style.FONT,", sans-serif");const t=this._lines;for(let A=0;A<t.length;A++){const n=t[A],i=this.measurementProvider.measureText(n);let r=0;"center"===this.style.ALIGN&&(r=this._size[0]/2-i/2),"right"===this.style.ALIGN&&(r=this._size[0]-i);let o=this.style.LINE_HEIGHT*A+.9*this.style.FONT_SIZE+this.style.VERTICAL_PADDING;if(this.style.STROKE_WIDTH>0&&(o+=this.style.STROKE_WIDTH,e.lineWidth=2*this.style.STROKE_WIDTH,e.strokeStyle=this.style.STROKE_COLOR,e.strokeText(n,r,o)),this.style.RAINBOW){const A=e.createLinearGradient(r,0,r+i,0),t=12;for(let e=0;e<t;e++)A.addColorStop(e/t,"hsl(".concat(360*e/t,", 100%, 50%)"));e.fillStyle=A}e.fillText(n,r,o)}const n=[this._size[0]/2,.9*this.style.FONT_SIZE];this._rotationCenter=n,this._renderedScale=A}getTexture(A){let e=(A?Math.max(Math.abs(A[0]),Math.abs(A[1])):100)/100;const t=this._renderer.customRenderConfig.textCostumeResolution;if((t.fixed||t.capped&&e>t.value)&&(e=t.value),this._textureDirty||this._renderedScale!==e){if(this._renderedScale!==e&&(this._textDirty=!0),this._renderText(e),0===this._canvas.width||0===this._canvas.height)return super.getTexture();this._textureDirty=!1;const A=this._canvas.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,this._canvas.width,this._canvas.height),t=this._renderer.gl;if(null===this._texture){const A={auto:!1,wrap:t.CLAMP_TO_EDGE};this._texture=n.createTexture(t,A)}this._setTexture(A)}return this._texture}get size(){return this._textDirty&&this._reflowLines(this._renderedScale),this._size}get maxScale(){return 10}}},function(A,e,t){(function(){var e,n,i,r,o,s,a,B,c,g,E,Q,u,l,w,h,C,I,M,d,m,p,F,D,Y,f,N;M=t(116),p=t(468),f=t(469),f.BK,c=f.CR,f.LF,f.NL,o=f.CB,i=f.BA,f.SP,d=f.WJ,I=f.SP,r=f.BK,Q=f.LF,l=f.NL,e=f.AI,n=f.AL,h=f.SA,C=f.SG,m=f.XX,a=f.CJ,f.ID,w=f.NS,f.characterClasses,N=t(470),g=N.DI_BRK,E=N.IN_BRK,s=N.CI_BRK,B=N.CP_BRK,N.PR_BRK,Y=N.pairTable,D=p.toByteArray("AA4IAAAAAAAAAhqg5VV7NJtZvz7fTC8zU5deplUlMrQoWqmqahD5So0aipYWrUhVFSVBQ10iSTtUtW6nKDVF6k7d75eQfEUbFcQ9KiFS90tQEolcP23nrLPmO+esr/+f39rr/a293t/e7/P8nmfvlz0O6RvrBJADtbBNaD88IOKTOmOrCqhu9zE770vc1pBV/xL5dxj2V7Zj4FGSomFKStCWNlV7hG1VabZfZ1LaHbFrRwzzLjzPoi1UHDnlV/lWbhgIIJvLBp/pu7AHEdRnIY+ROdXxg4fNpMdTxVnnm08OjozejAVsBqwqz8kddGRlRxsd8c55dNZoPuex6a7Dt6L0NNb03sqgTlR2/OT7eTt0Y0WnpUXxLsp5SMANc4DsmX4zJUBQvznwexm9tsMH+C9uRYMPOd96ZHB29NZjCIM2nfO7tsmQveX3l2r7ft0N4/SRJ7kO6Y8ZCaeuUQ4gMTZ67cp7TgxvlNDsPgOBdZi2YTam5Q7m3+00l+XG7PrDe6YoPmHgK+yLih7fAR16ZFCeD9WvOVt+gfNW/KT5/M6rb/9KERt+N1lad5RneVjzxXHsLofuU+TvrEsr3+26sVz5WJh6L/svoPK3qepFH9bysDljWtD1F7KrxzW1i9r+e/NLxV/acts7zuo304J9+t3Pd6Y6u8f3EAqxNRgv5DZjaI3unyvkvHPya/v3mWVYOC38qBq11+yHZ2bAyP1HbkV92vdno7r2lxz9UwCdCJVfd14NLcpO2CadHS/XPJ9doXgz5vLv/1OBVS3gX0D9n6LiNIDfpilO9RsLgZ2W/wIy8W/Rh93jfoz4qmRV2xElv6p2lRXQdO6/Cv8f5nGn3u0wLXjhnvClabL1o+7yvIpvLfT/xsKG30y/sTvq30ia9Czxp9dr9v/e7Yn/O0QJXxxBOJmceP/DBFa1q1v6oudn/e6qc/37dUoNvnYL4plQ9OoneYOh/r8fOFm7yl7FETHY9dXd5K2n/qEc53dOEe1TTJcvCfp1dpTC334l0vyaFL6mttNEbFjzO+ZV2mLk0qc3BrxJ4d9gweMmjRorxb7vic0rSq6D4wzAyFWas1TqPE0sLI8XLAryC8tPChaN3ALEZSWmtB34SyZcxXYn/E4Tg0LeMIPhgPKD9zyHGMxxhxnDDih7eI86xECTM8zodUCdgffUmRh4rQ8zyA6ow/Aei+01a8OMfziQQ+GAEkhwN/cqUFYAVzA9ex4n6jgtsiMvXf5BtXxEU4hSphvx3v8+9au8eEekEEpkrkne/zB1M+HAPuXIz3paxKlfe8aDMfGWAX6Md6PuuAdKHFVH++Ed5LEji94Z5zeiJIxbmWeN7rr1/ZcaBl5/nimdHsHgIH/ssyLUXZ4fDQ46HnBb+hQqG8yNiKRrXL/b1IPYDUsu3dFKtRMcjqlRvONd4xBvOufx2cUHuk8pmG1D7PyOQmUmluisVFS9OWS8fPIe8LiCtjwJKnEC9hrS9uKmISI3Wa5+vdXUG9dtyfr7g/oJv2wbzeZU838G6mEvntUb3SVV/fBZ6H/sL+lElzeRrHy2Xbe7UWX1q5sgOQ81rv+2baej4fP4m5Mf/GkoxfDtT3++KP7do9Jn26aa6xAhCf5L9RZVfkWKCcjI1eYbm2plvTEqkDxKC402bGzXCYaGnuALHabBT1dFLuOSB7RorOPEhZah1NjZIgR/UFGfK3p1ElYnevOMBDLURdpIjrI+qZk4sffGbRFiXuEmdFjiAODlQCJvIaB1rW61Ljg3y4eS4LAcSgDxxZQs0DYa15wA032Z+lGUfpoyOrFo3mg1sRQtN/fHHCx3TrM8eTrldMbYisDLXbUDoXMLejSq0fUNuO1muX0gEa8vgyegkqiqqbC3W0S4cC9Kmt8MuS/hFO7Xei3f8rSvIjeveMM7kxjUixOrl6gJshe4JU7PhOHpfrRYvu7yoAZKa3Buyk2J+K5W+nNTz1nhJDhRUfDJLiUXxjxXCJeeaOe/r7HlBP/uURc/5efaZEPxr55Qj39rfTLkugUGyMrwo7HAglfEjDriehF1jXtwJkPoiYkYQ5aoXSA7qbCBGKq5hwtu2VkpI9xVDop/1xrC52eiIvCoPWx4lLl40jm9upvycVPfpaH9/o2D4xKXpeNjE2HPQRS+3RFaYTc4Txw7Dvq5X6JBRwzs9mvoB49BK6b+XgsZVJYiInTlSXZ+62FT18mkFVcPKCJsoF5ahb19WheZLUYsSwdrrVM3aQ2XE6SzU2xHDS6iWkodk5AF6F8WUNmmushi8aVpMPwiIfEiQWo3CApONDRjrhDiVnkaFsaP5rjIJkmsN6V26li5LNM3JxGSyKgomknTyyrhcnwv9Qcqaq5utAh44W30SWo8Q0XHKR0glPF4fWst1FUCnk2woFq3iy9fAbzcjJ8fvSjgKVOfn14RDqyQuIgaGJZuswTywdCFSa89SakMf6fe+9KaQMYQlKxiJBczuPSho4wmBjdA+ag6QUOr2GdpcbSl51Ay6khhBt5UXdrnxc7ZGMxCvz96A4oLocxh2+px+1zkyLacCGrxnPzTRSgrLKpStFpH5ppKWm7PgMKZtwgytKLOjbGCOQLTm+KOowqa1sdut9raj1CZFkZD0jbaKNLpJUarSH5Qknx1YiOxdA5L6d5sfI/unmkSF65Ic/AvtXt98Pnrdwl5vgppQ3dYzWFwknZsy6xh2llmLxpegF8ayLwniknlXRHiF4hzzrgB8jQ4wdIqcaHCEAxyJwCeGkXPBZYSrrGa4vMwZvNN9aK0F4JBOK9mQ8g8EjEbIQVwvfS2D8GuCYsdqwqSWbQrfWdTRUJMqmpnWPax4Z7E137I6brHbvjpPlfNZpF1d7PP7HB/MPHcHVKTMhLO4f3CZcaccZEOiS2DpKiQB5KXDJ+Ospcz4qTRCRxgrKEQIgUkKLTKKwskdx2DWo3bg3PEoB5h2nA24olwfKSR+QR6TAvEDi/0czhUT59RZmO1MGeKGeEfuOSPWfL+XKmhqpZmOVR9mJVNDPKOS49Lq+Um10YsBybzDMtemlPCOJEtE8zaXhsaqEs9bngSJGhlOTTMlCXly9Qv5cRN3PVLK7zoMptutf7ihutrQ/Xj7VqeCdUwleTTKklOI8Wep9h7fCY0kVtDtIWKnubWAvbNZtsRRqOYl802vebPEkZRSZc6wXOfPtpPtN5HI63EUFfsy7U/TLr8NkIzaY3vx4A28x765XZMzRZTpMk81YIMuwJ5+/zoCuZj1wGnaHObxa5rpKZj4WhT670maRw04w0e3cZW74Z0aZe2n05hjZaxm6urenz8Ef5O6Yu1J2aqYAlqsCXs5ZB5o1JJ5l3xkTVr8rJQ09NLsBqRRDT2IIjOPmcJa6xQ1R5yGP9jAsj23xYDTezdyqG8YWZ7vJBIWK56K+iDgcHimiQOTIasNSua1fOBxsKMMEKd15jxTl+3CyvGCR+UyRwuSI2XuwRIPoNNclPihfJhaq2mKkNijwYLY6feqohktukmI3KDvOpN7ItCqHHhNuKlxMfBAEO5LjW2RKh6lE5Hd1dtAOopac/Z4FdsNsjMhXz/ug8JGmbVJTA+VOBJXdrYyJcIn5+OEeoK8kWEWF+wdG8ZtZHKSquWDtDVyhFPkRVqguKFkLkKCz46hcU1SUY9oJ2Sk+dmq0kglqk4kqKT1CV9JDELPjK1WsWGkEXF87g9P98e5ff0mIupm/w6vc3kCeq04X5bgJQlcMFRjlFWmSk+kssXCAVikfeAlMuzpUvCSdXiG+dc6KrIiLxxhbEVuKf7vW7KmDQI95bZe3H9mN3/77F6fZ2Yx/F9yClllj8gXpLWLpd5+v90iOaFa9sd7Pvx0lNa1o1+bkiZ69wCiC2x9UIb6/boBCuNMB/HYR0RC6+FD9Oe5qrgQl6JbXtkaYn0wkdNhROLqyhv6cKvyMj1Fvs2o3OOKoMYTubGENLfY5F6H9d8wX1cnINsvz+wZFQu3zhWVlwJvwBEp69Dqu/ZnkBf3nIfbx4TK7zOVJH5sGJX+IMwkn1vVBn38GbpTg9bJnMcTOb5F6Ci5gOn9Fcy6Qzcu+FL6mYJJ+f2ZZJGda1VqruZ0JRXItp8X0aTjIcJgzdaXlha7q7kV4ebrMsunfsRyRa9qYuryBHA0hc1KVsKdE+oI0ljLmSAyMze8lWmc5/lQ18slyTVC/vADTc+SNM5++gztTBLz4m0aVUKcfgOEExuKVomJ7XQDZuziMDjG6JP9tgR7JXZTeo9RGetW/Xm9/TgPJpTgHACPOGvmy2mDm9fl09WeMm9sQUAXP3Su2uApeCwJVT5iWCXDgmcuTsFgU9Nm6/PusJzSbDQIMfl6INY/OAEvZRN54BSSXUClM51im6Wn9VhVamKJmzOaFJErgJcs0etFZ40LIF3EPkjFTjGmAhsd174NnOwJW8TdJ1Dja+E6Wa6FVS22Haj1DDA474EesoMP5nbspAPJLWJ8rYcP1DwCslhnn+gTFm+sS9wY+U6SogAa9tiwpoxuaFeqm2OK+uozR6SfiLCOPz36LiDlzXr6UWd7BpY6mlrNANkTOeme5EgnnAkQRTGo9T6iYxbUKfGJcI9B+ub2PcyUOgpwXbOf3bHFWtygD7FYbRhb+vkzi87dB0JeXl/vBpBUz93VtqZi7AL7C1VowTF+tGmyurw7DBcktc+UMY0E10Jw4URojf8NdaNpN6E1q4+Oz+4YePtMLy8FPRP"),F=new M(D),u=function(){var A,t,u;function M(A){this.string=A,this.pos=0,this.lastPos=0,this.curClass=null,this.nextClass=null}return M.prototype.nextCodePoint=function(){var A,e;return A=this.string.charCodeAt(this.pos++),e=this.string.charCodeAt(this.pos),55296<=A&&A<=56319&&56320<=e&&e<=57343?(this.pos++,1024*(A-55296)+(e-56320)+65536):A},t=function(A){switch(A){case e:return n;case h:case C:case m:return n;case a:return w;default:return A}},u=function(A){switch(A){case Q:case l:return r;case o:return i;case I:return d;default:return A}},M.prototype.nextCharClass=function(A){return null==A&&(A=!1),t(F.get(this.nextCodePoint()))},A=function(A,e){this.position=A,this.required=null!=e&&e},M.prototype.nextBreak=function(){var e,n,a;for(null==this.curClass&&(this.curClass=u(this.nextCharClass()));this.pos<this.string.length;){if(this.lastPos=this.pos,n=this.nextClass,this.nextClass=this.nextCharClass(),this.curClass===r||this.curClass===c&&this.nextClass!==Q)return this.curClass=u(t(this.nextClass)),new A(this.lastPos,!0);if(null==(e=function(){switch(this.nextClass){case I:return this.curClass;case r:case Q:case l:return r;case c:return c;case o:return i}}.call(this))){switch(a=!1,Y[this.curClass][this.nextClass]){case g:a=!0;break;case E:a=n===I;break;case s:if(!(a=n===I))continue;break;case B:if(n!==I)continue}if(this.curClass=this.nextClass,a)return new A(this.lastPos)}else if(this.curClass=e,this.nextClass===o)return new A(this.lastPos)}if(this.pos>=this.string.length)return this.lastPos<this.string.length?(this.lastPos=this.string.length,new A(this.string.length)):null},M}(),A.exports=u}).call(this)},function(A,e){function t(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function n(A,e){this.source=A,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=e,this.destLen=0,this.ltree=new t,this.dtree=new t}var i=new t,r=new t,o=new Uint8Array(30),s=new Uint16Array(30),a=new Uint8Array(30),B=new Uint16Array(30),c=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),g=new t,E=new Uint8Array(320);function Q(A,e,t,n){var i,r;for(i=0;i<t;++i)A[i]=0;for(i=0;i<30-t;++i)A[i+t]=i/t|0;for(r=n,i=0;i<30;++i)e[i]=r,r+=1<<A[i]}var u=new Uint16Array(16);function l(A,e,t,n){var i,r;for(i=0;i<16;++i)A.table[i]=0;for(i=0;i<n;++i)A.table[e[t+i]]++;for(A.table[0]=0,r=0,i=0;i<16;++i)u[i]=r,r+=A.table[i];for(i=0;i<n;++i)e[t+i]&&(A.trans[u[e[t+i]]++]=i)}function w(A){A.bitcount--||(A.tag=A.source[A.sourceIndex++],A.bitcount=7);var e=1&A.tag;return A.tag>>>=1,e}function h(A,e,t){if(!e)return t;for(;A.bitcount<24;)A.tag|=A.source[A.sourceIndex++]<<A.bitcount,A.bitcount+=8;var n=A.tag&65535>>>16-e;return A.tag>>>=e,A.bitcount-=e,n+t}function C(A,e){for(;A.bitcount<24;)A.tag|=A.source[A.sourceIndex++]<<A.bitcount,A.bitcount+=8;var t=0,n=0,i=0,r=A.tag;do{n=2*n+(1&r),r>>>=1,++i,t+=e.table[i],n-=e.table[i]}while(n>=0);return A.tag=r,A.bitcount-=i,e.trans[t+n]}function I(A,e,t){var n,i,r,o,s,a;for(n=h(A,5,257),i=h(A,5,1),r=h(A,4,4),o=0;o<19;++o)E[o]=0;for(o=0;o<r;++o){var B=h(A,3,0);E[c[o]]=B}for(l(g,E,0,19),s=0;s<n+i;){var Q=C(A,g);switch(Q){case 16:var u=E[s-1];for(a=h(A,2,3);a;--a)E[s++]=u;break;case 17:for(a=h(A,3,3);a;--a)E[s++]=0;break;case 18:for(a=h(A,7,11);a;--a)E[s++]=0;break;default:E[s++]=Q}}l(e,E,0,n),l(t,E,n,i)}function M(A,e,t){for(;;){var n,i,r,c,g=C(A,e);if(256===g)return 0;if(g<256)A.dest[A.destLen++]=g;else for(n=h(A,o[g-=257],s[g]),i=C(A,t),c=r=A.destLen-h(A,a[i],B[i]);c<r+n;++c)A.dest[A.destLen++]=A.dest[c]}}function d(A){for(var e,t;A.bitcount>8;)A.sourceIndex--,A.bitcount-=8;if((e=256*(e=A.source[A.sourceIndex+1])+A.source[A.sourceIndex])!==(65535&~(256*A.source[A.sourceIndex+3]+A.source[A.sourceIndex+2])))return-3;for(A.sourceIndex+=4,t=e;t;--t)A.dest[A.destLen++]=A.source[A.sourceIndex++];return A.bitcount=0,0}!function(A,e){var t;for(t=0;t<7;++t)A.table[t]=0;for(A.table[7]=24,A.table[8]=152,A.table[9]=112,t=0;t<24;++t)A.trans[t]=256+t;for(t=0;t<144;++t)A.trans[24+t]=t;for(t=0;t<8;++t)A.trans[168+t]=280+t;for(t=0;t<112;++t)A.trans[176+t]=144+t;for(t=0;t<5;++t)e.table[t]=0;for(e.table[5]=32,t=0;t<32;++t)e.trans[t]=t}(i,r),Q(o,s,4,3),Q(a,B,2,1),o[28]=0,s[28]=258,A.exports=function(A,e){var t,o,s=new n(A,e);do{switch(t=w(s),h(s,2,0)){case 0:o=d(s);break;case 1:o=M(s,i,r);break;case 2:I(s,s.ltree,s.dtree),o=M(s,s.ltree,s.dtree);break;default:o=-3}if(0!==o)throw new Error("Data error")}while(!t);return s.destLen<s.dest.length?"function"==typeof s.dest.slice?s.dest.slice(0,s.destLen):s.dest.subarray(0,s.destLen):s.dest}},function(A,e,t){!function(A){"use strict";var e="undefined"!=typeof Uint8Array?Uint8Array:Array,t="+".charCodeAt(0),n="/".charCodeAt(0),i="0".charCodeAt(0),r="a".charCodeAt(0),o="A".charCodeAt(0),s="-".charCodeAt(0),a="_".charCodeAt(0);function B(A){var e=A.charCodeAt(0);return e===t||e===s?62:e===n||e===a?63:e<i?-1:e<i+10?e-i+26+26:e<o+26?e-o:e<r+26?e-r+26:void 0}A.toByteArray=function(A){var t,n,i,r,o,s;if(A.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var a=A.length;o="="===A.charAt(a-2)?2:"="===A.charAt(a-1)?1:0,s=new e(3*A.length/4-o),i=o>0?A.length-4:A.length;var c=0;function g(A){s[c++]=A}for(t=0,n=0;t<i;t+=4,n+=3)g((16711680&(r=B(A.charAt(t))<<18|B(A.charAt(t+1))<<12|B(A.charAt(t+2))<<6|B(A.charAt(t+3))))>>16),g((65280&r)>>8),g(255&r);return 2===o?g(255&(r=B(A.charAt(t))<<2|B(A.charAt(t+1))>>4)):1===o&&(g((r=B(A.charAt(t))<<10|B(A.charAt(t+1))<<4|B(A.charAt(t+2))>>2)>>8&255),g(255&r)),s},A.fromByteArray=function(A){var e,t,n,i,r=A.length%3,o="";function s(A){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(A)}for(e=0,n=A.length-r;e<n;e+=3)t=(A[e]<<16)+(A[e+1]<<8)+A[e+2],o+=s((i=t)>>18&63)+s(i>>12&63)+s(i>>6&63)+s(63&i);switch(r){case 1:o+=s((t=A[A.length-1])>>2),o+=s(t<<4&63),o+="==";break;case 2:o+=s((t=(A[A.length-2]<<8)+A[A.length-1])>>10),o+=s(t>>4&63),o+=s(t<<2&63),o+="="}return o}}(e)},function(A,e){(function(){e.OP=0,e.CL=1,e.CP=2,e.QU=3,e.GL=4,e.NS=5,e.EX=6,e.SY=7,e.IS=8,e.PR=9,e.PO=10,e.NU=11,e.AL=12,e.HL=13,e.ID=14,e.IN=15,e.HY=16,e.BA=17,e.BB=18,e.B2=19,e.ZW=20,e.CM=21,e.WJ=22,e.H2=23,e.H3=24,e.JL=25,e.JV=26,e.JT=27,e.RI=28,e.AI=29,e.BK=30,e.CB=31,e.CJ=32,e.CR=33,e.LF=34,e.NL=35,e.SA=36,e.SG=37,e.SP=38,e.XX=39}).call(this)},function(A,e){(function(){e.DI_BRK=0,e.IN_BRK=1,e.CI_BRK=2,e.CP_BRK=3,e.PR_BRK=4,e.pairTable=[[4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,4,4,4,4,4,4,4],[0,4,4,1,1,4,4,4,4,1,1,0,0,0,0,0,1,1,0,0,4,2,4,0,0,0,0,0,0],[0,4,4,1,1,4,4,4,4,1,1,1,1,1,0,0,1,1,0,0,4,2,4,0,0,0,0,0,0],[4,4,4,1,1,1,4,4,4,1,1,1,1,1,1,1,1,1,1,1,4,2,4,1,1,1,1,1,1],[1,4,4,1,1,1,4,4,4,1,1,1,1,1,1,1,1,1,1,1,4,2,4,1,1,1,1,1,1],[0,4,4,1,1,1,4,4,4,0,0,0,0,0,0,0,1,1,0,0,4,2,4,0,0,0,0,0,0],[0,4,4,1,1,1,4,4,4,0,0,0,0,0,0,0,1,1,0,0,4,2,4,0,0,0,0,0,0],[0,4,4,1,1,1,4,4,4,0,0,1,0,0,0,0,1,1,0,0,4,2,4,0,0,0,0,0,0],[0,4,4,1,1,1,4,4,4,0,0,1,1,1,0,0,1,1,0,0,4,2,4,0,0,0,0,0,0],[1,4,4,1,1,1,4,4,4,0,0,1,1,1,1,0,1,1,0,0,4,2,4,1,1,1,1,1,0],[1,4,4,1,1,1,4,4,4,0,0,1,1,1,0,0,1,1,0,0,4,2,4,0,0,0,0,0,0],[1,4,4,1,1,1,4,4,4,1,1,1,1,1,0,1,1,1,0,0,4,2,4,0,0,0,0,0,0],[1,4,4,1,1,1,4,4,4,0,0,1,1,1,0,1,1,1,0,0,4,2,4,0,0,0,0,0,0],[1,4,4,1,1,1,4,4,4,0,0,1,1,1,0,1,1,1,0,0,4,2,4,0,0,0,0,0,0],[0,4,4,1,1,1,4,4,4,0,1,0,0,0,0,1,1,1,0,0,4,2,4,0,0,0,0,0,0],[0,4,4,1,1,1,4,4,4,0,0,0,0,0,0,1,1,1,0,0,4,2,4,0,0,0,0,0,0],[0,4,4,1,0,1,4,4,4,0,0,1,0,0,0,0,1,1,0,0,4,2,4,0,0,0,0,0,0],[0,4,4,1,0,1,4,4,4,0,0,0,0,0,0,0,1,1,0,0,4,2,4,0,0,0,0,0,0],[1,4,4,1,1,1,4,4,4,1,1,1,1,1,1,1,1,1,1,1,4,2,4,1,1,1,1,1,1],[0,4,4,1,1,1,4,4,4,0,0,0,0,0,0,0,1,1,0,4,4,2,4,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0],[1,4,4,1,1,1,4,4,4,0,0,1,1,1,0,1,1,1,0,0,4,2,4,0,0,0,0,0,0],[1,4,4,1,1,1,4,4,4,1,1,1,1,1,1,1,1,1,1,1,4,2,4,1,1,1,1,1,1],[0,4,4,1,1,1,4,4,4,0,1,0,0,0,0,1,1,1,0,0,4,2,4,0,0,0,1,1,0],[0,4,4,1,1,1,4,4,4,0,1,0,0,0,0,1,1,1,0,0,4,2,4,0,0,0,0,1,0],[0,4,4,1,1,1,4,4,4,0,1,0,0,0,0,1,1,1,0,0,4,2,4,1,1,1,1,0,0],[0,4,4,1,1,1,4,4,4,0,1,0,0,0,0,1,1,1,0,0,4,2,4,0,0,0,1,1,0],[0,4,4,1,1,1,4,4,4,0,1,0,0,0,0,1,1,1,0,0,4,2,4,0,0,0,0,1,0],[0,4,4,1,1,1,4,4,4,0,0,0,0,0,0,0,1,1,0,0,4,2,4,0,0,0,0,0,1]]}).call(this)},function(A,e,t){(function(A){(function(){var n,i,r,o,s,a,B,c,g,E,Q,u,l,w,h,C;C=t(472),n=C.CR,s=C.LF,i=C.Control,r=C.Extend,c=C.Regional_Indicator,g=C.SpacingMark,o=C.L,u=C.V,E=C.T,a=C.LV,B=C.LVT,Q=t(116),l=new Q(A("AA4QAAAAAAAAAHbgAQgG9/ntmkuIXjUUxzN+r3k4bUWQVotSHVCsoov6qIoiToWKFYvMuLHVtlaoLqQilLrwtakuxFYoLmQQYWalRYpUKYJV0am4mMUooojgSEG7EC2CdiHq/3rzMcc0yT333jyu0xz4kdwkN+ckOXncfN9QS4jzwCqwBqwHt5O0uuFGsBlsAhOM8lvATkv+LrAb7AXPgRfBAfAqeJ2UmwZvgcPgKDgGjoNZMAe+AN+C5W0hLgAXtvN3KZci7UpwFVgHbgHjYAPYJJ8nwCTYCnaQ58dI+cfBHvn8DFgL9kl9LyP8LLOflJ8CM+Q5K39IPo/28vfeyd6X8fcR/5jYP4v4nHyeR/iNjC8gPAl+BU+T8qcRFx0hBsGKzn/74LreIrdKxsGkRO0zE48wy7lmZSfnYkmWdhnCtTK+oHnnWqUPbuyY679N5t2J8B4ZnyTltyK+Dezq5P62G+Femf+sDPdp6n8JaQcterN5NWXJ5/Ij+FnGR0n6BvCbZk4kwjGjjO8rGh9woedNoudtBz6VSCQSiUQikUgkEomET97t5Hdp/ecvGfcXH+CdWfLNu6onxGowh7SvZPp3CE+A63v5feBJxMcQPyXz/0D4N2h18+cRhEcQnt+1674I+Q+inofANrAd7AAPg529lJfyUl7KS3mu8+4G94H7e/H3rPWRid3+RGIpc0nBGbAuE63F39VV1mjS6Pn4VCv++jN9bs4JMM5gbFSIdaNnpj+ppE3j+QQYWybEA8vytP0IPwF/gpXLsQ+AhWH0xYgQPwwJMTjA46YRXrnVw4vxzYjvke8dzvQx60gkEonE0uQA9oU3wB04J7yH/fDDVv4/j+x/QqfJXv0RuEueJe7t5vkTCLeQ88V2zVkjq+tRpD/Rzf+39hTC55lnkhdQbr+l7EHkTZH8GcTnSf4hkpf9/+uI57NQFT6HTSsC6hMYg3no/FrTF983sH84FJ3xNlroteOfQWNTp+8vL/CZeeX5mgb62A2w6WaDXa/9D/6DeFTafqwBfXtFT4irwacObMnm50/dPPwF4e/grwa0kUsTxiMEnQbcY9ZlsDXwL4iyOIfEB5jvcEgST1L/u/PjkP7vctzaZzkuJZSepknsMaw67jQ0xZe61F2XyvZ5k/ecJq4voXzQ1oZWQRm1Dl1ZH0LtiiVN8pUmy9nQD77bppuTLqWl1O9Ch+9vv9Dfm12COrZqOrXRJv13TX6i00XHyISLNamp3/e6eWWab9xyoYSr1+XeUoWug7ZWFTonhLDPO9M8pOX7cVHwbhn7Yu1VantC61ZtMPWhaiMtX0YXp1wsf7X5p65sW/OslnXpV3XrN803WneXlC0zvj5EZ5sP/6yyXsQQ01rRVdJV/+XWXUZ/rPmp7gf9dNuZoKjOmOOZibqv6fY43fi6bp9pfoXyL1tZ0x5Fy6u+UcVOrm1FZxdOPS7OLi7sFaKaXt+2c/X71qELqbhcD4v8wgRnb6+rr459rqgr3H5T21tmza0r3LOnj/6oWkcmnP6pa7OPvve9dvmqm+PD1HdteyP3e7xsX/mcK7Y26tJV0bXfVI/vOa9bZ3wIbS9nraehKHiH248cn/KxtpX1bV3bQoptnGx+S9ND2xujn6jo+ku3Jvic16oO3djo7CsrnHWdM1dd9UPR/OFQ9rtKl2ZaQ4vaWWe9KGOzSV8dcenPZdvhUny1QZdW1ce4fuhSdGuYb/F1h8IV3/PPlR0+pOya6dofdPuDbt8oug9uis+YvguqjiHnnVDz1KbfR30637f1Y5U+1o2VrVxZMX37qvfcof1XJzFtCKG76plJCJ7fhTq/FJ0hqI/FFtMaGWOv69vjUsrePZTZQ331h8lm07dj1fpCn2Fi3EX09atn2L6Ynsv4AFfUernj4HucbGc8dU0w+aDL+4M6YmtLX0z3I7Ha4Fpn1bufKucck2/YfIhrP3dfci0h5puv9TfUPs21g8bbmvzQZ4tQfhNSiuZ4HVzp4rShTHt9icl2l31YVTqB6Eus81pd/U2xuwyxpYrNPsik1wCoDEZmyDMjCmXFZVtV8d12DqoMizP7zCeh9anyDw==","base64")),w=function(A,e){var t,n,i;return e=e||0,55296<=(t=A.charCodeAt(e))&&t<=56319?(n=t,56320<=(i=A.charCodeAt(e+1))&&i<=57343?1024*(n-55296)+(i-56320)+65536:n):56320<=t&&t<=57343?(i=t,55296<=(n=A.charCodeAt(e-1))&&n<=56319?1024*(n-55296)+(i-56320)+65536:i):t},h=function(A,e){return(A!==n||e!==s)&&(A===i||A===n||A===s||(e===i||e===n||e===s||(A!==o||e!==o&&e!==u&&e!==a&&e!==B)&&((A!==a&&A!==u||e!==u&&e!==E)&&((A!==B&&A!==E||e!==E)&&((A!==c||e!==c)&&(e!==r&&e!==g))))))},e.nextBreak=function(A,e){var t,n,i,r,o,s,a;if(null==e&&(e=0),e<0)return 0;if(e>=A.length-1)return A.length;for(i=l.get(w(A,e)),t=r=e+1,o=A.length;r<o;t=r+=1)if(!(55296<=(s=A.charCodeAt(t-1))&&s<=56319&&56320<=(a=A.charCodeAt(t))&&a<=57343)){if(n=l.get(w(A,t)),h(i,n))return t;i=n}return A.length},e.previousBreak=function(A,e){var t,n,i,r,o,s;if(null==e&&(e=A.length),e>A.length)return A.length;if(e<=1)return 0;for(e--,n=l.get(w(A,e)),t=r=e-1;r>=0;t=r+=-1)if(!(55296<=(o=A.charCodeAt(t))&&o<=56319&&56320<=(s=A.charCodeAt(t+1))&&s<=57343)){if(i=l.get(w(A,t)),h(i,n))return t+1;n=i}return 0},e.break=function(A){var t,n,i;for(i=[],n=0;(t=e.nextBreak(A,n))<A.length;)i.push(A.slice(n,t)),n=t;return n<A.length&&i.push(A.slice(n)),i},e.countBreaks=function(A){var t,n,i;for(n=0,i=0;(t=e.nextBreak(A,i))<A.length;)i=t,n++;return i<A.length&&n++,n}}).call(this)}).call(this,t(20).Buffer)},function(A){A.exports=JSON.parse('{"Other":0,"CR":1,"LF":2,"Control":3,"Extend":4,"Regional_Indicator":5,"SpacingMark":6,"L":7,"V":8,"T":9,"LV":10,"LVT":11}')},function(A,e){A.exports=".scratch-render-overlays {\n    position: absolute;\n    top: 0;\n    left: 0;\n    pointer-events: none;\n    overflow: hidden;\n}\n.scratch-render-overlays > * {\n    position: absolute;\n    top: 0;\n    left: 0;\n}\n"},function(A,e,t){const n=t(475),i=t(480),r=t(73),o=t(117),s=t(74);A.exports=class{constructor(){this.defaultAssetId={},this.builtinHelper=new n(this),this.webHelper=new i(this),this.builtinHelper.registerDefaultAssets(this),this._helpers=[{helper:this.builtinHelper,priority:100},{helper:this.webHelper,priority:-100}]}get Asset(){return r}get AssetType(){return o}get DataFormat(){return s}static get Asset(){return r}static get AssetType(){return o}addHelper(A){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._helpers.push({helper:A,priority:e}),this._helpers.sort((A,e)=>e.priority-A.priority)}get(A){return this.builtinHelper.get(A)}cache(A,e,t,n){return this.builtinHelper._store(A,e,t,n)}createAsset(A,e,t,n,i){if(!e)throw new Error("Tried to create asset without a dataFormat");return new r(A,n,e,t,i)}addWebStore(A,e,t,n){this.webHelper.addStore(A,e,t,n)}addWebSource(A,e){this.addWebStore(A,e)}getDefaultAssetId(A){if(Object.prototype.hasOwnProperty.call(this.defaultAssetId,A.name))return this.defaultAssetId[A.name]}setDefaultAssetId(A,e){this.defaultAssetId[A.name]=e}load(A,e,t){const n=this._helpers.map(A=>A.helper),i=[];t=t||A.runtimeFormat;let r,o=0;const s=a=>{if(a&&i.push(a),r=n[o++],r){const n=r.load(A,e,t);return null===n?s():n.catch(s)}return i.length>0?Promise.reject(i):Promise.resolve(null)};return s()}store(A,e,t,n){return e=e||A.runtimeFormat,new Promise((i,r)=>this.webHelper.store(A,e,t,n).then(n=>(this.builtinHelper._store(A,e,t,n.id),i(n))).catch(A=>r(A)))}}},function(A,e,t){(function(e){const n=t(32),i=t(73),r=t(117),o=t(74),s=t(118),a=[{type:r.ImageBitmap,format:o.PNG,id:null,data:e.from(t(477))},{type:r.Sound,format:o.WAV,id:null,data:e.from(t(478))},{type:r.ImageVector,format:o.SVG,id:null,data:e.from(t(479))}],B=a.concat([]);A.exports=class extends s{constructor(A){super(A),this.assets={},B.forEach(A=>{A.id=this._store(A.type,A.format,A.data,A.id)})}registerDefaultAssets(){const A=a.length;for(let e=0;e<A;++e){const A=a[e];this.parent.setDefaultAssetId(A.type,A.id)}}get(A){let e=null;if(Object.prototype.hasOwnProperty.call(this.assets,A)){const t=this.assets[A];e=new i(t.type,t.id,t.format,t.data)}return e}cache(A,e,t,n){return this.store(A,e,t,n)}store(A,e,t,n){return this._store(A,e,t,n)}_store(A,e,t,i){if(!e)throw new Error("Data cached without specifying its format");if(""!==i&&null!=i){if(Object.prototype.hasOwnProperty.call(this.assets,i)&&A.immutable)return i}else{if(!A.immutable)throw new Error("Tried to cache data without an id");i=n(t)}return this.assets[i]={type:A,format:e,id:i,data:t},i}load(A,e){return this.get(e)?Promise.resolve(this.get(e)):null}}}).call(this,t(20).Buffer)},function(A,e,t){"use strict";e.byteLength=function(A){var e=B(A),t=e[0],n=e[1];return 3*(t+n)/4-n},e.toByteArray=function(A){for(var e,t=B(A),n=t[0],o=t[1],s=new r(function(A,e,t){return 3*(e+t)/4-t}(0,n,o)),a=0,c=o>0?n-4:n,g=0;g<c;g+=4)e=i[A.charCodeAt(g)]<<18|i[A.charCodeAt(g+1)]<<12|i[A.charCodeAt(g+2)]<<6|i[A.charCodeAt(g+3)],s[a++]=e>>16&255,s[a++]=e>>8&255,s[a++]=255&e;2===o&&(e=i[A.charCodeAt(g)]<<2|i[A.charCodeAt(g+1)]>>4,s[a++]=255&e);1===o&&(e=i[A.charCodeAt(g)]<<10|i[A.charCodeAt(g+1)]<<4|i[A.charCodeAt(g+2)]>>2,s[a++]=e>>8&255,s[a++]=255&e);return s},e.fromByteArray=function(A){for(var e,t=A.length,i=t%3,r=[],o=0,s=t-i;o<s;o+=16383)r.push(c(A,o,o+16383>s?s:o+16383));1===i?(e=A[t-1],r.push(n[e>>2]+n[e<<4&63]+"==")):2===i&&(e=(A[t-2]<<8)+A[t-1],r.push(n[e>>10]+n[e>>4&63]+n[e<<2&63]+"="));return r.join("")};for(var n=[],i=[],r="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,a=o.length;s<a;++s)n[s]=o[s],i[o.charCodeAt(s)]=s;function B(A){var e=A.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=A.indexOf("=");return-1===t&&(t=e),[t,t===e?0:4-t%4]}function c(A,e,t){for(var i,r,o=[],s=e;s<t;s+=3)i=(A[s]<<16&16711680)+(A[s+1]<<8&65280)+(255&A[s+2]),o.push(n[(r=i)>>18&63]+n[r>>12&63]+n[r>>6&63]+n[63&r]);return o.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(A,e,t){A.exports=t(75)("iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAAAAADmVT4XAAADZElEQVR42u3a70vbQBgH8O/7vOibvsmbFUEEWUGGUhQ25nDuhSKIUFDxlYi0SAd94atRmFiHCH2x4W8iiNtwowXRgd1QipJYY3N/1F4kTQ6XLKS9yyHcvWyO8MnT5y53Tw5EcIMESIAESIAESIAESIAEPFVAq/6l8G4oAQCp4aniwbUVJ6BVzafwqKXy1VZMgNb+CHzbyK4ZB+Bi0nnk0VyhsDiSoAmvvnMHmGUVAF6UG+0ffsxRhsRHky/AyCsAUpumX0wAAIs6T4CxDADDtcdZsal6gjmdH8AsAEC6+s8Fa48SFExeAKusAEju+V367AmUCi9ANQ0AU3pwcOw2cMEH0FwAAKz5X228pRLR5AI4TgIAtIDL24oLUE94AB6W7LsH/cONN14Ilh44AOqD9s2LQR1KHiB9zgGgOSGeuA3ocPrME1Q4ANaceyePAzrcjHmAZYs9IBeW4/fzHiAwTCwAgTle9ACZK44ALDT9e6x7gL4aT0BQCHb4AqgA5/1TTOMLoJ7vZSMM0H/GHnCeDnu+CrU8vGYPcN5FADBYD0vCaYPDy+i0p337GSMsS1Z4vA3t9QgAZTt0IuIxFRPSKicAQHlvhk3FXF5GhBByMa8qo/sBO6BarwuYbYrYnFKDYEvE7phKgcxvEQBqnvhgiQCUOgoAO4C3JOS3L/hv23UXxVldBECfcueAqpAa0WGy/QeULREAY6aTXRFDgBuA13+ElOncAERMAGaA9hBQD4gQQHsIRE1AZoD2xrgQS5nOZyHgFKmWDSIG4GRAVidiAE4GRB6AzAB2AKIPQFaA5myHA5AV4ESNugZhC7BLR50lIBPAebrzBGQCKAFQNSIMcDvRTQIwAHxNApM3RBygGK0uyhxwOwGsPAgEnPWj5ycRCNiJtBHlAChGKQVwANzPY+CXSMDNWISiLA9AfRA5IhJQ68UnoQAt+AtOPIBKhJosF8B6UM0yLkAxQk2WCyDX9SiUh1gkQAIkoCuAvjGuquMbuijAtwG7MPL8yBICOHSPk3W8Ne8KcEUdmBi6FADYos+QleIH0N/ogOxd7AD6uAS6WRU8WcBdlgZMG/EnYUlwEpLLoQ4PjzGbiA5UsRMRsbQ+5ziDJmYqJuR6NaMomdXuFuZyPSABEiABEiABEiABEiAc8Bd6VyvCEKGqcQAAAABJRU5ErkJggg==")},function(A,e,t){A.exports=t(75)("UklGRiYAAABXQVZFZm10IBAAAAABAAEAIlYAAESsAAACABAAZGF0YQIAAAAAAA==")},function(A,e,t){A.exports=t(75)("PD94bWwgdmVyc2lvbj0iMS4wIj8+Cjxzdmcgd2lkdGg9IjEyOCIgaGVpZ2h0PSIxMjgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6c3ZnPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiA8Zz4KICA8cmVjdCBmaWxsPSIjQ0NDIiBoZWlnaHQ9IjEyOCIgd2lkdGg9IjEyOCIvPgogIDx0ZXh0IGZpbGw9ImJsYWNrIiB5PSIxMDciIHg9IjM1LjUiIGZvbnQtc2l6ZT0iMTI4Ij4/PC90ZXh0PgogPC9nPgo8L3N2Zz4K")},function(A,e,t){const n=t(73),i=t(118),r=t(481),o=A=>"string"==typeof A?{url:A}:A;A.exports=class extends i{constructor(A){super(A),this.stores=[],this.assetTool=new r,this.projectTool=new r(r.TOOL_FILTER.READY)}addSource(A,e){this.addStore(A,e)}addStore(A,e,t,n){this.stores.push({types:A.map(A=>A.name),get:e,create:t,update:n})}load(A,e,t){const i=[],r=this.stores.slice().filter(e=>e.types.indexOf(A.name)>=0),s=new n(A,e,t);let a=this.assetTool;"Project"===A.name&&(a=this.projectTool);let B=0;const c=A=>{A&&i.push(A);const e=r[B++],n=e&&e.get;if(n){const A=o(n(s));return!1===A?c():a.get(A).then(A=>A?(s.setData(A,t),s):c()).catch(c)}return i.length>0?Promise.reject(i):Promise.resolve(null)};return c()}store(A,e,t,i){const r=new n(A,i,e),s=""===i||null==i,a=this.stores.filter(e=>-1!==e.types.indexOf(A.name)&&(s&&e.create||e.update))[0],B=s?"post":"put";if(!a)return Promise.reject(new Error("No appropriate stores"));let c=this.assetTool;"Project"===A.name&&(c=this.projectTool);const g=o(s?a.create(r):a.update(r)),E=Object.assign({body:t,method:B},g);return c.send(E).then(A=>{if("string"==typeof A)try{A=JSON.parse(A)}catch(e){return A}return Object.assign({id:A["content-name"]||i},A)})}}},function(A,e,t){const n=t(482),i=t(484);class r{constructor(){let A;A=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.TOOL_FILTER.ALL)===r.TOOL_FILTER.READY?[new i]:[new n,new i],this.tools=A}get isGetSupported(){return this.tools.some(A=>A.isGetSupported)}get(A){let e=0;const t=n=>{const i=this.tools[e++];if(!i)throw n;return i.isGetSupported?i.get(A).catch(t):t(n)};return t()}get isSendSupported(){return this.tools.some(A=>A.isSendSupported)}send(A){let e=0;const t=n=>{const i=this.tools[e++];if(!i)throw n;return i.isSendSupported?i.send(A).catch(t):t(n)};return t()}}r.TOOL_FILTER={ALL:"all",READY:"ready"},A.exports=r},function(A,e,t){const n=["url"];class i{constructor(){this._workerSupport={fetch:"undefined"!=typeof fetch},this._supportError=null,this.worker=null,this.jobs={};try{if(this.isGetSupported){const A=t(483);this.worker=new A,this.worker.addEventListener("message",A=>{let{data:e}=A;if(e.support)this._workerSupport=e.support;else for(const A of e)this.jobs[A.id]&&(A.error?this.jobs[A.id].reject(A.error):this.jobs[A.id].resolve(A.buffer),delete this.jobs[A.id])})}}catch(A){this._supportError=A}}get isGetSupported(){return"undefined"!=typeof Worker&&this._workerSupport.fetch&&!this._supportError}get(A){let{url:e}=A,t=function(A,e){if(null==A)return{};var t,n,i=function(A,e){if(null==A)return{};var t={};for(var n in A)if({}.hasOwnProperty.call(A,n)){if(-1!==e.indexOf(n))continue;t[n]=A[n]}return t}(A,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(A);for(n=0;n<r.length;n++)t=r[n],-1===e.indexOf(t)&&{}.propertyIsEnumerable.call(A,t)&&(i[t]=A[t])}return i}(A,n);return new Promise((A,n)=>{const i=Math.random().toString(16).substring(2);this.worker.postMessage({id:i,url:e,options:Object.assign({method:"GET"},t)}),this.jobs[i]={id:i,resolve:A,reject:n}}).then(A=>A?new Uint8Array(A):null)}get isSendSupported(){return!1}send(){throw new Error("Not implemented.")}static get instance(){return this._instance||(this._instance=new i),this._instance}}A.exports=class{constructor(){this.inner=i.instance}get isGetSupported(){return this.inner.isGetSupported}get(A){return this.inner.get(A)}get isSendSupported(){return!1}send(){throw new Error("Not implemented.")}}},function(A,e,t){A.exports=function(){return t(101)('!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){const r=n(1),o=[];let s=null;const u=()=>{s||(s=setTimeout(()=>{s=null,o.length&&(postMessage(o.slice(),o.map(e=>e.buffer).filter(Boolean)),o.length=0)}))},a=e=>{let{data:t}=e;r(t.url,t.options).then(e=>o.push({id:t.id,buffer:e})).catch(e=>o.push({id:t.id,error:e&&e.message||"Failed request: ".concat(t.url)})).then(u)};self.fetch?(postMessage({support:{fetch:!0}}),self.addEventListener("message",a)):(postMessage({support:{fetch:!1}}),self.addEventListener("message",e=>{let{data:t}=e;postMessage([{id:t.id,error:"fetch is unavailable"}])}))},function(e,t){let n=0;const r=[],o=()=>{n<100&&r.length>0&&(n++,(e=>{let t,[r,s,u]=e,a=0;const l=()=>fetch(s,u).then(e=>e.ok||0===e.status?e.arrayBuffer():404===e.status?null:Promise.reject(e.status)).then(e=>(n--,o(),e)).catch(e=>{if(403===e)throw e;if(console.warn("Attempt to fetch ".concat(s," failed"),e),t||(t=e),a<2)return a++,new Promise(e=>setTimeout(e,5e3*(a+Math.random()-1))).then(l);throw n--,o(),t});r(l())})(r.shift()))};e.exports=(e,t)=>new Promise(n=>{r.push([n,e,t]),o()})}]);',null)}},function(A,e,t){const n=["url"],i=["url","withCredentials"];function r(A,e){if(null==A)return{};var t,n,i=function(A,e){if(null==A)return{};var t={};for(var n in A)if({}.hasOwnProperty.call(A,n)){if(-1!==e.indexOf(n))continue;t[n]=A[n]}return t}(A,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(A);for(n=0;n<r.length;n++)t=r[n],-1===e.indexOf(t)&&{}.propertyIsEnumerable.call(A,t)&&(i[t]=A[t])}return i}const o=t(485);A.exports=class{get isGetSupported(){return"undefined"!=typeof fetch}get(A){let{url:e}=A,t=r(A,n);return o(e,Object.assign({method:"GET"},t)).then(A=>A?new Uint8Array(A):A)}get isSendSupported(){return"undefined"!=typeof fetch}send(A){let{url:e,withCredentials:t=!1}=A,n=r(A,i);return fetch(e,Object.assign({credentials:t?"include":"omit"},n)).then(A=>A.ok?A.text():Promise.reject(A.status))}}},function(A,e){let t=0;const n=[],i=()=>{t<100&&n.length>0&&(t++,(A=>{let e,[n,r,o]=A,s=0;const a=()=>fetch(r,o).then(A=>A.ok||0===A.status?A.arrayBuffer():404===A.status?null:Promise.reject(A.status)).then(A=>(t--,i(),A)).catch(A=>{if(403===A)throw A;if(console.warn("Attempt to fetch ".concat(r," failed"),A),e||(e=A),s<2)return s++,new Promise(A=>setTimeout(A,5e3*(s+Math.random()-1))).then(a);throw t--,i(),e});n(a())})(n.shift()))};A.exports=(A,e)=>new Promise(t=>{n.push([t,A,e]),i()})},function(A,e,t){const n=t(487),i=t(51),r=t(489),o=t(490),s=t(492),a=t(493),B=t(494),c=t(495),g=t(496),E=t(119),Q=t(497);A.exports=class{constructor(){let A=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(()=>{const A=window.AudioContext||window.webkitAudioContext;if(!A)throw new Error("Browser does not support AudioContext");return new A})();this.audioContext=A,this.inputNode=this.audioContext.createGain(),this.inputNode.connect(this.audioContext.destination),this.audioBuffers={},this.loudness=null,this.effects=[c,g,E],n(this.audioContext)}get currentTime(){return this.audioContext.currentTime}get EFFECT_NAMES(){return{pitch:"pitch",pan:"pan"}}get DECAY_DURATION(){return.025}get DECAY_WAIT(){return.05}getInputNode(){return this.inputNode}_decodeSound(A){const e=A.data.buffer.slice(0),t=r();var n,s;return(n=this.audioContext,s=e,1===n.decodeAudioData.length?n.decodeAudioData(s):new Promise((A,e)=>{n.decodeAudioData(s,e=>A(e),A=>e(A))})).catch(()=>{if(0===A.data.length)return this._emptySound();const e=A.data.buffer.slice(0);return new o(this.audioContext).decode(e).catch(()=>this._emptySound())}).then(A=>[t,A],A=>{i.warn("audio data could not be decoded",A)})}_emptySound(){return this.audioContext.createBuffer(1,1,this.audioContext.sampleRate)}decodeSound(A){return this._decodeSound(A).then(A=>{let[e,t]=A;return this.audioBuffers[e]=t,e})}decodeSoundPlayer(A){return this._decodeSound(A).then(A=>{let[e,t]=A;return new a(this,{id:e,buffer:t})})}getLoudness(){return this.loudness||(this.loudness=new s(this.audioContext)),this.loudness.getLoudness()}createEffectChain(){const A=new B(this,this.effects);return A.connect(this),A}createBank(){return new Q(this,this.createEffectChain())}}},function(A,e,t){const n=t(488);A.exports=function(A){if("undefined"!=typeof document)return n(A)}},function(A,e){const t=["mousedown","mouseup","keydown","keyup","touchstart","touchend"];A.exports=A=>{if("running"===A.state)return;const e=()=>{"running"===A.state&&(()=>{A.removeEventListener("statechange",e);for(const A of t)document.body.removeEventListener(A,n)})()};A.addEventListener("statechange",e);const n=()=>{A.resume()};for(const A of t)document.body.addEventListener(A,n)}},function(A,e){const t="!#%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";A.exports=function(){const A=t.length,e=[];for(let n=0;n<20;n++)e[n]=t.charAt(Math.random()*A);return e.join("")}},function(A,e,t){const n=t(491),i=t(51),r=[7,8,9,10,11,12,13,14,16,17,19,21,23,25,28,31,34,37,41,45,50,55,60,66,73,80,88,97,107,118,130,143,157,173,190,209,230,253,279,307,337,371,408,449,494,544,598,658,724,796,876,963,1060,1166,1282,1411,1552,1707,1878,2066,2272,2499,2749,3024,3327,3660,4026,4428,4871,5358,5894,6484,7132,7845,8630,9493,10442,11487,12635,13899,15289,16818,18500,20350,22385,24623,27086,29794,32767],o=[-1,-1,-1,-1,2,4,6,8,-1,-1,-1,-1,2,4,6,8];let s=null;A.exports=class{constructor(A){this.audioContext=A}static get STEP_TABLE(){return r}static get INDEX_TABLE(){return o}decode(A){return new Promise((e,t)=>{const r=new n(A);"RIFF"!==r.readUint8String(4)&&(i.warn("incorrect adpcm wav header"),t());const o=r.readInt32();o+8!==A.byteLength&&i.warn("adpcm wav length in header: ".concat(o," is incorrect"));"WAVE"!==r.readUint8String(4)&&(i.warn("incorrect adpcm wav header"),t());const s=this.extractChunk("fmt ",r);this.encoding=s.readUint16(),this.channels=s.readUint16(),this.samplesPerSecond=s.readUint32(),this.bytesPerSecond=s.readUint32(),this.blockAlignment=s.readUint16(),this.bitsPerSample=s.readUint16(),s.position+=2,this.samplesPerBlock=s.readUint16(),this.adpcmBlockSize=(this.samplesPerBlock-1)/2+4;const a=this.extractChunk("data",r),B=this.numberOfSamples(a,this.adpcmBlockSize),c=this.audioContext.createBuffer(1,B,this.samplesPerSecond);this.imaDecompress(a,this.adpcmBlockSize,c.getChannelData(0)),e(c)})}extractChunk(A,e){for(e.position=12;e.position<e.getLength()-8;){const t=e.readUint8String(4),n=e.readInt32();if(t===A){return e.extract(n)}e.position+=n}}numberOfSamples(A,e){if(!A)return 0;A.position=0;const t=A.getBytesAvailable();return(t/e|0)*(2*(e-4))+1+2*Math.max(t%e-4,0)+Math.min(t%e,1)}imaDecompress(A,e,t){let n,i,a,B=0,c=-1;if(!A)return;A.position=0;const g=t.length,E=2*(e-4),Q=function(){if(null===s){const A=r.length,e=o.length;s=new Array(A*e).fill(0);let t=0;for(let n=0;n<A;n++)for(let A=0;A<e;A++){const e=r[n];let i=0;4&A&&(i+=e),2&A&&(i+=e>>1),1&A&&(i+=e>>2),i+=e>>3,s[t++]=8&A?-i:i}}return s}();let u=0;for(;u<g;){n=A.readInt16(),B=A.readUint8(),A.position++,B>88&&(B=88),t[u++]=n/32768;const e=Math.min(E,g-u),r=u;for(;u-r<e;)c=A.readUint8(),i=15&c,a=Q[16*B+i],B+=o[i],B>88?B=88:B<0&&(B=0),n+=a,n>32767?n=32767:n<-32768&&(n=-32768),t[u++]=n/32768,i=c>>4&15,a=Q[16*B+i],B+=o[i],B>88?B=88:B<0&&(B=0),n+=a,n>32767?n=32767:n<-32768&&(n=-32768),t[u++]=n/32768}}}},function(A,e){class t{constructor(A){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:A.byteLength,{_uint8View:n=new Uint8Array(A)}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.arrayBuffer=A,this.start=e,this.end=t,this._uint8View=n,this._position=e}extract(A){return new t(this.arrayBuffer,this._position,this._position+A,this)}getLength(){return this.end-this.start}getBytesAvailable(){return this.end-this._position}get position(){return this._position-this.start}set position(A){return this._position=A+this.start,A}readUint8(){const A=this._uint8View[this._position];return this._position+=1,A}readUint8String(A){const e=this._uint8View;let t="";const n=this._position+A;for(let A=this._position;A<n;A++)t+=String.fromCharCode(e[A]);return this._position+=A,t}readInt16(){const A=new Int16Array(this.arrayBuffer,this._position,1)[0];return this._position+=2,A}readUint16(){const A=new Uint16Array(this.arrayBuffer,this._position,1)[0];return this._position+=2,A}readInt32(){let A;return A=this._position%4==0?new Int32Array(this.arrayBuffer,this._position,1)[0]:new Int32Array(this.arrayBuffer.slice(this._position,this._position+4))[0],this._position+=4,A}readUint32(){const A=new Uint32Array(this.arrayBuffer,this._position,1)[0];return this._position+=4,A}}A.exports=t},function(A,e,t){const n=t(51);A.exports=class{constructor(A){this.audioContext=A,this.connectingToMic=!1,this.mic=null}getLoudness(){if(this.mic||this.connectingToMic||(this.connectingToMic=!0,navigator.mediaDevices.getUserMedia({audio:!0}).then(A=>{this.audioStream=A,this.mic=this.audioContext.createMediaStreamSource(A),this.analyser=this.audioContext.createAnalyser(),this.mic.connect(this.analyser),this.micDataArray=new Float32Array(this.analyser.fftSize)}).catch(A=>{n.warn(A)})),this.mic&&this.audioStream.active){this.analyser.getFloatTimeDomainData(this.micDataArray);let A=0;for(let e=0;e<this.micDataArray.length;e++)A+=Math.pow(this.micDataArray[e],2);let e=Math.sqrt(A/this.micDataArray.length);return this._lastValue&&(e=Math.max(e,.6*this._lastValue)),this._lastValue=e,e*=1.63,e=Math.sqrt(e),e=Math.round(100*e),e=Math.min(e,100),e}return-1}}},function(A,e,t){const{EventEmitter:n}=t(27),i=t(119);class r extends n{constructor(A,e){let{id:t,buffer:n}=e;super(),this.id=t,this.audioEngine=A,this.buffer=n,this.outputNode=null,this.volumeEffect=null,this.target=null,this.initialized=!1,this.isPlaying=!1,this.startingUntil=0,this.playbackRate=1,this.stopFadeDecay=0,this.handleEvent=this.handleEvent.bind(this)}get isStarting(){return this.isPlaying&&this.startingUntil>this.audioEngine.currentTime}handleEvent(A){"ended"===A.type&&this.onEnded()}onEnded(){this.emit("stop"),this.isPlaying=!1}_createSource(){null!==this.outputNode&&(this.outputNode.removeEventListener("ended",this.handleEvent),this.outputNode.disconnect()),this.outputNode=this.audioEngine.audioContext.createBufferSource(),this.outputNode.playbackRate.value=this.playbackRate,this.outputNode.buffer=this.buffer,this.outputNode.addEventListener("ended",this.handleEvent),null!==this.target&&this.connect(this.target)}initialize(){this.initialized=!0,this._createSource()}connect(A){return A===this.volumeEffect?(this.outputNode.disconnect(),void this.outputNode.connect(this.volumeEffect.getInputNode())):(this.target=A,this.initialized?(null===this.volumeEffect?(this.outputNode.disconnect(),this.outputNode.connect(A.getInputNode())):this.volumeEffect.connect(A),this):void 0)}dispose(){this.initialized&&(this.stopImmediately(),null!==this.volumeEffect&&(this.volumeEffect.dispose(),this.volumeEffect=null),this.outputNode.disconnect(),this.outputNode=null,this.target=null,this.initialized=!1)}take(){this.outputNode&&this.outputNode.removeEventListener("ended",this.handleEvent);const A=new r(this.audioEngine,this);return A.playbackRate=this.playbackRate,this.isPlaying&&(A.startingUntil=this.startingUntil,A.isPlaying=this.isPlaying,A.initialized=this.initialized,A.outputNode=this.outputNode,A.outputNode.addEventListener("ended",A.handleEvent),A.volumeEffect=this.volumeEffect,A.volumeEffect&&(A.volumeEffect.audioPlayer=A),null!==this.target&&A.connect(this.target),this.emit("stop"),A.emit("play")),this.outputNode=null,this.volumeEffect=null,this.initialized=!1,this.startingUntil=0,this.isPlaying=!1,A}play(A){if(this.isStarting)return this.emit("stop"),void this.emit("play");this.isPlaying&&this.stop(),this.initialized?this._createSource():this.initialize(),"number"==typeof A?this.outputNode.start(0,A):this.outputNode.start(),this.isPlaying=!0;const{currentTime:e,DECAY_DURATION:t}=this.audioEngine;this.startingUntil=e+(t+this.stopFadeDecay),this.emit("play")}stop(){if(!this.isPlaying)return;const A=this.take();A.volumeEffect=new i(A.audioEngine,A,null),A.volumeEffect.connect(A.target),A.finished().then(()=>A.dispose()),A.volumeEffect.set(0,this.stopFadeDecay);const{currentTime:e,DECAY_DURATION:t}=this.audioEngine;A.outputNode.stop(e+(t+this.stopFadeDecay))}stopImmediately(){this.isPlaying&&(this.outputNode.stop(),this.isPlaying=!1,this.startingUntil=0,this.emit("stop"))}finished(){return new Promise(A=>{this.once("stop",A)})}setPlaybackRate(A){this.playbackRate=A,this.initialized&&(this.outputNode.playbackRate.value=A)}}A.exports=r},function(A,e){class t{constructor(A,e){this.audioEngine=A,this.inputNode=this.audioEngine.audioContext.createGain(),this.effects=e;let t=null;this._effects=e.reverse().map(e=>{const n=new e(A,this,t);return this[n.name]=n,t=n,n}).reverse(),this.firstEffect=this._effects[0],this.lastEffect=this._effects[this._effects.length-1],this._soundPlayers=new Set}clone(){const A=new t(this.audioEngine,this.effects);return this.target&&A.connect(this.target),A}addSoundPlayer(A){this._soundPlayers.has(A)||(this._soundPlayers.add(A),this.update())}removeSoundPlayer(A){this._soundPlayers.remove(A)}getInputNode(){return this.inputNode}connect(A){const{firstEffect:e,lastEffect:t}=this;if(A===t)return this.inputNode.disconnect(),void this.inputNode.connect(t.getInputNode());A!==e&&(this.target=A,e.connect(A))}getSoundPlayers(){return[...this._soundPlayers]}setEffectsFromTarget(A){this._effects.forEach(e=>{"soundEffects"in A&&e.name in A.soundEffects?e.set(A.soundEffects[e.name]):e.name in A&&e.set(A[e.name])})}set(A,e){A in this&&this[A].set(e)}update(){this._effects.forEach(A=>A.update())}clear(){this._effects.forEach(A=>A.clear())}dispose(){this._soundPlayers=null,this._effects.forEach(A=>A.dispose()),this._effects=null}}A.exports=t},function(A,e,t){const n=t(76);A.exports=class extends n{constructor(A,e,t){super(A,e,t),this.leftGain=null,this.rightGain=null,this.channelMerger=null}get name(){return"pan"}initialize(){const A=this.audioEngine.audioContext;this.inputNode=A.createGain(),this.leftGain=A.createGain(),this.rightGain=A.createGain(),this.channelMerger=A.createChannelMerger(2),this.outputNode=this.channelMerger,this.inputNode.connect(this.leftGain),this.inputNode.connect(this.rightGain),this.leftGain.connect(this.channelMerger,0,0),this.rightGain.connect(this.channelMerger,0,1),this.initialized=!0}_set(A){this.value=A;const e=(A+100)/200,t=Math.cos(e*Math.PI/2),n=Math.sin(e*Math.PI/2),{currentTime:i,DECAY_WAIT:r,DECAY_DURATION:o}=this.audioEngine;this.leftGain.gain.setTargetAtTime(t,i+r,o),this.rightGain.gain.setTargetAtTime(n,i+r,o)}dispose(){this.initialized&&(this.inputNode.disconnect(),this.leftGain.disconnect(),this.rightGain.disconnect(),this.channelMerger.disconnect(),this.inputNode=null,this.leftGain=null,this.rightGain=null,this.channelMerger=null,this.outputNode=null,this.target=null,this.initialized=!1)}}},function(A,e,t){const n=t(76);A.exports=class extends n{constructor(A,e,t){super(A,e,t),this.ratio=1}get name(){return"pitch"}get _isPatch(){return!1}getInputNode(){return this.target.getInputNode()}initialize(){this.initialized=!0}_set(A){this.value=A,this.ratio=this.getRatio(this.value),this.updatePlayers(this.audioPlayer.getSoundPlayers())}update(){this.updatePlayers(this.audioPlayer.getSoundPlayers())}getRatio(A){const e=A/10;return Math.pow(2,e/12)}updatePlayer(A){A.setPlaybackRate(this.ratio)}updatePlayers(A){if(A)for(const e in A)Object.prototype.hasOwnProperty.call(A,e)&&this.updatePlayer(A[e])}}},function(A,e,t){const n=t(51);A.exports=class{constructor(A,e){this.audioEngine=A,this.soundPlayers={},this.playerTargets=new Map,this.soundEffects=new Map,this.effectChainPrime=e}addSoundPlayer(A){this.soundPlayers[A.id]=A}getSoundPlayer(A){return this.soundPlayers[A]||n.error("SoundBank.getSoundPlayer(".concat(A,"): called missing sound in bank")),this.soundPlayers[A]}getSoundEffects(A){return this.soundEffects.has(A)||this.soundEffects.set(A,this.effectChainPrime.clone()),this.soundEffects.get(A)}playSound(A,e,t){const n=this.getSoundEffects(e),i=this.getSoundPlayer(e);return this.playerTargets.get(e)!==A&&i.stop(),this.playerTargets.set(e,A),n.addSoundPlayer(i),n.setEffectsFromTarget(A),i.connect(n),i.play(t),i.finished()}setEffects(A){this.playerTargets.forEach((e,t)=>{e===A&&this.getSoundEffects(t).setEffectsFromTarget(A)})}stop(A,e){this.playerTargets.get(e)===A&&this.soundPlayers[e].stop()}stopAllSounds(){let A=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"*";this.playerTargets.forEach((e,t)=>{"*"!==A&&e!==A||this.getSoundPlayer(t).stop()})}dispose(){this.playerTargets.clear(),this.soundEffects.forEach(A=>A.dispose()),this.soundEffects.clear();for(const A in this.soundPlayers)Object.prototype.hasOwnProperty.call(this.soundPlayers,A)&&this.soundPlayers[A].dispose();this.soundPlayers={}}}},function(A,e,t){"use strict";t.r(e),t.d(e,"SB1File",(function(){return ne})),t.d(e,"AssertionError",(function(){return n})),t.d(e,"ValidationError",(function(){return i}));class n extends Error{}class i extends n{}const r=function(A,e){if(!A)throw new n(e)};r.validate=function(A,e){if(!A)throw new i(e)};class o{constructor(A){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.buffer=A,this.position=e,this.uint8a=new Uint8Array(this.buffer)}read(A){const e=A.read(this.uint8a,this.position);return 0===A.size?this.position+=A.sizeOf(this.uint8a,this.position):this.position+=A.size,e}readStruct(A){const e=new A(this.uint8a,this.position);return this.position+=A.size,e}resize(A){if(this.buffer.byteLength<A){const e=this.uint8a,t=Math.pow(2,Math.ceil(Math.log(A)/Math.log(2)));this.buffer=new ArrayBuffer(t),this.uint8a=new Uint8Array(this.buffer),this.uint8a.set(e)}}write(A,e){return 0===A.size?this.resize(this.position+A.writeSizeOf(e)):this.resize(this.position+A.size),A.write(this.uint8a,this.position,e),0===A.size?this.position+=A.writeSizeOf(this.uint8a,this.position):this.position+=A.size,e}writeStruct(A,e){this.resize(this.position+A.size);const t=Object.assign(new A(this.uint8a,this.position),e);return this.position+=A.size,t}writeBytes(A){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:A.length;r(A instanceof Uint8Array,"writeBytes must be passed an Uint8Array"),this.resize(this.position+(t-e));for(let n=e;n<t;n++)this.uint8a[this.position+n-e]=A[n];return this.position+=t-e,A}}class s{constructor(A){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;this.iter=A,this.maxPosition=e}[Symbol.iterator](){return this}next(){return this.iter.stream.position>=this.maxPosition?{value:null,done:!0}:this.iter.next()}}const a=()=>{throw new Error("Not implemented")},B=(()=>{const A=new Uint16Array(1),e=new Uint8Array(A.buffer);return A[0]=43707,187===e[0]})();class c{constructor(A){let{size:e=0,sizeOf:t=(()=>e),writeSizeOf:n=a,toBytes:i=new Uint8Array(1),read:r,write:o=a}=A;this.size=e,this.sizeOf=t,this.writeSizeOf=n,this.toBytes=i,this.bytes=new Uint8Array(i.buffer),this.read=r,this.write=o}asPropertyObject(A){const e=this;return{get(){return e.read(this.uint8a,A+this.offset)},set(t){return e.write(this.uint8a,A+this.offset,t)},enumerable:!0}}read(){return null}}const g=new c({size:1,read:(A,e)=>A[e],write:(A,e,t)=>(A[e]=t,t)}),E={size:2,read(A,e){return this.bytes[1]=A[e+0],this.bytes[0]=A[e+1],this.toBytes[0]},write(A,e,t){return this.toBytes[0]=t,A[e+0]=this.bytes[1],A[e+1]=this.bytes[0],t}},Q={size:2,read(A,e){return this.bytes[0]=A[e+0],this.bytes[1]=A[e+1],this.toBytes[0]},write(A,e,t){return this.toBytes[0]=t,A[e+0]=this.bytes[0],A[e+1]=this.bytes[1],t}};let u;u=B?E:Q;new c(Object.assign({},u,{toBytes:new Uint16Array(1)}));const l=new c(Object.assign({},u,{toBytes:new Int16Array(1)})),w={size:4,read(A,e){return this.bytes[3]=A[e+0],this.bytes[2]=A[e+1],this.bytes[1]=A[e+2],this.bytes[0]=A[e+3],this.toBytes[0]},write(A,e,t){return this.toBytes[0]=t,A[e+0]=this.bytes[3],A[e+1]=this.bytes[2],A[e+2]=this.bytes[1],A[e+3]=this.bytes[0],t}},h={size:4,read(A,e){return this.bytes[0]=A[e+0],this.bytes[1]=A[e+1],this.bytes[2]=A[e+2],this.bytes[3]=A[e+3],this.toBytes[0]},write(A,e,t){return this.toBytes[0]=t,A[e+0]=this.bytes[0],A[e+1]=this.bytes[1],A[e+2]=this.bytes[2],A[e+3]=this.bytes[3],t}};let C;C=B?w:h;const I=new c(Object.assign({},C,{toBytes:new Int32Array(1)})),M=new c(Object.assign({},C,{toBytes:new Uint32Array(1)}));let d;d=B?Q:E;const m=new c(Object.assign({},d,{toBytes:new Uint16Array(1)}));let p;p=B?h:w;const F=new c(Object.assign({},p,{toBytes:new Uint32Array(1)}));let D;D=B?{size:8,read(A,e){return this.bytes[7]=A[e+0],this.bytes[6]=A[e+1],this.bytes[5]=A[e+2],this.bytes[4]=A[e+3],this.bytes[3]=A[e+4],this.bytes[2]=A[e+5],this.bytes[1]=A[e+6],this.bytes[0]=A[e+7],this.toBytes[0]}}:{size:8,read(A,e){return this.bytes[7]=A[e+0],this.bytes[6]=A[e+1],this.bytes[5]=A[e+2],this.bytes[4]=A[e+3],this.bytes[3]=A[e+4],this.bytes[2]=A[e+5],this.bytes[1]=A[e+6],this.bytes[0]=A[e+7],this.toBytes[0]}};const Y=new c(Object.assign({},D,{toBytes:new Float64Array(1)}));class f extends c{constructor(A){super({size:A,read(e,t){let n="";for(let i=0;i<A;i++){const A=e[t+i];r(A<=127,"Non-ascii character in FixedAsciiString"),n+=String.fromCharCode(A)}return n},write(e,t,n){for(let i=0;i<A;i++){const A=n.charCodeAt(i);r(A<=127,"Non-ascii character in FixedAsciiString"),e[t+i]=A}return n}})}}var N=t(30);let U;U=new c(B?{size:3,read:(A,e)=>A[e+0]<<16|A[e+1]<<8|A[e+2]}:{size:3,read:(A,e)=>A[e+2]<<16|A[e+1]<<8|A[e+0]});const y=new c({sizeOf(A,e){const t=l.read(A,e);return l.size+t},read(A,e){let t=0,n=0;const i=l.read(A,e);for(let r=0;r<i;r++)t+=n*g.read(A,e++),n*=256;return t}}),T=new c({sizeOf(A,e){const t=M.read(A,e);return M.size+t},read(A,e){const t=M.read(A,e);r(t<10485760,"asciiString too big"),e+=4;let n="";for(let i=0;i<t;i++)n+=String.fromCharCode(A[e++]);return n}}),x=new c({sizeOf:(A,e)=>M.size+M.read(A,e),read(A,e){const t=M.read(A,e);return r(t<10485760,"bytes too big"),e+=M.size,r(t<10485760,"uint8a array too big"),new Uint8Array(A.buffer,e,t)}}),R=new c({sizeOf:(A,e)=>M.size+2*M.read(A,e),read(A,e){const t=M.read(A,e);r(t<10485760,"sound too big"),e+=M.size;const n=2*t;return r(n<10485760,"uint8a array too big"),new Uint8Array(A.buffer,e,n)}}),G=new c({sizeOf:(A,e)=>M.size+M.read(A,e)*M.size,read(A,e){const t=M.read(A,e);r(t<10485760,"bitmap too big"),e+=M.size,r(t<10485760,"uint8a array too big");const n=new Uint32Array(t);for(let i=0;i<t;i++)n[i]=M.read(A,e),e+=M.size;return n}});let S;S="undefined"==typeof TextDecoder?new N.TextDecoder:new TextDecoder;const H=new c({sizeOf:(A,e)=>M.size+M.read(A,e),read(A,e){const t=M.read(A,e);return r(t<10485760,"utf8 too big"),e+=M.size,r(t<10485760,"uint8a array too big"),S.decode(new Uint8Array(A.buffer,e,t))}}),b=new c({size:4,read(A,e){const t=M.read(A,e);return(255<<24|(t>>22&255)<<16|(t>>12&255)<<8|t>>2&255)>>>0}}),v=new c({size:5,read(A,e){const t=M.read(A,e);return(g.read(A,e)<<24|(t>>22&255)<<16|(t>>12&255)<<8|t>>2&255)>>>0}}),k={NULL:1,TRUE:2,FALSE:3,SMALL_INT:4,SMALL_INT_16:5,LARGE_INT_POSITIVE:6,LARGE_INT_NEGATIVE:7,FLOATING:8,STRING:9,SYMBOL:10,BYTES:11,SOUND:12,BITMAP:13,UTF8:14,ARRAY:20,ORDERED_COLLECTION:21,SET:22,IDENTITY_SET:23,DICTIONARY:24,IDENTITY_DICTIONARY:25,COLOR:30,TRANSLUCENT_COLOR:31,POINT:32,RECTANGLE:33,FORM:34,SQUEAK:35,OBJECT_REF:99,MORPH:100,ALIGNMENT:104,STATIC_STRING:105,UPDATING_STRING:106,SAMPLED_SOUND:109,IMAGE_MORPH:110,SPRITE:124,STAGE:125,WATCHER:155,IMAGE_MEDIA:162,SOUND_MEDIA:164,MULTILINE_STRING:171,WATCHER_READOUT_FRAME:173,WATCHER_SLIDER:174,LIST_WATCHER:175},j=Object.entries(k).reduce((A,e)=>{let[t,n]=e;return A[n]=t,A},{});class J{constructor(A,e){this.classId=A,this.position=e}}const z=A=>"object"==typeof A&&A?A.valueOf():A;class L extends J{constructor(A,e,t){super(A,e),this.value=t}valueOf(){return this.value}toJSON(){return this.classId===k.TRANSLUCENT_COLOR||this.classId===k.COLOR?16777215&this.value:this.value}toString(){return this.value}}class P extends J{constructor(A,e,t){super(A,e),this.size=t}}class O extends J{constructor(A,e,t){super(A,e),this.index=t}valueOf(){return"Ref(".concat(this.index,")")}}class V extends P{constructor(A,e,t,n){super(A,e,n),this.version=t}}class W{constructor(A){let{type:e=L,read:t,value:n=(t?A=>A.read(t):null)}=A;this.type=e,this.value=n}next(A,e,t){return{value:new this.type(e,t,this.value(A)),done:!1}}}const K={[k.NULL]:{value:()=>null},[k.TRUE]:{value:()=>!0},[k.FALSE]:{value:()=>!1},[k.SMALL_INT]:{read:I},[k.SMALL_INT_16]:{read:l},[k.LARGE_INT_POSITIVE]:{read:y},[k.LARGE_INT_NEGATIVE]:{read:y},[k.FLOATING]:{read:Y},[k.STRING]:{read:T},[k.SYMBOL]:{read:T},[k.BYTES]:{read:x},[k.SOUND]:{read:R},[k.BITMAP]:{read:G},[k.UTF8]:{read:H},[k.ARRAY]:{type:P,read:I},[k.ORDERED_COLLECTION]:{type:P,read:I},[k.SET]:{type:P,read:I},[k.IDENTITY_SET]:{type:P,read:I},[k.DICTIONARY]:{type:P,value:A=>2*A.read(I)},[k.IDENTITY_DICTIONARY]:{type:P,value:A=>2*A.read(I)},[k.COLOR]:{read:b},[k.TRANSLUCENT_COLOR]:{read:v},[k.POINT]:{type:P,value:()=>2},[k.RECTANGLE]:{type:P,value:()=>4},[k.FORM]:{type:P,value:()=>5},[k.SQUEAK]:{type:P,value:()=>6},[k.OBJECT_REF]:{type:O,read:U}},X=Array.from({length:256},(A,e)=>K[e]?new W(K[e]):null),Z=new W({type:class extends P{constructor(A,e){super(A,e,0)}},value:()=>null});class _{constructor(A,e){this.buffer=A,this.stream=new o(A,e)}[Symbol.iterator](){return this}next(){if(this.stream.position>=this.stream.uint8a.length)return{value:null,done:!0};const A=this.stream.position,e=this.stream.read(g),t=X[e];if(null!==t)return t.next(this.stream,e,A);if(e<k.OBJECT_REF)return Z.next(this.stream,e,A);const n=this.stream.read(g),i=this.stream.read(g);return{value:new V(e,A,n,i),done:!1}}}class q{constructor(A){let{classId:e,version:t,fields:n}=A;this.classId=e,this.version=t,this.fields=n}get FIELDS(){return[]}get RAW_FIELDS(){return this.fields}string(A){return String(this.fields[A])}number(A){return+this.fields[A]}boolean(A){return!!this.fields[A]}toString(){return this.constructor===q?"".concat(this.constructor.name," ").concat(this.classId," ").concat(j[this.classId]):this.constructor.name}static define(A){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:q;class t extends e{get FIELDS(){return A}static get FIELDS(){return A}}return Object.keys(A).forEach(e=>{const n=A[e];Object.defineProperty(t.prototype,e.toLowerCase().replace(/_(\w)/g,A=>{let[,e]=A;return e.toUpperCase()}),{get(){return this.fields[n]}})}),t}}class ${constructor(){let A;this.bit=new Uint32Array(1),this.crc=0,this.c=0,this.table=[];for(let e=0;e<256;e++){A=e;for(let e=0;e<8;e++)A=1&A?3988292384^A>>>1:A>>>1;this.table[e]=A>>>0}}update(A){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:A.length,n=~this.crc>>>0;for(let i=0;i<t;i++)n=n>>>8^this.table[255&(n^A[e+i])];return this.crc=~n>>>0,this}get digest(){return this.crc}}const AA=[0,4278190080,4294967295,4286611584,4294901760,4278255360,4278190335,4278255615,4294967040,4294902015,4280295456,4282400832,4284506208,4288651167,4290756543,4292861919,4278716424,4279242768,4279769112,4280821800,4281348144,4281874488,4282927176,4283453520,4283979864,4285032552,4285558896,4286085240,4287072135,4287598479,4288124823,4289177511,4289703855,4290230199,4291282887,4291809231,4292335575,4293388263,4293914607,4294440951,4278190080,4278203136,4278216192,4278229248,4278242304,4278255360,4278190131,4278203187,4278216243,4278229299,4278242355,4278255411,4278190182,4278203238,4278216294,4278229350,4278242406,4278255462,4278190233,4278203289,4278216345,4278229401,4278242457,4278255513,4278190284,4278203340,4278216396,4278229452,4278242508,4278255564,4278190335,4278203391,4278216447,4278229503,4278242559,4278255615,4281532416,4281545472,4281558528,4281571584,4281584640,4281597696,4281532467,4281545523,4281558579,4281571635,4281584691,4281597747,4281532518,4281545574,4281558630,4281571686,4281584742,4281597798,4281532569,4281545625,4281558681,4281571737,4281584793,4281597849,4281532620,4281545676,4281558732,4281571788,4281584844,4281597900,4281532671,4281545727,4281558783,4281571839,4281584895,4281597951,4284874752,4284887808,4284900864,4284913920,4284926976,4284940032,4284874803,4284887859,4284900915,4284913971,4284927027,4284940083,4284874854,4284887910,4284900966,4284914022,4284927078,4284940134,4284874905,4284887961,4284901017,4284914073,4284927129,4284940185,4284874956,4284888012,4284901068,4284914124,4284927180,4284940236,4284875007,4284888063,4284901119,4284914175,4284927231,4284940287,4288217088,4288230144,4288243200,4288256256,4288269312,4288282368,4288217139,4288230195,4288243251,4288256307,4288269363,4288282419,4288217190,4288230246,4288243302,4288256358,4288269414,4288282470,4288217241,4288230297,4288243353,4288256409,4288269465,4288282521,4288217292,4288230348,4288243404,4288256460,4288269516,4288282572,4288217343,4288230399,4288243455,4288256511,4288269567,4288282623,4291559424,4291572480,4291585536,4291598592,4291611648,4291624704,4291559475,4291572531,4291585587,4291598643,4291611699,4291624755,4291559526,4291572582,4291585638,4291598694,4291611750,4291624806,4291559577,4291572633,4291585689,4291598745,4291611801,4291624857,4291559628,4291572684,4291585740,4291598796,4291611852,4291624908,4291559679,4291572735,4291585791,4291598847,4291611903,4291624959,4294901760,4294914816,4294927872,4294940928,4294953984,4294967040,4294901811,4294914867,4294927923,4294940979,4294954035,4294967091,4294901862,4294914918,4294927974,4294941030,4294954086,4294967142,4294901913,4294914969,4294928025,4294941081,4294954137,4294967193,4294901964,4294915020,4294928076,4294941132,4294954188,4294967244,4294902015,4294915071,4294928127,4294941183,4294954239,4294967295],eA=[4294967295,4278190080],tA=new c({sizeOf(A,e){const t=A[e];return t<=223?1:t<=254?2:5},read(A,e){const t=A[e];return t<=223?t:t<=254?256*(t-224)+A[e+1]:M.read(A,e+1)}});class nA{decode(A,e,t,n,i){const r=this.decodePixels(n,32===t);if(t<=8)return i||(i=1===t?eA:AA),this.unpackPixels(r,A,e,t,i);if(16===t)return this.raster16To32(r,A,e);if(32===t)return r;throw new Error("Unhandled Squeak Image depth.")}decodePixels(A,e){let t;if(Array.isArray(A)||A instanceof Uint32Array){if(t=new Uint32Array(A),e)for(let A=0;A<t.length;A++)0!==t[A]&&(t[A]=4278190080|t[A]);return t}const n=new o(A.buffer,A.byteOffset),i=n.read(tA);t=new Uint32Array(i);let r=0;for(;r<i;){const A=n.read(tA),i=A>>2;let o;switch(3&A){case 0:r+=i;break;case 1:o=n.read(g),o|=o<<24|o<<16|o<<8,e&&0!==o&&(o|=4278190080);for(let A=0;A<i;A++)t[r++]=o;break;case 2:o=n.read(M),e&&0!==o&&(o|=4278190080);for(let A=0;A<i;A++)t[r++]=o;break;case 3:for(let A=0;A<i;A++)o=n.read(M),e&&0!==o&&(o|=4278190080),t[r++]=o}}return t}unpackPixels(A,e,t,n,i){const r=new Uint32Array(e*t),o=(1<<n)-1,s=32/n;let a=0,B=0;for(let c=0;c<t;c++){let t,c=-1;for(let g=0;g<e;g++)c<0&&(c=n*(s-1),t=A[B++]),r[a++]=i[t>>c&o],c-=n}return r}raster16To32(A,e,t){const n=new Uint32Array(2*A.length);let i,r,o,s=0,a=0;for(let B=0;B<t;B++){i=-1;for(let t=0;t<e;t++){if(i<0&&(i=16,r=A[s++]),o=r>>i&65535,0!==o){o=4278190080|(o>>7&248)<<16|(o>>2&248)<<8|o<<3&248}n[a++]=o,i-=16}}return n}buildCustomColormap(A,e,t){const n=new Uint32Array(1<<A);for(let A=0;A<e.length;A++)n[A]=t[e[A].index-1];return n}}const iA=[7,8,9,10,11,12,13,14,16,17,19,21,23,25,28,31,34,37,41,45,50,55,60,66,73,80,88,97,107,118,130,143,157,173,190,209,230,253,279,307,337,371,408,449,494,544,598,658,724,796,876,963,1060,1166,1282,1411,1552,1707,1878,2066,2272,2499,2749,3024,3327,3660,4026,4428,4871,5358,5894,6484,7132,7845,8630,9493,10442,11487,12635,13899,15289,16818,18500,20350,22385,24623,27086,29794,32767],rA={2:[-1,2,-1,2],3:[-1,-1,2,4,-1,-1,2,4],4:[-1,-1,-1,-1,2,4,6,8,-1,-1,-1,-1,2,4,6,8],5:[-1,-1,-1,-1,-1,-1,-1,-1,1,2,4,6,8,10,13,16,-1,-1,-1,-1,-1,-1,-1,-1,1,2,4,6,8,10,13,16]};class oA{constructor(A){this.bitsPerSample=A,this.indexTable=rA[A],this.signMask=1<<A-1,this.valueMask=this.signMask-1,this.valueHighBit=this.signMask>>1,this.bitPosition=0,this.currentByte=0,this.stream=null,this.end=0}decode(A){this.bitPosition=0,this.currentByte=0,this.stream=new o(A.buffer,A.byteOffset),this.end=A.byteOffset+A.length;const e=Math.floor(8*A.length/this.bitsPerSample),t=new Int16Array(e);let n=0,i=0;for(let A=0;A<e;A++){const e=this.nextCode();r(e>=0,"Ran out of bits in Squeak Sound");let o=iA[i],s=0;for(let A=this.valueHighBit;A>0;A>>=1)0!=(e&A)&&(s+=o),o>>=1;s+=o,n+=0==(e&this.signMask)?s:-s,i+=this.indexTable[e],i<0&&(i=0),i>88&&(i=88),n>32767&&(n=32767),n<-32768&&(n=-32768),t[A]=n}return t}nextCode(){let A=this.bitsPerSample,e=A-this.bitPosition,t=e<0?this.currentByte>>-e:this.currentByte<<e;for(;e>0;){if(A-=this.bitPosition,!(this.end-this.stream.position>0))return this.currentByte=0,this.bitPosition=0,-1;this.currentByte=this.stream.read(g),this.bitPosition=8,e=A-this.bitPosition,t+=e<0?this.currentByte>>-e:this.currentByte<<e}return this.bitPosition-=A,this.currentByte=this.currentByte&255>>8-this.bitPosition,t}static samples(A,e){return 8*e.length/A}}class sA{constructor(){let A=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Uint8Array(this.size),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.uint8a=A,this.offset=e}equals(A){for(const e in A)if(this[e]!==A[e])return!1;return!0}view(){const A=this.constructor.name,e={toString:()=>A};for(const A in this.shape)e[A]=this[A];return e}static initConstructor(A){return A.size=A.prototype.size,A}static extend(A){const e=class extends sA{get shape(){return A}};let t=0;return Object.keys(A).forEach(n=>{if(Object.defineProperty(e.prototype,n,A[n].asPropertyObject(t)),0===A[n].size)throw new Error("Packet cannot be defined with variable sized members.");t+=A[n].size}),e.prototype.size=t,e.size=t,e}}class aA extends(sA.extend({riff:new f(4),length:F,wave:new f(4)})){}sA.initConstructor(aA);class BA extends(sA.extend({chunkType:new f(4),length:F})){}sA.initConstructor(BA);class cA extends(sA.extend({format:m,channels:m,sampleRate:F,bytesPerSec:F,blockAlignment:m,bitsPerSample:m})){}sA.initConstructor(cA);class gA{encode(A){let{channels:e=1,sampleRate:t=22050}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=new Uint8Array(A.buffer,A.byteOffset,A.byteLength),i=aA.size+BA.size+cA.size+BA.size+n.length,r=new o(new ArrayBuffer(i));return r.writeStruct(aA,{riff:"RIFF",length:i-8,wave:"WAVE"}),r.writeStruct(BA,{chunkType:"fmt ",length:cA.size}),r.writeStruct(cA,{format:1,channels:e,sampleRate:t,bytesPerSec:2*t*e,blockAlignment:2*e,bitsPerSample:16}),r.writeStruct(BA,{chunkType:"data",length:i-r.position-BA.size}),r.writeBytes(n),r.uint8a}static encode(A,e){return(new gA).encode(A,e)}static samples(A){const e=new BA(A,aA.size).length;return new BA(A,aA.size+BA.size+e).length/2}}var EA=t(32),QA=t.n(EA);class uA extends(q.define({X:0,Y:1})){}class lA extends(q.define({X:0,Y:1,X2:2,Y2:3})){get width(){return this.x2-this.x}get height(){return this.y2-this.y}}class wA extends(q.define({WIDTH:0,HEIGHT:1,DEPTH:2,BYTES:4,COLORMAP:5})){get decoded(){return this._decoded||(this._decoded=(A=>{for(let e=0;e<A.length;e+=4){const t=A[e+2],n=A[e+0];A[e+2]=n,A[e+0]=t}return A})(new Uint8Array((new nA).decode(this.width.value,this.height.value,this.depth.value,this.bytes.value,this.colormap&&this.colormap.map(A=>A.valueOf())).buffer))),this._decoded}get extension(){return"uncompressed"}}class hA extends(q.define({STAGE_CONTENTS:2,OBJ_NAME:6,VARS:7,BLOCKS_BIN:8,IS_CLONE:9,MEDIA:10,CURRENT_COSTUME:11,ZOOM:12,H_PAN:13,V_PAN:14,OBSOLETE_SAVED_STATE:15,SPRITE_ORDER_IN_LIBRARY:16,VOLUME:17,TEMPO_BPM:18,SCENE_STATES:19,LISTS:20})){get spriteOrderInLibrary(){return this.fields[this.FIELDS.SPRITE_ORDER_IN_LIBRARY]||null}get tempoBPM(){return this.fields[this.FIELDS.TEMPO_BPM]||0}get lists(){return this.fields[this.FIELDS.LISTS]||[]}}class CA extends(q.define({BOX:0,PARENT:1,COLOR:3,VISIBLE:4,OBJ_NAME:6,VARS:7,BLOCKS_BIN:8,IS_CLONE:9,MEDIA:10,CURRENT_COSTUME:11,VISIBILITY:12,SCALE_POINT:13,ROTATION_DEGREES:14,ROTATION_STYLE:15,VOLUME:16,TEMPO_BPM:17,DRAGGABLE:18,SCENE_STATES:19,LISTS:20})){get scratchX(){return this.box.x+this.currentCostume.rotationCenter.x-240}get scratchY(){return 180-(this.box.y+this.currentCostume.rotationCenter.y)}get visible(){return 0==(1&this.fields[this.FIELDS.VISIBLE])}get tempoBPM(){return this.fields[this.FIELDS.TEMPO_BPM]||0}get lists(){return this.fields[this.FIELDS.LISTS]||[]}}q.define({RECTANGLE:0,FONT:8,COLOR:9,LINES:11});class IA extends(q.define({COSTUME_NAME:0,BITMAP:1,ROTATION_CENTER:2,TEXT_DETAILS:3,BASE_LAYER_DATA:4,OLD_COMPOSITE:5})){get image(){return this.oldComposite instanceof wA?this.oldComposite:this.baseLayerData.value?null:this.bitmap}get width(){return null===this.image?-1:this.image.width}get height(){return null===this.image?-1:this.image.height}get rawBytes(){return null===this.image?this.baseLayerData.value.slice():this.image.bytes.value}get decoded(){return null===this.image?this.baseLayerData.value.slice():this.image.decoded}get crc(){if(!this._crc){const A=(new $).update(new Uint8Array(new Uint32Array([this.bitmap.width]).buffer)).update(new Uint8Array(new Uint32Array([this.bitmap.height]).buffer)).update(new Uint8Array(new Uint32Array([this.bitmap.depth]).buffer)).update(this.rawBytes);this._crc=A.digest}return this._crc}get extension(){return this.oldComposite instanceof wA?"uncompressed":this.baseLayerData.value?"jpg":"uncompressed"}toString(){return'ImageMediaData "'.concat(this.costumeName,'"')}}class MA extends(q.define({DATA:3,RATE:4})){}class dA extends(q.define({NAME:0,UNCOMPRESSED:1,RATE:4,BITS_PER_SAMPLE:5,DATA:6})){get rate(){return 0!==this.uncompressed.data.value.length?this.uncompressed.rate:this.fields[this.FIELDS.RATE]}get rawBytes(){return this.data&&this.data.value?this.data.value:this.uncompressed.data.value}get decoded(){return this._decoded||(this.data&&this.data.value?this._decoded=new oA(this.bitsPerSample.value).decode(this.data.value):this._decoded=new Int16Array((A=>{const e=new Uint8Array(A);for(let t=0;t<e.length;t+=2)e[t]=A[t+1],e[t+1]=A[t];return e})(this.uncompressed.data.value.slice()).buffer)),this._decoded}get crc(){return this._crc||(this._crc=(new $).update(new Uint32Array([this.rate])).update(this.rawBytes).digest),this._crc}get sampleCount(){return this.data&&this.data.value?oA.samples(this.bitsPerSample.value,this.data.value):this.uncompressed.data.value.length/2}get extension(){return"pcm"}get wavEncodedData(){return this._wavEncodedData||(this._wavEncodedData=new Uint8Array(gA.encode(this.decoded,{sampleRate:this.rate&&this.rate.value}))),this._wavEncodedData}get md5(){return this._md5||(this._md5=QA()(this.wavEncodedData)),this._md5}toString(){return'SoundMediaData "'.concat(this.name,'"')}}class mA extends(q.define({BOX:0,HIDDEN_WHEN_NULL:1,LIST_NAME:8,CONTENTS:9,TARGET:10})){get x(){return null===z(this.hiddenWhenNull)?5:this.box.x+1}get y(){return null===z(this.hiddenWhenNull)?5:this.box.y+1}get width(){return this.box.width-2}get height(){return this.box.height-2}}class pA extends(q.define({BOX:0,PARENT:1,FRAMES:2,COLOR:3,DIRECTION:8,ALIGNMENT:9})){}class FA extends(q.define({BOX:0,PARENT:1,COLOR:3})){}class DA extends(q.define({BOX:0,COLOR:3,VALUE:8})){}class YA extends(q.define({BOX:0,READOUT_FRAME:1,COLOR:3,FONT:6,VALUE:8,TARGET:10,CMD:11,PARAM:13})){}class fA extends(q.define({BOX:0})){}const NA=1,UA=2,yA=3;class TA extends(q.define({BOX:0,TARGET:1,SHAPE:2,READOUT:14,READOUT_FRAME:15,SLIDER:16,ALIGNMENT:17,SLIDER_MIN:20,SLIDER_MAX:21})){get x(){return this.box.x}get y(){return this.box.y}get mode(){return null===z(this.slider)?this.readoutFrame.box.height<=14?NA:UA:yA}get isDiscrete(){return Math.floor(this.sliderMin)===this.sliderMin&&Math.floor(this.sliderMax)===this.sliderMax&&Math.floor(this.readout.value)===this.readout.value}}const xA={[k.POINT]:uA,[k.RECTANGLE]:lA,[k.FORM]:wA,[k.SQUEAK]:wA,[k.SAMPLED_SOUND]:MA,[k.SPRITE]:CA,[k.STAGE]:hA,[k.IMAGE_MEDIA]:IA,[k.SOUND_MEDIA]:dA,[k.ALIGNMENT]:pA,[k.MORPH]:FA,[k.WATCHER_READOUT_FRAME]:fA,[k.STATIC_STRING]:DA,[k.UPDATING_STRING]:YA,[k.WATCHER]:TA,[k.LIST_WATCHER]:mA},RA=Array.from({length:256},(A,e)=>xA[e]||null);class GA{constructor(A){this.valueIterator=A}[Symbol.iterator](){return this}next(){const A=this.valueIterator.next();if(A.done)return A;const e=A.value,{classId:t}=e;let n=e;if(e instanceof P){n=[];for(let A=0;A<e.size;A++)n.push(this.next().value)}if(null!==RA[t]||e instanceof V){n=new(RA[e.classId]||q)({classId:e.classId,version:e.version,fields:n})}return{value:n,done:!1}}}class SA{constructor(A){this.table=Array.from(A),this.fixed=this.fix(this.table)}fix(){const A=[];for(let e=0;e<this.table.length;e++)this.fixItem(this.table[e]),A.push(this.table[e]);return A}fixItem(A){if(void 0!==A.fields&&(A=A.fields),Array.isArray(A))for(let e=0;e<A.length;e++)A[e]=this.deref(A[e])}deref(A){return A instanceof O?this.table[A.index-1]:A}}class HA extends(sA.extend({support8Bit:g,png:new f(3),dosLineEnding:new f(2),dosEndOfFile:new f(1),unixLineEnding:new f(1)})){static validate(){r(this.equals({support8Bit:137,png:"PNG",dosLineEnding:"\r\n",dosEndOfFile:"",unixLineEnding:"\n"}),"PNGSignature does not match the expected values")}}sA.initConstructor(HA);class bA extends(sA.extend({length:M,chunkType:new f(4)})){}sA.initConstructor(bA);class vA extends(sA.extend({checksum:M})){}sA.initConstructor(vA);class kA extends(sA.extend({width:M,height:M,bitDepth:g,colorType:g,compressionMethod:g,filterMethod:g,interlaceMethod:g})){}sA.initConstructor(kA);class jA extends(sA.extend({method:g})){}sA.initConstructor(jA);class JA{constructor(){this.adler=1}update(A,e,t){let n=65535&this.adler,i=this.adler>>>16;for(let r=0;r<t;r++)n=(n+A[e+r])%65521,i=(i+n)%65521;return this.adler=i<<16|n,this}get digest(){return this.adler}}class zA extends(sA.extend({cmf:g,flag:g})){}sA.initConstructor(zA);class LA extends(sA.extend({lastPacket:g,length:m,lengthCheck:m})){}sA.initConstructor(LA);class PA extends(sA.extend({checksum:F})){}sA.initConstructor(PA);class OA{constructor(A){this.stream=A}get uint8a(){return this.stream.uint8a}set uint8a(A){return this.stream.uint8a=A,this.stream.uint8a}get position(){return this.stream.position}set position(A){return this.stream.position=A,this.stream.position}writeStruct(A,e){return this.stream.writeStruct(A,e)}writeBytes(A){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:A.length;return this.stream.writeBytes(A,e,t)}}class VA extends OA{constructor(A){super(A),this.stream.writeStruct(zA,{cmf:8,flag:29}),this.adler=new JA,this.chunk=this.stream.writeStruct(LA,{lastPacket:0,length:0,lengthCheck:65535})}get _deflateIndex(){return this.chunk.length}set _deflateIndex(A){return this.chunk.length=A,this.chunk.lengthCheck=65535^A,this.chunk.length}writeStruct(A,e){this.writeBytes(Object.assign(new A,e).uint8a)}writeBytes(A){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:A.length,n=e;for(;t-n>0;){65535===this._deflateIndex&&(this.chunk=this.stream.writeStruct(LA,{lastPacket:0,length:0,lengthCheck:65535}));const e=Math.min(t-n,65535-this._deflateIndex);this.stream.writeBytes(A,n,n+e),this._deflateIndex+=e,n+=e}this.adler.update(A,e,t-e)}finish(){this.chunk.lastPacket=1,this.stream.writeStruct(PA,{checksum:this.adler.digest})}static estimateSize(A){const e=Math.ceil(A/65535);return zA.size+e*LA.size+PA.size+A}}class WA extends OA{constructor(A){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"IHDR";super(A),this.start=this.stream.writeStruct(bA,{length:0,chunkType:e}),this.crc=new $}finish(){const A=this.start.offset+this.start.size,e=this.position-A;this.start.length=e,this.crc.update(this.stream.uint8a,A-M.size,e+M.size),this.stream.writeStruct(vA,{checksum:this.crc.digest})}static size(A){return bA.size+A+vA.size}}class KA{encode(A,e,t){const n=4*A+jA.size,i=n*e,r=HA.size+WA.size(kA.size)+WA.size(VA.estimateSize(i))+WA.size(0),s=new o(new ArrayBuffer(r));s.writeStruct(HA,{support8Bit:137,png:"PNG",dosLineEnding:"\r\n",dosEndOfFile:"",unixLineEnding:"\n"});const a=new WA(s,"IHDR");a.writeStruct(kA,{width:A,height:e,bitDepth:8,colorType:6,compressionMethod:0,filterMethod:0,interlaceMethod:0}),a.finish();const B=new WA(s,"IDAT"),c=new VA(B);let g=0;for(;g<t.length;){c.writeStruct(jA,{method:0});const A=Math.min(t.length-g,n-jA.size);c.writeBytes(t,g,g+A),g+=A}c.finish(),B.finish();return new WA(s,"IEND").finish(),s.buffer}static encode(A,e,t){return(new KA).encode(A,e,t)}}class XA{constructor(A){this.file=A}async(A){return r("uint8array"===A,"SB1FakeZipFile only supports uint8array"),Promise.resolve(this.file.bytes)}}class ZA{constructor(A){this.files=A}file(A){if(A in this.files)return new XA(this.files[A])}}const _A=A=>"uncompressed"===A.extension?new Uint8Array(KA.encode(A.width,A.height,A.decoded)):A.decoded,qA=A=>{const e=String(A[A.length-1]),t=A.length-1;return"mouse"===e?A[t]="_mouse_":"edge"===e?A[t]="_edge_":A[A.length-1]instanceof hA&&(A[t]="_stage_"),A},$A={getParam:A=>{let[e,t,n,i]=A;return[e,t,n,i||"r"]},changeVariable:A=>[A[2],A[1],A[3]],EventHatMorph:A=>"Scratch-StartClicked"===String(A[1])?["whenGreenFlag"]:["whenIReceive",A[1]],MouseClickEventHatMorph:()=>["whenClicked"],KeyEventHatMorph:A=>["whenKeyPressed",A[1]],stopScripts:A=>"other scripts"===String(A[1])?[A[0],"other scripts in sprite"]:A,abs:A=>["computeFunction:of:","abs",A[1]],sqrt:A=>["computeFunction:of:","sqrt",A[1]],"\\\\":A=>["%",...A.slice(1)],doReturn:()=>["stopScripts","this script"],stopAll:()=>["stopScripts","all"],"showBackground:":A=>["startScene",A[1]],nextBackground:()=>["nextScene"],doForeverIf:A=>["doForever",[["doIf",A[1],A[2]]]],"getAttribute:of:":qA,"gotoSpriteOrMouse:":qA,"distanceTo:":qA,"pointTowards:":qA,"touching:":qA},Ae=A=>{const{info:e,stageData:t,images:n,sounds:i}=A,r=A=>{const e=[];for(let t=0;t<A.length;t+=2)e.push([A[t],A[t+1]]);return e},o=A=>{let[e,t]=A;return{name:e,value:t,isPersistent:!1}},s=A=>{let[,{listName:e,contents:t,x:n,y:i,width:r,height:o,hiddenWhenNull:s}]=A;return{listName:e,contents:t,isPersistent:!1,x:n,y:i,width:r,height:o,visible:null!==(a=s,"object"==typeof a&&a?a.valueOf():a)};var a},a=A=>{const e=i.findIndex(e=>e.crc===A.crc);return{soundName:A.name,soundID:e,md5:"".concat(A.md5,".wav"),sampleCount:A.sampleCount,rate:A.rate,format:""}},B=A=>{const e=n.findIndex(e=>e.crc===A.crc);return{costumeName:A.costumeName,baseLayerID:e,baseLayerMD5:"".concat(QA()(A.rawBytes),".").concat((t=A,"uncompressed"===t.extension?"png":"jpg")),bitmapResolution:1,rotationCenterX:A.rotationCenter.x,rotationCenterY:A.rotationCenter.y};var t},c=A=>{let e=A.map(E);const t=$A[e[0]];return t&&(e=t(e)),e},g=A=>A.map(c),E=A=>A instanceof CA?A.objName:Array.isArray(A)?0===A.length||Array.isArray(A[0])?g(A):c(A):A,Q=A=>[A[0].x,A[0].y,g(A[1])],u=A=>A instanceof CA?(A=>{const e=A.media.filter(A=>A instanceof IA),n=A.media.filter(A=>A instanceof dA);return{objName:A.objName,variables:r(A.vars).map(o),lists:r(A.lists).map(s),scripts:A.blocksBin.map(Q),costumes:e.map(B),currentCostumeIndex:e.findIndex(e=>e.crc===A.currentCostume.crc),sounds:n.map(a),scratchX:A.scratchX,scratchY:A.scratchY,scale:A.scalePoint.x,direction:Math.round(1e6*A.rotationDegrees)/1e6-270,rotationStyle:A.rotationStyle,isDraggable:A.draggable,indexInLibrary:t.spriteOrderInLibrary.indexOf(A),visible:A.visible,spriteInfo:{}}})(A):null;return JSON.parse(JSON.stringify(Object.assign((A=>{const e=A.media.filter(A=>A instanceof IA),t=A.media.filter(A=>A instanceof dA);return{objName:A.objName,variables:r(A.vars).map(o),lists:r(A.lists).map(s),scripts:A.blocksBin.map(Q),costumes:e.map(B),currentCostumeIndex:e.findIndex(e=>e.crc===A.currentCostume.crc),sounds:t.map(a),penLayerMD5:"5c81a336fab8be57adc039a8a2b33ca9.png",penLayerID:0,tempoBPM:A.tempoBPM,videoAlpha:.5,children:A.stageContents.map(u).filter(Boolean).reverse()}})(t),{info:(A=>{const e={};for(let t=0;t<A.length;t+=2)"thumbnail"!==String(A[t])&&(e[String(A[t])]=String(A[t+1]));return e})(e)})))};class ee extends(sA.extend({version:new f(10),infoByteLength:M})){validate(){r.validate(this.equals({version:"ScratchV01"})||this.equals({version:"ScratchV02"}),"Invalid Scratch file signature.")}}sA.initConstructor(ee);class te extends(sA.extend({ObjS:new f(4),ObjSValue:g,Stch:new f(4),StchValue:g,numObjects:M})){validate(){r.validate(this.equals({ObjS:"ObjS",ObjSValue:1,Stch:"Stch",StchValue:1}),"Invalid Scratch file info packet header.")}}sA.initConstructor(te);class ne{constructor(A){this.buffer=A,this.stream=new o(A),this.signature=this.stream.readStruct(ee),this.signature.validate(),this.infoHeader=this.stream.readStruct(te),this.infoHeader.validate(),this.stream.position+=this.signature.infoByteLength-te.size,this.dataHeader=this.stream.readStruct(te),this.dataHeader.validate()}get json(){return Ae({info:this.info(),stageData:this.data(),images:this.images(),sounds:this.sounds()})}get zip(){return(A=>{let{images:e,sounds:t}=A;const n={};let i=0;for(const A of e)n["".concat(i++,".").concat((r=A,"uncompressed"===r.extension?"png":"jpg"))]={bytes:_A(A)};var r,o;i=0;for(const A of t)n["".concat(i++,".wav")]={bytes:(o=A,o.wavEncodedData)};return new ZA(n)})({images:this.images(),sounds:this.sounds()})}view(){return{signature:this.signature,infoHeader:this.infoHeader,dataHeader:this.dataHeader,toString:()=>"SB1File"}}infoRaw(){return new s(new _(this.buffer,this.infoHeader.offset+te.size),this.signature.infoByteLength+ee.size)}infoTable(){return new GA(this.infoRaw())}info(){return this._info||(this._info=new SA(this.infoTable()).table[0]),this._info}dataRaw(){return new s(new _(this.buffer,this.dataHeader.offset+te.size),this.stream.uint8a.length)}dataTable(){return new GA(this.dataRaw())}dataFixed(){return this._data||(this._data=new SA(this.dataTable()).table),this._data}data(){return this.dataFixed()[0]}images(){const A=new Set;return this.dataFixed().filter(e=>e instanceof IA&&(!A.has(e.crc)&&(A.add(e.crc),!0)))}sounds(){const A=new Set;return this.dataFixed().filter(e=>e instanceof dA&&(!A.has(e.crc)&&(A.add(e.crc),!0)))}}},function(A,e,t){"use strict";t.r(e);var n={};t.r(n),t.d(n,"Scaffolding",(function(){return J})),t.d(n,"Cloud",(function(){return d})),t.d(n,"VM",(function(){return r.a})),t.d(n,"Renderer",(function(){return s.a})),t.d(n,"Storage",(function(){return g})),t.d(n,"AudioEngine",(function(){return Q.a})),t.d(n,"JSZip",(function(){return w.a}));var i=t(77),r=t.n(i),o=t(78),s=t.n(o),a=t(120),B=t.n(a);class c extends B.a{constructor(){super(),this._totalAssets=0,this._loadedAssets=0}_updateProgress(){this.onprogress&&this.onprogress(this._totalAssets,this._loadedAssets)}load(A,e,t){return A===this.AssetType.ImageBitmap||A===this.AssetType.ImageVector||A===this.AssetType.Sound||A===this.AssetType.Font?(this._totalAssets++,this._updateProgress(),super.load(A,e,t).then(A=>(this._loadedAssets++,this._updateProgress(),A))):super.load(A,e,t)}}var g=c,E=t(79),Q=t.n(E),u=t(31),l=t(33),w=t.n(l);const h=[],C=A=>{let e;var t;return 0===h.length?(t={audio:!1,video:A},e=navigator.mediaDevices?navigator.mediaDevices.getUserMedia(t):Promise.reject(new Error("video is not supported in this context (insecure domain?)")),h.push(e)):h.length>0&&(e=h[0],h.push(!0)),e};class I{constructor(){this.mirror=!0,this._frameCacheTimeout=16,this._video=null,this._track=null,this._workspace=[]}static get FORMAT_IMAGE_DATA(){return"image-data"}static get FORMAT_CANVAS(){return"canvas"}static get DIMENSIONS(){return[480,360]}static get ORDER(){return 1}get video(){return this._video}enableVideo(){return this.enabled=!0,this._setupVideo()}disableVideo(){this.enabled=!1,this._singleSetup&&this._singleSetup.then(this._teardown.bind(this)).catch(A=>this.onError(A))}_teardown(){if(!1===this.enabled){const A=(h.pop(),!(h.length>0));this._singleSetup=null,this._video=null,this._track&&A&&this._track.stop(),this._track=null}}getFrame(A){let{dimensions:e=I.DIMENSIONS,mirror:t=this.mirror,format:n=I.FORMAT_IMAGE_DATA,cacheTimeout:i=this._frameCacheTimeout}=A;if(!this.videoReady)return null;const[r,o]=e,s=this._getWorkspace({dimensions:e,mirror:Boolean(t)}),{videoWidth:a,videoHeight:B}=this._video,{canvas:c,context:g,lastUpdate:E,cacheData:Q}=s,u=Date.now();E+i<u&&(t&&(g.scale(-1,1),g.translate(-1*r,0)),g.drawImage(this._video,0,0,a,B,0,0,r,o),g.setTransform(1,0,0,1,0,0),s.lastUpdate=u),Q[n]||(Q[n]={lastUpdate:0});const l=Q[n];return l.lastUpdate+i<u&&(n===I.FORMAT_IMAGE_DATA?l.lastData=g.getImageData(0,0,r,o):n===I.FORMAT_CANVAS?(l.lastUpdate=1/0,l.lastData=c):(console.error("video io error - unimplemented format ".concat(n)),l.lastUpdate=1/0,l.lastData=null),l.lastUpdate=Math.max(s.lastUpdate,l.lastUpdate)),l.lastData}onError(A){console.error("Unhandled video io device error",A)}_setupVideo(){return this._singleSetup||(this._singleSetup=C({width:{min:480,ideal:640},height:{min:360,ideal:480}}).then(A=>{this._video=document.createElement("video");try{this._video.srcObject=A}catch(e){this._video.src=window.URL.createObjectURL(A)}return this._video.play(),this._track=A.getTracks()[0],this}).catch(A=>{this._singleSetup=null,this.onError(A)})),this._singleSetup}get videoReady(){if(!this.enabled)return!1;if(!this._video)return!1;if(!this._track)return!1;const{videoWidth:A,videoHeight:e}=this._video;return"number"==typeof A&&"number"==typeof e&&(0!==A&&0!==e)}_getWorkspace(A){let{dimensions:e,mirror:t}=A,n=this._workspace.find(A=>A.dimensions.join("-")===e.join("-")&&A.mirror===t);return n||(n={dimensions:e,mirror:t,canvas:document.createElement("canvas"),lastUpdate:0,cacheData:{}},n.canvas.width=e[0],n.canvas.height=e[1],n.context=n.canvas.getContext("2d"),this._workspace.push(n)),n}}var M=I;var d={CloudManager:class{constructor(A){this.parent=A,this.providers=[],this.overrides=new Map}hasCloudData(){return this.parent.vm.runtime.hasCloudData()}projectReady(){if(this.hasCloudData())for(const A of this.providers)A.enable()}setVariable(A,e,t){this.overrides.has(e)&&this.overrides.get(e)!==A||this.parent.vm.postIOData("cloud",{varUpdate:{name:e,value:t}})}getUsername(){return this.parent._username}addProvider(A){A.manager=this,this.hasCloudData()&&A.enable(),this.providers.push(A)}requestCloseConnection(){}createVariable(A,e){}renameVariable(A,e){}deleteVariable(A){}addProviderOverride(A,e){if(e&&!this.providers.includes(e))throw new Error("Manager is not aware of this provider");this.overrides.set(A,e)}updateVariable(A,e){if(this.overrides.has(A)){const t=this.overrides.get(A);t&&t.handleUpdateVariable(A,e)}else for(const t of this.providers)t.handleUpdateVariable(A,e)}},WebSocketProvider:class{constructor(A,e){this.cloudHosts=Array.isArray(A)?A:[A],this.projectId=e,this.attemptedConnections=0,this.bufferedMessages=[],this.scheduledBufferedSend=null,this.reconnectTimeout=null,this.openConnection=this.openConnection.bind(this),this._scheduledSendBufferedMessages=this._scheduledSendBufferedMessages.bind(this)}enable(){this.openConnection()}setProjectId(A){this.projectId=A,this.closeAndReconnect()}openConnection(){this.currentCloudHost=this.cloudHosts[this.attemptedConnections%this.cloudHosts.length],this.attemptedConnections++,console.log("Connecting to ".concat(this.currentCloudHost," with ID ").concat(this.projectId,", username ").concat(this.manager.getUsername()));try{this.ws=new WebSocket(this.currentCloudHost)}catch(A){throw console.error(A),new Error("Cloud host ".concat(this.currentCloudHost," is invalid: ").concat(A))}this.ws.onerror=this.onerror.bind(this),this.ws.onmessage=this.onmessage.bind(this),this.ws.onopen=this.onopen.bind(this),this.ws.onclose=this.onclose.bind(this)}onerror(A){console.error("WebSocket error",A)}onmessage(A){for(const e of A.data.split("\n"))if(e){const A=JSON.parse(e);"set"===A.method&&this.manager.setVariable(this,A.name,A.value)}}onopen(){this.attemptedConnections=0,this.writeToServer({method:"handshake"}),this.sendBufferedMessages(),console.log("WebSocket connected")}onclose(A){if(A&&4002===A.code)return void console.log("Username is invalid; not reconnecting.");if(A&&4003===A.code)return void console.log("Cloud variable server is full; not reconnecting.");if(A&&4004===A.code)return void console.log("Project is blocked; not reconnecting.");const e=Math.random()*(Math.pow(2,Math.min(this.attemptedConnections+1,5))-1)*1e3;console.log("Connection lost; reconnecting in ".concat(Math.round(e),"ms")),this.reconnectTimeout=setTimeout(this.openConnection,e)}closeAndReconnect(){console.log("Closing connection and reconnecting."),this.ws&&(this.ws.onclose=null,this.ws.onerror=null,this.ws.close()),clearTimeout(this.reconnectTimeout);this.reconnectTimeout=setTimeout(this.openConnection,1e3/30)}canWriteToServer(){return this.ws&&this.ws.readyState===WebSocket.OPEN}scheduleBufferedSend(){this.scheduledBufferedSend||(this.scheduledBufferedSend=!0,Promise.resolve().then(this._scheduledSendBufferedMessages))}_scheduledSendBufferedMessages(){this.scheduledBufferedSend=!1,this.canWriteToServer()&&this.sendBufferedMessages()}sendBufferedMessages(){for(const A of this.bufferedMessages)this.writeToServer(A);this.bufferedMessages.length=0}bufferedWriteToServer(A){this.bufferedMessages.push(A),this.scheduleBufferedSend()}writeToServer(A){A.project_id=this.projectId,A.user=this.manager.getUsername(),this.ws.send(JSON.stringify(A))}handleUpdateVariable(A,e){for(const t of this.bufferedMessages)if(t.name===A)return void(t.value=e);this.bufferedWriteToServer({method:"set",name:A,value:e})}},LocalStorageProvider:class{constructor(){let A=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"p4:cloudvariables";this.key=A,this.variables={},this.handleStorageEvent=this.handleStorageEvent.bind(this)}readFromLocalStorage(){let A;try{if(A=JSON.parse(localStorage.getItem(this.key)),!A||"object"!=typeof A)return}catch(A){return}this.variables=A;for(const A of Object.keys(this.variables))this.manager.setVariable(this,A,this.variables[A])}storeToLocalStorage(){try{localStorage.setItem(this.key,JSON.stringify(this.variables))}catch(A){}}handleStorageEvent(A){A.key===this.key&&A.storageArea===localStorage&&this.readFromLocalStorage()}enable(){this.readFromLocalStorage(),window.addEventListener("storage",this.handleStorageEvent)}handleUpdateVariable(A,e){this.variables[A]=e,this.storeToLocalStorage()}}},m=t(121),p=t.n(m),F=t(80),D={insert:A=>{var e=document.head||document.body||document.documentElement;e.insertBefore(A,e.firstChild)},singleton:!1},Y=(p()(F.a,D),F.a.locals||{});const f=A=>new Promise((e,t)=>{const n=new FileReader;n.onload=()=>e(n.result),n.onerror=()=>t(new Error("Cannot read as text: ".concat(n.error))),n.readAsText(A)});var N=class{constructor(A,e){this.el=A,this.callback=e,this.el.addEventListener("dragover",this.ondragover.bind(this)),this.el.addEventListener("dragleave",this.ondragleave.bind(this)),this.el.addEventListener("drop",this.ondrop.bind(this))}ondragover(A){A.dataTransfer.types.includes("Files")&&(A.preventDefault(),A.dataTransfer.dropEffect="copy",this.el.classList.add(Y.dropping))}ondragleave(A){A.preventDefault(),this.el.classList.remove(Y.dropping)}ondrop(A){A.preventDefault(),this.el.classList.remove(Y.dropping),A.dataTransfer.types.includes("Files")&&A.dataTransfer.files.length>0&&Promise.all(Array.from(A.dataTransfer.files).map(f)).then(A=>{this.callback(A)})}};var U=class{constructor(A,e){this.parent=A,this.text=e,this.root=document.createElement("div"),this.root.className=Y.questionRoot,this.inner=document.createElement("div"),this.inner.className=Y.questionInner,e&&(this.textElement=document.createElement("div"),this.textElement.textContent=e,this.textElement.className=Y.questionText),this.inputContainer=document.createElement("div"),this.inputContainer.className=Y.questionInputOuter,this.input=document.createElement("input"),this.input.className=Y.questionInput,this.input.addEventListener("keypress",this.onkeypress.bind(this)),this.dropper=new N(this.input,this.dropperCallback.bind(this)),this.submitButton=document.createElement("button"),this.submitButton.className=Y.questionSubmitButton,this.submitButton.addEventListener("click",this.onsubmitpressclick.bind(this)),this.inputContainer.appendChild(this.input),this.inputContainer.appendChild(this.submitButton),this.textElement&&this.inner.appendChild(this.textElement),this.inner.appendChild(this.inputContainer),this.root.appendChild(this.inner),this.parent._addLayer(this.root),this.input.focus(),this.answerCallback=new Promise(A=>{this.callback=A})}answer(){return this.answerCallback}submit(){this.callback(this.input.value),this.destroy()}onkeypress(A){"Enter"===A.key&&this.submit()}dropperCallback(A){const e=A.join("").replace(/\r?\n/g," ");this.input.value=e}onsubmitpressclick(){this.submit()}destroy(){this.root.remove(),this.parent.question=null}};var y=class{constructor(A){this.parent=A,this.root=document.createElement("div"),this.root.className=Y.contextMenu,this._onmousedown=this._onmousedown.bind(this),this._onresize=this._onresize.bind(this),this._onblur=this._onblur.bind(this)}_onmousedown(A){this.root.contains(A.target)||this.destroy()}_onresize(){this.destroy()}_onblur(){this.destroy()}add(A){const e=document.createElement("button");e.className=Y.contextMenuItem,e.textContent=A.text,e.addEventListener("click",()=>{this.destroy(),A.callback()}),e.addEventListener("contextmenu",A=>{A.preventDefault()}),this.root.appendChild(e)}show(A){document.addEventListener("mousedown",this._onmousedown),window.addEventListener("resize",this._onresize),window.addEventListener("blur",this._onblur),this.parent._addLayer(this.root);const e=this.parent.layersRect,t=this.root.getBoundingClientRect();let n=A.clientX-e.left,i=A.clientY-e.top;n+t.width>e.width&&(n-=t.width),i+t.height>e.height&&(i-=t.height),this.root.style.transform="translate(".concat(n,"px, ").concat(i,"px)"),getComputedStyle(this.root).opacity,this.root.style.opacity="1"}destroy(){document.removeEventListener("mousedown",this._onmousedown),window.removeEventListener("resize",this._onresize),window.removeEventListener("blur",this._onblur),this.root.style.opacity="0",this.root.style.pointerEvents="none",setTimeout(()=>{this.root.remove()},200)}};var T=(A,e)=>{if("undefined"!=typeof ExternalDownloadHelper)return void ExternalDownloadHelper.download(A,e);const t=document.createElement("a");if(document.body.appendChild(t),navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(e,A);else if("download"in HTMLAnchorElement.prototype){const n=window.URL.createObjectURL(e);t.href=n,t.download=A,t.type=e.type,t.click(),window.setTimeout(()=>{document.body.removeChild(t),window.URL.revokeObjectURL(n)},1e3)}else{let A=window.open("","_blank");const t=new FileReader;t.onloadend=function(){A.location.href=t.result,A=null},t.readAsDataURL(e)}};class x{constructor(A,e){this.parent=A,this.id=e.get("id"),this.spriteName=e.get("spriteName"),this.targetId=e.get("targetId"),this.opcode=e.get("opcode"),this.params=e.get("params"),this.root=document.createElement("div"),this.root.className=Y.monitorRoot,this.root.dataset.id=this.id,this.root.dataset.opcode=this.opcode,this.parent._monitorOverlay.appendChild(this.root)}getLabel(){let A;if("data_variable"===this.opcode)A=this.params.VARIABLE;else if("data_listcontents"===this.opcode)A=this.params.LIST;else if("motion_xposition"===this.opcode)A=this.parent.getMessage("var-x");else if("motion_yposition"===this.opcode)A=this.parent.getMessage("var-y");else if("motion_direction"===this.opcode)A=this.parent.getMessage("var-direction");else if("sensing_username"===this.opcode)A=this.parent.getMessage("var-username");else if("looks_costumenumbername"===this.opcode)A="number"===this.params.NUMBER_NAME?this.parent.getMessage("var-costume-number"):this.parent.getMessage("var-costume-name");else if("looks_backdropnumbername"===this.opcode)A="number"===this.params.NUMBER_NAME?this.parent.getMessage("var-backdrop-number"):this.parent.getMessage("var-backdrop-name");else if("looks_size"===this.opcode)A=this.parent.getMessage("var-size");else if("looks_stretchGetX"===this.opcode)A=this.parent.getMessage("var-stretch-x");else if("looks_stretchGetY"===this.opcode)A=this.parent.getMessage("var-stretch-y");else if("looks_sayWidth"===this.opcode)A=this.parent.getMessage("var-say-width");else if("looks_sayHeight"===this.opcode)A=this.parent.getMessage("var-say-height");else if("looks_getEffectValue"===this.opcode){const e=this.params.EFFECT.toLowerCase();A=this.parent.getMessage("var-".concat(e,"-effect"))||this.parent.getMessage("var-effect")}else if("looks_tintColor"===this.opcode)A=this.parent.getMessage("var-tint-color");else if("looks_getSpriteVisible"===this.opcode)A=this.parent.getMessage("var-visible");else if("looks_layersGetLayer"===this.opcode)A=this.parent.getMessage("var-layer");else if("looks_size"===this.opcode)A=this.parent.getMessage("var-size");else if("sound_getEffectValue"===this.opcode){const e=this.params.EFFECT.toLowerCase();A=this.parent.getMessage("var-".concat(e,"-sound-effect"))||this.parent.getMessage("var-sound-effect")}else if("control_get_counter"===this.opcode)A=this.parent.getMessage("var-get_counter");else if("sensing_answer"===this.opcode)A=this.parent.getMessage("var-answer");else if("sensing_mousedown"===this.opcode)A=this.parent.getMessage("var-mousedown");else if("sensing_mouseclicked"===this.opcode)A=this.parent.getMessage("var-mouseclicked");else if("sensing_mousex"===this.opcode)A=this.parent.getMessage("var-mousex");else if("sensing_mousey"===this.opcode)A=this.parent.getMessage("var-mousey");else if("sensing_loudness"===this.opcode)A=this.parent.getMessage("var-loudness");else if("sensing_timer"===this.opcode)A=this.parent.getMessage("var-timer");else if("sensing_dayssince2000"===this.opcode)A=this.parent.getMessage("var-dayssince2000");else if("sensing_getclipboard"===this.opcode)A=this.parent.getMessage("var-getclipboard");else if("sensing_getdragmode"===this.opcode)A=this.parent.getMessage("var-getdragmode");else if("sensing_loud"===this.opcode)A=this.parent.getMessage("var-loud");else if("sensing_loggedin"===this.opcode)A=this.parent.getMessage("var-loggedin");else if("sound_volume"===this.opcode)A=this.parent.getMessage("var-volume");else if("sensing_current"===this.opcode){const e=this.params.CURRENTMENU.toLowerCase();"year"===e?A=this.parent.getMessage("var-year"):"month"===e?A=this.parent.getMessage("var-month"):"date"===e?A=this.parent.getMessage("var-date"):"dayofweek"===e?A=this.parent.getMessage("var-day-of-week"):"hour"===e?A=this.parent.getMessage("var-hour"):"minute"===e?A=this.parent.getMessage("var-minute"):"second"===e&&(A=this.parent.getMessage("var-second"))}else{const e=this.parent.vm.runtime.getLabelForOpcode(this.opcode);A=e?e.label:this.opcode}return this.spriteName?"".concat(this.spriteName,": ").concat(A):A}getTarget(){return this.targetId?this.parent.vm.runtime.getTargetById(this.targetId):this.parent.vm.runtime.getTargetForStage()}getVmVariable(){return this.getTarget().variables[this.id]}update(A){this.x=A.get("x"),this.y=A.get("y"),this.visible=A.get("visible"),this.root.style.transform="translate(".concat(Math.round(this.x),"px, ").concat(Math.round(this.y),"px)"),this.root.style.display=this.visible?"":"none"}}class R extends x{constructor(A,e){super(A,e),this.mode=e.get("mode"),"large"===this.mode?(this.valueElement=document.createElement("div"),this.valueElement.className=Y.monitorLargeValue+" "+Y.monitorValueColor,this.root.appendChild(this.valueElement)):(this.inner=document.createElement("div"),this.inner.className=Y.monitorInner,this.valueRow=document.createElement("div"),this.valueRow.className=Y.monitorRow,this.label=document.createElement("div"),this.label.className=Y.monitorLabel,this.label.textContent=this.getLabel(),this.valueElement=document.createElement("div"),this.valueElement.className=Y.monitorValue+" "+Y.monitorValueColor,this.valueRow.appendChild(this.label),this.valueRow.appendChild(this.valueElement),this.inner.appendChild(this.valueRow),"slider"===this.mode&&(this.sliderRow=document.createElement("div"),this.sliderRow.className=Y.monitorRow,this.slider=document.createElement("input"),this.slider.className=Y.monitorSlider,this.slider.type="range",this.slider.min=e.get("sliderMin"),this.slider.max=e.get("sliderMax"),this.slider.step=e.get("isDiscrete")?1:.01,this.slider.addEventListener("input",this.onsliderchange.bind(this)),this.sliderRow.appendChild(this.slider),this.inner.appendChild(this.sliderRow)),this.root.appendChild(this.inner)),this.parent._monitorOverlay.appendChild(this.root),this._value=""}setVariableValue(A){const e=this.getVmVariable();if(e.value=A,e.isCloud){this.parent.vm.runtime.ioDevices.cloud.requestUpdateVariable(e.name,e.value)}this._value=A,this.valueElement.textContent=A}onsliderchange(A){this.setVariableValue(+A.target.value)}update(A){if(super.update(A),!this.visible)return;let e=A.get("value");"number"==typeof e&&(e=Number(e.toFixed(6))),this._value!==e&&(this._value=e,this.valueElement.textContent=e,this.slider&&(this.slider.value=e))}}class G{constructor(A){this.monitor=A,this.index=-1,this.value="",this.locked=!1,this.root=document.createElement("label"),this.root.className=Y.monitorRowRoot,this.indexEl=document.createElement("div"),this.indexEl.className=Y.monitorRowIndex,this.valueOuter=document.createElement("div"),this.valueOuter.className=Y.monitorRowValueOuter,this.editable=this.monitor.editable,this.editable?(this.valueInner=document.createElement("input"),this.valueInner.tabIndex=-1,this.valueInner.className=Y.monitorRowValueInner,this.valueInner.readOnly=!0,this.valueInner.addEventListener("click",this._onclickinput.bind(this)),this.valueInner.addEventListener("blur",this._onblurinput.bind(this)),this.valueInner.addEventListener("keypress",this._onkeypressinput.bind(this)),this.valueInner.addEventListener("keydown",this._onkeypressdown.bind(this)),this.valueInner.addEventListener("contextmenu",this._oncontextmenu.bind(this)),this.valueInner.addEventListener("input",this._oninput.bind(this)),this.valueOuter.appendChild(this.valueInner),this.deleteButton=document.createElement("button"),this.deleteButton.className=Y.monitorRowDelete,this.deleteButton.textContent="",this.deleteButton.addEventListener("mousedown",this._onclickdelete.bind(this)),this.valueOuter.appendChild(this.deleteButton)):(this.valueInner=document.createElement("div"),this.valueInner.className=Y.monitorRowValueInner,this.valueOuter.appendChild(this.valueInner),this.valueInner.addEventListener("contextmenu",this._oncontextmenuuneditable.bind(this))),this.root.appendChild(this.indexEl),this.root.appendChild(this.valueOuter)}_onclickinput(){this.valueInner.focus(),this.locked||(this.valueInner.select(),this.valueInner.readOnly=!1,this.locked=!0,this.root.classList.add(Y.monitorRowValueEditing),this.addNewValue=!1,this.deleteValue=!1,this.valueWasChanged=!1)}_onblurinput(){if(this.locked)if(this.unfocus(),this.deleteValue){const A=[...this.monitor.value];A.splice(this.index,1),this.monitor.setValue(A),this.monitor.tryToFocusRow(Math.min(A.length-1,this.index))}else if(this.valueWasChanged||this.addNewValue){const A=[...this.monitor.value];A[this.index]=this.valueInner.value,this.addNewValue&&A.splice(this.index+1,0,""),this.monitor.setValue(A),this.addNewValue&&this.monitor.tryToFocusRow(this.index+1)}}_oninput(){this.valueWasChanged=!0}_onkeypressinput(A){"Enter"===A.key&&(this.addNewValue=!0,this.valueInner.blur())}_onkeypressdown(A){if("Escape"===A.key)this.valueInner.blur();else if("ArrowUp"===A.key||"ArrowDown"===A.key||"Tab"===A.key){A.preventDefault();let e=this.index;"ArrowUp"===A.key||"Tab"===A.key&&A.shiftKey?(e--,e<0&&(e=this.monitor.value.length-1)):(e++,e>=this.monitor.value.length&&(e=0)),this.monitor.tryToFocusRow(e)}}_onclickdelete(A){A.preventDefault(),this.deleteValue=!0,this.valueInner.blur()}_oncontextmenu(A){this.locked?A.stopPropagation():A.preventDefault()}_oncontextmenuuneditable(A){const e=getSelection();this.valueInner.contains(e.anchorNode)&&!e.isCollapsed&&A.stopPropagation()}setIndex(A){this.index!==A&&(this.index=A,this.root.dataset.index=A,this.root.style.transform="translateY(".concat(24*A,"px)"),this.indexEl.textContent=A+1)}setValue(A){this.value===A||this.locked||(this.value=A,this.editable?this.valueInner.value=A:this.valueInner.textContent=A)}focus(){this.valueInner.click(),document.activeElement!==this.valueInner&&setTimeout(()=>this.valueInner.click())}unfocus(){this.locked&&(this.locked=!1,this.valueInner.readOnly=!0,this.root.classList.remove(Y.monitorRowValueEditing))}}class S extends x{constructor(A,e){super(A,e),this.editable=A.editableLists,this.rows=new Map,this.cachedRows=[],this.scrollTop=0,this.oldLength=-1,this.label=document.createElement("div"),this.label.className=Y.monitorListLabel,this.label.textContent=this.getLabel(),this.footer=document.createElement("div"),this.footer.className=Y.monitorListFooter,this.footerText=document.createElement("div"),this.footerText.className=Y.monitorListFooterText,this.rowsOuter=document.createElement("div"),this.rowsOuter.className=Y.monitorRowsOuter,this.rowsInner=document.createElement("div"),this.rowsInner.className=Y.monitorRowsInner,this.rowsInner.addEventListener("scroll",this._onscroll.bind(this),{passive:!0}),this.endPoint=document.createElement("div"),this.endPoint.className=Y.monitorRowsEndpoint,this.emptyLabel=document.createElement("div"),this.emptyLabel.textContent=A.getMessage("list-empty"),this.emptyLabel.className=Y.monitorEmpty,this.editable&&(this.addButton=document.createElement("button"),this.addButton.className=Y.monitorListAdd,this.addButton.textContent="+",this.addButton.addEventListener("click",this._onclickaddbutton.bind(this)),this.footer.appendChild(this.addButton)),this.rowsInner.appendChild(this.endPoint),this.rowsInner.appendChild(this.emptyLabel),this.rowsOuter.appendChild(this.rowsInner),this.footer.appendChild(this.footerText),this.root.appendChild(this.label),this.root.appendChild(this.rowsOuter),this.root.appendChild(this.footer),this.dropper=new N(this.rowsOuter,this.dropperCallback.bind(this)),this.handleImport=this.handleImport.bind(this),this.handleExport=this.handleExport.bind(this),this.root.addEventListener("contextmenu",this._oncontextmenu.bind(this))}_onclickaddbutton(A){this.setValue([...this.value,""]),this.tryToFocusRow(this.value.length-1)}unfocusAllRows(){for(const A of this.rows.values())A.unfocus()}tryToFocusRow(A){if(A>=0&&A<this.value.length){this.unfocusAllRows();let e=this.rows.get(A);e||(e=this.createRow(A)),e.focus()}}_onscroll(A){this.scrollTop=A.target.scrollTop,this.updateValue(this.value)}_oncontextmenu(A){A.preventDefault();const e=new y(this.parent);e.add({text:this.parent.getMessage("list-import"),callback:this.handleImport}),e.add({text:this.parent.getMessage("list-export"),callback:this.handleExport}),e.show(A)}handleImport(){const A=document.createElement("input");A.type="file",A.accept=".txt,.csv,.tsv",A.style.display="none",document.body.appendChild(A),A.addEventListener("change",A=>{const e=A.target.files;if(0===e.length)return;const t=e[0];f(t).then(A=>this.import(A))}),A.click()}import(A){const e=A.split(/\r?\n/);this.setValue(e)}handleExport(){const A=this.getValue().join("\n"),e=new Blob([A],{type:"text/plain"});T("".concat(this.getLabel(),".txt"),e)}dropperCallback(A){this.import(A.join("\n"))}getValue(){return this.getVmVariable().value}setValue(A){this.getVmVariable().value=A,this.updateValue(A)}update(A){super.update(A),this.visible&&(this.width=A.get("width")||100,this.height=A.get("height")||200,this.root.style.width="".concat(this.width,"px"),this.root.style.height="".concat(this.height,"px"),this.updateValue(A.get("value")))}createRow(A){const e=this.cachedRows.pop()||new G(this);e.setIndex(A),e.setValue(this.value[A]),this.rows.set(A,e);let t=!1;for(const n of this.rowsInner.children){const i=n.dataset.index;if(!i)continue;if(+i>A){this.rowsInner.insertBefore(e.root,n),t=!0;break}}return t||this.rowsInner.appendChild(e.root),e}updateValue(A){this.value=A,A.length!==this.oldLength&&(this.oldLength=A.length,this.footerText.textContent=this.parent.getMessage("list-length").replace("{n}",A.length),this.endPoint.style.transform="translateY(".concat(24*A.length,"px)"),this.emptyLabel.style.display=A.length?"none":"");let e=Math.floor(this.scrollTop/24)-5;e<0&&(e=0);let t=Math.ceil((this.scrollTop+this.height)/24)+3;t>A.length-1&&(t=A.length-1);for(const n of this.rows.keys())if(n<e||n>t){const e=this.rows.get(n);(!e.locked||n>=A.length)&&(e.unfocus(),e.root.remove(),this.rows.delete(n),this.cachedRows.length<10&&this.cachedRows.push(e))}for(let n=e;n<=t;n++){const e=this.rows.get(n);e?e.setValue(A[n]):this.createRow(n)}}}var H=class{constructor(){this.hasItem=!1,this.root=document.createElement("div"),this.root.className=Y.controlsBar,this.start=document.createElement("div"),this.end=document.createElement("div"),this.root.appendChild(this.start),this.root.appendChild(this.end)}addToStart(A){this.hasItem=!0,this.start.appendChild(A)}addToEnd(A){this.hasItem=!0,this.end.appendChild(A)}computeHeight(){return this.hasItem?this.root.getBoundingClientRect().height:0}};const b=A=>"number"==typeof A||"string"==typeof A||"boolean"==typeof A;var v=t(125);const k=A=>A.touches&&A.touches[0]?{x:A.touches[0].clientX,y:A.touches[0].clientY}:A.changedTouches&&A.changedTouches[0]?{x:A.changedTouches[0].clientX,y:A.changedTouches[0].clientY}:{x:A.clientX,y:A.clientY},j=A=>"function"==typeof A?A:()=>A;class J extends class{constructor(){this._events={}}addEventListener(A,e){this._events[A]||(this._events[A]=[]),this._events[A].push(e)}removeEventListener(A,e){const t=this._events[A];t&&(this._events[A]=t.filter(A=>A!==e))}dispatchEvent(A){const e=this._events[A.type];if(e)for(const t of e)t(A)}}{constructor(){super(),this.width=480,this.height=360,this.resizeMode="preserve-ratio",this.editableLists=!1,this.shouldConnectPeripherals=!0,this.usePackagedRuntime=!1,this.messages=v,this._monitors=new Map,this._mousedownPosition=null,this._draggingId=null,this._draggingStartMousePosition=null,this._draggingStartSpritePosition=null,this._offsetFromTop=0,this._offsetFromBottom=0,this._offsetFromLeft=0,this._offsetFromRight=0,this._root=document.createElement("div"),this._root.className=Y.root,this._layers=document.createElement("div"),this._layers.className=Y.layers,this._root.appendChild(this._layers),this._canvas=document.createElement("canvas"),this._canvas.className=Y.canvas,this._addLayer(this._canvas),this._overlays=document.createElement("div"),this._overlays.className=Y.scaledOverlaysInner,this._overlaysOuter=document.createElement("div"),this._overlaysOuter.className=Y.scaledOverlaysOuter,this._overlaysOuter.appendChild(this._overlays),this._addLayer(this._overlaysOuter),this._monitorOverlay=document.createElement("div"),this._monitorOverlay.className=Y.monitorOverlay,this._overlays.appendChild(this._monitorOverlay),this._topControls=new H,this._layers.appendChild(this._topControls.root),document.addEventListener("mousemove",this._onmousemove.bind(this)),this._canvas.addEventListener("mousedown",this._onmousedown.bind(this)),document.addEventListener("mouseup",this._onmouseup.bind(this)),this._canvas.addEventListener("touchstart",this._ontouchstart.bind(this)),document.addEventListener("touchmove",this._ontouchmove.bind(this)),document.addEventListener("touchend",this._ontouchend.bind(this)),this._canvas.addEventListener("contextmenu",this._oncontextmenu.bind(this)),this._canvas.addEventListener("wheel",this._onwheel.bind(this)),document.addEventListener("keydown",this._onkeydown.bind(this)),document.addEventListener("keyup",this._onkeyup.bind(this)),window.addEventListener("resize",this._onresize.bind(this))}_addLayer(A){this._layers.appendChild(A)}_scratchCoordinates(A,e){return{x:this.width/this.layersRect.width*(A-this.layersRect.width/2),y:-this.height/this.layersRect.height*(e-this.layersRect.height/2)}}_onmousemove(A){const{x:e,y:t}=k(A),n={x:e-this.layersRect.left,y:t-this.layersRect.top,canvasWidth:this.layersRect.width,canvasHeight:this.layersRect.height};if(this._mousedownPosition&&!this._draggingId){Math.sqrt(Math.pow(n.x-this._mousedownPosition.x,2)+Math.pow(n.y-this._mousedownPosition.y,2))>3&&(this._startDragging(n.x,n.y),this._cancelDragTimeout())}else if(this._draggingId){const A=this._scratchCoordinates(n.x,n.y);this.vm.postSpriteInfo({x:A.x-this._draggingStartMousePosition.x+this._draggingStartSpritePosition.x,y:A.y-this._draggingStartMousePosition.y+this._draggingStartSpritePosition.y,force:!0})}this.vm.postIOData("mouse",n)}_startDragging(A,e){if(this._draggingId)return;const t=this.renderer.pick(A,e);if(null===t)return;const n=this.vm.getTargetIdForDrawableId(t);if(null===n)return;const i=this.vm.runtime.getTargetById(n);i.draggable&&(i.goToFront(),this._draggingId=n,this._draggingStartMousePosition=this._scratchCoordinates(A,e),this._draggingStartSpritePosition={x:i.x,y:i.y},this.vm.startDrag(n))}_cancelDragTimeout(){clearTimeout(this._dragTimeout),this._dragTimeout=null}_onmousedown(A){const{x:e,y:t}=k(A),n={x:e-this.layersRect.left,y:t-this.layersRect.top,button:A.button,canvasWidth:this.layersRect.width,canvasHeight:this.layersRect.height,isDown:!0},i="undefined"!=typeof TouchEvent&&A instanceof TouchEvent;(0===A.button||i)&&(this._dragTimeout=setTimeout(this._startDragging.bind(this,n.x,n.y),400)),i&&(A.preventDefault(),document.activeElement&&document.activeElement.blur&&document.activeElement.blur()),this._mousedownPosition={x:n.x,y:n.y},this.vm.postIOData("mouse",n)}_onmouseup(A){this._cancelDragTimeout();const{x:e,y:t}=k(A),n={x:e-this.layersRect.left,y:t-this.layersRect.top,button:A.button,canvasWidth:this.layersRect.width,canvasHeight:this.layersRect.height,isDown:!1,wasDragged:null!==this._draggingId};this._mousedownPosition=null,this.vm.postIOData("mouse",n),this._draggingId&&(this.vm.stopDrag(this._draggingId),this._draggingStartMousePosition=null,this._draggingStartSpritePosition=null,this._draggingId=null)}_ontouchstart(A){this._onmousedown(A)}_ontouchmove(A){this._onmousemove(A)}_ontouchend(A){this._onmouseup(A)}_oncontextmenu(A){A.preventDefault()}_onwheel(A){const e={deltaX:A.deltaX,deltaY:A.deltaY};this.vm.postIOData("mouseWheel",e)}_onkeydown(A){if(A.target!==document&&A.target!==document.body)return;const e={key:A.key,keyCode:A.keyCode,isDown:!0};this.vm.postIOData("keyboard",e),(32===A.keyCode||A.keyCode>=37&&A.keyCode<=40||8===A.keyCode||222===A.keyCode||191===A.keyCode)&&A.preventDefault()}_onkeyup(A){const e={key:A.key,keyCode:A.keyCode,isDown:!1};this.vm.postIOData("keyboard",e),A.target!==document&&A.target!==document.body&&A.preventDefault()}_onresize(){this.relayout()}relayout(){const A=Math.max(1,this._root.offsetWidth),e=Math.max(1,this._root.offsetHeight),t=this._offsetFromTop+this._topControls.computeHeight(),n=this._offsetFromBottom,i=this._offsetFromLeft,r=this._offsetFromRight,o=Math.max(1,A-i-r),s=Math.max(1,e-t-n);"dynamic-resize"===this.resizeMode&&(this.vm.setStageSize?(this.width=o,this.height=s,this.vm.setStageSize(this.width,this.height)):console.warn("dynamic-resize not supported: vm does not implement setStageSize"));let a=o,B=s;"stretch"!==this.resizeMode&&(a=B/this.height*this.width,a>o&&(B=o/this.width*this.height,a=o));const c=e-B,g=A-a,E=(g-i-r)/2+i-g/2,Q=(c-t-n)/2+t-c/2;this._layers.style.transform="translate(".concat(E,"px, ").concat(Q,"px)"),this._layers.style.width="".concat(a,"px"),this._layers.style.height="".concat(B,"px"),this._overlays.style.transform="scale(".concat(a/this.width,", ").concat(B/this.height,")"),this.renderer.resize(a,B),this.layersRect=this._layers.getBoundingClientRect()}appendTo(A){A.appendChild(this._root),this.relayout()}setup(){this.vm=new r.a,this.vm.setCompatibilityMode(!0),this.vm.setLocale(navigator.language),this.vm.on("MONITORS_UPDATE",this._onmonitorsupdate.bind(this)),this.vm.runtime.on("QUESTION",this._onquestion.bind(this)),this.vm.on("PROJECT_RUN_START",()=>this.dispatchEvent(new Event("PROJECT_RUN_START"))),this.vm.on("PROJECT_RUN_STOP",()=>this.dispatchEvent(new Event("PROJECT_RUN_STOP"))),this.usePackagedRuntime&&this.vm.convertToPackagedRuntime&&this.vm.convertToPackagedRuntime(),this.vm.setStageSize&&this.vm.setStageSize(this.width,this.height),this.vm.runtime.cloudOptions&&(this.vm.runtime.cloudOptions.limit=1/0),this.vm.on("STAGE_SIZE_CHANGED",(A,e)=>{this.width===A&&this.height===e||(this.width=A,this.height=e,this.relayout())}),this.cloudManager=new d.CloudManager(this),this.renderer=new s.a(this._canvas,-this.width/2,this.width/2,-this.height/2,this.height/2),this.vm.attachRenderer(this.renderer),this.renderer.overlayContainer&&this._layers.insertBefore(this.renderer.overlayContainer,this._overlaysOuter),this.storage=new g,this.vm.attachStorage(this.storage),"undefined"!=typeof AudioContext||"undefined"!=typeof webkitAudioContext?(this.audioEngine=new Q.a,this.vm.attachAudioEngine(this.audioEngine)):console.warn("AudioContext not supported. Sound will not work."),this.bitmapAdapter=new u.BitmapAdapter,this.vm.attachV2BitmapAdapter(this.bitmapAdapter),this.videoProvider=new M,this.vm.setVideoProvider(this.videoProvider)}async _connectPeripherals(){const A=A=>new Promise(e=>{const t=e=>{const t=Object.keys(e).map(A=>e[A]);if(t.length>0){const e=t[0];console.log("Connecting to peripheral",e),this.vm.connectPeripheral(A,e.peripheralId)}else console.error("No peripherals found for",A);i()},n=()=>{console.error("Peripheral scan timed out for",A),i()},i=()=>{this.vm.removeListener("PERIPHERAL_LIST_UPDATE",t),this.vm.removeListener("PERIPHERAL_SCAN_TIMEOUT",n),e()};this.vm.on("PERIPHERAL_LIST_UPDATE",t),this.vm.on("PERIPHERAL_SCAN_TIMEOUT",n),this.vm.scanForPeripheral(A)});for(const e of Object.keys(this.vm.runtime.peripheralExtensions))await A(e)}_onmonitorsupdate(A){for(const e of A.valueSeq()){const A=e.get("id");if(!this._monitors.has(A)){if(!e.get("visible"))continue;"list"===e.get("mode")?this._monitors.set(A,new S(this,e)):this._monitors.set(A,new R(this,e))}this._monitors.get(A).update(e)}}ask(A){return this._question=new U(this,A),this._question.answer()}_onquestion(A){this._question&&this._question.destroy(),null!==A&&this.ask(A).then(A=>{this.vm.runtime.emit("ANSWER",A)})}loadProject(A){return this.vm.loadProject(A).then(()=>{this.vm.setCloudProvider(this.cloudManager),this.cloudManager.projectReady(),this.renderer.draw(),setTimeout(()=>{this.renderer.draw()}),this.shouldConnectPeripherals&&this._connectPeripherals()})}setUsername(A){this._username=A,this.vm.postIOData("userData",{username:A})}addCloudProvider(A){this.cloudManager.addProvider(A)}addCloudProviderOverride(A,e){this.cloudManager.addProviderOverride(A,e)}addControlButton(A){let{element:e,where:t}=A;if("top-left"===t)this._topControls.addToStart(e);else{if("top-right"!==t)throw new Error("Unknown 'where': ".concat(t));this._topControls.addToEnd(e)}this.relayout()}getMessage(A){return this.messages[A]||A}setAccentColor(A){this._root.style.setProperty("--sc-accent-color",A),this._root.style.setProperty("--sc-accent-color-transparent","".concat(A,"59"))}start(){this.vm.start(),this.vm.greenFlag()}greenFlag(){this.start()}stopAll(){this.vm.stopAll()}_lookupVariable(A,e){const t=this.vm.runtime.getTargetForStage().lookupVariableByNameAndType(A,e);if(!t)throw new Error("Global ".concat(e||"variable"," does not exist: ").concat(A));return t}setExtensionSecurityManager(A){const e=this.vm.extensionManager.securityManager;if(e)for(const[t,n]of Object.entries(A))e[t]=j(n);else console.warn("setExtensionSecurityManager not supported: there is no security manager")}getVariable(A){return this._lookupVariable(A,"").value}setVariable(A,e){if(!b(e))throw new Error("Invalid variable value");this._lookupVariable(A,"").value=e}getList(A){return this._lookupVariable(A,"list").value}setList(A,e){if(!(A=>{if(!Array.isArray(A))return!1;for(let e=0;e<A.length;e++)if(!b(A[e]))return!1;return!0})(e))throw new Error("Invalid list value");this._lookupVariable(A,"list").value=e}}if(window.Scaffolding)throw new Error("Scaffolding already exists on this page");window.Scaffolding=n},function(A,e,t){},function(A,e,t){},]);
// f3d2ad605e50e293c6db8fe58303772444339a20d898d28a6ad0028091591ebe =^..^=